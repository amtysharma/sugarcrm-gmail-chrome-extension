(function(){var h,aa=aa||{},q=this;function ba(a){a=a.split(".");for(var b=q,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}function ca(){}function da(a){a.W=function(){return a.qg?a.qg:a.qg=new a}}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function s(a){return void 0!==a}function u(a){return"array"==ea(a)}function v(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function w(a){return"string"==typeof a}function fa(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function ga(a){return"function"==ea(a)}function A(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ha(a){return a[ia]||(a[ia]=++ja)}
var ia="closure_uid_"+(1E9*Math.random()>>>0),ja=0;function ka(a,b,c){return a.call.apply(a.bind,arguments)}function la(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function ma(a,b,c){ma=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ka:la;return ma.apply(null,arguments)}function na(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var B=Date.now||function(){return+new Date};
function pa(a,b){var c=a.split("."),d=q;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function C(a,b){function c(){}c.prototype=b.prototype;a.m=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.ri=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function qa(a){Error.captureStackTrace?Error.captureStackTrace(this,qa):this.stack=Error().stack||"";a&&(this.message=String(a))}C(qa,Error);qa.prototype.name="CustomError";var ra;function sa(a,b){return 0==a.lastIndexOf(b,0)}function ta(a){var b=a.length-8;return 0<=b&&a.indexOf("#archive",b)==b}function ua(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function va(a){return/^[\s\xa0]*$/.test(a)}function wa(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}function xa(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}
function ya(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function za(a){if(!Aa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ba,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ca,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Da,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ea,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Fa,"&#39;"));return a}var Ba=/&/g,Ca=/</g,Da=/>/g,Ea=/"/g,Fa=/'/g,Aa=/[&<>"']/;function Ga(a){return ya(a.replace(/  /g," &#160;"),void 0)}
function Ha(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ia={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ja={"'":"\\'"};
function Ka(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,k;if(!(k=Ia[d])){if(!(31<e&&127>e))if(d in Ja)d=Ja[d];else if(d in Ia)d=Ja[d]=Ia[d];else{e=d;k=d.charCodeAt(0);if(31<k&&127>k)e=d;else{if(256>k){if(e="\\x",16>k||256<k)e+="0"}else e="\\u",4096>k&&(e+="0");e+=k.toString(16).toUpperCase()}d=Ja[d]=e}k=d}f[g]=k}b.push('"');return b.join("")}function La(a,b){return a<b?-1:a>b?1:0};function Ma(a,b){b.unshift(a);qa.call(this,ua.apply(null,b));b.shift()}C(Ma,qa);Ma.prototype.name="AssertionError";function Na(a,b){throw new Ma("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Oa=Array.prototype,Pa=Oa.indexOf?function(a,b,c){return Oa.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(w(a))return w(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Qa=Oa.forEach?function(a,b,c){Oa.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ra=Oa.filter?function(a,b,c){return Oa.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,g=w(a)?a.split(""):a,k=0;k<d;k++)if(k in g){var l=g[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},Sa=Oa.map?function(a,b,c){return Oa.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=w(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ta=Oa.some?function(a,b,c){return Oa.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},Ua=Oa.every?function(a,b,c){return Oa.every.call(a,b,c)}:function(a,
b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Va(a,b){var c=Wa(a,b,void 0);return 0>c?null:w(a)?a.charAt(c):a[c]}function Wa(a,b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Xa(a,b){return 0<=Pa(a,b)}function Ya(a){if(!u(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Za(a,b){var c=Pa(a,b),d;(d=0<=c)&&$a(a,c);return d}
function $a(a,b){Oa.splice.call(a,b,1)}function ab(a){return Oa.concat.apply(Oa,arguments)}function bb(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function cb(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(u(d)||(e=v(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,k=0;k<g;k++)a[f+k]=d[k];else a.push(d)}}function db(a,b,c,d){Oa.splice.apply(a,eb(arguments,1))}
function eb(a,b,c){return 2>=arguments.length?Oa.slice.call(a,b):Oa.slice.call(a,b,c)}function fb(a,b){if(!v(a)||!v(b)||a.length!=b.length)return!1;for(var c=a.length,d=gb,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function hb(a,b){return a>b?1:a<b?-1:0}function gb(a,b){return a===b}function ib(a,b){var c;c=jb||hb;for(var d=0,e=a.length,f;d<e;){var g=d+e>>1,k;k=c(b,a[g]);0<k?d=g+1:(e=g,f=!k)}c=f?d:~d;0>c&&db(a,-(c+1),0,b)};function kb(a){return function(){throw a;}};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function D(a,b){this.l=[];this.N=a;this.H=b||null}h=D.prototype;h.tb=!1;h.Nb=!1;h.Mc=!1;h.Xf=!1;h.Af=!1;h.vd=0;function lb(a,b){if(a.tb)a.i instanceof D&&lb(a.i);else{if(a.h){var c=a.h;delete a.h;b?lb(c,b):(c.vd--,0>=c.vd&&lb(c))}a.N?a.N.call(a.H,a):a.Af=!0;a.tb||a.D(new mb)}}h.Ad=function(a,b){this.Mc=!1;nb(this,a,b)};function nb(a,b,c){a.tb=!0;a.i=c;a.Nb=!b;a.Fe()}function ob(a){if(a.tb){if(!a.Af)throw new pb;a.Af=!1}}h.C=function(a){ob(this);nb(this,!0,a)};h.D=function(a){ob(this);nb(this,!1,a)};
h.A=function(a,b){return this.B(a,null,b)};h.Lc=function(a,b){return this.B(null,a,b)};h.fa=function(a,b){return this.B(a,a,b)};h.B=function(a,b,c){this.l.push([a,b,c]);this.tb&&this.Fe();return this};function qb(a,b){a.B(b.C,b.D,b)}function rb(a){return Ta(a.l,function(a){return ga(a[1])})}
h.Fe=function(){this.o&&this.tb&&rb(this)&&(q.clearTimeout(this.o),delete this.o);this.h&&(this.h.vd--,delete this.h);for(var a=this.i,b=!1,c=!1;this.l.length&&!this.Mc;){var d=this.l.shift(),e=d[0],f=d[1],d=d[2];if(e=this.Nb?f:e)try{var g=e.call(d||this.H,a);s(g)&&(this.Nb=this.Nb&&(g==a||g instanceof Error),this.i=a=g);a instanceof D&&(this.Mc=c=!0)}catch(k){a=k,this.Nb=!0,rb(this)||(b=!0)}}this.i=a;c&&(a.B(ma(this.Ad,this,!0),ma(this.Ad,this,!1)),a.Xf=!0);b&&(this.o=q.setTimeout(kb(a),0))};
function sb(a){var b=new D;b.C(a);return b}function F(a){var b=new D;b.D(a);return b}function tb(a){Error.captureStackTrace?Error.captureStackTrace(this,tb):this.stack=Error().stack||"";a&&(this.message=String(a))}C(tb,Error);function pb(){tb.call(this)}C(pb,tb);pb.prototype.message="Deferred has already fired";pb.prototype.name="AlreadyCalledError";function mb(){tb.call(this)}C(mb,tb);mb.prototype.message="Deferred was canceled";mb.prototype.name="CanceledError";function ub(){0!=vb&&(wb[ha(this)]=this)}var vb=0,wb={};ub.prototype.H=!1;ub.prototype.oa=function(){if(!this.H&&(this.H=!0,this.J(),0!=vb)){var a=ha(this);delete wb[a]}};ub.prototype.J=function(){if(this.Ub)for(;this.Ub.length;)this.Ub.shift()()};var xb,yb,zb,Ab,Bb;function Cb(){return q.navigator?q.navigator.userAgent:null}function Db(){return q.navigator}Ab=zb=yb=xb=!1;var Eb;if(Eb=Cb()){var Fb=Db();xb=sa(Eb,"Opera");yb=!xb&&(-1!=Eb.indexOf("MSIE")||-1!=Eb.indexOf("Trident"));zb=!xb&&-1!=Eb.indexOf("WebKit");Ab=!xb&&!zb&&!yb&&"Gecko"==Fb.product}var Gb=xb,H=yb,Hb=Ab,Ib=zb,Jb=Db();Bb=-1!=(Jb&&Jb.platform||"").indexOf("Mac");var Kb=!!Db()&&-1!=(Db().appVersion||"").indexOf("X11");
function Lb(){var a=q.document;return a?a.documentMode:void 0}var Mb;a:{var Nb="",Ob;if(Gb&&q.opera)var Pb=q.opera.version,Nb="function"==typeof Pb?Pb():Pb;else if(Hb?Ob=/rv\:([^\);]+)(\)|;)/:H?Ob=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Ib&&(Ob=/WebKit\/(\S+)/),Ob)var Qb=Ob.exec(Cb()),Nb=Qb?Qb[1]:"";if(H){var Rb=Lb();if(Rb>parseFloat(Nb)){Mb=String(Rb);break a}}Mb=Nb}var Sb={};
function Tb(a){var b;if(!(b=Sb[a])){b=0;for(var c=xa(String(Mb)).split("."),d=xa(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var n=l.exec(g)||["","",""],p=m.exec(k)||["","",""];if(0==n[0].length&&0==p[0].length)break;b=La(0==n[1].length?0:parseInt(n[1],10),0==p[1].length?0:parseInt(p[1],10))||La(0==n[2].length,0==p[2].length)||La(n[2],p[2])}while(0==b)}b=Sb[a]=0<=b}return b}
var Ub=q.document,Vb=Ub&&H?Lb()||("CSS1Compat"==Ub.compatMode?parseInt(Mb,10):5):void 0;var Wb=!H||H&&9<=Vb,Xb=!H||H&&9<=Vb,Yb=H&&!Tb("9");!Ib||Tb("528");Hb&&Tb("1.9b")||H&&Tb("8")||Gb&&Tb("9.5")||Ib&&Tb("528");Hb&&!Tb("8")||H&&Tb("9");function K(a,b){this.type=a;this.i=this.target=b}h=K.prototype;h.oa=function(){};h.Tb=!1;h.yg=!0;h.Wc=function(){this.Tb=!0};h.preventDefault=function(){this.yg=!1};function Zb(a){Zb[" "](a);return a}Zb[" "]=ca;function $b(a,b){K.call(this,a?a.type:"");this.j=this.i=this.target=null;this.g=this.clientY=this.clientX=0;this.l=this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.h=null;a&&this.init(a,b)}C($b,K);var ac=[1,4,2];
$b.prototype.init=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.i=b;var d=a.relatedTarget;if(d){if(Hb){var e;a:{try{Zb(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.j=d;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.g=a.keyCode||0;this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.l=Bb?a.metaKey:
a.ctrlKey;this.h=a;a.defaultPrevented&&this.preventDefault();delete this.Tb};function bc(a){return Wb?0==a.h.button:"click"==a.type?!0:!!(a.h.button&ac[0])}$b.prototype.Wc=function(){$b.m.Wc.call(this);this.h.stopPropagation?this.h.stopPropagation():this.h.cancelBubble=!0};$b.prototype.preventDefault=function(){$b.m.preventDefault.call(this);var a=this.h;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Yb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var cc="closure_listenable_"+(1E6*Math.random()|0);function dc(a){try{return!(!a||!a[cc])}catch(b){return!1}}var ec=0;function fc(a,b,c,d,e){this.gc=a;this.proxy=null;this.src=b;this.type=c;this.xd=!!d;this.fc=e;this.key=++ec;this.removed=this.wd=!1}function gc(a){a.removed=!0;a.gc=null;a.proxy=null;a.src=null;a.fc=null};function hc(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function ic(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function jc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function kc(a,b){for(var c=v(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],s(a));c++);return a}function lc(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');a[b]=c}function mc(a,b){return b in a?a[b]:void 0}function nc(a){var b={},c;for(c in a)b[a[c]]=c;return b}var oc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function pc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<oc.length;f++)c=oc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function qc(a){var b=arguments.length;if(1==b&&u(arguments[0]))return qc.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};function rc(a){this.src=a;this.g={};this.h=0}rc.prototype.add=function(a,b,c,d,e){var f=this.g[a];f||(f=this.g[a]=[],this.h++);var g=sc(f,b,d,e);-1<g?(a=f[g],c||(a.wd=!1)):(a=new fc(b,this.src,a,!!d,e),a.wd=c,f.push(a));return a};rc.prototype.remove=function(a,b,c,d){if(!(a in this.g))return!1;var e=this.g[a];b=sc(e,b,c,d);return-1<b?(gc(e[b]),$a(e,b),0==e.length&&(delete this.g[a],this.h--),!0):!1};
function tc(a,b){var c=b.type;if(!(c in a.g))return!1;var d=Za(a.g[c],b);d&&(gc(b),0==a.g[c].length&&(delete a.g[c],a.h--));return d}rc.prototype.removeAll=function(a){var b=0,c;for(c in this.g)if(!a||c==a){for(var d=this.g[c],e=0;e<d.length;e++)++b,gc(d[e]);delete this.g[c];this.h--}return b};function uc(a,b,c,d,e){a=a.g[b];b=-1;a&&(b=sc(a,c,d,e));return-1<b?a[b]:null}function sc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.gc==b&&f.xd==!!c&&f.fc==d)return e}return-1};var vc="closure_lm_"+(1E6*Math.random()|0),wc={},xc=0;function yc(a,b,c,d,e){if(u(b)){for(var f=0;f<b.length;f++)yc(a,b[f],c,d,e);return null}c=zc(c);return dc(a)?a.listen(b,c,d,e):Ac(a,b,c,!1,d,e)}function Ac(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,k=Cc(a);k||(a[vc]=k=new rc(a));c=k.add(b,c,d,e,f);if(c.proxy)return c;d=Dc();c.proxy=d;d.src=a;d.gc=c;a.addEventListener?a.addEventListener(b,d,g):a.attachEvent(b in wc?wc[b]:wc[b]="on"+b,d);xc++;return c}
function Dc(){var a=Ec,b=Xb?function(c){return a.call(b.src,b.gc,c)}:function(c){c=a.call(b.src,b.gc,c);if(!c)return c};return b}function Fc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Fc(a,b[f],c,d,e);else c=zc(c),dc(a)?a.sb.add(String(b),c,!0,d,e):Ac(a,b,c,!0,d,e)}function Gc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Gc(a,b[f],c,d,e);else c=zc(c),dc(a)?a.xa(b,c,d,e):a&&(a=Cc(a))&&(b=uc(a,b,c,!!d,e))&&Hc(b)}
function Hc(a){if(y(a)||!a||a.removed)return!1;var b=a.src;if(dc(b))return tc(b.sb,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.xd):b.detachEvent&&b.detachEvent(c in wc?wc[c]:wc[c]="on"+c,d);xc--;(c=Cc(b))?(tc(c,a),0==c.h&&(c.src=null,b[vc]=null)):gc(a);return!0}function Ic(a,b,c,d){var e=1;if(a=Cc(a))if(b=a.g[b])for(b=bb(b),a=0;a<b.length;a++){var f=b[a];f&&f.xd==c&&!f.removed&&(e&=!1!==Jc(f,d))}return Boolean(e)}
function Jc(a,b){var c=a.gc,d=a.fc||a.src;a.wd&&Hc(a);return c.call(d,b)}
function Ec(a,b){if(a.removed)return!0;if(!Xb){var c=b||ba("window.event"),d=new $b(c,this),e=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==c.returnValue)c.returnValue=!0}c=[];for(f=d.i;f;f=f.parentNode)c.push(f);for(var f=a.type,k=c.length-1;!d.Tb&&0<=k;k--)d.i=c[k],e&=Ic(c[k],f,!0,d);for(k=0;!d.Tb&&k<c.length;k++)d.i=c[k],e&=Ic(c[k],f,!1,d)}return e}return Jc(a,new $b(b,this))}
function Cc(a){a=a[vc];return a instanceof rc?a:null}var Kc="__closure_events_fn_"+(1E9*Math.random()>>>0);function zc(a){return ga(a)?a:a[Kc]||(a[Kc]=function(b){return a.handleEvent(b)})};function Lc(){ub.call(this);this.sb=new rc(this);this.Kc=this}C(Lc,ub);Lc.prototype[cc]=!0;h=Lc.prototype;h.Dc=null;h.wf=function(a){this.Dc=a};h.removeEventListener=function(a,b,c,d){Gc(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.Dc;if(c)for(b=[];c;c=c.Dc)b.push(c);var c=this.Kc,d=a.type||a;if(w(a))a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);pc(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.Tb&&0<=g;g--)f=a.i=b[g],e=Mc(f,d,!0,a)&&e;a.Tb||(f=a.i=c,e=Mc(f,d,!0,a)&&e,a.Tb||(e=Mc(f,d,!1,a)&&e));if(b)for(g=0;!a.Tb&&g<b.length;g++)f=a.i=b[g],e=Mc(f,d,!1,a)&&e;return e};h.J=function(){Lc.m.J.call(this);this.sb&&this.sb.removeAll(void 0);this.Dc=null};
h.listen=function(a,b,c,d){return this.sb.add(String(a),b,!1,c,d)};h.xa=function(a,b,c,d){return this.sb.remove(String(a),b,c,d)};function Mc(a,b,c,d){b=a.sb.g[String(b)];if(!b)return!0;b=bb(b);for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.xd==c){var k=g.gc,l=g.fc||g.src;g.wd&&tc(a.sb,g);e=!1!==k.call(l,d)&&e}}return e&&!1!=d.yg};function L(a){qa.call(this,a);this.name="ydn.error.ArgumentException"}C(L,qa);function Nc(a){qa.call(this,a);this.name="ydn.error.NotSupportedException"}C(Nc,qa);function Oc(a){qa.call(this,a);this.name="ydn.error.NotImplementedException"}C(Oc,qa);function Pc(a){qa.call(this,a);this.name="ydn.error.InvalidOperationException"}C(Pc,qa);
function Qc(a){Error.captureStackTrace?Error.captureStackTrace(this,Qc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(Qc,Error);Qc.prototype.name="ydn.error.InternalError";function Rc(a,b){D.call(this,a,b);this.j=[]}C(Rc,D);function Sc(a,b){for(var c=0;c<a.j.length;c++)a.j[c][0].call(a.j[c][1],b)}Rc.prototype.C=function(a){this.j.length=0;Rc.m.C.call(this,a)};Rc.prototype.D=function(a){this.j.length=0;Rc.m.D.call(this,a)};function Tc(a){this.id="i"+this.count();this.req=a;this.i=!0;this.g=this.h=null;this.j=new Rc;this.l=NaN}Tc.prototype.F=function(){return this.id};var Uc=0;Tc.prototype.count=function(){Uc++;return Uc};
Tc.prototype.listen=function(a){if(a&&a.id==this.id){this.h=a.data;var b=a.error;b&&(b instanceof Error?this.g=b:A(b)?(this.g=Error(b.message),this.g.name=b.name,this.g.source=b,this.g.result=this.h):(this.g=Error(b),this.g.name="UnknownError"));a.done?(this.i=!1,this.g?this.j.D(this.g):this.j.C(this.h),window.clearTimeout(this.l)):Sc(this.j,a.data);return!0}return!1};Tc.prototype.toString=function(){return"Message:"+this.id+(this.i?"*":"")};
Tc.prototype.toJSON=function(){var a=this;this.l=window.setTimeout(function(){if(a.i){var b=Error("message timeout");b.name="TimeOutError";a.listen({id:a.id,req:a.req,error:b})}},1E4);return{id:this.id,req:this.req,group:this.o,name:this.p,data:this.h}};function Vc(a){Lc.call(this);var b=w(a)?null:a;this.name=w(a)?a:a.name;this.g=[];this.o=b;this.h=null;this.i={}}C(Vc,Lc);Vc.prototype.J=function(){if(this.h){var a=this;this.h.disconnect(function(){a.h=null;a.g.length=0})}else this.g.length=0};function Wc(a){K.call(this,"post");this.message=a}C(Wc,K);Wc.prototype.getMessage=function(){return this.message};
Vc.prototype.l=function(a){if(a)if(a.id)for(var b=this.g.length-1;0<=b;b--){if(this.g[b].F()==a.id&&this.g[b].listen(a)){this.g[b].i?25<b&&(a=this.g.splice(b,1),this.g.unshift(a[0])):this.g.splice(b,1);break}}else"info"==a.req?(a.data=this.o,this.h.postMessage(a)):"html-body-inner"==a.req?(window.console.log("html",a),a.req="",a.done=!0,a.data=document&&document.body?document.body.innerHTML:"",this.h.postMessage(a)):this.dispatchEvent(new Wc(a))};Vc.prototype.toString=function(){return"Pipe:"+this.name};
Vc.prototype.j=function(a,b){var c=a||Xc,d=c+(b?"-"+b:"");this.i[d]||(this.i[d]=new Yc(this,c,b||""));return this.i[d]};function Zc(a){if(!a.h){a.h=chrome.runtime.connect({name:a.name});var b=ma(a.l,a);a.h.onMessage.addListener(b);a.h.onDisconnect.addListener(function(){a.h.onMessage.removeListener(b);a.h=null;a.g.length=0})}return a.h}var $c=null;function ad(){if(!$c){var a=Xc+"-"+B();$c=new Vc(a)}return $c}function bd(a){var b=a;w(a)&&(b={group:a,name:a+"-"+B()});return $c=new Vc(b)}
var Xc="default",cd=["dev","gmail","host-permission","popup","options"];function dd(a,b){return ad().j(a,b)}function Yc(a,b,c){this.g=a;this.h=b;this.i=c}Yc.prototype.send=function(a,b){var c=new Tc(a),d=this.i;c.o=this.h;c.p=d;b&&(c.h=b);var d=c.j,e=this.g,f=c.toJSON();Zc(e).postMessage(f);e.g.push(c);50<e.g.length&&(e.g.length-=1);return d};function ed(a){if("function"==typeof a.Aa)return a.Aa();if(w(a))return a.split("");if(v(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return ic(a)}function fd(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(v(a)||w(a))Qa(a,b,c);else{var d;if("function"==typeof a.Qa)d=a.Qa();else if("function"!=typeof a.Aa)if(v(a)||w(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=jc(a);else d=void 0;for(var e=ed(a),f=e.length,g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)}};var gd="StopIteration"in q?q.StopIteration:Error("StopIteration");function hd(){}hd.prototype.g=function(){throw gd;};hd.prototype.Kb=function(){return this};function id(a){if(a instanceof hd)return a;if("function"==typeof a.Kb)return a.Kb(!1);if(v(a)){var b=0,c=new hd;c.g=function(){for(;;){if(b>=a.length)throw gd;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function kd(a,b){if(v(a))try{Qa(a,b,void 0)}catch(c){if(c!==gd)throw c;}else{a=id(a);try{for(;;)b.call(void 0,a.g(),void 0,a)}catch(d){if(d!==gd)throw d;}}}function ld(a){if(v(a))return bb(a);a=id(a);var b=[];kd(a,function(a){b.push(a)});return b};function md(a,b){this.h={};this.g=[];this.j=this.i=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof md?(c=a.Qa(),d=a.Aa()):(c=jc(a),d=ic(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=md.prototype;h.ca=function(){return this.i};h.Aa=function(){nd(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a};h.Qa=function(){nd(this);return this.g.concat()};
h.Oa=function(){return 0==this.i};h.clear=function(){this.h={};this.j=this.i=this.g.length=0};h.remove=function(a){return od(this.h,a)?(delete this.h[a],this.i--,this.j++,this.g.length>2*this.i&&nd(this),!0):!1};function nd(a){if(a.i!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];od(a.h,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.i!=a.g.length){for(var e={},c=b=0;b<a.g.length;)d=a.g[b],od(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}h.get=function(a,b){return od(this.h,a)?this.h[a]:b};
h.set=function(a,b){od(this.h,a)||(this.i++,this.g.push(a),this.j++);this.h[a]=b};h.ga=function(){return new md(this)};h.Kb=function(a){nd(this);var b=0,c=this.g,d=this.h,e=this.j,f=this,g=new hd;g.g=function(){for(;;){if(e!=f.j)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw gd;var g=c[b++];return a?g:d[g]}};return g};function od(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var pd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function qd(a){if(rd){rd=!1;var b=q.location;if(b){var c=b.href;if(c&&(c=(c=qd(c)[3]||null)&&decodeURIComponent(c))&&c!=b.hostname)throw rd=!0,Error();}}return a.match(pd)}var rd=Ib;function sd(a,b){var c;if(a instanceof sd)this.Zb=s(b)?b:a.Zb,td(this,a.lc),this.he=a.he,ud(this,a.K()),vd(this,a.Jd),wd(this,a.Ec),xd(this,a.g.ga()),yd(this,a.Ge);else if(a&&(c=qd(String(a)))){this.Zb=!!b;td(this,c[1]||"",!0);var d=c[2]||"";this.he=d?decodeURIComponent(d):"";ud(this,c[3]||"",!0);vd(this,c[4]);wd(this,c[5]||"",!0);xd(this,c[6]||"",!0);yd(this,c[7]||"",!0)}else this.Zb=!!b,this.g=new zd(null,0,this.Zb)}h=sd.prototype;h.lc="";h.he="";h.De="";h.Jd=null;h.Ec="";h.Ge="";h.Zb=!1;
h.toString=function(){var a=[],b=this.lc;b&&a.push(Ad(b,Bd),":");if(b=this.K()){a.push("//");var c=this.he;c&&a.push(Ad(c,Bd),"@");a.push(encodeURIComponent(String(b)));b=this.Jd;null!=b&&a.push(":",String(b))}if(b=this.Ec)this.De&&"/"!=b.charAt(0)&&a.push("/"),a.push(Ad(b,"/"==b.charAt(0)?Cd:Dd));(b=this.g.toString())&&a.push("?",b);(b=this.Ge)&&a.push("#",Ad(b,Ed));return a.join("")};h.ga=function(){return new sd(this)};
function td(a,b,c){a.lc=c?b?decodeURIComponent(b):"":b;a.lc&&(a.lc=a.lc.replace(/:$/,""));return a}h.K=function(){return this.De};function ud(a,b,c){a.De=c?b?decodeURIComponent(b):"":b;return a}function vd(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Jd=b}else a.Jd=null}function Fd(a){return a.Ec}function wd(a,b,c){a.Ec=c?b?decodeURIComponent(b):"":b}function xd(a,b,c){b instanceof zd?(a.g=b,Gd(a.g,a.Zb)):(c||(b=Ad(b,Hd)),a.g=new zd(b,0,a.Zb))}
function yd(a,b,c){a.Ge=c?b?decodeURIComponent(b):"":b}function Ad(a,b){return w(a)?encodeURI(a).replace(b,Id):null}function Id(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Bd=/[#\/\?@]/g,Dd=/[\#\?:]/g,Cd=/[\#\?]/g,Hd=/[\#\?@]/g,Ed=/#/g;function zd(a,b,c){this.g=a||null;this.h=!!c}
function Jd(a){if(!a.ja&&(a.ja=new md,a.Ma=0,a.g))for(var b=a.g.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=null,f=null;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=Kd(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}h=zd.prototype;h.ja=null;h.Ma=null;h.ca=function(){Jd(this);return this.Ma};h.add=function(a,b){Jd(this);this.g=null;a=Kd(this,a);var c=this.ja.get(a);c||this.ja.set(a,c=[]);c.push(b);this.Ma++;return this};
h.remove=function(a){Jd(this);a=Kd(this,a);return od(this.ja.h,a)?(this.g=null,this.Ma-=this.ja.get(a).length,this.ja.remove(a)):!1};h.clear=function(){this.ja=this.g=null;this.Ma=0};h.Oa=function(){Jd(this);return 0==this.Ma};function Ld(a,b){Jd(a);b=Kd(a,b);return od(a.ja.h,b)}h.Qa=function(){Jd(this);for(var a=this.ja.Aa(),b=this.ja.Qa(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
h.Aa=function(a){Jd(this);var b=[];if(w(a))Ld(this,a)&&(b=ab(b,this.ja.get(Kd(this,a))));else{a=this.ja.Aa();for(var c=0;c<a.length;c++)b=ab(b,a[c])}return b};h.set=function(a,b){Jd(this);this.g=null;a=Kd(this,a);Ld(this,a)&&(this.Ma-=this.ja.get(a).length);this.ja.set(a,[b]);this.Ma++;return this};h.get=function(a,b){var c=a?this.Aa(a):[];return 0<c.length?String(c[0]):b};
h.toString=function(){if(this.g)return this.g;if(!this.ja)return"";for(var a=[],b=this.ja.Qa(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.Aa(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.g=a.join("&")};h.ga=function(){var a=new zd;a.g=this.g;this.ja&&(a.ja=this.ja.ga(),a.Ma=this.Ma);return a};function Kd(a,b){var c=String(b);a.h&&(c=c.toLowerCase());return c}
function Gd(a,b){b&&!a.h&&(Jd(a),a.g=null,fd(a.ja,function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.g=null,this.ja.set(Kd(this,e),bb(a)),this.Ma+=a.length))},a));a.h=b};var Md;
Md={i:["BC","AD"],h:["Before Christ","Anno Domini"],p:"JFMAMJJASOND".split(""),ea:"JFMAMJJASOND".split(""),o:"January February March April May June July August September October November December".split(" "),Z:"January February March April May June July August September October November December".split(" "),G:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Ja:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Kc:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Ub:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
T:"Sun Mon Tue Wed Thu Fri Sat".split(" "),Wa:"Sun Mon Tue Wed Thu Fri Sat".split(" "),t:"SMTWTFS".split(""),na:"SMTWTFS".split(""),N:["Q1","Q2","Q3","Q4"],H:["1st quarter","2nd quarter","3rd quarter","4th quarter"],g:["AM","PM"],Kf:["EEEE, MMMM d, y","MMMM d, y","MMM d, y","M/d/yy"],Rf:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],Ng:["{1} 'at' {0}","{1} 'at' {0}","{1}, {0}","{1}, {0}"],j:6,od:[5,6],l:5};function Nd(a){this.h=[];this.g=Md;"number"==typeof a?Od(this,a):Pd(this,a)}var Qd=[/^\'(?:[^\']|\'\')*\'/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|w+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvwzZ]+/];function Pd(a,b){for(;b;)for(var c=0;c<Qd.length;++c){var d=b.match(Qd[c]);if(d){d=d[0];b=b.substring(d.length);0==c&&("''"==d?d="'":(d=d.substring(1,d.length-1),d=d.replace(/\'\'/,"'")));a.h.push({text:d,type:c});break}}}
function Od(a,b){var c;if(4>b)c=a.g.Kf[b];else if(8>b)c=a.g.Rf[b-4];else if(12>b)c=a.g.Ng[b-8],c=c.replace("{1}",a.g.Kf[b-8]),c=c.replace("{0}",a.g.Rf[b-8]);else{Od(a,10);return}Pd(a,c)}function Rd(a){var b=Nd.prototype;if(void 0===b.g||void 0===b.g.Ug)return a;for(var c=[],d=0;d<a.length;d++){var e=a.charCodeAt(d);c.push(48<=e&&57>=e?String.fromCharCode(b.g.Ug+e-48):a.charAt(d))}return c.join("")};var Sd={Lg:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Kg:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Td=Sd,Td=Sd;var Ud={Mf:".",Of:",",Pf:"%",te:"0",Sg:"+",Pg:"-",Nf:"E",Qf:"\u2030",se:"\u221e",Qg:"NaN",Lf:"#,##0.###",Tg:"#E0",Rg:"#,##0%",Mg:"\u00a4#,##0.00;(\u00a4#,##0.00)",Og:"USD"},Vd=Ud,Vd=Ud;var Wd={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[0,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[18,"kr","kr"],DOP:[2,"$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[0,"Ft",
"Ft"],IDR:[0,"Rp","Rp"],ILS:[2,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],LVL:[2,"Ls","Ls"],MNT:[0,"\u20ae","MN\u20ae"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u0440\u0443\u0431.",
"\u0440\u0443\u0431."],SAR:[2,"Rial","Rial"],SEK:[2,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u20b4","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[0,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};function Xd(a,b,c){this.t=b||Vd.Og;this.Ub=c||Yd;this.N=40;this.g=1;this.na=0;this.j=3;this.T=this.h=0;this.Wa=!1;this.G=this.l="";this.i="-";this.o="";this.H=1;this.ea=3;this.Z=this.Ja=!1;this.p=Zd;if("number"==typeof a)switch(a){case 1:$d(this,Vd.Lf);break;case 2:$d(this,Vd.Tg);break;case 3:$d(this,Vd.Rg);break;case 4:a=Vd.Mg;b=["0"];c=Wd[this.t][0]&7;if(0<c){b.push(".");for(var d=0;d<c;d++)b.push("0")}a=a.replace(/0.00/g,b.join(""));$d(this,a);break;case 5:ae(this,1);break;case 6:ae(this,2);break;
default:throw Error("Unsupported pattern type.");}else $d(this,a)}var Yd=0,Zd=0;
function $d(a,b){b.replace(/ /g,"\u00a0");var c=[0];a.l=be(a,b,c);for(var d=c[0],e=-1,f=0,g=0,k=0,l=-1,m=b.length,n=!0;c[0]<m&&n;c[0]++)switch(b.charAt(c[0])){case "#":0<g?k++:f++;0<=l&&0>e&&l++;break;case "0":if(0<k)throw Error('Unexpected "0" in pattern "'+b+'"');g++;0<=l&&0>e&&l++;break;case ",":l=0;break;case ".":if(0<=e)throw Error('Multiple decimal separators in pattern "'+b+'"');e=f+g+k;break;case "E":if(a.Z)throw Error('Multiple exponential symbols in pattern "'+b+'"');a.Z=!0;a.T=0;c[0]+1<
m&&"+"==b.charAt(c[0]+1)&&(c[0]++,a.Wa=!0);for(;c[0]+1<m&&"0"==b.charAt(c[0]+1);)c[0]++,a.T++;if(1>f+g||1>a.T)throw Error('Malformed exponential pattern "'+b+'"');n=!1;break;default:c[0]--,n=!1}0==g&&0<f&&0<=e&&(g=e,0==g&&g++,k=f-g,f=g-1,g=1);if(0>e&&0<k||0<=e&&(e<f||e>f+g)||0==l)throw Error('Malformed pattern "'+b+'"');k=f+g+k;a.j=0<=e?k-e:0;0<=e&&(a.h=f+g-e,0>a.h&&(a.h=0));a.g=(0<=e?e:k)-f;a.Z&&(a.N=f+a.g,0==a.j&&0==a.g&&(a.g=1));a.ea=Math.max(0,l);a.Ja=0==e||e==k;d=c[0]-d;a.G=be(a,b,c);c[0]<b.length&&
b.charAt(c[0])==ce?(c[0]++,a.i=be(a,b,c),c[0]+=d,a.o=be(a,b,c)):(a.i=a.l+a.i,a.o+=a.G)}function ae(a,b){a.p=b;$d(a,Vd.Lf);a.h=0;a.j=2;if(0<a.h)throw Error("Can't combine significant digits and minimum fraction digits");a.na=2}
Xd.prototype.parse=function(a,b){var c=b||[0];if(this.p!=Zd)throw Error("Parsing of compact numbers is unimplemented");var d=NaN;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.l,c[0])==c[0],f=a.indexOf(this.i,c[0])==c[0];e&&f&&(this.l.length>this.i.length?f=!1:this.l.length<this.i.length&&(e=!1));e?c[0]+=this.l.length:f&&(c[0]+=this.i.length);if(a.indexOf(Vd.se,c[0])==c[0])c[0]+=Vd.se.length,d=Infinity;else{var d=a,g=!1,k=!1,l=!1,m=1,n=Vd.Mf,p=Vd.Of,r=Vd.Nf;if(this.p!=Zd)throw Error("Parsing of compact style numbers is not implemented");
for(var t="";c[0]<d.length;c[0]++){var x=d.charAt(c[0]),z=de(x);if(0<=z&&9>=z)t+=z,l=!0;else if(x==n.charAt(0)){if(g||k)break;t+=".";g=!0}else if(x==p.charAt(0)&&("\u00a0"!=p.charAt(0)||c[0]+1<d.length&&0<=de(d.charAt(c[0]+1)))){if(g||k)break}else if(x==r.charAt(0)){if(k)break;t+="E";k=!0}else if("+"==x||"-"==x)t+=x;else if(x==Vd.Pf.charAt(0)){if(1!=m)break;m=100;if(l){c[0]++;break}}else if(x==Vd.Qf.charAt(0)){if(1!=m)break;m=1E3;if(l){c[0]++;break}}else break}d=parseFloat(t)/m}if(e){if(a.indexOf(this.G,
c[0])!=c[0])return NaN;c[0]+=this.G.length}else if(f){if(a.indexOf(this.o,c[0])!=c[0])return NaN;c[0]+=this.o.length}return f?-d:d};function ee(a,b){var c=Math.pow(10,a.j),d=0>=a.na?Math.round(b*c):Math.floor(ge(b*c,a.na,a.j)),e;isFinite(d)?(e=Math.floor(d/c),c=Math.floor(d-e*c)):(e=b,c=0);return{rg:e,Zg:c}}
function he(a,b,c,d){if(a.h>a.j)throw Error("Min value must be less than max value");b=ee(a,b);var e=Math.pow(10,a.j),f=b.rg,g=b.Zg,k=0<a.h||0<g||!1;b=a.h;k&&(b=a.h);for(var l="",m=f;1E20<m;)l="0"+l,m=Math.round(m/10);var l=m+l,n=Vd.Mf,p=Vd.Of,m=Vd.te.charCodeAt(0),r=l.length;if(0<f||0<c){for(f=r;f<c;f++)d.push(String.fromCharCode(m));for(f=0;f<r;f++)d.push(String.fromCharCode(m+1*l.charAt(f))),1<r-f&&0<a.ea&&1==(r-f)%a.ea&&d.push(p)}else k||d.push(String.fromCharCode(m));(a.Ja||k)&&d.push(n);a=""+
(g+e);for(c=a.length;"0"==a.charAt(c-1)&&c>b+1;)c--;for(f=1;f<c;f++)d.push(String.fromCharCode(m+1*a.charAt(f)))}function ie(a,b,c){c.push(Vd.Nf);0>b?(b=-b,c.push(Vd.Pg)):a.Wa&&c.push(Vd.Sg);b=""+b;for(var d=Vd.te,e=b.length;e<a.T;e++)c.push(d);c.push(b)}function de(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Vd.te.charCodeAt(0);return b<=a&&a<b+10?a-b:-1}var ce=";";
function be(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var g=b.charAt(c[0]);if("'"==g)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case ce:return d;case "\u00a4":if(c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1))c[0]++,d+=a.t;else switch(a.Ub){case Yd:d+=Wd[a.t][1];break;case 2:var g=a.t,k=Wd[g],d=d+(g==k[1]?g:g+" "+k[1]);break;case 1:d+=Wd[a.t][2]}break;case "%":if(1!=a.H)throw Error("Too many percent/permill");a.H=100;d+=Vd.Pf;
break;case "\u2030":if(1!=a.H)throw Error("Too many percent/permill");a.H=1E3;d+=Vd.Qf;break;default:d+=g}}return d}var je={prefix:"",Ag:"",Ce:0};function ke(a,b){var c=1==a.p?Td.Lg:Td.Kg;if(3>b)return je;b=Math.min(14,b);c=c[Math.pow(10,b)];if(!c)return je;c=c.other;return c&&"0"!=c?(c=/([^0]*)(0+)(.*)/.exec(c))?{prefix:c[1],Ag:c[3],Ce:b-(c[2].length-1)}:je:je}function le(a){for(var b=0;1<=(a/=10);)b++;return b}
function ge(a,b,c){if(!a)return a;b=b-le(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};function me(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"}var ne=me,ne=me;function oe(a){return 1==a?"one":"other"}var pe=oe,pe=oe;function qe(a){this.g=[];this.i=[];this.j=new Xd(1);a&&(a=re(this,a),this.i=se(this,a))}var te=RegExp("'([{}#].*?)'","g"),ue=RegExp("''","g");
function ve(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var g=b[f].value,k=a,l=e,m=c[g];s(m)?(k.g.push(m),l.push(k.h(k.g))):l.push("Undefined parameter - "+g);break;case 2:g=b[f].value;k=e;l=g.td;s(c[l])?(l=g[c[l]],s(l)||(l=g.other),ve(a,l,c,d,k)):k.push("Undefined parameter - "+l);break;case 0:g=b[f].value;we(a,g,c,pe,d,e);break;case 1:g=b[f].value;we(a,g,c,ne,d,e);break;default:Na("Unrecognized block type.")}}
function we(a,b,c,d,e,f){var g=b.td,k=b.Vf,l=+c[g];if(isNaN(l))f.push("Undefined or invalid parameter - "+g);else if(k=l-k,g=b[c[g]],s(g)||(d=d(k),g=b[d],s(g)||(g=b.other)),b=[],ve(a,g,c,e,b),c=b.join(""),e)f.push(c);else{a=a.j;if(isNaN(k))a=Vd.Qg;else{e=[];g=d=k;a.p==Zd?b=je:(d=Math.abs(d),g=Math.abs(g),b=ke(a,1>=d?0:le(d)).Ce,ee(a,g/Math.pow(10,b)),d=ee(a,d/Math.pow(10,b)),b=ke(a,b+le(d.rg)));k/=Math.pow(10,b.Ce);e.push(b.prefix);d=0>k||0==k&&0>1/k;e.push(d?a.i:a.l);if(isFinite(k))if(k=k*(d?-1:
1)*a.H,a.Z)if(0==k)he(a,k,a.g,e),ie(a,0,e);else{g=Math.log(k)/Math.log(10);g=Math.floor(g+2E-15);k/=Math.pow(10,g);l=a.g;if(1<a.N&&a.N>a.g){for(;0!=g%a.N;)k*=10,g--;l=1}else 1>a.g?(g++,k/=10):(g-=a.g-1,k*=Math.pow(10,a.g-1));he(a,k,l,e);ie(a,g,e)}else he(a,k,a.g,e);else e.push(Vd.se);e.push(d?a.o:a.G);e.push(b.Ag);a=e.join("")}f.push(c.replace(/#/g,a))}}
function re(a,b){var c=a.g,d=ma(a.h,a);b=b.replace(ue,function(){c.push("'");return d(c)});return b=b.replace(te,function(a,b){c.push(b);return d(c)})}function xe(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,g),d.push(f),b=g+1)):(0==c.length&&(b=a.substring(b,g),""!=b&&d.push({type:0,value:b}),b=g+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d}
var ye=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,ze=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Ae=/^\s*(\w+)\s*,\s*select\s*,/;
function se(a,b){for(var c=[],d=xe(b),e=0;e<d.length;e++){var f={};if(0==d[e].type)f.type=4,f.value=d[e].value;else if(1==d[e].type){var g=d[e].value;switch(ye.test(g)?0:ze.test(g)?1:Ae.test(g)?2:/^\s*\w+\s*/.test(g)?3:5){case 2:f.type=2;f.value=Be(a,d[e].value);break;case 0:f.type=0;f.value=Ce(a,d[e].value);break;case 1:f.type=1;f.value=De(a,d[e].value);break;case 3:f.type=3;f.value=d[e].value;break;default:Na("Unknown block type.")}}else Na("Unknown part of the pattern.");c.push(f)}return c}
function Be(a,b){var c="";b=b.replace(Ae,function(a,b){c=b;return""});var d={};d.td=c;for(var e=xe(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=se(a,e[f].value);else Na("Expected block type.");d[g.replace(/\s/g,"")]=k;f++}return d}
function Ce(a,b){var c="",d=0;b=b.replace(ye,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.td=c;e.Vf=d;for(var f=xe(b),g=0;g<f.length;){var k=f[g].value;g++;if(1==f[g].type)var l=se(a,f[g].value);else Na("Expected block type.");e[k.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=l;g++}return e}
function De(a,b){var c="";b=b.replace(ze,function(a,b){c=b;return""});var d={};d.td=c;d.Vf=0;for(var e=xe(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=se(a,e[f].value);else Na("Expected block type.");d[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return d}qe.prototype.h=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};function Ee(a,b,c){a=new qe(a);b={COUNT:b,TEXT:c};if(0==a.i.length)a="";else{c=[];ve(a,a.i,b,!1,c);for(b=c.join("");0<a.g.length;)b=b.replace(a.h(a.g),a.g.pop());a=b}return a};function Fe(a){this.g=new md;if(a){a=ed(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])}}function Ge(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+ha(a):b.substr(0,1)+a}h=Fe.prototype;h.ca=function(){return this.g.ca()};h.add=function(a){this.g.set(Ge(a),a)};h.removeAll=function(a){a=ed(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};h.remove=function(a){return this.g.remove(Ge(a))};h.clear=function(){this.g.clear()};h.Oa=function(){return this.g.Oa()};
h.contains=function(a){a=Ge(a);return od(this.g.h,a)};h.Aa=function(){return this.g.Aa()};h.ga=function(){return new Fe(this)};h.Kb=function(){return this.g.Kb(!1)};function He(a){return Ie(a||arguments.callee.caller,[])}
function Ie(a,b){var c=[];if(Xa(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Je(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Je(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Ie(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Je(a){if(Ke[a])return Ke[a];a=String(a);if(!Ke[a]){var b=/function ([^\(]+)/.exec(a);Ke[a]=b?b[1]:"[Anonymous]"}return Ke[a]}var Ke={};function Le(a,b,c,d,e){this.o="number"==typeof e?e:Me++;this.l=d||B();this.j=a;this.p=b;this.h=c;delete this.i;delete this.g}Le.prototype.o=0;Le.prototype.i=null;Le.prototype.g=null;var Me=0;Le.prototype.getMessage=function(){return this.p};function Ne(a){this.l=a}Ne.prototype.i=null;Ne.prototype.h=null;Ne.prototype.j=null;Ne.prototype.g=null;function Oe(a,b){this.name=a;this.value=b}Oe.prototype.toString=function(){return this.name};var Pe=new Oe("SHOUT",1200),Qe=new Oe("SEVERE",1E3),Re=new Oe("WARNING",900),Se=new Oe("INFO",800),Te=new Oe("CONFIG",700),Ue=new Oe("FINE",500),Ve=new Oe("FINER",400),We=new Oe("FINEST",300),Xe=[new Oe("OFF",Infinity),Pe,Qe,Re,Se,Te,Ue,Ve,We,new Oe("ALL",0)],Ye=null;h=Ne.prototype;h.getName=function(){return this.l};
function Ze(a,b){a.g||(a.g=[]);a.g.push(b)}h.getParent=function(){return this.i};h.getChildren=function(){this.j||(this.j={});return this.j};function $e(a){if(a.h)return a.h;if(a.i)return $e(a.i);Na("Root logger has no level set.");return null}
h.log=function(a,b,c){if(a.value>=$e(this).value)for(ga(b)&&(b=b()),a=this.bh(a,b,c),b="log:"+a.getMessage(),q.console&&(q.console.timeStamp?q.console.timeStamp(b):q.console.markTimeline&&q.console.markTimeline(b)),q.msWriteProfilerMark&&q.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.g)for(var e=0,f=void 0;f=c.g[e];e++)f(d);b=b.getParent()}};
h.bh=function(a,b,c){var d=new Le(a,String(b),this.l);if(c){d.i=c;var e;var f=arguments.callee.caller;try{var g;var k=ba("window.location.href");if(w(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var l,m,n=!1;try{l=c.lineNumber||c.ui||"Not available"}catch(p){l="Not available",n=!0}try{m=c.fileName||c.filename||c.sourceURL||q.$googDebugFname||k}catch(r){m="Not available",n=!0}g=!n&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||
"Not available",name:c.name||"UnknownError",lineNumber:l,fileName:m,stack:c.stack||"Not available"}}e="Message: "+za(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+za(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+za(He(f)+"-> ")}catch(t){e="Exception trying to expose exception! You win, we lose. "+t}d.g=e}return d};function M(a,b,c){a.log(Re,b,c)}h.info=function(a,b){this.log(Se,a,b)};
function af(a,b,c){a.log(Ue,b,c)}function N(a,b){a.log(Ve,b,void 0)}function O(a,b){a.log(We,b,void 0)}var bf={},cf=null;function df(){cf||(cf=new Ne(""),bf[""]=cf,cf.h=Te)}function ef(){df();return cf}function P(a){df();var b;if(!(b=bf[a])){b=new Ne(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=P(a.substr(0,c));c.getChildren()[d]=b;b.i=c;bf[a]=b}return b};function ff(a){ub.call(this);this.h=a;this.g={}}C(ff,ub);var gf=[];h=ff.prototype;h.listen=function(a,b,c,d){u(b)||(gf[0]=b,b=gf);for(var e=0;e<b.length;e++){var f=yc(a,b[e],c||this.handleEvent,d||!1,this.h||this);if(!f)break;this.g[f.key]=f}return this};h.xa=function(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)this.xa(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.h||this,c=zc(c),d=!!d,b=dc(a)?uc(a.sb,String(b),c,d,e):a?(a=Cc(a))?uc(a,b,c,d,e):null:null,b&&(Hc(b),delete this.g[b.key]);return this};
h.removeAll=function(){hc(this.g,Hc);this.g={}};h.J=function(){ff.m.J.call(this);this.removeAll()};h.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function hf(a,b){Lc.call(this);this.h=a||1;this.g=b||q;this.i=ma(this.Th,this);this.j=B()}C(hf,Lc);h=hf.prototype;h.Vc=!1;h.da=null;h.setInterval=function(a){this.h=a;this.da&&this.Vc?(this.stop(),jf(this)):this.da&&this.stop()};h.Th=function(){if(this.Vc){var a=B()-this.j;0<a&&a<0.8*this.h?this.da=this.g.setTimeout(this.i,this.h-a):(this.da&&(this.g.clearTimeout(this.da),this.da=null),this.dispatchEvent(kf),this.Vc&&(this.da=this.g.setTimeout(this.i,this.h),this.j=B()))}};
function jf(a){a.Vc=!0;a.da||(a.da=a.g.setTimeout(a.i,a.h),a.j=B())}h.stop=function(){this.Vc=!1;this.da&&(this.g.clearTimeout(this.da),this.da=null)};h.J=function(){hf.m.J.call(this);this.stop();delete this.g};var kf="tick";function lf(a,b,c){if(ga(a))c&&(a=ma(a,c));else if(a&&"function"==typeof a.handleEvent)a=ma(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:q.setTimeout(a,b||0)};function mf(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return JSON.parse(a)}catch(b){}throw Error("Invalid JSON string: "+a);}function nf(){}function of(a,b){var c=[];pf(a,b,c);return c.join("")}
function pf(a,b,c){switch(typeof b){case "string":qf(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(u(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),pf(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),qf(e,c),c.push(":"),pf(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var rf={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},sf=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function qf(a,b){b.push('"',a.replace(sf,function(a){if(a in rf)return rf[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return rf[a]=e+b.toString(16)}),'"')};function tf(a,b){a&&af(a,b,void 0)};function uf(){}uf.prototype.g=null;function vf(a){var b;(b=a.g)||(b={},wf(a)&&(b[0]=!0,b[1]=!0),b=a.g=b);return b};var xf;function yf(){}C(yf,uf);function zf(a){return(a=wf(a))?new ActiveXObject(a):new XMLHttpRequest}function wf(a){if(!a.h&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.h=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.h}xf=new yf;function Af(a){Lc.call(this);this.headers=new md;this.ea=a||null;this.h=!1;this.Z=this.S=null;this.Wa=this.t="";this.o=0;this.p="";this.i=this.Ja=this.G=this.na=!1;this.l=0;this.N=null;this.j=Bf;this.T=this.od=!1}C(Af,Lc);var Bf="";Af.prototype.g=P("goog.net.XhrIo");var Cf=/^https?$/i,Df=["POST","PUT"];h=Af.prototype;h.fg=function(){return this.j};
h.send=function(a,b,c,d){if(this.S)throw Error("[goog.net.XhrIo] Object is active with another request="+this.t+"; newUri="+a);b=b?b.toUpperCase():"GET";this.t=a;this.p="";this.o=0;this.Wa=b;this.na=!1;this.h=!0;this.S=this.ea?zf(this.ea):zf(xf);this.Z=this.ea?vf(this.ea):vf(xf);this.S.onreadystatechange=ma(this.wg,this);try{tf(this.g,Ef(this,"Opening Xhr")),this.Ja=!0,this.S.open(b,a,!0),this.Ja=!1}catch(e){tf(this.g,Ef(this,"Error opening Xhr: "+e.message));Ff(this,e);return}a=c||"";var f=this.headers.ga();
d&&fd(d,function(a,b){f.set(b,a)});d=Va(f.Qa(),Gf);c=q.FormData&&a instanceof q.FormData;!Xa(Df,b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");fd(f,function(a,b){this.S.setRequestHeader(b,a)},this);this.j&&(this.S.responseType=this.j);"withCredentials"in this.S&&(this.S.withCredentials=this.od);try{Hf(this),0<this.l&&(this.T=If(this.S),tf(this.g,Ef(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.T)),this.T?(this.S.timeout=this.l,this.S.ontimeout=ma(this.Bg,
this)):this.N=lf(this.Bg,this.l,this)),tf(this.g,Ef(this,"Sending request")),this.G=!0,this.S.send(a),this.G=!1}catch(g){tf(this.g,Ef(this,"Send error: "+g.message)),Ff(this,g)}};function If(a){return H&&Tb(9)&&y(a.timeout)&&s(a.ontimeout)}function Gf(a){return"content-type"==a.toLowerCase()}h.Bg=function(){"undefined"!=typeof aa&&this.S&&(this.p="Timed out after "+this.l+"ms, aborting",this.o=8,tf(this.g,Ef(this,this.p)),this.dispatchEvent("timeout"),this.abort(8))};
function Ff(a,b){a.h=!1;a.S&&(a.i=!0,a.S.abort(),a.i=!1);a.p=b;a.o=5;Jf(a);Kf(a)}function Jf(a){a.na||(a.na=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}h.abort=function(a){this.S&&this.h&&(tf(this.g,Ef(this,"Aborting")),this.h=!1,this.i=!0,this.S.abort(),this.i=!1,this.o=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Kf(this))};h.J=function(){this.S&&(this.h&&(this.h=!1,this.i=!0,this.S.abort(),this.i=!1),Kf(this,!0));Af.m.J.call(this)};
h.wg=function(){this.H||(this.Ja||this.G||this.i?Lf(this):this.Oh())};h.Oh=function(){Lf(this)};function Lf(a){if(a.h&&"undefined"!=typeof aa)if(a.Z[1]&&4==Mf(a)&&2==a.P())tf(a.g,Ef(a,"Local request error detected and ignored"));else if(a.G&&4==Mf(a))lf(a.wg,0,a);else if(a.dispatchEvent("readystatechange"),4==Mf(a)){tf(a.g,Ef(a,"Request complete"));a.h=!1;try{a.Fa()?(a.dispatchEvent("complete"),a.dispatchEvent("success")):(a.o=6,a.p=a.La()+" ["+a.P()+"]",Jf(a))}finally{Kf(a)}}}
function Kf(a,b){if(a.S){Hf(a);var c=a.S,d=a.Z[0]?ca:null;a.S=null;a.Z=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){(c=a.g)&&c.log(Qe,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Hf(a){a.S&&a.T&&(a.S.ontimeout=null);y(a.N)&&(q.clearTimeout(a.N),a.N=null)}
h.Fa=function(){var a=this.P(),b;a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}if(!b){if(a=0===a)a=qd(String(this.t))[1]||null,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),a=!Cf.test(a?a.toLowerCase():"");b=a}return b};function Mf(a){return a.S?a.S.readyState:0}h.P=function(){try{return 2<Mf(this)?this.S.status:-1}catch(a){var b=this.g;b&&M(b,"Can not get status: "+a.message,void 0);return-1}};
h.La=function(){try{return 2<Mf(this)?this.S.statusText:""}catch(a){return tf(this.g,"Can not get status: "+a.message),""}};
function Nf(a){try{if(!a.S)return null;if("response"in a.S)return a.S.response;switch(a.j){case Bf:case "text":return a.S.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.S)return a.S.mozResponseArrayBuffer}var b=a.g;b&&b.log(Qe,"Response type "+a.j+" is not supported on this browser",void 0);return null}catch(c){return tf(a.g,"Can not get response: "+c.message),null}}function Ef(a,b){return b+" ["+a.Wa+" "+a.t+" "+a.P()+"]"};function Of(){this.i=this.h=0;this.g=[]}function Pf(a){if(a.h!=a.i){var b=a.g[a.h];delete a.g[a.h];a.h++;return b}}h=Of.prototype;h.ca=function(){return this.i-this.h};h.Oa=function(){return 0==this.i-this.h};h.clear=function(){this.i=this.h=this.g.length=0};h.contains=function(a){return Xa(this.g,a)};h.remove=function(a){a=Pa(this.g,a);if(0>a)return!1;a==this.h?Pf(this):($a(this.g,a),this.i--);return!0};h.Aa=function(){return this.g.slice(this.h,this.i)};function Qf(a,b){ub.call(this);this.o=a||0;this.i=b||10;if(this.o>this.i)throw Error(Rf);this.g=new Of;this.h=new Fe;this.l=null;this.qd()}C(Qf,ub);var Rf="[goog.structs.Pool] Min can not be greater than max";h=Qf.prototype;h.Kd=function(){var a=B();if(!(null!=this.l&&0>a-this.l)){for(var b;0<this.g.ca()&&(b=Pf(this.g),!this.sf(b));)this.qd();!b&&this.ca()<this.i&&(b=this.Pe());b&&(this.l=a,this.h.add(b));return b}};h.be=function(a){return this.h.remove(a)?(this.ue(a),!0):!1};
h.ue=function(a){this.h.remove(a);if(this.sf(a)&&this.ca()<this.i){var b=this.g;b.g[b.i++]=a}else Sf(a)};h.qd=function(){for(var a=this.g;this.ca()<this.o;){var b=this.Pe();a.g[a.i++]=b}for(;this.ca()>this.i&&0<this.g.ca();)Sf(Pf(a))};h.Pe=function(){return{}};function Sf(a){if("function"==typeof a.oa)a.oa();else for(var b in a)a[b]=null}h.sf=function(a){return"function"==typeof a.Wg?a.Wg():!0};h.contains=function(a){return this.g.contains(a)||this.h.contains(a)};
h.ca=function(){return this.g.ca()+this.h.ca()};h.Oa=function(){return this.g.Oa()&&this.h.Oa()};h.J=function(){Qf.m.J.call(this);if(0<this.h.ca())throw Error("[goog.structs.Pool] Objects not released");delete this.h;for(var a=this.g;!a.Oa();)Sf(Pf(a));delete this.g};function Tf(a,b){this.g=a;this.h=b}Tf.prototype.V=function(){return this.h};Tf.prototype.ga=function(){return new Tf(this.g,this.h)};function Uf(a){this.g=[];if(a)a:{var b,c;if(a instanceof Uf){if(b=a.Qa(),c=a.Aa(),0>=a.ca()){a=this.g;for(var d=0;d<b.length;d++)a.push(new Tf(b[d],c[d]));break a}}else b=jc(a),c=ic(a);for(d=0;d<b.length;d++)Vf(this,b[d],c[d])}}function Vf(a,b,c){var d=a.g;d.push(new Tf(b,c));b=d.length-1;a=a.g;for(c=a[b];0<b;)if(d=b-1>>1,a[d].g>c.g)a[b]=a[d],b=d;else break;a[b]=c}h=Uf.prototype;
h.remove=function(){var a=this.g,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Ya(a);else{a[0]=a.pop();for(var a=0,b=this.g,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,g=2*a+2,f=g<d&&b[g].g<b[f].g?g:f;if(b[f].g>e.g)break;b[a]=b[f];a=f}b[a]=e}return c.V()}};h.Aa=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].V());return b};h.Qa=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].g);return b};h.ga=function(){return new Uf(this)};h.ca=function(){return this.g.length};
h.Oa=function(){return 0==this.g.length};h.clear=function(){Ya(this.g)};function Wf(){Uf.call(this)}C(Wf,Uf);function Xf(a,b){this.j=new Wf;Qf.call(this,a,b)}C(Xf,Qf);h=Xf.prototype;h.Kd=function(a,b){if(!a)return Xf.m.Kd.call(this);Vf(this.j,s(b)?b:100,a);this.ef()};h.ef=function(){for(var a=this.j;0<a.ca();){var b=this.Kd();if(b)a.remove().apply(this,[b]);else break}};h.ue=function(a){Xf.m.ue.call(this,a);this.ef()};h.qd=function(){Xf.m.qd.call(this);this.ef()};h.J=function(){Xf.m.J.call(this);q.clearTimeout(void 0);this.j.clear();this.j=null};function Yf(a,b,c){Xf.call(this,b,c);this.p=a}C(Yf,Xf);Yf.prototype.Pe=function(){var a=new Af,b=this.p;b&&fd(b,function(b,d){a.headers.set(d,b)});return a};Yf.prototype.sf=function(a){return!a.H&&!a.S};function Zf(a,b,c,d,e){Lc.call(this);this.i=s(a)?a:1;this.j=s(e)?Math.max(0,e):0;this.Ic=new Yf(b,c,d);this.g=new md;this.h=new ff(this)}C(Zf,Lc);var $f="ready complete success error abort timeout".split(" ");h=Zf.prototype;h.send=function(a,b,c,d,e,f,g,k,l){if(this.g.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new ag(b,ma(this.th,this,a),c,d,e,g,s(k)?k:this.i,l);this.g.set(a,b);a=ma(this.lh,this,a);this.Ic.Kd(a,f);return b};
h.abort=function(a,b){var c=this.g.get(a);if(c){var d=c.je;c.Sf=!0;b&&(d&&(this.h.xa(d,$f,c.ie),Fc(d,"ready",function(){this.Ic.be(d)},!1,this)),this.g.remove(a));d&&d.abort()}};h.lh=function(a,b){var c=this.g.get(a);c&&!c.je?(this.h.listen(b,$f,c.ie),b.l=Math.max(0,this.j),b.j=c.fg(),c.je=b,this.dispatchEvent(new bg("ready",this,a,b)),cg(this,a,b),c.Sf&&b.abort()):this.Ic.be(b)};
h.th=function(a,b){var c=b.target;switch(b.type){case "ready":cg(this,a,c);break;case "complete":a:{var d=this.g.get(a);if(7==c.o||c.Fa()||d.ud>d.Ne)if(this.dispatchEvent(new bg("complete",this,a,c)),d&&(d.ag=!0,d.ze)){c=d.ze.call(c,b);break a}c=null}return c;case "success":this.dispatchEvent(new bg("success",this,a,c));break;case "timeout":case "error":d=this.g.get(a);d.ud>d.Ne&&this.dispatchEvent(new bg("error",this,a,c));break;case "abort":this.dispatchEvent(new bg("abort",this,a,c))}return null};
function cg(a,b,c){var d=a.g.get(b);!d||d.ag||d.ud>d.Ne?(d&&(a.h.xa(c,$f,d.ie),a.g.remove(b)),a.Ic.be(c)):(d.ud++,c.send(d.Vh,d.Hd(),d.pa(),d.Tc()))}h.J=function(){Zf.m.J.call(this);this.Ic.oa();this.Ic=null;this.h.oa();this.h=null;var a=this.g;fd(a,function(a){a.oa()});a.clear();this.g=null};function bg(a,b,c,d){K.call(this,a,b);this.id=c;this.je=d}C(bg,K);
function ag(a,b,c,d,e,f,g,k){ub.call(this);this.Vh=a;this.i=c||"GET";this.g=d;this.h=e||null;this.Ne=s(g)?g:1;this.ud=0;this.Sf=this.ag=!1;this.ie=b;this.ze=f;this.j=k||Bf;this.je=null}C(ag,ub);h=ag.prototype;h.Hd=function(){return this.i};h.pa=function(){return this.g};h.Tc=function(){return this.h};h.fg=function(){return this.j};h.J=function(){ag.m.J.call(this);delete this.ie;delete this.ze};function dg(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b};function eg(){this.i=[];this.h=this.g=0};function fg(){};function gg(){this.g=[];this.j=[];this.o=[];this.i=[];this.i[0]=128;for(var a=1;64>a;++a)this.i[a]=0;this.g[0]=1732584193;this.g[1]=4023233417;this.g[2]=2562383102;this.g[3]=271733878;this.g[4]=3285377520;this.l=this.h=0}C(gg,fg);
function hg(a,b,c){c||(c=0);var d=a.o;if(w(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.g[0];c=a.g[1];for(var g=a.g[2],k=a.g[3],l=a.g[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.g[0]=a.g[0]+b&4294967295;a.g[1]=a.g[1]+c&4294967295;a.g[2]=a.g[2]+g&4294967295;a.g[3]=a.g[3]+k&4294967295;a.g[4]=a.g[4]+l&4294967295}
gg.prototype.update=function(a,b){s(b)||(b=a.length);for(var c=b-64,d=0,e=this.j,f=this.h;d<b;){if(0==f)for(;d<=c;)hg(this,a,d),d+=64;if(w(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){hg(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){hg(this,e);f=0;break}}this.h=f;this.l+=b};
function ig(a){var b=[],c=8*a.l;56>a.h?a.update(a.i,56-a.h):a.update(a.i,64-(a.h-56));for(var d=63;56<=d;d--)a.j[d]=c&255,c/=256;hg(a,a.j);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.g[d]>>e&255,++c;return b};var jg=null,kg=null;function lg(a){this.g=a;this.h=new nf}lg.prototype.set=function(a,b){s(b)?this.g.set(a,of(this.h,b)):this.g.remove(a)};lg.prototype.get=function(a){var b;try{b=this.g.get(a)}catch(c){return}if(null!==b)try{return mf(b)}catch(d){throw"Storage: Invalid value was encountered";}};lg.prototype.remove=function(a){this.g.remove(a)};function mg(){};function ng(a){lg.call(this,a)}C(ng,lg);function og(a){this.data=a}function pg(a){return!s(a)||a instanceof og?a:new og(a)}function qg(a){a=a.data;if(!s(a))throw"Storage: Invalid value was encountered";return a}ng.prototype.set=function(a,b){ng.m.set.call(this,a,pg(b))};ng.prototype.Uc=function(a){a=ng.m.get.call(this,a);if(!s(a)||a instanceof Object)return a;throw"Storage: Invalid value was encountered";};ng.prototype.get=function(a){return(a=this.Uc(a))?qg(a):void 0};function rg(a){lg.call(this,a)}C(rg,ng);rg.prototype.set=function(a,b,c){if(b=pg(b)){if(c){if(c<B()){rg.prototype.remove.call(this,a);return}b.expiration=c}b.creation=B()}rg.m.set.call(this,a,b)};rg.prototype.Uc=function(a,b){var c=rg.m.Uc.call(this,a);if(c){var d;if(d=!b){d=c.creation;var e=c.expiration;d=!!e&&e<B()||!!d&&d>B()}if(d)rg.prototype.remove.call(this,a);else return c}};function sg(a){lg.call(this,a)}C(sg,rg);function tg(){}C(tg,mg);tg.prototype.ca=function(){var a=0;kd(this.Kb(!0),function(){a++});return a};tg.prototype.clear=function(){var a=ld(this.Kb(!0)),b=this;Qa(a,function(a){b.remove(a)})};function ug(a,b){lg.call(this,a);this.Oe=dg(b);this.Zf=new nf}C(ug,sg);h=ug.prototype;h.Oe=null;h.Zf=null;
function vg(a,b){var c=new gg;c.update(dg(b));c.update(a.Oe);c=ig(c);if(!v(c))throw Error("encodeByteArray takes an array as a parameter");if(!jg){jg={};kg={};for(var d=0;65>d;d++)jg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d),kg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(d)}for(var d=kg,e=[],f=0;f<c.length;f+=3){var g=c[f],k=f+1<c.length,l=k?c[f+1]:0,m=f+2<c.length,n=m?c[f+2]:0,p=g>>2,g=(g&3)<<4|l>>4,l=(l&15)<<2|n>>6,n=n&63;
m||(n=64,k||(l=64));e.push(d[p],d[g],d[l],d[n])}return e.join("")}
function wg(a,b,c,d){if(!(0<b.length))throw Error("Non-empty salt must be provided");var e=new gg;e.update(dg(c));e.update(b);e.update(a.Oe);a=new eg;var e=ig(e),f;f||(f=e.length);b=a.i;for(c=0;256>c;++c)b[c]=c;var g=0;for(c=0;256>c;++c){var g=g+b[c]+e[c%f]&255,k=b[c];b[c]=b[g];b[g]=k}a.g=0;a.h=0;f=a.g;e=a.h;b=a.i;for(c=0;1536>c;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=g;a.g=f;a.h=e;d=dg(d);var l;l||(l=d.length);f=a.g;e=a.h;b=a.i;for(c=0;c<l;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=
g,d[c]^=b[b[f]+b[e]&255];a.g=f;a.h=e;return String.fromCharCode.apply(null,d)}h.set=function(a,b,c){if(s(b)){for(var d=[],e=0;8>e;++e)d[e]=Math.floor(256*Math.random());b=new og(wg(this,d,a,of(this.Zf,b)));b.salt=d;ug.m.set.call(this,vg(this,a),b,c)}else ug.prototype.remove.call(this,a)};
h.Uc=function(a,b){var c=ug.m.Uc.call(this,vg(this,a),b);if(c){var d=qg(c),e=c.salt;if(!w(d)||!u(e)||!e.length)throw"Storage: Invalid value was encountered";d=wg(this,e,a,d);try{c.data=mf(d)}catch(f){throw"Storage: The value could not be decrypted";}return c}};h.remove=function(a){ug.m.remove.call(this,vg(this,a))};function xg(a){this.g=a}C(xg,tg);h=xg.prototype;h.set=function(a,b){try{this.g.setItem(a,b)}catch(c){if(0==this.g.length)throw"Storage mechanism: Storage disabled";throw"Storage mechanism: Quota exceeded";}};h.get=function(a){a=this.g.getItem(a);if(!w(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return a};h.remove=function(a){this.g.removeItem(a)};h.ca=function(){return this.g.length};
h.Kb=function(a){var b=0,c=this.g,d=new hd;d.g=function(){if(b>=c.length)throw gd;var d=c.key(b++);if(a)return d;d=c.getItem(d);if(!w(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};h.clear=function(){this.g.clear()};h.key=function(a){return this.g.key(a)};function yg(){var a=null;try{a=window.localStorage||null}catch(b){}this.g=a}C(yg,xg);var zg=!H||H&&9<=Vb,Ag=!Hb&&!H||H&&H&&9<=Vb||Hb&&Tb("1.9.1"),Bg=H&&!Tb("9");function Cg(a){a=a.className;return w(a)&&a.match(/\S+/g)||[]}function Dg(a,b){for(var c=Cg(a),d=eb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)Xa(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function Eg(a,b){var c=Cg(a),d=eb(arguments,1),e=Fg(c,d);a.className=e.join(" ");return e.length==c.length-d.length}function Fg(a,b){return Ra(a,function(a){return!Xa(b,a)})};function Gg(a,b){this.x=s(a)?a:0;this.y=s(b)?b:0}Gg.prototype.ga=function(){return new Gg(this.x,this.y)};Gg.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Hg(a,b){return new Gg(a.x-b.x,a.y-b.y)}Gg.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};Gg.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function Ig(a,b){this.width=a;this.height=b}h=Ig.prototype;h.ga=function(){return new Ig(this.width,this.height)};h.toString=function(){return"("+this.width+" x "+this.height+")"};h.Oa=function(){return!(this.width*this.height)};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Jg(a){return a?new Kg(Lg(a)):ra||(ra=new Kg)}function Mg(a,b){var c=b||document,d=null;c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):(c=b||document,d=(c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):Ng(document,"*",a,b))[0]);return d||null}
function Ng(a,b,c,d){a=d||a;b=b&&"*"!=b?b.toUpperCase():"";if(a.querySelectorAll&&a.querySelector&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){d={};for(var e=0,f=0,g;g=a[f];f++)b==g.nodeName&&(d[e++]=g);d.length=e;return d}return a}a=a.getElementsByTagName(b||"*");if(c){d={};for(f=e=0;g=a[f];f++)b=g.className,"function"==typeof b.split&&Xa(b.split(/\s+/),c)&&(d[e++]=g);d.length=e;return d}return a}
function Og(a,b){hc(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Pg?a.setAttribute(Pg[d],b):sa(d,"aria-")||sa(d,"data-")?a.setAttribute(d,b):a[d]=b})}var Pg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Qg(a){return Ib||"CSS1Compat"!=a.compatMode?a.body||a.documentElement:a.documentElement}function Rg(a){return a.parentWindow||a.defaultView}function Sg(a,b,c){function d(c){c&&b.appendChild(w(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!v(f)||A(f)&&0<f.nodeType?d(f):Qa(Tg(f)?bb(f):f,d)}}function Ug(a){for(var b;b=a.firstChild;)a.removeChild(b)}function Vg(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)}function Wg(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function Xg(a){if(void 0!=a.firstElementChild)a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Yg(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Lg(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function Zg(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else Ug(a),a.appendChild(Lg(a).createTextNode(String(b)))}var $g={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},ah={IMG:" ",BR:"\n"};function bh(a){a=a.getAttributeNode("tabindex");return null!=a&&a.specified}function ch(a){a=a.tabIndex;return y(a)&&0<=a&&32768>a}
function dh(a){var b=[];eh(a,b,!1);return b.join("")}function eh(a,b,c){if(!(a.nodeName in $g))if(3==a.nodeType)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in ah)b.push(ah[a.nodeName]);else for(a=a.firstChild;a;)eh(a,b,c),a=a.nextSibling}function Tg(a){if(a&&"number"==typeof a.length){if(A(a))return"function"==typeof a.item||"string"==typeof a.item;if(ga(a))return"function"==typeof a.item}return!1}
function fh(a,b,c){if(!b&&!c)return null;var d=b?b.toUpperCase():null;return gh(a,function(a){var b;if(b=!d||a.nodeName==d)(b=!c)||(b=Xa(Cg(a),c));return b})}function hh(a){return fh(a,null,"sidebar")}function gh(a,b){for(var c=0;a;){if(b(a))return a;a=a.parentNode;c++}return null}function Kg(a){this.g=a||q.document||document}h=Kg.prototype;h.n=function(a){return w(a)?this.g.getElementById(a):a};
h.s=function(a,b,c){var d=this.g,e=arguments,f=e[0],g=e[1];if(!zg&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',za(g.name),'"');if(g.type){f.push(' type="',za(g.type),'"');var k={};pc(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=d.createElement(f);g&&(w(g)?f.className=g:u(g)?Dg.apply(null,[f].concat(g)):Og(f,g));2<e.length&&Sg(d,f,e);return f};h.createElement=function(a){return this.g.createElement(a)};function ih(a){return"CSS1Compat"==a.g.compatMode}
function jh(a){var b=a.g;a=Qg(b);b=Rg(b);return H&&Tb("10")&&b.pageYOffset!=a.scrollTop?new Gg(a.scrollLeft,a.scrollTop):new Gg(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}h.appendChild=function(a,b){a.appendChild(b)};h.Jh=Vg;h.getChildren=function(a){return Ag&&void 0!=a.children?a.children:Ra(a.childNodes,function(a){return 1==a.nodeType})};h.eg=Xg;h.contains=Yg;H&&Tb(8);function kh(a,b,c){ub.call(this);this.h=a;this.o=b||0;this.i=c;this.l=ma(this.j,this)}C(kh,ub);kh.prototype.g=0;kh.prototype.J=function(){kh.m.J.call(this);this.stop();delete this.h;delete this.i};function lh(a){a.stop();a.g=lf(a.l,s(void 0)?void 0:a.o)}kh.prototype.stop=function(){0!=this.g&&q.clearTimeout(this.g);this.g=0};function mh(a){a.stop();a.j()}kh.prototype.j=function(){this.g=0;this.h&&this.h.call(this.i)};function nh(a,b,c){ub.call(this);this.j=a;this.i=b;this.h=c;this.g=ma(this.Qh,this)}C(nh,ub);h=nh.prototype;h.fe=!1;h.da=null;function oh(a){a.da?a.fe=!0:ph(a)}h.stop=function(){this.da&&(q.clearTimeout(this.da),this.da=null,this.fe=!1)};h.J=function(){nh.m.J.call(this);this.stop()};h.Qh=function(){this.da=null;this.fe&&(this.fe=!1,ph(this))};function ph(a){a.da=lf(a.g,a.i);a.j.call(a.h)};P("ydn");var qh=Math.pow(2,3),rh=Math.pow(2,6);function sh(){Lc.call(this);this.key=this.g=void 0}C(sh,Lc);sh.prototype.U=function(a,b){if("boolean"!=typeof b)throw Error("Invalid value");if("number"!=typeof a||0>a)throw Error("Invalid state");"undefined"==typeof this.g&&(this.g=0);this.g=b?this.g|a:this.g&~a};function th(a){a.U(qh,!0);lf(function(){this.dispatchEvent(uh)},0,a)}var uh="a";function vh(a,b,c){K.call(this,a,b);this.url=c}C(vh,K);P("ydn");function wh(a){return!w(a)||va(a)?{}:JSON.parse(a)}function xh(a){var b;try{b=yh(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function yh(a){return JSON.stringify(a,void 0,void 0)};P("ydn.Store");function zh(a,b){if(b&&!a)throw Error("Can't create document with namespace and no root tag");if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument(b||"",a||"",null);if("undefined"!=typeof ActiveXObject){var c=Ah();if(c)return a&&c.appendChild(c.createNode(1,a,b||"")),c}throw Error("Your browser does not support creating new documents");}
function Bh(a){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(a,"application/xml");if("undefined"!=typeof ActiveXObject){var b=Ah();b.loadXML(a);return b}throw Error("Your browser does not support loading xml documents");}function Ch(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if(a=a.xml)return a;throw Error("Your browser does not support serializing XML documents");}
function Ah(){var a=new ActiveXObject("MSXML2.DOMDocument");if(a){a.resolveExternals=!1;a.validateOnParse=!1;try{a.setProperty("ProhibitDTD",!0),a.setProperty("MaxXMLSize",2048),a.setProperty("MaxElementDepth",256)}catch(b){}}return a};function Dh(a){Error.captureStackTrace?Error.captureStackTrace(this,Dh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}C(Dh,Error);function Eh(a){Error.captureStackTrace?Error.captureStackTrace(this,Eh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}C(Dh,Error);Eh.prototype.name="ydn.error.NotSupportedException";
function Fh(a){Error.captureStackTrace?Error.captureStackTrace(this,Fh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}C(Fh,Error);function Gh(a){Error.captureStackTrace?Error.captureStackTrace(this,Gh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(Gh,Error);Gh.prototype.name="ydn.InternalError";
function Hh(a){Error.captureStackTrace?Error.captureStackTrace(this,Hh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}C(Hh,Error);Hh.prototype.name="ydn.error.ConstraintError";function Ih(a){Error.captureStackTrace?Error.captureStackTrace(this,Ih):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}C(Dh,Error);
function Jh(a){Error.captureStackTrace?Error.captureStackTrace(this,Jh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}C(Jh,Error);var Kh,Lh,Mh,Nh;Nh=Mh=Lh=Kh=!1;var Oh=Cb();Oh&&(-1!=Oh.indexOf("Firefox")?Kh=!0:-1!=Oh.indexOf("Camino")||(-1!=Oh.indexOf("iPhone")||-1!=Oh.indexOf("iPod")?Lh=!0:-1!=Oh.indexOf("iPad")?Mh=!0:-1!=Oh.indexOf("Chrome")&&(Nh=!0)));var Ph=Kh,Qh=Lh,Rh=Mh,Sh=Nh;function Th(a){if(!u(a))throw new Dh("Array required.");if(s(void 0))return a=Sa(a,function(a){return a[void 0]}),Th(a);for(var b=Number.NaN,c=-1,d=0;d<a.length;d++)!isNaN(a[d])&&(isNaN(b)||a[d]>b)&&(b=a[d],c=d);return{value:b,index:c}};function Uh(){sh.call(this);this.h=null;yc(this,"user-login",this.xg,!1,this);yc(this,"user-logout",this.xg,!1,this);this.p=window.top.location.href.replace(/[?#]\S+/,"")}C(Uh,sh);h=Uh.prototype;h.logger=P("ydn.api.AbstractUser");h.xg=function(){this.display?(this.display.i(this.l||""),this.isLogin()?this.j&&this.display.h(this.j):this.i&&this.display.g(this.i),O(this.logger,"Refreshed.")):O(this.logger,"No UI refreshed.")};
h.toJSON=function(){return{nickname:this.o,email:this.l,is_login:this.h,login_url:this.i,logout_url:this.j,user_id:this.user_id}};h.isLogin=function(){return!0===this.h};h.toString=function(){return"User:"+(!0===this.h?this.l:!1===this.h?"logout":"?")};h.ed=0;
function Vh(a,b){!b&&a.isLogin()?O(a.logger,"Already login"):(a.Bc||(a.Bc=new nh(function(){this.isLogin()?this.Bc.stop():1<this.ed?(M(this.logger,"Cannot login to the API server, tried "+this.ed+" times."),this.Bc.stop(),this.ed=0):(this.ed++,this.cd())},5E3,a)),a.ed=0,oh(a.Bc))}h.refresh=function(a){Vh(this,a)};function Wh(a,b,c){vh.call(this,a,b,c)}C(Wh,vh);function Xh(){Uh.call(this)}C(Xh,Uh);Xh.prototype.logger=P("ydn.api.User");
Xh.prototype.load=function(a){af(this.logger,"getting user info");if(a.logout_url)return this.o=a.nickname,this.l=a.email,this.user_id=a.user_id,this.h=a.is_login,this.j=a.logout_url,this.i=a.login_url,af(this.logger,a.email+" login"),this.j=a.logout_url,this.user_id=a.Id?a.Id.$t:void 0,this.h=!0,this.i=void 0,this.U(rh,!0),th(this),!0;a.login_url&&(af(this.logger,"NO user"),this.i=a.login_url,this.h=!1,this.l=this.user_id=this.j=this.o=void 0,this.U(rh,!0),th(this));return!1};
Xh.prototype.t=function(a,b){O(this.logger,"Receiving "+(b.Fa()?"":"fail")+" login info from server.");if(b.Fa()){var c=a.User;if(c){var d;d=this.load(c)?new Wh("user-login",this,this.j):new Wh("user-logout",this,this.i);lf(function(){this.dispatchEvent(d)},0,this)}}else M(this.logger,"Server return error with: "+b.La());this.Bc&&this.Bc.stop()};
function Yh(a,b){var c=new D,d=Zh($h);if(!d)return F("login server not available.");var e={pm:a.p,state:Math.random().toString().substr(2,6)};if(b)for(var f in b)e[f]=b[f];d.request(new ai("/rpc_login","GET",e)).execute(function(a,b){a?c.C(a.User):c.D(b)},a);return c}Xh.prototype.cd=function(){af(this.logger,"Sending login request.");var a=Zh($h),b=window.top.location.href.replace(/[?#]\S+/,"");a.request(new ai("/rpc_login","GET",{url:b})).execute(ma(this.t,this));return!1};function bi(){this.g=B()}var ci=new bi;bi.prototype.set=function(a){this.g=a};bi.prototype.get=function(){return this.g};function di(a){this.j=a||"";this.l=ci}di.prototype.g=!0;di.prototype.h=!1;function ei(a){a=new Date(a.l);return fi(a.getFullYear()-2E3)+fi(a.getMonth()+1)+fi(a.getDate())+" "+fi(a.getHours())+":"+fi(a.getMinutes())+":"+fi(a.getSeconds())+"."+fi(Math.floor(a.getMilliseconds()/10))}function fi(a){return 10>a?"0"+a:String(a)}function gi(a,b){var c=(a.l-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function hi(a){di.call(this,a)}C(hi,di);hi.prototype.h=!0;
hi.prototype.i=function(a){var b;switch(a.j.value){case Pe.value:b="dbg-sh";break;case Qe.value:b="dbg-sev";break;case Re.value:b="dbg-w";break;case Se.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.j," ");this.g&&c.push("[",ei(a),"] ");c.push("[",Ga(gi(a,this.l.get())),"s] ");c.push("[",za(a.h),"] ");c.push('<span class="',b,'">',ya(Ga(za(a.getMessage()))));this.h&&a.i&&c.push("<br>",ya(Ga(a.g||"")));c.push("</span>");c.push("<br>");return c.join("")};
function ii(a){di.call(this,a)}C(ii,di);ii.prototype.i=function(a){var b=[];b.push(this.j," ");this.g&&b.push("[",ei(a),"] ");b.push("[",gi(a,this.l.get()),"s] ");b.push("[",a.h,"] ");b.push(a.getMessage());this.h&&a.i&&b.push("\n",a.g);b.push("\n");return b.join("")};function ji(){this.j=ma(this.o,this);this.g=new ii;this.g.g=!1;this.h=this.g.h=!1;this.i="";this.l={}}function ki(a){var b=li;if(a!=b.h){var c=ef();a?Ze(c,b.j):(c=c.g)&&Za(c,b.j);b.h=a}}ji.prototype.o=function(a){if(!this.l[a.h]){var b=this.g.i(a),c=mi;if(c)switch(a.j){case Pe:ni(c,"info",b);break;case Qe:ni(c,"error",b);break;case Re:ni(c,"warn",b);break;default:ni(c,"debug",b)}else window.opera?window.opera.postError(b):this.i+=b}};var mi=window.console;
function ni(a,b,c){if(a[b])a[b](c);else a.log(c)};function oi(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}h=oi.prototype;h.ga=function(){return new oi(this.top,this.right,this.bottom,this.left)};h.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};h.contains=function(a){return this&&a?a instanceof oi?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1};
h.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};h.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};function pi(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}h=pi.prototype;h.ga=function(){return new pi(this.left,this.top,this.width,this.height)};h.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};h.contains=function(a){return a instanceof pi?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
h.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function qi(a,b){var c=Lg(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""}function ri(a,b){return qi(a,b)||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}
function si(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}H&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ti(a){if(H&&!(H&&8<=Vb))return a.offsetParent;var b=Lg(a),c=ri(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=ri(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}
function ui(a){for(var b=new oi(0,Infinity,Infinity,0),c=Jg(a),d=c.g.body,e=c.g.documentElement,f=Qg(c.g);a=ti(a);)if(!(H&&0==a.clientWidth||Ib&&0==a.clientHeight&&a==d||a==d||a==e||"visible"==ri(a,"overflow"))){var g=vi(a),k;k=a;if(Hb&&!Tb("1.9")){var l=parseFloat(qi(k,"borderLeftWidth"));if(wi(k))var m=k.offsetWidth-k.clientWidth-l-parseFloat(qi(k,"borderRightWidth")),l=l+m;k=new Gg(l,parseFloat(qi(k,"borderTopWidth")))}else k=new Gg(k.clientLeft,k.clientTop);g.x+=k.x;g.y+=k.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(Rg(c.g)||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new Ig(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}
function vi(a){var b,c=Lg(a),d=ri(a,"position"),e=Hb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Gg(0,0),g;b=c?Lg(c):document;g=!H||H&&9<=Vb||ih(Jg(b))?b.documentElement:b.body;if(a==g)return f;if(a.getBoundingClientRect)b=si(a),a=jh(Jg(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=
b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(Ib&&"fixed"==ri(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Gb||Ib&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=ti(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,Gb&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}function xi(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function yi(a){var b=zi;if("none"!=ri(a,"display"))return b(a);var c=a.style,d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}function zi(a){var b=a.offsetWidth,c=a.offsetHeight,d=Ib&&!b&&!c;return s(b)&&!d||!a.getBoundingClientRect?new Ig(b,c):(a=si(a),new Ig(a.right-a.left,a.bottom-a.top))}function Ai(a){var b=vi(a);a=yi(a);return new pi(b.x,b.y,a.width,a.height)}
function R(a,b){a.style.display=b?"":"none"}function wi(a){return"rtl"==ri(a,"direction")}var Bi=Hb?"MozUserSelect":Ib?"WebkitUserSelect":null;function Ci(a,b,c){c=c?null:a.getElementsByTagName("*");if(Bi){if(b=b?"none":"",a.style[Bi]=b,c){a=0;for(var d;d=c[a];a++)d.style[Bi]=b}}else if(H||Gb)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;d=c[a];a++)d.setAttribute("unselectable",b)}
function Di(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}function Ei(a,b){var c=a.currentStyle?a.currentStyle[b]:null;return c?Di(a,c):0}var Fi={thin:2,medium:4,thick:6};
function Gi(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:null))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:null;return c in Fi?Fi[c]:Di(a,c)}function Hi(a){if(H&&!(H&&9<=Vb)){var b=Gi(a,"borderLeft"),c=Gi(a,"borderRight"),d=Gi(a,"borderTop");a=Gi(a,"borderBottom");return new oi(d,c,a,b)}b=qi(a,"borderLeftWidth");c=qi(a,"borderRightWidth");d=qi(a,"borderTopWidth");a=qi(a,"borderBottomWidth");return new oi(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))}var Ii=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Ji(a){this.l=ma(this.o,this);this.h=new hi;this.i=this.h.g=!1;this.g=a;this.j=this.g.ownerDocument||this.g.document;a=Jg(this.g);var b=null,c=a.g;if(H&&c.createStyleSheet)a=b=c.createStyleSheet(),H&&s(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";else{c=Ng(a.g,"head",void 0,void 0)[0];c||(b=Ng(a.g,"body",void 0,void 0)[0],c=a.s("head"),b.parentNode.insertBefore(c,b));var d=b=a.s("style");H&&s(d.cssText)?d.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
d.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";a.appendChild(c,b)}this.g.className+=" logdiv"}
Ji.prototype.o=function(a){var b=100>=this.g.scrollHeight-this.g.scrollTop-this.g.clientHeight,c=this.j.createElement("div");c.className="logmsg";c.innerHTML=this.h.i(a);this.g.appendChild(c);b&&(this.g.scrollTop=this.g.scrollHeight)};Ji.prototype.clear=function(){this.g.innerHTML=""};var li=null,Ki=null;P("ydn.debug");function Li(a,b,c){if(y(b))b=new Oe("log",b);else if(w(b)){b=b.toUpperCase();if(!Ye){Ye={};for(var d=0,e;e=Xe[d];d++)Ye[e.value]=e,Ye[e.name]=e}b=Ye[b]||null}else b=Ue;P(a||"ydn").h=b;s(c)?Ki||(a=Ki=new Ji(c),!0!=a.i&&(c=ef(),Ze(c,a.l),a.i=!0),ef().h=Re):li||Ki||(li=new ji,ki(!0),ef().h=Re)}var Mi=null;function Ni(a){Mi&&setTimeout(function(){Mi.log(a)},10)};var $h="login",Oi=P("ydn.http"),Pi={},Qi=[];var Ri,Si={},Ti=[];function Ui(a,b){Si[b||"default"]=a}function Zh(a){if(!s(a))return Si["default"];for(var b=a,c=0;c<Ti.length;c++){var d=(0,Ti[c])(a);if(d){b=d;break}}return Si[b]||null}function Vi(){Ri||(Ri=new Zf);return Ri}function Wi(a,b,c,d){w(a)?this.Fc=a:(this.Fc=null,this.status=a,this.body=b,this.headers=c||{},this.g=d)}function Xi(a){if(a.Fc){var b=wh(a.Fc);b.gapiRequest&&(b=b.gapiRequest.data);a.status=b.status;a.g=b.statusText;a.headers=b.headers;a.body=b.body;a.Fc=null}}
Wi.prototype.P=function(){Xi(this);return this.status};Wi.prototype.Fa=function(){Xi(this);return 200<=this.status&&400>this.status};Wi.prototype.La=function(){Xi(this);return this.g||""};function Yi(a){Xi(a);return a.body}function Zi(a,b){Xi(a);return a.headers[b]}Wi.prototype.Tc=function(){Xi(this);return this.headers};
function $i(a){var b;Xi(a);"application/json"==Zi(a,"content-type")?b=!0:(b=a.body,b=w(b)&&!va(b)?/^[\],:{}\s]*$/.test(b.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")):!1);return b&&w(a.body)?JSON.parse(a.body):a.body}function aj(a){return a instanceof Wi?a:w(a)?new Wi(a):new Wi(a.status,a.body,a.headers,a.statusText)}
function ai(a,b,c,d,e){this.path=a;this.method=b?b.toUpperCase():"GET";this.params=c||{};this.headers=d||{};this.body=e}var bj=null;function cj(a,b,c,d){this.l=s(b)?b:Vi();this.j="sr"+dj++;this.o=c||0;this.p=!!d;this.g=a}var dj=0;cj.prototype.F=function(){return this.j};
cj.prototype.execute=function(a,b){var c=this.g,d=new sd(c.path),e;for(e in c.params)d.g.set(e,c.params[e]);this.l.send(this.j,d.toString(),c.method,c.body,c.headers,void 0,function(d){d=d.target;for(var e=(d.S&&4==Mf(d)?d.S.getAllResponseHeaders():"").split("\n"),k={},l=0;l<e.length;l++){var m=e[l].indexOf(":");0<m&&(k[e[l].substr(0,m).toLowerCase()]=e[l].substr(m+1).trim())}e=l=Nf(d);if(k["content-type"]&&/json/.test(k["content-type"]))if(A(l))e=l;else if(w(l))try{e=wh(l)}catch(n){e=l}k=new Wi(d.P(),
l,k,d.La());bj&&!k.Fa()&&bj.log({"class":"ydn.gdata.Entry",method:"commit",context:"HTTP request",HttpRequestData:{path:c.path,uri:String(d.t),method:c.method,params:c.params,headers:c.headers,body:c.body},HttpRespondData:{status:k.P(),statusText:k.La(),body:Yi(k),headers:k.Tc()}});a&&(a.call(b,e,k),a=null)},this.o,void 0,this.p);this.l=null};cj.prototype.toString=function(){return"HTTPRequest:"+this.j};function ej(a,b,c){this.h=a;this.i=b;this.g=null;this.Wh=s(c)?c:!0}ej.prototype.request=function(a){return new fj(a,this)};function fj(a,b){cj.call(this,a,b.i);this.parent=b}C(fj,cj);var hj=new Wi(0,null,null,"No access token");
fj.prototype.execute=function(a,b){function c(){this.Wh?d.g.headers.Authorization="Bearer "+d.parent.g.access_token:d.g.params.access_token=d.parent.g.access_token}var d=this;d.parent.g&&d.parent.g.expires>B()?(c(),fj.m.execute.call(this,function(e,f){401==f.P()?ij(d.parent.h).B(function(e){d.parent.g=e;c();fj.m.execute.call(d,a,b)},function(){d.parent.g=null;a.call(b,null,hj)},d):a.call(b,e,f)},this)):ij(this.parent.h).B(function(e){d.parent.g=e;c();fj.m.execute.call(this,a,b)},function(){d.parent.g=
null;a.call(b,null,hj)},this)};function S(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ga(Object.freeze)&&Object.freeze(this)}S.prototype.lower=void 0;S.prototype.upper=void 0;S.prototype.toJSON=function(){return jj(this)};function kj(a){return lj(a)}S.only=function(a){return new S(a,a,!1,!1)};S.bound=function(a,b,c,d){return new S(a,b,c,d)};S.upperBound=function(a,b){return new S(void 0,a,void 0,!!b)};S.lowerBound=function(a,b){return new S(a,void 0,!!b,void 0)};
function mj(a){var b;if(u(a))b=bb(a),b.push("\uffff");else if(w(a))b=a+"\uffff";else if(y(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return S.only(a);return S.bound(a,b,!1,!0)}function jj(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function nj(a){if(null==a)return null;if(a instanceof S)return a;if(A(a))return new S(a.lower,a.upper,a.lowerOpen,a.upperOpen);throw new L("Invalid key range: "+a+" of type "+typeof a);}
function lj(a){return null!=a?null!=a.upper&&null!=a.lower?oj.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?oj.upperBound(a.upper,a.upperOpen):null!=a.lower?oj.lowerBound(a.lower,a.lowerOpen):null:null}function pj(a){if(a instanceof S)return"";if(null!=a){if(A(a)){for(var b in a)if(a.hasOwnProperty(b)&&!Xa(["lower","upper","lowerOpen","upperOpen"],b))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
S.prototype.we=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return S.bound(b,c,d,e)};function qj(a){if(!a)return"";var b=a.lowerOpen?"(":"[";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function rj(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==sj(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(tj(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(tj(c.upper,b)))}else d.push(a+" = ?"),e.push(tj(c.lower,b))}var oj=q.IDBKeyRange||q.webkitIDBKeyRange||S;function uj(a,b){var c,d;2==arguments.length&&w(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=v(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],s(a));c++);return a}function vj(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)A(a[e])||(a[e]={}),a=a[e];a[d]=c}}var wj={};
function xj(a){a=[a];for(var b=new yj,c=0,d,e;void 0!==(e=a.pop());){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(wj);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),zj(b,e);else if(e instanceof Date)c+=2,b.write(c),zj(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>
2|255,(f|3)<<6)}c.write(0)}else if(e===wj)b.write(0);else return"";c=0}return b.trim().toString()}function Aj(a){for(var b=[],c=b,d=[],e,f,g=new Bj(a);null!=g.read();)if(0===g.current)c=d.pop();else{if(null===g.current)break;do{e=g.current/4|0;a=g.current%4;for(var k=0;k<e;k++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.current+4)g.read();else break}while(1);1===a?c.push(Cj(g)):2===a?c.push(new Date(Cj(g))):3===a?c.push(Dj(g)):0===a&&(c=d.pop())}return b[0]}
function zj(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Cj(a){var b=a.read()|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=a.read()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.read()|0):a.read()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Dj(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.read();if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Bj(a){this.current=null;this.g=a;this.h=this.g.length-1;this.index=-1}
Bj.prototype.read=function(){return this.current=this.index<this.h?parseInt(this.g[++this.index]+this.g[++this.index],16):null};function yj(){this.g=[];this.h=void 0}yj.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.h=arguments[b].toString(16),this.g.push(2===this.h.length?this.h:this.h="0"+this.h)};yj.prototype.trim=function(){for(var a=this.g.length;"00"===this.g[--a];);this.g.length=++a;return this};yj.prototype.toString=function(){return this.g.length?this.g.join(""):""};
function Ej(a,b){var c=xj(a),d=xj(b);return c>d?1:c==d?0:-1};function Fj(a,b,c,d,e){if(!(b instanceof S))if(w(b)&&s(c)){var f,g,k,l;if("starts"==b||"^"==b)b=mj(c);else{if("<"==b||"<="==b)f=c,k="<"==b;else if(">"==b||">="==b)g=c,l=">"==b;else if("="==b||"=="==b)f=g=c;else throw new L("invalid op: "+b);if("<"==d||"<="==d)f=e,k="<"==d;else if(">"==d||">="==d)g=e,l=">"==d;else if(s(d))throw new L("invalid op2: "+d);b=S.bound(g,f,l,k)}}else b=nj(b);this.g=b;this.h=a}Fj.prototype.h="";Fj.prototype.Sc=function(){return this.h};
Fj.prototype.we=function(a){if(this.h!=a.h)return null;a=null!=this.g&&null!=a.g?this.g.we(a.g):this.g||a.g;return new Fj(this.h,a)};var Gj={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Hj=q.IDBRequest&&"LOADING"in q.IDBRequest?q.IDBTransaction:q.webkitIDBRequest&&"LOADING"in q.webkitIDBRequest&&1===q.webkitIDBTransaction.READ_WRITE?q.webkitIDBTransaction:Gj,Ij=Hj.READ_ONLY,Jj=Hj.READ_WRITE,Kj=Hj.VERSION_CHANGE,Lj=q.indexedDB||q.mozIndexedDB||q.webkitIndexedDB||q.moz_indexedDB||q.msIndexedDB;function Mj(a,b,c,d){ub.call(this);this.i=c;this.R=c.getName();this.Cb=void 0;this.j=!1;this.aa=null;this.o=a;this.od=b;this.Wa=0;this.Ja=this.G=!1;this.na=d||4;this.p=this.h=this.g=void 0;this.T=function(){throw new Qc;};this.Z=function(){throw new Qc;};this.Kc=function(){}}C(Mj,ub);h=Mj.prototype;
h.init=function(a,b,c,d,e){if(s(b)){a=this.i;var f,g=b;u(b)?(f=Nj(a,b),g=b.join(", ")):f=Oj(a,b);if(!f)throw new L('require index "'+g+'" not found in store "'+a.getName()+'"');this.Cb=f.getName()}this.j=w(this.Cb);this.aa=c||null;this.Wa=0;this.Ja=this.G=!1;this.reverse="prev"==d||"prevunique"==d;this.unique="nextunique"==d||"prevunique"==d;this.Ib=d;this.bd=e;this.p=this.h=this.g=void 0};h.Ib="";h.aa=null;h.unique=!1;h.reverse=!1;h.bd=!0;h.logger=P("ydn.db.core.req.AbstractCursor");
h.ic=function(a,b,c){null==a&&(N(this.logger,this+" finished."),this.G=!0);this.g=a;this.h=b;this.p=c;this.Wa++;this.G?(O(this.logger,this+" DONE."),this.T(),Pj(this)):(O(this.logger,this+" new cursor position {"+(this.j?this.g+", "+this.h:this.g)+"}"),this.T(this.g))};h.J=function(){this.o=null};h.toString=function(){return"Cursor:"+this.R+(s(this.Cb)?":"+this.Cb:"")+"["+(this.o?"":"~")+this.od+"]"};
function Pj(a){null!=a.h?a.h=Qj(a.h):a.h=void 0;null!=a.g?a.g=Qj(a.g):a.g=void 0;a.Kc(a.Ja,a.g,a.h)}function Rj(a){a.Ja=!0;O(a.logger,a+": exit");Pj(a)}h.ca=function(){return this.Wa};h.ha=function(){return this.j?this.h:this.g};h.V=function(){return this.bd?this.ha():this.p};h.zd=function(){};function Sj(){};function Tj(a,b,c,d,e,f,g){if(!w(a))throw new TypeError("store name must be a string, but "+a+" found.");this.i=a;this.h=b;this.o=g;this.p=!!this.h;if(s(d)&&!fa(d))throw new L("reverse value must be a boolean, but "+typeof d+" found");if(s(e)&&!fa(e))throw new L("unique value must be a boolean, but "+typeof e+" found");if(s(f)&&!fa(f))throw new L("key_only value must be a boolean, but "+typeof f+" found");this.g=s(f)?f:!!w(this.h);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.l=
a;if(d=pj(c))throw new L("Invalid key range: "+d);this.j=lj(c);this.t=Uj;this.N=NaN}C(Tj,Sj);Tj.prototype.g=!0;function Vj(a,b,c,d,e){if(!w(b))throw new L("index name must be string");Tj.call(this,a,b,c,d,e,!0)}C(Vj,Tj);function Wj(a,b,c){if(3<arguments.length)throw new L("too many argument");Tj.call(this,a,void 0,b,c,void 0,!1)}C(Wj,Tj);function Xj(a,b,c,d,e){if(!w(b))throw new L("index name must be string");Tj.call(this,a,b,c,d,e,!1)}C(Xj,Tj);var Uj="init";h=Tj.prototype;h.logger=P("ydn.db.Iterator");
h.I=function(){return this.i};h.ga=function(){var a=new Tj(this.i,this.h,this.j,Yj(this),Zj(this),this.g,this.o);a.N=this.N;return a};h.unique=function(a){return new Tj(this.i,this.h,this.j,Yj(this),a,this.g,this.o)};h.toJSON=function(){return{store:this.i,index:this.h,keyRange:this.j?jj(this.j):null,direction:this.l}};
h.toString=function(){var a=s(this.o)?":"+this.o.join(","):s(this.h)?":"+this.h:"",a=a+qj(this.j);this.t!=Uj&&(a+=this.t+"{"+this.G,this.p&&(a+=", "+this.H),a+="}");var b=this.p?"Index":"",b=b+(this.g?"Key":"Value");return b+"Iterator:"+this.i+a};h.reverse=function(){return new Tj(this.i,this.h,this.j,!Yj(this),Zj(this),this.g,this.o)};function Yj(a){return"prev"===a.l||"prevunique"===a.l}function Zj(a){return"nextunique"===a.l||"prevunique"===a.l}
h.load=function(a){a=a[0];a.init(this.i,this.o||this.h,this.j,this.l,this.g);this.t="busy";var b=this;a.Kc=function(a,d,e){b.G=d;b.H=e;b.t=a?"rest":"done"};a.openCursor(this.G,this.H);return a};h.ha=function(){return this.H};h.stores=function(){return[this.i]};function ak(a,b,c){Rc.call(this,b,c);this.t=a;this.j=[];this.p=[];this.T=[];this.g=null;this.nb="";this.G=0}C(ak,Rc);h=ak.prototype;h.nb="";h.logger=P("ydn.db.Request");function bk(a,b,c){a.g=b;a.nb=c;N(a.logger,a+" BEGIN");if(b){for(c=0;c<a.p.length;c++)a.p[c][0].call(a.p[c][1],b);a.p.length=0}N(a.logger,a+" END")}function ck(a){var b=new ak(a.t);a.G++;bk(b,a.g,a.nb+"C"+a.G);return b}h.Hd=function(){return this.t};
h.abort=function(){if(this.g)if(N(this.logger,this+" aborting"),ga(this.g.abort))this.g.abort();else if(ga(this.g.executeSql))this.g.executeSql("ABORT",[],function(){},function(){return!0});else throw new Nc;else throw new dk("No active transaction");};function T(a,b,c){var d=a.T.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){T(a,b,c)}):c?a.D(b):a.C(b)}function ek(a,b,c){a.T.push([b,c])}function U(a,b,c){a.g?b.call(c,a.g):a.p.push([b,c])}
h.C=function(a){N(this.logger,this+" SUCCESS");ak.m.C.call(this,a);this.g=null;this.nb=this.nb};h.D=function(a){N(this.logger,this+" ERROR");ak.m.D.call(this,a);this.g=null;this.nb=this.nb};function V(a){var b="";a.nb&&(b=a.g?"*":"",b="["+a.nb+b+"]");return a.t+b}function fk(a,b){var c=new ak(a);T(c,b);return c}h.toString=function(){return"Request:"+V(this)};
h.Fe=function(){this.o&&this.tb&&rb(this)&&(q.clearTimeout(this.o),delete this.o);this.h&&(this.h.vd--,delete this.h);for(var a=this.i,b=!1;this.l.length&&!this.Mc;){var c=this.l.shift(),d=c[0],e=c[1],c=c[2];if(d=this.Nb?e:d)d=d.call(c||this.H,a),s(d)&&(this.Nb=this.Nb&&(d==a||d instanceof Error),this.i=a=d),a instanceof D&&(this.Mc=b=!0)}this.i=a;b&&(a.B(ma(this.Ad,this,!0),ma(this.Ad,this,!1)),a.Xf=!0)};
h.toJSON=function(){var a=(this.nb||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.t?this.t.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var sj=Lj&&Lj.cmp?ma(Lj.cmp,Lj):Ej,gk=[];(function(a,b){if(null!=a&&!("push"in a))throw new Dh('output receiver object must have "push" method.');this.limit=b}).prototype.logger=P("ydn.db.algo.AbstractSolver");function hk(a){Error.captureStackTrace?Error.captureStackTrace(this,hk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}C(hk,Error);hk.prototype.name="ConstraintError";hk.prototype.toString=function(){return this.name+": "+this.message};function ik(a){Error.captureStackTrace?Error.captureStackTrace(this,ik):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}C(ik,Error);
ik.prototype.toString=function(){return this.name+": "+this.message};function jk(a){Error.captureStackTrace?Error.captureStackTrace(this,jk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}C(jk,Error);jk.prototype.name="ydn.db.VersionError";jk.prototype.toString=function(){return this.name+": "+this.message};function kk(a){Error.captureStackTrace?Error.captureStackTrace(this,kk):this.stack=Error().stack||"";a&&(this.message=String(a))}C(kk,Error);
kk.prototype.name="ydn.db.InternalError";function dk(a){Error.captureStackTrace?Error.captureStackTrace(this,dk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}C(dk,Error);function lk(a){Error.captureStackTrace?Error.captureStackTrace(this,lk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}C(lk,Error);
function mk(a){Error.captureStackTrace?Error.captureStackTrace(this,mk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}C(mk,Error);mk.prototype.name="NotFoundError";mk.prototype.toString=function(){return this.name+": "+this.message};function nk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,nk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}C(nk,Error);
nk.prototype.toString=function(){return this.name+": "+this.message};function ok(a,b){Error.captureStackTrace?Error.captureStackTrace(this,ok):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}C(ok,Error);ok.prototype.toString=function(){return this.name+": "+this.message};function pk(a){Error.captureStackTrace?Error.captureStackTrace(this,pk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}
C(pk,Error);function qk(a){Error.captureStackTrace?Error.captureStackTrace(this,qk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}C(qk,Error);function rk(a,b,c){var d;if(A(a))d=a.store,b=a.id,null!=a.parent&&(c=new rk(a.parent));else if(s(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new rk(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!s(b))throw Error("Invalid key value: "+a);this.R=d;this.id=b;this.parent=c||null}h=rk.prototype;h.toJSON=function(){var a={store:this.R,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
h.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.R+"^:"+this.id};h.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};h.I=function(){return this.R};h.F=function(){return this.id};function sk(a){return u(a.id)?a.id.join("^|"):a.id instanceof Date?+a.id:a.id}h.getParent=function(){return this.parent};function tk(a){return y(a)||w(a)||u(a)&&Ua(a,tk)||a instanceof Date}
function Qj(a){if(v(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function uk(a,b){this.g=b}uk.prototype.logger=P("ydn.db.crud.req.RequestExecuto");uk.prototype.toString=function(){return"RequestExecutor"};function vk(a,b,c,d,e,f){this.Ja=a;this.Wa=b;this.g=this.i=0;this.ea=d;this.Z=e;this.l=c||wk;this.N=f||0;this.t=!1;this.H=0}h=vk.prototype;h.logger=P("ydn.db.tr.Thread");h.Nh=function(a){if("complete"==a||"abort"==a)this.t?(O(this.logger,"tx "+this.i+" committed"),this.t=!1):(O(this.logger,"Generator done "+this.t),T(null,this.i,"complete"!=a))};
h.qc=function(){if(s(this.G))if(this.G)O(this.logger,"Receive to commit tx "+this.i+" on yield "+this.H),this.t=!0;else throw new Pc("Coroutine transaction thread has been ended");else throw new Pc("Transaction thread not running in a generator");};
function xk(a,b){a.t?(O(a.logger,"waiting tx to be committed for yielding "+a.H),setTimeout(function(){a.Sb(function(){O(a.logger,"sending result to yield "+a.H);a.G.next(b)},a.ea,a.Z,ma(a.Nh,a))},4)):(O(a.logger,"sending result to yield "+a.H),a.G.next(b));a.H++}h.request=function(a){a=new ak(a);this.G&&a.B(function(a){xk(this,a)},function(a){var c=a;a instanceof Error||(c=Error(),c.error=a);xk(this,c)},this);return a};h.type=function(){return yk(this.Ja)};h.M=function(){return this.Ja};
h.Pa=function(){return"B"+this.Wa+"T"+this.i};var wk="single";function zk(a){if(a)if(ga(a.abort))a.abort();else if(ga(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new Nc;else throw new dk("No active transaction");};function Ak(a){this.i=a;this.g=null;this.h=0}Ak.prototype.logger=P("ydn.db.tr.Mutex");Ak.prototype.hb=null;function Bk(a){return!!a.g&&!a.j}Ak.prototype.$a=null;Ak.prototype.toString=function(){return"Mutex:"+("B"+this.i+"T"+this.h)+(this.g?"*":"")};function Ck(a,b,c,d,e,f){vk.call(this,a,b,c,d,e,f);this.j=[];this.o=[];this.p=null;this.h=new Ak(b);this.T=f||0;this.na=!1}C(Ck,vk);h=Ck.prototype;h.logger=P("ydn.db.tr.Serial");
function Dk(a,b,c){if("multi"==a.l)a:if(a=a.h,!a.hb||!a.mode||c!=a.mode&&(a.mode!=Jj||c!=Ij)||b.length>a.hb.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.hb.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.l)a:if(a=a.h,a.hb&&a.mode&&c==a.mode&&a.hb.length==b.length){for(c=0;c<b.length;c++)if(-1==a.hb.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.l?!0:!1;return b}
function Ek(a){var b=0<a.j.length?a.j[0].hb:null,c=0<a.j.length?a.j[0].mode:null;return null!=b&&null!=c?Dk(a,b,c):!1}function Fk(a,b,c,d,e){O(a.logger,"push tx queue["+a.j.length+"]");a.j.push({Fd:b,hb:c,mode:d,$a:e})}h.abort=function(){N(this.logger,this+": aborting");zk(this.p)};
h.Sb=function(a,b,c,d){var e=w(b)?[b]:b;if(v(e)){if(0==e.length)throw new L("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!w(e[f]))throw new L("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.Ub&&!Xa(this.Ub,e[f]))throw new L('store name "'+f+e[f]+'" in scope of '+this);}}else throw new L("store names must be an array");var g=s(c)?c:Ij,k=this;if(this.h.g||!Gk(this.M())&&this.na)Fk(this,a,b,g,d);else{var l=this.Pa();d&&this.o.push(d);
if(this.T&&this.i>=this.T)throw new Pc("Exceed maximum number of transactions of "+this.T);this.na=!0;Hk(this.M(),function(c){var d=k.h;d.g=c;d.j=!1;d.hb=b;d.mode=g;d.h++;d.$a=null;l=k.Pa();af(k.logger,l+" BEGIN "+yh(b)+" "+g);a(k);for(a=null;Ek(k);)c=k.j.shift(),c.$a&&k.o.push(c.$a),O(k.logger,"pop tx queue"+(k.j.length+1)+" reusing T"+k.i),c.Fd()},e,g,function(a,b){af(k.logger,l+" "+a);var c=k.h;c.g?(c.g=null,c.hb=null,c.mode=null,ga(c.$a)&&c.$a(a,b),c.$a=null):M(c.logger,c+" has no TX to be unlocked for "+
a);for(c=0;c<k.o.length;c++)(0,k.o[c])(a,b);k.o.length=0;(c=k.j.shift())&&k.Sb(c.Fd,c.hb,c.mode,c.$a);k.g=0})}};h.Pa=function(){var a=this.h;return"B"+a.i+"T"+a.h};h.request=function(a,b,c,d){var e=Ck.m.request.call(this,a,b,c,d);a=c||Ij;var f=this;Bk(this.h)&&Dk(this,b,a)?(b=this.h.g,this.g++,bk(e,b,this.Pa()+"R"+this.g),d&&this.o.push(d)):f.Sb(function(){var a=f.h.g;f.g++;bk(e,a,f.Pa()+"R"+f.g)},b,a,d);return e};
h.oc=function(a,b,c,d,e){d=d||Ij;var f=this,g;if(Bk(f.h)&&Dk(this,c,d)){var k=f.h.g;f.g++;g=f.Pa()+"R"+f.g;N(f.logger,g+" BEGIN");b(k,g,function(b,c){f.p=k;c?(N(f.logger,g+" ERROR"),a.D(b)):(N(f.logger,g+" SUCCESS"),a.C(b));f.p=null});N(f.logger,g+" END");b=null}else f.Sb(function(){var c=f.h.g;f.g++;g=f.Pa()+"R"+f.g;N(f.logger,g+" BEGIN");b(c,g,function(b,d){f.p=c;d?(N(f.logger,g+" ERROR"),a.D(b)):(N(f.logger,g+" SUCCESS"),a.C(b));f.p=null});N(f.logger,g+" END");b=null},c,d,e)};h.getName=function(){return this.M().getName()};
h.toString=function(){return"Serial:"+this.Pa()+(this.p?"*":"")};function Ik(a,b){Ck.call(this,a,b)}C(Ik,Ck);Ik.prototype.logger=P("ydn.db.tr.AtomicSerial");Ik.prototype.request=function(a,b,c){var d,e,f,g=Ik.m.request.call(this,a,b,c,function(a,b){g.g=null;if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new qk;T(g,c,!0)}});ek(g,function(a,b,c){f=b;e=a;d=c});return g};
Ik.prototype.oc=function(a,b,c,d,e){var f,g,k=new D;k.B(function(a){g=!1;f=a},function(a){g=!0;f=a});Ik.m.oc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.D(c);else if(!0===g)a.D(f);else if(!1===g)a.C(f);else{var d=new qk;a.D(d)}e&&(e(b,c),e=void 0)})};Ik.prototype.toString=function(){return"Atomic"+Ik.m.toString.call(this)};function Jk(a,b,c,d){this.j=a;this.h=b;this.g=c;this.Ua=d;this.i=null}h=Jk.prototype;h.logger=P("ydn.db.tr.DbOperator");h.abort=function(){this.g.abort()};function W(a){a.i||(a.i=a.j.H());return a.i}h.M=function(){return this.j};h.qc=function(){this.g.qc()};
function Kk(a,b){var c=a.M(),d=b instanceof Lk?b:Mk(b),e=b.name,f=X(c.h,e);if(0==Nk(d,f).length)sb(!1);else if(f=f?"update":"add",c.h instanceof Ok)Pk(c.h,d),c.i?(c.i.le(),c.i=null,Qk(c)):sb(!1);else throw new Hh("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}h.toString=function(){return"TxStorage:"+this.M().getName()};function Rk(a,b,c,d){Jk.call(this,a,b,c,d)}C(Rk,Jk);h=Rk.prototype;h.logger=P("ydn.db.crud.DbOperator");
h.count=function(a,b,c,d){var e,f,g,k;if(null!=a)if(u(a)){if(s(c)||s(b))throw new L("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!Sk(this.h,f[l]))throw new L('store name "'+f[l]+'" at '+l+" not found.");N(this.logger,"countStores: "+yh(f));e=this.g.request("count",f);U(e,function(){W(this).Bd(e,f)},this)}else if(w(a)){l=X(this.h,a);if(!l)throw new L('store name "'+a+'" not found.');if(s(d)&&!fa(d))throw new L('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(w(b))if(g=
b,A(c)){var m=pj(c);if(m)throw new L("invalid key range: "+xh(c)+" "+m);k=lj(c)}else{if(null!=c)throw new L("invalid key range: "+xh(c)+" of type "+typeof c);k=null}else if(A(b)||null==b)if(A(b)){if(m=pj(b))throw new L("invalid key range: "+xh(b)+" "+m);k=lj(b)}else{if(null!=b)throw new L("key range must be  an object but found "+xh(b)+" of type "+typeof b);k=null}else throw new L('invalid second argument for count "'+xh(c)+'" of type '+typeof b);N(this.logger,"countKeyRange: "+a+" "+(g?g:"")+yh(k));
e=this.g.request("count",f);Tk(l,e,arguments);U(e,function(){W(this).Nc(e,f[0],k,g,!!d)},this)}else throw new L("Invalid store name or store names.");else M(this.logger,"count method requires store name(s)"),l=Uk(this.h),e=this.g.request("count",l),ek(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),U(e,function(){W(this).Bd(e,f)},this);return e};
h.get=function(a,b){var c=this,d;if(a instanceof rk){var e=a,f=e.I(),g=X(this.h,f);if(!g){if(this.h.bb()){if(Gk(this.M()))return fk("get",void 0);d=new ak("get");this.M().Pb(function(){c.get(a,b).B(function(a){d.C(a)},function(a){d.D(a)})});return d}throw new L("Store: "+f+" not found.");}var k=e.F();N(this.logger,"getByKey: "+f+":"+k);d=this.g.request("get:key",[f]);Tk(g,d,arguments,void 0,this);U(d,function(){W(this).Gd(d,f,k)},this)}else if(w(a)&&s(b)){var l=a,g=X(this.h,l);if(!g){if(this.h.bb()){if(Gk(this.M()))return fk("get",
void 0);d=new ak("get");this.M().Pb(function(){c.get(a,b).B(function(a){d.C(a)},function(a){d.D(a)})});return d}throw new L('Store name "'+l+'" not found.');}var m=b;N(this.logger,"getById: "+l+":"+m);d=this.g.request("get",[l]);Tk(g,d,arguments,void 0,this);U(d,function(){W(this).Gd(d,l,m)},this)}else throw new L("get require valid input arguments.");return d};
h.keys=function(a,b,c,d,e,f,g){var k,l,m=null,n=!1,p=!1,r=a,t=X(this.h,r);if(!w(r))throw new L("store name must be a string, but "+r+" of type "+typeof r+" is not.");if(!this.h.bb()){if(!t)throw new L('store name "'+r+'" not found.');if(w(b)&&!Oj(t,b))throw new L('index "'+b+'" not found in store "'+r+'".');}if(this.h.bb()&&!t)return fk("keys",[]);var x;if(w(b)){var z=b,G=pj(c);if(G)throw new L("invalid key range: "+c+" "+G);m=lj(c);if(y(d))k=d;else{if(s(d))throw new L("limit must be a number");k=
100}if(y(e))l=e;else{if(s(e))throw new L("offset must be a number");l=0}if(s(f))if(fa(f))n=f;else throw new L("reverse must be a boolean");if(s(g))if(fa(g))p=g;else throw new L("unique must be a boolean");N(this.logger,"keysByIndexKeyRange: "+r);x=this.g.request("keys:iter:index",[r]);Tk(t,x,arguments);U(x,function(){W(this).list(x,2,r,z,m,k,l,n,p)},this)}else{if(A(b)){if(G=pj(b))throw new L("invalid key range: "+xh(b)+" "+G);m=lj(b)}else{if(null!=b)throw new L("invalid key range: "+xh(b)+" of type "+
typeof b);m=null}if(y(c))k=c;else{if(s(c))throw new L("limit must be a number");k=100}if(y(d))l=d;else{if(s(d))throw new L("offset must be a number");l=0}if(s(e))if(fa(e))n=e;else throw new L("reverse must be a boolean");N(this.logger,"keysByKeyRange: "+r);x=this.g.request("keys",[r]);Tk(t,x,arguments);U(x,function(){W(this).list(x,2,r,null,m,k,l,n,!1)},this)}return x};
h.values=function(a,b,c,d,e,f,g){var k=this,l,m,n,p=!1,r=!1;if(w(a)){var t=a,x=X(this.h,t);if(!x){if(this.h.bb()){if(Gk(this.M()))return fk("values",[]);l=new ak("values");this.M().Pb(function(){k.values(a,b,c,d,e,f).B(function(a){l.C(a)},function(a){l.D(a)})});return l}throw new mk(t);}if(u(b)){if(s(c)||s(d))throw new L("too many input arguments");var z=b;N(this.logger,"listByIds: "+t+" "+z.length+" ids");l=this.g.request("values:array",[t]);Tk(x,l,arguments,void 0,this);U(l,function(){W(this).mf(l,
t,z)},this)}else if(w(b)){var G=b;if(!Vk(x,G))throw new L('index "'+G+'" not found in store "'+t+'"');var E=pj(c);if(E)throw new L("invalid key range: "+c+" "+E);var J=lj(c);if(s(d))if(y(d))m=d;else throw new L("limit must be a number.");else m=100;if(s(e))if(y(e))n=e;else throw new L("offset must be a number.");else n=0;if(fa(f))p=f;else if(s(f))throw new L("reverse must be a boolean, but "+f);if(s(g))if(fa(g))r=g;else throw new L("unique must be a boolean");N(this.logger,"listByIndexKeyRange: "+
t+":"+G);l=this.g.request("values:iter:index",[t]);Tk(x,l,arguments);U(l,function(){W(this).list(l,4,t,G,J,m,n,p,r)},this)}else{J=null;if(A(b)){if(E=pj(b))throw new L("invalid key range: "+b+" "+E);J=lj(b)}else if(null!=b)throw new L('expect key range object, but found "'+xh(b)+'" of type '+typeof b);if(s(c))if(y(c))m=c;else throw new L("limit must be a number, but "+c+" is "+typeof c);else m=100;if(s(d))if(y(d))n=d;else throw new L("offset must be a number, but "+d+" is "+typeof d);else n=0;if(s(e))if(fa(e))p=
e;else throw new L("reverse must be a boolean, but "+e+" is "+typeof e);N(this.logger,(J?"listByKeyRange: ":"listByStore: ")+t);l=this.g.request("values",[t]);Tk(x,l,arguments);U(l,function(){W(this).list(l,4,t,null,J,m,n,p,!1)},this)}}else if(u(a))if(a[0]instanceof rk){for(var x=[],Q=a,E=0;E<Q.length;E++){var oa=Q[E].I();if(!Sk(this.h,oa)){if(this.h.bb())return x=[],x[Q.length-1]=void 0,fk("get",x);throw new L("Store: "+oa+" not found.");}Xa(x,oa)||x.push(oa)}N(this.logger,"listByKeys: "+yh(x)+" "+
Q.length+" keys");l=this.g.request("values:keys",x);U(l,function(){W(this).Wd(l,Q)},this)}else throw new L("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found.");else throw new L("first argument "+a+" is invalid.");return l};
h.list=function(a,b,c,d,e,f,g,k,l){var m=X(this.h,b);if(!m){if(this.h.bb())return fk("get",[]);throw new mk(b);}var n;if(c&&!Vk(m,c))throw new L('index "'+c+'" not found in store "'+b+'"');if(m=pj(d))throw new L("invalid key range: "+d+" "+m);var p=lj(d),r=100;if(y(e))r=e;else if(null!=e)throw new L('limit must be a number but "'+e+'" of type '+typeof e+" found.");var t=0;if(y(f))t=f;else if(null!=f)throw new L('offset must be a number but "'+f+'" of type '+typeof f+" found.");var x=!1;if(fa(g))x=
g;else if(null!=g)throw new L('reverse must be a boolean but "'+g+'" of type '+typeof g+" found.");var z=!1;if(fa(k))z=k;else if(null!=k)throw new L('unique must be a boolean but "'+k+'" of type '+typeof k+" found.");if(t&&l&&s(l[0]))throw new L("offset must not given when initial cursor position is defined");N(this.logger,a+": "+b+":"+c);n=this.g.request("values:iter:index",[b]);U(n,function(){W(this).list(n,a,b,c||null,p,r,t,x,z,l)},this);return n};
h.add=function(a,b,c){var d=w(a)?a:A(a)?a.name:void 0;if(!w(d))throw new L("store name "+d+" must be a string, but "+typeof d);var e=X(this.h,d);if(!e){if(!this.h.bb())throw new L('store name "'+d+'" not found.');e=Mk(A(a)?a:{name:d});N(this.logger,"Adding object store: "+d);Kk(this,e)}else if(this.h.bb()&&A(a)&&(a=Mk(a),a=Nk(e,a)))throw new Nc(a);var f;if(!e)throw new L('store name "'+d+'" not found.');if(w(e.keyPath)&&s(c))throw new L("key must not be provided while the store uses in-line key.");
if(!e.keyPath&&!e.h&&!s(c))throw new L("out-of-line key must be provided.");if(u(b)){N(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)Wk(e,b[a]);f=this.g.request("add:array",[d],Jj);U(f,function(){W(this).kb(f,!1,!1,d,b,c)},this);e.Xb&&f.A(function(a){a=new Xk(Yk,this.M(),e.getName(),a,b);this.M().Ya(a)},this)}else if(A(b))a="store: "+d+" key: "+Zk(e,b,c),N(this.logger,"addObject: "+a),Wk(e,b),f=this.g.request("add",[d],Jj),U(f,function(){W(this).kb(f,!1,!0,d,[b],[c])},
this),e.Xb&&f.A(function(a){a=new $k(Yk,this.M(),e.getName(),a,b);this.M().Ya(a)},this);else throw new L("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};
function al(a,b){var c=w(b)?b:A(b)?b.name:void 0;if(!w(c))throw new L("store name must be a string");var d=X(a.h,c);if(!d){if(!a.h.bb())throw new mk(c);d=Mk(A(b)?b:{name:c});N(a.logger,"Adding object store: "+c);Kk(a,d)}else if(a.h.bb()&&A(b)){var e=Mk(b);if(e=Nk(d,e))throw new Nc(e);}if(!d)throw new mk(c);return d}h.load=function(a,b,c){var d=c||",",e=al(this,a).getName();a=this.g.request("load",[e]);var f=this;this.g.oc(a,function(a,c,l){W(f).tf(a,c,l,e,b,d)},[e],Jj);return a};
h.search=function(a){var b=bl(a);O(this.logger,"query "+a);var c=this.g.request("search",b,Ij);U(c,function(){var b=W(this);cl(a,function(e,f,g,k){var l=ck(c);b.list(l,4,e,f,lj(g),100,0,!1,!1);l.fa(function(b){var d=null;b instanceof Array||(d=b,b=[]);for(var e=0;e<b.length;e++){var f;f=b[e];var g=f.id,g=w(g)?Aj(g):g,k=g[3];(f=1==this.type&&k!=this.value?null:new dl(this,g[0],g[2],g[1],k,f.k,f.loc))&&a.j.push(f)}a.i--;b=0==a.i?!1:a.h[a.h.length-1].l===this.l?!0:null;!0===b?Sc(c,a):!1===b&&c.C(el(a));
if(d)throw d;},k)})},this);return c};
h.put=function(a,b,c){var d,e=this;if(a instanceof rk){var f=a,g=f.I(),k=X(this.h,g);if(!k)throw new L('store "'+g+'" not found.');if(k.keyPath){var l=Zk(k,b);if(null!=l){if(0!=sj(l,f.F()))throw new L("Inline key must be "+f+" but "+l+" found.");}else fl(k,b,f.F());return this.put(g,b)}return this.put(g,b,f.F())}if(u(a)){if(s(c))throw new L("too many arguments");var m=a;if(!s(b))throw new L("record values required");for(var n=b,f=[],g=0,k=m.length;g<k;g++){l=m[g].I();-1==Pa(f,l)&&f.push(l);var p=
X(this.h,l);if(!p)throw new L('store "'+l+'" not found.');p.keyPath&&fl(p,n[g],m[g].F())}N(this.logger,"putByKeys: to "+yh(f)+" "+n.length+" objects");for(g=0;g<n.length;g++)Wk(p,n[g]);d=this.g.request("put:keys",f,Jj);Tk(p,d,arguments);U(d,function(){W(e).ae(d,n,m)},this)}else if(w(a)||A(a)){var p=al(this,a),r=p.getName();if(p.keyPath&&s(c))throw new L("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.h&&!s(c))throw new L("out-of-line key must be provided.");if(u(b)){var t=
b,x=c;N(this.logger,"putObjects: "+r+" "+t.length+" objects");for(g=0;g<t.length;g++)Wk(p,t[g]);d=this.g.request("put:array",[r],Jj);Tk(p,d,arguments);U(d,function(){W(this).kb(d,!0,!1,r,t,x)},this);p.Xb&&d.A(function(a){a=new Xk(gl,this.M(),r,a,t);this.M().Ya(a)},this)}else if(A(b)){var z=b,G=c;N(this.logger,"putObject: "+r+" "+G);if(s(q.Blob)&&z instanceof Blob&&p.nc&&!p.keyPath&&0==p.indexes.length&&Ib)d=new ak("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,c=e.g.request("put",
[r],Jj);Tk(p,c,[r,z,G]);U(c,function(){W(e).kb(c,!0,!0,r,[b],[G])},this);c.B(function(a){d.C(a)},function(a){d.D(a)})},f.onerror=function(a){d.D(a)},f.onabort=function(a){d.D(a)},f.readAsDataURL(z);else{Wk(p,z);d=this.g.request("put",[r],Jj);var E=[r,z,G];Tk(p,d,E);U(d,function(){var a=s(G)?[E[2]]:void 0;W(e).kb(d,!0,!0,r,[E[1]],a)},this)}p.Xb&&d.A(function(a){a=new $k(gl,this.M(),r,a,z);this.M().Ya(a)},this)}else throw new L("put record value must be Object or array of Objects");}else throw new L("the first argument of put must be store name, store schema or array of keys.");
return d};
function hl(a,b,c,d){var e=a.Ua,f,g;if(w(b)){var k=X(a.h,b);if(k){if(!k.keyPath&&!k.h&&null==d)throw new L('key required for store "'+b+'"');}else throw new mk(b);for(var l=0;l<c.length;l++)Wk(k,c[l]);f=[b]}else{g=b;f=[];for(var l=0,m=g.length;l<m;l++){var n=g[l].I(),k=X(a.h,n);-1==Pa(f,n)&&f.push(n);if(!k)throw new mk(n);Wk(k,c[l])}}var p;w(b)?(k=X(a.h,b),p=e.request("put:array",f,Jj),U(p,function(){W(this).kb(p,!0,!1,b,c,d)},a)):(p=e.request("put:keys",f,Jj),U(p,function(){W(this).ae(p,c,g)},a));
return p}function il(a,b){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d].I();-1==Pa(c,f)&&c.push(f);if(!Sk(a.h,f))throw new mk(f);}var g=a.Ua.request("rm:keys",c,Jj);U(g,function(){W(this).de(g,b)},a);return g}function jl(a,b,c){var d=a.Ua.request("rm:iter",[b],Jj);U(d,function(){W(this).hd(d,b,c||null)},a);return d}
function kl(a,b,c,d,e,f,g){f=f||100;var k,l=g||0;if(g=X(a.h,b)){if(c&&!Vk(g,c))throw new mk('index "'+c+'" in store "'+b+'"');}else throw new mk(b);var m=lj(d);w(c)?(k=a.Ua.request("values:iter:index",[b]),U(k,function(){W(this).list(k,4,b,c,m,f,l,e,!1)},a)):(k=a.Ua.request("values",[b]),U(k,function(){W(this).list(k,4,b,null,m,f,l,e,!1)},a));return k}
function ll(a,b){var c=[],d=b.length;if(0==d)return fk("keys",[]);for(var e=0;e<d;e++){var f=b[e].I();-1==Pa(c,f)&&c.push(f);if(!Sk(a.h,f))throw new mk(f);}var g=a.Ua.request("keys",c);U(g,function(){W(a).Wd(g,b)},a);return g}
function ml(a,b,c,d,e,f,g,k){var l;e=e||100;var m=X(a.h,b);if(m){if(c&&!Vk(m,c))throw new mk('index "'+c+'" in store "'+b+'"');}else throw new mk(b);w(c)?(l=a.Ua.request("keys:iter:index",[b]),U(l,function(){W(this).list(l,2,b,c,d,e,f,g,k)},a)):(l=a.Ua.request("keys",[b]),U(l,function(){W(this).list(l,2,b,null,d,e,f,g,k)},a));return l}
h.clear=function(a,b,c){if(s(c))throw new L("too many input arguments");var d;if(w(a)){c=X(this.h,a);if(!c)throw new L('store name "'+a+'" not found.');if(A(b)){var e=lj(b);if(null===e)throw new L("clear method requires a valid non-null KeyRange object.");N(this.logger,"clearByKeyRange: "+a+":"+yh(e));d=this.g.request("clear",[a],Jj);Tk(c,d,[a,e]);U(d,function(){W(this).ye(d,a,e)},this)}else{if(s(b))throw new L("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+
typeof b);N(this.logger,"clearByStore: "+a);d=this.g.request("clear",[a],Jj);U(d,function(){W(this).yd(d,[a])},this)}}else if(!s(a)||u(a)&&w(a[0])){var f=a||Uk(this.h);N(this.logger,"clearByStores: "+yh(f));d=this.g.request("clear",f,Jj);U(d,function(){W(this).yd(d,f)},this)}else throw new L('first argument "'+a+'" is invalid.');return d};
h.remove=function(a,b,c){var d;if(w(a)){var e=X(this.h,a);if(!e)throw new L('store name "'+a+'" not found.');if(s(c))if(w(b)){var f=Oj(e,b);if(!f)throw new L("index: "+b+" not found in "+a);if(A(c)||null===c){var g=lj(c);N(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.g.request("rm:iter:index",[a],Jj);U(d,function(){W(this).uf(d,a,f.getName(),g)},this)}else throw new L("key range "+c+' is invalid type "'+typeof c+'".');}else throw new L('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(w(b)||y(b)||v(b)||b instanceof Date){N(this.logger,"removeById: "+a+":"+b);d=this.g.request("rm",[a],Jj);var k=[a,b];Tk(e,d,k);U(d,function(){W(this).ce(d,a,k[1])},this);e.Xb&&d.A(function(b){b=new $k(nl,this.M(),a,b,void 0);this.M().Ya(b)},this)}else if(A(b))g=lj(b),N(this.logger,"removeByKeyRange: "+a+":"+yh(g)),d=this.g.request("rm:iter",[a],Jj),Tk(e,d,[a,g]),U(d,function(){W(this).hd(d,a,g)},this),e.Xb&&d.A(function(b){b=new Xk(nl,this.M(),a,b,void 0);this.M().Ya(b)},
this);else throw new L('Invalid key or key range "'+b+'" of type '+typeof b);}else if(a instanceof rk){var l=a.I(),e=X(this.h,l);d=this.g.request("rm",[l],Jj);var m=[l,a.F()];Tk(e,d,m);U(d,function(){W(this).ce(d,l,m[1])},this)}else if(u(a)){b=[];c=0;for(e=a.length;c<e;c++){if(!(a[c]instanceof rk))throw new L("key list element at "+c+" of "+e+' must be yn.db.Key, but "'+xh(a[c])+'" ('+ea(a[c])+") is not ydn.db.Key.");var n=a[c].I();-1==Pa(b,n)&&b.push(n)}if(1>b.length)throw new L('at least one valid key required in key list "'+
xh(a)+'"');d=this.g.request("rm:keys",b,Jj);U(d,function(){W(this).de(d,a)},this)}else throw new L('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+xh(a)+'" ('+ea(a)+") found.");return d};h.toString=function(){return"DbOperator:"+this.M().getName()};function ol(a,b,c,d){Jk.call(this,a,b,c,d)}C(ol,Rk);h=ol.prototype;h.logger=P("ydn.db.core.DbOperator");h.get=function(a,b){if(a instanceof Tj){var c=a.I(),d=X(this.h,c);if(!d)throw new L('store "'+c+'" not found.');var e=a.h;if(s(e)&&!Vk(d,e))throw new L('index "'+e+'" not found in store "'+c+'".');N(this.logger,"getByIterator:"+a);var f=this.g.request("get:iter",[c]);U(f,function(){pl(this,5,f,a,1)},this);return f}return ol.m.get.call(this,a,b)};
h.keys=function(a,b,c,d,e,f,g){if(a instanceof Tj){var k=100;if(y(b)){if(k=b,1>k)throw new L("limit must be a positive value, but "+b);}else if(s(b))throw new L("limit must be a number,  but "+b);if(s(c))throw new L("offset must not be specified");N(this.logger,"keysByIterator:"+a);var l=this.g.request("keys:iter",[a.I()]);U(l,function(){a.p?pl(this,1,l,a,k):pl(this,2,l,a,k)},this);return l}return ol.m.keys.call(this,a,b,c,d,e,f,g)};
h.count=function(a,b,c,d){if(a instanceof Tj){if(s(b)||s(c))throw new L("too many arguments.");N(this.logger,"countIterator:"+a);var e=this.g.request("count",[a.I()]);U(e,function(){pl(this,6,e,a)},this);return e}return ol.m.count.call(this,a,b,c,d)};
h.values=function(a,b,c,d,e,f){if(a instanceof Tj){var g;if(y(b)){if(g=b,1>g)throw new L("limit must be a positive value, but "+g);}else if(s(b))throw new L("limit must be a number, but "+b);if(s(c))throw new L("offset must not be specified");N(this.logger,"listByIterator:"+a);var k=this.g.request("values:iter",[a.I()]);U(k,function(){a.g?pl(this,2,k,a,g):pl(this,4,k,a,g)},this);return k}return ol.m.values.call(this,a,b,c,d,e,f)};
h.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new L('Store "'+e+'" not found.');e=this.g.request("map",d);O(this.logger,"map:"+a);this.g.oc(e,function(d,e,f){O(c.logger,e+" iterating "+a);for(var m=a.stores(),n=[],p=0;p<m.length;p++)n[p]=W(c).h(d,e,m[p]);var r=a.load(n);r.Z=function(a){f(a,!1)};r.T=function(c){if(null!=c){var d;a.p?a.g?d=c:d=r.ha():a.g?d=c:d=r.V();b(d);r.advance(1)}else f(void 0),b=null}},d,Ij);return e};
function pl(a,b,c,d,e){var f=[],g=c.g,k=V(c),l=k+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);N(a.logger,l);for(var m=W(a),n=[],p=d.stores(),r=0;r<p.length;r++)n[r]=m.h(g,k,p[r]);var t=d.load(n);t.Z=function(a){Rj(t);T(c,a,!0)};var x=0,z=!1;t.T=function(d){z||(O(a.logger,l+" starting"),z=!0);null!=d?(t.ha(),x++,1==b?f.push(d):2==b?f.push(t.ha()):3==b?f.push([d,t.ha()]):6!=b&&f.push(t.V()),5==b?(Rj(t),T(c,f[0])):6==b||!s(e)||x<e?t.zd():(N(a.logger,"success:"+l+" yields "+f.length+" records"),Rj(t),
T(c,f))):(N(a.logger,"success:"+l+" yields "+f.length+" records"),Rj(t),T(c,5==b?f[0]:6==b?x:f))}};var Yk="created",nl="deleted",gl="updated";function ql(a,b){K.call(this,a,b)}C(ql,K);ql.prototype.I=function(){return this.R};function rl(a,b,c){K.call(this,a,b);this.version=c}C(rl,ql);rl.prototype.name="ReadyEvent";rl.prototype.version=NaN;function sl(a,b,c){K.call(this,c||"error",a);this.error=b}C(sl,ql);sl.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};sl.prototype.name="ErrorEvent";sl.prototype.error=null;function tl(a,b){sl.call(this,a,b,"fail")}C(tl,sl);
tl.prototype.name="FailEvent";function $k(a,b,c,d,e){K.call(this,a,b);this.R=c;this.key=d;this.value=e}C($k,ql);$k.prototype.name="RecordEvent";$k.prototype.V=function(){return this.value};function Xk(a,b,c,d,e){K.call(this,a,b);this.R=c;this.keys=d;this.values=e}C(Xk,ql);Xk.prototype.name="StoreEvent";Xk.prototype.Qa=function(){return this.keys};Xk.prototype.Aa=function(){return this.values};function ul(a,b,c,d,e,f){s(e)||(e=u(a)?a.join(", "):a);if(null!=a&&!w(a)&&!v(a))throw new L("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);u(a)&&Object.freeze&&Object.freeze(a);!s(a)&&s(e)&&(a=e);this.keyPath=a;this.o=v(this.keyPath);this.h=e;this.type=vl(b);if(s(b)){if(!s(this.type))throw new L("type invalid in index: "+this.h);if(u(this.keyPath))throw new L('composite key for store "'+this.h+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;this.p=w(this.type)?
this.type:wl;this.j=w(e)?e:u(a)?this.keyPath.join(","):a;this.i=Ka(this.j);this.g=this.o?null:this.keyPath.split(".");this.l=f||null}function xl(a,b){if(null!=b){if(v(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=uj(b,a.keyPath[d]);c[d]=f}return c}return uj(b,a.keyPath)}}function yl(a,b,c){for(var d=0;d<a.g.length;d++)d==a.g.length-1?b[a.g[d]]=c:A(b[a.g[d]])||(b[a.g[d]]={})}var wl="TEXT";function tj(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return null!=b?a:xj(a)}
function zl(a,b){return"DATE"==b?new Date(a):s(b)?a:Aj(a)}var Al=["BLOB","DATE","INTEGER","NUMERIC",wl];function vl(a){if(w(a))return a=Pa(Al,a),Al[a]}h=ul.prototype;h.getName=function(){return this.h};h.toJSON=function(){return{name:this.h,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};h.ga=function(){var a=u(this.keyPath)?bb(this.keyPath):this.keyPath;return new ul(a,this.type,this.unique,this.multiEntry,this.h,this.l)};
function Bl(a,b){return null!=a||null!=b?null!=a?null!=b?v(a)&&v(b)?fb(a,b)?null:"expect: "+a+", but: "+b:Cl(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}h.hint=function(a){if(!a)return this;var b=u(this.keyPath)?bb(this.keyPath):this.keyPath,c=this.type;s(a.type)||"TEXT"!=c||(c=void 0);return new ul(b,c,this.unique,this.multiEntry,a.h)};function Dl(a,b){a.l=b}
h.toString=function(){var a=this.multiEntry?"MultiEntry":"";this.g&&1<this.g.length&&(a+="Compound");return a+"Index:"+this.h};function Lk(a,b,c,d,e,f,g,k){this.i=a;if(!w(this.i))throw new L("store name must be a string");this.keyPath=s(b)?b:null;this.t=v(this.keyPath);if(null!==this.keyPath&&!w(this.keyPath)&&!this.t)throw new L("keyPath must be a string or array");this.h=c;var l;if(null!=d){l=vl(d);if(!s(l))throw new L('type "'+d+'" for primary key in store "'+this.i+'" is invalid.');if(this.t)throw new L('composite key for store "'+this.i+'" must not specified type');}this.type=null!=l?l:this.h?"INTEGER":void 0;this.o=
w(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.Xb=!!f;this.nc=!!g;this.G=w(this.type)?this.type:wl;this.l=u(this.keyPath)?this.keyPath.join(","):w(this.keyPath)?this.keyPath:"_ROWID_";this.j=Ka(this.l);if(this.H=!!k){if(this.keyPath)throw new L('encrypted store "'+this.i+'" must not use inline key');if(this.h)throw new L('encrypted store "'+this.i+'" must not use key generator');}this.p=[]}h=Lk.prototype;h.Xb=!1;h.nc=!1;
h.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.i,keyPath:this.keyPath,autoIncrement:this.h,type:this.type,indexes:a}};
function Mk(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==Pa(b,c))throw new L('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(u(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==Pa(f,g))throw new L("Unknown field: "+g+" in "+yh(e));e=new ul(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
s(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new Lk(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}function El(a,b,c,d,e,f,g){a=Fl(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.Pc;a.ya&&(b+=" WHERE "+a.ya);a.group&&(b+=" GROUP BY "+a.group);a.jc&&(b+=" ORDER BY "+a.jc);return b}
function Fl(a,b,c,d,e,f,g){var k={select:"",Pc:"",ya:"",group:"",jc:""},l=a.l,m=a.j,n=null;d!==l&&w(d)&&(n=Oj(a,d));var p=!!n,r=d||l,t=Ka(r),x=p?n.type:a.type,z=p&&n.multiEntry;k.Pc=Gl(a);6===c?k.select="COUNT("+m+")":3===c||1===c||2===c?(k.select=m,null!=d&&d!=l&&(k.select+=", "+t)):k.select="*";d=g?"DISTINCT ":"";l=[];z?(z=Ka("ydn.db.me:"+a.getName()+":"+n.getName()),k.select=6===c?"COUNT("+d+z+"."+t+")":3===c||1===c||2===c?"DISTINCT "+Gl(a)+"."+m+", "+z+"."+t+" AS "+r:"DISTINCT "+Gl(a)+".*, "+
z+"."+t+" AS "+r,k.Pc=z+" INNER JOIN "+Gl(a)+" USING ("+m+")",null!=e&&(rj(z+"."+t,x,e,l,b),0<l.length&&(k.ya=k.ya?k.ya+(" AND "+l.join(" AND ")):l.join(" AND ")))):null!=e&&(rj(t,x,e,l,b),0<l.length&&(k.ya=k.ya?k.ya+(" AND "+l.join(" AND ")):l.join(" AND ")));p&&!n.unique&&g&&(k.group=t);a=f?"DESC":"ASC";k.jc=t+" "+a;p&&(k.jc+=", "+m+" "+a);return k}
function Hl(a,b,c,d,e,f,g,k,l){var m,n,p,r;null!=e?(m=e.lower,n=e.upper,p=e.lowerOpen,r=e.upperOpen,f?null!=n?(e=sj(k,n),-1==e?(n=k,r=l):0==e&&(r=l||r)):(n=k,r=l):null!=m?(e=sj(k,m),1==e?(m=k,p=l):0==e&&(p=l||p)):(m=k,p=l)):f?(n=k,r=l):(m=k,p=l);e=new S(m,n,!!p,!!r);d=d?Oj(a,d):null;b=Fl(a,c,b,d?d.j:a.l,e,f,g);b="SELECT "+b.select+" FROM "+b.Pc+(b.ya?" WHERE "+b.ya:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.jc;d&&(b+=", "+a.j+(f?"DESC":"ASC"));return b}
function Il(a,b,c,d,e,f,g,k,l,m){var n=Oj(a,d),p=n.j;d=n.i;var r=a.j,t=l?" <":" >",t=g?t+" ":t+"= ";g=tj(f,n.type);k=tj(k,a.type);n="";e?(a=Fl(a,c,b,p,e,l,m),a.ya+=" AND ",n=d+t+"?",c.push(g)):(e=l?S.upperBound(f,!0):S.lowerBound(f,!0),a=Fl(a,c,b,p,e,l,m),n=a.ya,a.ya="");a.ya+="("+n+" OR ("+d+" = ? AND "+r+t+"?))";c.push(g);c.push(k);return"SELECT "+a.select+" FROM "+a.Pc+" WHERE "+a.ya+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.jc}h.ga=function(){return Mk(this.toJSON())};
h.index=function(a){return this.indexes[a]||null};function Oj(a,b){return Va(a.indexes,function(a){return a.getName()==b})}function Nj(a,b){for(var c=0;c<a.indexes.length;c++)if(!Bl(a.indexes[c].keyPath,b))return a.indexes[c];return null}function Vk(a,b){return b===a.keyPath?!0:Ta(a.indexes,function(a){return a.getName()==b})}function Gl(a){return Ka(a.i)}
function Jl(a,b){if(!b)return a;var c=a.h,d=u(a.keyPath)?bb(a.keyPath):a.keyPath,e=a.type,f=Sa(a.indexes,function(a){return a.ga()});s(b.type)||"TEXT"!=e||(e=void 0);u(b.keyPath)&&w(d)&&d==b.keyPath.join(",")&&(d=bb(b.keyPath));for(var g=0,k=b.indexes.length;g<k;g++)if(b.indexes[g].o)for(var l=b.indexes[g].getName(),m=f.length-1;0<=m;m--)if(0<=l.indexOf(f[m].getName())){f[m]=b.indexes[g].ga();break}for(g=0;g<f.length;g++)(k=Oj(b,f[g].getName()))&&(f[g]=f[g].hint(k));return new Lk(b.i,d,c,e,f)}
h.getName=function(){return this.i};function Kl(a){return!!a.keyPath}function Zk(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.t){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(uj(b,a.keyPath[d]));return c}if(a.keyPath)return kc(b,a.o)}}function fl(a,b,c){for(var d=0;d<a.o.length;d++){var e=a.o[d];if(d==a.o.length-1){b[e]=c;break}s(b[e])||(b[e]={});b=b[e]}}
function Ll(a,b,c){var d=[],e=[];c=s(c)?c:Zk(a,b);s(c)&&(e.push(a.j),d.push(tj(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&g.getName()!==a.keyPath&&"_default_"!=g.getName()){var k=xl(g,b);null!=k&&(d.push(tj(k,g.type)),e.push(g.i))}}a.nc?a.nc&&!a.keyPath&&0==a.indexes.length&&(w(b)&&-1==b.indexOf(";base64,")?d.push(b):d.push(yh(b)),e.push("_default_")):(d.push(yh(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{$f:e,zg:a,values:d,key:c}}
function Nk(a,b){if(!b)return"missing store: "+a.i;if(a.i!=b.i)return"store name, expect: "+a.i+", but: "+b.i;var c=Bl(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(s(a.h)&&s(b.h)&&a.h!=b.h)return"autoIncrement, expect:  "+a.h+", but: "+b.h;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(s(a.type)&&s(b.type)&&(v(a.type)?!fb(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=
Oj(b,a.indexes[c].getName()),e;e=a.indexes[c];if(d)if(e.h!=d.h)e="name, expect: "+e.h+", but: "+d.h;else{var f=Bl(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:s(e.type)&&s(d.type)&&(v(e.type)?!fb(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e=
"no index for "+e.h;if(0<e.length)return'index "'+a.indexes[c].getName()+'" '+e}return""}function Wk(a,b){if(b)for(var c=0;c<a.indexes.length;c++){var d=a.indexes[c],e=b;if(d.l){var f=d.l(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||u(f)){for(g=0;g<d.g.length-1;g++)A(e[d.g[g]])||(e[d.g[g]]={});e[d.g[d.g.length-1]]=f}}}}function Ml(a,b){a.p.push(b)}function Tk(a,b,c,d,e){for(var f=0;f<a.p.length;f++)d!==f&&a.p[f].call(e,b,c)}
h.toString=function(){return"Store:"+this.i+"["+this.indexes.length+"index]"};function Nl(a,b,c){if(!a||va(a))throw new L("store_name must be provided for primary full text index");if(!b||va(b))throw new L("index_name must be provided for primary full text index");this.R=a;this.g=b;this.h=c||1}Nl.prototype.I=function(){return this.R};function Ol(a,b,c,d){this.name=a;this.indexes=b;this.lang=c||"";if(-1==["","en","fr"].indexOf(this.lang))throw new L('Unsupported lang "'+c+" for full text search index "+a);this.h=d||null;this.g=null}Ol.prototype.getName=function(){return this.name};Ol.prototype.count=function(){return this.indexes.length};Ol.prototype.index=function(a){return this.indexes[a]};function Pl(a,b,c){return Va(a.indexes,function(a){return a.I()==b&&a.g==c})}
function Ql(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Pa(b,c))throw new L("Unknown field: "+c+" in "+yh(a));if(!u(a.sources))throw new L("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Pa(b,c))throw new L("Unknown field: "+c+" in "+xh(a));return new Nl(a.storeName,a.keyPath,a.weight)});return new Ol(a.name,
b,a.lang)};function Rl(a,b){var c,d,e=b;if(A(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==Pa(c,f))throw new L("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!u(g))throw new L("stores must be array");for(f=0;f<g.length;f++){var k=Mk(g[f]);if(-1!=Wa(e,function(a){return a.name==k.getName()}))throw new L('duplicate store name "'+k.getName()+'".');e.push(k)}}else w(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(s(c)){if(!y(c)||0>c)throw new L("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(s(b)&&(!u(b)||0<b.length&&!(b[0]instanceof Lk)))throw new L("stores");this.version=c;this.Ac=!s(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=Ql(d.fullTextCatalogs[f]),c[f]=e,X(this,e.getName())||(g=[new ul("k",wl),new ul("v",wl)],e=new Lk(e.getName(),"id",!1,void 0,g),this.stores.push(e));this.g=c}h=Rl.prototype;
h.toJSON=function(){var a=Sa(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;s(this.version)&&(b.version=this.version);return b};h.Ac=!1;h.bb=function(){return!1};function Uk(a){return Sa(a.stores,function(a){return a.getName()})}h.store=function(a){return this.stores[a]||null};h.count=function(){return this.stores.length};function X(a,b){return Va(a.stores,function(a){return a.getName()==b})}function Sk(a,b){return Ta(a.stores,function(a){return a.getName()==b})}
function Sl(a,b,c,d){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var e=0;e<a.stores.length;e++){var f=X(b,a.stores[e].getName());if(f){c&&(f=Jl(f,a.stores[e]));if(d)for(var g=f,k=a.stores[e],l=0;l<k.indexes.length;l++){var m=k.indexes[l];Vk(g,m.getName())||"BLOB"!=m.type||(m=new ul(m.keyPath,m.type,m.unique,m.multiEntry,m.getName()),g.indexes.push(m))}f=Nk(a.stores[e],f);if(0<f.length)return'store: "'+a.stores[e].getName()+'" '+f}else return'missing object store "'+
a.stores[e].getName()+'"'}return""}function Tl(a,b){return Va(a.g,function(a){return a.getName()==b})};function Ok(a,b){Rl.call(this,a,b)}C(Ok,Rl);Ok.prototype.bb=function(){return!0};function Pk(a,b){a.stores.push(b)};function Ul(a){return wh(yh(a))}function Cl(a,b){var c;c=c||{};if(null!=a&&null!=b){if(v(a)&&v(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Va(b,function(b){return Cl(b,a[d])}))return!1;return!0}if(v(a))return 1==a.length&&Cl(a[0],b);if(v(b))return 1==b.length&&Cl(b[0],a);if(A(a)&&A(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=Cl(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=Cl(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function Vl(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Wl(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==Pa(d,e))throw new L('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!u(c.mechanisms))throw new L("mechanisms attribute must be an array but "+ea(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!Xa(Xl,c.mechanisms[e]))throw new L('Invalid mechanism "'+c.mechanisms[e]+'"');}this.N=c.mechanisms||Xl;this.G=c.size;this.T=
s(c.connectionTimeout)?c.connectionTimeout:3E4;this.i=null;this.j=[];this.Sd=!1;var f;if(b instanceof Rl)f=b;else if(A(b))for(c.autoSchema||!s(b.stores)?f=new Ok(b):f=new Rl(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=X(f,b.stores[e].name),b.stores[e].Sync&&this.Uf(d,b.stores[e].Sync);else f=new Ok;this.h=f;for(e=0;e<this.h.count();e++)if(this.h.store(e).H)throw Error("encryption option must be defined");if(s(a)){if(this.i)throw new Pc("Already connected with "+this.t);this.t=a;Qk(this)}this.p=
null;this.o=new D}Wl.prototype.logger=P("ydn.db.con.Storage");function Yl(a,b,c){return(a=X(a.h,b))?Vk(a,c):!1}function Zl(a){var b;if(s(b)){var c=function(a){b(a.toJSON());b=void 0};a.i?a.i.ib(c):Hk(a,function(b){a.i.ib(c,b)},null,Ij)}return a.h?a.h.toJSON():null}Wl.prototype.getName=function(){return this.t};var Xl="indexeddb websql localstorage sessionstorage userdata memory".split(" ");h=Wl.prototype;h.Be=function(){return null};
function Qk(a){function b(b,e){b?(O(a.logger,a+": ready."),a.sg=NaN,d.md=function(b){a.Ya(new sl(a,b))},d.oe=function(b){a.Ya(new tl(a,b));a.i=null},d.$d=function(b){a.Ya(b)},setTimeout(function(){$l(a,e);am(a)},10),c.C(e)):(M(a.logger,a+": database connection fail "+e.name),setTimeout(function(){$l(a,new tl(a,e));if(a.j){a.logger.info("Purging "+a.j.length+" transactions request.");for(var b;b=a.j.shift();)b.$a&&b.$a("error",e)}},10),c.D(e))}for(var c=new D,d=null,e=a.N,f=0;f<e.length;f++){var g=
e[f].toLowerCase();if(d=a.Be(g)){d=a.Be(g);break}}null===d?(e=new Hh("No storage mechanism found."),b(!1,new tl(a,e))):(a.init(),d.connect(a.t,a.h).B(function(){this.i=d;b(!0,new rl("ready",this,parseFloat(d.me())))},function(a){M(this.logger,this+": opening fail");b(!1,a)},a))}function yk(a){if(a.i)return a.i.Jc()}h.Pb=function(a,b){this.o.fa(a,b)};function $l(a,b){setTimeout(function(){b instanceof sl?a.o.D(b.error):a.o.C();a.Ya(b)},4)}function Gk(a){return!!a.i&&a.i.ne()}h.init=function(){};
function bm(a){a.i&&(a.i.le(),a.i=null,O(a.logger,a+" closed"))}h.sg=NaN;function am(a){var b=a.j.shift();b&&(O(a.logger,"pop tx queue["+(a.j.length+1)+"]"),Hk(a,b.Fd,b.scopes,b.mode,b.$a));a.sg=B()}function cm(a,b,c,d,e){O(a.logger,"push tx queue["+a.j.length+"]");a.j.push({Fd:b,scopes:c,mode:d,$a:e});100<a.j.length&&0==a.j.length%100&&M(a.logger,"Transaction queue stack size is "+a.j.length+". It is too large, possibility due to incorrect usage.")}h.Sd=!1;
function Hk(a,b,c,d,e){var f=c;if(w(c))f=[c];else if(null!=c)if(v(c)){if(0==c.length)throw new L("number of store names must more than 0");for(var g=0;g<c.length;g++)if(!w(c[g]))throw new L("store name at "+g+" must be string but found "+typeof c[g]);}else throw new L("store names must be an array");else f=null;if(a.i&&a.i.ne()&&!a.Sd){var k=s(d)?d:Ij;k==Kj&&(a.Sd=!0);a.i.Dd(function(a){b(a);b=null},f,k,function(b,c){ga(e)&&(e(b,c),e=void 0);k==Kj&&(a.Sd=!1);am(a)})}else cm(a,b,f,d,e)}
h.Uf=function(a){M(this.logger,"Synchronization option for "+a.getName()+" ignored.")};h.Tf=function(a){M(this.logger,"Full text indexer option for "+a.getName()+" ignored.")};h.Ya=function(){};h.toString=function(){return"Storage:"+this.i};function dm(a,b,c,d){this.j=a;this.l=b;this.g=bb(c);this.h=d;this.i=[]}dm.prototype.j=null;dm.prototype.onCompleted=function(a,b){for(var c=0;c<this.i.length;c++)this.i[c](a,b);this.i.length=0;this.i=this.g=this.j=null};function em(a,b,c){if(a.j)c&&a.i.push(c),b(a.j);else throw new Qc("tx committed on ParallelTxExecutor");}dm.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.l+" mode:"+this.h+" scopes:"+yh(this.g)};function fm(a,b,c,d,e,f){vk.call(this,a,b,c,d,e,f);this.j=this.h=null}C(fm,vk);h=fm.prototype;h.logger=P("ydn.db.tr.Parallel");h.abort=function(){N(this.logger,this+": aborting");zk(this.j)};
h.Hg=function(a,b){var c;if("multi"==this.l)a:if(c=this.h,!c.g||!c.h||b!=c.h&&(c.h!=Jj||b!=Ij)||a.length>c.g.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.l)a:if(c=this.h,c.g&&c.h&&b==c.h&&c.g.length==a.length){for(d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.l?!0:!1;return c};
h.Sb=function(a,b,c,d){function e(c){l.i++;m=new dm(c,l.i,b,k);g=l.Pa();af(l.logger,g+" BEGIN "+yh(b)+" "+k);l.h=m;em(l.h,a,d)}function f(a,b){af(l.logger,g+" "+a);if(m)m.onCompleted(a,b);l.g=0}var g;this.ea&&(b=this.ea);this.Z&&(c=this.Z);var k=s(c)?c:Ij,l=this,m;if(this.h&&this.h.j&&this.Hg(b,k))em(this.h,a,d);else{if(this.N&&this.i>=this.N)throw new Pc("Exceed maximum number of transactions of "+this.N);Hk(this.M(),e,b,k,f)}};
h.request=function(a,b,c,d){var e=fm.m.request.call(this,a,b,c,d),f=this;this.Sb(function(a){f.g++;bk(e,a,f.Pa()+"R"+f.g)},b,c||Ij,d);return e};h.oc=function(a,b,c,d,e){var f=this,g;this.Sb(function(c){f.g++;g=f.Pa()+"R"+f.g;N(f.logger,g+" BEGIN");b(c,g,function(b,d){f.j=c;g=f.Pa()+"R"+f.g;d?(N(f.logger,g+" ERROR"),a.D(b)):(N(f.logger,g+" SUCCESS"),a.C(b));f.j=null});b=null;N(f.logger,g+" END")},c,d,e)};h.toString=function(){return"Parallel:"+this.l+":"+this.Pa()+(this.j?"*":"")};function gm(a,b){fm.call(this,a,b,wk)}C(gm,fm);h=gm.prototype;h.logger=P("ydn.db.tr.AtomicParallel");h.Hg=function(){return!1};h.request=function(a,b,c){var d,e,f,g=this,k=gm.m.request.call(this,a,b,c,function(a,b){k.g=null;N(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new qk;T(k,c,!0)}});ek(k,function(a,b,c){f=b;e=a;d=c});return k};
h.oc=function(a,b,c,d,e){var f,g,k=new D;k.B(function(a){g=!1;f=a},function(a){g=!0;f=a});gm.m.oc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.D(c);else if(!0===g)a.D(f);else if(!1===g)a.C(f);else{var d=new qk;a.D(d)}e&&(e(b,c),e=void 0)})};h.toString=function(){return"Atomic"+gm.m.toString.call(this)};function hm(a,b,c){Wl.call(this,a,b,c);this.l=0;a=!0;b=wk;c&&(s(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=im(this,b,a);this.Ua=im(this,"atomic",!1);this.g=this.Cc(c,this.Ua)}C(hm,Wl);hm.prototype.l=0;hm.prototype.Cc=function(a,b){return new Jk(this,this.h,a,b)};
function im(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==wk)return new Ck(a,a.l++,b,d,e,f);if("atomic"==b)return new Ik(a,a.l++);throw new L('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==wk)return new fm(a,a.l++,b,d,e,f);if("atomic"==b)return new gm(a,a.l++);throw new L('Invalid requestType "'+b+'"');}
hm.prototype.Z=function(a,b,c){if(3<arguments.length)throw new L("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.l++;var d=b||Uk(this.h),e=Ij;if(c)if("readwrite"==c)e=Jj;else if("readonly"!=c)throw new L('Invalid transaction mode "'+c+'"');var f=im(this,"all",!1,d,e,1),g=this.Cc(f,this.Ua),k=new ak("run"),l=this;f.Sb(function(b){O(l.logger,"executing run in transaction on "+f);bk(k,b,f.Pa()+"R0");a(g)},d,e,function(a){k.g=null;T(k,f.i,
"complete"!==a)});return k};function jm(a,b,c){hm.call(this,a,b,c);a=this.h;for(b=0;b<a.g.length;b++){c=a.g[b];var d=X(a,c.getName());if(d){if(!Vk(d,"k"))throw new L('full text index store "'+d.getName()+'" must have "keyword" index');if(!Vk(d,"v"))throw new L('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new L('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new L('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=X(a,e.I());if(f)this.Tf(f,c);else throw new L('full text source store "'+e.I()+'" does not exist for full text index "'+c.getName()+'"');}}}C(jm,hm);h=jm.prototype;h.init=function(){jm.m.init.call(this)};h.Cc=function(a,b){return new Rk(this,this.h,a,b)};h.add=function(a,b,c){return this.g.add(a,b,c)};h.count=function(a,b,c,d){return this.g.count(a,b,c,d)};h.get=function(a,b){return this.g.get(a,b)};h.keys=function(a,b,c,d,e,f,g){return this.g.keys(a,b,c,d,e,f,g)};
h.values=function(a,b,c,d,e,f){return this.g.values(a,b,c,d,e,f)};h.list=function(a,b,c,d,e,f,g,k,l){return this.g.list(a,b,c,d,e,f,g,k,l)};h.load=function(a,b,c){return this.g.load(a,b,c)};h.put=function(a,b,c){return this.g.put(a,b,c)};h.clear=function(a,b,c){return this.g.clear(a,b,c)};h.remove=function(a,b,c){return this.g.remove(a,b,c)};h.toString=function(){var a="Storage:"+this.getName();Gk(this)&&(a+=" ["+yk(this)+"]");return a};function km(a,b,c){jm.call(this,a,b,c)}C(km,jm);km.prototype.Cc=function(a,b){return new ol(this,this.h,a,b)};km.prototype.map=function(a,b){return this.g.map(a,b)};function lm(a,b,c,d){Mj.call(this,a,b,c,d);this.l=null}C(lm,Mj);h=lm.prototype;h.logger=P("ydn.db.core.req.IDBCursor");h.bg=function(a){(a=a.target.result)?this.ic(a.key,a.primaryKey,a.value):this.ic()};
h.openCursor=function(a,b){function c(a,b,c){p.l=n;p.l.onsuccess=ma(p.bg,p);p.ic(a,p.j?b:void 0,c);n=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");O(this.logger,d);var e=this.aa,d=this.o.objectStore(this.R),f=w(this.Cb)?d.index(this.Cb):null;if(s(a))var g=f?!s(b):!0,k=e?e.lower:void 0,l=e?e.upper:void 0,m=e?!!e.lowerOpen:!1,e=e?!!e.upperOpen:!1,e=kj(this.reverse?new S(k,a,m,g):new S(a,l,g,e));var n;this.bd?f?n=null!=this.Ib?f.openKeyCursor(e,this.Ib):null!=e?f.openKeyCursor(e):
f.openKeyCursor():n=null!=this.Ib?d.openCursor(e,this.Ib):null!=e?d.openCursor(e):d.openCursor():f?n=null!=this.Ib?f.openCursor(e,this.Ib):null!=e?f.openCursor(e):f.openCursor():n=null!=this.Ib?d.openCursor(e,this.Ib):null!=e?d.openCursor(e):d.openCursor();var p=this;n.onerror=function(a){var b=n.error;a.preventDefault();p.Z(b);Pj(p);p.G=!0};null!=a?n.onsuccess=function(d){if(d=d.target.result){var e=Lj.cmp(d.key,a),f=p.reverse?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);
else if(null!=b)if(Lj.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(p.l=n,p.l.onsuccess=ma(p.bg,p))};h.Rd=function(){return!!this.l};h.update=function(a){var b=this.l.result;if(b){var c=new D;a=b.update(a);a.onsuccess=function(a){c.C(a.target.result)};a.onerror=function(a){a.preventDefault();c.D(a)};return c}throw new lk("cursor gone");};
h.clear=function(){var a=this.l.result;if(a){var b=new D,a=a["delete"]();a.onsuccess=function(){b.C(1)};a.onerror=function(a){a.preventDefault();b.D(a)};return b}throw new lk("cursor gone");};h.advance=function(a){var b=this.l.result;if(1==a)b["continue"]();else b.advance(a)};h.zd=function(a){var b=this.l.result;if(null!=a)b["continue"](a);else b["continue"]()};h.J=function(){lm.m.J.call(this);this.l=null};h.toString=function(){return"IDB"+lm.m.toString.call(this)};function mm(a,b,c,d,e,f){D.call(this,e,f);this.j=a;this.g=[];this.p=!!b;this.Z=!!c;this.T=!!d;for(b=this.G=0;b<a.length;b++)a[b].B(ma(this.t,this,b,!0),ma(this.t,this,b,!1));0!=a.length||this.p||this.C(this.g)}C(mm,D);mm.prototype.t=function(a,b,c){this.G++;this.g[a]=[b,c];this.tb||(this.p&&b?this.C([a,c]):this.Z&&!b?this.D(c):this.G==this.j.length&&this.C(this.g));this.T&&!b&&(c=null);return c};mm.prototype.D=function(a){mm.m.D.call(this,a);for(a=0;a<this.j.length;a++)lb(this.j[a])};
function nm(a){return(new mm(a,!1,!0)).A(function(a){for(var c=[],d=0;d<a.length;d++)c[d]=a[d][1];return c})};function om(a,b){this.g=b}C(om,uk);h=om.prototype;h.logger=P("ydn.db.crud.req.IndexedDb");h.Bd=function(a,b){function c(e){var f=a.g.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?T(a,d):c(e)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}}var d=[];0==b.length?T(a,[]):c(0)};
h.kb=function(a,b,c,d,e,f){function g(t){if(null==e[t])if(O(n.logger,"empty object at "+t+" of "+e.length),l++,l==e.length)T(a,k,m);else{var z=t+10;z<e.length&&g(z)}var G,z=e[t];G=null!=f?b?r.put(z,f[t]):r.add(z,f[t]):b?r.put(z):r.add(z);G.onsuccess=function(b){l++;k[t]=b.target.result;l==e.length?T(a,c?k[0]:k,m):(b=t+10,b<e.length&&g(b))};G.onerror=function(b){l++;var f=G.error;O(n.logger,V(a)+p+' request to "'+d+'" cause '+f.name+' for object "'+xh(e[t])+'" at index '+t+" of "+e.length+" objects.");
k[t]=f;m=!0;b.preventDefault();l==e.length?T(a,c?k[0]:k,m):(b=t+10,b<e.length&&g(b))}}var k=[],l=0,m=!1,n=this,p=b?"put":"add",r=a.g.objectStore(d);O(this.logger,V(a)+" "+p+" "+e.length+' objects to store "'+d+'"');if(0<e.length)for(var t=0;10>t&&t<e.length;t++)g(t);else T(a,[])};
h.ae=function(a,b,c){function d(l){var n=c[l],p=n.I(),r=a.g.objectStore(p),t;t=null===r.keyPath?r.put(b[l],n.F()):r.put(b[l]);t.onsuccess=function(c){f++;e[l]=c.target.result;f==b.length?T(a,e,g):(c=l+10,c<b.length&&d(c))};t.onerror=function(c){f++;M(k.logger,"request result "+c.name+' error when put keys to "'+p+'" for object "'+xh(b[l])+'" at index '+l+" of "+b.length+" objects.");e[l]=t.error;g=!0;c.preventDefault();f==b.length?T(a,e,g):(c=l+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,k=this;O(this.logger,
V(a)+" putByKeys: of "+b.length+" objects");if(0<b.length)for(var l=0;10>l&&l<b.length;l++)d(l);else T(a,e,g)};
h.tf=function(a,b,c,d,e,f){function g(){var a={},b=e.indexOf("\n",n),d=!1,t;-1==b?(d=!0,t=e.substring(n)):(t=e.substring(n,b),n=b+1);for(var b=t.split(f),J=0;J<p.length;J++){var Q=b[J];r[J]&&(r[J]==wl?Q=Ha(Q,'"'):"INTEGER"==r[J]?Q=parseInt(Q,10):"NUMERIC"==r[J]&&(Q=parseFloat(Q)));a[p[J]]=Q}var oa=l.put(a);oa.onsuccess=function(a){m.push(a.target.result);d?c(m):g()};oa.onerror=function(a){"DataError"==a.name&&(a=new ik(k+": "+t.substring(0,70)));a.preventDefault();c(oa.error,!0)}}var k=X(this.g,d),
l=a.objectStore(d),m=[],n=e.indexOf("\n"),p=e.substr(0,n).split(f),r=[];for(a=0;a<p.length;a++){var t=Oj(k,p[a]);t?r[a]=t.type:p[a]==k.keyPath&&(r[a]=k.type)}n++;O(this.logger,b+" Loading data  of "+p.length+"-fields record to "+d);g()};
h.ce=function(a,b,c){var d=a.g.objectStore(b);O(this.logger,V(a)+" clearById: "+b+" "+c);var e=d.openCursor(oj.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){T(a,1)};c.onerror=function(){T(a,c.error,!0)}}else T(a,0)};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};
h.de=function(a,b){function c(k){k++;if(k>=b.length)0<g.length?T(a,g,!0):T(a,d);else{b[k].I()!=e&&(e=b[k].I(),f=a.g.objectStore(e));var l=f["delete"](b[k].F());l.onsuccess=function(){d++;c(k)};l.onerror=function(a){a.preventDefault();g[k]=l.error;c(k)}}}var d=0,e,f;O(this.logger,V(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
h.hd=function(a,b,c){var d=a.g.objectStore(b),e=d.count(c);O(this.logger,V(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,k=d["delete"](c);k.onsuccess=function(){T(a,e)};k.onerror=function(){T(a,k.error,!0)}};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};h.ye=function(a,b,c){var d=a.g.objectStore(b);O(this.logger,V(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){T(a,void 0)};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};
h.uf=function(a,b,c,d){var e=a.g.objectStore(b).index(c);O(this.logger,V(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),k=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){k++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?T(a,f,!0):T(a,k)};g.onerror=function(b){b.preventDefault();T(a,g.error,!0)}};
h.yd=function(a,b){var c=b.length,d=0;O(this.logger,V(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.g.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&T(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&T(a,f.error,!0)}}};
h.Gd=function(a,b,c){var d=this;O(this.logger,V(a)+b+":"+c);var e=a.g.objectStore(b),f=e.get(c);f.onsuccess=function(b){O(d.logger,V(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");var f=b.target.result;if(!e.keyPath&&0==e.indexNames.length&&Ib&&w(f)&&0<=f.indexOf(";base64,")){'"'==f.charAt(0)&&'"'==f.charAt(f.length-1)&&(f=f.substr(1,f.length-2));f=f.split(";base64,");b=f[0].split(":")[1];for(var f=window.atob(f[1]),l=f.length,m=new Uint8Array(l),n=0;n<l;++n)m[n]=f.charCodeAt(n);
T(a,new Blob([m.buffer],{type:b}))}else T(a,b.target.result)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}};
h.mf=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==k)T(a,e);else{var m=b+10;m<k&&d(m)}var n;n=g.get(c[b]);n.onsuccess=function(c){f++;e[b]=c.target.result;f==k?T(a,e):(c=b+10,c<k&&d(c))};n.onerror=function(b){f++;b.preventDefault();T(a,n.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.g.objectStore(b),k=c.length;O(this.logger,V(a)+" "+b+":"+k+" ids");if(0<k)for(b=0;10>b&&b<k;b++)d(b);else T(a,[])};
h.Wd=function(a,b){function c(f){var k=b[f],l=a.g.objectStore(k.I()).get(k.F());l.onsuccess=function(k){e++;d[f]=k.target.result;e==b.length?T(a,d):(k=f+10,k<b.length&&c(k))};l.onerror=function(b){e++;b.preventDefault();T(a,l.error,!0)}}var d=[];d.length=b.length;var e=0;O(this.logger,V(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else T(a,[])};
h.Nc=function(a,b,c,d,e){if(d&&e)throw new Pc("unique count not available in IndexedDB");e=a.g.objectStore(b);b=V(a)+" "+b+(d?":"+d:"")+(c?":"+yh(c):"");O(this.logger,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){T(a,b.target.result)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=[],p=a.g.objectStore(c),r=k?l?"prevunique":"prev":l?"nextunique":"next";c=V(a)+" "+b+" "+c+(d?":"+d:"")+(e?yh(e):"");k&&(c+=" reverse");l&&(c+=" unique");if(m&&s(m[0])){l=d?!s(m[1]):!0;var t=m[0],x=e?e.lower:void 0,z=e?e.upper:void 0,G=e?!!e.lowerOpen:!1;e=e?!!e.upperOpen:!1;e=kj(k?new S(x,t,G,l):new S(t,z,l,e));c+=" starting from "+yh(m[0]);s(m[1])&&(c+=", "+yh(m[1]))}O(this.logger,c);var E;E=1==b||2==b||3==b?d?p.index(d).openKeyCursor(e,r):p.openCursor(e,
r):d?p.index(d).openCursor(e,r):p.openCursor(e,r);var J=!1;E.onsuccess=function(c){if(c=c.target.result){if(!J){if(0<g){J=!0;c.advance(g);return}if(m&&d&&s(m[0]))if(s(m[1])){var e=Lj.cmp(c.key,m[0]),l=k?-1:1;if(0==e){e=Lj.cmp(c.primaryKey,m[1]);if(0==e){J=!0;c["continue"]();return}if(e==l)J=!0;else{c["continue"]();return}}else J=!0}else J=!0;else J=!0}1==b?n.push(c.key):2==b?n.push(c.primaryKey):3==b?(l={},d&&(l[d]=c.key),p.keyPath?l[p.keyPath]=c.primaryKey:l._ROWID_=c.primaryKey,n.push(l)):4==b?
n.push(c.value):n.push([c.key,c.primaryKey,c.value]);if(n.length<f)c["continue"]();else m&&(m[0]=Qj(c.key),m[1]=Qj(c.primaryKey)),T(a,n)}else m&&(m[0]=void 0,m[1]=void 0),T(a,n)};E.onerror=function(b){b.preventDefault();T(a,E.error,!0)}};function pm(a,b){this.g=b}C(pm,om);pm.prototype.logger=P("ydn.db.core.req.IndexedDb");pm.prototype.h=function(a,b,c,d){c=X(this.g,c);return new lm(a,b,c,d)};function qm(){this.g=!1}qm.prototype.g=!1;function rm(a,b,c,d){Mj.call(this,a,b,c,d);this.p=this.h=this.g=void 0;this.t=this.l=null;this.N=new qm;this.ge=this.Vb=null}C(rm,Mj);h=rm.prototype;h.logger=P("ydn.db.core.req.SimpleCursor");h.Rd=function(){return!!this.o};h.update=function(a){sm(this.ge,this.ha(),a);return sb()};h.advance=function(a){function b(b){d++;if(!b||d>=a)return tm(c,b)}var c=this,d=this.l?-1:0;this.reverse?um(this.Vb,b,this.l):vm(this.Vb,b,this.l)};
h.zd=function(a){if(null!=a){var b=this,c=new wm(a),d=function(c){b.l=c;if(!c)return tm(b,c);var d=sj(c.value.key,a);if(b.reverse){if(1!=d)return tm(b,c)}else if(-1!=d)return tm(b,c)};this.reverse?um(this.Vb,d,c):vm(this.Vb,d,c)}else this.advance(1)};function xm(a){setTimeout(function(){a.N.g?(a.N.g=!1,a.ic(a.g,a.h,a.p),xm(a)):(a.t(),a.t=null)},4)}
function tm(a,b){if(a.l=b){var c=b.value;if(a.aa)if(a.reverse||null==a.aa.upper)a.reverse&&null!=a.aa.lower&&(d=sj(c.key,a.aa.lower),-1==d||0==d&&a.aa.lowerOpen)&&(a.l=null);else{var d=sj(c.key,a.aa.upper);if(1==d||0==d&&a.aa.upperOpen)a.l=null}if(a.l){if(a.unique&&null!=a.g&&null!=c.key&&0==sj(a.g,c.key))return;a.g=c.key;a.h=a.j?c.ha():a.g;4==a.na&&(a.bd?a.p=a.h:a.p=a.ge.qa(null,a.h))}}a.l||(a.g=void 0,a.h=void 0,a.p=void 0);return a.N.g=!0}
h.openCursor=function(a,b){var c=null;if(this.aa)if(this.reverse){var d=this.j?"\uffff":void 0;null!=this.aa.upper&&(c=new wm(this.aa.upper,d))}else null!=this.aa.lower&&(c=new wm(this.aa.lower));null!=a&&(c=this.j?new wm(a,b):new wm(a));this.t=this.o.M(function(b){function d(b){var e=b.value,f=e.key;if(b&&null!=f)if(null!=a){if(0==zm(c,e))return}else if(this.aa&&(!this.reverse&&this.aa.lowerOpen&&null!=this.aa.lower&&(e=sj(f,this.aa.lower),0==e)||this.reverse&&this.aa.upperOpen&&null!=this.aa.upper&&
(e=sj(f,this.aa.upper),0==e)))return;return tm(this,b)}this.ge=Am(b,this.R);this.Vb=Bm(this.ge,this.Cb);this.reverse?um(this.Vb,ma(d,this),c):vm(this.Vb,ma(d,this),c);xm(this)},this)};h.clear=function(){throw new Oc;};h.toString=function(){return"Simple"+rm.m.toString.call(this)};function Cm(a,b,c){a=["ydn.db",a];s(b)&&(a.push(b),s(c)&&(a.push(c),s(void 0)&&a.push(xj(void 0))));return a.join("^|")};function wm(a,b){this.key=a;this.g=b}wm.prototype.ha=function(){return this.g};wm.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.g?", "+this.g+")":")")};function zm(a,b){var c=sj(a.key,b.key);return 0===c?null!=a.g?null!=b.g?sj(a.g,b.g):1:null!=b.g?-1:0:c};function Dm(a){this.Xa=a||Em}function Em(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}h=Dm.prototype;h.Ba=null;h.Xa=null;h.Fb=null;h.Db=null;
h.add=function(a){if(null==this.Ba)return this.Db=this.Fb=this.Ba=new Fm(a),!0;var b=null;Gm(this,function(c){var d=null;0<this.Xa(c.value,a)?(d=c.left,null==c.left&&(b=new Fm(a,c),c.left=b,c==this.Fb&&(this.Fb=b))):0>this.Xa(c.value,a)&&(d=c.right,null==c.right&&(b=new Fm(a,c),c.right=b,c==this.Db&&(this.Db=b)));return d});b&&(Gm(this,function(a){a.count++;return a.parent},b.parent),Hm(this,b.parent));return!!b};
h.remove=function(a){var b=null;Gm(this,function(c){var d=null;0<this.Xa(c.value,a)?d=c.left:0>this.Xa(c.value,a)?d=c.right:(b=c.value,Im(this,c));return d});return b};h.clear=function(){this.Db=this.Fb=this.Ba=null};h.contains=function(a){var b=!1;Gm(this,function(c){var d=null;0<this.Xa(c.value,a)?d=c.left:0>this.Xa(c.value,a)?d=c.right:b=!0;return d});return b};h.ca=function(){return this.Ba?this.Ba.count:0};h.Aa=function(){var a=[];Jm(this,function(b){a.push(b)});return a};
function Jm(a,b){if(a.Ba){var c,d=c=Km(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Gm(a,b,c){for(c=c?c:a.Ba;c&&null!=c;)c=b.call(a,c)}
function Hm(a,b){Gm(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Lm(this,a.left),Mm(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Mm(this,a.right),Lm(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Lm(a,b){Nm(b)?(b.parent.left=b.right,b.right.parent=b.parent):Om(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.Ba=b.right,a.Ba.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Mm(a,b){Nm(b)?(b.parent.left=b.left,b.left.parent=b.parent):Om(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.Ba=b.left,a.Ba.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Im(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Pm(a,b.left);Gm(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.Db&&(a.Db=d)}else{d=Km(a,b.right);Gm(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.Fb&&(a.Fb=d)}d.count=b.count;Nm(b)?b.parent.left=d:Om(b)?b.parent.right=d:a.Ba=d;Hm(a,c?c:d)}else Gm(a,function(a){a.count--;return a.parent},b.parent),Nm(b)?(b.parent.left=null,b==a.Fb&&(a.Fb=b.parent),Hm(a,b.parent)):Om(b)?(b.parent.right=null,b==a.Db&&(a.Db=b.parent),Hm(a,b.parent)):a.clear()}function Km(a,b){if(!b)return a.Fb;var c=b;Gm(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Pm(a,b){if(!b)return a.Db;var c=b;Gm(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Fm(a,b){this.value=a;this.parent=b?b:null;this.count=1}Fm.prototype.left=null;Fm.prototype.right=null;Fm.prototype.height=1;function Om(a){return!!a.parent&&a.parent.right==a}function Nm(a){return!!a.parent&&a.parent.left==a};function Qm(a){this.Xa=a||Em}C(Qm,Dm);function vm(a,b,c){if(a.Ba){var d;if(c instanceof Fm)d=c;else if(c){if(Gm(a,function(a){var b=null;0<this.Xa(a.value,c)?(b=a.left,d=a):0>this.Xa(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Km(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function um(a,b,c){if(a.Ba){var d;if(c instanceof Fm)d=c;else if(c){if(Gm(a,ma(function(a){var b=null;0<this.Xa(a.value,c)?b=a.left:(0>this.Xa(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Pm(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Rm(a,b,c){this.l=a;this.storage=b;this.h=c;this.g={};a=this.h.keyPath;this.i=u(a)?a.join(","):a||"_ROWID_";this.g[this.i]=null;this.j=Cm(this.l,this.h.getName(),this.i)+"^|"}
function Bm(a,b){var c=b||a.i;if(!a.g[c]){a.g[c]=new Qm(zm);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&sa(f,a.j)){var g=Aj(f.substr(a.j.length));if(c==a.i)a.g[c].add(new wm(g));else{var k=a.storage.getItem(f);if(null!==k)if(f=Oj(a.h,c),k=wh(k),k=xl(f,k),f.multiEntry){if(u(k))for(f=0;f<k.length;f++)a.g[c].add(new wm(k[f],g))}else a.g[c].add(new wm(k,g))}}}}return a.g[c]}
function Sm(a,b,c){for(var d in a.g){var e=a.g[d];if(e)if(d==a.i)e.remove(new wm(b));else{var f=Oj(a.h,d),f=uj(c,f.keyPath);e.remove(new wm(b,f))}}}function Tm(a){for(var b in a.g){var c=a.g[b];c&&c.clear()}a.g={}}
function sm(a,b,c,d){if(null==b&&(a.h.keyPath&&(b=Zk(a.h,c)),a.h.h&&null==b)){b=a.j+xj(void 0);var e=wh(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,yh(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.j+xj(b)));if(d)return null;a.storage.setItem(a.j+xj(b),yh(c));d=b;for(var f in a.g)if(e=a.g[f])if(f==a.i)e.add(new wm(d));else{var g=Oj(a.h,f),g=uj(c,g.keyPath);null!=g&&e.add(new wm(d,g))}return b}
function Um(a,b){var c=a.j+xj(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=wh(d);Sm(a,b,c);return 1}h=Rm.prototype;h.clear=function(){Tm(this);Vm(this)};h.qa=function(a,b){if(a&&a!=this.i)throw"impl";var c=this.storage.getItem(this.j+xj(b)),d=void 0;if(null!==c)for(var d=wh(c),c=0,e=this.h.indexes.length;c<e;c++){var f=this.h.index(c);if("DATE"==f.type){var g=xl(f,d);g&&yl(f,d,new Date(g))}}return d};h.getName=function(){return this.h.getName()};
function Wm(a,b,c){b=b||a.i;a=Bm(a,b);var d=null,e=null,f=0,g=!1,k=!1;null!=c&&(null!=c.lower&&(d=new wm(c.lower)),null!=c.upper&&(e=new wm(c.upper)),g=c.lowerOpen,k=c.upperOpen);vm(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=sj(a.key,d.key))){if(null!=e&&(a=sj(a.key,e.key),1===a||0===a&&k))return!0;f++}},d);return f}
function Vm(a,b){var c=Bm(a,a.i),d=null,e=null,f=0,g=[],k=[],l=!1,m=!1;null!=b&&(null!=b.lower&&(d=new wm(b.lower)),null!=b.upper&&(e=new wm(b.upper)),l=b.lowerOpen,m=b.upperOpen);vm(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=zm(b,d))){if(null!=e){var c=zm(b,e);if(1===c||0===c&&m)return!0}var c=a.j+xj(b.key),r=a.storage.getItem(c);null!==r&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),k.push(wh(r))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Sm(a,g[c],k[c]);else Tm(a);return f}
h.uc=function(a,b,c,d,e,f,g,k){function l(b){if(b&&(z++,!(z<f))){var c=b.value;if(d){if(E&&null!=x&&(b=p?zm(c,x):sj(c.key,x.key),0==b))return;if(null!=t&&(b=p?zm(c,t):sj(c.key,t.key),-1==b||0==b&&G))return k&&(k[0]=void 0,k[1]=void 0),!0}else{if(G&&null!=t&&(b=p?zm(c,t):sj(c.key,t.key),0==b))return;if(null!=x&&(b=p?zm(c,x):sj(c.key,x.key),1==b||0==b&&E))return k&&(k[0]=void 0,k[1]=void 0),!0}b=c.key;if(!g||!r||null==n||0!=sj(n,b)){c=r?c.ha():b;if(2==a)m.push(c);else if(1==a)m.push(b);else if(3==a)m.push([b,
c]);else if(4==a){var l=Q.qa(null,c);m.push(l)}else m.push([b,c,Q.qa(null,c)]);k&&(k[0]=b,k[1]=c)}n=b;if(s(e)&&m.length>=e)return!0}}var m=[],n,p=!!k&&null!=k[0];b=b||this.i;var r=b!=this.i;b=Bm(this,b);var t=null,x=null;s(f)||(f=0);var z=-1,G=!1,E=!1;null!=c&&(null!=c.lower&&(t=r&&d?new wm(c.lower,"\uffff"):new wm(c.lower)),null!=c.upper&&(x=r&&!d?new wm(c.upper,"\uffff"):new wm(c.upper)),G=!!c.lowerOpen,E=!!c.upperOpen);if(p){d?E=!0:G=!0;c=k[0];var J=s(k[1])?k[1]:"\uffff";d?x=r?new wm(c,J):new wm(c):
t=r?new wm(c,J):new wm(c)}var Q=this;d?um(b,l,x):vm(b,l,t);return m};h.Qa=function(a,b,c,d,e){return this.uc(2,a,b,c,d,e)};h.toString=function(){return"ydn.db.con.simple.Store:"+this.l+":"+this.h.getName()};function Xm(){this.clear()}h=Xm.prototype;h.Ae=function(){return this};h.setItem=function(a,b){s(this.g[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.g[a]=b};h.getItem=function(a){return s(this.g[a])?this.g[a]:null};h.removeItem=function(a){delete this.g[a];Za(this.keys,a.toString());this.length=this.keys.length};h.length=0;h.key=function(a){a=this.keys[a];return s(a)?this.g[a]:null};h.clear=function(){this.g={};this.keys=[];this.length=0};function Ym(a){this.o=a||new Xm;this.l={}}function Am(a,b){var c=X(a.g,b);if(c)a.l[b]||(a.l[b]=new Rm(a.i,a.j,c));else throw new Qc('store name "'+b+'" not found.');return a.l[b]}Ym.prototype.ib=function(a){var b=this;setTimeout(function(){var c=Cm(b.i),c=b.j.getItem(c),c=new Rl(c);a(c)},10)};function Zm(a,b){this.h=a;this.g=b}Zm.prototype.M=function(a,b){var c=this.h;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.g("complete",null);d.g=null;d.h=null}};function $m(a,b){this.g=b}C($m,uk);h=$m.prototype;h.logger=P("ydn.db.crud.req.SimpleStore");h.ae=function(a,b,c){this.kb(a,!0,!1,null,b,c)};
h.kb=function(a,b,c,d,e,f){O(this.logger,V(a)+" "+(b?"put":"add")+"Object"+(c?"":"s "+e.length+" objects"));var g=a.g.M(function(k){var l;if(c)l=Am(k,d),k=f?f[0]:void 0,k=sm(l,k,e[0],!b),null!=k?T(a,k):(l=xh(k),l=new hk(l),T(a,l,!0));else{for(var m=d,n=[],p=!1,r=f||{},t=0;t<e.length;t++){var x;d?x=r[t]:(m=f[t],x=m.F(),m=m.I());l&&l.getName()==m||(l=Am(k,m));x=sm(l,x,e[t],!b);null!=x?n.push(x):(p=!0,n.push(new hk))}T(a,n,p)}g();g=null},this)};h.tf=function(){throw new Oc("putData");};
h.Gd=function(a,b,c){var d=a.g.M(function(e){e=Am(e,b).qa(null,c);T(a,e);d();d=null},this)};function an(a,b,c,d){var e=b.g.M(function(a){for(var g=[],k=c,l,m=0;m<d.length;m++){var n=d[m];n instanceof rk&&(k=n,n=k.F(),k=k.I());l&&l.getName()==k||(l=Am(a,k));n=l.qa(null,n);g[m]=n}T(b,g,!1);e();e=null},a)}h.mf=function(a,b,c){an(this,a,b,c)};h.Wd=function(a,b){an(this,a,null,b)};
h.ce=function(a,b,c){var d=V(a)+" removeById "+b+" "+c;O(this.logger,d);var e=this,f=a.g.M(function(g){g=Um(Am(g,b),c);N(e.logger,"success "+d+(0==g?" [not found]":""));T(a,g);f();f=null},this)};h.de=function(a,b){O(this.logger,V(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=a.g.M(function(f){for(var g=0;g<b.length;g++){var k=b[g].I(),l=b[g].F();c&&c.getName()==k||(c=Am(f,k));d+=Um(c,l)}T(a,d);e();e=null},this)};h.ye=function(a,b,c){this.hd(a,b,c)};
h.hd=function(a,b,c){var d=V(a)+" removeByKeyRange "+(c?yh(c):"");O(this.logger,d);var e=this,f=a.g.M(function(g){g=Vm(Am(g,b),c);N(e.logger,d+" deleted "+g+" records.");T(a,g);f();f=null},this)};h.uf=function(a,b,c,d){var e=V(a)+" removeByIndexKeyRange "+(d?yh(d):"");O(this.logger,e);var f=a.g.M(function(e){e=Am(e,b);for(var k=e.Qa(c,d),l=k.length,m=0;m<l;m++)Um(e,k[m]);T(a,l);f();f=null},this)};
h.yd=function(a,b){var c=V(a)+" clearByStores";O(this.logger,c);var d=a.g.M(function(e){for(var f=0;f<b.length;f++)Am(e,b[f]).clear();N(this.logger,"success "+c);T(a,b.length);d();d=null},this)};h.Bd=function(a,b){var c=a.g.M(function(d){for(var e=[],f=0;f<b.length;f++){var g=Am(d,b[f]);e.push(Wm(g))}T(a,e);c();c=null},this)};
h.Nc=function(a,b,c,d){var e=V(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");O(this.logger,e);var f=a.g.M(function(g){g=Wm(Am(g,b),d,c);N(this.logger,"success "+e);T(a,g);f();f=null},this)};h.list=function(a,b,c,d,e,f,g,k,l,m){var n=V(a)+" "+c+" "+(e?xh(e):"");O(this.logger,n);var p=a.g.M(function(r){r=Am(r,c).uc(b,d,e,k,f,g,l,m);N(this.logger,n+" "+r.length+" records found.");T(a,r);p();p=null},this)};function bn(a,b){this.g=b}C(bn,$m);bn.prototype.h=function(a,b,c,d){c=X(this.g,c);return new rm(a,b,c,d)};function cn(a,b,c,d){Mj.call(this,a,b,c,d);this.N=null;this.t=this.l=void 0}C(cn,Mj);h=cn.prototype;h.logger=P("ydn.db.core.req.WebsqlCursor");h.ha=function(){return this.t};h.init=function(a,b,c,d,e){cn.m.init.call(this,a,b,c,d,e);this.N=w(b)?Oj(this.i,b):null};h.V=function(){return this.ea};function dn(a,b){a.l=void 0;a.t=void 0;a.ea=void 0;if(s(b))if(A(b)){var c=zl(b[a.i.l],a.i.type);a.t=c;if(a.j){var d=Oj(a.i,a.Cb);a.l=zl(b[a.Cb],d.type)}else a.l=c;a.ea=a.bd?c:en(b,a.i)}else a.ea=b}
function fn(a,b,c,d,e,f){var g=!d;d=[];a.j&&null!=f&&null!=c?c=Il(a.i,a.na,d,a.N.getName(),a.aa,c,g,f,a.reverse,a.unique):null!=c?(f=a.N?a.N.getName():null,c=Hl(a.i,a.na,d,f,a.aa,a.reverse,a.unique,c,g)):(c=El(a.i,d,a.na,a.j?a.N.j:a.i.l,a.aa,a.reverse,a.unique),a.j&&(c+=", "+a.i.j+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);O(a.logger,a+": continue:  SQL: "+c+" : "+yh(d));a.o.executeSql(c,d,function(c,d){0<d.rows.length?dn(a,d.rows.item(0)):dn(a);b.call(a,a.l,a.t,a.ea);b=null},function(c,d){M(a.logger,
"get error: "+d.message);a.Z(d);Pj(a);a.G=!0;dn(a);b.call(a,a.t,a.l,a.ea);b=null;return!1})}h.Rd=function(){return!!this.o};h.update=function(a){if(!this.Rd())throw new lk;var b=new D,c=this.ha();a=Ll(this.i,a,c);var d="REPLACE INTO "+Gl(this.i)+" ("+a.$f.join(", ")+") VALUES ("+a.zg.join(", ")+")";O(this.logger,this+': update "'+d+'" : '+yh(a.values));this.o.executeSql(d,a.values,function(){b.C(c)},function(a,c){b.D(c);return!1});return b};
h.advance=function(a){var b=this.l,c=this.t,d=!0;null==this.l||this.j&&null==this.t||(a-=1,d=!1);fn(this,function(a,d,g){var k=null!=b&&null!=a&&0==sj(b,a);if(this.j){var l=null!=d&&null!=c&&0==sj(d,c);if(k&&l)throw new Qc("current: "+b+";"+c+" next: "+a+";"+d);}else if(k)throw new Qc("current: "+b+" next: "+a);this.ic(a,d,g)},this.l,d,a,this.t)};h.zd=function(a){null!=a?fn(this,this.ic,a,!0):this.advance(1)};h.openCursor=function(a,b){fn(this,this.ic,a,!1,0,b)};
h.clear=function(){if(!this.Rd())throw new lk;var a=new D,b=this.i.l,b="DELETE FROM "+Gl(this.i)+" WHERE "+b+" = ?",c=[this.ha()];O(this.logger,this+': clear "'+b+'" : '+yh(c));this.o.executeSql(b,c,function(b,c){a.C(c.rowsAffected)},function(b,c){a.D(c);return!1});return a};h.toString=function(){return"WebSql"+cn.m.toString.call(this)};function gn(a,b){this.g=b}C(gn,uk);h=gn.prototype;h.logger=P("ydn.db.crud.req.WebSql");
function en(a,b){if(b.nc&&!b.keyPath&&0==b.indexes.length&&a._default_){var c=a._default_;if(-1==c.indexOf(";base64,"))return wh(c);'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substr(1,c.length-2));for(var d=c.split(";base64,"),c=d[0].split(":")[1],d=window.atob(d[1]),e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f.buffer],{type:c})}c=a._default_?wh(a._default_):{};null!=b.keyPath&&(d=zl(a[b.keyPath],b.type),null!=d&&fl(b,c,d));for(d=0;d<b.indexes.length;d++)e=
b.index(d),f=e.j,"_default_"==f||e.o||e.multiEntry||"DATE"!=e.type&&!b.nc||(f=zl(a[f],e.type),s(f)&&yl(e,c,f));return c}h.tf=function(){throw new Oc("putData");};
h.kb=function(a,b,c,d,e,f){function g(b,d){if(null==e[b])if(O(m.logger,"empty object at "+b+" of "+e.length),p++,p==e.length)N(m.logger,r+" success "+r),T(a,n,t);else{var G=b+2;G<e.length&&g(G,d)}var E;E=s(f)?Ll(k,e[b],f[b]):Ll(k,e[b]);G=l+Gl(k)+" ("+E.$f.join(", ")+") VALUES ("+E.zg.join(", ")+");";O(m.logger,V(a)+" SQL: "+G+" PARAMS: "+E.values+" REQ: "+b+" of "+e.length);d.executeSql(G,E.values,function(f,r){function G(b,c){var e="ydn.db.me:"+k.getName()+":"+b.getName(),e=l+Ka(e)+" ("+k.j+", "+
b.i+") VALUES (?, ?)",f=[tj(I,k.type),tj(c,b.type)];O(m.logger,V(a)+" multiEntry "+e+" "+f);d.executeSql(e,f,function(){},function(a,b){M(m.logger,"multiEntry index insert error: "+b.message);return!1})}p++;var I=s(E.key)?E.key:r.insertId;1>r.rowsAffected&&(t=!0,I=new hk(I+" no-op"));for(var Bc=0,gj=k.indexes.length;Bc<gj;Bc++){var jd=k.index(Bc);if(jd.multiEntry)for(var fe=uj(e[b],jd.keyPath),Wv=(fe?fe.length:0)||0,ym=0;ym<Wv;ym++)G(jd,fe[ym])}c?T(a,I):(n[b]=I,p==e.length?T(a,n,t):(Bc=b+2,Bc<e.length&&
g(Bc,f)))},function(d,f){p++;t=!0;6==f.code?f.name="ConstraintError":M(m.logger,"error: "+f.message+" "+r);if(c)T(a,f,!0);else if(n[b]=f,p==e.length)O(m.logger,"success "+r),T(a,n,t);else{var k=b+2;k<e.length&&g(k,d)}return!1})}b=!b;var k=X(this.g,d),l=b?"INSERT INTO ":"INSERT OR REPLACE INTO ";d=a.g;var m=this,n=[],p=0,r=V(a)+" inserting "+e.length+" objects.",t=!1;if(0<e.length)for(b=0;2>b&&b<e.length;b++)g(b,d);else N(this.logger,"success"),T(a,[])};
h.ae=function(a,b,c){if(0==c.length)T(a,[]);else{for(var d=[],e=0,f=0,g=this,k=function(k,l){var m=[];O(g.logger,"put "+l.length+" objects to "+k);for(var n=Kl(X(g.g,k)),p=n?void 0:[],r=0;r<l.length;r++)m.push(b[l[r]]),n||p.push(c[l[r]].F());n=ck(a);n.B(function(b){for(var c=0;c<l.length;c++)d[l[c]]=b[c];e++;e==f&&T(a,d)},function(){e++;e==f&&T(a,d,!0)});g.kb(n,!1,!1,k,m,p)},l="",m=[],n=[],p=0;p<c.length;p++){var r=c[p].I(),t=c[p].F();r!=l?(f++,0<m.length&&k(l,m),m=[p],n=[t],l=r):(m.push(p),n.push(t))}0<
m.length&&k(l,m)}};h.Gd=function(a,b,c){var d=a.g,e=X(this.g,b),f=this;b=e.j;c=[tj(c,e.type)];b="SELECT * FROM "+Gl(e)+" WHERE "+b+" = ?";var g=V(a)+" SQL: "+b+" PARAMS: "+c;O(this.logger,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=en(d,e),T(a,d)):(N(f.logger,"success no result: "+g),T(a,void 0))}else N(f.logger,"success no result: "+g),T(a,void 0)},function(b,c){M(f.logger,"error: "+g+" "+c.message);T(a,c,!0);return!1})};
h.mf=function(a,b,c){function d(b,e){var p=l.j,r=[tj(c[b],l.type)],t="SELECT * FROM "+Gl(l)+" WHERE "+p+" = ?";O(f.logger,"SQL: "+t+" PARAMS: "+r);e.executeSql(t,r,function(e,f){k++;if(0<f.rows.length){var n=f.rows.item(0);null!=n&&(g[b]=en(n,l))}else g[b]=void 0;k==c.length?T(a,g):(n=b+10,n<c.length&&d(n,e))},function(e,l){k++;M(f.logger,"error: "+t+" "+l.message);if(k==c.length)T(a,g);else{var n=b+10;n<c.length&&d(n,e)}return!1})}var e=a.g,f=this,g=[],k=0,l=X(this.g,b);if(0<c.length)for(b=0;10>
b&&b<c.length;b++)d(b,e);else N(f.logger,"success"),T(a,[])};
h.Wd=function(a,b){function c(d,k){var n=b[d],p=X(e.g,n.I()),r=sk(n),n=p.j,r=[tj(r,p.type)],t="SELECT * FROM "+Gl(p)+" WHERE "+n+" = ?";O(e.logger,"SQL: "+t+" PARAMS: "+r);k.executeSql(t,r,function(k,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=en(n,p))}else f[d]=void 0;g==b.length?(O(e.logger,"success "+t),T(a,f)):(n=d+10,n<b.length&&c(n,k))},function(b,c){T(a,c,!0);return!1})}var d=a.g,e=this,f=[],g=0;if(0<b.length)for(var k=0;10>k&&k<b.length;k++)c(k,d);else O(this.logger,"success"),
T(a,[])};
h.yd=function(a,b){function c(d,g){function k(a){a="ydn.db.me:"+l.getName()+":"+a.getName();a="DELETE FROM  "+Ka(a);O(e.logger,"SQL: "+a);g.executeSql(a,[])}var l=X(e.g,b[d]),m="DELETE FROM  "+Gl(l);O(e.logger,"SQL: "+m+" PARAMS: []");g.executeSql(m,[],function(g){d==b.length-1?(O(e.logger,"success "+m),T(a,b.length)):c(d+1,g)},function(b,c){T(a,c,!0);return!1});for(var n=0,p=l.indexes.length;n<p;n++){var r=l.index(n);r.multiEntry&&k(r)}}var d=a.g,e=this;0<b.length?c(0,d):(O(this.logger,"success"),
T(a,0))};
h.de=function(a,b){function c(k){if(k>=b.length)T(a,f,g);else{var l=X(e.g,b[k].I()),m=tj(b[k].F(),l.type),n=" WHERE "+l.j+" = ?",p="DELETE FROM "+Gl(l)+n,r=V(a)+" SQL: "+p+" PARAMS: "+[m];d.executeSql(p,[m],function(){f++;c(k)},function(a,b){M(e.logger,"error: "+r+b.message);g=!0;c(k);return!1});k++;for(var p=function(b){b="ydn.db.me:"+l.getName()+":"+b.getName();b="DELETE FROM  "+Ka(b)+n;O(e.logger,V(a)+NaN+b);d.executeSql(b,[m])},t=0,x=l.indexes.length;t<x;t++){var z=l.index(t);z.multiEntry&&p(z)}}}
var d=a.g,e=this,f=0,g=!1;O(this.logger,V(a)+" removeByKeys: "+b.length+" keys");c(0)};
h.ce=function(a,b,c){function d(b){b="ydn.db.me:"+f.getName()+":"+b.getName();b="DELETE FROM  "+Ka(b)+l;O(k.logger,V(a)+NaN+b);e.executeSql(b,[g])}var e=a.g,f=X(this.g,b),g=tj(c,f.type),k=this,l=" WHERE "+f.j+" = ?";b="DELETE FROM "+Gl(f)+l;O(this.logger,V(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){T(a,c.rowsAffected)},function(b,c){T(a,c,!0);return!1});b=0;for(c=f.indexes.length;b<c;b++){var m=f.index(b);m.multiEntry&&d(m)}};h.ye=function(a,b,c){hn(this,a,b,void 0,c)};
h.hd=function(a,b,c){hn(this,a,b,void 0,c)};h.uf=function(a,b,c,d){hn(this,a,b,c,d)};
function hn(a,b,c,d,e){function f(c){c="ydn.db.me:"+k.getName()+":"+c.getName();c="DELETE FROM  "+Ka(c)+n;O(a.logger,V(b)+NaN+c);g.executeSql(c,m)}var g=b.g,k=X(a.g,c);c="DELETE FROM "+Gl(k);var l=[],m=[],n="";null!=e&&(s(d)?(d=Oj(k,d),rj(d.i,d.type,e,m,l)):rj(k.j,k.type,e,m,l),n=" WHERE "+m.join(" AND "));c+=n;var p=V(b)+" SQL: "+c+" PARAMS: "+l;O(a.logger,p);g.executeSql(c,l,function(c,d){O(a.logger,"success "+p);T(b,d.rowsAffected)},function(c,d){M(a.logger,"error: "+p+d.message);T(b,d,!0);return!1});
e=0;for(d=k.indexes.length;e<d;e++)c=k.index(e),c.multiEntry&&f(c)}h.Bd=function(a,b){function c(g){var k="SELECT COUNT(*) FROM "+Ka(b[g]);O(e.logger,"SQL: "+k+" PARAMS: []");d.executeSql(k,[],function(d,e){var k=e.rows.item(0);f[g]=parseInt(k["COUNT(*)"],10);g++;g==b.length?T(a,f):c(g)},function(b,c){T(a,c,!0);return!1})}var d=a.g,e=this,f=[];0==b.length?(O(this.logger,"success"),T(a,0)):c(0)};
h.Nc=function(a,b,c,d,e){var f=[];b=El(X(this.g,b),f,6,d,c,!1,e);O(this.logger,V(a)+" SQL: "+b+" PARAMS: "+f);a.g.executeSql(b,f,function(b,c){var d=c.rows.item(0);T(a,Vl(d))},function(b,c){T(a,c,!0);return!1})};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=this,p=[],r=X(this.g,c),t=r.l,x=r.type,z=x,G=null!=d&&d!==t?Oj(r,d):null,E=d||t;G&&(z=G.type);c=[];if(m&&s(m[0])){var J=m[0];G&&s(m[1])?(d=m[1],e=Il(r,b,c,G.getName(),e,J,!0,d,k,l)):e=Hl(r,b,c,d,e,k,l,J,!0)}else e=El(r,c,b,E,e,k,l);y(f)&&(e+=" LIMIT "+f);y(g)&&(e+=" OFFSET "+g);var Q=a+" SQL: "+e+" ;params= "+yh(c);O(this.logger,Q);a.g.executeSql(e,c,function(c,d){for(var e=d.rows.length,f,g=0;g<e;g++)f=d.rows.item(g),2==b?p[g]=zl(f[t],x):1==b?p[g]=zl(f[E],
z):3==b?p[g]=[zl(f[E],z),zl(f[t],x)]:null!=f&&(p[g]=en(f,r));N(n.logger,"success "+a);m&&f&&(m[0]=zl(f[E],z),m[1]=zl(f[t],x));T(a,p)},function(b,c){M(n.logger,"error: "+Q+c.message);T(a,c,!0);return!1})};function jn(a,b){this.g=b}C(jn,gn);jn.prototype.logger=P("ydn.db.core.req.WebSql");jn.prototype.h=function(a,b,c,d){c=X(this.g,c);return new cn(a,b,c,d)};km.prototype.H=function(){var a=yk(this);if("indexeddb"==a)return new pm(0,this.h);if("websql"==a)return new jn(0,this.h);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new bn(0,this.h);throw new Qc("No executor for "+a);};function kn(a){return w(a)?a.replace(/\D/g,"").replace(/^0+/,""):null}function ln(a){if(!w(a)||!/[\w\+]+@\w+\.\w+/.test(a))return null;a=a.replace(/.*</,"").replace(/>.*/,"");a=a.toLowerCase();a=a.replace(/\+\w*?@/,"@");for(var b=a.indexOf("@");0<=b;b--);return a};function mn(a){if(!w(a))throw new Dh;this.ab=a;this.j=Jj;this.g=[];nn(this,a);this.ld=""}h=mn.prototype;h.ab="";h.tg=NaN;h.ug=NaN;h.Ef=!1;h.ld="";
function nn(a,b){var c=b.split(/\sFROM\s/i);if(2==c.length){var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==c.length){a.l=c[1].toUpperCase();if("SELECT"==a.l)a.j=Ij;else if("INSERT"==a.l)a.j=Jj;else if("UPDATE"==a.l)a.j=Jj;else if("DELETE"==a.l)a.j=Jj;else return;var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.i=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.i=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-
1):new pk("missing closing parentheses"));a.H=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.h=d.substring(c),d=d.substring(0,c)):a.h="";c=d.search(/WHERE/i);0<c?(a.o=d.substring(c+6).trim(),d=d.substring(0,c)):a.o="";a.g=d.trim().split(",").map(function(a){a=Ha(a,'"');a=Ha(a,"'");return a.trim()})}}}
h.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.ab=this.ab.replace("?",a[b]);nn(this,this.ab)}this.p=on(this);if(!this.p)return this.ld;a=this.h.length;if(b=/OFFSET\s+(\d+)/i.exec(this.h))this.ug=parseInt(b[1],10),a=this.h.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.h))this.tg=parseInt(b[1],10),b=this.h.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.h.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.Ef="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.Ef=!1,this.t=Ha(Ha(a,'"'),"'")):this.t=void 0;return""};function pn(a){if("*"==a.H)return null;a=a.H.split(",");return a=a.map(function(a){return Ha(a.trim(),'"')})}h.toJSON=function(){return{sql:this.ab}};
function on(a){function b(a){return Wa(c,function(b){return b.Sc()==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.o.length)for(var e=a.o.split("AND"),f=0;f<e.length;f++){var g=e[f],k=d.exec(g);if(k){var l=k[1].trim(),l=Ha(l,'"'),l=Ha(l,"'");if(0<l.length){var m=k[3].trim();sa(m,'"')?m=Ha(m,'"'):sa(m,"'")?m=Ha(m,"'"):m=parseFloat(m);k=new Fj(l,k[2],m);l=b(l);if(0<=l){if(c[l]=c[l].we(k),!c[l])return a.ld='where clause "'+g+'" conflict',null}else c.push(k)}else return a.ld='Invalid clause "'+g+'"',
null}else return a.ld='Invalid clause "'+g+'"',null}return c}h.toString=function(){return"query:"+this.ab};function qn(a,b){this.g=b;this.h=a}qn.prototype.logger=P("ydn.db.sql.req.nosql.Node");qn.prototype.toJSON=function(){return{sql:this.g}};qn.prototype.toString=function(){return"idb.Node:"};
qn.prototype.execute=function(a,b){var c=bb(this.g.g)[0],d=this.g.p,e=this.g.tg,e=isNaN(e)?100:e,f=this.g.ug,f=isNaN(f)?0:f,g=this.g.t,k=pn(this.g),l=null,m=this.g.Ef;if(0==d.length)l=null;else if(1==d.length)l=lj(d[0].g);else throw new Nc("too many conditions.");null===k||ek(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=k.length;if(1==b)return uj(a,k[0]);for(var c={},d=0;d<b;d++)c[k[d]]=uj(a,k[d]);return c}));c(d,b)});var d=0<d.length?d[0].Sc():void 0,n=V(a)+" executing on"+c;d&&(n+=":"+
d);n+=" "+qj(l);N(this.logger,n);g&&g!=this.h.keyPath?b.list(a,4,c,g,l,e,f,m,!1):s(d)&&d!=this.h.keyPath?b.list(a,4,c,d,l,e,f,m,!1):b.list(a,4,c,null,l,e,f,m,!1)};function rn(a,b){qn.call(this,a,b)}C(rn,qn);
rn.prototype.execute=function(a,b){var c,d=bb(this.g.g)[0],e=this.g.p,f=null;if(0==e.length)f=null;else if(1==e.length)f=lj(e[0].g);else throw new Nc("too many conditions.");var g=this.g.i,e=0<e.length?e[0].Sc():void 0,k=V(a)+" executing "+g+" on "+d;e&&(k+=":"+e);k+=" "+qj(f);N(this.logger,k);if("COUNT"==g)f?b.Nc(a,d,f,e,!1):b.Nc(a,d,null,void 0,!1);else{var l,k=pn(this.g);if(!k||0==k.length)throw new Jh("field name require for reduce operation: "+g);k=k[0];if("MIN"==g)l=sn(k);else if("MAX"==g)l=
tn(k);else if("AVG"==g)c=0,l=un(k);else if("SUM"==g)c=0,l=vn(k);else throw new Eh(g);var m;s(e)?m=new Xj(d,e,f):m=new Wj(d,f);var d=b.h(a.g,V(a),d,4),n=m.load([d]);n.Z=function(b){T(a,b,!0)};var p=0;n.T=function(b){null!=b?(b=m.g?n.ha():n.V(),c=l(b,c,p),n.advance(1),p++):T(a,c)}}};function un(a){return function(b,c,d){s(c)||(c=0);return(c*d+b[a])/(d+1)}}function vn(a){return function(b,c){return c+b[a]}}function sn(a){return function(b,c){var d=b[a];return s(c)?c<d?c:d:d}}
function tn(a){return function(b,c){var d=b[a];return s(c)?c>d?c:d:d}};function wn(a,b){this.g=b}C(wn,pm);wn.prototype.logger=P("ydn.db.sql.req.IndexedDb");wn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new pk(c);c=bb(b.g);if(1==c.length){var d=X(this.g,c[0]);if(!d)throw new mk(c[0]);var e=pn(b);if(e)for(var f=0;f<e.length;f++)if(!Vk(d,e[f]))throw new mk('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new rn(d,b):g=new qn(d,b);g.execute(a,this)}else throw new Eh(b.ab);};function xn(a,b){this.h=b;this.i=a;this.g=pn(b)}xn.prototype.logger=P("ydn.db.sql.req.websql.Node");xn.prototype.toJSON=function(){return{sql:this.h.ab}};xn.prototype.toString=function(){return"websql.Node:"};function yn(a,b){if(a.g){if(1==a.g.length){if(A(b))return kc(b,a.g[0]);return}for(var c={},d=0;d<a.g.length;d++)c[a.g[d]]=kc(b,a.g[d]);return c}return en(b,a.i)}
xn.prototype.execute=function(a,b,c){var d=this,e=[];b.executeSql(this.h.ab,c,function(b,c){for(var k=c.rows.length,l=0;l<k;l++){var m=c.rows.item(l);if(A(m))var n=yn(d,m);e.push(n)}a(e)},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function zn(a,b){xn.call(this,a,b)}C(zn,xn);zn.prototype.execute=function(a,b,c){var d=this;b.executeSql(this.h.ab,c,function(b,c){var d=c.rows.length;if(1==d)d=Vl(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new kk;},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function An(a,b){this.g=b}C(An,jn);An.prototype.logger=P("ydn.db.sql.req.WebSql");An.prototype.executeSql=function(a,b,c){var d=bb(b.g);if(1==d.length){var e=X(this.g,d[0]);if(!e)throw new mk(d[0]);var f=pn(b);if(f)for(var g=0;g<f.length;g++)if(!Vk(e,f[g]))throw new mk('Index "'+f[g]+'" not found in '+d[0]);var k;b.i?k=new zn(e,b):k=new xn(e,b);k.execute(function(b,c){T(a,b,c)},a.g,c)}else throw new Eh(b.ab);};function Bn(a,b){this.g=b}C(Bn,bn);Bn.prototype.logger=P("ydn.db.sql.req.SimpleStore");Bn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new pk(c);c=bb(b.g);if(1==c.length){var d=X(this.g,c[0]);if(!d)throw new mk(c[0]);var e=pn(b);if(e)for(var f=0;f<e.length;f++)if(!Vk(d,e[f]))throw new L('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new rn(d,b):g=new qn(d,b);g.execute(a,this)}else throw new Nc(b.ab);};function Cn(a,b,c,d){Jk.call(this,a,b,c,d)}C(Cn,ol);Cn.prototype.executeSql=function(a,b){for(var c=new mn(a),d=bb(c.g),e=0;e<d.length;e++){var f=X(this.h,d[e]);if(!f)throw new L("store: "+f+" not exists.");}N(this.logger,"executeSql: "+a+" params: "+b);var g=this.g.request("sql",bb(c.g),c.j);U(g,function(){W(this).executeSql(g,c,b||[])},this);return g};function Dn(a,b,c){jm.call(this,a,b,c)}C(Dn,km);Dn.prototype.Cc=function(a,b){return new Cn(this,this.h,a,b)};Dn.prototype.executeSql=function(a,b){return this.g.executeSql(a,b)};Dn.prototype.H=function(){var a=yk(this);if("indexeddb"==a)return new wn(0,this.h);if("websql"==a)return new An(0,this.h);if("memory"==a||"localstorage"==a||"sessionstorage"==a)return new Bn(0,this.h);throw new Qc("No executor for "+a);};function En(a,b){s(a)&&5242880<a&&M(this.logger,"storage size request ignored, use Quota Management API instead");this.ia=null;this.jd=b||NaN}h=En.prototype;
h.connect=function(a,b){function c(a,c,d){N(e.logger,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)Fn(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Sk(b,c[d])||(a.deleteObjectStore(c[d]),N(e.logger,"store: "+c[d]+" deleted."))}function d(a,b){f.tb?M(e.logger,"database already set."):s(b)?(M(e.logger,b?b.message:"Error received."),e.ia=null,f.D(b)):(e.ia=a,e.ia.onabort=function(a){O(e.logger,e+": abort");e.md(a.target.error)},
e.ia.onerror=function(a){O(e.logger,e+": error");e.md(a.target.error)},e.ia.onversionchange=function(a){O(e.logger,e+" closing connection for onversionchange to: "+a.version);if(e.ia&&(e.ia.onabort=null,e.ia.onblocked=null,e.ia.onerror=null,e.ia.onversionchange=null,e.$d(a),!a.defaultPrevented)){e.ia.close();e.ia=null;var b=Error();b.name=a.type;e.oe(b)}},f.C(parseFloat(g)))}var e=this,f=new D,g=void 0,k=b.version;N(e.logger,"Opening database: "+a+" ver: "+(b.Ac?"auto":k));var l;l=s(k)?Lj.open(a,
k):Lj.open(a);l.onsuccess=function(f){var k=f.target.result;s(g)||(g=k.version);N(e.logger,"Database: "+k.name+", ver: "+k.version+" opened.");if(b.Ac)e.ib(function(f){if(b instanceof Ok)for(var g=0;g<f.stores.length;g++)Sk(b,f.stores[g].getName())||Pk(b,f.stores[g].ga());f=Sl(b,f,!1,!0);if(0<f.length){N(e.logger,"Schema change require for difference in "+f);var l=y(k.version)?k.version+1:1;if("IDBOpenDBRequest"in q){k.close();var m=Lj.open(a,l);m.onupgradeneeded=function(a){a=a.target.result;N(e.logger,
"re-open for version "+a.version);c(a,m.transaction,!1)};m.onsuccess=function(a){d(a.target.result)};m.onerror=function(){N(e.logger,e+": fail.");d(null)}}else{var p=k.setVersion(l+"");p.g=function(a){M(e.logger,"migrating from "+k.version+" to "+l+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=E;c(k,p.transaction,!0)};var E=function(){var b=Lj.open(a);b.onsuccess=function(a){a=a.target.result;N(e.logger,e+": OK.");d(a)};b.onerror=function(){N(e.logger,e+": fail.");d(null)}};
null!=p.transaction&&(p.transaction.oncomplete=E)}}else d(k)},void 0,k);else if(b.version>k.version){var l=k.setVersion(b.version);l.g=function(a){M(e.logger,"migrating from "+k.version+" to "+b.version+" failed.");d(null,a)};l.onsuccess=function(){c(k,l.transaction,!0)}}else b.version==k.version?N(e.logger,"database version "+k.version+" ready to go"):M(e.logger,"connected database version "+k.version+" is higher than requested version."),e.ib(function(a){a=Sl(b,a,!1,!0);0<a.length?(N(e.logger,a),
d(null,new Hh("different schema: "+a))):d(k)},void 0,k)};l.onupgradeneeded=function(a){a=a.target.result;g=NaN;N(e.logger,"upgrade needed for version "+a.version);c(a,l.transaction,!1)};l.onerror=function(c){e.logger.log(Qe,'open request to database "'+a+'" '+(s(b.version)?" with version "+b.version:"")+" cause error of "+l.error.name,void 0);d(null,c)};l.onblocked=function(c){e.logger.log(Qe,"database "+a+" "+b.version+" block, close other connections.",void 0);d(null,c)};y(this.jd)&&!isNaN(this.jd)&&
setTimeout(function(){"done"!=l.readyState&&(e.logger.log(Qe,e+": database state is still "+l.readyState,void 0),d(null,new qk("connection timeout after "+e.jd)))},this.jd);return f};h.jd=18E4;h.oe=function(){};h.md=function(){};h.$d=function(){};h.Jc=function(){return"indexeddb"};h.ne=function(){return!!this.ia};h.logger=P("ydn.db.con.IndexedDb");h.ia=null;h.me=function(){return this.ia?parseFloat(this.ia.version):void 0};
h.ib=function(a,b,c){c=c||this.ia;if(s(b)){if(null===b){if(0==c.objectStoreNames.length){a(new Rl(c.version));return}throw new Gh;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new Rl(c.version));return}b=c.transaction(b,Ij)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var k=b.objectStore(e[d]),l=[],m=0,n=k.indexNames.length;m<n;m++){var p=k.index(k.indexNames[m]);l[m]=new ul(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new Lk(k.name,k.keyPath,k.autoIncrement,void 0,l)}b=new Rl(c.version,f);a(b)};
function Fn(a,b,c,d){function e(){var a={autoIncrement:!!d.h};null!=d.keyPath&&(a.keyPath=d.keyPath);return b.createObjectStore(d.getName(),a)}O(a.logger,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName())){c=c.objectStore(d.getName());Bl(d.keyPath||"",c.keyPath||"")?(b.deleteObjectStore(d.getName()),M(a.logger,"store: "+d.getName()+" deleted due to keyPath change."),c=e()):fa(c.autoIncrement)&&fa(d.h)&&c.autoIncrement!=d.h&&(b.deleteObjectStore(d.getName()),
M(a.logger,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e());for(var f=c.indexNames,g=0;g<d.indexes.length;g++){var k=d.index(g);!f.contains(k.getName())&&k.l&&(c.clear(),M(a.logger,"store: "+d.getName()+" cleared since generator index need re-indexing."))}for(var l=0,m=0,n=0,g=0;g<d.indexes.length;g++){var k=d.index(g),p=!1;if(f.contains(k.getName())){var r=c.index(k.getName()),t=null!=r.unique&&null!=k.unique&&r.unique!=k.unique,x=null!=r.multiEntry&&null!=k.multiEntry&&r.multiEntry!=
k.multiEntry,r=null!=r.keyPath&&null!=k.keyPath&&!!Bl(r.keyPath,k.keyPath);if(t||x||r)c.deleteIndex(k.getName()),p=!0,l--,n++}else"BLOB"!=k.type&&(p=!0);p&&(k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath),l++)}for(g=0;g<f.length;g++)Vk(d,f[g])||(c.deleteIndex(f[g]),m++);O(a.logger,"Updated store: "+c.name+", "+l+" index created, "+m+" index deleted, "+n+" modified.")}else{c=e();for(g=0;g<d.indexes.length;g++)k=
d.index(g),"BLOB"==k.type?a.logger.info("Index "+k+" of blob data type ignored."):(O(a.logger,"Creating index: "+k),k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath));O(a.logger,"Created store: "+c)}}
h.Dd=function(a,b,c,d){var e=this.ia;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};h.le=function(){O(this.logger,this+" closing connection");this.ia.close()};h.toString=function(){return"IndexedDB:"+(this.ia?this.ia.name+":"+this.ia.version:"")};
gk.push(function(a,b){if(!Lj||b&&"indexeddb"!=b)return null;var c=Lj.deleteDatabase(a),d=new ak("IDBVersionChangeEvent ");c.onblocked=function(a){Sc(d,a)};c.onerror=function(a){d.D(a)};c.onsuccess=function(a){d.C(a)};return d});function Gn(a){Ym.call(this,a);this.h=NaN}C(Gn,Ym);h=Gn.prototype;h.logger=P("ydn.db.con.SimpleStorage");h.me=function(){return this.h};
h.connect=function(a,b){function c(a,b){setTimeout(function(){b?(N(d.logger,d+" opening fail"),e.D(b)):(N(d.logger,d+" version "+d.me()+" open"),e.C(a))},10)}var d=this,e=new D;this.j=this.o.Ae(a);this.i=a;this.g=b;var f=Cm(this.i);this.h=NaN;var g=wh(this.j.getItem(f));s(g.version)&&!y(g.version)&&(g.version=NaN);if(g)if(g=new Rl(g),Sl(this.g,g,!1,!1))if(!this.g.Ac&&!isNaN(g.version)&&this.g.version>g.version)c(NaN,new jk("existing version "+g.version+" is larger than "+this.g.version));else{var k=
this.g.version;this.h=s(k)?k:g.version+1;for(k=0;k<this.g.count();k++)var l=this.g.store(k);if(this.g instanceof Ok)for(k=0;k<g.count();k++)l=g.store(k),Pk(this.g,l);k=this.g.toJSON();k.version=this.h||NaN;this.j.setItem(f,yh(k));c(g.version||NaN)}else{for(k=0;k<this.g.count();k++)l=this.g.store(k);this.h=g.version||NaN;c(this.h)}else g=b.toJSON(),this.h=1,g.version=this.h,this.j.setItem(f,yh(g)),c(NaN);return e};h.ne=function(){return!!this.i};h.oe=function(){};h.md=function(){};h.$d=function(){};
h.Jc=function(){return"memory"};h.le=function(){};h.Dd=function(a,b,c,d){a(new Zm(this,function(a,b){d(a,b)}))};h.toString=function(){return"SimpleStorage:"+this.Jc()+":"+(this.i+":"+this.h)};function Hn(){Gn.call(this,this)}C(Hn,Gn);Hn.prototype.Ae=function(){return window.localStorage};Hn.prototype.Jc=function(){return"localstorage"};gk.push(function(a,b){if(!b||"localstorage"==b){var c=new Hn,d=new Ok;c.connect(a,d);c.ib(function(a){for(var b=0;b<a.stores.length;b++)Am(c,a.stores[b].getName()).clear()})}});function In(){Gn.call(this,this)}C(In,Gn);In.prototype.Ae=function(){return window.sessionStorage};In.prototype.Jc=function(){return"sessionstorage"};
gk.push(function(a,b){if(!b||"sessionstorage"==b){var c=new In,d=new Ok;c.connect(a,d);c.ib(function(a){for(var b=0;b<a.stores.length;b++)Am(c,a.stores[b].getName()).clear()})}});function Jn(a){this.g=s(a)?a:4194304}h=Jn.prototype;
h.connect=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,g=c.Ac?isNaN(f)?1:f+1:c.version;af(e.logger,a+": changing version from "+b.version+" to "+g);var k=!1,l=0;b.changeVersion(b.version,g+"",function(a){e.ib(function(b){k=!0;for(var d=0;d<c.count();d++){var f=X(b,c.store(d).getName()),f=f?Jl(f,c.store(d)):null;Kn(e,a,c.store(d),function(a){a&&l++},f)}for(d=0;d<b.count();d++)f=b.store(d),Sk(c,f.getName())||(c instanceof Ok?Pk(c,f):(f="DROP TABLE "+Gl(f),N(e.logger,f),a.executeSql(f,
[],function(){},function(a,b){throw b;})))},a,b)},function(c){e.logger.log(Qe,"SQLError "+c+" "+c.code+"("+c.message+") while changing version from "+b.version+" to "+g+" on "+a,void 0);throw c;},function(){if(k){var f=".";l!=c.stores.length&&(f=" but unexpected stores exists.");O(e.logger,a+":"+b.version+" ready"+f);d(b)}else M(e.logger,a+": changing version voided.")})}function d(a,b){s(b)?(e.Ha=null,g.D(b)):(e.Ha=a,g.C(parseFloat(f)))}var e=this,f=NaN,g=new D,k=null;try{k=q.openDatabase(a,"",a,
this.g)}catch(l){if("SECURITY_ERR"==l.name)M(this.logger,"SECURITY_ERR for opening "+a),k=null,this.Ff=new ok(l);else throw l;}if(k){var f=k.version,m="database "+a+(0==k.version.length?"":" version "+k.version);null!=b.version&&b.version==k.version?(af(e.logger,"Existing "+m+" opened as requested."),d(k)):this.ib(function(a){(a=Sl(b,a,!0,!1))?(0==k.version.length?af(e.logger,"New "+m+" created."):b.Ac?af(e.logger,"Existing "+m+" opened and schema change for "+a):af(e.logger,"Existing "+m+" opened and  schema change to version "+
b.version+" for "+a),c(k,b)):(af(e.logger,"Existing "+m+" with same schema opened."),d(k))},null,k)}else d(null,this.Ff);return g};h.Jc=function(){return"websql"};h.Ff=null;h.Ha=null;h.logger=P("ydn.db.con.WebSql");h.oe=function(){};h.md=function(){};
function Ln(a){var b=a.G,c="CREATE TABLE IF NOT EXISTS "+Gl(a)+" (",d=a.j,c=c+(d+" "+b+" PRIMARY KEY ");a.h&&(c+=" AUTOINCREMENT ");if(!a.nc||!a.keyPath&&0==a.indexes.length)c+=" ,_default_ BLOB";for(var e=[],f=[d],g=0,k=a.indexes.length;g<k;g++){var l=a.index(g),m="";if(l.multiEntry){var m="ydn.db.me:"+a.getName()+":"+l.getName(),n=l.unique?" UNIQUE ":"",l="CREATE TABLE IF NOT EXISTS "+Ka(m)+" ("+d+" "+b+", "+l.i+" "+l.p+n+")";e.push(l)}else l.unique&&(m=" UNIQUE "),n=l.keyPath,"BLOB"!=l.type&&w(n)&&
(n="CREATE "+m+" INDEX IF NOT EXISTS "+Ka(a.getName()+"-"+l.getName())+" ON "+Gl(a)+" ("+l.i+")",e.push(n)),n=l.i,-1==f.indexOf(n)&&(c+=", "+n+" "+l.p+m,f.push(n))}e.unshift(c+")");return e}h.me=function(){return this.Ha?parseFloat(this.Ha.version):void 0};
h.ib=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var r=mc(e,"sql");O(f.logger,"Parsing table schema from SQL: "+r);for(var t=r.substr(r.indexOf("("),r.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),x=void 0,z,r=[],G=!1,E=!1,J=0;J<t.length;J++){var Q=t[J].match(/\w+|"[^"]+"/g),oa=Sa(Q,function(a){return a.toUpperCase()}),I=Ha(Q[0],'"'),
Q=vl(oa[1]);if(-1!=oa.indexOf("PRIMARY")&&-1!=oa.indexOf("KEY")){z=Q;if(w(I)&&!va(I)&&"_ROWID_"!=I){var Bc=I.split(","),x=I;1<Bc.length&&(x=Bc,z=void 0)}-1!=oa.indexOf("AUTOINCREMENT")&&(G=!0)}else if("_ROWID_"!=I)if("_default_"==I)E=!0;else{var gj="UNIQUE"==oa[2];sa(I,e.tbl_name+"-")&&(I=I.substr(e.tbl_name.length+1));oa=new ul(I,Q,gj);r.push(oa)}}if(sa(e.name,"ydn.db.me:")){var jd=e.name.split(":");if(3<=jd.length){var fe=jd[1],x=new ul(jd[2],Q,gj,!0),t=Wa(r,function(a){return a.getName()==jd[2]});
0<=t?r[t]=x:r.push(x);t=Wa(k,function(a){return a.getName()===fe});0<=t?(J=k[t],k[t]=new Lk(J.getName(),J.keyPath,G,z,r,void 0,!E)):k.push(new Lk(fe,void 0,!1,void 0,[x]));O(f.logger,'multi entry index "'+x.getName()+'" found in '+fe+(-1==t?"*":""))}else M(f.logger,'Invalid multiEntry store name "'+e.name+'"')}else J=Wa(k,function(a){return a.getName()===e.name}),0<=J?(t=k[J].index(0),r.push(t),k[J]=new Lk(e.name,x,G,z,r,void 0,!E)):(r=new Lk(e.name,x,G,z,r,void 0,!E),k.push(r))}}d=new Rl(g,k);a(d)}}
var f=this,g=(c=c||this.Ha)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,k=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.ib(a,b,c)},function(a){f.logger.log(Qe,"opening tx: "+a.message,void 0);throw a;},e)};
function Kn(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==k.length&&(d(!0),d=null)},function(b,e){g++;g==k.length&&(d(!1),d=null);var f="SQLError creating table: "+c.getName()+" "+e.message+' for executing "'+a;throw new nk(e,f);})}var g=0,k=Ln(c),l="Create";if(e){e=Nk(c,e);if(0==e.length){O(a.logger,"same table "+c.getName()+" exists.");d(!0);d=null;return}l="Modify";M(a.logger,"table: "+c.getName()+" has changed by "+e+" ALTER TABLE cannot run in WebSql, dropping old table.");k.unshift("DROP TABLE IF EXISTS "+
Ka(c.getName()))}O(a.logger,l+" table: "+c.getName()+": "+k.join(";"));for(a=0;a<k.length;a++)f(k[a])}h.ne=function(){return!!this.Ha};h.le=function(){this.Ha=null};
h.Dd=function(a,b,c,d){function e(a){O(k.logger,k+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var k=this;null===this.Ha&&(a(null),d("abort",this.Ff));c==Ij?this.Ha.readTransaction(g,e,f):c==Kj?this.Ha.changeVersion(this.Ha.version,this.Ha.version+1+"",g,e,f):this.Ha.transaction(g,e,f)};
gk.push(function(a,b){if(ga(q.openDatabase)&&(!b||"websql"==b)){var c=new Jn,d=new Ok;N(c.logger,"deleting websql database: "+a);var d=c.connect(a,d),e=function(){c.logger.info("all tables in "+a+" deleted.")};d.A(function(){c.Dd(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var l=e.rows.length,m=0,n=0;n<l;n++){var p=e.rows.item(n);"__WebKitDatabaseInfoTable__"!=p.name&&"sqlite_sequence"!=p.name&&(m++,O(c.logger,"deleting table: "+p.name),
b.executeSql("DROP TABLE "+p.name))}N(c.logger,m+' tables deleted from "'+a+'"')}},function(a,b){throw b;})},[],Jj,e)});d.Lc(function(){M(c.logger,"Connecting "+a+" failed.")})}});Jn.prototype.$d=function(){};Jn.prototype.toString=function(){return"WebSql:"+(this.Ha?":"+this.Ha.version:"")};hm.prototype.Be=function(a){return"indexeddb"==a&&Lj?new En(this.G,this.T):"websql"==a&&ga(q.openDatabase)?new Jn(this.G):"localstorage"==a&&window.localStorage?new Hn:"sessionstorage"==a&&window.sessionStorage?new In:"memory"==a?new Gn:null};function Mn(a,b){ub.call(this);this.j=b;this.g=[];if(a>this.j)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.g.push(this.h())}C(Mn,ub);Mn.prototype.be=function(a){this.g.length<this.j?this.g.push(a):this.i(a)};Mn.prototype.h=function(){return{}};Mn.prototype.i=function(a){if(A(a))if(ga(a.oa))a.oa();else for(var b in a)delete a[b]};Mn.prototype.J=function(){Mn.m.J.call(this);for(var a=this.g;a.length;)this.i(a.pop());delete this.g};function Nn(){this.g=[];this.i=new md;this.j=new md;this.o=1;this.l=new Mn(0,4E3);this.l.h=function(){return new On};this.p=new Mn(0,50);this.p.h=function(){return new Pn};var a=this;this.h=new Mn(0,2E3);this.h.h=function(){return String(a.o++)};this.h.i=function(){}}P("goog.debug.Trace");function Pn(){this.time=this.count=0}Pn.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function On(){}
function Qn(a,b,c){var d=[];-1==b?d.push("    "):d.push(Rn(a.h-b));d.push(" ",Sn(a.h-0));0==a.g?d.push(" Start        "):1==a.g?(d.push(" Done "),d.push(Rn(a.l-a.startTime)," ms ")):d.push(" Comment      ");d.push(c,a);0<a.j&&d.push("[VarAlloc ",a.j,"] ");return d.join("")}On.prototype.toString=function(){return null==this.type?this.i:"["+this.type+"] "+this.i};
Nn.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.g.length;d++){var e=this.g[d];1==e.g&&c.pop();a.push(" ",Qn(e,b,c.join("")));b=e.h;a.push("\n");0==e.g&&c.push("|  ")}if(0!=this.i.ca()){var f=B();a.push(" Unstopped timers:\n");kd(this.i,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Sn(b.startTime),")\n")})}b=this.j.Qa();for(d=0;d<b.length;d++)c=this.j.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",0,"\n","Total comments created ",
0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function Rn(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Sn(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new Nn;/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Tn(a){a.p||(a.p=new Lc);return a.p}hm.prototype.removeEventListener=function(a,b,c,d){Gc(Tn(this),a,b,c,d)};hm.prototype.Ya=function(a){Tn(this).dispatchEvent(a)};function Un(a,b,c){jm.call(this,a,b,c)}C(Un,Dn);P("ydn.gdata.base");function Vn(a){this.i=a||null;this.g=this.h=null;a&&Wn(this,a)}Vn.prototype.logger=P("ydn.crm.UserSetting");
var Xn={stores:[{name:"general"},{name:"sugar"}]},Yn={stores:[{name:"contact",keyPath:"id.$t",type:"TEXT",indexes:[{name:"updated.$t",type:"TEXT"},{name:"ydn$emails",multiEntry:!0,generator:function(a){var b=[];a=u(a.gd$email)?a.gd$email:A(a.gd$email)?[a.gd$email]:[];for(var c=0;c<a.length;c++){var d=ln(a[c].address);d&&b.push(d)}return b}},{name:"ydn$externalIds",multiEntry:!0,generator:function(a){return(u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:
[]).map(function(a){return a.value})}}]}]};function Wn(a,b){if(!a.i||a.i!=b){q.sessionStorage.setItem("last-user-id",b);var c=b+"-setting",d=b+"-gdata";a.h&&a.h.getName()!=c&&(bm(a.h),a.h=null);a.g&&a.g.getName()!=d&&(bm(a.g),a.g=null);a.h||(a.h=new Un(c,Xn));a.g||(a.g=new Un(d,Yn))}}function Zn(a){return a.i?a.i+"-sd":q.sessionStorage.getItem("last-user-id")+"-sd"}function $n(a){var b=Zn(a),c=new D;chrome.storage.local.get(b,function(a){c.C(a[b])});return c}
function ao(a,b){var c=Zn(a),d=new D,e={};e[c]=b;chrome.storage.local.set(e,function(){d.C(!0)})};function bo(){var a=new D;chrome.storage.sync.get("user-setting",function(b){a.C(b["user-setting"])});return a};function co(){}co.prototype.logger=P("ydn.crm.Client");function eo(a,b,c){this.client=a;this.g=b;this.h=c}eo.prototype.request=function(a){a=this.g.call(this.h,a);return this.client.request(a)};function fo(a,b,c){this.h=a;this.i=b;this.g=c}fo.prototype.request=function(a){return this.h(a)?this.i.request(a):this.g.request(a)};function go(a,b){this.client=a;this.h=b;this.dd=NaN;this.i=[];this.g=!1}go.prototype.request=function(a){return new ho(a,this)};function ho(a,b){a.path=b.h+a.path;this.req=b.client.request(a);this.parent=b;this.i=null;this.h=void 0}C(ho,cj);
ho.prototype.execute=function(a,b){if(this.parent.g)this.i=a,this.h=b,this.parent.i.push(this);else{this.parent.g=!0;var c=function(c,d){var g=Zi(d,"retry-after");g?(this.parent.dd=/[^0-9|\.]/.test(g)?(new Date(g)).getTime():1E3*parseFloat(g)+B(),q.console.info("Next retry "+this.parent.dd+", now "+B())):this.parent.dd=NaN;a&&a.call(b,c,d);this.parent.g=!1;if(g=this.parent.i.pop())g.execute(g.i,g.h),g.i=null,g.h=null},d=this.parent.dd-B();0<d?(q.console.info("Proxy will call after "+d+" ms"),lf(function(){this.parent.dd=
NaN;this.req.execute(c,this)},d,this)):this.req.execute(c,this)}};function jo(a,b,c,d,e){this.l=s(a)?a:Vi();this.g=b;this.h=c;this.i=d||0;this.j=!!e}jo.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new cj(a,this.l,this.i,this.j)};function ko(a,b,c){this.i=s(a)?a:Vi();this.g=b;this.h=c}ko.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new cj(a,this.i)};function lo(a){for(var b=Zl(a),c=0;c<b.stores.length;c++);b=(b=wk)||wk;b=im(a,b,!1,void 0,void 0,void 0);this.g=a.Cc(b,a.Ua);this.j=!1;a.Pb(this.H,this);this.h=1E4;this.l=We.value;this.i=0;this.t=ma(this.G,this);this.p=!1;this.o={}}function mo(a){if(a.h&&a.i>=a.h){var b=a.h/100;100<b&&(b=100);a.g.keys("db-logger",null,b).A(function(a){a=a.map(function(a){return new rk("db-logger",a)});this.g.remove(a).A(function(){this.g.count("db-logger").A(function(a){this.i=a},this)},this)},a)}}
function no(){var a=oo;a.h=1E4;mo(a)}lo.prototype.H=function(){this.h&&(this.j=!0,this.g.count("db-logger").A(function(a){this.i=a;mo(this)},this))};function po(a){var b=oo;if(a!=b.p){var c=ef();a?Ze(c,b.t):(c=c.g)&&Za(c,b.t);b.p=a}}lo.prototype.G=function(a){if(this.j){var b=a.h;sa(b,"ydn.db.")||this.o[b]||!(b=a.j)||b.value<=this.l||(a={exception:a.g,level:b.value,logger:a.h,name:b.name,time:a.l,message:a.getMessage(),seq:a.o},this.g.put("db-logger",a),this.i++,mo(this))}};
function qo(a,b){var c=oo,d=a||100,e=b||0,f=mj(["INFO"]);return c.g.values("db-logger","name, time",f,d,e,!0)}var oo=null;var ro,so,to,uo,vo=P("ydn.crm");function wo(){ro||(ro=new Zf(0));return ro}var xo=null;function yo(a,b){b&&"local"!=b||(s(a["logging-captureConsole"])&&ki(!!a["logging-captureConsole"]),s(a["logging-bugReport"])&&po(!!a["logging-bugReport"]))}
function zo(){var a;a="Yathit CRM Bridge ydn.crm.version 0.7.14 (dev)";Li("ydn.crm","fine");Li("ydn.crm.inj.App","finest");Li("ydn.ds","fine");q.console.log(a);q.console.log("API documentation: http://dev.yathit.com/\nFeedback and suggestion: https://yathit.uservoice.com/\nBug report: https://github.com/yathit/sugarcrm-gmail-chrome-extension");xo=new Un("ydn.crm",{stores:[{name:"log",keyPath:"key"},{name:"db-logger",autoIncrement:!0,indexes:[{name:"level"},{name:"time"},{name:"name"},{name:"name, time",
keyPath:["name","time"]}]}]});oo=new lo(xo);no();oo.l=300;oo.o["ydn.db.tr.DbOperator"]=!0;po(!0);vo.info("Starting ydn.crm.App:0.7.14");chrome.storage.local.get(["logging-captureConsole","logging-bugReport"],yo);chrome.storage.onChanged.addListener(yo);var b=B();bj=Mi=new Ao(xo,function(a){if(!a||a.HttpRequestData&&"https://mail.google.com/mail/feed/atom/bazinga"==a.HttpRequestData.path)return null;a.uptime=b;return a})}function Bo(){so||(so=new ko(wo()),Ui(so,"default"));return so}
function Co(a){var b=Bo();a=new ej(a,ro,!1);Ui(a,"gc");var c=new eo(a,function(a){a.path="https://yathit-app.appspot.com/proxy/"+a.path;return a});Ui(new go(b,"https://yathit-app.appspot.com/proxy/"),"proxy");Ui(new fo(function(a){return"GET"==a.method},a,c),"gse")}function Do(){uo||(uo=new jo(wo(),void 0,"https://yathit-app.appspot.com/a/cm",1,!0),Ui(uo,"auth"));return uo};function Eo(a,b){this.j=b||B();this.type=a;this.i=this.g=this.h=void 0}function Fo(a,b){A(b)?a.h=Ul(b):a.h=b}Eo.prototype.toJSON=function(){return{type:this.type,timestamp:this.j,newValue:this.g,oldValue:this.h,meta:this.i}};function Go(a){this.g=a}Go.prototype.add=function(a){this.g.add("history",a.toJSON())};function Ho(a,b){if(a.link){if(u(a.link)){for(var c=0;c<a.link.length;c++)if(a.link[c].rel==b)return a.link[c];return null}return a.link.rel==b?a.link:null}return null};function Io(a,b){this.entry=a;this.data=b;this.g=!1}Io.prototype.data=null;Io.prototype.preventDefault=function(){this.g=!0};function Jo(a,b,c,d){K.call(this,a,b);this.status=c;this.entry=d}C(Jo,K);Jo.prototype.status=NaN;Jo.prototype.P=function(){return this.status};Jo.prototype.yb=function(){return this.entry.yb()};function Ko(a,b,c){Jo.call(this,"conflict",a,b,c.entry)}C(Ko,Jo);function Lo(a,b){this.g=a;if(b)throw new Nc("optional key paths");}var Mo={ni:"key",ki:"date",oi:"modified",mi:"expires",li:"etag",pi:"updated",qi:"uri",NEXT:"next"};Lo.prototype.V=function(a,b){return b&&this.g[a]?uj(b,this.g[a]):void 0};function No(a,b,c,d){a.g[b]&&vj(c,a.g[b],d)};function Oo(a,b,c,d){this.key=a;this.h=(this.h=d?b[d]:b)||{};this.g=c}function Po(a){return null!=a.key?a.key:a.g.V("key",a.h)}Oo.prototype.getDate=function(){return this.g.V("date",this.h)};function Qo(a){return a.g.V("updated",a.h)}function Ro(a){return a.g.V("etag",a.h)}function So(a){var b={},c=Ro(a);c&&1<c.length?b["if-none-match"]=c:(a=Qo(a))&&(b["if-modified-since"]=a);return b}
Oo.prototype.toJSON=function(){var a={};No(this.g,"key",a,Po(this));var b=this.getDate();b&&No(this.g,"date",a,b);(b=this.g.V("expires",this.h))&&No(this.g,"expires",a,b);(b=Qo(this))&&No(this.g,"updated",a,b);(b=Ro(this))&&No(this.g,"etag",a,b);return a};function To(a,b,c){b.expires&&No(c,"expires",b,(new Date(b.expires)).getTime());b["last-updated"]&&No(c,"updated",b,(new Date(b["last-updated"])).getTime());b.etag&&No(c,"etag",b,(new Date(b.etag)).getTime());No(c,"date",b,NaN);Oo.call(this,a,b,c)}C(To,Oo);function Uo(a,b,c){this.g=a;this.o=c||null;this.i=this.h=null;this.key=b}h=Uo.prototype;h.logger=P("ydn.db.sync.entry.Rest");h.yb=function(){if(this.i&&this.g.p&&this.j){var a=this.g.t;this.g.T||delete this.i[a]}return this.i||null};h.V=function(){return this.o};h.F=function(){return this.key};h.pe=function(){return this.g.gf(this.F())};function Vo(a,b){var c=a.F();return new To(c,b.Tc(),a.g.o)}
h.Ke=function(a,b){if(a)return a;if(b.Fa())return $i(b);try{return $i(b)}catch(c){var d=Yi(b);return A(d)?d:{body:d}}};h.save=function(a){var b=this.F();if(a&&!this.g.p)return B(),Wo(this.g,[this.j.toJSON()]);var c=this.i;if(a&&!c)return sb();a=void 0;null!=this.j&&(B(),a=[this.j.toJSON()]);return Xo(this.g,[c],a,[b])};
h.kc=function(a,b){if(this.g.G&&A(this.h))a.call(b,304),a=null;else{var c=this;Yo(this,function(d){if(d){var e=d.g.V("expires",d.h);if(e&&e>B()){O(this.logger,this+" not expired");a.call(b,304);a=null;return}}e=c.pe();d=c.hc(e,"GET",d);this.g.va().request(d).execute(function(d,e){c.j=Vo(c,e);c.i=c.Ke(d,e);a.call(b,e.P());a=null})},this)}};
h.hc=function(a,b,c,d){a=new ai(a,b);if(c){var e;"POST"==a.method||"PUT"==a.method||"DELETE"==a.method?(e={},(b=Qo(c))&&(e["if-unmodified-since"]=b),(c=Ro(c))&&1<c.length&&(e["if-match"]=c),c=e):c=So(c);e=c;a.headers?pc(a.headers,e):a.headers=e}a.body=A(d)?JSON.stringify(d):d;O(this.logger,this+" "+a.method+" "+a.path+" "+xh(e));return a};
function Zo(a,b,c){Yo(a,function(a){var e=this.V();a=this.hc(this.pe(),"PUT",a,e);this.g.va().request(a).execute(function(a,d){this.j=Vo(this,d);this.i=a;b&&(b.call(c,d.P()),b=null)},this)},a)}function Yo(a,b,c){a.l?b.call(c,a.l):$o(a.g,a.F(),function(d){a.l=d;b.call(c,d)})}
h.load=function(a,b){if(this.h&&this.l)a&&(a.call(b,this.h,this.l),a=void 0);else{var c=this.F();this.g.load(c,function(c,e){this.h=c;var f=this.g.t;this.h&&f&&this.h[f]&&(this.l=new Oo(this.key,this.h,this.g.o,f),this.g.T||delete this.h[f]);this.h=c;this.l=e;a&&(a.call(b,c),a=void 0)},this)}};function ap(a,b){var c=a.pe(),d=a.g.va();Yo(a,function(a){a=this.hc(c,"DELETE",a);d.request(a).execute(function(a,d){O(this.logger,"deleted "+c+" "+d.P());b.call(this,d.P())},this)},a)}
h.toString=function(){return"sync.entry{"+this.g.I()+":"+this.key+"}"};function bp(a,b,c){this.storage=a;this.store=b;this.R=b.getName();a="format readRequestTimeout writeRequestTimeout transport Options fetchStrategies baseUri immutable keepMeta metaStoreName metaDataName prefetch prefetchRefractoryPeriod".split(" ");for(var d in c)if(-1==Pa(a,d))throw new L('Unknown Sync attribute "'+d+'"  in Sync.');this.G=!!c.immutable;this.h=c.baseUri;this.Eb=c.metaStoreName||this.R;this.t=c.metaDataName;this.p=this.Eb==this.R;a=c.Options||{};if(!this.Eb)throw new L("metadata store name required.");
b=this.wb();for(d in a)if(-1==Pa(b,d))throw new L('Unknown Sync.Options attribute "'+d+'" in Sync.Options');this.na=a.delimiter||"";this.j=a.prefix||"";this.T=!!c.keepMeta;this.N=c.prefetch||y(c.prefetchRefractoryPeriod)?"full":null;this.ea=y(c.prefetchRefractoryPeriod)?c.prefetchRefractoryPeriod:5E3;this.g=cp(c.transport);this.o=new Lo(this.vb(),c.metaData);this.l=null;this.H=NaN}h=bp.prototype;h.vb=function(){var a={},b;for(b in Mo)a[b]=b;return a};h.wb=function(){return[]};h.I=function(){return this.R};
h.logger=P("ydn.db.sync.Rest");h.Jb=function(){return this.h};h.va=function(){this.g||(this.g=new ko);return this.g};h.toString=function(){return"sync:"+this.R};function Wo(a,b){return hl(a.storage.g,a.Eb,b).Lc(function(a){throw a;})}function dp(a,b,c){a.store.keyPath&&null==Zk(a.store,b)&&null!=c&&vj(b,a.store.keyPath,c)}
function Xo(a,b,c,d){d=a.store.keyPath?void 0:d;if(c){if(a.p){for(g=0;g<b.length;g++)null!=c[g]&&pc(b[g],c[g]);return hl(a.storage.g,a.R,b,d)}if(b){for(var e=[],f=b.concat(c),g=0;g<b.length;g++){var k=a.store.keyPath?NaN:d[g];e.push(new rk(a.R,k))}for(g=0;g<c.length;g++)e.push(new rk(a.Eb,NaN));return hl(a.storage.g,e,f)}return hl(a.storage.g,a.Eb,c)}for(g=0;g<b.length;g++)k=d?d[g]:void 0,dp(a,b[g],k);return hl(a.storage.g,a.R,b,d)}
function ep(a,b){var c=[new rk(a.R,b)];a.p||c.push(new rk(a.Eb,b));return il(a.storage.g,c)}h.gf=function(a){return this.Jb()+a};h.add=function(a,b,c){null!=c?dp(this,b,c):this.store.keyPath&&(c=Zk(this.store,b));var d=this.za(c,b),e=this;Zo(d,function(a){201==a||200==a?(O(e.logger,d+" created"),d.save(!0)):M(e.logger,"Unexpected respond "+a+" for add "+d)})};
function $o(a,b,c){var d=new rk(a.Eb,b);fp(a,[d]).B(function(a){c.call(void 0,new Oo(b,a[0],this.o,this.t))},function(a){M(this.logger,this+" error loading meta data "+a);c.call(void 0,null)},a)}h.Xd=function(a,b){var c=a.map(function(a){return new rk(this.Eb,a)});fp(this,c).B(function(c){for(var e=[],f=0;f<a.length;f++)e[f]=new Oo(a[f],c[f],this.o,this.t);b(e)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)};
h.load=function(a,b,c){var d=this.Eb,e=[new rk(this.I(),a)];this.p||e.push(new rk(d,a));fp(this,e).B(function(d){var e=d[0];b.call(c,e,new Oo(a,this.p?e:d[1],this.o,this.t))},function(a){M(this.logger,this+" error loading meta data "+a);b.call(c,null,null)},this)};function fp(a,b){return ll(a.storage.g,b)}
h.get=function(a,b){this.H||this.Yb();ek(a,function(c,d,e){if(d)e(c,d);else{Sc(a,c);var f=s(c);if(f&&this.G)e(c);else{var g=this.za(b,c);g.kc(function(a){if(304==a){if(e(c),!f)throw new Qc(g+" not modified, but not exist in server");}else if(200==a)g.save().fa(function(){e(g.yb())});else if(404==a)ep(g.g,g.F()).fa(function(){e(g.yb())});else throw e(g.yb()),new Pc("Invalid HTTP respond "+a+" for GET "+b);},this)}}},this)};
function gp(a,b,c,d,e,f){var g=[],k=a.logger;N(a.logger,d.length+", "+e.length+", "+f.length+", "+g.length+" records to fetch, update, delete, save");var l=d.length+e.length+f.length+g.length;if(0==l)b(c);else{for(var m=!1,n=function(){l--;0==l&&(b(c,m),b=null)},g=0;g<d.length;g++){var p=a.za(d[g]);p.index=g;p.kc(function(a){200==a?(O(k,"A new "+this+" received from server"),this.save().B(function(){c[this.index]=this.yb();n()},function(){m=!0;n()},this)):304==a?this.save(!0).B(function(){O(k,this+
" expires date updated");n()},function(){m=!0;n()},this):(M(k,"Invalid status "+a+" for fetching "+this),n())},p)}for(g=0;g<e.length;g++)p=a.za(e[g]),p.index=g,p.load(function(){this.kc(function(a){200==a?(O(k,this+" updated from server"),this.save().B(function(){c[this.index]=this.yb();n()},function(){m=!0;n()},this)):(M(k,"Invalid status "+a+" for fetching "+this),n())})});for(g=0;g<f.length;g++)p=a.za(f[g]),p.index=g,ep(p.g,p.F()).B(function(){c[this.index]=new Io(p,null);n()},function(){m=!0;
n()},p)}}function hp(a,b,c){ek(b,function(a,e,f){if(e)f(a,e);else if(Ua(a,function(a){return s(a)})&&this.G)f(a);else{Sc(b,a);var g=a.length;for(e=0;e<c.length;e++)if(this.G&&s(a[e]))g--,0==g&&f(a);else{var k=this.za(c[e],a[e]);k.index=e;k.kc(function(b){200==b?(a[this.index]=this.yb(),this.save()):404==b&&(a[this.index]=void 0);g--;0==g&&f(a)},k)}}},a)}h.za=function(a,b){return new Uo(this,a,b)};h.count=function(a){return a};h.nf=function(){throw new Nc;};
h.values=function(a,b,c){ip(this)?(O(this.logger,"prefetch queued"),ek(a,function(d,e,f){Sc(a,d);e?f(d,e):jp(this,function(a){a?kl(this.storage.g,this.R,null,null,!1,b,c).B(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(){M(this.logger,this+" prefetch fail");f(d)},this)},this)):this.nf(a,b,c)};
h.keys=function(a,b,c,d,e,f,g){ek(a,function(k,l,m){Sc(a,k);l?m(k,l):jp(this,function(a){a?ml(this.storage.g,this.R,b,c,d,e,f,g).B(function(a){m(a)},function(a){m(a,!0)},this):m(k)},function(){M(this.logger,this+" prefetch fail");m(k)},this)},this)};h.Ie=function(){};
h.put=function(a,b,c){c=s(c)?c:this.store.keyPath?Zk(this.store,b):null;var d=this.za(c,b);U(a,function(){d.load()},this);ek(a,function(c,f,g){Sc(a,c);Zo(d,function(c){409==c?d.kc(function(){var c=new Io(d,b);Sc(a,c);c.g?g(null,f):g(void 0,f)}):200==c||201==c?(d.save(!0),g(b,f)):(M(this.logger,"Unexpected response for PUT: "+c),g(null,f))},this)},this)};
h.remove=function(a,b){var c=this,d=this.za(b);d.load(function(){ek(a,function(e,f,g){ap(d,function(f){if(409==f){f=new Io(d,null);Sc(a,f);var l=new Ko(c.storage,409,f);c.storage.Ya(l)}else 200==f?O(c.logger,"Successfully deleted object "+b):(M(c.logger,"Unexpected response for DELETE: "+f+" "+b),Sc(a,l));g(e)})})})};
h.Yb=function(){O(this.logger,this+" starting prefetch");var a=new D;kl(this.storage.g,this.R,"updated.$t",null,!0,1).B(function(b){var c={};if(b=b[0])b=kc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b;var d=this,c=new ai(this.Jb(),"GET",c);d.va().request(c).execute(function(b,c){if(200==c.P()){if(!b){var g=Yi(c);w(g)&&(b=JSON.parse(g))}g=(g=(b.feed||b).entry)?u(g)?g:[g]:[];0<g.length?Xo(d,g).fa(function(){a.C(!0)}):a.C(!1)}else 302==c.P()?a.C():(g=d+": Invalid response status "+
c.P()+" on prefetching",M(d.logger,g),a.D(Error(g)))})},function(b){a.D(b)},this);return a};function ip(a){return a.N?a.H?B()-a.H>a.ea:!0:!1}function jp(a,b,c,d){ip(a)?a.l?a.l.B(b,c,d):(a.l=a.Yb(),a.H=B(),a.l.B(b,c,d),a.l.B(function(a){O(this.logger,"prefetch "+(a?"updated":"no update"));this.l=null},function(a){this.l=null;throw a;},a)):b.call(d,!1)};function kp(a,b,c){bp.call(this,a,b,c)}C(kp,bp);kp.prototype.logger=P("ydn.db.sync.Atom");kp.prototype.wb=function(){return kp.m.wb.call(this)};kp.prototype.F=function(a){return a.key};function lp(a){this.data=a}h=lp.prototype;h.F=function(){return this.data.id.$t};h.Cf=function(){return this.data.title?this.data.title.$t:void 0};h.ke=function(a){return Ho(this.data,a)};h.Yh=function(){var a=this.ke("self");return a?a.href:void 0};h.Xh=function(){var a=this.ke("http://schemas.google.com/g/2005#batch");return a?a.href:""};h.pa=function(){return this.data.content||null};function mp(a,b,c){Uo.call(this,a,b,c)}C(mp,Uo);mp.prototype.logger=P("ydn.db.sync.entry.S3");mp.prototype.getName=function(){return this.g.j+this.key};mp.prototype.hc=function(a,b,c,d){b=mp.m.hc.call(this,a,b,c,d);if("PUT"==b.method||"POST"==b.method){c=Fd(new sd(a)).substr(1);if(1>c.length)throw new Pc("invalid url "+a);b.headers.Key=c;a=b.headers["Content-Type"]||"application/json";d instanceof File?a=d.type:w(d)&&(a=/<*DOCTYPE html/i.test(d)?"text/html":"text/plain");b.headers.ContentType=a}return b};function np(a){this.data=a}C(np,lp);var op={atom:"http://www.w3.org/2005/Atom",ydn:"http://www.yathit.com/2012/ydn",app:"http://www.w3.org/2007/app",openSearch:"http://a9.com/-/spec/opensearch/1.1/",gAcl:"http://schemas.google.com/acl/2007",sites:"http://schemas.google.com/sites/2008",gs:"http://schemas.google.com/spreadsheets/2006",dc:"http://purl.org/dc/terms",batch:"http://schemas.google.com/gdata/batch",gd:"http://schemas.google.com/g/2005",gContact:"http://schemas.google.com/contact/2008",thr:"http://purl.org/syndication/thread/1.0",
xhtml:"http://www.w3.org/1999/xhtml"};function pp(a,b){for(var c=a.indexOf(" "),d=0;d<b.length;d++){var e=b[d],e=(0==d?"xmlns":"xmlns:"+e)+'="'+op[e]+'"';-1==a.indexOf(e)&&(a=a.substring(0,c+1)+e+" "+a.substr(c+1))}return a}P("ydn.xml");function qp(a){return op[a]||op.xhtml};function rp(a,b,c){c=!!c;if(a.getName()!=b.getName())return!1;var d=sp(a),e=sp(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;for(d=0;d<e.length;d++)if(a.getAttribute(e[d])!=b.getAttribute(e[d]))return!1;d=tp(a);e=tp(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;if(0==d.length||0==d.length)return a.data.$t===b.data.$t;for(d=0;d<e.length;d++){var f=up(a,e[d]),g=up(b,e[d]);if(!c&&f.length!=g.length||c&&g.length>f.length)return!1;for(var k=0;k<g.length;k++)if(-1==Wa(f,function(a){return rp(a,
g[k],c)}))return!1}return!0};function vp(a,b,c){if(s(b))wp(this,b),s(c)||(c=a[b]);else for(var d in a)if(a.hasOwnProperty(d)&&A(a[d])&&w(a[d].xmlns)){this.nd=[d].xmlns;wp(this,d);c=a[d];break}this.data=c;this.parent=a}h=vp.prototype;h.nd="http://www.w3.org/2005/Atom";function wp(a,b){var c=b.split(":");1<c.length&&(a.nd=qp(c[0])||vp.prototype.nd,b=c[1]);a.tagName=b}
h.n=function(a,b){var c;c=a;var d=b,e=c;if(s(d))"atom"!=d&&(e=d+"$"+c);else{var f=c.split(":"),e=c.replace(/:/,"$");2==f.length&&(d=f[0],c=f[1])}d=s(d)?qp(d):void 0;c=s(this.data[c])&&s(d)&&this.data[c].xmlns==d?c:e;return u(this.data[c])?new vp(this.data,c,this.data[c][0]):A(this.data[c])?new vp(this.data,c,this.data[c]):null};h.toString=function(){return"JsonElement:"+this.tagName};h.getName=function(){return this.tagName};
function xp(a,b){for(var c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&delete a.data[c];a.data.$t=b}h.getAttribute=function(a){a=a.replace(/:/,"$");return this.data[a]};h.setAttribute=function(a,b){a=a.replace(/:/,"$");this.data[a]=b};h.removeAttribute=function(a){a=a.replace(/:/,"$");delete this.data[a]};function sp(a){var b=[],c;for(c in a.data)a.data.hasOwnProperty(c)&&w(a.data[c])&&"$t"!=c&&b.push(c);return b}
function up(a,b){s(void 0)?b="undefined$"+b:s(b)&&(b=b.replace(/:/,"$"));var c=[];if(s(b)){var d=a.data[b];if(u(d))for(var e=0;e<d.length;e++)c.push(new vp(a.data,b,d[e]));else A(d)&&c.push(new vp(a.data,b,d))}else for(d in a.data)if(u(a.data[d]))for(e=0;e<a.data[d].length;e++)c.push(new vp(a.data,d,a.data[d][e]));else A(a.data[d])&&c.push(new vp(a.data,d,a.data[d]));return c}function tp(a){var b=[],c;for(c in a.data)A(a.data[c])&&b.push(c.replace("$",":"));return b}
h.appendChild=function(a){var b=a.getName();this.data[b]?(u(this.data[b])||(this.data[b]=[this.data[b]]),this.data[b].push(Ul(a.data))):this.data[b]=Ul(a.data)};
h.update=function(a,b,c,d,e){var f=!1;c=c||{};var g=s(b),k=!0===b||!g,l=!1===b,m=sp(this),n=sp(a);if(!g)for(var p=0;p<m.length;p++)s(e)&&!e[m[p].replace("$",":")]||Xa(n,m[p])||(this.removeAttribute(m[p]),f=!0);for(p=0;p<n.length;p++){var r=a.getAttribute(n[p]);if(!s(e)||e[n[p].replace("$",":")])Xa(m,n[p])?l||r==this.getAttribute(n[p])||(this.setAttribute(n[p],r),f=!0):(this.setAttribute(n[p],r),f=!0)}if(0==yp(a)&&k&&(e=this.data.$t,l=a.data.$t,s(l)&&e!=l))return xp(this,l),!0;if(!g)for(var t in this.data)d&&
!d[t.replace("$",":")]||!A(this.data[t])||A(a.data[t])||(delete this.data[t],f=!0);t=tp(a);for(e=0;e<t.length;e++)if(l=t[e],!d||!0==d[l]){var x=up(a,l),m=up(this,l),z=l.replace(":","$");if(1==x.length)0==m.length?(this.data[z]=Ul(x[0].data),f=!0):1==m.length?c[l]?k&&!rp(m[0],x[0],!0)&&(u(this.data[z])||(this.data[z]=[this.data[z]]),this.data[z].push(Ul(x[0].data)),f=!0):f=m[0].update(x[0],b)||f:g?(l=Wa(m,function(a){return rp(a,x[0],!0)}),-1==l&&k&&(this.data[z].push(Ul(x[0].data)),f=!0)):(this.data[z]=
Ul(x[0].data),f=!0);else if(!u(this.data[z]))if(k)this.data[z]=Ul(a.data[z]),f=!0;else{if(g){var m=Ul(a.data[z]),G=this,l=Wa(m,function(a){return Cl(G.data[z],a)});-1==l&&(m.push(this.data[z]),this.data[z]=m,f=!0)}}else if(k)for(m.length>x.length&&(this.data[z].splice(x.length,m.length-x.length),f=!0),p=0;p<x.length;p++)s(m[p])?Cl(m[p].data,x[p].data)||(this.data[z][p]=Ul(x[p].data),f=!0):(this.data[z][p]=Ul(x[p].data),f=!0);else if(g)for(p=0;p<a.data[z].length;p++)l=Wa(this.data[z],function(b){return Cl(a.data[z][p],
b)}),-1==l&&(this.data[z].push(Ul(a.data[z][p])),f=!0)}return f};h.of=function(a,b,c,d,e){s(b)||(b=!1);return this.update(a,b,c,d,e)};h.toJSON=function(){return{data:this.data,tagName:this.tagName}};
function zp(a){function b(a,g){d(g,a);var k,l;for(l in a)if(a.hasOwnProperty(l)&&!w(a[l]))if(w(a[l].$t)&&"xhtml"==a[l].type){k=c(l);d(k,a[l]);var m=Bh(a[l].$t);e.importNode(m.documentElement,!0);k.appendChild(m.documentElement);g.appendChild(k)}else if(w(a[l].$t))k=c(l),k.textContent=a[l].$t,d(k,a[l]),g.appendChild(k);else if(u(a[l])&&a[l][0]&&w(a[l][0].$t))for(m=0;m<a[l].length;m++)k=c(l),k.textContent=a[l][m].$t,d(k,a[l][m]),g.appendChild(k);else if(u(a[l]))for(m=0;m<a[l].length;m++)k=c(l),g.appendChild(k),
b(a[l][m],k);else A(a[l])&&(k=c(l),g.appendChild(k),b(a[l],k))}function c(a){return e.createElement(a.replace("$",":"))}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&"$t"!=c&&w(b[c])&&a.setAttribute(c.replace("$",":"),b[c])}var e=zh(a.getName(),a.nd);b(a.data,e.documentElement);return Ch(e.documentElement)}
function yp(a){function b(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&(u(a[c])?b+=a[c].length:A(a[c])&&b++);return b}var c;s(void 0)?c="undefined$"+c:s(c)&&(c=c.replace(/:/,"$"));return s(c)?u(a.data[c])?a.data[c].length:A(a.data[c])?b(a.data[c]):0:b(a.data)}h.ga=function(a){var b={};if(s(a))for(var c in this.data){var d=c.replace("$",":");w(this.data[c])?b[c]=this.data[c]:!0==a[d]&&(b[c]=Ul(this.data[c]))}else b=Ul(this.data);return new vp(null,this.tagName,b)};
function Ap(a,b){var c=b.ownerDocument.createElementNS(a.nd,a.getName()),d;for(d in a.data)if(a.data.hasOwnProperty(d)){var e=d.replace("$",":");if(w(a.data[d]))"$t"==d?c.textContent=a.data[d]:(e=c.ownerDocument.createAttribute(e),e.nodeValue=a.data[d],c.setAttributeNode(e));else if(u(a.data[d]))for(var f=0;f<a.data[d].length;f++){var g=new vp(a.data[d],e,a.data[d][f]);Ap(g,c)}else A(a.data[d])&&(g=new vp(a.data,e,a.data[d]),Ap(g,c))}return b.appendChild(c)};function Bp(a){var b;if(s(a.id))b=a.id.$t;else if(s(a.batch$id))b=a.batch$id.$t;else if(s(a.g))b=a.g.$t;else throw new Dh("id or batch:id required.");this.id=b;this.h=void 0;this.data=a}C(Bp,np);h=Bp.prototype;h.logger=P("ydn.gdata.Entry");h.Gf=function(){return this.kind};h.Cf=lp.prototype.Cf;h.F=function(){return this.id};function Cp(a){return a.id.match(/\w+$/)[0]}h.pc=["link","category"];h.ng=["id","batch$id","link","category"];h.pa=lp.prototype.pa;
function Dp(a,b){if(b)a.data.status=""==b?void 0:b;else{var c=a.data;c.status&&(c.status=b)}}function Ep(a){return s(a.gd$deleted)?"gd:deleted":(a=a.status)?a:""}function Fp(a){return"gd:deleted"==Ep(a.data)}h.setTitle=function(){throw new Fh;};
h.qc=function(){if(!Gp(this.data))throw Error("nothing to commit");var a=new D;Hp(this,function(b,c){if(c.Fa())a.C(b);else{var d=Yi(c);if(w(d)&&/html/.test(Zi(c,"content-type")))try{var e=(new DOMParser).parseFromString(d,"text/html");e.body&&(d=e.body.innerHTML)}catch(f){}a.D(c.P()+" "+c.La()+" "+d)}},this);return a};
function Hp(a,b,c){var d=Zh("gse");if(Gp(a.data)){var e={"Content-Type":"application/atom+xml"};a.g&&(e["GData-Version"]=a.g);var f={},g="POST",k,l,m;m="full";s(l)||(l="base"!=m);var n=a.kind||"contact";k=k?"/"+k:"";k=(l?"https":"http")+"://www.google.com/m8/feeds/"+n+"s/"+a.user_id.replace("@","%40")+"/"+m+k;k=k.replace("%40","@");if(l=(l=a.ke("edit"))?l.href:void 0)g="delete"==Ep(a.data)?"DELETE":"PUT",k=l;try{var p=Ip(a)}catch(r){Ni({"class":"ydn.gdata.Entry",method:"ydn.gdata.Entry.commit","entry.data":a.data,
context:"toXmlString",error:{name:r.name,message:r.message,stack:r.stack}})}l=a.type;m=["atom","app","gd","batch","ydn"];if("sites"==l||"site"==l||"content"==l||"webpage"==l)m=m.concat("xhtml","sites");else if("m8"==l||"contact"==l)m=m.concat("gContact");p=pp(p,m);Bp.g&&(a.h=[k,f,g,e,p]);d.request(new ai(k,g,f,e,p)).execute(b,c)}else N(a.logger,a+" commit ignore since not modified."),b&&b.call(c,null,null)}function Gp(a){if(null==a.id)return!0;a=Ep(a);return"modified"===a||"delete"===a}h.Je=function(){return this.data};
function Ip(a){var b=new vp(null,"entry",a.Je()),c=!1;b.xmlns||(b.xmlns="http://www.w3.org/2005/Atom",c=!0);var d=["atom"],e;for(e in a.data)if(a=e.match(/^(\w+)\$\w+/))a=a[1],a in op&&(Xa(d,a)||d.push(a));e=zp(b);c&&delete b.xmlns;return pp(e,d)}h.update=function(a){var b=["batch$status","batch$operation","status"],c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Xa(b,c)&&!Xa(this.ng,c)&&(this.data[c]=a.data[c])};h.pf=function(a,b){if(Cl(this.data[a],b))return!1;this.data[a]=Ul(b);return!0};
h.of=function(a){if(a.data.updated.$t>=this.data.updated.$t&&Fp(a)){if(Fp(this)||"delete"==Ep(this.data))return!1;Dp(this,"delete");return!0}var b=!1,c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Xa(this.ng,c)&&this.pf(c,a.data[c])&&(b=!0);b&&(a=Ep(this.data),"delete"==a?M(this.logger,this+" marked for deletion. Cannot mark modify flag."):"committed"==a?this.logger.log(Qe,this+" already committed. All changes must wait until updated from the server.",void 0):Dp(this,"modified"));return b};function Jp(a,b,c){Uo.call(this,a,b,c)}C(Jp,Uo);Jp.prototype.pe=function(){return this.key};Jp.prototype.hc=function(a,b,c,d){a=Jp.m.hc.call(this,a,b,c,d);this.g.Dg(a.method)&&q.gapi&&q.gapi.auth&&(b=gapi.auth.getToken())&&b.access_token&&(a.headers.Authorization=b.token_type+" "+b.access_token);if("GET"==a.method)a.params.alt="json";else if("PUT"==a.method||"POST"==a.method)d=new Bp(d),a.body=Ip(d),a.headers["Content-Type"]="application/atom+xml";return a};
Jp.prototype.Ke=function(a,b){a=Jp.m.Ke.call(this,a,b);a.feed&&(a=a.feed);a.entry&&(a=a.entry);return a};function Kp(a,b,c){bp.call(this,a,b,c);a=c.Options;this.kind=a.kind;this.version=a.version;this.projection=a.projection;this.i=a.maxResults}C(Kp,kp);h=Kp.prototype;h.projection=null;h.version=null;h.logger=P("ydn.db.sync.GData");h.za=function(a,b){return new Jp(this,a,b)};h.vb=function(){var a=Kp.m.vb.call(this);a.key=["id","$t"];a.etag="gd$etag";a.updated=["updated","$t"];return a};h.wb=function(){var a=Kp.m.wb.call(this);return a=a.concat(["version","projection","kind","maxResults"])};
h.Jb=function(){return"https://www.googleapis.com/"+this.kind+"/"};h.Dg=function(){return!1};h.F=function(a){return a?a.id?a.id.$t:"":""};
function Lp(a,b,c){var d=c||a.Jb();c&&O(a.logger,"continuing "+c);b=new ai(d,"GET",b);var e=new D;a.va().request(b).execute(function(b,d){if(200==d.P()){if(!b){var k=Yi(d);w(k)&&(b=JSON.parse(k))}var k=b.feed||b,l=k.entry,l=l?u(l)?l:[l]:[];0<l.length&&Xo(a,l);for(var l=null,k=k.link,k=u(k)?k:[k],m=0;m<k.length;m++)"next"==k[m].rel&&(l=k[m].href);l?qb(Lp(a,{},l),e):(O(a.logger,"prefetch "+a.R+" done"),e.C(!!c))}else 302==d.P()?e.C():(k=a+": Invalid response status "+d.P()+" on prefetching",M(a.logger,
k),e.D(Error(k)))});return e}h.Yb=function(){O(this.logger,"starting prefetch");var a=new D;kl(this.storage.g,this.R,"updated.$t",null,!0,1).A(function(b){var c={alt:"json",kind:this.kind};this.i&&(c["max-results"]=this.i);(b=b[0])?(b=kc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b,O(this.logger,this.R+" fetching entries later then "+b)):O(this.logger,this.R+" fetching entries from beginning");qb(Lp(this,c),a)},this);return a};
h.count=function(a){var b=Nj(this.store,"updated.$t");if(!b)return a;var c=ck(a);a.B(function(a){Sc(c,a);kl(this.storage.g,this.R,b.getName(),null,!1,1).B(function(b){var f={alt:"json"};if(b=u(b)?b[0]:b)b=kc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),f["updated-min"]=b;var g=this,f=new ai(this.Jb(),"GET",f);this.va().request(f).execute(function(b,e){if(200==e.P()){if(!b){var f=Yi(e);w(f)&&(b=JSON.parse(f))}f=kc(b.feed,"openSearch$totalResults");c.C(a+parseFloat(f||0))}else M(g.logger,
g+":Unexpected respond status "+e.P())})},function(a){c.D(a)},this)},function(a){c.D(a)},this);return c};function Mp(a,b,c){Uo.call(this,a,b,c)}C(Mp,Jp);function Np(a,b,c){Kp.call(this,a,b,c);this.h=this.h.substr(27);this.Rb=c.Options.prefix}C(Np,Kp);Np.prototype.va=function(){this.g||(this.g=new Op(gapi.client));return this.g};Np.prototype.za=function(a,b){return new Mp(this,a,b)};Np.prototype.Jb=function(){return this.h+this.Rb};
Np.prototype.Yb=function(){O(this.logger,"starting prefetch");var a=new D;kl(this.storage.g,this.R,"updated",null,!0,1).B(function(b){var c={alt:"json"};if(b=b[0])b=kc(b,"updated"),b=(new Date(1+ +new Date(b))).toISOString(),c.updatedMin=b;var d=this,c=new ai(this.Jb(),"GET",c);d.va().request(c).execute(function(b,c){if(b){var g=b.items||[];0<g.length?Xo(d,g).fa(function(){a.C(!0)}):a.C(!1)}else 302==c.P()?a.C():(g=d+": Invalid response status "+c.P()+" on prefetching",M(d.logger,g),a.D(Error(g)))})},
function(b){a.D(b)},this);return a};function Pp(a,b){if(!s(q.AWS))throw new Pc("AWS JS SDK not loaded");this.h=a;this.i=b;this.g=null}Pp.prototype.request=function(a){return new Qp(this,a)};function Rp(a){var b={params:{Bucket:a.h,region:a.i}};if(!a.h)throw new L("bucket name required");a.g||(a.g=new AWS.S3(b));return a.g}function Qp(a,b){this.parent=a;this.g=b}
function Sp(a,b,c,d,e){var f=NaN,g="",k={};a=Rp(a.parent)[b](c);a.on("complete",function(a){a.httpResponse&&(f=a.httpResponse.statusCode,w(f)&&(f=parseInt(f,10)),k=a.httpResponse.headers);a.error&&(g=a.error.message,f||(f=400))});a.send(function(a,b){var c=new Wi(f,b,k,g);a?d.call(e,null,c):d.call(e,b,c)})}
Qp.prototype.execute=function(a,b){var c=Fd(new sd(this.g.path)),c="/"==c.charAt(0)?c.substr(1):c,d=this.g.headers||{};c&&(d.Key=c);if(c)if("GET"==this.g.method)Sp(this,"getObject",d,a,b);else if("PUT"==this.g.method)Sp(this,"putObject",d,a,b);else throw new Nc("HTTP method "+this.g.method);};function Tp(a,b){this.g=a;this.prefix=Up(this,"Prefix")[0];this.h=b.type}Tp.prototype.ca=function(){return this.g.documentElement.getElementsByTagName("Contents").length};Tp.prototype.keys=function(){var a=Up(this,"Key");if(this.prefix){var b=this.prefix.length,a=a.map(function(a){return a.substr(b)});"INTEGER"==this.h?a=a.map(function(a){return parseInt(a,10)}):"NUMERIC"==this.h&&(a=a.map(function(a){return parseFloat(a)}))}return a};
function Up(a,b){for(var c=[],d=a.g.documentElement.getElementsByTagName(b),e=d.length,f=0;f<e;f++)c[f]=d[f].textContent;return c}function Vp(a){return Up(a,"LastModified").map(function(a){return(new Date(Date.parse(a))).toGMTString()})}
function Wp(a){var b=a.g.documentElement.getElementsByTagName("NextMarker");return 1==b.length?b[0].textContent:"true"==a.g.documentElement.getElementsByTagName("IsTruncated")[0].textContent&&(a=a.g.documentElement.firstElementChild.lastElementChild)&&"Contents"==a.tagName?a.getElementsByTagName("Key")[0]:null};function Xp(a,b,c){bp.call(this,a,b,c);this.i=c.Options.bucket;if(!w(this.i)||va(this.i))throw new L("bucket name required.");this.h||(this.h="https://"+this.i+".s3.amazonaws.com/");if(!0===b.h)throw new L('S3 object store "'+b.getName()+'" must not set autoIncrement to true.');}C(Xp,bp);h=Xp.prototype;h.logger=P("ydn.db.sync.S3");h.wb=function(){var a=Xp.m.wb.call(this);return a=a.concat(["bucket","maxKeys","prefix","delimiter"])};h.va=function(){this.g||(this.g=new Pp(this.i));return this.g};
h.gf=function(a){return this.h+this.j+a};h.za=function(a,b){return new mp(this,a,b)};
h.nf=function(a,b){var c=this;ek(a,function(d,e,f){Sc(a,d);c.Xd(d,function(a){var e={},l=a[0]?Po(a[0]):null;null!=l&&(e.marker=l);0<c.j.length&&(e.prefix=c.j);0<b&&(e["max-keys"]=b);O(c.logger,c+" querying for newer entries starting from "+l);e=new ai(c.h,"GET",e);c.va().request(e).execute(function(b,e){if(200==e.P()){for(var k=Yi(e),k=k instanceof Document?k:Bh(k),l=new Tp(k,c.store),k=l.keys(),l=Vp(l),t=[],x=[],z=[],G=0,E=0;G<=a.length&&E<k.length;){var J=a[G]?Po(a[G]):null,Q=k[E];if(G==a.length)x.push(Q),
E++;else{var oa=J?sj(J,Q):-1;0==oa?((Q=Qo(a[G]))&&l[E]&&Q!=l[E]&&(l[E]>Q?z.push(J):M(c.logger,'record "'+J+'" in database is more recent than server '+Q+" vs "+l[E])),G++,E++):1==oa?(t.push(J),G++):(x.push(Q),E++)}}gp(c,f,d,x,z,t)}else M(c.logger,"Invalid response status "+e.P())})})},this)};
function Yp(a,b){function c(f){null!=f&&(d.marker=f);O(a.logger,a+" querying for newer entries starting from "+f);e.request(new ai(a.h,"GET",d)).execute(function(d,e){if(200==e.P()){var f=Yi(e),f=f instanceof Document?f:Bh(f),f=new Tp(f,a.store),m=Wp(f),f=f.keys(),n=f.length;if(0==n)b([]),b=null;else for(var p=0,r=0;r<n;r++)a.za(f[r]).kc(function(){p++;p==n&&(m?c(m):b&&(b([this.yb()]),b=null))})}else M(a.logger,"Invalid response status "+e.P())})}var d={};0<a.j.length&&(d.prefix=a.j);var e=a.va();
c();a.Z=!0}function Zp(a,b){a.Z||ek(b,function(a,b,e){s(a[0])?e(a):Yp(this,e)},a)};function $p(a,b,c){Uo.call(this,a,b,c)}C($p,mp);$p.prototype.logger=P("ydn.db.sync.entry.Gcs");function aq(a,b,c){Xp.call(this,a,b,c);this.h="https://"+this.i+".storage.googleapis.com/"}C(aq,Xp);aq.prototype.logger=P("ydn.db.sync.Gcs");aq.prototype.va=function(){this.g||(this.g=new ko);return this.g};aq.prototype.za=function(a,b){return new $p(this,a,b)};function Op(a,b){this.h=a;this.g=!!b}Op.prototype.request=function(a){var b={path:a.path,method:a.method,headers:a.headers,params:a.params,body:a.body};this.g&&(b.callback=function(a,e){c.C(a,e);b.callback=null});a=this.h.request(b);var c=new bq(a);return c};function bq(a){this.h=a||null}bq.prototype.C=function(a,b){this.i&&(this.i(a,aj(b)),this.i=null);this.g={json:a,Fc:b}};
bq.prototype.execute=function(a){this.h?(this.h.execute(function(b,c){a(b,aj(c))}),this.h=null):this.g?(a(this.g.json,aj(this.g.Fc)),this.g=null):this.i=a};function cp(a){if(a){if(a instanceof ko)return a;if(ga(a))return new Op({request:function(b){a(b)}},!0);if("request"in a)return new Op(a);throw new L(a+" is not a valid HTTP Client");}return null};function cq(a,b,c){Uo.call(this,a,b,c)}C(cq,$p);cq.prototype.logger=P("ydn.db.sync.entry.GcsJson");cq.prototype.kc=function(a){var b=this.g,c=this;Yo(this,function(d){var e={method:"GET",path:"storage/v1beta2/b/"+b.i+"/o/"+encodeURIComponent(c.getName())};d&&(e.headers=So(d));gapi.client.request(e).execute(function(d,e){var k=aj(e);c.j=new To(c.F(),k.Tc(),b.o);d?(O(c.logger,c+": readServer updated"),c.i=d):(O(c.logger,c+": readServer request fail "+e),c.j=null,c.i=null);a.call(c,200)},e)})};function dq(a,b,c){aq.call(this,a,b,c)}C(dq,aq);h=dq.prototype;h.logger=P("ydn.db.sync.GcsJson");h.vb=function(){var a=dq.m.vb.call(this);a.key="name";return a};h.va=function(){if(!this.g)if(s(q.gapi))this.g=new Op(gapi.client);else throw new Pc("gapi not loaded");return dq.m.va.call(this)};h.za=function(a,b){return new cq(this,a,b)};
h.Yb=function(){N(this.logger,"starting prefetch");var a=new D;ml(this.storage.g,this.R,null,null,1,0,!0,!1).B(function(b){var c={bucket:this.i};(b=b[0])&&(c.marker=b);var d=this;if(!q.ah||q.ah.client)throw Error("gapi lib not loaded");gapi.client.load("storage","v1beta2",function(){var b=gapi.client.storage.objects.list({bucket:d.i});this.Rb&&(c.prefix=this.Rb);b.execute(function(b,c){if(b&&!b.error){var e=b.items||[];0<e.length?Xo(d,null,e).fa(function(){a.C(!0)}):a.C(!1)}else e=d+": "+c,M(d.logger,
e),a.D(Error(e))})})},function(b){a.D(b)},this);return a};function eq(a,b,c){aq.call(this,a,b,c);this.N="full"}C(eq,aq);h=eq.prototype;h.logger=P("ydn.db.sync.GcsMeta");h.vb=function(){var a=eq.m.vb.call(this);a.key="name";return a};h.va=function(){!this.g&&gapi&&(this.g=new Op(gapi.client));return eq.m.va.call(this)};h.za=function(a,b){return new cq(this,a,b)};
h.Yb=function(){N(this.logger,"starting prefetch");var a=new D;if(!q.gapi||!q.gapi.client)throw Error("gapi lib not loaded");var b=this;gapi.client.load("storage","v1beta2",function(){function c(e){e&&(d.pageToken=e);gapi.client.storage.objects.list(d).execute(function(e,g){if(e&&!e.error){var k=e.items||[];if(e.nextPageToken)O(b.logger,"receiving "+k.length+" meta records, continuing next"),Xo(b,k),c(e.nextPageToken);else if(0<k.length)Xo(b,k).fa(function(){O(b.logger,"receiving "+k.length+" meta records, prefetching dane.");
a.C(!0)});else{var l=!!d.pageToken;O(b.logger,"prefetching done");a.C(l)}}else l=b+": "+g,M(b.logger,l),a.D(Error(l))})}var d={bucket:b.i};this.Rb&&(d.prefix=this.Rb);c()});return a};h.Xd=function(a,b){if(0==a.length)b([]);else{var c=this.I(),d=Sa(a,function(a){return new rk(c,a)});fp(this,d).B(function(d){for(var f=[],g=0;g<a.length;g++)f[g]=new Oo(a[g],d[g],this.o,c);b(f)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)}};function fq(a,b,c){bp.call(this,a,b,c)}C(fq,bp);fq.prototype.gf=function(a){return this.h+this.j+this.R+this.na+a};fq.prototype.logger=P("ydn.db.sync.Json");
fq.prototype.nf=function(a){function b(a,b){var c=new ai(e);d.va().request(c).execute(function(c){if(200==c.status){var e=(c.response instanceof Object?c.response:wh(c.responseText)).items;c=Sa(e,function(a){return a.id});for(var e=Sa(e,function(a){return a.updated}),k=[],p=[],r=[],t=0,x=0;t<=a.length&&x<c.length;){var z=Po(a[t]),G=c[x];if(t==a.length)p.push(G),x++;else{var E=sj(z,G);0==E?((G=Qo(a[t]))&&e[x]&&G!=e[x]&&(new Date(e[x])>G?r.push(z):M(d.logger,'record "'+z+'" in database is more recent than server '+
G+" vs "+e[x])),t++,x++):1==E?(k.push(z),t++):(p.push(G),x++)}}gp(d,function(){},b,p,r,k)}else M(d.logger,"Invalid response status "+c.status)})}var c=new Rc,d=this,e=this.h+this.j+this.R;a.A(function(a){Sc(c,a);this.Xd(a,function(c){b(c,a)})},this)};function gq(a,b,c){bp.call(this,a,b,c)}C(gq,kp);function hq(a,b,c){Uo.call(this,a,b,c)}C(hq,mp);hq.prototype.logger=P("ydn.db.sync.entry.S3Meta");function iq(a,b,c){Xp.call(this,a,b,c);this.Rb=c.Options.prefix;if("Key"!=b.keyPath)throw new L('s3-meta store "'+b.getName()+'" must use inline key with keyPath "Key"');this.N="meta"}C(iq,Xp);h=iq.prototype;h.logger=P("ydn.db.sync.S3Meta");h.vb=function(){var a=iq.m.vb.call(this);a.key="Key";a.modified="LastModified";a.etag="ETag";return a};h.za=function(a,b){return new hq(this,a,b)};
h.Yb=function(){function a(f){f&&(e.marker=f);c.listObjects(e).send(function(c,f){if(c){var l=d+": "+xh(c);M(d.logger,l);b.D(c instanceof Error?c:Error(l))}else{var m=f.Contents||[];f.IsTruncated?(O(d.logger,"receiving "+m.length+" meta records, continuing next"),Xo(d,m),a(m[m.length-1].Key+"\uffff")):0<m.length?Xo(d,m).fa(function(){O(d.logger,"receiving "+m.length+" meta records, prefetching dane.");b.C(!0)}):(l=!!e.marker,O(d.logger,"prefetching done"),b.C(l))}})}N(this.logger,"starting prefetch");
var b=new D,c=Rp(this.va()),d=this,e={};this.Rb&&(e.prefix=this.Rb);a();return b};h.Xd=function(){throw new Pc("loading meta data should not be necessary");};function jq(a,b,c){Uo.call(this,a,b,c)}C(jq,Jp);function kq(a,b,c){Kp.call(this,a,b,c);a=c.Options;this.domain=a.domain;this.Z=a.siteName;if(a=Oj(b,"sites$parent"))Dl(a,function(a){for(var b=a.link||[],c=0;c<b.length;c++)if("http://schemas.google.com/sites/2008#parent"==b[c].rel)return b[c].href;return a.id.$t.replace(/\w+$/,"0")}),af(this.logger,"index sites$parent in "+b.getName()+" has set a generator.");if(a=Oj(b,"alternate"))Dl(a,function(a){a=a.link||[];for(var b=0;b<a.length;b++)if("alternate"==a[b].rel)return a[b].href}),af(this.logger,
"index alternate in "+b.getName()+" has set a generator.")}C(kq,Kp);h=kq.prototype;h.za=function(a,b){return new jq(this,a,b)};h.wb=function(){var a=kq.m.wb.call(this);return a=a.concat(["domain","siteName"])};h.Jb=function(){return"https://sites.google.com/feeds/content/"+this.domain+"/"+this.Z+"/"};h.Dg=function(a){return"GET"!=a};
function lq(a,b,c,d){var e={alt:"json",kind:a.kind};"sites$parent"==c?(c=d.match(/\w+$/)[0],e.parent=c):"alternate"==c&&(c=d.replace(/https:\/\/sites.google.com\/a\/[^\/]+\/[^\/]+/,""),e.path=c);var f={},g=a.Jb();ek(b,function(c,l,m){Sc(b,c);if(l=c[0])l=kc(l,"updated","$t"),l=(new Date(1+ +new Date(l))).toISOString(),e["updated-min"]=l;l=new ai(g,"GET",e,f);a.va().request(l).execute(function(b,e){if(200==e.P()){if(!b){var f=Yi(e);w(f)&&(b=JSON.parse(f))}var g=(f=(b.feed||b).entry)?u(f)?f:[f]:[];0<
g.length?Xo(a,g).fa(function(){m(g)}):m(c)}else 302==e.P()?m(c):(f=a+": Invalid response status "+e.P()+" for querying pageName: "+d,M(a.logger,f),m(Error(f),!0))})},a)}h.Ie=function(a,b,c){if(ip(this))ek(a,function(d,e,f){Sc(a,d);jp(this,function(a){!0===a?kl(this.storage.g,this.R,b,S.only(c),!1,0).B(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(a){f(a,!0)},this)},this);else return"alternate"==b||"alternate"==b?lq(this,a,b,c):kq.m.Ie.call(this,a,b,c)};Lk.prototype.g=null;
jm.prototype.Uf=function(a,b){var c=b.format;if("gdata-sites"==c)a.g=new kq(this,a,b);else if("gdata"==c)a.g=new Kp(this,a,b);else if("gdata-json"==c)a.g=new Np(this,a,b);else if("odata"==c)a.g=new gq(this,a,b);else if("s3"==c)a.g=new Xp(this,a,b);else if("s3-meta"==c)a.g=new iq(this,a,b);else if("gcs"==c)a.g=new aq(this,a,b);else if("gcs-json"==c)a.g=new dq(this,a,b);else if("gcs-meta"==c)a.g=new eq(this,a,b);else if("atom"==c)a.g=new kp(this,a,b);else if("json"==c)a.g=new fq(this,a,b);else if("rest"==
c)a.g=new bp(this,a,b);else throw new Nc("Sync format: "+c);Ml(a,function(b,c){var f=b.Hd();if(!(this instanceof Jk)||this.Ua)if(!window.navigator||!s(window.navigator.onLine)||window.navigator.onLine)if("add"==f)f=c[1],a.g.add(b,f);else if("count"==f)c[1]||c[2]||a.g.count(b);else if("put"==f){var f=c[1],g=c[2];a.g.put(b,f,g)}else if("rm:iter"==f)g=c[1],a.g.remove(b,g);else if("values:iter:index"==f){var f=c[1],g=c[2],k=c[3],l=c[4],m=c[5];!k&&!m&&g&&null!=g.lower&&null!=g.upper&&0==sj(g.lower,g.upper)&&
a.g.Ie(b,f,g.lower)}else if("keys"==f)g=c[1],l=c[2],k=c[3],m=c[4],a.g.keys(b,null,g,l,k,m,!1);else if("keys:iter:index"==f)f=c[1],g=c[2],l=c[3],k=c[4],m=c[5],a.g.keys(b,f,g,l,k,m,c[6]);else if("values"==f)g=c[1],l=c[2],k=c[3],m=c[4],g||m?g&&g.lower&&w(g.lower)&&g.lower==g.upper||!g&&m&&1==l&&k&&Zp(a.g,b):a.g.values(b,l,k);else if(""!=f)if("get"==f)g=c[1],a.g.get(b,g);else if("values:array"==f)hp(a.g,b,c[1]);else throw Error(f);})};var mq="Accounts Campaigns Contacts Documents Emails EmailTemplates Employees Leads Notes Opportunities Tasks Teams TeamSets Users".split(" "),nq="Accounts Contacts EmailTemplates Leads Notes Emails".split(" "),oq=["Accounts","Contacts","Leads"],pq=["Accounts","Contacts","Leads"],qq=["Contacts","Leads"],rq=["Notes"];function sq(a,b,c){return"https://"+a+"/index.php?module="+b+"&action=DetailView&record="+c};function tq(a){this.h=a||[]}tq.prototype.g=function(a){return-1==this.h.indexOf(a)?a:null};function uq(){}
uq.prototype.g=function(a){var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};a=a.toLowerCase();var d,e,f=a;if(3>a.length)return a;var g,k;a=a.substr(0,1);"y"==a&&(f=a.toUpperCase()+f.substr(1));g=/^(.+?)(ss|i)es$/;e=/^(.+?)([^s])s$/;
g.test(f)?f=f.replace(g,"$1$2"):e.test(f)&&(f=f.replace(e,"$1$2"));g=/^(.+?)eed$/;e=/^(.+?)(ed|ing)$/;g.test(f)?(e=g.exec(f),g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(e[1])&&(g=/.$/,f=f.replace(g,""))):e.test(f)&&(e=e.exec(f),d=e[1],e=/^([^aeiou][^aeiouy]*)?[aeiouy]/,e.test(d)&&(f=d,e=/(at|bl|iz)$/,k=/([^aeiouylsz])\1$/,d=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,e.test(f)?f+="e":k.test(f)?(g=/.$/,f=f.replace(g,"")):d.test(f)&&(f+="e")));g=/^(.+?)y$/;g.test(f)&&(e=g.exec(f),
d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy]/,g.test(d)&&(f=d+"i"));g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+b[e]));g=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+c[e]));g=
/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;e=/^(.+?)(s|t)(ion)$/;g.test(f)?(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d)):e.test(f)&&(e=e.exec(f),d=e[1]+e[2],e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,e.test(d)&&(f=d));g=/^(.+?)e$/;g.test(f)&&(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,g.test(d)||e.test(d)&&!k.test(d))&&(f=d);g=/ll$/;e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;g.test(f)&&e.test(f)&&(g=/.$/,f=f.replace(g,""));"y"==a&&(f=a.toLowerCase()+f.substr(1));return f};function vq(a){this.h=a}
vq.prototype.g=function(a){a=a.toLowerCase();a=a.replace(/([^c])\1/g,"$1");a=function(a){return a.match(/^(kn|gn|pn|ae|wr)/)?a.substr(1,a.length-1):a}(a);a=a.replace(/mb$/,"m");a=a.replace(/ck/g,"k");a=function(a){a=a.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim();a=a.replace(/cia/g,"xia");a=a.replace(/c(i|e|y)/g,"s$1");return a=a.replace(/c/g,"k")}(a);a=function(a){a=a.replace(/d(ge|gy|gi)/g,"j$1");return a=a.replace(/d/g,"t")}(a);a=function(a){a=a.replace(/gh(^$|[^aeiou])/g,"h$1");return a=a.replace(/g(n|ned)$/g,
"$1")}(a);a=function(a){a=a.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3");a=a.replace(/gg/g,"g");return a=a.replace(/g/g,"k")}(a);a=a.replace(/([aeiou])h([^aeiou])/g,"$1$2");a=a.replace(/ph/g,"f");a=a.replace(/q/g,"k");a=a.replace(/s(h|io|ia)/g,"x$1");a=function(a){a=a.replace(/^x/,"s");return a=a.replace(/x/g,"ks")}(a);a=function(a){a=a.replace(/t(ia|io)/g,"x$1");return a=a.replace(/th/,"0")}(a);a=a.replace(/tch/g,"ch");a=a.replace(/v/g,"f");a=a.replace(/^wh/,"w");a=a.replace(/w([^aeiou]|$)/g,"$1");a=a.replace(/y([^aeiou]|$)/g,
"$1");a=a.replace(/z/,"s");a=a.charAt(0)+a.substr(1,a.length).replace(/[aeiou]/g,"");a.length>=this.h&&(a=a.substring(0,this.h));return a=a.toUpperCase()};var wq=new vq(32),xq=new uq,yq=new tq("a a's able about above according accordingly across actually after afterwards again against ain't all allow allows almost alone along already also although always am among amongst an and another any anybody anyhow anyone anything anyway anyways anywhere apart appear appreciate appropriate are aren't around as aside ask asking associated at available away awfully b be became because become becomes becoming been before beforehand behind being believe below beside besides best better between beyond both brief but by c c'mon c's came can can't cannot cant cause causes certain certainly changes clearly co com come comes concerning consequently consider considering contain containing contains corresponding could couldn't course currently d definitely described despite did didn't different do does doesn't doing don't done down downwards during e each edu eg eight either else elsewhere enough entirely especially et etc even ever every everybody everyone everything everywhere ex exactly example except f far few fifth first five followed following follows for former formerly forth four from further furthermore g get gets getting given gives go goes going gone got gotten greetings h had hadn't happens hardly has hasn't have haven't having he he's hello help hence her here here's hereafter hereby herein hereupon hers herself hi him himself his hither hopefully how howbeit however i i'd i'll i'm i've ie if ignored immediate in inasmuch inc indeed indicate indicated indicates inner insofar instead into inward is isn't it it'd it'll it's its itself j just k keep keeps kept know knows known l last lately later latter latterly least less lest let let's like liked likely little look looking looks ltd m mainly many may maybe me mean meanwhile merely might more moreover most mostly much must my myself n name namely nd near nearly necessary need needs neither never nevertheless new next nine no nobody non none noone nor normally not nothing novel now nowhere o obviously of off often oh ok okay old on once one ones only onto or other others otherwise ought our ours ourselves out outside over overall own p particular particularly per perhaps placed please plus possible presumably probably provides q que quite qv r rather rd re really reasonably regarding regardless regards relatively respectively right s said same saw say saying says second secondly see seeing seem seemed seeming seems seen self selves sensible sent serious seriously seven several shall she should shouldn't since six so some somebody somehow someone something sometime sometimes somewhat somewhere soon sorry specified specify specifying still sub such sup sure t t's take taken tell tends th than thank thanks thanx that that's thats the their theirs them themselves then thence there there's thereafter thereby therefore therein theres thereupon these they they'd they'll they're they've think third this thorough thoroughly those though three through throughout thru thus to together too took toward towards tried tries truly try trying twice two u un under unfortunately unless unlikely until unto up upon us use used useful uses using usually uucp v value various very via viz vs w want wants was wasn't way we we'd we'll we're we've welcome well went were weren't what what's whatever when whence whenever where where's whereafter whereas whereby wherein whereupon wherever whether which while whither who who's whoever whole whom whose why will willing wish with within without won't wonder would wouldn't x y yes yet you you'd you'll you're you've your yours yourself yourselves z zero".split(" "));function zq(a){this.data=a;this.h=0}zq.prototype.g=function(a){for(var b=this.h,c=this.data[b],c=1,d=0;0<=b&&b<this.data.length;){c=this.data[b];if(c instanceof Array)if(a<c[0])c=-1;else if(a>c[1])c=1;else return this.h=b,!0;else{if(c==a)return this.h=b,!0;c=a<c?-1:1}if(0==d)d=c;else if(d!=c)break;b+=c;if(b>this.data.length||0>b)break}return!1};
function Aq(a,b){for(var c=0,d=0,e=a.length,f=0;f<e;++f){a:{var d=a.charCodeAt(f),g=new zq(categ_letters_numbers_data);if(y(d))d=g.g(d);else{for(var k=0,l=d.length;k<l;++k)if(!1===g.g(d[k])){d=!1;break a}d=!0}}d||((d=f-c)&&b(c,d),c=f+1)}(d=e-c)&&b(c,d)};function Bq(a,b){this.j=b;this.value=a}Bq.prototype.V=function(){return this.value};Bq.prototype.xb=function(){return 1};var Cq=Sh||Ph;Bq.prototype.F=function(){return this.value};Bq.prototype.toString=function(){return"Entry:"+this.value};function Dq(a,b,c,d,e,f){Bq.call(this,d,e);this.R=a;this.h=b;this.i=c;this.Yd=f||[]}C(Dq,Bq);h=Dq.prototype;h.kd=function(){return{k:this.j,v:this.value.toLowerCase(),id:this.F(),loc:this.Yd}};h.F=function(){var a=[this.R,this.i,this.h,this.value];return Cq?a:xj(a)};h.I=function(){return this.R};h.ha=function(){return this.i};h.toString=function(){return["IndexEntry",this.R,this.i,this.value].join(":")};function Eq(a,b,c,d,e){Bq.call(this,b,c);this.l=d;this.g=e;this.type=a;this.Wf=1}C(Eq,Bq);Eq.prototype.xb=function(){return this.g*this.type*this.Wf};Eq.prototype.F=function(){return this.value+"|"+this.l};function Fq(a,b){Dq.call(this,b.I(),b.h,b.ha(),b.V(),b.j,[]);this.o=a;this.g=[b]}C(Fq,Dq);h=Fq.prototype;h.count=function(){return this.g.length};h.entry=function(a){return this.g[a]};h.of=function(a){a=a.g[0];for(var b=0;b<this.g.length;b++)if(this.g[b].h==a.h&&this.g[b].value==a.value)return;this.g.push(a)};h.xb=function(){for(var a=0,b=0;b<this.g.length;b++)var c=this.g[b],d=Pl(this.o,c.I(),c.h),c=c.xb(),a=a+c*d.h;return a};function jb(a,b){var c=a.xb(),d=b.xb();return c<=d?1:-1}
h.kd=function(){for(var a={value:this.value,primaryKey:this.i,storeName:this.R,score:this.xb(),tokens:[]},b=0;b<this.g.length;b++)a.tokens[b]=this.g[b].kd();return a};h.toString=function(){return["RankEntry",this.R,this.i,this.value].join(":")+"["+this.g.length+"]"};function Gq(a){var b=[],c;a=a.split(/\s+/);for(var d=0;d<a.length;d++){c=a[d];for(var e=c.length-1,f=Array(e),g=0;g<e;g++)f[g]=c.substring(g,g+2);c=f;b.push.apply(b,c)}return b};function dl(a,b,c,d,e,f,g){Dq.call(this,b,c,d,e,f,g);this.query=a}C(dl,Dq);dl.prototype.xb=function(){var a,b=this.value;a=Gq(this.query.value.toLowerCase().replace(/^\s+|\s+$/g,""));var b=Gq(b.toLowerCase().replace(/^\s+|\s+$/g,"")),c=0,d=a.length+b.length,e,f,g,k;for(e=0;e<a.length;e++)for(g=a[e],f=0;f<b.length;f++)if(k=b[f],g==k){c++;delete b[f];break}a=2*c/d;b=Math.log(this.Yd.length+1);c=this.query.xb();return b*a*c};dl.prototype.kd=function(){return{keyPath:this.h,value:this.value,loc:this.Yd.slice()}};
dl.prototype.toString=function(){return["ResultEntry",this.R,this.i,this.value].join(":")};function Hq(a,b,c){this.g=a;this.h=b;this.j=[];this.limit=c||1E3;this.i=0}function cl(a,b){for(var c,d,e=a.g.getName(),f=0;f<a.h.length;f++){var g=a.h[f],k=g.type;0.4==k||0.6==k?(d="v",c=g.V().toLowerCase(),c=mj(c)):(d="v",c=g.V().toLowerCase(),c=S.only(c));b(e,d,c,g);a.i++;0.6==k&&(d="k",c=g.j,c=S.only(c),b(e,d,c,g),a.i++)}}function bl(a){for(var b=[a.g.getName()],c=0;c<a.g.count();c++){var d=a.g.index(c).I();-1==b.indexOf(d)&&b.push(d)}return b}
function el(a){for(var b=[],c=[],d=0;d<a.j.length;d++){var e=a.j[d];if(0==e.query.type)-1==Wa(c,function(a){return a.ha()==e.ha()&&a.I()==e.I()})&&c.push(e);else{var f=new Fq(a.g,e),g=Wa(b,function(a){return a.ha()==f.ha()&&a.I()==f.I()});if(0<=g){var k=b[g];$a(b,g);k.of(f);f=k}ib(b,f)}}for(a=0;a<c.length;a++)for(g=c[a],d=b.length-1;0<=d;--d)if(k=b[d],g.ha()==k.ha()&&g.I()==k.I()){b.splice(a,1);break}return b.map(function(a){return a.kd()})};function Iq(a){this.g=a;if("en"==a.lang){a=a.h||["stop","stemmer","metaphone"];for(var b=[],c=0;c<a.length;c++)if("metaphone"==a[c])b.push(wq);else if("stemmer"==a[c])b.push(xq);else if("stop"==a[c])b.push(yq);else throw Error('Invalid normalizer "'+a[c]+'" for English lang');a=b}else a=[];this.h=a}function Jq(a,b){for(var c=0;c<a.h.length;c++){var d=a.h[c].g(b);if(d)b=d;else return null}return b}Iq.prototype.parse=function(a){var b=[];Aq(a,function(c,d){b.push(a.substr(c,d))});return b};
Iq.prototype.query=function(a,b,c){a=Kq(this,b);return 0==a.length?null:new Hq(this.g,a,c||10)};
function Kq(a,b){var c=[],d=[];Aq(b,function(a,e){c.push(b.substr(a,e));d.push(a)});for(var e=[],f=0;f<c.length;f++)e[f]=Jq(a,c[f]);for(var g=[],k=0,f=0;f<c.length;f++){var l=c[f],m=e[f],n="*"==b.charAt(d[f]+l.length),p=n?d[f]+l.length+1:d[f]+l.length,p='"'==b.charAt(d[f]-1)&&'"'==b.charAt(p),r="-"==b.charAt(p?d[f]-2:d[f]-1),t=0.8;n?t=0.4:p?t=1:r?t=0:null!=m&&(t=0.6);l=new Eq(t,l,m,d[f],1/(f+2));g.push(l);k+=l.xb()}for(f=0;f<g.length;++f)g[f].Wf=1/k;return g}
function Lq(a,b,c,d){var e=[],f=[];Aq(b,function(a,c){e.push(b.substr(a,c));f.push(a)});for(var g=[],k=0;k<e.length;k++)g[k]=Jq(a,e[k]);a=c.I();c=c.g;for(var l=[],k=0;k<e.length;k++){var m=e[k],n=g[k];if(null!=n){var p=Va(l,function(a){return a.V()==m});p||(p=new Dq(a,c,d,m,n),l.push(p));p.Yd.push(f[k])}}return l}function Mq(a,b,c,d){for(var e=[],f=0;f<a.g.count();f++){var g=a.g.index(f);if(g.I()==b){var k=uj(d,g.g);w(k)&&(e=e.concat(Lq(a,k,g,c)))}}return e};jm.prototype.Tf=function(a,b){var c=this;b.g=new Iq(b);Ml(a,function(d,e){function f(e){var f=a.getName();tk(e)&&ek(d,function(a,g,k){if(g)k(a,g);else{Sc(d,a);var l=kj(S.bound([f,e],[f,e,"\uffff"])),z=b.getName();jl(c.g,z,l).fa(function(){k(a,g)})}})}function g(b){var e=a.getName();ek(d,function(a,f,g){f?g(a,f):(Sc(d,a),b&&(b=kj(S.bound([e,b.lower],[e,b.upper,"\uffff"]))),jl(c.g,e,b).fa(function(){g(a,f)}))})}function k(e,f){var g=a.getName();ek(d,function(a,k,l){Sc(d,a);if(k)l(a,k);else{var z=b.getName();
u(a)||(a=[a]);for(var G=0;G<a.length;G++){var E=a[G];if(tk(E)){if(f){var J=kj(S.bound([g,E],[g,E,"\uffff"]));jl(c.g,z,J)}E=Mq(b.g,g,E,e[G]).map(function(a){return a.kd()});E=hl(c.g,z,E);G==a.length-1&&E.fa(function(){l(a,k)})}}}})}var l=d.Hd();"put"==l?k([e[1]],!0):"put:array"==l?k(e[1],!0):"add"==l?k([e[1]],!1):"add:array"==l?k(e[1],!1):"rm:iter"==l||"clear"==l?g(e[1]):"rm"==l&&f(e[1])})};
jm.prototype.search=function(a,b,c,d){var e=Tl(this.h,a);if(!e)throw new L('full text index catalog "'+a+'" not found.');a=e.g.query(a,b,c,d);return a?this.g.search(a):(N(this.logger,'query "'+b+'" contains only noise and search is ignored'),fk("search",null))};function Nq(a){this.name=a;this.info=null;this.h={};this.g=null}
var Oq={Accounts:{GeneratorIndex:{ydn$emails:["email","email1","email_addresses_non_primary"],ydn$phones:["phone_office","phone_alternate","phone_fax"]}},Contacts:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Documents:{FullTextIndex:{content:["name","document_name","filename","description"]},indexes:[{name:"parent",keyPath:["doc_type","doc_id"]}]},
Emails:{FullTextIndex:{content:["name","description"]},GeneratorIndex:{ydn$emails:["bcc_addrs","cc_addrs","from_addr","to_addrs","reply_to_addr"]},indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]},{name:"message_id"}]},Leads:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Notes:{FullTextIndex:{content:["name","description"]},
indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]}]}};
function Pq(a,b){return"ydn$emails"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=a.indexOf(e))if(w(b[e]))if(/addrs$/.test(e))for(var f=b[e].split(","),g=0;g<f.length;g++){var k=ln(f[g]);k&&d.push(k)}else(k=ln(b[e]))&&d.push(k);else if(v(b[e])&&b[e][0]&&b[e][0].email_address)for(f=b[e],g=0;g<f.length;g++)f[g]&&w(f[g].email_address)&&(k=ln(f[g].email_address))&&d.push(k);return d}}:"ydn$phones"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=
a.indexOf(e)){var f=kn(b[e]);f&&d.push(f)}return d}}:null}function Qq(a,b){if(a.g)for(var c=0;c<a.g.stores.length;c++)if(a.g.stores[c].name==b)return a.g.stores[c];var c=a.h[b]||Oq[b]||{},d={name:b,keyPath:c.keyPath||"id",indexes:[{name:"name"},{name:"date_modified"}]},e=["ydn$emails","ydn$phones","ydn$names"];c.indexes&&(d.indexes=d.indexes.concat(c.indexes));for(var f=c.GeneratorIndex||{},c=0;c<e.length;c++){var g=e[c],k=f[g];!k||u(k)&&0==k.length||d.indexes.push(Pq(k,g))}return d}
function Rq(a){if(a.g)return a.g;for(var b={fullTextCatalogs:[],stores:[{name:"history",indexes:[{keyPath:"type"},{keyPath:"timestamp"}]},{name:"Meta"}]},c=0;c<nq.length;c++){var d=nq[c];b.stores.push(Qq(a,d));var e=a.h[d]||Oq[d]||{};if(e.FullTextIndex)for(var f in e.FullTextIndex){var g=e.FullTextIndex[f];if(0<g.length){for(var k={name:"ft-"+d+"-"+f,lang:"en",sources:[]},l=0;l<g.length;l++)k.sources.push({storeName:d,keyPath:g[l]});b.fullTextCatalogs.push(k)}}}a.g=b;Object.freeze(a.g);return a.g}
;function Sq(a,b,c){this.domain=a;this.module=b;this.g=c||null}Sq.prototype.K=function(){return this.domain};function Tq(a,b){if(b){a.g||(a.g={});for(var c in b)a.g[c]=b[c]}}Sq.prototype.F=function(){return this.g.id};function Uq(a){return a.g?+new Date(a.g.date_modified+" GMT"):NaN}function Vq(a){if(!a.g)return"";var b=a.g.full_name||a.g.name;return b?b:a.g.first_name||a.g.last_name?(b=(a.g.first_name||"").trim(),a=(a.g.last_name||"").trim(),b+" "+a):a.g.id}
Sq.prototype.value=function(a){return this.g?this.g[a]:null};Sq.prototype.toString=function(){return"Record:"+this.module+":"+(this.g?this.g.id:void 0)};function Wq(a,b,c){var d=0;if(!b)return d;b.gd$city&&a[c+"_address_city"]!=b.gd$city.$t&&(a[c+"_address_city"]=b.gd$city.$t,d++);b.gd$country&&a[c+"_address_country"]!=b.gd$country.$t&&(a[c+"_address_country"]=b.gd$country.$t,d++);b.gd$postcode&&a[c+"_address_postalcode"]!=b.gd$postcode.$t&&(a[c+"_address_postalcode"]=b.gd$postcode.$t,d++);b.gd$region&&a[c+"_address_state"]!=b.gd$region.$t&&(a[c+"_address_state"]=b.gd$region.$t,d++);b.gd$street&&a[c+"_address_street"]!=b.gd$street.$t&&(a[c+"_address_street"]=
b.gd$street.$t,d++);b.gd$housename&&a[c+"_address_street_2"]!=b.gd$neighborhood.$t&&(a[c+"_address_street_2"]=b.gd$neighborhood.$t,d++);b.gd$neighborhood&&a[c+"_address_street_3"]!=b.gd$city.$t&&(a[c+"_address_street_3"]=b.gd$city.$t,d++);return d}
function Xq(a,b,c){function d(d,g){!a[c+g]||b[d]&&b[d].$t==a[c+g]||(e++,b[d]={$t:a[c+g]})}var e=0;if(!a)return 0;b||(b={});d("gd$city","_address_city");d("gd$country","_address_country");d("gd$postcode","_address_postalcode");d("gd$region","_address_state");d("gd$street","_address_street");d("gd$neighborhood","_address_street_2");d("gd$city","_address_street_3");return e}
function Yq(a,b){var c=0;!a.title||b.name&&b.name==a.title.$t||(b.name=a.title.$t,c++);for(var d=0;a.gd$email&&d<a.gd$email.length;d++){var e=a.gd$email[d];"http://schemas.google.com/g/2005#work"==e.rel?b.email1!=e.address&&(c++,b.email1=e.address):"http://schemas.google.com/g/2005#home"==e.rel?b.email2!=e.address&&(c++,b.email2=e.address):"http://schemas.google.com/g/2005#other"==e.rel&&b.email!=e.address&&(c++,b.email=e.address)}a.gd$name?(a.gd$name.gd$namePrefix&&b.salutation!=a.gd$name.gd$namePrefix.$t&&
(c++,b.salutation=a.gd$name.gd$namePrefix.$t),a.gd$name.gd$givenName&&b.first_name!=a.gd$name.gd$givenName.$t&&(b.first_name=a.gd$name.gd$givenName.$t,c++),a.gd$name.gd$familyName&&b.last_name!=a.gd$name.gd$familyName.$t&&(b.last_name=a.gd$name.gd$familyName.$t,c++),a.gd$name.gd$fullName&&b.full_name!=a.gd$name.gd$fullName.$t&&(b.full_name=a.gd$name.gd$fullName.$t,c++)):b.full_name=a.title.$t;a.gd$organization&&a.gd$organization[0]&&(d=a.gd$organization[0],d.gd$orgTitle&&d.gd$orgTitle.$t!=b.title&&
(b.title=d.gd$orgTitle.$t,c++),d.gd$orgDepartment&&d.gd$orgDepartment.$t!=b.department&&(b.department=d.gd$orgDepartment.$t,c++),d.gd$orgJobDescription&&d.gd$orgJobDescription.$t!=b.description&&(b.description=d.gd$orgJobDescription.$t,c++));if(a.gd$im)for(d=0;d<a.gd$im.length;d++)"Twitter"==a.gd$im[d].label&&b.twitter!=a.gd$im[d].address?(b.twitter=a.gd$im[d].address,c++):"Facebook"==a.gd$im[d].label&&b.facebook!=a.gd$im[d].address?(b.facebook=a.gd$im[d].address,c++):"Google Plus"==a.gd$im[d].label&&
b.googleplus!=a.gd$im[d].address?(b.googleplus=a.gd$im[d].address,c++):"Linkedin"==a.gd$im[d].label&&b.linkedin!=a.gd$im[d].address&&(b.linkedin=a.gd$im[d].address,c++);a.gContact$birthday&&b.birthdate!=a.gContact$birthday.when&&(b.birthdate=a.gContact$birthday.when,c++);for(d=0;a.gd$phoneNumber&&d<a.gd$phoneNumber.length;d++)if(e=a.gd$phoneNumber[d],e.$t)if("http://schemas.google.com/g/2005#mobile"==e.rel)b.phone_mobile!=e.$t&&(b.phone_mobile=e.$t,c++);else if("http://schemas.google.com/g/2005#work"==
e.rel)b.phone_work!=e.$t&&(b.phone_work=e.$t,c++);else if("http://schemas.google.com/g/2005#home"==e.rel)b.phone_home!=e.$t&&(b.phone_home=e.$t,c++);else if("http://schemas.google.com/g/2005#fax"==e.rel||"http://schemas.google.com/g/2005#home_fax"==e.rel||"http://schemas.google.com/g/2005#work_fax"==e.rel)b.phone_fax!=e.$t&&(b.phone_fax=e.$t,c++);else if(b.phone_other=e.$t)b.phone_other=e.$t,c++;if(a.gd$structuredPostalAddress){for(var f=e=-1,d=0;d<a.gd$structuredPostalAddress.length;d++){var g=a.gd$structuredPostalAddress[d];
"http://schemas.google.com/g/2005#work"==g.rel||g.primary?e=d:f=d}-1==e&&(f=-1);c+=Wq(b,a.gd$structuredPostalAddress[e],"primary");c+=Wq(b,a.gd$structuredPostalAddress[f],"alt")}return c}
function Zq(a,b){function c(a,c){if(g[a]){b.gd$phoneNumber||(b.gd$phoneNumber=[]);var d;a:{for(d=0;b.gd$phoneNumber&&d<b.gd$phoneNumber.length;d++)if(b.gd$phoneNumber[d].rel==c){d=b.gd$phoneNumber[d];break a}d=null}d?d.$t!=g[a]&&(d.$t=g[a],k++):(b.gd$phoneNumber.push({rel:c,$t:g[a]}),k++)}}function d(a){b.gd$im||(b.gd$im=[]);for(var c=0;c<b.gd$im.length;c++)if(b.gd$im[c].label==a)return b.gd$im[c];return null}function e(){b.gd$name||(b.gd$name={},k++)}function f(a,c){if(g[a]){b.gd$email?v(b.gd$email)||
(b.gd$email=[b.gd$email]):b.gd$email=[];var d;a:{for(d=0;b.gd$email&&d<b.gd$email.length;d++)if(!(0<=l.indexOf(d))&&b.gd$email[d].address==g[a])break a;d=-1}if(0<=d){var e=b.gd$email[d];e.rel!=c&&(k++,e.rel=c);l.push(d)}else b.gd$email.push({rel:c,address:g[a]}),l.push(b.gd$email.length-1),k++}}var g=a.g,k=0;!g.name||b.title&&b.title.$t==g.name||(b.title={$t:g.name},k++);var l=[];f("email1","http://schemas.google.com/g/2005#work");f("email2","http://schemas.google.com/g/2005#home");f("email","http://schemas.google.com/g/2005#other");
g.salutation&&(e(),b.gd$name.gd$namePrefix&&b.gd$name.gd$namePrefix.$t==g.salutation||(b.gd$name.gd$namePrefix={$t:g.salutation},k++));g.first_name&&(e(),b.gd$name.gd$givenName&&b.gd$name.gd$givenName.$t==g.first_name||(b.gd$name.gd$givenName={$t:g.first_name},k++));g.last_name&&(e(),b.gd$name.gd$familyName&&b.gd$name.gd$familyName.$t==g.last_name||(b.gd$name.gd$familyName={$t:g.last_name},k++));g.full_name&&(e(),b.gd$name.gd$fullName&&b.gd$name.gd$fullName.$t==g.full_name||(b.gd$name.gd$fullName=
{$t:g.full_name},k++));if(g.twitter){var m=d("Twitter");m?m.address!=g.twitter&&(m.address=g.twitter,k++):(b.gd$im.push({label:"Twitter",address:g.twitter}),k++)}g.facebook&&((m=d("Facebook"),m)?m.address!=g.facebook&&(m.address=g.facebook,k++):(b.gd$im.push({label:"Facebook",address:g.facebook}),k++));g.googleplus&&((m=d("Google Plus"),m)?m.address!=g.googleplus&&(m.address=g.googleplus,k++):(b.gd$im.push({label:"Google Plus",address:g.googleplus}),k++));g.linkedin&&((m=d("Linkedin"),m)?m.address!=
g.linkedin&&(m.address=g.linkedin,k++):(b.gd$im.push({label:"Linkedin",address:g.linkedin}),k++));!g.birthdate||b.gContact$birthday&&b.gContact$birthday.when==g.birthdate||(b.gContact$birthday={when:g.birthdate},k++);c("phone_mobile","http://schemas.google.com/g/2005#mobile");c("phone_work","http://schemas.google.com/g/2005#work");c("phone_home","http://schemas.google.com/g/2005#home");c("phone_fax","http://schemas.google.com/g/2005#work_fax");c("phone_other","http://schemas.google.com/g/2005#other");
for(var n=-1,m=-1,p=0;b.gd$structuredPostalAddress&&p<b.gd$structuredPostalAddress.length;p++)-1==n&&"true"==b.gd$structuredPostalAddress[p].primary||"http://schemas.google.com/g/2005#work"==b.gd$structuredPostalAddress[p].rel?n=p:-1==m&&(m=p);-1==n&&0<=m&&(n=m,b.gd$structuredPostalAddress[n].primary="true",m=-1);0<=n?k+=Xq(g,b.gd$structuredPostalAddress[n],"primary"):(n={primary:"true",rel:"http://schemas.google.com/g/2005#work"},p=Xq(g,n,"primary"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=
[]),b.gd$structuredPostalAddress.push(n),k+=p));0<=m?k+=Xq(g,b.gd$structuredPostalAddress[m],"alt"):(n={},p=Xq(g,n,"alt"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=[]),b.gd$structuredPostalAddress.push(n),k+=p));return k};function $q(a){if(u(a))return a.map(function(a){return $q(a)});if(A(a)){var b={},c;for(c in a.name_value_list)b[c]=a.name_value_list[c].value;return b}throw Error("Invalid name_value_entries");};function ar(a,b,c,d,e){c=sa(c,"http")?new sd(c):td(ud(new sd,c),"https");yd(c,"");xd(c,null);this.p=c.K();this.N=b;this.l=c.toString().replace(/\/$/,"");this.i=d;this.o=e;this.g=null;this.j=a;this.T=new Nq(this.p);this.db=new Un(this.p,Rq(this.T),{isSerial:!0,policy:"single",mechanisms:["indexeddb"]});this.h=null;this.t=this.H=NaN;this.G=!1;this.history=new Go(this.db)}C(ar,co);h=ar.prototype;h.K=function(){return this.p};
h.request=function(a,b,c,d,e,f){function g(){m.execute(function(g,k){this.H=B();var l=g;if(w(l))try{g=JSON.parse(l)}catch(m){}f||!g||11!=g.number&&10!=g.number?d.call(e,g,k):this.cd().B(function(){this.request(a,b,c,d,e,!0)},function(){d.call(e,null,new Wi(0,null,{},"Login fail"))},this)},this)}for(var k="{",l=0;l<b.length;l++)k+=(0==l?"":",")+'"'+b[l]+'":'+JSON.stringify(c[l]);k+="}";l=new zd;l.add("method",a);l.add("input_type","json");l.add("response_type","json");l.add("rest_data",k);var m=this.j.request(new ai(this.l+
"/service/v4/rest.php","POST",{},{"Content-Type":"application/x-www-form-urlencoded"},l.toString())),k=B()-this.H;0<k&&100>k?(this.H=100+this.H,O(this.logger,"request will call after "+k+" ms."),lf(g,k,this)):g.call(this)};
function br(a,b,c){var d=["session","module_name"];a=[a.g?a.g.id:null,c.module_name];var e=[!1,!1];if("get_entry_list"==b)b=c.query||"",d.push("query"),a.push(b),e.push(""==b),d.push("order_by"),b=c.order_by||"",a.push(b),e.push(""==b),b=c.offset||0,d.push("offset"),a.push(b),e.push(0==b),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length),b=c.max_results||25,d.push("max_results"),
a.push(b),e.push(null!=c.max_results),b=c.deleted||0,d.push("deleted"),a.push(b),e.push(0==b),c=!!c.favorites,d.push("favorites"),a.push(c),e.push(!1==c);else if("get_available_modules"==b)c=c.filter||"",d.push("filter"),a.push(c),e.push(0==c.length);else if("get_module_fields"==b)c=c.fields||[],d.push("fields"),a.push(c),e.push(0==c.length);else if("get_entries"==b)b=c.ids||[],d.push("ids"),a.push(b),e.push(!1),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||
[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length);else for(var f in c)"module_name"!=f&&(d.push(f),a.push(c[f]),e.push(!1));for(c=e.length-1;0<=c;c--)if(e[c])d.pop(),a.pop();else break;return{keys:d,values:a}}
function cr(a,b){var c=b.entry_list;if(u(c)&&0<c.length){var d=c.map(function(a){return'"'+a.id+'"'});return dr(a,"get_entry_list",{module_name:"EmailText",max_results:b.length,query:"email_id IN ("+d.join(",")+")"}).A(function(a){a=a.entry_list;c.length!=a.length&&M(this.logger,"number of entries retrived for EmailText exptected to have "+c.length+" but found only "+a.length);for(var d=0;d<a.length;d++){var g=a[d];if(a[d]){var k=kc(g,"name_value_list","email_id","value"),l=Wa(c,function(a){return a.id==
k});if(0<=l)for(var m in g.name_value_list)c[l].name_value_list[m]=g.name_value_list[m];else af(this.logger,"key "+k+" not found in EmailText")}}return b},a)}}
function er(a,b){var c=b.module_name;a.t=B();var d=dr(a,"get_entry_list",b);"Emails"==c&&(d=d.A(function(a){return cr(this,a)},a));return d.A(function(a){var d=a.result_count,g=a.offset||0,k=a.entry_list,l=parseInt(a.next_offset,10);if(s(d)&&u(k)){if(0<k.length){a=$q(k);var m=this.N,n=this.K(),p=a;if(m.h)for(var p=u(p)?p:[p],r=0;r<p.length;r++)p[r]&&fr(m,new Sq(n,c,p[r]));this.db.put(c,a)}return 0<k.length&&d>=k.length&&l>g?(b.offset=l,er(this,b)):l}throw Error("Invalid REST respond on entry list query on "+
c+": "+JSON.stringify(a));},a)}function gr(a,b){if(!b){for(var c=[],d=0;d<nq.length;d++)c[d]=gr(a,nq[d]);c.push(gr(a,"Users"));return nm(c)}var e={module_name:b},f="module/"+b;return a.db.get("Meta",f).A(function(a){return a?a:dr(this,"get_module_fields",e).A(function(a){a&&a.module_name&&a.module_fields?this.db.put("Meta",a,f):M(this.logger,"Invalid module for "+b+" "+xh(a));return a},this)},a)}
function hr(a,b){var c=new Vj(b,"date_modified",null,!0);return a.db.keys(c,1).A(function(a){var c={};a[0]&&(c.query=b.toLowerCase()+".date_modified>'"+a[0]+"'");c.module_name=b;c.order_by="date_modified";a=er(this,c);a.B(function(a){this.logger.info(this+" module "+b+" synced, "+a+" records updated.")},function(a){var c=".";a&&(c=" with "+a.name+": "+a.message);M(this.logger,this+" module "+b+" failed"+c)},this);return a},a)}
function dr(a,b,c,d){var e=d||0,f=new D;if(!a.g||!a.g.user_id)return 2>e?(O(a.logger,"Request require login, tried "+e),a.cd().A(function(){e++;qb(dr(a,b,c,e),f)})):(N(a.logger,"Cannot do request, not login. Give up after "+e+" retry"),f.D()),f;d=br(a,b,c);a.request(b,d.keys,d.values,function(d,k){k.Fa()&&A(d)?11==d.number&&/invalid/i.test(d.name)?(this.g=null,qb(dr(a,b,c,e),f)):f.C(d):f.D(k.P()+" "+k.La())},a);return f}
h.list=function(a){if(!u(a)||0==a.length)return F("invalid query");for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.limit||5,f=d.offset||0,g=!!d.reverse;if(!A(d))return F("invalid query at "+c+"");var k=d.store;if(-1==nq.indexOf(k))return F("invalid store name at "+c+": "+k);var l=d.index||"id";if(!w(l)||0==l.length)return F("index name missing in "+k);var m=null;null!=d.key?(m=d.key,"ydn$phones"==l?m=kn(m):"ydn$emails"==l&&(m=m.toLowerCase()),m=d.prefix?mj(m):S.only(m)):null!=d.keyRange&&(m=nj(d.keyRange));
"id"==l?b.push(this.db.values(k,m,e,f,g)):Yl(this.db,k,l)?b.push(this.db.values(k,l,m,e,f,g)):b.push(sb([]))}return(new mm(b)).B(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].result=b[c][1]:(M(this.logger,"query "+c+" failed."),a[c].result=[]);return a},function(b){M(this.logger,"list failed "+b);return a},this)};
h.search=function(a){if(!u(a)||0==a.length)return F("invalid query");for(var b=[],c=Rq(this.T),d=0;d<a.length;d++){var e=a[d];if(!A(e))return F("invalid query at "+d+"");var f=e.q;if(!w(f)||0==f.length)return F("query term missing "+d+"");var g="ft-"+e.store+"-"+(e.index||"name");0<=Wa(c.fullTextCatalogs,function(a){return a.name==g})?(f=this.db.search(g,e.q),e.fetchFull&&(f=f.A(function(a){if(0<a.length){for(var b=[],c=0;c<a.length;c++)b.push(new rk(a[c].storeName,a[c].primaryKey));return this.db.values(b).A(function(b){for(var c=
0;c<b.length;c++)a.record=b[c];return a})}},this)),b.push(f)):b.push(sb([]))}return(new mm(b)).B(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].fullTextResult=b[c][1]:(M(this.logger,"query "+c+" failed."),a[c].fullTextResult=[]);return a},function(b){M(this.logger,"list failed "+b);return a},this)};
function ir(a,b,c,d){var e={module_name:b},f="get_entry";d?(e.query=d+" = '"+c+"'",e.order_by="id",f="get_entry_list"):e.id=c;return dr(a,f,e).A(function(a){if(a&&a.entry_list&&A(a.entry_list[0]))return $q(a.entry_list[0]);N(this.logger,"record "+b+":"+c+" not found.");return null},a)}
function jr(a){if(a.isLogin()){var b="login_data/"+a.g.user_id;return a.db.get("Meta",b).A(function(a){var d=ir(this,"Users",this.g.user_id).A(function(d){a&&a.date_modified==d.date_modified||this.db.put("Meta",d,b)},this);return a?a:d},a)}return F("Not login")}
function kr(a,b,c,d){if(!w(c)||0==c.length)return F("record id required.");if(0<=nq.indexOf(b)){var e;d?(e=S.only(c),e=a.db.values(b,d,e).A(function(a){return a[0]},a)):e=a.db.get(b,c);return e.A(function(a){if(!a)return ir(this,b,c,d)},a)}return 0<=mq.indexOf(b)?ir(a,b,c,d):F("module: "+b+" not registerred")}
function lr(a){if(a.h&&a.h.isLogin)return sb(a.h);var b=new D;a.db.get("Meta","info/server").fa(function(a){a&&a.version?(this.h=a,b.C(a)):this.request("get_server_info",[],[],function(a,c){if(0==c.P())this.h=null,b.D("service "+(this.l+"/service/v4/rest.php")+" not responding");else if(c.Fa()){var f=Yi(c);if((!a||!a.version)&&w(f))try{a=JSON.parse(f)}catch(g){a=Yi(c)}if(a&&a.version){var f=a,k={},l;for(l in f)k[l]=f[l];this.h=k;b.C({info:f,about:mr(this)});this.db.put("Meta",f,"info/server")}else this.h=
null,b.D("invalid respond "+Yi(c))}else this.h=null,b.D("request fail "+c.P()+" "+c.La())},this)},a);return b}function nr(a){var b=new D;a.request("get_available_modules",["filter"],["all"],function(a){b.C(a)},a);return b}function mr(a){var b=a.j,b=b instanceof go&&/proxy/.test(b.h);return{baseUrl:a.l,domain:a.K(),userName:a.i,isLogin:a.isLogin(),hostPermission:!b}}function or(a){return(new mm([lr(a),nr(a)])).A(function(a){return{serverInfo:a[0][1],availableModules:a[1][1],about:mr(this)}},a)}
function pr(a,b,c){var d=[],e;for(e in c)d.push({name:e,value:c[e]});return dr(a,"set_entry",{module_name:b,name_value_list:d}).A(function(a){if(a&&a.id){var c={id:a.id};a=a.entry_list||{};for(var d in a)c[d]=a[d].value;this.db.put(b,c);return c}throw Error("creating "+b+" entry fail");},a)}
function qr(a,b,c){if(c){var d=rr(b,sr,a.K(),void 0,c.id),e=d.module,f=new Sq(a.K(),e,c);N(a.logger,"synchronizing "+b+" to "+f);if(Uq(f)==d.g){var g=new Eo("update-gdata-record");Fo(g,c);b=b.data;A(b)&&Ul(b);Yq(b,c)&&pr(a,e,c).B(function(a){A(a)?g.g=Ul(a):g.g=a;this.history.add(g)},function(a){M(this.logger,"Fail to put record "+c.id+" to server "+a.message)},a)}}}
function tr(a,b){for(var c=ur(b),d=0;d<c.length;d++)0<=nq.indexOf(c[d].module)&&a.db.get(c[d].module,c[d].fd).A(function(a){qr(this,b,a)},a)}function vr(a,b,c){var d={};Yq(c,d);return pr(a,b,d)}h.isLogin=function(){return!!this.g&&!!this.g.user_id};
h.update=function(){if(this.j&&this.j instanceof go)this.logger.info(this+" updating skipped since no direct connection is not available.");else{var a;if(this.G)af(this.logger,"Modules are already updating now at "+a+" / "+nq.length);else{this.G=!0;this.t=B();a=0;var b=this,c=function(){var d=nq[a];d?(N(b.logger,"Syncing module "+d),a++,hr(b,d).fa(function(){b.t=B();q.setTimeout(function(){c()},500)})):(af(b.logger,"Updating module done"),b.G=!1)};c();q.setTimeout(function(){2E3<b.t-B()&&c()},2E3)}}};
h.cd=function(a,b){if(!window.navigator.onLine){var c=this,d=new D;chrome.storage.local.get("last-login",function(a){(a=a["last-login"])&&qb(c.db.get("Meta","login_data/"+a).A(function(a){this.g=a},c),d)});return d}a&&(this.i=a);b&&(this.o=b);if(!this.i)return F("username required.");if(!this.o)return F("password required.");d=new D;this.request("login",["user_auth","application_name","name_value_list"],[{user_name:this.i,password:this.o},"Yathit CRM",{language:"",notifyonsave:"false"}],function(a,
b){if(a&&a.id){this.g=$q(a);this.g.id=a.id;var c={};c["last-login"]=this.g.user_id;chrome.storage.local.set(c);d.C(a)}else a&&a.description?d.D(a.description+" ("+a.name+")"):(c=b.P()+" "+b.La()+" "+Yi(b),d.D("Login fail: "+c.substr(0,200)))},this,!0);return d};
function wr(a){var b=new D;if(a.g&&a.g.user_id){var c="login_data/"+a.g.user_id;chrome.storage.local.remove("last-login");a.db.remove("Meta",c)}a.request("logout",[],[],function(a,c){this.g=null;c.Fa()?(M(this.logger,"Logout request fail with "+c.P()+" "+c.La()),b.C(!0)):b.D(c.P()+" "+c.La())},a,!0);return b}
function xr(a){function b(){f.request(new ai(e.toString())).execute(function(a,b){/sugarcrm/i.test(Yi(b))?d.D("Look like SugarCRM web site, but REST V4 API is not available."):200==b.P()?d.D("Not a SugarCRM web site"):d.D("Invalid respond, "+b.P())})}function c(a,b){var c=new zd;c.add("method","get_server_info");c.add("input_type","json");c.add("response_type","json");c.add("rest_data","{}");f.request(new ai(a,"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},c.toString())).execute(b)}
var d=new D;a=a.trim();sa(a,"http")||(a="https://"+a);var e=new sd(a);yd(e,"");xd(e,null);var f=Zh("proxy"),g=e.ga();a=e.Ec;/rest.php$/.test(a)||(/index.php$/.test(a)?wd(g,a.replace("/index.php","")):wd(g,""));var k=g.toString();(function(a,b){c(a+"/service/v4/rest.php",function(a,c){if(200==c.P()){if(!a||!a.version){var d=Yi(c);if(w(d))try{a=JSON.parse(d)}catch(e){b(null,c);return}else a=d}a&&a.version&&b(a,c)}else b(0,c)})})(k,function(a,f){a?(a.isLogin=!1,a.userName=null,a.domain=g.K(),a.baseUrl=
k,d.C(a)):0==a?"https"==e.lc?(td(g,"http"),setTimeout(function(){c(g.toString(),function(a,c){c.Fa()?d.C(a):b()})},100)):d.D(f.P()+" "+f.La()+" "+Yi(f)):b()});return d}h.toString=function(){return"SugarClient:"+this.p};
function yr(a,b,c){if("about"==b)return sb(mr(a));if("details"==b)return or(a);if("get"==b)return kr(a,c.module,c.id,c.index);if("fetch-module"==b)return hr(a,c);if("info-module"==b)return A(c)&&w(c.module)&&(c=c.module),gr(a,c);if("list"==b)return u(c)?a.list(c):F("query must be an array");if("list-module"==b)return nr(a);if("login-user"==b)return jr(a);if("put-record"==b||"new-record"==b){b=c.module;if(!b||-1==mq.indexOf(b))return F("invalid module name: "+b);c=c.record;return A(c)?pr(a,b,c):F("record object required")}if("search"==
b)return u(c)?a.search(c):F("query must be an array");if("server-info"==b)return lr(a);if("rest"==b){if(!A(c))return F("REST parameter must be an object");b=c.method;c=c.params;return w(b)&&0!=b.length?A(c)?dr(a,b,c):F("REST parameter must be an object"):F("method must be valid string")}return F("invalid req "+b)};function zr(a){Error.captureStackTrace?Error.captureStackTrace(this,zr):this.stack=Error().stack||"";a&&(this.message=String(a))}C(zr,Error);zr.prototype.name="ydn.gdata.error.InvalidAtomFormatError";function Ar(a){Error.captureStackTrace?Error.captureStackTrace(this,Ar):this.stack=Error().stack||"";a&&(this.message=String(a))}C(Ar,Error);Ar.prototype.name="ydn.gdata.error.IncompatibleError";var Br="atom app gd xhtml batch openSearch".split(" ");function Cr(a){if(!s(this.type))throw new Ih("Abstract class cannot be instantiated.");if(w(a))a={id:{$t:a}};else if(!s(a.id)||!w(a.id.$t))throw new Dh("Invalid GDataFeed");this.id=a.id.$t;this.data=a;s(this.data.entry)?u(this.data.entry)||(this.data.entry=[this.data.entry]):this.data.entry=[];this.j={};this.o={};a=u(this.data.entry)?this.data.entry.length:0;for(var b=0;b<a;b++){var c=this.data.entry[b],c=c.id?c.id.$t:c.Vg?c.Vg.$t:"";if(0==c.length)throw new zr("entry "+b);if(0==c.match(/\w+$/)[0].length)throw new zr("entry "+
b+" of "+c);var d=c.match(/\w+$/)[0];this.j[c]=this.data.entry[b];this.o[d]=this.data.entry[b]}this.i=!0;this.G=[];this.t=new kh(function(){this.dispatchEvent(Dr)},300,this);this.Cg=null;this.h=NaN;this.p=void 0}C(Cr,sh);var Dr="i";h=Cr.prototype;h.Jf=function(){return this.kind};h.logger=P("ydn.gdata.Feed");
h.Pb=function(a){var b=new D;O(this.logger,this+" receiving a task, ready: "+this.i);var c=this;this.i?(this.i=!1,b.fa(function(){O(c.logger,c+" finish the task.");c.i=!0;var a=c.G.shift();a&&a.call(this)}),a.call(this,b)):this.G.push(na(ma(a,this),b));return b};h.Cg=null;function Er(a){var b;if(!(b=a.Cg))if(a=a.re(),s(a)){b=a;for(var c=0;c<Qi.length;c++){var d=(0,Qi[c])(a);if(d){b=d;break}}O(Oi,"Resolving "+a+" to "+b);b=Pi[b]||null}else b=Pi["default"];return b}h.hf=function(){this.dispatchEvent("e")};
h.cg=function(){return Br};h.Xg=function(a){a.g()||M(this.logger,"Batch submission failed. "+a.responseText)};
h.qc=function(a,b){var c=this.cg(),d=void 0;s(c)||(c=Br);for(var e="",f=0;f<c.length;f++)var g=c[f],e=0==f?e+(' xmlns="'+op[g]+'" '):e+(" xmlns:"+g+'="'+op[g]+'" ');d=s(d)?"<id>"+d+"</id>":"";d=Bh("<feed"+e+">"+d+"</feed>");for(f=c=0;e=this.tc(f);f++)if(Fp(e))Dp(e,"");else if(Gp(e.data)){var g="delete"==Ep(e.data),k=!(!e.data.id||!e.data.id.$t);Dp(e,null);var l=Ap(new vp(null,"entry",e.data),d.documentElement),m=l.getElementsByTagNameNS(qp("batch"),"operation");m[0]?m=m[0]:m=l.appendChild(d.createElementNS(qp("batch"),
"operation"));l=d.createAttribute("type");l.nodeValue=g?"delete":k?"update":"insert";m.setAttributeNode(l);Dp(e,"committed");c++;a&&a.message({id:this.If(),code:"operation: "+l.nodeValue+" "+e})}if(0==c)return af(this.logger,this+" Nothing to commit."),0;af(this.logger,this+" committing "+c+" entries.");d=Ch(d);b?(this.logger.info("Commit ignored for dry run."),window.console.log(d)):(e=ma(this.Xg,this),this.N&&this.N.stop(),f=Er(this),g=this.He(),f.send(g,e,{method:"POST",body:d,headers:{"Content-Type":"application/atom+xml"},
params:{}}));return c};h.qe=function(a){return new Bp(a)};h.tc=function(a){return 0<=a&&a<this.data.entry.length?this.qe(this.data.entry[a]):null};h.Hf=function(a){return(a=this.j[a])?this.qe(a):null};
h.save=function(a){if(this.store){var b=this;this.l||(this.l=new kh(function(){this.Pb(function(a){var d=b.toJSON(),e=b.data.entry,f,g,k;b.store.Z(function(a){a.put("ydn.gdata.feed",d).Lc(function(a){throw a;}).A(function(){f=!0});a.put("ydn.gdata.entry",e).Lc(function(a){throw a;}).A(function(a){k=a.length;g=!0})},["ydn.gdata.feed","ydn.gdata.entry"],"readwrite").B(function(){f&&g?O(this.logger,b+": saved "+k+" entries."):O(this.logger,b+": saved failed"+e.length+" entries.");a.C(!0)},function(a){throw a;
},this)})},1E3,this));a?mh(this.l):lh(this.l)}};
function Fr(a,b,c){c=c||new D;var d=Er(a);if(!d)return M(a.logger,a+": No transport available."),c.D(Error("No transport available.")),c;d.send(b,function(b){if(200==b.status){a.h=B();b=b.S?mf(b.S.responseText):void 0;if(!b.feed)throw new zr("feed missing.");var d=b.feed;if(!s(d))throw b=yh(d),new zr(b.substr(0,50));if(d.id.$t!=a.F())throw new Ar(d.id.$t+" is not "+a.F());var g=b=0,k=u(d.entry)?d.entry:d.entry?[d.entry]:[];b=k.length;0==b&&O(a.logger,a+": fetch return no result.");for(var l=0;l<b;l++){for(var m=
a,n=k[l],p=n instanceof Bp?n:m.qe(n),r=p,t=0;t<r.pc.length;t++)null!=r.data[r.pc[t]]&&!u(r.data[r.pc[t]])&&(r.data[r.pc[t]]=[r.data[r.pc[t]]]);Dp(r,null);r=r.data;r.batch$status&&(r.batch$status=void 0);r.batch$operation&&(r.batch$operation=void 0);var r=p.F(),x=m.Hf(r);(t=!!x)?x.update(p):(x=Cp(p),m.data.entry.push(n),m.j[r]=p.data,m.o[x]=p.data);!t&&g++}af(a.logger,a+" "+b+" ("+g+" new) entries received");a.hf();(d=Ho(d,"next"))?(a.save(),lh(a.t),a.p=d.$t,Fr(a,d.href,c)):(0<b&&(a.save(),lh(a.t)),
c.C(!0))}else M(a.logger,"Fetching "+b.uri+" failed: "+b.status),c.D(!1)});return c}h.toString=function(){return this.type+":"+this.id};function Gr(a,b){a.Jg&&b.g.set("v",a.Jg);b.g.set("alt","json");b.g.set("showdeleted",!0)}
function Hr(a,b){var c="lu",d=!1;if("lf"==c){if(a.h){var d=!0,e=new Date(a.h),e=e.toISOString();b.g.set("updated-min",e)}}else if("lu"==c){for(var e=0,f=-1,g,k=0;g=a.tc(k);k++)g=g.data.updated.$t,e<g&&(e=g,f=k);if(e=a.tc(f))e=new Date(e.data.updated.$t),e=new Date(1+ +e),e=e.toISOString(),b.g.set("updated-min",e)}else"lo"==c?(b.g.set("orderby","lastmodified"),a.h&&b.g.set("max-results","1")):c="no";O(a.logger,a+" updating "+(d?"continue":"begin")+" by "+c)}h.hi=lp.prototype.ke;h.F=lp.prototype.F;
h.ji=lp.prototype.Yh;h.ii=lp.prototype.Xh;h.re=function(){return this.ji()||""};h.If=function(){return this.id};h.He=function(){return this.ii()};function Ir(a){return a.Pb(function(a){var c=new sd(this.re());Gr(this,c);Hr(this,c);this.U(qh,!1);Fr(this,c.toString()).fa(function(c){th(this);c?a.C(!0):a.D(void 0)},this)})}h.update=function(a){return a||!0!==("undefined"==typeof this.g?null:(this.g&qh)==qh)?Ir(this):(O(this.logger,this+" already loaded."),sb(!1))};
h.count=function(a){if(a){a=0;for(var b,c=0;b=this.tc(c);c++)Fp(b)||"deleted"==Ep(b.data)||a++;return a}return this.data.entry.length};h.toJSON=function(){return{id:this.id,key:this.If(),last_fetch_next_uri:this.p,last_fetch:this.h}};function Jr(a){var b,c=a.match(/^\D*0*(\d{1,2}\D)?\D*0*(.+)/);c?(b=c[1].replace(/\D/g,""),a=c[2].replace(/\D/g,"")):a=a.replace(/\D/g,"");return{ob:b,fb:a}}function Kr(a,b){var c=Jr(a),d=Jr(b);if(s(c.ob)&&s(d.ob)&&0!=c.ob.length&&0!=d.ob.length&&c.ob!==d.ob)return 0;if(s(c.eb)&&0!=c.eb.length){if(s(d.eb)&&0!=d.eb.length){if(c.eb.length>=d.eb.length){for(var e=0;e<d.eb.length;e++)if(c.eb[e]!=d.eb[e])return 0;return 1}for(e=0;e<c.eb.length;e++)if(c.eb[e]!=d.eb[e])return 0}return-1}return 1};function Lr(a){Bp.call(this,a);a=(a=this.id.match(/https?:\/\/www.google.com\/m8\/feeds\/(group|contact|batch)s?\/([^\/]+)\/?(\w+)\/?(\w*)?/))?{ti:"m8",kind:a[1],user_id:a[2]?a[2].replace("%40","@"):"",projection:a[3],id:a[4]}:null;window.console.assert(!!a,"Invalid m8 entry: "+this.id);this.user_id=a.user_id;window.console.assert(a.kind==this.kind,"Invalid kind: "+a.kind+" vs "+this.kind)}C(Lr,Bp);Lr.prototype.logger=P("ydn.gdata.m8.Entry");Lr.prototype.g="3.0";Lr.prototype.type="m8";
Lr.prototype.toString=function(){var a=this.id?Cp(this):void 0;return"m8.Entry."+this.kind+":"+a};function Mr(a){if(!s(this.kind))throw new Ih("Abstract class cannot be instantiated.");Cr.call(this,a);this.user_id=this.F()}C(Mr,Cr);h=Mr.prototype;h.Jf=function(){return this.kind};h.Jg="3.0";h.type="m8";h.toString=function(){return"Feed:"+this.kind+":"+this.user_id};h.re=function(){return"https://www.google.com/m8/feeds/"+this.Jf()+"s/"+this.user_id.replace("@","%40")+"/full?v=3.0"};
h.He=function(){var a=Mr.m.He.call(this);return a?a:"https://www.google.com/m8/feeds/"+this.Jf()+"s/"+this.user_id.replace("@","%40")+"/full/batch?v=3.0"};var Nr=Br.concat(["gContact"]);Mr.prototype.cg=function(){return Nr};function Or(a,b,c,d,e,f){this.scheme=a;this.domain=b;this.module=c;this.fd=d;this.h=y(e)?e:NaN;this.g=y(f)?f:NaN}var sr="sugarcrm";function Pr(a){if(!A(a)||!w(a.value))return null;var b=Qr(a.value);if(!b)return null;var c=NaN,d=NaN;if(w(a.label)){a=a.label;var e=a.indexOf("#"),f=a.indexOf("-");0<e&&0<f&&f>e&&(c=parseInt(a.substring(e,f),10),d=parseInt(a.substring(f),10))}return new Or(b[1],b[2],b[3],b[4],c,d)}function Qr(a){return a?a.match(/(\w+):\/\/([^\/]+)\/([^\/]+)\/(.*)/):null}
Or.prototype.V=function(){return this.scheme+"://"+this.domain+"/"+this.module+"/"+this.fd};function Rr(a){Lr.call(this,a)}C(Rr,Lr);h=Rr.prototype;h.kind="contact";h.logger=P("ydn.gdata.m8.ContactEntry");h.Gf=function(){return"contact"};h.getName=function(a){var b=a?"":this.Cf();if(a||0==b.length)a=this.data.gd$name,A(a)&&(b=a.gd$fullName.$t||"",0==b.length&&(b=(a.gd$givenName.$t||"")+" "+(a.gd$familyName.$t||"")));return xa(b)};function Sr(a){var b=a.data.gd$email;a=[];for(var b=u(b)?b:b?[b]:[],c=0;c<b.length;c++)a.push(b[c].address);return a}
function Tr(a){a=a.data.gd$phoneNumber;a=u(a)?a:A(a)?[a]:[];for(var b=[],c=0;c<a.length;c++)a[c].$t&&!va(a[c].$t)&&b.push(a[c].$t);return b}h.Je=function(){var a=Rr.m.Je.call(this);if(a.ydn$emails||a.ydn$xp||a.ydn$externalIds)a==this.data&&(a=Ul(this.data)),delete a.ydn$emails,delete a.ydn$xp,delete a.ydn$externalIds;return a};h.pc="link category gd$email gd$im gd$organization gd$phoneNumber gd$structuredPostalAddress gd$formattedAddress".split(" ");
function Ur(a,b){function c(a){var b=Va(e,function(b){return b.address===a.address});b?b.rel=s(a.rel)?a.rel:b.rel:d(a)}function d(a){a=Ul(a);f&&delete a.primary;s(void 0)&&(a.rel=void 0);e.push(a)}for(var e=[Ul(a.data.gd$email[0])],f=!!a.data.gd$email[0].primary,g=1;g<a.data.gd$email.length;g++)c(a.data.gd$email[g]);for(g=0;g<b.length;g++)c(b[g]);g=Cl(e,a.data.gd$email);g||(a.data.gd$email=e);return!g}
function Vr(a,b){function c(a){var b=Sa(e,function(b){var c=b.$t;b=a.$t;c&&b&&0!=c.length&&0!=b.length?(c=c.trim(),b=b.trim(),c=Jr(c),b=Jr(b),b=c.ob&&c.fb&&c.ob==b.ob&&c.fb==b.fb?6<=c.fb.length?1:4<=c.fb.length?0.8:0.4:c.fb&&4<=c.fb.length&&c.fb==b.fb?8<=c.fb.length?0.8:4<=c.fb.length?0.6:0.4:0):b=0;return b}),c=Th(b);if(0.4<c.value){var b=e[c.index],f=s(a.rel)?a.rel:b.rel;1==c.value?(b.rel=f,b.$t=a.$t):s(a.rel)&&s(b.rel)&&b.rel!==a.rel?d(a,f):(b.rel=f,c=Kr(b,a),-1==c?b.$t=a.$t:0==c&&(b.$t=a.$t))}else d(a)}
function d(a,b){a=Ul(a);f&&delete a.primary;s(b)&&(a.rel=b);e.push(a)}for(var e=[Ul(a.data.gd$phoneNumber[0])],f=!!a.data.gd$phoneNumber[0].primary,g=1;g<a.data.gd$phoneNumber.length;g++)c(a.data.gd$phoneNumber[g]);for(g=0;g<b.length;g++)c(b[g]);g=Cl(e,a.data.gd$phoneNumber);g||(a.data.gd$phoneNumber=e);return!g}
h.pf=function(a,b){if("gd$phoneNumber"==a){if(null!=this.data.gd$phoneNumber)return Vr(this,b);this.data.gd$phoneNumber=Ul(b);return!0}if("gd$email"==a){if(null!=this.data.gd$email)return Ur(this,b);this.data.gd$email=Ul(b);return!0}return Rr.m.pf.call(this,a,b)};
function rr(a,b,c,d,e){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var f=0;f<a.length;f++){var g=Pr(a[f]);if(g&&!(b&&b!=g.scheme||c&&c!=g.domain||e&&e!=g.fd||d&&d!=g.module))return g}return null}function ur(a){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var b=[],c=0;c<a.length;c++){var d=Pr(a[c]);d&&b.push(d)}return b};function Wr(a){Mr.call(this,a)}C(Wr,Mr);h=Wr.prototype;h.logger=P("ydn.gdata.m8.ContactFeed");h.kind="contact";h.hf=function(){Wr.m.hf.call(this)};h.Hf=function(a){return Wr.m.Hf.call(this,a)};h.qe=function(a){return new Rr(a)};h.tc=function(a){return Wr.m.tc.call(this,a)};h.re=function(){return"https://www.google.com/m8/feeds/contacts/"+this.F()+"/full"};h.If=function(){return"http://www.google.com/m8/feeds/contacts/"+this.F().replace("@","%40")};function Xr(a){function b(a){sa(a,"atom:")&&(a=a.substring(5,a.length));return a.replace("#text","$t").replace(/:/g,"$")}w(a)&&(a=Bh(a));var c={};if(1==a.nodeType){if(0<a.attributes.length)for(var d=0;d<a.attributes.length;d++){var e=a.attributes.item(d);c[b(e.nodeName)]=e.nodeValue}}else 3==a.nodeType&&(c=a.nodeValue);if(a.hasChildNodes())for(d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d),f=b(e.nodeName);if("undefined"==typeof c[f])"content"==f?(c[f]={$t:Ch(e)},e.namespaceURI&&(c[f].xmlns=
e.namespaceURI)):c[f]=Xr(e);else{if("undefined"==typeof c[f].length){var g=c[f];c[f]=[];c[f].push(g)}c[f].push(Xr(e))}}return c};function Yr(a,b){this.id=b.replace("@","%40");this.client=this.g=null;this.i=new nh(function(){af(this.logger,"updating gdata "+this);Zr(this).B(function(a){this.logger.info(this+" synced, "+a+" new entries updated.")},function(){M(this.logger,this+" update failed.")},this)},6E4,this);this.j=a;this.h=null}h=Yr.prototype;h.logger=P("ydn.ds.gdata.GData");h.update=function(){oh(this.i)};h.M=function(){return this.j};function $r(a){var b=new D;a.execute(function(a,d){a?b.C(a):b.D(d)});return b}
function as(a,b){var c=(a.client?a.client:Zh("gse")).request(b);return $r(c).B(function(a){a=a.feed;if(!a.entry)return 0;for(var b=(new Wr(a)).hi("next"),c=a.entry.length,g=!!this.h,k=0;g&&k<c;k++){var l=a.entry[k];l.gContact$externalId&&this.h(l)}return this.M().put(this.I(),a.entry).A(function(){return b?as(this,new ai(b.href)).A(function(a){return c+a},this):c},this)},function(a){M(this.logger,"fetching fail "+(a?a.P()+" "+a.La():""))},a)}h.getParams=function(){return{alt:"json"}};
h.get=function(a){return w(a)&&0!=a.length?this.M().get(this.I(),a):F("invalid key")};h.put=function(a){return this.M().put(this.I(),a)};h.Ig=function(a){return new Bp(a)};function bs(a,b){return a.Ig(b).qc().A(function(a){a=Xr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+xh(a));this.M().put(this.I(),b);return b},a)}
function Zr(a){if(!a.M().getName())return F(Error("database not ready"));if(!a.g){var b=new Vj(a.I(),"updated.$t",null,!0);a.g=a.M().keys(b,1).A(function(a){var b=this.getParams();b.orderby="lastmodified";a[0]?(b.sortorder="descending",a=(new Date(1+ +new Date(a[0]))).toISOString(),b["updated-min"]=a):b.sortorder="ascending";return as(this,new ai(cs(this)+"/full","GET",b)).fa(function(){this.g=null},this)},a)}return a.g}h.toString=function(){return"GData:contact:"+this.id.replace("%40","@")};function ds(a,b){Yr.call(this,a,b)}C(ds,Yr);ds.prototype.I=function(){return"contact"};ds.prototype.getParams=function(){var a=ds.m.getParams.call(this);a.v="3.0";return a};function cs(a){return"https://www.google.com/m8/feeds/contacts/"+a.id}ds.prototype.Ig=function(a){var b=!!a.id;b||(a.id={$t:cs(this)+"/base/0"});var c=new Rr(a);b||delete a.id;return c};function es(a,b){return w(b)?0==b.length?sb([]):a.M().values(a.I(),"ydn$emails",S.only(b),100,0,!1,!0):F("invalid key for email "+b)}
function fs(a,b){var c=b.V();if(!w(c)||0==c.length)return F("invalid key for external id "+c);c=S.only(c);return a.M().values(a.I(),"ydn$externalIds",c).A(function(){},a)}
function gs(a,b,c){return a.M().get(a.I(),b).A(function(a){if(a){if(!c||!c.label||!c.value)return F("invalid external_id_data");var e=c.label,f=c.value;a.gContact$externalId=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var g=new Rr(a),k=!1,l=0;l<a.gContact$externalId.length;l++)if(a.gContact$externalId[l].value==f){a.gContact$externalId[l].label=e;k=!0;break}k||a.gContact$externalId.push({label:e,value:f});Dp(g,"modified");return g.qc().A(function(a){a=
Xr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+xh(a));this.M().put(this.I(),b);return b},this)}throw Error("gdata entry "+b+" not found");},a)};function hs(a){this.g=a;this.i=0;this.j=[];this.l=[0,0,0,0];this.h=new Kinetic.Layer;a=this.g/2;var b=a/3;this.o=[a,a,b,this.g-b];this.p=[a,b,this.g-b,this.g-b]}hs.prototype.clear=function(){this.h=new Kinetic.Layer};var is=Math.pow(2,2),js=Math.pow(2,3),ks=Math.pow(2,4),ls=Math.pow(2,5);hs.prototype.U=function(a,b){this.i=b?this.i|a:this.i&~a};
function ms(a){a.clear();for(var b=[["#C2C2C2","#6B6B6B","#525252","#3D3D3D"],["#FAFAFA","#D8D8D8","#D8D8D8","#C2C2C2"],["#FCCA03","#DD1812","#0140CA","#16A61E"]],c=["m252,324c0,-59.647 48.354,-108 108,-108c26.90799,0 51.51501,9.843 70.42401,26.121c1.03198,-8.564 1.57599,-17.27901 1.57599,-26.121c0,-119.126 -96.43701,-215.722 -215.49899,-215.994c40.89099,0.137 73.99899,33.321 73.99899,74.244c0,41.007 -33.24301,74.25 -74.25,74.25c-41.008,0 -74.25,-33.243 -74.25,-74.25c0,-40.979 33.19701,-74.203 74.16701,-74.248c-0.05602,0 -0.11201,-0.002 -0.16701,-0.002c-119.294,0 -216,96.707 -216,216c0,8.843 0.544,17.55701 1.577,26.121c18.908,-16.278 43.515,-26.121 70.423,-26.121c59.646,0 108,48.353 108,108c0,37.93399 -19.561,71.29401 -49.14301,90.56c26.127,11.21701 54.90701,17.44 85.14301,17.44s59.01599,-6.22299 85.14301,-17.44c-29.582,-19.26599 -49.14301,-52.62601 -49.14301,-90.56z",
"m142,74.25c0,41.007 33.242,74.25 74.25,74.25c41.00699,0 74.25,-33.243 74.25,-74.25c0,-40.923 -33.108,-74.107 -73.99899,-74.244c-0.112,0 -0.22301,-0.004 -0.334,-0.004c-40.97,0.045 -74.16701,33.269 -74.16701,74.248z","m180,324c0,-59.647 -48.354,-108 -108,-108c-26.908,0 -51.515,9.843 -70.424,26.121c9.366,77.69 59.967,142.67798 129.28099,172.43799c29.582,-19.26498 49.14301,-52.625 49.14301,-90.55899z","m430.42401,242.121c-18.909,-16.278 -43.51602,-26.121 -70.42401,-26.121c-59.646,0 -108,48.353 -108,108c0,37.93399 19.561,71.29401 49.142,90.56c69.315,-29.76199 119.91602,-94.74899 129.28201,-172.439z"],
d=b[0].slice(),e=[is,js,ks,ls],f=0;f<e.length;f++){var g=e[f];(a.i&g)==g&&(d[f]=b[2][f])}b=new Kinetic.Group({scaleX:a.g/435,scaleY:a.g/435});e=new Kinetic.Group;for(f=0;f<c.length;f++)a.j[f]=new Kinetic.Path({data:c[f],fill:d[f]}),0<a.l[f]&&(g=a.g/19*8,g=new Kinetic.Text({x:a.o[f]-g/4,y:a.p[f]-g/2,text:String(a.l[f]),fontSize:g,fontFamily:"sans-serif",fill:"white"}),e.add(g)),b.add(a.j[f]);a.h.add(b);a.h.add(e);return a.h};function ns(a){this.g=document.createElement("div");this.h=a||19;this.i=new hs(this.h);this.j=new kh(function(){this.render()},100,this);chrome.runtime.onSuspend&&chrome.runtime.onSuspend.addListener(function(){chrome.browserAction.setTitle({title:"suspended"});this.U(js,!1);this.U(ks,!1);this.U(ls,!1);this.U(is,!1);this.render()}.bind(this))}ns.prototype.n=function(){return this.g};ns.prototype.U=function(a,b){this.i.U(a,b);mh(this.j)};
ns.prototype.render=function(){this.g.parentElement||document.body.appendChild(this.g);(new Kinetic.Stage({container:this.g,width:this.h,height:this.h})).add(ms(this.i));if(chrome.browserAction){var a=this.g.querySelector("canvas"),b=a.getContext("2d");chrome.browserAction.setIcon({imageData:b.getImageData(0,0,a.width,a.height)})}};function Ao(a,b){this.g=a;this.filter=b||null;var c=this;setTimeout(function(){os(c)},6E5*Math.random())}
function os(a){var b=a.g.getName(),c={"Content-Type":"application/json"};a.g.values("log",null,20).A(function(a){if(0!=a.length){var e=a.map(function(a){return a.key});a=JSON.stringify(a);a=new ai("https://mhardartway.s3.amazonaws.com/"+(b+"/"+e[0]),"PUT",null,c,a);var f=Zh(),e=e.map(function(a){return new rk("log",a)});f.request(a).execute(function(a,b){b.Fa()&&this.g.remove(e).A(function(a){a==e.length&&os(this)},this)},this)}},a)}Ao.prototype.log=function(){};function ps(){this.Z=null;this.g={};this.h=null;var a=this.N=new Xh,b=chrome.extension.getURL("option-page.html");a.p=b;this.H=new Vn;this.i=this.p=this.l=this.t=null;this.G=new ug(new yg,"XMLHttpRequest"+location.host);this.o=new ns;chrome.permissions.onAdded.addListener(this.yh.bind(this))}h=ps.prototype;h.logger=P("ydn.crm.app.App");
h.yh=function(a){for(var b=(a=a.origins)?a.length:0,c=0;c<b;c++){var d=a[c].match(/https:\/\/([^\/]+)/);if(d){var d=d[1],e=this.g[d];if(e&&(af(this.logger,"host permission granted to "+e),e.j instanceof go)){var f=Zh("default");this.g[d]=new ar(f,e.N,e.l,e.i,e.o);this.g[d].update()}}}};h.init=function(){N(this.logger,"init "+this);this.o.U(is,!0);to||(Bo(),to=new jo(wo(),void 0,"https://yathit-app.appspot.com",1,!0),Ui(to,$h))};
function qs(a,b){function c(a){return a.cd().A(function(){var b=a.isLogin()?a.i+"@":" (not login) ";this.logger.info("connected to sugarcrm client: "+b+e);a.isLogin()&&(this.g[e]=a,this.G.set(k,l),b=Object.keys(this.g),ao(this.H,b),a.update(),rs(this));return mr(a)},this)}var d=b.baseUrl,e=b.domain||d;if(!e)return F("domain or url required.");e=e.trim();sa(e,"http")&&(e=(new sd(e)).K());/\//.test(e)&&(e=(new sd("https://"+e)).K());if(d&&(d=d.trim(),!sa(d,"http"))){var d=d.replace(/:?\/\//,""),f=new sd("https://"+
d);f.Ec||wd(f,"/");d=f.toString()}var g=a.g[e],k="sugar-client-"+e,l=a.G.get(k)||{};if(g)return g.isLogin()?sb(mr(g)):c.call(a,g);var m=b.userName||l.userName;d||(d=l.base_url);d||(d="https://"+e+"/");if(!m)return N(a.logger,"username not found in "+JSON.stringify(b)),F("username required");var n=b.password;n?b.hashed||(n=CryptoJS.MD5(n).toString()):n=l.password;if(!n)return N(a.logger,"password not found in "+JSON.stringify(b)),F("password required.");l.userName=m;l.password=n;l.base_url=d;var p=
new D;chrome.permissions.contains({origins:[d+"/"]},function(b){b||M(a.logger,"host permission required for "+d);b=b?Zh("default"):Zh("proxy");g=new ar(b,a,d,m,n);qb(c.call(a,g),p)});return p}function ss(a,b,c,d){return 0<=mq.indexOf(b)?a.h.get(c).A(function(a){if(a){var f=mq[mq.indexOf(b)];return vr(d,f,a).A(function(a){if(a&&a.id)return a;throw Error("Set Entry to "+f+" failed");},this)}throw Error("contact entry "+c+" not found");},a):F(new Dh("invalid module name "+b))}
function fr(a,b){var c=new Or(sr,b.K(),b.module,b.F());fs(a.h,c).A(function(a){for(var c=0;c<a.length;c++){var f=a[c];0<Zq(b,f)&&this.h.put(f)}},a)}function rs(a){var b=!1,c;for(c in a.g)if(a.g[c].isLogin()){b=!0;break}a.o.U(is,!0);a.o.U(ls,a.isLogin());a.o.U(js,b)}
function ts(a,b){if(!b)return F("domain required");a.G.remove("sugar-client-"+b);return $n(a.H).A(function(a){a=a||[];var d=a.indexOf(b);0<=d&&(a.splice(d,1),ao(this.H,a));return this.g[b]?wr(this.g[b]).A(function(){delete this.g[b];this.logger.info("SugarCRM "+b+" removed.");rs(this);return!0},this):!1},a)}
h.Ih=function(a){for(var b=u(a.gContact$externalId)?a.gContact$externalId:[a.gContact$externalId],c=0;c<b.length;c++)if(b[c]&&b[c].value&&b[c].label){var d=Qr(b[c].value);d&&"sugarcrm"==d[1]&&(d=d[2],this.g[d]&&tr(this.g[d],new Rr(a)))}};function us(a){a.h=new ds(a.H.g,a.i.email);var b=Zh("gse");a.h.client=b;a.h.h=a.Ih.bind(a);a.h.update()}
function vs(a,b){var c=new D,d=b.email||"";if(a.i&&a.i.email==d)return N(a.logger,"already running for "+d),c.C(a.i),c;a.i=b;a.i.updated=B();d?(a.logger.info(d+" login to YDN server"),Co(a),Wn(a.H,b.Id.$t),us(a),$n(a.H).A(function(a){a=a||[];for(var b=0;b<a.length;b++)a[b]&&qs(this,{domain:a[b]})},a),c.C(a.i),a.isLogin()?(a.o.U(ls,!0),chrome.browserAction.setTitle({title:"Ready"})):(a.o.U(ls,!1),chrome.browserAction.setTitle({title:"Login required."}))):(a.logger.info("Not login to YDN server"),c.C(a.i),
a.o.U(ls,!1),chrome.browserAction.setTitle({title:"Login required."}));return c}function ws(a){var b=new D;Do().request(new ai("/token","DELETE")).execute(function(a,d){d.Fa()?(this.l=this.t=null,b.C(null)):b.D("error "+d.La())},a);return b}
function xs(a,b){var c=A(b)?b:{last_login:"1"},d=Do(),e=new D;d.request(new ai("/audit","GET",c)).execute(function(a,b){if(b.Fa()){if(a.LastLoginRecord){var c=a.LastLoginRecord;if(c.timestamp){var d;d=c.timestamp-B();d=Math.abs(d);if(6E4>d)d="0 minutes";else{var m=Math.floor(d/864E5);d%=864E5;var n=Math.floor(d/36E5),p=Math.floor(d%36E5/6E4),r=Rd(String(m)),t=Rd(String(n)),x=Rd(String(p));d=m*(n+p)?" ":"";var z=n*p?" ":"",m=Ee("{COUNT, plural, =0 {}=1 {{TEXT} day}other {{TEXT} days}}",m,r),n=Ee("{COUNT, plural, =0 {}=1 {{TEXT} hour}other {{TEXT} hours}}",
n,t),p=Ee("{COUNT, plural, =0 {}=1 {{TEXT} minute}other {{TEXT} minutes}}",p,x);d=m+(d+(n+(z+p)))}c.ago=d}}e.C(a)}else e.D(b)},a);return e}
function ij(a,b){if(a.l)return a.l;if(a.t&&a.t.expires<B())return sb(a.t);a.l=new D;var c={url:b||chrome.extension.getURL("option-page.html")},c=new ai("/token","GET",c);Do().request(c).execute(function(a,b){if(b.Fa()){var c=a.Tokens[0];c.has_token?(c.expires=1E3*c.expires_in+B(),this.t=c,this.l.C(c)):this.l.D(c)}else this.t=null,this.l.D(b);this.l=null},a);return a.l}h.isLogin=function(){return!!this.i&&this.i.is_login};
function ys(a,b){if(a.p)return a.p;a.p=Yh(a.N,b).A(function(b){return vs(this,b).A(function(){a.isLogin()?setTimeout(function(){a.p=null},9E5):a.p=null},function(a){this.logger.info("Attamping to login YDN server fail: "+xh(a))})},a);return a.p}function zs(a){a.p=null;a.i=null;a.o.U(ls,!1)}h.toString=function(){return"SugarApp:0.7.14"};function As(){ps.call(this);this.j={};Bs(this)}C(As,ps);As.prototype.logger=P("ydn.crm.app.EventPage");
function Cs(a,b,c){var d=c.req;c.done=!0;var e=null!=c.data?c.data:{};N(a.logger,"service req: "+d+":"+c.id);if("app-setting"==d)c.data=q.localStorage.getItem("app-setting"),b.postMessage(c);else if("echo"==d)N(a.logger,"resp: "+d+":"+c.id),b.postMessage(c);else if("gdata-fetch"==d)e=c.data,"contact"==e?a.h?Zr(a.h).B(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):(c.error="gdata not ready",b.postMessage(c)):(c.error="invalid kind "+e,b.postMessage(c));
else if("gdata-list-contact-by-email"==d)es(a.h,c.data).A(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token"==d)ij(a,c.data).fa(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("feed-log"==d){var f=e.offset||0,e=e.limit||100;oo.g.values("db-logger",null,e||100,f||0,!0).fa(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c)}else if("feed-log-info"==d)f=
e.offset||0,e=e.limit||100,qo(e,f).fa(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token-revoke"==d)ws(a).B(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("list-sugarcrm"==d){e=[];for(f in a.g)e.push(mr(a.g[f]));N(a.logger,"resp: "+c.req+":"+c.id);c.data=e;b.postMessage(c)}else"log-bug"==d?(Ni(c.data),
b.postMessage(c)):"login-info"==d?ys(a,c.data).B(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="invalid login";b.postMessage(this)},c):"logged-in"==d?(ys(a,null).A(function(b){Ds(a,{req:d,info:b})}),b.postMessage(c)):"logout"==d?(zs(a),Ds(a,{req:d}),b.postMessage(c)):"new-entry"==d?A(c.data)?bs(a.h,c.data).B(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error=
"failed to create a new entry";b.postMessage(this)},c):(c.error="Invalid gdata entry data",b.postMessage(c)):"new-sugarcrm"==d?qs(a,c.data).B(function(){N(a.logger,"resp: "+this.req+":"+this.id);this.data=!0;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"remove-sugar"==d?ts(a,c.data).fa(function(a){this.data=a;b.postMessage(this)},c):"server-audit-log"==d?xs(a,e).B(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"sugar-server-info"==
d?(e=c.data,e=/https?:/.test(e)?new sd(e):ud(new sd,e),(e=a.g[e.K()])?lr(e).A(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c):xr(c.data).B(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){N(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},c)):"user-setting"==d?bo().A(function(a){this.data=a;b.postMessage(this)},c):M(a.logger,"Main channel unknown req: "+d)}
function Es(a,b,c,d){var e=d.req;d.done=!0;N(a.logger,"sugar service req: "+c+":"+e+":"+d.id);if(a.isLogin())if("echo"==e)b.postMessage(d);else if("import-gdata"==e){var f=d.data,g=f?f["gdata-id"]:"";g?ss(a,f.module,g,c).B(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(M(a.logger,"resp error: "+e+":"+d.id),d.error="gdata id required",b.postMessage(d))}else"link"==e?(c=a.h,(e=d.data["gdata-id"])?gs(c,e,d.data["external-id"]).B(function(a){this.data=a;
b.postMessage(this)},function(c){M(a.logger,"error linking gdata "+this.req+":"+this.id);this.error=c.name+": "+c.message;b.postMessage(this)},d):(d.error="gdata-id not required",b.postMessage(d))):"login"==e?qs(a,d.data).B(function(c){this.data=c;b.postMessage(this);rs(a)},function(a){this.error=a;b.postMessage(this)},d):"sync-entry"==e?(e=d.data,a.h.get(e).B(function(c){c?new Rr(c):(c="GData entry "+this.data+" not found.",N(a.logger,c),this.error=c,b.postMessage(this))},function(c){N(a.logger,
"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d)):yr(c,e,d.data).B(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){N(a.logger,"resp error: "+this.req+":"+this.id+" "+(c&&c instanceof Error?c.name+" "+c.message:c));this.error=c;b.postMessage(this)},d);else d.error="Not login",b.postMessage(d)}function Fs(a){var b=!1,c;for(c in a.j)"gmail"==a.j[c].group&&(b=!0);a.o.U(ks,b)}
function Ds(a,b){for(var c in a.j){var d=a.j[c];"gmail"==d.group&&d.port.postMessage(b)}}As.prototype.T=function(){var a=Object.keys(this.g)[0];return{sugars:this.g,s0:a?this.g[a]:null,gdata:this.h,ports:this.j,user_info:this.i}};
function Bs(a){chrome.runtime.onMessage.addListener(function(b,c,d){var e=c.url;e&&/https?:\/\/mail.google.com/.test(e)?(c=b?b.req:null,"inject"==c?chrome.storage.local.get("ydn-crm-src",function(b){var c=b["ydn-crm-src"];af(a.logger,"injecting "+c+" to "+e);chrome.tabs.executeScript(null,{file:c},function(){chrome.tabs.executeScript(null,{code:"app = runInjApp();"},function(){af(a.logger,c+" injected");d(c)})})}):"attach"==c&&(af(a.logger,"attaching crm-ex/sidebar.html to "+e),chrome.tabs.executeScript(null,
{code:'var parent = document.getElementById("'+b.parent+'");var f = document.createElement("iframe"); f.src = "crm-ex/sidebar.html"; parent.appendChild(f);'},function(){af(a.logger,"crm-ex/sidebar.html attached");d("crm-ex/sidebar.html")}))):af(a.logger,"invalid sender "+e)});chrome.runtime.onConnect.addListener(function(b){var c=b.sender.url,d=b.name.substr(0,b.name.lastIndexOf("-"));Xa(cd,d)?(af(a.logger,"Channel "+b.name+" connected for "+c),a.j[b.name]={name:b.name,group:d,port:b},Fs(a),b.onMessage.addListener(function(c){if(c&&
A(c)){if("close"==c.req)a.logger.info("closing "+b.name),delete a.j[b.name],b.disconnect(),Fs(a);else if(!c.id){M(a.logger,"Unknown group in pipe info "+b.name);return}if("sugarcrm"==c.group){var f=c.name,g=a.g[f];g?Es(a,b,g,c):M(a.logger,"SugarCRM instance "+f+" not found.")}else if("gmail"==c.group||"dev"==c.group||"host-permission"==c.group||"popup"==c.group||"options"==c.group)for(f in a.j)g=a.j[f],g.group!=c.group||c.name&&c.name!=g.name||(c.group=d,c.name=b.name,g.port.postMessage(c));else Cs(a,
b,c)}else M(a.logger,"invalid message package: "+c)}),b.onDisconnect.addListener(function(){af(a.logger,"disconnected "+b.name);delete a.j[b.name];Fs(a)})):M(a.logger,"channel "+b.name+" ignored from "+c)});af(a.logger,"event page start listening incoming connection")};pa("ydn.debug.log",Li);pa("loadApp",function(a){chrome.storage.local.get("ydn-crm-track",function(b){var c=b["ydn-crm-track"];b="jsc/ydn.crm-0.7.14.js";navigator.onLine&&"Edge"==c?b="https://ydn-src-1.storage.googleapis.com/jsc/ydn.crm-edge.js":"Beta"==c?b="jsc/ydn.crm-0.7.14.js":"RC"==c&&(b="jsc/ydn.crm-0.7.14.js");c=document.createElement("script");c.onload=a;c.type="text/javascript";var d={};d["ydn-crm-src"]=b;chrome.storage.local.set(d);c.src=b;document.getElementsByTagName("head")[0].appendChild(c)})});function Gs(a){K.call(this,"navigate");this.g=a}C(Gs,K);function Hs(a){Lc.call(this);this.g=a||window;yc(this.g,"popstate",this.Zd,!1,this);yc(this.g,"hashchange",this.Zd,!1,this)}C(Hs,Lc);h=Hs.prototype;h.Me=!1;h.Rh="/";h.setEnabled=function(a){a!=this.Me&&(this.Me=a)&&this.dispatchEvent(new Gs(this.getToken()))};h.getToken=function(){var a=this.g.location.href,b=a.indexOf("#");return 0>b?"":a.substring(b+1)};h.J=function(){Gc(this.g,"popstate",this.Zd,!1,this);Gc(this.g,"hashchange",this.Zd,!1,this)};h.Zd=function(){this.Me&&this.dispatchEvent(new Gs(this.getToken()))};function Is(){}da(Is);Is.prototype.g=0;function Y(a){Lc.call(this);this.g=a||Jg();this.Ld=Js}C(Y,Lc);Y.prototype.ea=Is.W();var Js=null;function Ks(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?"highlight":"unhighlight";case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close"}throw Error("Invalid component state");}h=Y.prototype;h.wc=null;h.$=!1;h.Y=null;h.Ld=null;h.Se=null;h.Na=null;h.Ca=null;h.cb=null;
h.Eg=!1;h.F=function(){return this.wc||(this.wc="ydn:"+(this.ea.g++).toString(36))};function Ls(a,b){if(a.Na&&a.Na.cb){var c=a.Na.cb,d=a.wc;d in c&&delete c[d];lc(a.Na.cb,b,a)}a.wc=b}h.n=function(){return this.Y};function Ms(a){return a.l||(a.l=new ff(a))}function Ns(a,b){if(a==b)throw Error("Unable to set parent component");if(b&&a.Na&&a.wc&&Os(a.Na,a.wc)&&a.Na!=b)throw Error("Unable to set parent component");a.Na=b;Y.m.wf.call(a,b)}h.getParent=function(){return this.Na};
h.wf=function(a){if(this.Na&&this.Na!=a)throw Error("Method not supported");Y.m.wf.call(this,a)};h.Q=function(){this.Y=this.g.createElement("div")};h.render=function(a){Ps(this,a)};function Ps(a,b,c){if(a.$)throw Error("Component already rendered");a.Y||a.Q();b?b.insertBefore(a.Y,c||null):a.g.g.body.appendChild(a.Y);a.Na&&!a.Na.$||a.L()}
function Qs(a,b){if(a.$)throw Error("Component already rendered");if(b&&a.Re(b)){a.Eg=!0;var c=Lg(b);a.g&&a.g.g==c||(a.g=Jg(b));a.Wb(b);a.L()}else throw Error("Invalid element to decorate");}h.Re=function(){return!0};h.Wb=function(a){this.Y=a};h.L=function(){this.$=!0;Rs(this,function(a){!a.$&&a.n()&&a.L()})};h.Ka=function(){Rs(this,function(a){a.$&&a.Ka()});this.l&&this.l.removeAll();this.$=!1};
h.J=function(){this.$&&this.Ka();this.l&&(this.l.oa(),delete this.l);Rs(this,function(a){a.oa()});!this.Eg&&this.Y&&Wg(this.Y);this.Na=this.Se=this.Y=this.cb=this.Ca=null;Y.m.J.call(this)};h.u=function(){return this.Se};h.ba=function(a){this.Se=a};h.O=function(a,b){this.pd(a,Ss(this),b)};
h.pd=function(a,b,c){if(a.$&&(c||!this.$))throw Error("Component already rendered");if(0>b||b>Ss(this))throw Error("Child component index out of bounds");this.cb&&this.Ca||(this.cb={},this.Ca=[]);if(a.getParent()==this){var d=a.F();this.cb[d]=a;Za(this.Ca,a)}else lc(this.cb,a.F(),a);Ns(a,this);db(this.Ca,b,0,a);a.$&&this.$&&a.getParent()==this?(c=this.ra(),c.insertBefore(a.n(),c.childNodes[b]||null)):c?(this.Y||this.Q(),b=Z(this,b+1),Ps(a,this.ra(),b?b.Y:null)):this.$&&!a.$&&a.Y&&a.Y.parentNode&&
1==a.Y.parentNode.nodeType&&a.L()};h.ra=function(){return this.Y};function Ts(a){null==a.Ld&&(a.Ld=wi(a.$?a.Y:a.g.g.body));return a.Ld}function Ss(a){return a.Ca?a.Ca.length:0}function Os(a,b){return a.cb&&b?mc(a.cb,b)||null:null}function Z(a,b){return a.Ca?a.Ca[b]||null:null}function Rs(a,b,c){a.Ca&&Qa(a.Ca,b,c)}function Us(a,b){return a.Ca&&b?Pa(a.Ca,b):-1}
h.xc=function(a,b){if(a){var c=w(a)?a:a.F();a=Os(this,c);if(c&&a){var d=this.cb;c in d&&delete d[c];Za(this.Ca,a);b&&(a.Ka(),a.Y&&Wg(a.Y));Ns(a,null)}}if(!a)throw Error("Child is not in parent component");return a};function Vs(a,b,c,d,e){if(!(H||Ib&&Tb("525")))return!0;if(Bb&&e)return Ws(a);if(e&&!d)return!1;y(b)&&(b=Xs(b));if(!c&&(17==b||18==b||Bb&&91==b))return!1;if(Ib&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(H&&d&&b==a)return!1;switch(a){case 13:return!(H&&H&&9<=Vb);case 27:return!Ib}return Ws(a)}
function Ws(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||Ib&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function Xs(a){if(Hb)a=Ys(a);else if(Bb&&Ib)a:switch(a){case 93:a=91;break a}return a}
function Ys(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function Zs(a,b){Lc.call(this);a&&$s(this,a,b)}C(Zs,Lc);h=Zs.prototype;h.vc=null;h.Ud=null;h.jf=null;h.Vd=null;h.Za=-1;h.Ob=-1;h.ve=!1;
var at={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},bt={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},ct=H||Ib&&Tb("525"),dt=Bb&&Hb;h=Zs.prototype;
h.vh=function(a){Ib&&(17==this.Za&&!a.ctrlKey||18==this.Za&&!a.altKey||Bb&&91==this.Za&&!a.metaKey)&&(this.Ob=this.Za=-1);-1==this.Za&&(a.ctrlKey&&17!=a.g?this.Za=17:a.altKey&&18!=a.g?this.Za=18:a.metaKey&&91!=a.g&&(this.Za=91));ct&&!Vs(a.g,this.Za,a.shiftKey,a.ctrlKey,a.altKey)?this.handleEvent(a):(this.Ob=Xs(a.g),dt&&(this.ve=a.altKey))};h.wh=function(a){this.Ob=this.Za=-1;this.ve=a.altKey};
h.handleEvent=function(a){var b=a.h,c,d,e=b.altKey;H&&"keypress"==a.type?c=this.Ob:Ib&&"keypress"==a.type?c=this.Ob:Gb?c=this.Ob:(c=b.keyCode||this.Ob,d=b.charCode||0,dt&&(e=this.ve),Bb&&63==d&&224==c&&(c=191));d=c=Xs(c);var f=b.keyIdentifier;c?63232<=c&&c in at?d=at[c]:25==c&&a.shiftKey&&(d=9):f&&f in bt&&(d=bt[f]);this.Za=d;a=new et(d,0,0,b);a.altKey=e;this.dispatchEvent(a)};h.n=function(){return this.vc};
function $s(a,b,c){a.Vd&&ft(a);a.vc=b;a.Ud=yc(a.vc,"keypress",a,c);a.jf=yc(a.vc,"keydown",a.vh,c,a);a.Vd=yc(a.vc,"keyup",a.wh,c,a)}function ft(a){a.Ud&&(Hc(a.Ud),Hc(a.jf),Hc(a.Vd),a.Ud=null,a.jf=null,a.Vd=null);a.vc=null;a.Za=-1;a.Ob=-1}h.J=function(){Zs.m.J.call(this);ft(this)};function et(a,b,c,d){$b.call(this,d);this.type="key";this.g=a}C(et,$b);var gt;function ht(a,b){b?a.setAttribute("role",b):a.removeAttribute("role")}function it(a,b,c){v(c)&&(c=c.join(" "));var d="aria-"+b;""===c||void 0==c?(gt||(gt={atomic:!1,autocomplete:"none",dropeffect:"none",haspopup:!1,live:"off",multiline:!1,multiselectable:!1,orientation:"vertical",readonly:!1,relevant:"additions text",required:!1,sort:"none",busy:!1,disabled:!1,hidden:!1,invalid:"false"}),c=gt,b in c?a.setAttribute(d,c[b]):a.removeAttribute(d)):a.setAttribute(d,c)};function jt(){}var kt;da(jt);h=jt.prototype;h.Lb=function(){};h.X=function(a){var b=a.g.s("div",lt(this,a).join(" "),a.pa());mt(this,a,b);return b};h.wa=function(a){return a};function nt(a,b,c){if(a=a.n?a.n():a)if(H&&!Tb("7")){var d=ot(Cg(a),b);d.push(b);na(c?Dg:Eg,a).apply(null,d)}else c?Dg(a,b):Eg(a,b)}h.Nd=function(){return!0};
h.sa=function(a,b){b.id&&Ls(a,b.id);var c=this.wa(b);c&&c.firstChild?pt(a,c.firstChild.nextSibling?bb(c.childNodes):c.firstChild):a.Bb=null;var d=0,e=this.w(),f=this.w(),g=!1,k=!1,c=!1,l=Cg(b);Qa(l,function(a){g||a!=e?k||a!=f?d|=this.Le(a):k=!0:(g=!0,f==e&&(k=!0))},this);a.Mb=d;g||(l.push(e),f==e&&(k=!0));k||l.push(f);var m=a.Ee;m&&l.push.apply(l,m);if(H&&!Tb("7")){var n=ot(l);0<n.length&&(l.push.apply(l,n),c=!0)}if(!g||!k||m||c)b.className=l.join(" ");mt(this,a,b);return b};
h.Od=function(a){Ts(a)&&this.Ze(a.n(),!0);a.isEnabled()&&this.yc(a,a.Ea)};function mt(a,b,c){b.Ea||it(c,"hidden",!b.Ea);b.isEnabled()||a.Va(c,1,!b.isEnabled());b.ka&8&&a.Va(c,8,qt(b,8));b.ka&16&&a.Va(c,16,qt(b,16));b.ka&64&&a.Va(c,64,qt(b,64))}h.Pd=function(a,b){Ci(a,!b,!H&&!Gb)};h.Ze=function(a,b){nt(a,this.w()+"-rtl",b)};h.Ye=function(a){var b;return a.ka&32&&(b=a.i.cc(a))?bh(b)&&ch(b):!1};
h.yc=function(a,b){var c;if(a.ka&32&&(c=a.i.cc(a))){if(!b&&qt(a,32)){try{c.blur()}catch(d){}qt(a,32)&&a.Qd(null)}(bh(c)&&ch(c))!=b&&(b?c.tabIndex=0:(c.tabIndex=-1,c.removeAttribute("tabIndex")))}};h.U=function(a,b,c){var d=a.n();if(d){var e=this.Qc(b);e&&nt(a,e,c);this.Va(d,b,c)}};h.Va=function(a,b,c){kt||(kt={1:"disabled",8:"selected",16:"checked",64:"expanded"});(b=kt[b])&&it(a,b,c)};
h.Ab=function(a,b){var c=this.wa(a);if(c&&(Ug(c),b))if(w(b))Zg(c,b);else{var d=function(a){if(a){var b=Lg(c);c.appendChild(w(a)?b.createTextNode(a):a)}};u(b)?Qa(b,d):!v(b)||"nodeType"in b?d(b):Qa(bb(b),d)}};h.cc=function(a){return a.n()};h.w=function(){return"goog-control"};function lt(a,b){var c=a.w(),d=[c],e=a.w();e!=c&&d.push(e);c=b.Mb;for(e=[];c;){var f=c&-c;e.push(a.Qc(f));c&=~f}d.push.apply(d,e);(c=b.Ee)&&d.push.apply(d,c);H&&!Tb("7")&&d.push.apply(d,ot(d));return d}
function ot(a,b){var c=[];b&&(a=a.concat([b]));Qa([],function(d){!Ua(d,na(Xa,a))||b&&!Xa(d,b)||c.push(d.join("_"))});return c}h.Qc=function(a){this.g||rt(this);return this.g[a]};h.Le=function(a){this.i||(this.g||rt(this),this.i=nc(this.g));a=parseInt(this.i[a],10);return isNaN(a)?0:a};function rt(a){var b=a.w();a.g={1:b+"-disabled",2:b+"-hover",4:b+"-active",8:b+"-selected",16:b+"-checked",32:b+"-focused",64:b+"-open"}};var st=!!q.DOMTokenList,tt=st?function(a){return a.classList}:function(a){a=a.className;return w(a)&&a.match(/\S+/g)||[]},ut=st?function(a,b){return a.classList.contains(b)}:function(a,b){return Xa(tt(a),b)},vt=st?function(a,b){a.classList.add(b)}:function(a,b){ut(a,b)||(a.className+=0<a.className.length?" "+b:b)},wt=st?function(a,b){Qa(b,function(b){vt(a,b)})}:function(a,b){var c={};Qa(tt(a),function(a){c[a]=!0});Qa(b,function(a){c[a]=!0});a.className="";for(var d in c)a.className+=0<a.className.length?
" "+d:d},xt=st?function(a,b){a.classList.remove(b)}:function(a,b){ut(a,b)&&(a.className=Ra(tt(a),function(a){return a!=b}).join(" "))};function yt(a,b){if(!ga(a))throw Error("Invalid component class "+a);if(!ga(b))throw Error("Invalid renderer class "+b);var c=ha(a);zt[c]=b}function At(a,b){if(!a)throw Error("Invalid class name "+a);if(!ga(b))throw Error("Invalid decorator function "+b);Bt[a]=b}var zt={},Bt={};function Ct(a,b,c){Y.call(this,c);if(!b){b=this.constructor;for(var d;b;){d=ha(b);if(d=zt[d])break;b=b.m?b.m.constructor:null}b=d?ga(d.W)?d.W():new d:null}this.i=b;this.Bb=s(a)?a:null}C(Ct,Y);h=Ct.prototype;h.Bb=null;h.Mb=0;h.ka=39;h.xe=255;h.mc=0;h.Ea=!0;h.Ee=null;h.cf=!0;h.sd=!1;h.$e=null;function Dt(a,b){a.$&&b!=a.cf&&Et(a,b);a.cf=b}h.Q=function(){var a=this.i.X(this);this.Y=a;var b=this.$e||this.i.Lb();b&&ht(a,b);this.sd||this.i.Pd(a,!1);this.Ea||(R(a,!1),a&&it(a,"hidden",!0))};h.ra=function(){return this.i.wa(this.n())};
h.Re=function(a){return this.i.Nd(a)};h.Wb=function(a){this.Y=a=this.i.sa(this,a);var b=this.$e||this.i.Lb();b&&ht(a,b);this.sd||this.i.Pd(a,!1);this.Ea="none"!=a.style.display};h.L=function(){Ct.m.L.call(this);this.i.Od(this);if(this.ka&-2&&(this.cf&&Et(this,!0),this.ka&32)){var a=this.i.cc(this);if(a){var b=this.j||(this.j=new Zs);$s(b,a);Ms(this).listen(b,"key",this.Ra).listen(a,"focus",this.hh).listen(a,"blur",this.Qd)}}};
function Et(a,b){var c=Ms(a),d=a.n();b?(c.listen(d,"mouseover",a.ad).listen(d,"mousedown",a.Xc).listen(d,"mouseup",a.ec).listen(d,"mouseout",a.df),a.$c!=ca&&c.listen(d,"contextmenu",a.$c),H&&c.listen(d,"dblclick",a.ig)):(c.xa(d,"mouseover",a.ad).xa(d,"mousedown",a.Xc).xa(d,"mouseup",a.ec).xa(d,"mouseout",a.df),a.$c!=ca&&c.xa(d,"contextmenu",a.$c),H&&c.xa(d,"dblclick",a.ig))}h.Ka=function(){Ct.m.Ka.call(this);this.j&&ft(this.j);this.Ea&&this.isEnabled()&&this.i.yc(this,!1)};
h.J=function(){Ct.m.J.call(this);this.j&&(this.j.oa(),delete this.j);delete this.i;this.Ee=this.Bb=null};h.pa=function(){return this.Bb};function pt(a,b){a.Bb=b}h.ub=function(){var a=this.pa();if(!a)return"";if(!w(a))if(u(a))a=Sa(a,dh).join("");else{if(Bg&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];eh(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");Bg||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""))}return wa(a)};
function Ft(a){a.sd=!0;var b=a.n();b&&a.i.Pd(b,!0)}h.Yc=function(a,b){if(b||this.Ea!=a&&this.dispatchEvent(a?"show":"hide")){var c=this.n();c&&(R(c,a),c&&it(c,"hidden",!a));this.isEnabled()&&this.i.yc(this,a);this.Ea=a;return!0}return!1};h.isEnabled=function(){return!qt(this,1)};h.setEnabled=function(a){var b=this.getParent();b&&"function"==typeof b.isEnabled&&!b.isEnabled()||!Gt(this,1,!a)||(a||(Ht(this,!1),this.Ga(!1)),this.Ea&&this.i.yc(this,a),this.U(1,!a))};
h.Ga=function(a){Gt(this,2,a)&&this.U(2,a)};function Ht(a,b){Gt(a,4,b)&&a.U(4,b)}h.Gc=function(a){Gt(this,8,a)&&this.U(8,a)};h.ma=function(a){Gt(this,64,a)&&this.U(64,a)};function qt(a,b){return!!(a.Mb&b)}h.U=function(a,b){this.ka&a&&b!=qt(this,a)&&(this.i.U(this,a,b),this.Mb=b?this.Mb|a:this.Mb&~a)};function It(a,b,c){if(a.$&&qt(a,b)&&!c)throw Error("Component already rendered");!c&&qt(a,b)&&a.U(b,!1);a.ka=c?a.ka|b:a.ka&~b}function Jt(a,b){return!!(a.xe&b)&&!!(a.ka&b)}function Kt(a){a.xe&=-256}
function Gt(a,b,c){return!!(a.ka&b)&&qt(a,b)!=c&&(!(a.mc&b)||a.dispatchEvent(Ks(b,c)))&&!a.H}h.ad=function(a){!Lt(a,this.n())&&this.dispatchEvent("enter")&&this.isEnabled()&&Jt(this,2)&&this.Ga(!0)};h.df=function(a){!Lt(a,this.n())&&this.dispatchEvent("leave")&&(Jt(this,4)&&Ht(this,!1),Jt(this,2)&&this.Ga(!1))};h.$c=ca;function Lt(a,b){return!!a.j&&Yg(b,a.j)}
h.Xc=function(a){this.isEnabled()&&(Jt(this,2)&&this.Ga(!0),!bc(a)||Ib&&Bb&&a.ctrlKey||(Jt(this,4)&&Ht(this,!0),this.i.Ye(this)&&this.i.cc(this).focus()));this.sd||!bc(a)||Ib&&Bb&&a.ctrlKey||a.preventDefault()};h.ec=function(a){this.isEnabled()&&(Jt(this,2)&&this.Ga(!0),qt(this,4)&&this.mb(a)&&Jt(this,4)&&Ht(this,!1))};h.ig=function(a){this.isEnabled()&&this.mb(a)};
h.mb=function(a){if(Jt(this,16)){var b=!qt(this,16);Gt(this,16,b)&&this.U(16,b)}Jt(this,8)&&this.Gc(!0);Jt(this,64)&&this.ma(!qt(this,64));b=new K("action",this);a&&(b.altKey=a.altKey,b.ctrlKey=a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.l=a.l);return this.dispatchEvent(b)};h.hh=function(){Jt(this,32)&&Gt(this,32,!0)&&this.U(32,!0)};h.Qd=function(){Jt(this,4)&&Ht(this,!1);Jt(this,32)&&Gt(this,32,!1)&&this.U(32,!1)};
h.Ra=function(a){return this.Ea&&this.isEnabled()&&this.zc(a)?(a.preventDefault(),a.Wc(),!0):!1};h.zc=function(a){return 13==a.g&&this.mb(a)};yt(Ct,jt);At("goog-control",function(){return new Ct(null)});function Mt(){}C(Mt,jt);da(Mt);h=Mt.prototype;h.w=function(){return"goog-tab"};h.Lb=function(){return"tab"};h.X=function(a){var b=Mt.m.X.call(this,a);(a=a.zb())&&this.Hb(b,a);return b};h.sa=function(a,b){b=Mt.m.sa.call(this,a,b);var c=this.zb(b);c&&a.ee(c);qt(a,8)&&(c=a.getParent())&&ga(c.Hc)&&(a.U(8,!1),c.Hc(a));return b};h.zb=function(a){return a.title||""};h.Hb=function(a,b){a&&(a.title=b||"")};function Nt(a,b,c){Ct.call(this,a,b||Mt.W(),c);It(this,8,!0);this.mc|=9}C(Nt,Ct);Nt.prototype.zb=function(){return this.h};Nt.prototype.Hb=function(a){this.i.Hb(this.n(),a);this.ee(a)};Nt.prototype.ee=function(a){this.h=a};At("goog-tab",function(){return new Nt(null)});function Ot(){}da(Ot);h=Ot.prototype;h.Md=function(){};function Pt(a,b){a&&(a.tabIndex=b?0:-1)}h.Te=function(a){return"DIV"==a.tagName};function Qt(a,b,c){c.id&&Ls(b,c.id);var d=a.w(),e=!1,f=tt(c);f&&Qa(f,function(a){a==d?e=!0:a&&this.xf(b,a,d)},a);e||vt(c,d);Rt(a,b,c);return c}h.xf=function(a,b,c){b==c+"-disabled"?a.setEnabled(!1):b==c+"-horizontal"?St(a,Tt):b==c+"-vertical"&&St(a,Ut)};
function Rt(a,b,c){if(c)for(var d=c.firstChild,e;d&&d.parentNode==c;){e=d.nextSibling;if(1==d.nodeType){var f=a.Rc(d);f&&(f.Y=d,b.isEnabled()||f.setEnabled(!1),b.O(f),Qs(f,d))}else d.nodeValue&&""!=xa(d.nodeValue)||c.removeChild(d);d=e}}h.Rc=function(a){a:{var b;a=tt(a);for(var c=0,d=a.length;c<d;c++)if(b=a[c],b=b in Bt?Bt[b]():null){a=b;break a}a=null}return a};h.Ve=function(a){a=a.n();Ci(a,!0,Hb);H&&(a.hideFocus=!0);var b=this.Md();b&&ht(a,b)};h.w=function(){return"goog-container"};
h.Ue=function(a){var b=this.w(),c=[b,a.Qb==Tt?b+"-horizontal":b+"-vertical"];a.isEnabled()||c.push(b+"-disabled");return c};h.dg=function(){return Ut};function Vt(a,b,c){Y.call(this,c);this.jb=b||Ot.W();this.Qb=a||this.jb.dg()}C(Vt,Y);var Tt="horizontal",Ut="vertical";h=Vt.prototype;h.kf=null;h.ac=null;h.jb=null;h.Qb=null;h.Da=!0;h.$b=!0;h.sc=!0;h.Sa=-1;h.ta=null;h.lb=!1;h.pb=null;function Wt(a){return a.kf||a.n()}h.Q=function(){this.Y=this.g.s("div",this.jb.Ue(this).join(" "))};h.ra=function(){return this.n()};h.Re=function(a){return this.jb.Te(a)};h.Wb=function(a){this.Y=Qt(this.jb,this,a);"none"==a.style.display&&(this.Da=!1)};
h.L=function(){Vt.m.L.call(this);Rs(this,function(a){a.$&&Xt(this,a)},this);var a=this.n();this.jb.Ve(this);this.bc(this.Da,!0);Ms(this).listen(this,"enter",this.bf).listen(this,"highlight",this.eh).listen(this,"unhighlight",this.gh).listen(this,"open",this.zh).listen(this,"close",this.ph).listen(a,"mousedown",this.fh).listen(Lg(a),"mouseup",this.sh).listen(a,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.mh);this.sc&&Yt(this,!0)};
function Yt(a,b){var c=Ms(a),d=Wt(a);b?c.listen(d,"focus",a.We).listen(d,"blur",a.hg).listen(a.ac||(a.ac=new Zs(Wt(a))),"key",a.Ra):c.xa(d,"focus",a.We).xa(d,"blur",a.hg).xa(a.ac||(a.ac=new Zs(Wt(a))),"key",a.Ra)}h.Ka=function(){this.Gb(-1);this.ta&&this.ta.ma(!1);this.lb=!1;Vt.m.Ka.call(this)};h.J=function(){Vt.m.J.call(this);this.ac&&(this.ac.oa(),this.ac=null);this.jb=this.ta=this.pb=this.kf=null};h.bf=function(){return!0};
h.eh=function(a){var b=Us(this,a.target);if(-1<b&&b!=this.Sa){var c=Zt(this);c&&c.Ga(!1);this.Sa=b;c=Zt(this);this.lb&&Ht(c,!0);this.ta&&c!=this.ta&&(c.ka&64?c.ma(!0):this.ta.ma(!1))}b=this.n();null!=a.target.n()&&it(b,"activedescendant",a.target.n().id)};h.gh=function(a){a.target==Zt(this)&&(this.Sa=-1);this.n().removeAttribute("aria-activedescendant")};h.zh=function(a){(a=a.target)&&a!=this.ta&&a.getParent()==this&&(this.ta&&this.ta.ma(!1),this.ta=a)};
h.ph=function(a){a.target==this.ta&&(this.ta=null)};h.fh=function(a){this.$b&&(this.lb=!0);var b=Wt(this);b&&bh(b)&&ch(b)?b.focus():a.preventDefault()};h.sh=function(){this.lb=!1};h.mh=function(a){var b;a:{b=a.target;if(this.pb)for(var c=this.n();b&&b!==c;){var d=b.id;if(d in this.pb){b=this.pb[d];break a}b=b.parentNode}b=null}if(b)switch(a.type){case "mousedown":b.Xc(a);break;case "mouseup":b.ec(a);break;case "mouseover":b.ad(a);break;case "mouseout":b.df(a);break;case "contextmenu":b.$c(a)}};
h.We=function(){};h.hg=function(){this.Gb(-1);this.lb=!1;this.ta&&this.ta.ma(!1)};h.Ra=function(a){return this.isEnabled()&&this.Da&&(0!=Ss(this)||this.kf)&&this.Xe(a)?(a.preventDefault(),a.Wc(),!0):!1};
h.Xe=function(a){var b=Zt(this);if(b&&"function"==typeof b.Ra&&b.Ra(a)||this.ta&&this.ta!=b&&"function"==typeof this.ta.Ra&&this.ta.Ra(a))return!0;if(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)return!1;switch(a.g){case 27:if(this.sc)Wt(this).blur();else return!1;break;case 36:$t(this);break;case 35:au(this);break;case 38:if(this.Qb==Ut)bu(this);else return!1;break;case 37:if(this.Qb==Tt)Ts(this)?cu(this):bu(this);else return!1;break;case 40:if(this.Qb==Ut)cu(this);else return!1;break;case 39:if(this.Qb==
Tt)Ts(this)?bu(this):cu(this);else return!1;break;default:return!1}return!0};function Xt(a,b){var c=b.n(),c=c.id||(c.id=b.F());a.pb||(a.pb={});a.pb[c]=b}h.O=function(a,b){Vt.m.O.call(this,a,b)};h.pd=function(a,b,c){a.mc|=2;a.mc|=64;It(a,32,!1);Dt(a,!1);Vt.m.pd.call(this,a,b,c);a.$&&this.$&&Xt(this,a);b<=this.Sa&&this.Sa++};
h.xc=function(a,b){if(a=w(a)?Os(this,a):a){var c=Us(this,a);-1!=c&&(c==this.Sa?(a.Ga(!1),this.Sa=-1):c<this.Sa&&this.Sa--);var d=a.n();d&&d.id&&this.pb&&(c=this.pb,d=d.id,d in c&&delete c[d])}a=Vt.m.xc.call(this,a,b);Dt(a,!0);return a};function St(a,b){if(a.n())throw Error("Component already rendered");a.Qb=b}
h.bc=function(a,b){if(b||this.Da!=a&&this.dispatchEvent(a?"show":"hide")){this.Da=a;var c=this.n();c&&(R(c,a),this.sc&&Pt(Wt(this),this.$b&&this.Da),b||this.dispatchEvent(this.Da?"aftershow":"afterhide"));return!0}return!1};h.isEnabled=function(){return this.$b};
h.setEnabled=function(a){this.$b!=a&&this.dispatchEvent(a?"enable":"disable")&&(a?(this.$b=!0,Rs(this,function(a){a.Fg?delete a.Fg:a.setEnabled(!0)})):(Rs(this,function(a){a.isEnabled()?a.setEnabled(!1):a.Fg=!0}),this.lb=this.$b=!1),this.sc&&Pt(Wt(this),a&&this.Da))};function du(a,b){b!=a.sc&&a.$&&Yt(a,b);a.sc=b;a.$b&&a.Da&&Pt(Wt(a),b)}h.Gb=function(a){(a=Z(this,a))?a.Ga(!0):-1<this.Sa&&Zt(this).Ga(!1)};h.Ga=function(a){this.Gb(Us(this,a))};function Zt(a){return Z(a,a.Sa)}
function $t(a){eu(a,function(a,c){return(a+1)%c},Ss(a)-1)}function au(a){eu(a,function(a,c){a--;return 0>a?c-1:a},0)}function cu(a){eu(a,function(a,c){return(a+1)%c},a.Sa)}function bu(a){eu(a,function(a,c){a--;return 0>a?c-1:a},a.Sa)}function eu(a,b,c){c=0>c?Us(a,a.ta):c;var d=Ss(a);c=b.call(a,c,d);for(var e=0;e<=d;){var f=Z(a,c);if(f&&a.Yf(f)){a.vf(c);break}e++;c=b.call(a,c,d)}}h.Yf=function(a){return a.Ea&&a.isEnabled()&&!!(a.ka&2)};h.vf=function(a){this.Gb(a)};function fu(){}C(fu,Ot);da(fu);fu.prototype.w=function(){return"goog-tab-bar"};fu.prototype.Md=function(){return"tablist"};fu.prototype.xf=function(a,b,c){this.h||(this.g||gu(this),this.h=nc(this.g));var d=this.h[b];d?(St(a,d==hu||d==iu?Ut:Tt),a.i=d):fu.m.xf.call(this,a,b,c)};fu.prototype.Ue=function(a){var b=fu.m.Ue.call(this,a);this.g||gu(this);b.push(this.g[a.i]);return b};function gu(a){var b=a.w();a.g=qc(ju,b+"-top",ku,b+"-bottom",hu,b+"-start",iu,b+"-end")};function lu(a,b,c){a=a||ju;St(this,a==hu||a==iu?Ut:Tt);this.i=a;Vt.call(this,this.Qb,b||fu.W(),c);mu(this)}C(lu,Vt);var ju="top",ku="bottom",hu="start",iu="end";h=lu.prototype;h.gb=null;h.L=function(){lu.m.L.call(this);mu(this)};h.J=function(){lu.m.J.call(this);this.gb=null};h.xc=function(a,b){nu(this,a);return lu.m.xc.call(this,a,b)};h.vf=function(a){lu.m.vf.call(this,a);this.Hc(Z(this,a))};h.Hc=function(a){a?a.Gc(!0):this.gb&&this.gb.Gc(!1)};
function nu(a,b){if(b&&b==a.gb){for(var c=Us(a,b),d=c-1;b=Z(a,d);d--)if(b.Ea&&b.isEnabled()){a.Hc(b);return}for(c+=1;b=Z(a,c);c++)if(b.Ea&&b.isEnabled()){a.Hc(b);return}a.Hc(null)}}h.Fh=function(a){this.gb&&this.gb!=a.target&&this.gb.Gc(!1);this.gb=a.target};h.Gh=function(a){a.target==this.gb&&(this.gb=null)};h.Dh=function(a){nu(this,a.target)};h.Eh=function(a){nu(this,a.target)};h.We=function(){Zt(this)||this.Ga(this.gb||Z(this,0))};
function mu(a){Ms(a).listen(a,"select",a.Fh).listen(a,"unselect",a.Gh).listen(a,"disable",a.Dh).listen(a,"hide",a.Eh)}At("goog-tab-bar",function(){return new lu});function ou(a,b){this.g=a;this.h=b};function pu(){}C(pu,jt);pu.prototype.logger=P("ydn.crm.inj.sugar.FeedPanelRenderer");pu.prototype.w=function(){return"feed-panel"};pu.prototype.X=function(a){var b=pu.m.X.call(this,a);a=a.g.s("div","feed","Feed panel");b.appendChild(a);return b};pu.prototype.refresh=function(){};function qu(a,b){Ct.call(this,null,null,a);this.ba(b)}C(qu,Ct);qu.prototype.refresh=function(){var a=this.u(),b=this.n();this.i.refresh(b,a)};yt(qu,pu);function ru(a,b){var c=a.type;if(s(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b?"checked":null;break;case "select-one":a.selectedIndex=-1;if(w(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":c=b;w(c)&&(c=[c]);for(var e=0;d=a.options[e];e++)if(d.selected=!1,c)for(var f,g=0;f=c[g];g++)d.value==f&&(d.selected=!0);break;default:a.value=null!=b?b:""}};function su(){}C(su,jt);da(su);su.prototype.w=function(){return"field"};function tu(a){var b=uu(a.parent.module).module_fields[a.g];a="ydnf-"+($(a.parent.module)+"-"+a.g);if("enum"==b.type&&b.options&&!document.getElementById(a)){var c=document.createElement("datalist");c.id=a;for(var d in b.options)d&&(b=document.createElement("option"),b.setAttribute("value",d),c.appendChild(b));document.body.appendChild(c)}return a}
su.prototype.X=function(a){var b=su.m.X.call(this,a);a.Y=b;var c=a.u();a=a.g;var d,e,f=vu(c);d=uu(c.parent.module).module_fields[c.g].type||"varchar";"bool"==d?(d=a.s("input",{"class":"value",type:"checkbox",disabled:"1"}),e=a.s("span","name")):"enum"==d?(d=a.s("input",{"class":"value enum",type:"text",disabled:"1"}),d.setAttribute("list",tu(c))):(d=a.s("label","value"),e=a.s("sup","name"));b.classList.add(this.w());b.setAttribute("name",c.g);b.appendChild(d);e&&(e.textContent=f,b.appendChild(e));
return b};su.prototype.refresh=function(a,b){R(a,!!b);if(b){var c=wu(b),d=w(c)?!va(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":ru(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function xu(a,b,c){Ct.call(this,null,b,c);Dt(this,!1);Ft(this);Kt(this);It(this,32,!1);It(this,8,!1);this.ba(a)}C(xu,Ct);yt(xu,su);xu.prototype.refresh=function(){this.i.refresh(this.n(),this.u())};yt(xu,su);function yu(){}C(yu,jt);da(yu);yu.prototype.w=function(){return"record-group"};
yu.prototype.X=function(a){var b=yu.m.X.call(this,a),c=a.g,d=c.s("div"),e=c.s("div","content");b.appendChild(d);b.appendChild(e);a.Y=b;b.setAttribute("name",a.u().g);for(var d=a.u(),e=zu(d),f=su.W(),g=0;g<e.length;g++){var k=Au(d,e[g]),k=new xu(k,f,c);a.O(k,!0)}a=d.module;c=a.parent.j||null;a=A(c)?kc(c,["modules",$(a)]):null;(a=A(a)?kc(a,["groups",d.g]):null)?d=a.normallyHide:(d=d.g,d=/address/i.test(d)?!1:0<=["email","name","phone"].indexOf(d)?!1:!0);d&&b.classList.add("normally-hide");return b};function Bu(a,b){this.parent=a;this.g=b}function wu(a){var b=a.parent.qa();return b?b.value(a.g):null}Bu.prototype.Sc=function(){return wu(this)};function vu(a){a=uu(a.parent.module).module_fields[a.g];return w(a.label)?a.label.replace(/:$/,""):a.label}Bu.prototype.toString=function(){return this.parent+";Field:"+this.g};function Cu(a,b){this.module=a;this.g=b||"";this.h={}}Cu.prototype.K=function(){return this.module.K()};Cu.prototype.qa=function(){return this.module.qa()};function zu(a){var b=uu(a.module),c=[],d;for(d in b.module_fields){var e=b.module_fields[d];a.g&&e.group==a.g?c.push(d):a.g||e.group||c.push(d)}return c}function Du(a,b){var c=uu(a.module),d;for(d in c.module_fields)if(d==b)return!0;return!1}function Au(a,b){a.h[b]||(a.h[b]=new Bu(a,b));return a.h[b]}
function Eu(a){a=a.g.replace("_"," ");return a=a.charAt(0).toUpperCase()+a.substr(1)};function Fu(a,b,c){Ct.call(this,null,b,c);Dt(this,!1);Ft(this);Kt(this);It(this,32,!1);It(this,8,!1);this.ba(a)}C(Fu,Ct);Fu.prototype.ra=function(){return Mg("content",this.n())};Fu.prototype.refresh=function(){for(var a=0;a<Ss(this);a++)Z(this,a).refresh()};yt(Fu,yu);function Gu(){}C(Gu,su);da(Gu);
Gu.prototype.X=function(a){var b=a.g.s("span",lt(this,a).join(" "),a.pa());mt(this,a,b);a.Y=b;var c=a.u(),d=a.g;a=vu(c);var e=uu(c.parent.module).module_fields[c.g].type||"varchar";"bool"==e?d=d.s("input",{"class":"value",type:"checkbox",disabled:"1"}):"enum"==e?(d=d.s("input",{"class":"value enum",type:"text",disabled:"1"}),d.setAttribute("list",tu(c))):d=d.s("label","value");d.setAttribute("title",a);b.classList.add(this.w());b.setAttribute("name",c.g);b.appendChild(d);return b};
Gu.prototype.refresh=function(a,b){R(a,!!b);if(b){var c=wu(b),d=w(c)?!va(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":ru(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function Hu(){}C(Hu,jt);da(Hu);Hu.prototype.w=function(){return"address"};Hu.prototype.X=function(a){var b=Hu.m.X.call(this,a),c=a.u(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.s("details"),f=d.s("summary");f.textContent=Eu(c);b.appendChild(f);var g=d.s("div","content");e.appendChild(f);e.appendChild(g);b.appendChild(e);a.Y=b;e=zu(c);f=Gu.W();for(g=0;g<e.length;g++){var k=Au(c,e[g]),k=new xu(k,f,d);a.O(k,!0)}return b};function Iu(a,b){var c=Hu.W();Fu.call(this,a,c,b)}C(Iu,Fu);Iu.prototype.ra=function(){return this.n().querySelector("summary").nextElementSibling};Iu.prototype.refresh=function(){for(var a=0;a<Ss(this);a++)Z(this,a).refresh()};yt(Iu,Hu);function Ju(){}C(Ju,jt);da(Ju);Ju.prototype.w=function(){return"email"};Ju.prototype.X=function(a){var b=Ju.m.X.call(this,a),c=a.u(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.s("div");e.setAttribute("title",Eu(c));b.appendChild(e);c=d.s("div","content");b.appendChild(e);b.appendChild(c);return a.Y=b};
function Ku(a,b,c,d,e,f){b?(a.textContent=c||b,a.setAttribute("name",b),b="",d&&(b+=" primary"),e&&(b+=" optout"),f&&(b+=" deleted"),a.className=b):(a.textContent="",a.className="empty")}
Ju.prototype.refresh=function(a){var b=a.n(),c=a.u();R(b,!!c);if(c){var b=a.g,d=Au(c,"email"),e=d?d.Sc():null,d=u(e);a=a.ra();if(d){for(d=0;d<e.length;d++){var c=e[d],f=a.children[d];f||(f=b.s("SPAN"),a.appendChild(f));c&&Ku(f,c.email_address,void 0,"1"==c.primary_address?!0:!1,"1"==c.opt_out?!0:!1,"1"==c.deleted?!0:!1)}for(d=a.childElementCount-1;d>=e.length;d--)a.removeChild(a.children[d])}else{e=zu(c);for(d=0;d<e.length;d++){var g=e[d],f=a.children[d];f||(f=b.s("SPAN"),a.appendChild(f));(g=Au(c,
g))&&Ku(f,wu(g))}for(d=a.childElementCount-1;d>=e.length;d--)a.removeChild(a.children[d])}}};function Lu(a,b){var c=Ju.W();Fu.call(this,a,c,b)}C(Lu,Fu);Lu.prototype.ra=function(){return Mg("content",this.n())};Lu.prototype.refresh=function(){this.i.refresh(this)};yt(Lu,Ju);function Mu(){}C(Mu,jt);da(Mu);Mu.prototype.w=function(){return"list"};Mu.prototype.X=function(a){var b=Mu.m.X.call(this,a),c=a.u(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.s("div");e.setAttribute("title",Eu(c));b.appendChild(e);var f=d.s("div","content");b.appendChild(e);b.appendChild(f);a.Y=b;for(var e=zu(c),f=Gu.W(),g=0;g<e.length;g++){var k=Au(c,e[g]),k=new xu(k,f,d);a.O(k,!0)}return b};function Nu(a,b){var c=Mu.W();Fu.call(this,a,c,b)}C(Nu,Fu);Nu.prototype.ra=function(){return Mg("content",this.n())};Nu.prototype.refresh=function(){for(var a=0;a<Ss(this);a++)Z(this,a).refresh()};yt(Nu,Mu);function Ou(){}C(Ou,jt);da(Ou);Ou.prototype.w=function(){return"name"};
Ou.prototype.X=function(a){var b=Ou.m.X.call(this,a),c=a.u(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.s("div");e.setAttribute("title",Eu(c));b.appendChild(e);var f=d.s("div","content");b.appendChild(e);b.appendChild(f);a.Y=b;zu(c);e=Gu.W();Du(c,"salutation")&&(f=Au(c,"salutation"),f=new xu(f,e,d),a.O(f,!0));Du(c,"first_name")&&a.O(new xu(Au(c,"first_name"),e,d),!0);Du(c,"last_name")&&a.O(new xu(Au(c,"last_name"),e,d),!0);return b};function Pu(a,b){var c=Ou.W();Fu.call(this,a,c,b)}C(Pu,Fu);Pu.prototype.ra=function(){return Mg("content",this.n())};Pu.prototype.refresh=function(){for(var a=0;a<Ss(this);a++)Z(this,a).refresh()};yt(Pu,Ou);function Qu(a,b){Lc.call(this);this.parent=a;this.h=b;this.i={}}C(Qu,Lc);h=Qu.prototype;h.logger=P("ydn.crm.sugar.model.Record");h.K=function(){return this.parent.K()};h.F=function(){return this.h.F()};h.value=function(a){return this.h.value(a)};function $(a){return a.h.module}function uu(a){return a.parent.i[$(a)]}
h.save=function(){var a=this.qa();return a.g?this.parent.send("put-record",{module:a.module,record:a.g}).A(function(b){var c=this,d=!Ru(this);Tq(a,b);setTimeout(function(){d?c.dispatchEvent(new Su(0,c)):c.dispatchEvent(new Tu(0,c))},10)},this):F("empty record to save")};h.J=function(){Qu.m.J.call(this);this.i=null};h.qa=function(){return this.h};
function Uu(a,b){b=b?b.g?b:null:null;var c=!1,d=!1,e=!1;b?b!==a.h&&(c=!0,(d=a.h.module!=b.module)||(e=Ru(a)?a.h.F()!=b.F():!0),a.h=b):!b&&Ru(a)&&(e=c=!0,a.h.g=null);var f=a.h.module;d?a.dispatchEvent(new Vu(f,b,a)):e?a.dispatchEvent(new Su(0,a)):c&&a.dispatchEvent(new Tu(0,a))}function Ru(a){return!!a.h.g}function Wu(a){var b=[];a=uu(a);for(var c in a.module_fields){var d=a.module_fields[c].group;-1==b.indexOf(d)&&b.push(d)}return b}function Xu(a,b){a.i[b]||(a.i[b]=new Cu(a,b));return a.i[b]}
h.toString=function(){return"ydn.crm.sugar.model.Record:"+this.h};function Yu(a,b){K.call(this,a,b)}C(Yu,K);function Su(a,b){K.call(this,"record-change",b)}C(Su,Yu);function Vu(a,b,c){K.call(this,"record-change",c);this.module=a;this.update=b}C(Vu,Yu);function Tu(a,b){K.call(this,"record-update",b)}C(Tu,Yu);function Zu(a,b,c,d){K.call(this,"gdata-change",d);this.module_name=a}C(Zu,Yu);function $u(a,b){Lc.call(this);this.g=a;for(var c={},d=0;d<b.length;d++)c[b[d].module_name]=b[d];this.i=c;this.info={};this.j=null;this.fc=new ff(this);this.h=new Sq(this.K(),"Users");av(this)}C($u,Lc);h=$u.prototype;h.isLogin=function(){return!!this.g.isLogin};function av(a){a.g&&a.g.userName&&a.send("login-user").A(function(a){a&&a.id&&(this.h.g=a)},a)}function bv(a){return dd("sugarcrm",a.K())}h.K=function(){return this.g.domain};
function cv(a,b,c){var d={};d.domain=a.K();d.baseUrl=a.g.baseUrl||null;d.wi=b;d.password=c;return a.send("login",d).A(function(a){this.g=a},a)}h.send=function(a,b){return dd("sugarcrm",this.K()).send(a,b)};function dv(a,b,c,d,e,f){b={store:b};c&&(b.index=c);d&&(d instanceof S?b.range=d.toJSON():b.key=d);b.prefix=!!e;f&&(b.limit=void 0);return bv(a).send("list",[b])}function ev(a,b,c){c={store:b,index:"name",q:c,fetchFull:!1};"Notes"==b&&(c.index="content");return bv(a).send("search",[c])}
function fv(a,b,c,d){var e=document.createElement("div");e.innerHTML=b.ff;var f=b.Yg.toISOString().replace("T"," ").replace(/\..+/,""),g=a.g?a.g.userName||"":"",k;k=a.h.value("name")||a.g.userName||null;return a.send("new-record",{module:"Emails",record:{assigned_user_id:g,assigned_user_name:k,type:"archived",date_sent:f,description:e.textContent,description_html:b.ff,name:b.Sh,from_addr:b.$g,to_addrs:b.Uh,parent_id:d||"",parent_type:c||"",mailbox_id:b.Lh||"",message_id:b.qf||"",status:"read"}})}
h.J=function(){$u.m.J.call(this);this.j=this.info=null;this.fc.oa();this.fc=null};h.toString=function(){return"ydn.crm.sugar.model.Sugar:"+this.K()};function gv(){}C(gv,jt);da(gv);gv.prototype.w=function(){return"record-panel"};
gv.prototype.X=function(a){var b=gv.m.X.call(this,a),c=a.g,d=c.s("div","record-header"),e=c.s("div","record-content");b.appendChild(d);b.appendChild(e);a.Y=b;e=c.s("a",{name:"detail"},"detail");e.href="#";d.appendChild(e);for(var d=a.u(),e=Wu(d),f=yu.W(),g=0;g<e.length;g++){var k=e[g],l,m=Xu(d,k);/address/i.test(k)?l=new Iu(m,c):"email"==k?l=new Lu(m,c):"phone"==k?l=new Nu(m,c):"name"==k?l=new Pu(m,c):l=new Fu(m,f,c);a.O(l,!0)}return b};function hv(a){return a.querySelector("a[name=detail]")};function iv(a,b,c){b=b||gv.W();Ct.call(this,null,b,c);Dt(this,!1);Ft(this);Kt(this);this.ba(a)}C(iv,Ct);h=iv.prototype;h.logger=P("ydn.crm.inj.sugar.module.RecordCtrl");h.ra=function(){return Mg("record-content",this.n())};h.L=function(){iv.m.L.call(this);var a=Ms(this),b=this.u();b&&a.listen(b,"record-change",this.refresh);a.listen(hv(this.n()),"click",this.bi,!1)};
h.bi=function(a){a.preventDefault();var b=this.n();a=Mg("record-header",b);b=Mg("record-content",b);a=hv(a);b.classList.contains("detail")?(a.textContent="detail",b.classList.remove("detail")):(a.textContent="less",b.classList.add("detail"))};
h.refresh=function(a){var b=this.u(),c=this.n();if(b.qa())for(R(c,!0),a&&"record-change"==a.type&&(a=this.n(),b=Mg("record-header",a),Mg("record-content",a),a=hv(b),a.textContent="detail",R(a,!0)),a=0;a<Ss(this);a++)b=Z(this,a),b instanceof Fu&&b.refresh();else R(c,!1)};yt(iv,gv);function jv(){}C(jv,jt);jv.prototype.logger=P("ydn.crm.inj.sugar.module.GDataPanelRenderer");jv.prototype.w=function(){return"record-panel"};
jv.prototype.X=function(a){var b=jv.m.X.call(this,a),c=a.u(),d=$(c),e=a.g,f=e.s("div","record-root");b.appendChild(f);var g=e.s("div","record-header"),k=e.s("div","record-content");f.appendChild(g);f.appendChild(k);a.Y=f;f.classList.add(d);f=e.s("span",{"class":"icon"},d.substr(0,2));k=e.s("a",{href:"#","class":"title"});k.target=c.K();var l=e.s("a",{href:"#link","class":"link"},"link"),m=e.s("span","synced");R(l,!1);R(m,!1);f=e.s("div","header",[f,k,l,m]);d=e.s("a",{"class":"import",href:"#import"},
"Add to "+d);d.style.zIndex=1E3;d=e.s("div",{"class":"import"},d);g.appendChild(d);g.appendChild(f);c=new iv(c,null,e);a.O(c,!0);return b};
jv.prototype.refresh=function(a,b){var c=a.querySelector(".import"),d=a.querySelector(".header"),e=a.querySelector(".title"),f=c.nextElementSibling,c=c.querySelector("a"),g=a.querySelector("a.link"),f=f.querySelector(".synced");b.Bf||b.og?R(a,!0):R(a,!1);R(d,!!b.title);e.textContent=b.title;b.Bf?e.href=b.Bf:e.removeAttribute("href");c.textContent=b.og;c.setAttribute("title",b.pg);(g.textContent=b.lf)?(g.setAttribute("title",b.pg),g.href="#"+b.lf):g.removeAttribute("href");R(f,b.Kh)};function kv(){Lc.call(this);this.h=this.g=null}C(kv,Lc);kv.prototype.J=function(){this.g&&(this.g.oa(),this.h=this.g=null)};function lv(a,b){a.h=b;a.g=new ff(a);a.g.listen(b,"click",a.i,!0)}kv.prototype.n=function(){return this.h};kv.prototype.i=function(a){var b=this.n(),c=this.n();(c.classList.contains("error")?mv:c.href?"n":"v")==mv?(a.preventDefault(),b.textContent="Error reported, thanks.",b.removeAttribute("href"),b.removeAttribute("title"),b.classList.remove("error")):this.dispatchEvent(a)};
var mv="e";function nv(a,b,c,d){a=a.n();a.classList.remove("error");c?a.href=c:a.removeAttribute("href");b?(a.textContent=b,R(a,!0)):R(a,!1);d?a.setAttribute("title",d):a.removeAttribute("title")}function ov(a,b,c){a=a.n();a.classList.add("error");a.href="#error";a.textContent="error";b&&b instanceof Error&&(b=b.name+": "+b.message);a.setAttribute("title","Click to report error"+(b?" for "+b:""));c&&dd().send("log-bug",c)};function pv(a,b){Ct.call(this,null,null,a);this.ba(b);this.h=new kv;this.o=new kv}C(pv,Ct);h=pv.prototype;h.logger=P("ydn.crm.inj.sugar.module.GDataPanel");h.ra=function(){return Mg("record-content",this.n())};
h.L=function(){pv.m.L.call(this);var a=this.n();lv(this.h,Ng(document,"A","import",a)[0]);lv(this.o,Ng(document,"A","link",a)[0]);Ms(this).listen(this.h,"click",this.$h,!1);Ms(this).listen(this.o,"click",this.ai,!1);a=this.u();Ms(this).listen(a,["record-change"],this.refresh);Ms(this).listen(a.parent,["gdata-change"],this.refresh)};h.refresh=function(){var a=this.u(),b=Mg("record-header",this.n());this.i.refresh(b,qv(this));b=this.ra();R(b,!!a.qa())};
function qv(a){a=a.u();var b=a.p(),c=b?null:a.j(),d=a.o(),e=a.qa(),f=$(a),g="",k=null,l=!1,m="",n="",p="",r="";d&&(m="Add to "+f,n="Add current contact "+d.g+" to SugarCRM "+f,e&&e.g?(g=Vq(e),k=sq(e.domain,e.module,e.F()),n=m="",p="export",r="Export this SugarCRM "+f+" to Gmail My Contacts address book",b&&(a.G()?(l=!0,r=p=""):(p="link",r="Link Gmail contact "+Cp(b)+" with this SugarCRM "+f+" "+e.F()))):c&&(m+=" and sync",n+=" and then synchronize between the two records.",r=p=""));return{title:g,
Bf:k,og:m,pg:n,Kh:l,lf:p,vi:r}}h.ai=function(){var a=this.u();nv(this.o,"Linking...");a.g().B(function(){nv(this.o,"Done.");this.dispatchEvent(new K("record-change"))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?xh(a):a;var c=hh(this.n());ov(this.o,a,{"class":"RecordHeader",method:"handleLinkClick",context:"link",html:c?c.outerHTML:"",error:a})},this)};
h.$h=function(){var a=this.u();nv(this.h,"Adding... to "+$(a));var b;a.j()?b=a.t().A(function(){nv(this.h,"Linking GData and SugarCRM...");return a.g()},this):(b=a.l(),b=b.A(function(){return a.g()},this));b.B(function(){nv(this.h,null);this.dispatchEvent(new K("change",this))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?xh(a):a;var b=hh(this.n());ov(this.h,a,{"class":"RecordHeader",method:"handleImportClick",context:"link",html:b?b.outerHTML:"",error:a})},this)};yt(pv,jv);function rv(a,b){Y.call(this);this.ba(a);this.parent=b||null;this.h=new kv}C(rv,Y);h=rv.prototype;h.logger=P("ydn.crm.ui.GmailCmd");h.w=function(){return"gmail-cmd-panel"};h.Q=function(){rv.m.Q.call(this);var a=this.n(),b=this.g;a.classList.add(this.w());b=b.s("a",{"class":"archive"},".");lv(this.h,b);a.appendChild(b)};function sv(a,b){nv(a.h,"View",sq(a.u().K(),"Emails",b.id));var c=a.h.n();c.setAttribute("target","gmail");c.setAttribute("title","View archived email in SugarCRM")}
function tv(a){nv(a.h,"Archive","#archive");a.h.n().setAttribute("title","Archive this email message to SugarCRM")}function uv(a){nv(a.h,".");setTimeout(function(){nv(a.h,"..");var b=vv(a.n());b.qf?(nv(a.h,"..."),a.u().send("list",[{store:"Emails",index:"message_id",key:b.qf}]).B(function(b){(b=b[0]&&b[0].result?b[0].result[0]:null)?sv(a,b):tv(a)},function(b){tv(a);throw b;})):1<b.ff.length?tv(a):ov(a.h,"gmail message cannot be parsed")},100)}
h.L=function(){rv.m.L.call(this);Ms(this).listen(this.h,"click",this.kh);uv(this)};
function vv(a){var b="",c="",d="",e="",f="",g=fh(a,"TR");if(b=g.children[0].querySelector("span[email]"))b=b.getAttribute("email");else return M(vo,"cannot sniff sender email"),null;if(a=g.children[1].querySelector("span[alt]"))a=a.getAttribute("alt"),a=new Date(a.replace(" at",""));else return M(vo,"cannot sniff date sent"),null;var k=g.nextElementSibling;if(!k||"TR"!=k.tagName)return M(vo,"to email address TR expect after title TR"),null;for(var l=k.querySelectorAll("span[email]"),k=0;k<l.length;k++)c&&
(c+=", "),c+=l[k].getAttribute("email");for(var g=fh(g,"TABLE"),m=g.parentElement.nextElementSibling,k=0;m&&10>k;k++)if(l=m.querySelector("div[style]")){d=l.parentElement.className.split(/\s/);k=d.map(function(a){return a.length});k=k.indexOf(Math.max.apply(Math,k));10<d[k].length&&(e=d[k].substring(1),"m"!=d[k].charAt(0)&&N(vo,"not start with m? "+d[k]));d=l.innerHTML;break}else m=m.nextElementSibling;g=fh(g.parentElement,"TABLE");for(k=0;g&&10>k&&"presentation"!=g.getAttribute("role");k++)g=fh(g,
"TABLE");"presentation"==g.getAttribute("role")?(g=g.querySelector("h2"))?f=g.textContent:M(vo,"email subject cannot be sniff"):M(vo,"expect a presentation role TABLE");g=wv().g.email;return{$g:b,Uh:c,Yg:a,ff:d,Lh:g,qf:e,Sh:f}}h.kh=function(a){if(ta(a.target.href)){a.preventDefault();nv(this.h,"archiving...");var b=a=void 0,c=this.parent?xv(Z(this.parent,1)):[];c[0]&&(a=c[0].module,b=c[0].id);(c=vv(this.n()))?fv(this.u(),c,a,b).B(function(a){sv(this,a)},function(a){ov(this.h,a)},this):ov(this.h,"Cannot gather email message")}};function yv(a,b){this.h=a;this.parent=b||null;this.g=[]}yv.prototype.logger=P("ydn.crm.ui.GmailCmdInjector");yv.prototype.i=function(a){for(var b=0;b<a.length;b++){var c=a[b].target;if("Reply"==c.getAttribute("data-tooltip")){var d;a:{for(d=0;d<this.g.length;d++)if(!document.body.contains(this.g[d].n())){this.g[d].$&&this.g[d].Ka();d=this.g[d];break a}d=new rv(this.h);this.g.push(d)}var e=document.createElement("span");c.parentElement.insertBefore(e,c);d.render(e)}}};function zv(){}C(zv,jt);da(zv);zv.prototype.w=function(){return"goog-menuheader"};function Av(a,b,c){Ct.call(this,a,c||zv.W(),b);It(this,1,!1);It(this,2,!1);It(this,4,!1);It(this,32,!1);this.Mb=1}C(Av,Ct);At("goog-menuheader",function(){return new Av(null)});function Bv(){this.h=[]}C(Bv,jt);da(Bv);function Cv(a,b){var c=a.h[b];if(!c){switch(b){case 0:c=a.w()+"-highlight";break;case 1:c=a.w()+"-checkbox";break;case 2:c=a.w()+"-content"}a.h[b]=c}return c}h=Bv.prototype;h.Lb=function(){return"menuitem"};h.X=function(a){var b=a.g.s("div",lt(this,a).join(" "),Dv(this,a.pa(),a.g));Ev(this,a,b,!!(a.ka&8)||!!(a.ka&16));mt(this,a,b);return b};h.wa=function(a){return a&&a.firstChild};
h.sa=function(a,b){var c=Xg(b),d=Cv(this,2);c&&ut(c,d)||b.appendChild(Dv(this,b.childNodes,a.g));ut(b,"goog-option")&&(It(a,16,!0),(c=a.n())&&Fv(a.i,a,c),Fv(this,a,b));return Bv.m.sa.call(this,a,b)};h.Ab=function(a,b){var c=this.wa(a),d=Gv(this,a)?c.firstChild:null;Bv.m.Ab.call(this,a,b);d&&!Gv(this,a)&&c.insertBefore(d,c.firstChild||null)};function Dv(a,b,c){a=Cv(a,2);return c.s("div",a,b)}function Fv(a,b,c){c&&(ht(c,"menuitemcheckbox"),Ev(a,b,c,!0))}
function Gv(a,b){var c=a.wa(b);if(c){var c=c.firstChild,d=Cv(a,1);return!!c&&A(c)&&1==c.nodeType&&ut(c,d)}return!1}function Ev(a,b,c,d){d!=Gv(a,c)&&(d?vt(c,"goog-option"):xt(c,"goog-option"),c=a.wa(c),d?(a=Cv(a,1),c.insertBefore(b.g.s("div",a),c.firstChild||null)):c.removeChild(c.firstChild))}h.Qc=function(a){switch(a){case 2:return Cv(this,0);case 16:case 8:return"goog-option-selected";default:return Bv.m.Qc.call(this,a)}};
h.Le=function(a){var b=Cv(this,0);switch(a){case "goog-option-selected":return 16;case b:return 2;default:return Bv.m.Le.call(this,a)}};h.w=function(){return"goog-menuitem"};function Hv(a,b,c,d){Ct.call(this,a,d||Bv.W(),c);this.ba(b)}C(Hv,Ct);h=Hv.prototype;h.V=function(){var a=this.u();return null!=a?a:this.ub()};h.ub=function(){var a=this.pa();return u(a)?(a=Sa(a,function(a){return A(a)&&1==a.nodeType&&(ut(a,"goog-menuitem-accel")||ut(a,"goog-menuitem-mnemonic-separator"))?"":dh(a)}).join(""),wa(a)):Hv.m.ub.call(this)};
h.ec=function(a){var b=this.getParent();if(b){var c=b.h;b.h=null;if(b=c&&y(a.clientX))b=new Gg(a.clientX,a.clientY),b=c==b?!0:c&&b?c.x==b.x&&c.y==b.y:!1;if(b)return}Hv.m.ec.call(this,a)};h.zc=function(a){return a.g==this.rf&&this.mb(a)?!0:Hv.m.zc.call(this,a)};h.dh=function(){return this.rf};At("goog-menuitem",function(){return new Hv(null)});function Iv(){}C(Iv,jt);da(Iv);Iv.prototype.X=function(a){return a.g.s("div",this.w())};Iv.prototype.sa=function(a,b){b.id&&Ls(a,b.id);if("HR"==b.tagName){var c=b;b=this.X(a);Vg(b,c);Wg(c)}else vt(b,this.w());return b};Iv.prototype.Ab=function(){};Iv.prototype.w=function(){return"goog-menuseparator"};function Jv(a,b){Ct.call(this,null,a||Iv.W(),b);It(this,1,!1);It(this,2,!1);It(this,4,!1);It(this,32,!1);this.Mb=1}C(Jv,Ct);Jv.prototype.L=function(){Jv.m.L.call(this);var a=this.n();ht(a,"separator")};At("goog-menuseparator",function(){return new Jv});function Kv(){}C(Kv,Ot);da(Kv);h=Kv.prototype;h.Md=function(){return"menu"};h.Te=function(a){return"UL"==a.tagName||Kv.m.Te.call(this,a)};h.Rc=function(a){return"HR"==a.tagName?new Jv:Kv.m.Rc.call(this,a)};h.qb=function(a,b){return Yg(a.n(),b)};h.w=function(){return"goog-menu"};h.Ve=function(a){Kv.m.Ve.call(this,a);a=a.n();it(a,"haspopup","true")};At("goog-menuseparator",function(){return new Jv});function Lv(a,b){Vt.call(this,Ut,b||Kv.W(),a);du(this,!1)}C(Lv,Vt);h=Lv.prototype;h.rd=!0;h.w=function(){return this.jb.w()};h.qb=function(a){if(this.jb.qb(this,a))return!0;for(var b=0,c=Ss(this);b<c;b++){var d=Z(this,b);if("function"==typeof d.qb&&d.qb(a))return!0}return!1};h.uc=function(){var a=[];Rs(this,function(b){a.push(b)});return a};h.bc=function(a,b,c){(b=Lv.m.bc.call(this,a,b))&&a&&this.$&&this.rd&&Wt(this).focus();a&&c&&y(c.clientX)?this.h=new Gg(c.clientX,c.clientY):this.h=null;return b};
h.bf=function(a){this.rd&&Wt(this).focus();return Lv.m.bf.call(this,a)};h.Yf=function(a){return a.isEnabled()&&a.Ea&&!!(a.ka&2)};h.Wb=function(a){for(var b=this.jb,c=Ng(this.g.g,"div",b.w()+"-content",a),d=c.length,e=0;e<d;e++)Rt(b,this,c[e]);Lv.m.Wb.call(this,a)};h.Xe=function(a){var b=Lv.m.Xe.call(this,a);b||Rs(this,function(c){!b&&c.dh&&c.rf==a.g&&(this.isEnabled()&&this.Ga(c),b=c.Ra(a))},this);return b};
h.Gb=function(a){Lv.m.Gb.call(this,a);if(a=Z(this,a)){var b=a.n();a=this.n();var c=vi(b),d=vi(a),e=Hi(a),f=c.x-d.x-e.left,c=c.y-d.y-e.top,d=a.clientHeight-b.offsetHeight,e=a.scrollLeft,g=a.scrollTop,e=e+Math.min(f,Math.max(f-(a.clientWidth-b.offsetWidth),0)),g=g+Math.min(c,Math.max(c-d,0)),b=new Gg(e,g);a.scrollLeft=b.x;a.scrollTop=b.y}};function Mv(a,b,c,d,e,f,g,k,l){var m,n;if(m=c.offsetParent){var p="HTML"==m.tagName||"BODY"==m.tagName;p&&"static"==ri(m,"position")||(n=vi(m),p||(p=(p=wi(m))&&Hb?-m.scrollLeft:!p||H&&Tb("8")||"visible"==ri(m,"overflowX")?m.scrollLeft:m.scrollWidth-m.clientWidth-m.scrollLeft,n=Hg(n,new Gg(p,m.scrollTop))))}m=n||new Gg;n=Ai(a);if(p=ui(a)){var r=new pi(p.left,p.top,p.right-p.left,p.bottom-p.top),p=Math.max(n.left,r.left),t=Math.min(n.left+n.width,r.left+r.width);if(p<=t){var x=Math.max(n.top,r.top),
r=Math.min(n.top+n.height,r.top+r.height);x<=r&&(n.left=p,n.top=x,n.width=t-p,n.height=r-x)}}p=Jg(a);x=Jg(c);if(p.g!=x.g){var t=p.g.body,x=Rg(x.g),r=new Gg(0,0),z;z=(z=Lg(t))?Rg(z):window;var G=t;do{var E;if(z==x)E=vi(G);else{var J=G;E=void 0;if(J.getBoundingClientRect)E=si(J),E=new Gg(E.left,E.top);else{E=jh(Jg(J));var Q=vi(J);E=new Gg(Q.x-E.x,Q.y-E.y)}if(Hb&&!Tb(12)){Q=void 0;H?Q="-ms-transform":Ib?Q="-webkit-transform":Gb?Q="-o-transform":Hb&&(Q="-moz-transform");var oa=void 0;Q&&(oa=ri(J,Q));
oa||(oa=ri(J,"transform"));J=oa?(J=oa.match(Ii))?new Gg(parseFloat(J[1]),parseFloat(J[2])):new Gg(0,0):new Gg(0,0);E=new Gg(E.x+J.x,E.y+J.y)}}r.x+=E.x;r.y+=E.y}while(z&&z!=x&&(G=z.frameElement)&&(z=z.parent));t=Hg(r,vi(t));H&&!ih(p)&&(t=Hg(t,jh(p)));n.left+=t.x;n.top+=t.y}a=Nv(a,b);b=new Gg(a&2?n.left+n.width:n.left,a&1?n.top+n.height:n.top);b=Hg(b,m);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var I;if(g)if(l)I=l;else if(I=ui(c))I.top-=m.y,I.right-=m.x,I.bottom-=m.y,I.left-=m.x;a:{l=b.ga();e=0;
a=Nv(c,d);d=yi(c);k=k?k.ga():d.ga();if(f||0!=a)a&2?l.x-=k.width+(f?f.right:0):f&&(l.x+=f.left),a&1?l.y-=k.height+(f?f.bottom:0):f&&(l.y+=f.top);if(g&&(I?(f=l,e=0,65==(g&65)&&(f.x<I.left||f.x>=I.right)&&(g&=-2),132==(g&132)&&(f.y<I.top||f.y>=I.bottom)&&(g&=-5),f.x<I.left&&g&1&&(f.x=I.left,e|=1),f.x<I.left&&f.x+k.width>I.right&&g&16&&(k.width=Math.max(k.width-(f.x+k.width-I.right),0),e|=4),f.x+k.width>I.right&&g&1&&(f.x=Math.max(I.right-k.width,I.left),e|=1),g&2&&(e=e|(f.x<I.left?16:0)|(f.x+k.width>
I.right?32:0)),f.y<I.top&&g&4&&(f.y=I.top,e|=2),f.y<=I.top&&f.y+k.height<I.bottom&&g&32&&(k.height=Math.max(k.height-(I.top-f.y),0),f.y=I.top,e|=8),f.y>=I.top&&f.y+k.height>I.bottom&&g&32&&(k.height=Math.max(k.height-(f.y+k.height-I.bottom),0),e|=8),f.y+k.height>I.bottom&&g&4&&(f.y=Math.max(I.bottom-k.height,I.top),e|=2),g&8&&(e=e|(f.y<I.top?64:0)|(f.y+k.height>I.bottom?128:0)),g=e):g=256,e=g,e&496)){c=e;break a}f=Hb&&(Bb||Kb)&&Tb("1.9");l instanceof Gg?(g=l.x,l=l.y):(g=l,l=void 0);c.style.left=xi(g,
f);c.style.top=xi(l,f);d==k||d&&k&&d.width==k.width&&d.height==k.height||(f=ih(Jg(Lg(c))),!H||f&&Tb("8")?(c=c.style,Hb?c.MozBoxSizing="border-box":Ib?c.WebkitBoxSizing="border-box":c.boxSizing="border-box",c.width=Math.max(k.width,0)+"px",c.height=Math.max(k.height,0)+"px"):(g=c.style,f?(H?(f=Ei(c,"paddingLeft"),d=Ei(c,"paddingRight"),l=Ei(c,"paddingTop"),I=Ei(c,"paddingBottom"),f=new oi(l,d,I,f)):(f=qi(c,"paddingLeft"),d=qi(c,"paddingRight"),l=qi(c,"paddingTop"),I=qi(c,"paddingBottom"),f=new oi(parseFloat(l),
parseFloat(d),parseFloat(I),parseFloat(f))),c=Hi(c),g.pixelWidth=k.width-c.left-f.left-f.right-c.right,g.pixelHeight=k.height-c.top-f.top-f.bottom-c.bottom):(g.pixelWidth=k.width,g.pixelHeight=k.height)));c=e}return c}function Nv(a,b){return(b&4&&wi(a)?b^2:b)&-5};function Ov(){}Ov.prototype.i=function(){};function Pv(a,b,c){this.g=a;this.h=b;this.p=c}C(Pv,Ov);Pv.prototype.i=function(a,b,c){Mv(this.g,this.h,a,b,void 0,c,this.p)};function Qv(a,b,c,d){Pv.call(this,a,b);this.j=c?5:0;this.l=d||void 0}C(Qv,Pv);Qv.prototype.o=function(){return this.j};Qv.prototype.i=function(a,b,c,d){var e=Mv(this.g,this.h,a,b,null,c,10,d,this.l);if(e&496){var f=Rv(e,this.h);b=Rv(e,b);e=Mv(this.g,f,a,b,null,c,10,d,this.l);e&496&&(f=Rv(e,f),b=Rv(e,b),Mv(this.g,f,a,b,null,c,this.j,d,this.l))}};function Rv(a,b){a&48&&(b^=2);a&192&&(b^=1);return b};function Sv(a,b,c,d){Qv.call(this,a,b,c||d);if(c||d)this.j=65|(d?32:132)}C(Sv,Qv);function Tv(){}C(Tv,jt);da(Tv);h=Tv.prototype;h.Lb=function(){return"button"};h.Va=function(a,b,c){switch(b){case 8:case 16:it(a,"pressed",c);break;default:case 64:case 1:Tv.m.Va.call(this,a,b,c)}};h.X=function(a){var b=Tv.m.X.call(this,a);this.Hb(b,a.zb());var c=a.V();c&&this.Qe(b,c);a.ka&16&&this.Va(b,16,qt(a,16));return b};h.sa=function(a,b){b=Tv.m.sa.call(this,a,b);var c=this.V(b);a.N=c;a.ee(this.zb(b));a.ka&16&&this.Va(b,16,qt(a,16));return b};h.V=ca;h.Qe=ca;h.zb=function(a){return a.title};
h.Hb=function(a,b){a&&b&&(a.title=b)};h.w=function(){return"goog-button"};function Uv(){}C(Uv,Tv);da(Uv);h=Uv.prototype;h.Lb=function(){};h.X=function(a){Dt(a,!1);Kt(a);It(a,32,!1);return a.g.s("button",{"class":lt(this,a).join(" "),disabled:!a.isEnabled(),title:a.zb()||"",value:a.V()||""},a.ub()||"")};h.Nd=function(a){return"BUTTON"==a.tagName||"INPUT"==a.tagName&&("button"==a.type||"submit"==a.type||"reset"==a.type)};h.sa=function(a,b){Dt(a,!1);Kt(a);It(a,32,!1);if(b.disabled){var c=this.Qc(1);vt(b,c)}return Uv.m.sa.call(this,a,b)};
h.Od=function(a){Ms(a).listen(a.n(),"click",a.mb)};h.Pd=ca;h.Ze=ca;h.Ye=function(a){return a.isEnabled()};h.yc=ca;h.U=function(a,b,c){Uv.m.U.call(this,a,b,c);(a=a.n())&&1==b&&(a.disabled=c)};h.V=function(a){return a.value};h.Qe=function(a,b){a&&(a.value=b)};h.Va=ca;function Vv(a,b,c){Ct.call(this,a,b||Uv.W(),c)}C(Vv,Ct);h=Vv.prototype;h.V=function(){return this.N};h.gg=function(a){this.N=a;this.i.Qe(this.n(),a)};h.zb=function(){return this.G};h.Hb=function(a){this.G=a;this.i.Hb(this.n(),a)};h.ee=function(a){this.G=a};h.J=function(){Vv.m.J.call(this);delete this.N;delete this.G};h.L=function(){Vv.m.L.call(this);if(this.ka&32){var a=this.i.cc(this);a&&Ms(this).listen(a,"keyup",this.zc)}};
h.zc=function(a){return 13==a.g&&"key"==a.type||32==a.g&&"keyup"==a.type?this.mb(a):32==a.g};At("goog-button",function(){return new Vv(null)});function Xv(){}C(Xv,Tv);da(Xv);h=Xv.prototype;h.X=function(a){var b=lt(this,a),b=a.g.s("div",{"class":"goog-inline-block "+b.join(" ")},this.Cd(a.pa(),a.g));this.Hb(b,a.zb());mt(this,a,b);return b};h.Lb=function(){return"button"};h.wa=function(a){return a&&a.firstChild.firstChild};h.Cd=function(a,b){return b.s("div","goog-inline-block "+(this.w()+"-outer-box"),b.s("div","goog-inline-block "+(this.w()+"-inner-box"),a))};h.Nd=function(a){return"DIV"==a.tagName};
h.sa=function(a,b){Yv(b,!0);Yv(b,!1);var c;a:{c=a.g.eg(b);var d=this.w()+"-outer-box";if(c&&ut(c,d)&&(c=a.g.eg(c),d=this.w()+"-inner-box",c&&ut(c,d))){c=!0;break a}c=!1}c||b.appendChild(this.Cd(b.childNodes,a.g));wt(b,["goog-inline-block",this.w()]);return Xv.m.sa.call(this,a,b)};h.w=function(){return"goog-custom-button"};
function Yv(a,b){if(a)for(var c=b?a.firstChild:a.lastChild,d;c&&c.parentNode==a;){d=b?c.nextSibling:c.previousSibling;if(3==c.nodeType){var e=c.nodeValue;if(""==xa(e))a.removeChild(c);else{c.nodeValue=b?e.replace(/^[\s\xa0]+/,""):e.replace(/[\s\xa0]+$/,"");break}}else break;c=d}};function Zv(){}C(Zv,Xv);da(Zv);Hb&&(Zv.prototype.Ab=function(a,b){var c=Zv.m.wa.call(this,a&&a.firstChild);if(c){var d;d=Jg(a).s("div","goog-inline-block "+(this.w()+"-caption"),b);var e=c.parentNode;e&&e.replaceChild(d,c)}});h=Zv.prototype;h.wa=function(a){a=Zv.m.wa.call(this,a&&a.firstChild);Hb&&a&&a.__goog_wrapper_div&&(a=a.firstChild);return a};h.Va=function(a,b,c){64!=b&&Zv.m.Va.call(this,a,b,c)};
h.sa=function(a,b){var c=Ng(document,"*","goog-menu",b)[0];if(c){R(c,!1);Lg(c).body.appendChild(c);var d=new Lv;Qs(d,c);a.Zc(d)}return Zv.m.sa.call(this,a,b)};h.Cd=function(a,b){return Zv.m.Cd.call(this,[b.s("div","goog-inline-block "+(this.w()+"-caption"),a),b.s("div","goog-inline-block "+(this.w()+"-dropdown"),"\u00a0")],b)};h.w=function(){return"goog-menu-button"};function $v(a,b,c,d){Vv.call(this,a,c||Zv.W(),d);It(this,64,!0);this.o=new Sv(null,5);b&&this.Zc(b);this.da=new hf(500);!Qh&&!Rh||Tb("533.17.9")||(this.Td=!0)}C($v,Vv);h=$v.prototype;h.Td=!1;h.L=function(){$v.m.L.call(this);this.h&&aw(this,this.h,!0);it(this.Y,"haspopup",!!this.h)};h.Ka=function(){$v.m.Ka.call(this);if(this.h){this.ma(!1);this.h.Ka();aw(this,this.h,!1);var a=this.h.n();a&&Wg(a)}};h.J=function(){$v.m.J.call(this);this.h&&(this.h.oa(),delete this.h);delete this.na;this.da.oa()};
h.Xc=function(a){$v.m.Xc.call(this,a);qt(this,4)&&(this.ma(!qt(this,64),a),this.h&&(this.h.lb=qt(this,64)))};h.ec=function(a){$v.m.ec.call(this,a);this.h&&!qt(this,4)&&(this.h.lb=!1)};h.mb=function(){Ht(this,!1);return!0};h.rh=function(a){this.h&&this.h.Da&&!this.qb(a.target)&&this.ma(!1)};h.qb=function(a){return a&&Yg(this.n(),a)||this.h&&this.h.qb(a)||!1};
h.zc=function(a){if(32==a.g){if(a.preventDefault(),"keyup"!=a.type)return!0}else if("key"!=a.type)return!1;if(this.h&&this.h.Da){var b=this.h.Ra(a);return 27==a.g?(this.ma(!1),!0):b}return 40==a.g||38==a.g||32==a.g||13==a.g?(this.ma(!0),!0):!1};h.af=function(){this.ma(!1)};h.xh=function(){qt(this,4)||this.ma(!1)};h.Qd=function(a){this.Td||this.ma(!1);$v.m.Qd.call(this,a)};
h.Zc=function(a){var b=this.h;if(a!=b&&(b&&(this.ma(!1),this.$&&aw(this,b,!1),delete this.h),this.$&&it(this.Y,"haspopup",!!a),a)){this.h=a;Ns(a,this);a.bc(!1);var c=this.Td;(a.rd=c)&&du(a,!0);this.$&&aw(this,a,!0)}return b};h.Yc=function(a,b){var c=$v.m.Yc.call(this,a,b);c&&!this.Ea&&this.ma(!1);return c};h.setEnabled=function(a){$v.m.setEnabled.call(this,a);this.isEnabled()||this.ma(!1)};
h.ma=function(a,b){$v.m.ma.call(this,a);if(this.h&&qt(this,64)==a){if(a)this.h.$||this.h.render(),this.Z=ui(this.n()),this.T=Ai(this.n()),bw(this),this.h.Gb(-1);else{Ht(this,!1);this.h.lb=!1;var c=this.n();c&&it(c,"activedescendant","");if(null!=this.p&&(this.p=void 0,c=this.h.n())){var d="",e;d instanceof Ig?(e=d.height,d=d.width):e="";c.style.width=xi(d,!0);c.style.height=xi(e,!0)}}this.h.bc(a,!1,b);this.H||(c=Ms(this),d=a?c.listen:c.xa,d.call(c,this.g.g,"mousedown",this.rh,!0),this.Td&&d.call(c,
this.h,"blur",this.xh),d.call(c,this.da,kf,this.Ph),a?jf(this.da):this.da.stop())}};function bw(a){if(a.h.$){var b=a.na||a.n(),c=a.o;a.o.g=b;b=a.h.n();a.h.Da||(b.style.visibility="hidden",R(b,!0));!a.p&&a.o.o&&a.o.j&32&&(a.p=yi(b));c.i(b,c.h^1,null,a.p);a.h.Da||(R(b,!1),b.style.visibility="visible")}}
h.Ph=function(){var a=Ai(this.n()),b=ui(this.n()),c=this.T;(c=!(c==a||c&&a&&c.left==a.left&&c.width==a.width&&c.top==a.top&&c.height==a.height))||(c=this.Z,c=!(c==b||c&&b&&c.top==b.top&&c.right==b.right&&c.bottom==b.bottom&&c.left==b.left));c&&(this.T=a,this.Z=b,bw(this))};function aw(a,b,c){var d=Ms(a);c=c?d.listen:d.xa;c.call(d,b,"action",a.af);c.call(d,b,"highlight",a.ih);c.call(d,b,"unhighlight",a.jh)}h.ih=function(a){var b=this.n();null!=a.target.n()&&it(b,"activedescendant",a.target.n().id)};
h.jh=function(){if(!Zt(this.h)){var a=this.n();it(a,"activedescendant","")}};At("goog-menu-button",function(){return new $v(null)});H||Hb&&Tb("1.9.3");function cw(a){a||Jg();md.call(this)}C(cw,md);cw.prototype.set=function(a,b){md.prototype.set.call(this,a,b);return this};function dw(a,b,c,d){return a.set(b.key,b.caption,c,d)}cw.prototype.render=function(){};cw.prototype.n=function(){return null};var ew={key:"ok",caption:"OK"},fw={key:"cancel",caption:"Cancel"},gw={key:"yes",caption:"Yes"},hw={key:"no",caption:"No"},iw={key:"save",caption:"Save"},jw={key:"continue",caption:"Continue"};
"undefined"!=typeof document&&(dw(new cw,ew,!0,!0),dw(dw(new cw,ew,!0),fw,!1,!0),dw(dw(new cw,gw,!0),hw,!1,!0),dw(dw(dw(new cw,gw),hw,!0),fw,!1,!0),dw(dw(dw(new cw,jw),iw),fw,!0,!0));function kw(){this.h=[]}C(kw,Bv);da(kw);kw.prototype.X=function(a){var b=kw.m.X.call(this,a);vt(b,"goog-submenu");lw(this,a,b);return b};kw.prototype.sa=function(a,b){b=kw.m.sa.call(this,a,b);vt(b,"goog-submenu");lw(this,a,b);var c=Ng(document,"div","goog-menu",b);if(c.length){var d=new Lv(a.g),c=c[0];R(c,!1);a.g.g.body.appendChild(c);Qs(d,c);mw(a,d)}return b};kw.prototype.Ab=function(a,b){var c=this.wa(a),d=c&&c.lastChild;kw.m.Ab.call(this,a,b);d&&c.lastChild!=d&&ut(d,"goog-submenu-arrow")&&c.appendChild(d)};
kw.prototype.Od=function(a){kw.m.Od.call(this,a);var b=a.ra(),c=Ng(a.g.g,"span","goog-submenu-arrow",b)[0];nw(a,c);c!=b.lastChild&&b.appendChild(c);a=a.n();it(a,"haspopup","true")};function lw(a,b,c){var d=b.g.s("span");d.className="goog-submenu-arrow";nw(b,d);a.wa(c).appendChild(d)}function nw(a,b){Ts(a)?(vt(b,"goog-submenu-arrow-rtl"),Zg(b,"\u25c4")):(xt(b,"goog-submenu-arrow-rtl"),Zg(b,"\u25ba"))};function ow(a,b,c,d){Hv.call(this,a,b,c,d||kw.W())}C(ow,Hv);h=ow.prototype;h.Oc=null;h.zf=null;h.mg=!1;h.ua=null;h.Ed=!1;h.L=function(){ow.m.L.call(this);Ms(this).listen(this.getParent(),"hide",this.vg);this.ua&&pw(this,this.ua,!0)};h.Ka=function(){Ms(this).xa(this.getParent(),"hide",this.vg);this.ua&&(pw(this,this.ua,!1),this.Ed||(this.ua.Ka(),Wg(this.ua.n())));ow.m.Ka.call(this)};h.J=function(){this.ua&&!this.Ed&&this.ua.oa();this.ua=null;ow.m.J.call(this)};
h.Ga=function(a,b){ow.m.Ga.call(this,a);b&&(qw(this).lb=!0);a||(this.Oc&&q.clearTimeout(this.Oc),this.Oc=lf(this.rb,218,this))};h.yf=function(){var a=this.getParent();a&&Zt(a)==this&&(rw(this,!0),sw(this))};h.rb=function(){var a=this.ua;a&&a.getParent()==this&&(rw(this,!1),Rs(a,function(a){"function"==typeof a.rb&&a.rb()}))};function tw(a){a.Oc&&q.clearTimeout(a.Oc);a.zf&&q.clearTimeout(a.zf)}h.Yc=function(a,b){var c=ow.m.Yc.call(this,a,b);c&&!this.Ea&&this.rb();return c};
function sw(a){Rs(a.getParent(),function(a){a!=this&&"function"==typeof a.rb&&(a.rb(),tw(a))},a)}h.Ra=function(a){var b=a.g,c=Ts(this)?37:39,d=Ts(this)?39:37;if(!this.mg){if(!this.isEnabled()||b!=c&&b!=this.rf)return!1;this.yf();$t(qw(this));tw(this)}else if(!qw(this).Ra(a))if(b==d)this.rb();else return!1;a.preventDefault();return!0};h.Mh=function(){this.ua.getParent()==this&&(tw(this),this.Dc.Ga(this),sw(this))};h.vg=function(a){a.target==this.Dc&&(this.rb(),tw(this))};
h.ad=function(a){this.isEnabled()&&(tw(this),this.zf=lf(this.yf,218,this));ow.m.ad.call(this,a)};h.mb=function(a){tw(this);if(this.ka&8)return ow.m.mb.call(this,a);this.yf();return!0};
function rw(a,b){a.dispatchEvent(Ks(64,b));var c=qw(a);if(b!=c.Da){b&&(c.$||c.render(),c.Gb(-1));a.mg=b;var d=a.n();b?vt(d,"goog-submenu-open"):xt(d,"goog-submenu-open");c.bc(b);if(b){var c=new Qv(a.n(),6,!1),d=qw(a),e=d.n();d.Da||(e.style.visibility="hidden",R(e,!0));c.i(e,4);d.Da||(R(e,!1),e.style.visibility="visible")}}}function pw(a,b,c){var d=Ms(a);(c?d.listen:d.xa).call(d,b,"enter",a.Mh)}h.uc=function(){return qw(this).uc()};
function qw(a){a.ua?a.Ed&&a.ua.getParent()!=a&&Ns(a.ua,a):mw(a,new Lv(a.g));a.ua.n()||a.ua.Q();return a.ua}function mw(a,b){var c=a.ua;b!=c&&(c&&(a.rb(),a.$&&pw(a,c,!1)),a.ua=b,a.Ed=!1,b&&(Ns(b,a),b.bc(!1,!0),b.rd=!1,du(b,!1),a.$&&pw(a,b,!0)))}h.qb=function(a){return qw(this).qb(a)};At("goog-submenu",function(){return new ow(null)});function uw(a){this.i=a;this.h=this.g=null}uw.prototype.logger=P("ydn.crm.ui.gmail.Template");uw.prototype.u=function(){return this.i};function vw(a){if("FORM"!=a.tagName)return null;for(a=a.nextElementSibling;a&&"TABLE"!=a.tagName;)a=a.nextElementSibling;return a}function ww(a){a=fh(a,"table");a=fh(a.parentElement,"table");return fh(a.parentElement,"table").querySelector("form")}
function xw(a,b){if(!a)return null;var c=b||vo,d=ww(a);if(!d)return M(c,"Gmail header FORM not found"),null;d=d.querySelector("textarea[name=to]");if(!d)return M(c,"To textarea not found."),null;d=d.parentElement.querySelector("span[email]");return d?d?d.getAttribute("email"):null:(M(c,"email span not found in TO element"),null)}
uw.prototype.j=function(a){if(a.target instanceof Hv){var b=a.target.u(),c=xw(this.g,this.logger),d=!1;!c&&this.h&&(c=this.h.g,d=!!c);c?yw(this,b.id,c).B(function(a){var f=ww(this.g),g=f.querySelector('input[name="subjectbox"]'),k=vw(f).querySelector('div[aria-label="Message Body"]');d&&(f.querySelector('textarea[name="to"]').value=c);g.value=b.name;f=document.createElement("span");f.innerHTML=a;k.appendChild(f)},function(a){throw a;},this):window.alert("A valid recipient email address is required in To input field.")}};
function zw(a,b){var c=new Kg(b.ownerDocument);if(a.g)a.g.parentElement!=b&&(a.g.parentElement&&a.g.parentElement.removeChild(a.g),c=c.s("span"),c.className="crm-template inj",c.appendChild(a.g),b.insertBefore(c,b.firstElementChild));else{a.g=b;var d=new Lv(c),e=new $v("{ t }",d,null,c);e.Hb("Insert SugarCRM template");Aw(a,function(a){for(var b=[],c=0;c<a.length;c++)-1==b.indexOf(a[c].type)&&b.push(a[c].type);for(c=0;c<b.length;c++)if(b[c]){for(var e=new ow(b[c],null,d.g),m=0;m<a.length;m++)if(a[m].type==
b[c]){var n=new Hv(a[m].name,a[m]);qw(e).O(n,!0)}d.O(e,!0)}for(m=0;m<a.length;m++)a[m].type||(n=new Hv(a[m].name,a[m]),d.O(n,!0))},a);c=c.s("span");c.className="crm-template inj";b.insertBefore(c,b.firstElementChild);e.render(c);yc(d,"action",a.j,!0,a)}}
function Aw(a,b,c){dv(a.u(),"EmailTemplates",void 0,void 0,void 0,200).B(function(a){a=a[0];for(var e=[],f=0;f<a.result.length;f++){var g=a.result[f],k=g.body_html;e.push({id:g.id,name:g.name,type:g.type||"",si:0<=k.indexOf("$contact_name")||0<=k.indexOf("$contact_account_name")})}b.call(c,e)},function(a){throw a;},a)}
function yw(a,b,c){var d=a.u();if(w(c))return d.send("list",[{store:"Contacts",index:"ydn$emails",key:c,limit:1},{store:"Leads",index:"ydn$emails",key:c,limit:1}]).A(function(a){var c=null;a[0].result[0]?c=new Sq(d.K(),"Contacts",a[0].result[0]):a[1].result[0]&&(c=new Sq(d.K(),"Leads",a[1].result[0]));a=c?new Qu(d,c):null;return yw(this,b,a)},a);if(!w(b)||16>b.length)throw Error("valid template id required, but "+b+" found.");return d.send("get",{module:"EmailTemplates",id:b}).A(function(a){a=a.body_html;
if(w(a)){var d=this.u().h;if(d&&d.g){var g;g=this.u().i.Users;for(var k in g.module_fields)g=d.value(k),w(g)&&(a=a.replace(RegExp("\\$user_"+k,"g"),g))}else M(this.logger,"Login user info not available");if(c&&Ru(c))for(k in d=uu(c),d.module_fields)g=c.value(k),w(g)&&(a=a.replace(RegExp("\\$contact_"+k,"g"),g));return a}throw Error("Template record: "+b+" does not have body_html");},a)};function Bw(a,b){var c;c=a.replace("@","%40");c="http://www.google.com/m8/feeds/contacts/"+c+"/base/"+ ++Cw;b.id={$t:c};Lr.call(this,b)}C(Bw,Rr);var Cw=0;function Dw(a,b,c){Qu.call(this,b,new Sq(b.K(),c));this.g=null;this.j=a}C(Dw,Qu);Dw.prototype.logger=P("ydn.crm.sugar.model.GData");
function Ew(a,b,c,d,e){if(b){var f=[{store:$(a),index:"id",key:b}];bv(a.parent).send("list",f).B(function(a){(a=a[0])&&a.result[0]?Uu(this,new Sq(this.K(),$(this),a.result[0])):(M(this.logger,"record id "+b+" not in "+$(this)),Ew(this,null,c,d,e))},function(a){throw a;},a)}else f=[{store:$(a),index:"ydn$emails",key:c}],bv(a.parent).send("list",f).A(function(a){(a=a[0])&&a.result[0]&&Uu(this,new Sq(this.K(),$(this),a.result[0]))},a)}
Dw.prototype.update=function(a,b,c){Uu(this,null);if(a){var d={gd$email:[{address:a}]};b&&(d.gd$name={gd$fullName:{$t:b}});c&&(d.gd$phoneNumber=[{$t:c}]);this.g=new Bw(this.j,d);dd().send("gdata-list-contact-by-email",a).B(function(d){var f=null;d&&1<=d.length&&(this.g=d.map(function(a){return new Rr(a)})[0],d=rr(this.g,sr,this.K(),$(this)))&&(f=d.fd);Ew(this,f,a,b,c);this.dispatchEvent(new Zu($(this),0,0,this))},function(d){Ew(this,null,a,b,c);throw d;},this)}else this.g=null,this.dispatchEvent(new Zu($(this),
0,0,this))};function Fw(a){var b={module:$(a),kind:a.g.Gf(),"gdata-id":a.g.F()};N(a.logger,"sending import-gdata "+JSON.stringify(b));return bv(a.parent).send("import-gdata",b).A(function(a){a=new Sq(this.K(),$(this),a);N(this.logger,a+" created.");Uu(this,a)},a)}
function Gw(a){a.qa();var b=kc(a.g.data,"gd$name","gd$fullName","$t")||"",c={email1:Sr(a.g)[0],full_name:b};b&&0<b.length&&(b=b.split(/\s/),b[0]&&(c.first_name=b[0]),b[1]&&(c.last_name=b[b.length-1]));b=Tr(a.g);b[0]&&(c.phone_work=b[0]);c={module:$(a),record:c};N(a.logger,"sending put-record "+JSON.stringify(c));return bv(a.parent).send("put-record",c).A(function(a){a=new Sq(this.K(),$(this),a);N(this.logger,a+" created.");Uu(this,a)},a)}
function Hw(a){var b=a.qa();if(!b)return F("no Record to link.");b.F();var c=a.g;if(!c)return F("Not contact data to link.");var d=rr(c,sr,a.K(),$(a),b.F());if(d)return F("Contact "+Cp(c)+" already link to "+d.fd);b=new Or(sr,a.K(),$(a),b.F(),+new Date(c.data.updated.$t),Uq(b));c={kind:c.Gf(),"gdata-id":c.F(),"external-id":{label:b.module+"#"+b.h+"-"+b.g,value:b.V()}};return bv(a.parent).send("link",c).A(function(a){this.g=new Rr(a);this.dispatchEvent(new Zu($(this),0,0,this))},a)}
Dw.prototype.save=function(){var a=this.qa(),b=bv(this.parent).send("put-record",a);b.A(function(b){a.g=b},this);return b};Dw.prototype.toString=function(){var a="";this.h&&(a+=":"+this.h);var b=this.g;b&&(a+=":"+b);return"RecordModel:"+$(this)+a};function Iw(){this.i=0}var Jw=new Iw;Iw.prototype.render=function(){};Iw.prototype.h=function(){return++this.i};Iw.prototype.ca=function(){return this.i};function Kw(){this.i=0;this.g=document.createElement("div");var a=document.createElement("div");a.className="statusbar";this.g.className="message";a.appendChild(this.g)}C(Kw,Iw);Kw.prototype.render=function(a){a.appendChild(this.g.parentElement)};
Kw.prototype.h=function(a,b){var c=Kw.m.h.call(this,a,b);this.g.g=a;b?this.g.classList.add("error"):this.g.classList.remove("error");return c};function Lw(a,b){Y.call(this,b);this.ba(a)}C(Lw,Y);h=Lw.prototype;h.L=function(){Lw.m.L.call(this);this.n();var a=this.u(),b=Ms(this);b.listen(a,"record-change",this.Df);b.listen(a,"record-update",this.Df);this.Df()};h.Df=function(){this.refresh()};h.w=function(){return"record-body"};h.Q=function(){Lw.m.Q.call(this);var a=this.n();a.classList.add(this.w());a.classList.add("view")};h.Gg=function(){return null};h.refresh=function(){for(var a=0;a<Ss(this);a++)Z(this,a).refresh()};function Mw(a,b){Y.call(this,b);this.ba(a)}C(Mw,Y);Mw.prototype.w=function(){return"field"};Mw.prototype.Q=function(){Mw.m.Q.call(this);var a=this.n(),b=this.g,c=this.u();a.classList.add(this.w());a.classList.add(c.g);b=b.s("INPUT",{type:"text",name:c.g});a.appendChild(b)};Mw.prototype.refresh=function(){var a=this.u();this.n().querySelector("input").value=wu(a)};function Nw(a,b){Y.call(this,b);this.ba(a)}C(Nw,Y);Nw.prototype.w=function(){return"field"};Nw.prototype.Q=function(){Nw.m.Q.call(this);var a=this.n(),b=this.g,c=this.u();a.classList.add(this.w());a.classList.add(c.g);b=b.s("TEXTAREA",{name:c.g});a.appendChild(b)};Nw.prototype.refresh=function(){var a=this.u();this.n().querySelector("textarea").value=wu(a)};function Ow(a,b){Lw.call(this,a,b)}C(Ow,Lw);Ow.prototype.Q=function(){Ow.m.Q.call(this);this.n();for(var a=this.g,b=this.u(),c=Wu(b),d=yu.W(),e=0;e<c.length;e++){var f=c[e],g,k=Xu(b,f);/address/i.test(f)?g=new Iu(k,a):"email"==f?g=new Lu(k,a):"phone"==f?g=new Nu(k,a):"name"==f?g=new Pu(k,a):g=new Fu(k,d,a);this.O(g,!0)}};function Pw(){}da(Pw);function Qw(a){return a.querySelector(".record-footer")}function Rw(a){return a.querySelector(".record-footer button[name=save]")}function Sw(a){var b;b=a.n().querySelector(".record-footer div.message");b.textContent="";b.classList.remove("error");a=Rw(a.n());a.textContent="Save";a.removeAttribute("disabled")};function Tw(){}da(Tw);Tw.prototype.refresh=function(a){var b=a.u();a=a.n().querySelector(".record-header .title");if(Ru(b)){a.textContent=b.h.g?Vq(b.h):"";var c;c=b.qa();c=sq(c.domain,c.module,c.F());a.href=c;a.target=b.K()}else a.textContent="",a.href=""};function Uw(a){return a.querySelector(".record-header")};function Vw(a,b){Lw.call(this,a,b)}C(Vw,Lw);Vw.prototype.Q=function(){Vw.m.Q.call(this);var a=this.g,b=this.u(),c=Xu(b,"name"),b=Xu(b,""),c=Au(c,"name"),b=Au(b,"description");this.O(new Mw(c,a),!0);this.O(new Nw(b,a),!0)};
Vw.prototype.Gg=function(a){var b=Z(this,0).n().querySelector("input").value,c=Z(this,1).n().querySelector("textarea").value;if(!b)return Jw.h("Note title required.",!0),null;b={name:b,description:c};if(a=a.o)a=a.u(),b.parent_type=$(a),b.parent_id=a.F(),b.parent_name=a.value("name");return b};function Ww(a,b){Y.call(this,b);this.ba(a)}C(Ww,Y);Ww.prototype.w=function(){return"secondary"};Ww.prototype.Q=function(){Ww.m.Q.call(this);this.n().classList.add(this.w())};Ww.prototype.L=function(){Ww.m.L.call(this);var a=this.u();if(0<=oq.indexOf($(a))){var b=Ms(this);b.listen(a,"record-change",this.h);b.listen(a,"record-change",this.h);this.h()}};
Ww.prototype.h=function(){for(;this.Ca&&0!=this.Ca.length;){var a=Z(this,0);this.xc(a,!0);a.oa()}a=this.u();if(Ru(a)){var b=a.qa(),c=a.parent,a=[{store:"Notes",index:"parent",reverse:!0,keyRange:mj([$(a),b.F()])}];c.send("list",a).B(function(a){for(var b=0;b<a.length;b++){var f=a[b];f.result&&0<f.result.length&&(f=new Qu(this.u().parent,new Sq(c.K(),"Notes",f.result[0])),f=new Xw(f,this.g),this.O(f,!0))}},function(a){throw a;},this)}};function Xw(a,b,c){Y.call(this,b);this.ba(a);this.o=c||null;this.i=Tw.W();this.h=Yw(this);this.j=new Ww(a,b);Pw.W()}C(Xw,Y);h=Xw.prototype;h.logger=P("ydn.crm.ui.sugar.record.Record");h.w=function(){return"record-panel"};function Yw(a){var b=a.u();a=a.g;return"Notes"==$(b)?new Vw(b,a):new Ow(b,a)}h.ra=function(){return this.n().querySelector(".content")};
h.Q=function(){Xw.m.Q.call(this);var a=this.n(),b=this.g;a.classList.add(this.w());var c=b.s("div","record-header"),d=b.s("div","content");a.appendChild(c);a.appendChild(d);var c=Uw(this.n()),d=this.g,e=this.u(),f=d.s("div","record-header");c.appendChild(f);var e=$(e),g=d.s("a","title"),k=d.s("span","icon",e.substr(0,2));f.appendChild(k);f.appendChild(g);f.classList.add(e);e=d.s("a",{href:"#link","class":"link"},"link");g=d.s("span","synced");R(e,!1);R(g,!1);e=d.s("div","toolbar");e.appendChild(d.s("a",
{name:"Notes","class":"new-item",href:"#new-Notes"},"Add Note"));e.appendChild(d.s("a",{name:"edit",href:"#edit"},"edit"));e.appendChild(d.s("a",{name:"detail",href:"#detail"},"detail"));c.appendChild(f);c.appendChild(e);this.O(this.h,!0);this.O(this.j,!0);b=b.s("div","record-footer");a.appendChild(b);c=this.g;a=Qw(this.n());b=c.s("button",{type:"button",name:"save"},"Save");c=c.s("div","message");a.appendChild(b);a.appendChild(c)};
h.L=function(){Xw.m.L.call(this);var a=Ms(this),b=this.u();a.listen(b,"click",this.kg,!1);a.listen(Rw(this.n()),"click",this.Bh,!0);a.listen(b,"record-change",this.kg);a.listen(b,"gdata-change",this.lg);a.listen(b,"record-change",this.lg);a.listen(b,"record-update",this.Ah);a.listen(this.n(),"click",this.oh,!1);a.listen(this.n(),"dblclick",this.qh,!1);Zw(this)};
h.oh=function(a){this.n().classList.add("activated");var b=a.target.getAttribute("name");a.target.classList.contains("new-item")?(a.preventDefault(),a=this.u().parent,b=new Qu(a,new Sq(a.K(),mq[mq.indexOf(b)])),b=new Xw(b,this.g,this),this.j.O(b,!0),$w(b,!0)):"detail"==b?(a.preventDefault(),a=this.n(),b=this.h.n(),a=a.querySelector("a[name=detail]"),"detail"!=a.textContent?(a.textContent="detail",b.classList.remove("detail")):(a.textContent="less",b.classList.add("detail"))):"edit"==b&&(a.preventDefault(),
b=this.h.n().classList.contains("edit"),$w(this,!b))};h.qh=function(){};function $w(a,b){var c=a.h;b?(c.n().classList.add("edit"),c.n().classList.remove("view")):(c.n().classList.remove("edit"),c.n().classList.add("view"));c=Qw(a.n());b?(c.classList.add("edit"),c.classList.remove("view")):(c.classList.remove("edit"),c.classList.add("view"));b?a.n().classList.remove("empty"):Ru(a.u())&&a.n().classList.add("empty")}
h.Bh=function(a){var b=a.target;if(a=this.h.Gg(this)){b.textContent="saving...";b.setAttribute("disabled","1");var c=this.u();Tq(c.qa(),a);c.save().B(function(){Jw.h("saved",void 0);$w(this,!1);b.textContent="Save";b.removeAttribute("disabled")},function(a){b.textContent="Save";Jw.h("error saving "+a.message,!0)},this)}};h.kg=function(){Zw(this);this.xc(this.h,!0);this.h.oa();this.h=Yw(this);this.pd(this.h,0,!0)};h.lg=function(){Zw(this)};h.Ah=function(){this.refresh()};
function Zw(a){var b=a.u();a.n().classList.remove("activated");var c=a.i,d=a.n().querySelector("a[name=detail]");d.textContent="detail";R(d,!0);for(var d=0<=pq.indexOf($(a.u())),e=a.n().querySelectorAll(".new-item"),f=e.length-1;0<=f;f--)R(e[f],d);d=a.u();e=$(d);f=Uw(a.n());Mg("icon",f).textContent=e.substring(0,2);e=f.querySelector("a[name=edit]");R(e,0<=rq.indexOf($(d)));c.refresh(a);Sw(a);Ru(b)?a.n().classList.remove("empty"):a.n().classList.add("empty")}
h.refresh=function(){Ru(this.u())?this.n().classList.remove("empty"):this.n().classList.add("empty");this.i.refresh(this);Sw(this)};h.toString=function(){return"ydn.crm.ui.sugar.record.Record:"+this.u()};function ax(a,b){Y.call(this,b);this.ba(a);this.h=new kv;this.i=new kv}C(ax,Y);h=ax.prototype;h.logger=P("ydn.crm.ui.GDataPanel");h.ra=function(){return Mg("record-content",this.n())};
h.Q=function(){ax.m.Q.call(this);var a=this.n(),b=this.u(),c=$(b),d=this.g,e=d.s("div","record-root");a.appendChild(e);var a=d.s("div","record-header"),f=d.s("div","record-content");e.appendChild(a);e.appendChild(f);e.classList.add(c);d.s("span",{"class":"icon"},c.substr(0,2));c=d.s("a",{"class":"import",href:"#import"},"Add to "+c);c.style.zIndex=1E3;c=d.s("div",{"class":"import"},c);a.appendChild(c);b=new Xw(b,d);this.O(b,!0)};
h.L=function(){ax.m.L.call(this);var a=this.n(),b=Ms(this),c=this.u();lv(this.h,Ng(document,"A","import",a)[0]);b.listen(this.h,"click",this.ci,!1);b.listen(this.i,"click",this.di,!1);b.listen(c,["gdata-change"],this.jg);b.listen(c,"record-change",this.jg)};
h.jg=function(){var a,b;b=this.u();var c=Mg("record-header",this.n());if(Ru(b))R(c,!1);else{R(c,!0);a=this.u();var d=a.g,e=a.qa(),f=$(a),g="Add to "+f;b="Add current contact "+(a.g?Sr(a.g)[0]:null)+" to SugarCRM "+f;if(Ru(a)){if(b=g="",d&&(f=a.g,!Ru(a)||a.g instanceof Bw||!rr(f,sr,a.K(),$(a),a.F())))Cp(d),e.F()}else!a.g||a.g instanceof Bw||(g="Import to "+f,b="Import existing gmail contact "+(a.g?Sr(a.g)[0]:null)+" to SugarCRM "+f);a=g;c.querySelector(".import").querySelector("a");a?(R(c,!0),nv(this.h,
a,"#import",b)):R(c,!1)}};h.di=function(){var a=this.u();nv(this.i,"Linking...");Hw(a).B(function(){nv(this.i,"Done.");this.dispatchEvent(new K("record-change"))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?xh(a):a;var c=hh(this.n());ov(this.i,a,{"class":"RecordHeader",method:"handleLinkClick",context:"link",html:c?c.outerHTML:"",error:a})},this)};
h.ci=function(){var a=this.u();nv(this.h,"Adding... to "+$(a));var b;a.g instanceof Bw?b=Gw(a):(b=Fw(a),b=b.A(function(){nv(this.h,"Linking GData and SugarCRM...");return Hw(a)},this));b.B(function(){nv(this.h,null);this.dispatchEvent(new K("change",this))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?xh(a):a;var b=hh(this.n());ov(this.h,a,{"class":"RecordHeader",method:"handleImportClick",context:"link",html:b?b.outerHTML:"",error:a})},this)};function bx(a,b,c){Y.call(this,c);this.ba(b);this.i=a;this.h=[]}C(bx,Y);bx.prototype.w=function(){return"feed-panel"};bx.prototype.ra=function(){return Mg("feed-body",this.n())};function xv(a){for(var b=[],c=0;c<Ss(a);c++){var d=Z(a,c).u();Ru(d)&&b.push({module:$(d),id:d.F()})}return b}
bx.prototype.Q=function(){bx.m.Q.call(this);var a=this.n(),b=this.g,c=b.s("div","feed-header"),d=b.s("div","feed-body");a.appendChild(c);a.appendChild(d);a=b.s("div","feed-title");c.appendChild(a);for(c=0;c<qq.length;c++){a:{a=qq[c];for(b=0;b<this.h.length;b++)if(d=this.h[b],$(d.u())==a){$a(this.h,b);a=d;break a}a=new Dw(this.i,this.u(),a);a=new ax(a,this.g)}this.O(a,!0)}R(this.n(),!1)};bx.prototype.update=function(a,b,c){R(this.n(),!!a);for(var d=0;d<Ss(this);d++)Z(this,d).u().update(a,b,c)};function cx(){}C(cx,Iv);da(cx);cx.prototype.X=function(a){return a.g.s("div",this.w()+" goog-inline-block","\u00a0")};cx.prototype.sa=function(a,b){b=cx.m.sa.call(this,a,b);vt(b,"goog-inline-block");return b};cx.prototype.w=function(){return"goog-toolbar-separator"};function dx(){}C(dx,Ot);da(dx);dx.prototype.Md=function(){return"toolbar"};dx.prototype.Rc=function(a){return"HR"==a.tagName?new Jv(cx.W()):dx.m.Rc.call(this,a)};dx.prototype.w=function(){return"goog-toolbar"};dx.prototype.dg=function(){return Tt};function ex(a,b,c){Vt.call(this,b,a||dx.W(),c)}C(ex,Vt);function fx(a){Lc.call(this);this.g=[];gx(this,a)}C(fx,Lc);fx.prototype.h=null;function gx(a,b){b&&(Qa(b,function(a){hx(a,!1)},a),cb(a.g,b))}fx.prototype.uc=function(){return bb(this.g)};function ix(a){var b=a.h;return b?Pa(a.g,b):-1}fx.prototype.clear=function(){Ya(this.g);this.h=null};fx.prototype.J=function(){fx.m.J.call(this);delete this.g;this.h=null};function hx(a,b){a&&"function"==typeof a.Gc&&a.Gc(b)};function jx(a,b,c,d){$v.call(this,a,b,c,d);this.t=this.pa()}C(jx,$v);h=jx.prototype;h.la=null;h.L=function(){jx.m.L.call(this);kx(this);lx(this)};h.Wb=function(a){jx.m.Wb.call(this,a);(a=this.ub())?(this.t=a,kx(this)):this.la&&mx(this,this.la.g[0]||null)};h.J=function(){jx.m.J.call(this);this.la&&(this.la.oa(),this.la=null);this.t=null};h.af=function(a){mx(this,a.target);jx.m.af.call(this,a);a.Wc();this.dispatchEvent("action")};h.Ch=function(){var a=nx(this);jx.m.gg.call(this,a&&a.V());kx(this)};
h.Zc=function(a){var b=jx.m.Zc.call(this,a);a!=b&&(this.la&&this.la.clear(),a&&(this.la?Rs(a,function(a){ox(a);var b=this.la,e=b.g.length;a&&(hx(a,!1),db(b.g,e,0,a))},this):px(this,a)));return b};function mx(a,b){if(a.la){var c=nx(a),d=a.la;b!=d.h&&(hx(d.h,!1),d.h=b,hx(b,!0));d.dispatchEvent("select");b!=c&&a.dispatchEvent("change")}}h.gg=function(a){if(null!=a&&this.la)for(var b=0,c;c=this.la.g[b]||null;b++)if(c&&"function"==typeof c.V&&c.V()==a){mx(this,c);return}mx(this,null)};
function nx(a){return a.la?a.la.h:null}function px(a,b){a.la=new fx;b&&Rs(b,function(a){ox(a);var b=this.la,e=b.g.length;a&&(hx(a,!1),db(b.g,e,0,a))},a);lx(a)}function lx(a){a.la&&Ms(a).listen(a.la,"select",a.Ch)}function kx(a){var b=nx(a),b=b?b.ub():a.t;a.i.Ab(a.n(),b);a.Bb=b}function ox(a){a.$e=a instanceof Hv?"option":"separator"}h.ma=function(a,b){jx.m.ma.call(this,a,b);qt(this,64)&&(this.h||this.Zc(new Lv(this.g)),(this.h||null).Gb(this.la?ix(this.la):-1))};At("goog-select",function(){return new jx(null)});function qx(){}C(qx,Zv);da(qx);qx.prototype.w=function(){return"goog-toolbar-menu-button"};function rx(a,b,c,d){jx.call(this,a,b,c||qx.W(),d)}C(rx,jx);At("goog-toolbar-select",function(){return new rx(null)});function sx(){}C(sx,jt);da(sx);h=sx.prototype;h.Lb=function(){};function tx(a,b,c,d){var e=d.s("div",a.w()+"-inner-box"),f=d.s("div",a.w()+"-clear","\u00d7");a=d.s("div",a.w()+"-outer-box",[e,f]);d.appendChild(b,a);d.appendChild(e,c)}h.sa=function(a,b){var c=a.g,d=b;b=c.s("div","goog-inline-block");c.Jh(b,d);tx(this,b,d,c);sx.m.sa.call(this,a,b);a.Bb=d.value;return b};
h.X=function(a){var b=a.g,c=b.s("div","goog-inline-block "+lt(this,a).join(" "));a=b.s("input",{type:"text",value:a.pa()||"",disabled:!a.isEnabled()});tx(this,c,a,b);return c};h.Nd=function(a){return"INPUT"==a.tagName&&(!a.type||"TEXT"==a.type.toUpperCase())};h.wa=function(a){if(a)a:{a=a.getElementsByTagName("input");for(var b=0;b<a.length;++b){var c=a[b];if(!c.type||"TEXT"==c.type.toUpperCase()){a=c;break a}}a=null}else a=null;return a};h.cc=function(a){return this.wa(a.n())};h.Ze=ca;h.Ye=function(a){return a.isEnabled()};
h.yc=ca;h.U=function(a,b,c){sx.m.U.call(this,a,b,c);1==b&&(a=this.wa(a.n()))&&(a.disabled=c)};h.Va=ca;h.Ab=function(a,b){var c=this.wa(a);c&&(c.value=b)};h.pa=function(a){return(a=this.wa(a))?a.value:null};h.w=function(){return"wgui-textinput"};function ux(a,b,c){Ct.call(this,a,b||sx.W(),c);Dt(this,!1);Ft(this);Kt(this);It(this,32,!1);a||(this.Bb="")}C(ux,Ct);h=ux.prototype;h.L=function(){ux.m.L.call(this);var a=this.i.cc(this);if(a){var b=this.j||(this.j=new Zs);$s(b,a);Ms(this).listen(b,"key",this.Ra)}(a=Mg(this.i.w()+"-clear",this.n()))&&Ms(this).listen(a,"click",this.nh)};h.nh=function(a){a.preventDefault();this.i.Ab(this.n(),"");this.Bb="";this.dispatchEvent(new K("action",this))};
h.pa=function(){return this.n()?this.i.pa(this.n()):null};h.V=function(){return this.pa()};h.ub=function(){return this.pa()||""};function vx(a,b){this.result=b;Qu.call(this,a,new Sq(a.K(),b.storeName,b.record));this.h.g||wx(this)}C(vx,Qu);function wx(a){a.parent.send("list",[{store:a.result.storeName,index:"id",key:a.result.primaryKey}]).A(function(a){a=a[0].result;a[0]&&Uu(this,new Sq(this.parent.K(),mq[mq.indexOf(this.result.storeName)],a[0]))},a)}function xx(a,b){b&&(a.result=b,b.record?Uu(a,new Sq(a.K(),b.storeName,b.record)):b.storeName&&s(b.primaryKey)&&wx(a))}
vx.prototype.clear=function(){this.Oa()||(Uu(this,null),this.result=null)};vx.prototype.toString=function(){return"ydn.crm.sugar.model.ResultRecord:"+this.h};vx.prototype.Oa=function(){return!Ru(this)&&!this.result};function yx(a,b){Y.call(this,a);this.ba(b);this.i=new Y(a);this.h=null;this.j=[];this.o=0}C(yx,Y);h=yx.prototype;h.w=function(){return"search-panel"};
h.Q=function(){yx.m.Q.call(this);var a=this.g,b=this.n();b.classList.add(this.w());var c=a.s("div","header");b.appendChild(c);this.h=new ex(null,null,a);for(var d=new Lv(a),e=0;e<nq.length;e++)d.O(new Hv(nq[e]),!0);d=new rx("Module",d,null,a);this.h.O(d,!0);this.h.O(new ux(""),!0);this.h.render(c);d.Yc(!1);a=a.s("div","content");b.appendChild(a);this.O(this.i,!0)};h.L=function(){yx.m.L.call(this);var a=Z(this.h,1);Ms(this).listen(a,"action",this.gi,!0)};
function zx(a,b){if(b){for(var c=Ss(a.i),d=0;d<c;d++){var e=Z(a.i,d).u();if(e.Oa()){xx(e,b);return}}30<c?(e=Z(a.i,0).u(),xx(e,b)):(c=new vx(a.u(),b),c=new Xw(c,a.g),a.i.O(c,!0))}}function Ax(a,b,c,d){dv(a.u(),b,c,d,!0).B(function(a){a=a[0];if(a.result[0]){var b=a.result[0];zx(this,{storeName:mq[mq.indexOf(a.store)],primaryKey:b.id,record:b,value:d,tokens:[{keyPath:c}]})}Bx(this)},function(a){Bx(this);throw a;},a)}
function Cx(a){var b=a+0.1,c=["rgb(255, 255, 255) 0%"];99>a&&(c[1]="rgb(135, 224, 253) "+a.toFixed(1)+"%",c[2]="rgb(255, 255, 255) "+b.toFixed(1)+"%");c.push("rgb(255, 255, 255) 100%");return"linear-gradient(to right, "+c.join(", ")+")"}function Dx(a,b){0==a.o&&(a.o=b);var c=100*(a.o-b)/a.o,d=Z(a.h,1).n();Ng(document,"input",null,d)[0].style.background=Cx(c)}
function Bx(a){var b=a.j[0];if(b){b.Ia++;Dx(a,4*(a.j.length-1)+(4-b.Ia));var c=a.u();0==b.Ia?Ax(a,b.module,"id",b.Ta):1==b.Ia?Ax(a,b.module,"ydn$emails",b.Ta):2==b.Ia?(c=b.Ta.match(/\d/g),3>(c?c.length:0)?Bx(a):Ax(a,b.module,"ydn$phones",b.Ta)):3==b.Ia?ev(c,b.module,b.Ta).B(function(a){a=a[0].fullTextResult;for(var b=a.length||0,c=0;c<b;c++)zx(this,a[c]);Bx(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&Bx(a))}}
h.gi=function(){for(var a=Z(this.h,1).pa(),b=Ss(this.i)-1;0<=b;b--)Z(this.i,b).u().clear();this.o=0;if(a&&(a=a.trim(),2<=a.length)){b=(b=nx(Z(this.h,0)))?b.ub():null;this.j.length=0;if(b)this.j[0]={module:b,Ta:a,Ia:-1};else for(b=0;b<nq.length;b++)this.j[b]={module:nq[b],Ta:a,Ia:-1};Bx(this)}};h.ra=function(){return Mg("content",this.n())};function Ex(a,b){Y.call(this,a);this.ba(b)}C(Ex,Y);h=Ex.prototype;h.logger=P("ydn.crm.ui.sugar.Header");h.w=function(){return"sugar-header"};
h.Q=function(){Ex.m.Q.call(this);var a=this.n(),b=this.u(),c=this.g;Dg(a,this.w());var d=c.s("a");d.textContent=b.K();d.href=b.g.baseUrl?b.g.baseUrl:"https://"+b.g.domain;d=c.s("div",{"class":"main-title",title:"SugarCRM"},[d]);a.appendChild(d);var d=[],e=chrome.extension.getURL("option-page.html")+"#credentials",e=c.s("a",{href:e,target:"option-page"},"Setup host permission");e.setAttribute("title","Your permission is required to connect your server from this extension. Without permission request to server will be slow.");
d.push(e);d=c.s("div",{"class":"host-permission"},d);a.appendChild(d);var e=c.s("input",{name:"username",type:"text"}),e=c.s("div",null,[e]),f=c.s("input",{name:"password",type:"password"}),f=c.s("div",null,[f]),g=c.s("div","message"),e=c.s("div","login-form",[e,f,g]);R(d,!1);R(e,!1);a.appendChild(e);b=new yx(c,b);this.O(b);c=c.s("div");a.appendChild(c);b.render(c)};
h.L=function(){Ex.m.L.call(this);var a=this.n(),b=Ms(this);this.n().querySelector(".host-permission");a=a.querySelector(".login-form");a=new Zs(a);b.listen(a,"key",this.fi);b.listen(ad(),"post",function(a){a=a.getMessage();if("update-host-permission"==a.req&&(a=a.data)&&a.origins){a=a.origins;for(var b=this.info.K(),e=0;e<a.length;e++)if((new sd(a[e])).K()==b){N(this.logger,"has host permission on "+b);var f=this.u();f.g.hostPermission=!0;this.ba(f)}}},!1)};
h.fi=function(a){if(13==a.g){var b=this.n().querySelector(".login-form"),c=this.u();a=b.querySelector("input[name=username]").value;var d=b.querySelector("input[name=password]").value,e=b.querySelector(".message");e.textContent="logging in...";cv(c,a,d).B(function(){c.isLogin()?(e.textContent="",R(b,!1)):e.textContent="login failed"},function(a){e.textContent="Error: "+a},this)}};h.K=function(){return this.u().K()};function Fx(a,b,c){Y.call(this,c);this.ba(b);this.i=a;a=this.h=new yv(b);b=document.body;(new MutationObserver(a.i.bind(a))).observe(b,{childList:!1,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,attributeFilter:["data-tooltip"]})}C(Fx,Y);h=Fx.prototype;h.w=function(){return"sugar-panel"};h.Q=function(){Fx.m.Q.call(this);var a=this.g,b=this.n();Dg(b,this.w());b=new Ex(a,this.u());this.O(b,!0);a=new bx(this.i,this.u(),a);this.O(a,!0)};h.L=function(){Fx.m.L.call(this)};
h.logger=P("ydn.crm.ui.sugar.SugarPanel");h.update=function(a,b,c){N(this.logger,"update for "+a);Z(this,1).update(a,b,c)};function Gx(){this.g=null;var a=dd().send("user-setting").A(function(){},this),b=dd().send("login-info").B(function(a){a||M(this.logger,"login fail");this.g=a},function(){this.g=null;M(this.logger,"login fail")},this);this.j=nm([a,b])}var Hx;Gx.prototype.logger=P("ydn.crm.inj.UserSetting");function wv(){Hx||(Hx=new Gx);return Hx}Gx.prototype.Pb=function(){return this.j};Gx.prototype.i=function(){return this.g.email};Gx.prototype.h=function(a){return dd("sugarcrm",a).send("info-module")};function Ix(a){Y.call(this,a)}C(Ix,Y);Ix.prototype.Q=function(){Ix.m.Q.call(this);var a=this.n(),b=this.g;Dg(a,"sugarcrm-link-panel");b=b.createElement("a");b.textContent="Setup SugarCRM";b.href=chrome.extension.getURL("option-page.html")+"#credentials";b.className="sugarcrm-setup-link";a.appendChild(b);R(a,!1)};Ix.prototype.ba=function(a){Ix.m.ba.call(this,a);a=u(a)&&0<a.length;R(this.n(),!a)};function Jx(a){Y.call(this,a);this.j=wv();this.i=this.h=null}C(Jx,Y);h=Jx.prototype;h.w=function(){return"inj"};h.Q=function(){Jx.m.Q.call(this);this.n().classList.add(this.w());var a=new Ix;this.O(a,!0)};h.L=function(){Jx.m.L.call(this)};h.logger=P("ydn.crm.inj.SidebarPanel");
function Kx(a,b){var c=b.domain;return a.j.h(c).A(function(a){var e=this.j.g.email;a=new $u(b,a);!this.h&&a.isLogin()&&(N(this.logger,"compose template initialized."),this.h=new uw(a));e=new Fx(e,a,this.g);for(a=0;a<Ss(this);a++){var f=Z(this,a);if(f instanceof Fx&&f.u().K()==c)return}N(this.logger,"sugar panel "+c+" created");this.O(e,!0)},a)}function Lx(a,b){a.i=b;for(var c=0;c<Ss(a);c++){var d=Z(a,c);d instanceof Fx&&(b?d.update(b.g,b.h,null):d.update(null,null,null))}}
h.init=function(){return 1<Ss(this)?sb():dd().send("list-sugarcrm").A(function(a){Z(this,0).ba(a);for(var b=[],c=0;c<a.length;c++){var d;a:{for(d=1;d<Ss(this);d++){var e=Z(this,d);if(e instanceof Fx&&e.u().K()==a[c]){d=!0;break a}}d=!1}d||b.push(Kx(this,a[c]))}return nm(b)},this)};function Mx(){this.g=this.h=null}Mx.prototype.init=function(a){this.h=a;a=document.getElementById("user-login");yc(a,"click",function(a){a.preventDefault();window.open(a.target.href,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=400, top="+(screen.height/2-200)+", left="+(screen.width/2-300));return!0},!0,this)};
function Nx(a,b){if(!b||b instanceof Error)a.g=null;else if(a.g=b,a.h){var c=document.getElementById("user-login"),d=document.getElementById("user-name"),e=Mg("login-message",a.h);b instanceof Error?(e.textContent=b.message,R(e,!0),R(c,!1)):a.g.is_login?(c.href=a.g.logout_url,c.textContent="logout",d.textContent=a.g.email,R(e,!1),R(c,!1)):(c.href=a.g.login_url,c.textContent="login",c.style.display="",d.textContent="",R(e,!0),R(c,!0))}};function Ox(){this.h=document.createElement("div");document.body.appendChild(this.h);R(this.h,!1);this.j=new hf(400);yc(this.j,kf,this.Hh,!0,this);this.i=0;this.t="";bd("gmail");this.g=new Jx;this.g.render(this.h);this.p=!1;var a=this.history=new Hs,b=Fd(new sd(document.location.href))+"/";a.Rh=b;yc(this.history,"navigate",this.uh,!1,this);this.H=null;this.l=!1;new lu;this.o=new Mx}h=Ox.prototype;h.logger=P("ydn.crm.inj.App");h.isLogin=function(){return this.l};
h.Hh=function(){this.i++;this.t!=location.href&&(M(this.logger,"url already changed"),this.j.stop());40<this.i&&(M(this.logger,"sniff give up after "+this.i),this.j.stop());var a;this.g.n();a=(a=document.querySelector('table[role="presentation"]'))?a.querySelector("tr").children[2].querySelector("table"):null;if(a&&!this.p){for(var b,c=a,d=0;4>d;d++)if(c&&c.parentElement&&(c=c.parentElement,c.nextElementSibling&&"DIV"==c.nextElementSibling.tagName)){var c=c.parentElement,d=c.lastElementChild,e=!!d.querySelector("a[href]");
b=document.createElement("div");e?c.parentElement.insertBefore(b,d):c.appendChild(b);break}b||(M(this.logger,"usual root position is not available, locating on second best position"),c=a.ownerDocument,b=c.createElement("td"),b.setAttribute("colspan","2"),c=c.createElement("tr"),c.className="widget-topraw",c.appendChild(b),(a.querySelector("tbody")||a).appendChild(c));c=this.h;c.parentElement&&c.parentElement.removeChild(c);b.appendChild(c);R(c,!0);this.p=!0;R(this.h,!0)}a:if(c=5<this.i,b=a.querySelector("img[jid]")){for(a=
b.getAttribute("jid");b&&"TD"!=b.tagName;)b=b.parentElement;b=b.nextElementSibling.querySelector("span[title]").getAttribute("title");a=new ou(a,b)}else{if(c&&(a=a.querySelector("span[title]"))&&(b=a.getAttribute("title").trim(),0<b.length&&(a=document.querySelector('span[name="'+b+'"][email]')))){a=a.getAttribute("email");a=new ou(a,b);break a}a=null}a&&(this.j.stop(),Lx(this.g,a))};
h.uh=function(a){if(a.g!=this.H&&(this.H=a.g,!/^contact/.test(a.g)))if(/compose=new$/.test(a.g)){var b=this.g;b.h?(a=b.h,a.h=b.i||null,(b=document.querySelector('form[enctype="multipart/form-data"]'))?(b=(b=vw(b))?(b=b.querySelector("tbody").lastElementChild.firstElementChild.firstElementChild.firstElementChild.lastElementChild.querySelector("table"))?b.querySelector("td:last-child"):null:null,b?(zw(a,b),a=!0):(M(a.logger,"compose toolbar not found."),a=!1)):(M(a.logger,"compose FORM element not found."),
a=!1)):(M(b.logger,"SugarCRM instance not ready."),a=!1);O(this.logger,"inject compose "+(a?"ok":"fail"))}else/\w+\/[\w\d]{10,18}$/.test(a.g)&&(O(this.logger,"updating sidebar"),this.i=0,this.t=location.href,this.p=!1,Lx(this.g,null),jf(this.j))};
h.init=function(){N(this.logger,"init "+this);Px(this);var a=window.setInterval(function(){document.querySelector('a[href="http://mail.google.com/mail/help/terms.html"]')&&window.clearTimeout(a)},500);window.setTimeout(function(){window.clearTimeout(a)},15E3)};h.toString=function(){return"inj.Main:0.7.14"};
function Px(a){dd().send("login-info").B(function(a){a:{if(a&&a.email){O(this.logger,"user "+a.email+" login");this.l=!0;var c=this.o.g;if(c&&c.email==a.email)break a;this.g.init();this.history.setEnabled(!0)}else this.l&&(this.l=!1,this.history.setEnabled(!1));Nx(this.o,a)}},function(a){M(this.logger,a.name+" "+a.message);Nx(this.o,a)},a)}h.Zh=function(){return{sidebar:this.g,setting:this.o}};pa("ydn.crm.version","0.7.14");pa("runInjApp",function(){zo();var a=new Ox;a.init();return a});pa("runEventApp",function(){zo();var a=new As;a.init();ys(a);return a});pa("ydn.crm.ui.StatusBar",Iw);pa("ydn.crm.ui.SimpleStatusBar",Kw);Iw.instance=Jw;As.prototype.xp=As.prototype.T;Ox.prototype.xp=Ox.prototype.Zh;pa("goog.async.Deferred",D);D.prototype.addCallback=D.prototype.A;D.prototype.addErrback=D.prototype.Lc;D.prototype.addBoth=D.prototype.fa;D.prototype.addCallbacks=D.prototype.B;function Qx(a){Y.call(this,a);this.h=wv()}C(Qx,Y);h=Qx.prototype;h.w=function(){return"inj"};h.Q=function(){Qx.m.Q.call(this);this.n().classList.add(this.w());var a=new Ix;this.O(a,!0)};h.L=function(){Qx.m.L.call(this)};h.logger=P("ydn.crm.ui.SidebarPanel");
function Rx(a,b){var c=b.domain;return a.h.h(c).A(function(a){var e=this.h.g.email;a=new $u(b,a);e=new Fx(e,a,this.g);for(a=0;a<Ss(this);a++){var f=Z(this,a);if(f instanceof Fx&&f.u().K()==c)return}N(this.logger,"sugar panel "+c+" created");this.O(e,!0)},a)}h.update=function(a){R(this.n(),!0);for(var b=0;b<Ss(this);b++){var c=Z(this,b);c instanceof Fx&&(a?c.update(a.g,a.h,null):c.update(null,null,null))}};
h.init=function(){return 1<Ss(this)?sb():dd().send("list-sugarcrm").A(function(a){Z(this,0).ba(a);for(var b=[],c=0;c<a.length;c++){var d;a:{for(d=1;d<Ss(this);d++){var e=Z(this,d);if(e instanceof Fx&&e.u().K()==a[c]){d=!0;break a}}d=!1}d||b.push(Rx(this,a[c]))}return nm(b)},this)};function Sx(a,b){Y.call(this,a);this.ba(b);this.i=new Y(a);this.h=null;this.j=[];this.o=0}C(Sx,Y);h=Sx.prototype;h.Q=function(){Sx.m.Q.call(this);var a=this.g,b=this.n(),c=a.s("div","header");b.appendChild(c);this.h=new ex(null,null,a);for(var d=new Lv(a),e=0;e<nq.length;e++)d.O(new Hv(nq[e]),!0);d=new rx("Module",d,null,a);this.h.O(d,!0);this.h.O(new ux(""),!0);this.h.render(c);a=a.s("div","content");b.appendChild(a);this.O(this.i,!0)};
h.L=function(){Sx.m.L.call(this);var a=Z(this.h,1);Ms(this).listen(a,"action",this.ei,!0)};h.w=function(){return"browse-panel"};function Tx(a,b){if(b){for(var c=Ss(a.i),d=0;d<c;d++){var e=Z(a.i,d).u();if(e.Oa()){xx(e,b);return}}30<c?(e=Z(a.i,0).u(),xx(e,b)):(c=new vx(a.u(),b),c=new Xw(c,a.g),a.i.O(c,!0))}}
function Ux(a,b,c,d){dv(a.u(),b,c,d,!0).B(function(a){a=a[0];if(a.result[0]){var b=a.result[0];Tx(this,{storeName:mq[mq.indexOf(a.store)],primaryKey:b.id,record:b,value:d,tokens:[{keyPath:c}]})}Vx(this)},function(a){Vx(this);throw a;},a)}function Wx(a,b){0==a.o&&(a.o=b);var c=100*(a.o-b)/a.o,d=Z(a.h,1).n();Ng(document,"input",null,d)[0].style.background=Cx(c)}
function Vx(a){var b=a.j[0];if(b){b.Ia++;Wx(a,4*(a.j.length-1)+(4-b.Ia));var c=a.u();0==b.Ia?Ux(a,b.module,"id",b.Ta):1==b.Ia?Ux(a,b.module,"ydn$emails",b.Ta):2==b.Ia?(c=b.Ta.match(/\d/g),3>(c?c.length:0)?Vx(a):Ux(a,b.module,"ydn$phones",b.Ta)):3==b.Ia?ev(c,b.module,b.Ta).B(function(a){a=a[0].fullTextResult;for(var b=a.length||0,c=0;c<b;c++)Tx(this,a[c]);Vx(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&Vx(a))}}
h.ei=function(){for(var a=Z(this.h,1).pa(),b=Ss(this.i)-1;0<=b;b--)Z(this.i,b).u().clear();this.o=0;if(a&&(a=a.trim(),2<=a.length)){b=(b=nx(Z(this.h,0)))?b.ub():null;this.j.length=0;if(b)this.j[0]={module:b,Ta:a,Ia:-1};else for(b=0;b<nq.length;b++)this.j[b]={module:nq[b],Ta:a,Ia:-1};Vx(this)}};h.ra=function(){return Mg("content",this.n())};function Xx(a,b,c){Hv.call(this,a,b,c);It(this,8,!0);if(a=this.n())b=this.i,a&&(ht(a,"menuitemradio"),Ev(b,this,a,!0))}C(Xx,Hv);Xx.prototype.mb=function(){return this.dispatchEvent("action")};At("goog-option",function(){return new Xx(null)});function Yx(){}C(Yx,Xv);da(Yx);Yx.prototype.w=function(){return"goog-toolbar-button"};function Zx(a,b,c){Vv.call(this,a,b||Yx.W(),c)}C(Zx,Vv);At("goog-toolbar-button",function(){return new Zx(null)});function $x(a,b,c,d){$v.call(this,a,b,c||qx.W(),d)}C($x,$v);At("goog-toolbar-menu-button",function(){return new $x(null)});function ay(a,b){Jv.call(this,a||cx.W(),b)}C(ay,Jv);At("goog-toolbar-separator",function(){return new ay});function by(a,b,c){Vv.call(this,a,b||Xv.W(),c);It(this,16,!0)}C(by,Vv);At("goog-toggle-button",function(){return new by(null)});function cy(a,b,c){by.call(this,a,b||Yx.W(),c)}C(cy,by);At("goog-toolbar-toggle-button",function(){return new cy(null)});function dy(){}C(dy,jt);da(dy);dy.prototype.w=function(){return"record"};dy.prototype.X=function(a){return dy.m.X.call(this,a)};function ey(a,b){Ct.call(this,null,null,a);this.ba(b)}C(ey,Ct);yt(ey,dy);function fy(a,b){Y.call(this,a);this.ba(b);this.i=new Y(a);this.h=new Y(a)}C(fy,Y);fy.prototype.ra=function(){return Mg("content",this.n())};
fy.prototype.Q=function(){fy.m.Q.call(this);var a=this.n(),b;A('<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>')?(Na('Soy template output is unsafe for use as HTML: <div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>'),
b="zSoyz"):b='<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>';
a.innerHTML=b;Qs(new ex,Mg("goog-toolbar",a));this.O(this.i,!0);this.O(this.h,!0);R(this.h.n(),!1)};fy.prototype.L=function(){fy.m.L.call(this);this.n()};fy.prototype.refresh=function(){};pa("ydn.crm.sugar.model.Sugar",$u);pa("ydn.crm.ui.SidebarPanel",Qx);pa("ydn.crm.ui.sugar.SyncPanel",fy);pa("ydn.crm.ui.sugar.SearchPanel",yx);pa("ydn.crm.ui.sugar.BrowsePanel",Sx);pa("ydn.crm.inj.UserSetting",Gx);Gx.getInstance=wv;Gx.prototype.getModuleInfo=Gx.prototype.h;Gx.prototype.getGmail=Gx.prototype.i;
$u.list=function(){var a=wv();return dd().send("list-sugarcrm").A(function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.isLogin&&c.push(a.h(e.domain).A(function(a){return new $u(this,a)},e))}return nm(c)})};Qx.prototype.update=Qx.prototype.update;pa("ydn.msg.Pipe",Vc);pa("ydn.msg.initPipe",bd);pa("ydn.msg.getChannel",dd);Vc.prototype.listen=Vc.prototype.listen;Vc.prototype.getChannel=Vc.prototype.j;Yc.prototype.send=Yc.prototype.send;})();

            //# sourceMappingURL=https://ydn-src-1.storage.googleapis.com/jsc/ydn.crm-0.7.14.js.map
        