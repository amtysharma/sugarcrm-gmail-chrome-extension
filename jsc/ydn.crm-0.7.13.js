(function(){var h,aa=aa||{},q=this;function ba(a){a=a.split(".");for(var b=q,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}function ca(){}function da(a){a.W=function(){return a.ig?a.ig:a.ig=new a}}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function s(a){return void 0!==a}function u(a){return"array"==ea(a)}function fa(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function v(a){return"string"==typeof a}function ga(a){return"boolean"==typeof a}function w(a){return"number"==typeof a}function ha(a){return"function"==ea(a)}function y(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ia(a){return a[ja]||(a[ja]=++ka)}
var ja="closure_uid_"+(1E9*Math.random()>>>0),ka=0;function la(a,b,c){return a.call.apply(a.bind,arguments)}function na(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function oa(a,b,c){oa=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?la:na;return oa.apply(null,arguments)}function pa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var A=Date.now||function(){return+new Date};
function qa(a,b){var c=a.split("."),d=q;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function B(a,b){function c(){}c.prototype=b.prototype;a.m=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.ii=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function ra(a){Error.captureStackTrace?Error.captureStackTrace(this,ra):this.stack=Error().stack||"";a&&(this.message=String(a))}B(ra,Error);ra.prototype.name="CustomError";var sa;function ta(a,b){return 0==a.lastIndexOf(b,0)}function ua(a){var b=a.length-8;return 0<=b&&a.indexOf("#archive",b)==b}function va(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function wa(a){return/^[\s\xa0]*$/.test(a)}function xa(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}function ya(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}
function za(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function Aa(a){if(!Ba.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ca,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Da,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ea,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Fa,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Ga,"&#39;"));return a}var Ca=/&/g,Da=/</g,Ea=/>/g,Fa=/"/g,Ga=/'/g,Ba=/[&<>"']/;function Ha(a){return za(a.replace(/  /g," &#160;"),void 0)}
function Ia(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ja={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ka={"'":"\\'"};
function La(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,k;if(!(k=Ja[d])){if(!(31<e&&127>e))if(d in Ka)d=Ka[d];else if(d in Ja)d=Ka[d]=Ja[d];else{e=d;k=d.charCodeAt(0);if(31<k&&127>k)e=d;else{if(256>k){if(e="\\x",16>k||256<k)e+="0"}else e="\\u",4096>k&&(e+="0");e+=k.toString(16).toUpperCase()}d=Ka[d]=e}k=d}f[g]=k}b.push('"');return b.join("")}function Ma(a,b){return a<b?-1:a>b?1:0};function Na(a,b){b.unshift(a);ra.call(this,va.apply(null,b));b.shift()}B(Na,ra);Na.prototype.name="AssertionError";function Oa(a,b){throw new Na("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Pa=Array.prototype,Qa=Pa.indexOf?function(a,b,c){return Pa.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(v(a))return v(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Ra=Pa.forEach?function(a,b,c){Pa.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Sa=Pa.filter?function(a,b,c){return Pa.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,g=v(a)?a.split(""):a,k=0;k<d;k++)if(k in g){var l=g[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},Ta=Pa.map?function(a,b,c){return Pa.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=v(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ua=Pa.some?function(a,b,c){return Pa.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},Va=Pa.every?function(a,b,c){return Pa.every.call(a,b,c)}:function(a,
b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Wa(a,b){var c=Xa(a,b,void 0);return 0>c?null:v(a)?a.charAt(c):a[c]}function Xa(a,b,c){for(var d=a.length,e=v(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Ya(a,b){return 0<=Qa(a,b)}function Za(a){if(!u(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function $a(a,b){var c=Qa(a,b),d;(d=0<=c)&&ab(a,c);return d}
function ab(a,b){Pa.splice.call(a,b,1)}function bb(a){return Pa.concat.apply(Pa,arguments)}function cb(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function db(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(u(d)||(e=fa(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,k=0;k<g;k++)a[f+k]=d[k];else a.push(d)}}function eb(a,b,c,d){Pa.splice.apply(a,fb(arguments,1))}
function fb(a,b,c){return 2>=arguments.length?Pa.slice.call(a,b):Pa.slice.call(a,b,c)}function gb(a,b){if(!fa(a)||!fa(b)||a.length!=b.length)return!1;for(var c=a.length,d=hb,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function ib(a,b){return a>b?1:a<b?-1:0}function hb(a,b){return a===b}function jb(a,b){var c;c=kb||ib;for(var d=0,e=a.length,f;d<e;){var g=d+e>>1,k;k=c(b,a[g]);0<k?d=g+1:(e=g,f=!k)}c=f?d:~d;0>c&&eb(a,-(c+1),0,b)};function lb(a){return function(){throw a;}};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function C(a,b){this.l=[];this.N=a;this.H=b||null}h=C.prototype;h.ob=!1;h.Ib=!1;h.Hc=!1;h.Pf=!1;h.sf=!1;h.nd=0;function mb(a,b){if(a.ob)a.i instanceof C&&mb(a.i);else{if(a.h){var c=a.h;delete a.h;b?mb(c,b):(c.nd--,0>=c.nd&&mb(c))}a.N?a.N.call(a.H,a):a.sf=!0;a.ob||a.D(new nb)}}h.sd=function(a,b){this.Hc=!1;ob(this,a,b)};function ob(a,b,c){a.ob=!0;a.i=c;a.Ib=!b;a.ye()}function pb(a){if(a.ob){if(!a.sf)throw new qb;a.sf=!1}}h.C=function(a){pb(this);ob(this,!0,a)};h.D=function(a){pb(this);ob(this,!1,a)};
h.B=function(a,b){return this.A(a,null,b)};h.Gc=function(a,b){return this.A(null,a,b)};h.fa=function(a,b){return this.A(a,a,b)};h.A=function(a,b,c){this.l.push([a,b,c]);this.ob&&this.ye();return this};function rb(a,b){a.A(b.C,b.D,b)}function sb(a){return Ua(a.l,function(a){return ha(a[1])})}
h.ye=function(){this.o&&this.ob&&sb(this)&&(q.clearTimeout(this.o),delete this.o);this.h&&(this.h.nd--,delete this.h);for(var a=this.i,b=!1,c=!1;this.l.length&&!this.Hc;){var d=this.l.shift(),e=d[0],f=d[1],d=d[2];if(e=this.Ib?f:e)try{var g=e.call(d||this.H,a);s(g)&&(this.Ib=this.Ib&&(g==a||g instanceof Error),this.i=a=g);a instanceof C&&(this.Hc=c=!0)}catch(k){a=k,this.Ib=!0,sb(this)||(b=!0)}}this.i=a;c&&(a.A(oa(this.sd,this,!0),oa(this.sd,this,!1)),a.Pf=!0);b&&(this.o=q.setTimeout(lb(a),0))};
function tb(a){var b=new C;b.C(a);return b}function D(a){var b=new C;b.D(a);return b}function ub(a){Error.captureStackTrace?Error.captureStackTrace(this,ub):this.stack=Error().stack||"";a&&(this.message=String(a))}B(ub,Error);function qb(){ub.call(this)}B(qb,ub);qb.prototype.message="Deferred has already fired";qb.prototype.name="AlreadyCalledError";function nb(){ub.call(this)}B(nb,ub);nb.prototype.message="Deferred was canceled";nb.prototype.name="CanceledError";function vb(){0!=wb&&(xb[ia(this)]=this)}var wb=0,xb={};vb.prototype.H=!1;vb.prototype.qa=function(){if(!this.H&&(this.H=!0,this.J(),0!=wb)){var a=ia(this);delete xb[a]}};vb.prototype.J=function(){if(this.Rb)for(;this.Rb.length;)this.Rb.shift()()};var yb,zb,Ab,Bb,Cb;function Db(){return q.navigator?q.navigator.userAgent:null}function Eb(){return q.navigator}Bb=Ab=zb=yb=!1;var Fb;if(Fb=Db()){var Gb=Eb();yb=ta(Fb,"Opera");zb=!yb&&(-1!=Fb.indexOf("MSIE")||-1!=Fb.indexOf("Trident"));Ab=!yb&&-1!=Fb.indexOf("WebKit");Bb=!yb&&!Ab&&!zb&&"Gecko"==Gb.product}var Hb=yb,F=zb,Ib=Bb,Jb=Ab,Kb=Eb();Cb=-1!=(Kb&&Kb.platform||"").indexOf("Mac");var Lb=!!Eb()&&-1!=(Eb().appVersion||"").indexOf("X11");
function Mb(){var a=q.document;return a?a.documentMode:void 0}var Nb;a:{var Ob="",Pb;if(Hb&&q.opera)var Qb=q.opera.version,Ob="function"==typeof Qb?Qb():Qb;else if(Ib?Pb=/rv\:([^\);]+)(\)|;)/:F?Pb=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Jb&&(Pb=/WebKit\/(\S+)/),Pb)var Rb=Pb.exec(Db()),Ob=Rb?Rb[1]:"";if(F){var Sb=Mb();if(Sb>parseFloat(Ob)){Nb=String(Sb);break a}}Nb=Ob}var Tb={};
function Ub(a){var b;if(!(b=Tb[a])){b=0;for(var c=ya(String(Nb)).split("."),d=ya(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var n=l.exec(g)||["","",""],p=m.exec(k)||["","",""];if(0==n[0].length&&0==p[0].length)break;b=Ma(0==n[1].length?0:parseInt(n[1],10),0==p[1].length?0:parseInt(p[1],10))||Ma(0==n[2].length,0==p[2].length)||Ma(n[2],p[2])}while(0==b)}b=Tb[a]=0<=b}return b}
var Vb=q.document,Wb=Vb&&F?Mb()||("CSS1Compat"==Vb.compatMode?parseInt(Nb,10):5):void 0;var Xb=!F||F&&9<=Wb,Yb=!F||F&&9<=Wb,Zb=F&&!Ub("9");!Jb||Ub("528");Ib&&Ub("1.9b")||F&&Ub("8")||Hb&&Ub("9.5")||Jb&&Ub("528");Ib&&!Ub("8")||F&&Ub("9");function H(a,b){this.type=a;this.i=this.target=b}h=H.prototype;h.qa=function(){};h.Ob=!1;h.qg=!0;h.Qc=function(){this.Ob=!0};h.preventDefault=function(){this.qg=!1};function $b(a){$b[" "](a);return a}$b[" "]=ca;function ac(a,b){H.call(this,a?a.type:"");this.j=this.i=this.target=null;this.g=this.clientY=this.clientX=0;this.l=this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.h=null;a&&this.init(a,b)}B(ac,H);var bc=[1,4,2];
ac.prototype.init=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.i=b;var d=a.relatedTarget;if(d){if(Ib){var e;a:{try{$b(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.j=d;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.g=a.keyCode||0;this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.l=Cb?a.metaKey:
a.ctrlKey;this.h=a;a.defaultPrevented&&this.preventDefault();delete this.Ob};function cc(a){return Xb?0==a.h.button:"click"==a.type?!0:!!(a.h.button&bc[0])}ac.prototype.Qc=function(){ac.m.Qc.call(this);this.h.stopPropagation?this.h.stopPropagation():this.h.cancelBubble=!0};ac.prototype.preventDefault=function(){ac.m.preventDefault.call(this);var a=this.h;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Zb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var dc="closure_listenable_"+(1E6*Math.random()|0);function ec(a){try{return!(!a||!a[dc])}catch(b){return!1}}var fc=0;function gc(a,b,c,d,e){this.cc=a;this.proxy=null;this.src=b;this.type=c;this.pd=!!d;this.bc=e;this.key=++fc;this.removed=this.od=!1}function hc(a){a.removed=!0;a.cc=null;a.proxy=null;a.src=null;a.bc=null};function ic(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function jc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function kc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function lc(a,b){for(var c=fa(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],s(a));c++);return a}function mc(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');a[b]=c}function nc(a,b){return b in a?a[b]:void 0}function oc(a){var b={},c;for(c in a)b[c]=a[c];return b}
function pc(a){var b={},c;for(c in a)b[a[c]]=c;return b}var qc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function rc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<qc.length;f++)c=qc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}
function sc(a){var b=arguments.length;if(1==b&&u(arguments[0]))return sc.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};function tc(a){this.src=a;this.g={};this.h=0}tc.prototype.add=function(a,b,c,d,e){var f=this.g[a];f||(f=this.g[a]=[],this.h++);var g=uc(f,b,d,e);-1<g?(a=f[g],c||(a.od=!1)):(a=new gc(b,this.src,a,!!d,e),a.od=c,f.push(a));return a};tc.prototype.remove=function(a,b,c,d){if(!(a in this.g))return!1;var e=this.g[a];b=uc(e,b,c,d);return-1<b?(hc(e[b]),ab(e,b),0==e.length&&(delete this.g[a],this.h--),!0):!1};
function wc(a,b){var c=b.type;if(!(c in a.g))return!1;var d=$a(a.g[c],b);d&&(hc(b),0==a.g[c].length&&(delete a.g[c],a.h--));return d}tc.prototype.removeAll=function(a){var b=0,c;for(c in this.g)if(!a||c==a){for(var d=this.g[c],e=0;e<d.length;e++)++b,hc(d[e]);delete this.g[c];this.h--}return b};function xc(a,b,c,d,e){a=a.g[b];b=-1;a&&(b=uc(a,c,d,e));return-1<b?a[b]:null}function uc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.cc==b&&f.pd==!!c&&f.bc==d)return e}return-1};var yc="closure_lm_"+(1E6*Math.random()|0),zc={},Ac=0;function Bc(a,b,c,d,e){if(u(b)){for(var f=0;f<b.length;f++)Bc(a,b[f],c,d,e);return null}c=Cc(c);return ec(a)?a.listen(b,c,d,e):Dc(a,b,c,!1,d,e)}function Dc(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,k=Ec(a);k||(a[yc]=k=new tc(a));c=k.add(b,c,d,e,f);if(c.proxy)return c;d=Fc();c.proxy=d;d.src=a;d.cc=c;a.addEventListener?a.addEventListener(b,d,g):a.attachEvent(b in zc?zc[b]:zc[b]="on"+b,d);Ac++;return c}
function Fc(){var a=Gc,b=Yb?function(c){return a.call(b.src,b.cc,c)}:function(c){c=a.call(b.src,b.cc,c);if(!c)return c};return b}function Hc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Hc(a,b[f],c,d,e);else c=Cc(c),ec(a)?a.nb.add(String(b),c,!0,d,e):Dc(a,b,c,!0,d,e)}function Ic(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Ic(a,b[f],c,d,e);else c=Cc(c),ec(a)?a.Ca(b,c,d,e):a&&(a=Ec(a))&&(b=xc(a,b,c,!!d,e))&&Jc(b)}
function Jc(a){if(w(a)||!a||a.removed)return!1;var b=a.src;if(ec(b))return wc(b.nb,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.pd):b.detachEvent&&b.detachEvent(c in zc?zc[c]:zc[c]="on"+c,d);Ac--;(c=Ec(b))?(wc(c,a),0==c.h&&(c.src=null,b[yc]=null)):hc(a);return!0}function Kc(a,b,c,d){var e=1;if(a=Ec(a))if(b=a.g[b])for(b=cb(b),a=0;a<b.length;a++){var f=b[a];f&&f.pd==c&&!f.removed&&(e&=!1!==Lc(f,d))}return Boolean(e)}
function Lc(a,b){var c=a.cc,d=a.bc||a.src;a.od&&Jc(a);return c.call(d,b)}
function Gc(a,b){if(a.removed)return!0;if(!Yb){var c=b||ba("window.event"),d=new ac(c,this),e=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==c.returnValue)c.returnValue=!0}c=[];for(f=d.i;f;f=f.parentNode)c.push(f);for(var f=a.type,k=c.length-1;!d.Ob&&0<=k;k--)d.i=c[k],e&=Kc(c[k],f,!0,d);for(k=0;!d.Ob&&k<c.length;k++)d.i=c[k],e&=Kc(c[k],f,!1,d)}return e}return Lc(a,new ac(b,this))}
function Ec(a){a=a[yc];return a instanceof tc?a:null}var Mc="__closure_events_fn_"+(1E9*Math.random()>>>0);function Cc(a){return ha(a)?a:a[Mc]||(a[Mc]=function(b){return a.handleEvent(b)})};function Nc(){vb.call(this);this.nb=new tc(this);this.Fc=this}B(Nc,vb);Nc.prototype[dc]=!0;h=Nc.prototype;h.Rd=null;h.qf=function(a){this.Rd=a};h.removeEventListener=function(a,b,c,d){Ic(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.Rd;if(c)for(b=[];c;c=c.Rd)b.push(c);var c=this.Fc,d=a.type||a;if(v(a))a=new H(a,c);else if(a instanceof H)a.target=a.target||c;else{var e=a;a=new H(d,c);rc(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.Ob&&0<=g;g--)f=a.i=b[g],e=Oc(f,d,!0,a)&&e;a.Ob||(f=a.i=c,e=Oc(f,d,!0,a)&&e,a.Ob||(e=Oc(f,d,!1,a)&&e));if(b)for(g=0;!a.Ob&&g<b.length;g++)f=a.i=b[g],e=Oc(f,d,!1,a)&&e;return e};h.J=function(){Nc.m.J.call(this);this.nb&&this.nb.removeAll(void 0);this.Rd=null};
h.listen=function(a,b,c,d){return this.nb.add(String(a),b,!1,c,d)};h.Ca=function(a,b,c,d){return this.nb.remove(String(a),b,c,d)};function Oc(a,b,c,d){b=a.nb.g[String(b)];if(!b)return!0;b=cb(b);for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.pd==c){var k=g.cc,l=g.bc||g.src;g.od&&wc(a.nb,g);e=!1!==k.call(l,d)&&e}}return e&&!1!=d.qg};function K(a){ra.call(this,a);this.name="ydn.error.ArgumentException"}B(K,ra);function Pc(a){ra.call(this,a);this.name="ydn.error.NotSupportedException"}B(Pc,ra);function Qc(a){ra.call(this,a);this.name="ydn.error.NotImplementedException"}B(Qc,ra);function Rc(a){ra.call(this,a);this.name="ydn.error.InvalidOperationException"}B(Rc,ra);
function Sc(a){Error.captureStackTrace?Error.captureStackTrace(this,Sc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}B(Sc,Error);Sc.prototype.name="ydn.error.InternalError";function Tc(a,b){C.call(this,a,b);this.j=[]}B(Tc,C);function Uc(a,b){for(var c=0;c<a.j.length;c++)a.j[c][0].call(a.j[c][1],b)}Tc.prototype.C=function(a){this.j.length=0;Tc.m.C.call(this,a)};Tc.prototype.D=function(a){this.j.length=0;Tc.m.D.call(this,a)};function Vc(a){this.id="i"+this.count();this.req=a;this.i=!0;this.g=this.h=null;this.j=new Tc;this.l=NaN}Vc.prototype.F=function(){return this.id};var Wc=0;Vc.prototype.count=function(){Wc++;return Wc};
Vc.prototype.listen=function(a){if(a&&a.id==this.id){this.h=a.data;var b=a.error;b&&(b instanceof Error?this.g=b:y(b)?(this.g=Error(b.message),this.g.name=b.name,this.g.source=b,this.g.result=this.h):(this.g=Error(b),this.g.name="UnknownError"));a.done?(this.i=!1,this.g?this.j.D(this.g):this.j.C(this.h),window.clearTimeout(this.l)):Uc(this.j,a.data);return!0}return!1};Vc.prototype.toString=function(){return"Message:"+this.id+(this.i?"*":"")};
Vc.prototype.toJSON=function(){var a=this;this.l=window.setTimeout(function(){if(a.i){var b=Error("message timeout");b.name="TimeOutError";a.listen({id:a.id,req:a.req,error:b})}},1E4);return{id:this.id,req:this.req,group:this.o,name:this.p,data:this.h}};function Xc(a){Nc.call(this);var b=v(a)?null:a;this.name=v(a)?a:a.name;this.g=[];this.o=b;this.h=null;this.i={}}B(Xc,Nc);Xc.prototype.J=function(){if(this.h){var a=this;this.h.disconnect(function(){a.h=null;a.g.length=0})}else this.g.length=0};function Yc(a){H.call(this,"post");this.message=a}B(Yc,H);Yc.prototype.getMessage=function(){return this.message};
Xc.prototype.l=function(a){if(a)if(a.id)for(var b=this.g.length-1;0<=b;b--){if(this.g[b].F()==a.id&&this.g[b].listen(a)){this.g[b].i?25<b&&(a=this.g.splice(b,1),this.g.unshift(a[0])):this.g.splice(b,1);break}}else"info"==a.req?(a.data=this.o,this.h.postMessage(a)):"html-body-inner"==a.req?(window.console.log("html",a),a.req="",a.done=!0,a.data=document&&document.body?document.body.innerHTML:"",this.h.postMessage(a)):this.dispatchEvent(new Yc(a))};Xc.prototype.toString=function(){return"Pipe:"+this.name};
Xc.prototype.j=function(a,b){var c=a||Zc,d=c+(b?"-"+b:"");this.i[d]||(this.i[d]=new $c(this,c,b||""));return this.i[d]};function ad(a){if(!a.h){a.h=chrome.runtime.connect({name:a.name});var b=oa(a.l,a);a.h.onMessage.addListener(b);a.h.onDisconnect.addListener(function(){a.h.onMessage.removeListener(b);a.h=null;a.g.length=0})}return a.h}var bd=null;function cd(){if(!bd){var a=Zc+"-"+A();bd=new Xc(a)}return bd}function ed(a){var b=a;v(a)&&(b={group:a,name:a+"-"+A()});return bd=new Xc(b)}
var Zc="default",fd=["dev","gmail","host-permission","popup","options"];function gd(a,b){return cd().j(a,b)}function $c(a,b,c){this.g=a;this.h=b;this.i=c}$c.prototype.send=function(a,b){var c=new Vc(a),d=this.i;c.o=this.h;c.p=d;b&&(c.h=b);var d=c.j,e=this.g,f=c.toJSON();ad(e).postMessage(f);e.g.push(c);50<e.g.length&&(e.g.length-=1);return d};function hd(a){if("function"==typeof a.xa)return a.xa();if(v(a))return a.split("");if(fa(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return jc(a)}function id(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(fa(a)||v(a))Ra(a,b,c);else{var d;if("function"==typeof a.Ma)d=a.Ma();else if("function"!=typeof a.xa)if(fa(a)||v(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=kc(a);else d=void 0;for(var e=hd(a),f=e.length,g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)}};var jd="StopIteration"in q?q.StopIteration:Error("StopIteration");function kd(){}kd.prototype.g=function(){throw jd;};kd.prototype.Fb=function(){return this};function ld(a){if(a instanceof kd)return a;if("function"==typeof a.Fb)return a.Fb(!1);if(fa(a)){var b=0,c=new kd;c.g=function(){for(;;){if(b>=a.length)throw jd;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function md(a,b){if(fa(a))try{Ra(a,b,void 0)}catch(c){if(c!==jd)throw c;}else{a=ld(a);try{for(;;)b.call(void 0,a.g(),void 0,a)}catch(d){if(d!==jd)throw d;}}}function nd(a){if(fa(a))return cb(a);a=ld(a);var b=[];md(a,function(a){b.push(a)});return b};function od(a,b){this.h={};this.g=[];this.j=this.i=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof od?(c=a.Ma(),d=a.xa()):(c=kc(a),d=jc(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=od.prototype;h.ca=function(){return this.i};h.xa=function(){pd(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a};h.Ma=function(){pd(this);return this.g.concat()};
h.Ka=function(){return 0==this.i};h.clear=function(){this.h={};this.j=this.i=this.g.length=0};h.remove=function(a){return qd(this.h,a)?(delete this.h[a],this.i--,this.j++,this.g.length>2*this.i&&pd(this),!0):!1};function pd(a){if(a.i!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];qd(a.h,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.i!=a.g.length){for(var e={},c=b=0;b<a.g.length;)d=a.g[b],qd(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}h.get=function(a,b){return qd(this.h,a)?this.h[a]:b};
h.set=function(a,b){qd(this.h,a)||(this.i++,this.g.push(a),this.j++);this.h[a]=b};h.ga=function(){return new od(this)};h.Fb=function(a){pd(this);var b=0,c=this.g,d=this.h,e=this.j,f=this,g=new kd;g.g=function(){for(;;){if(e!=f.j)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw jd;var g=c[b++];return a?g:d[g]}};return g};function qd(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var rd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function sd(a){if(td){td=!1;var b=q.location;if(b){var c=b.href;if(c&&(c=(c=sd(c)[3]||null)&&decodeURIComponent(c))&&c!=b.hostname)throw td=!0,Error();}}return a.match(rd)}var td=Jb;function ud(a,b){var c;if(a instanceof ud)this.Wb=s(b)?b:a.Wb,vd(this,a.ic),this.$d=a.$d,wd(this,a.L()),xd(this,a.Ad),yd(this,a.zc),zd(this,a.g.ga()),Ad(this,a.ze);else if(a&&(c=sd(String(a)))){this.Wb=!!b;vd(this,c[1]||"",!0);var d=c[2]||"";this.$d=d?decodeURIComponent(d):"";wd(this,c[3]||"",!0);xd(this,c[4]);yd(this,c[5]||"",!0);zd(this,c[6]||"",!0);Ad(this,c[7]||"",!0)}else this.Wb=!!b,this.g=new Bd(null,0,this.Wb)}h=ud.prototype;h.ic="";h.$d="";h.we="";h.Ad=null;h.zc="";h.ze="";h.Wb=!1;
h.toString=function(){var a=[],b=this.ic;b&&a.push(Cd(b,Dd),":");if(b=this.L()){a.push("//");var c=this.$d;c&&a.push(Cd(c,Dd),"@");a.push(encodeURIComponent(String(b)));b=this.Ad;null!=b&&a.push(":",String(b))}if(b=this.zc)this.we&&"/"!=b.charAt(0)&&a.push("/"),a.push(Cd(b,"/"==b.charAt(0)?Ed:Fd));(b=this.g.toString())&&a.push("?",b);(b=this.ze)&&a.push("#",Cd(b,Gd));return a.join("")};h.ga=function(){return new ud(this)};
function vd(a,b,c){a.ic=c?b?decodeURIComponent(b):"":b;a.ic&&(a.ic=a.ic.replace(/:$/,""));return a}h.L=function(){return this.we};function wd(a,b,c){a.we=c?b?decodeURIComponent(b):"":b;return a}function xd(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Ad=b}else a.Ad=null}function Hd(a){return a.zc}function yd(a,b,c){a.zc=c?b?decodeURIComponent(b):"":b}function zd(a,b,c){b instanceof Bd?(a.g=b,Id(a.g,a.Wb)):(c||(b=Cd(b,Jd)),a.g=new Bd(b,0,a.Wb))}
function Ad(a,b,c){a.ze=c?b?decodeURIComponent(b):"":b}function Cd(a,b){return v(a)?encodeURI(a).replace(b,Kd):null}function Kd(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Dd=/[#\/\?@]/g,Fd=/[\#\?:]/g,Ed=/[\#\?]/g,Jd=/[\#\?@]/g,Gd=/#/g;function Bd(a,b,c){this.g=a||null;this.h=!!c}
function Ld(a){if(!a.ja&&(a.ja=new od,a.Ia=0,a.g))for(var b=a.g.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=null,f=null;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=Md(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}h=Bd.prototype;h.ja=null;h.Ia=null;h.ca=function(){Ld(this);return this.Ia};h.add=function(a,b){Ld(this);this.g=null;a=Md(this,a);var c=this.ja.get(a);c||this.ja.set(a,c=[]);c.push(b);this.Ia++;return this};
h.remove=function(a){Ld(this);a=Md(this,a);return qd(this.ja.h,a)?(this.g=null,this.Ia-=this.ja.get(a).length,this.ja.remove(a)):!1};h.clear=function(){this.ja=this.g=null;this.Ia=0};h.Ka=function(){Ld(this);return 0==this.Ia};function Nd(a,b){Ld(a);b=Md(a,b);return qd(a.ja.h,b)}h.Ma=function(){Ld(this);for(var a=this.ja.xa(),b=this.ja.Ma(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
h.xa=function(a){Ld(this);var b=[];if(v(a))Nd(this,a)&&(b=bb(b,this.ja.get(Md(this,a))));else{a=this.ja.xa();for(var c=0;c<a.length;c++)b=bb(b,a[c])}return b};h.set=function(a,b){Ld(this);this.g=null;a=Md(this,a);Nd(this,a)&&(this.Ia-=this.ja.get(a).length);this.ja.set(a,[b]);this.Ia++;return this};h.get=function(a,b){var c=a?this.xa(a):[];return 0<c.length?String(c[0]):b};
h.toString=function(){if(this.g)return this.g;if(!this.ja)return"";for(var a=[],b=this.ja.Ma(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.xa(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.g=a.join("&")};h.ga=function(){var a=new Bd;a.g=this.g;this.ja&&(a.ja=this.ja.ga(),a.Ia=this.Ia);return a};function Md(a,b){var c=String(b);a.h&&(c=c.toLowerCase());return c}
function Id(a,b){b&&!a.h&&(Ld(a),a.g=null,id(a.ja,function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.g=null,this.ja.set(Md(this,e),cb(a)),this.Ia+=a.length))},a));a.h=b};var Od;
Od={i:["BC","AD"],h:["Before Christ","Anno Domini"],p:"JFMAMJJASOND".split(""),ea:"JFMAMJJASOND".split(""),o:"January February March April May June July August September October November December".split(" "),Z:"January February March April May June July August September October November December".split(" "),G:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Ga:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Fc:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Rb:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
T:"Sun Mon Tue Wed Thu Fri Sat".split(" "),Sa:"Sun Mon Tue Wed Thu Fri Sat".split(" "),t:"SMTWTFS".split(""),na:"SMTWTFS".split(""),N:["Q1","Q2","Q3","Q4"],H:["1st quarter","2nd quarter","3rd quarter","4th quarter"],g:["AM","PM"],Cf:["EEEE, MMMM d, y","MMMM d, y","MMM d, y","M/d/yy"],Jf:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],Fg:["{1} 'at' {0}","{1} 'at' {0}","{1}, {0}","{1}, {0}"],j:6,fd:[5,6],l:5};function Pd(a){this.h=[];this.g=Od;"number"==typeof a?Qd(this,a):Rd(this,a)}var Sd=[/^\'(?:[^\']|\'\')*\'/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|w+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvwzZ]+/];function Rd(a,b){for(;b;)for(var c=0;c<Sd.length;++c){var d=b.match(Sd[c]);if(d){d=d[0];b=b.substring(d.length);0==c&&("''"==d?d="'":(d=d.substring(1,d.length-1),d=d.replace(/\'\'/,"'")));a.h.push({text:d,type:c});break}}}
function Qd(a,b){var c;if(4>b)c=a.g.Cf[b];else if(8>b)c=a.g.Jf[b-4];else if(12>b)c=a.g.Fg[b-8],c=c.replace("{1}",a.g.Cf[b-8]),c=c.replace("{0}",a.g.Jf[b-8]);else{Qd(a,10);return}Rd(a,c)}function Td(a){var b=Pd.prototype;if(void 0===b.g||void 0===b.g.Mg)return a;for(var c=[],d=0;d<a.length;d++){var e=a.charCodeAt(d);c.push(48<=e&&57>=e?String.fromCharCode(b.g.Mg+e-48):a.charAt(d))}return c.join("")};var Ud={Dg:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Cg:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Wd=Ud,Wd=Ud;var Xd={Ef:".",Gf:",",Hf:"%",le:"0",Kg:"+",Hg:"-",Ff:"E",If:"\u2030",ke:"\u221e",Ig:"NaN",Df:"#,##0.###",Lg:"#E0",Jg:"#,##0%",Eg:"\u00a4#,##0.00;(\u00a4#,##0.00)",Gg:"USD"},Yd=Xd,Yd=Xd;var Zd={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[0,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[18,"kr","kr"],DOP:[2,"$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[0,"Ft",
"Ft"],IDR:[0,"Rp","Rp"],ILS:[2,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],LVL:[2,"Ls","Ls"],MNT:[0,"\u20ae","MN\u20ae"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u0440\u0443\u0431.",
"\u0440\u0443\u0431."],SAR:[2,"Rial","Rial"],SEK:[2,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u20b4","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[0,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};function $d(a,b,c){this.t=b||Yd.Gg;this.Rb=c||ae;this.N=40;this.g=1;this.na=0;this.j=3;this.T=this.h=0;this.Sa=!1;this.G=this.l="";this.i="-";this.o="";this.H=1;this.ea=3;this.Z=this.Ga=!1;this.p=be;if("number"==typeof a)switch(a){case 1:ce(this,Yd.Df);break;case 2:ce(this,Yd.Lg);break;case 3:ce(this,Yd.Jg);break;case 4:a=Yd.Eg;b=["0"];c=Zd[this.t][0]&7;if(0<c){b.push(".");for(var d=0;d<c;d++)b.push("0")}a=a.replace(/0.00/g,b.join(""));ce(this,a);break;case 5:de(this,1);break;case 6:de(this,2);break;
default:throw Error("Unsupported pattern type.");}else ce(this,a)}var ae=0,be=0;
function ce(a,b){b.replace(/ /g,"\u00a0");var c=[0];a.l=ee(a,b,c);for(var d=c[0],e=-1,f=0,g=0,k=0,l=-1,m=b.length,n=!0;c[0]<m&&n;c[0]++)switch(b.charAt(c[0])){case "#":0<g?k++:f++;0<=l&&0>e&&l++;break;case "0":if(0<k)throw Error('Unexpected "0" in pattern "'+b+'"');g++;0<=l&&0>e&&l++;break;case ",":l=0;break;case ".":if(0<=e)throw Error('Multiple decimal separators in pattern "'+b+'"');e=f+g+k;break;case "E":if(a.Z)throw Error('Multiple exponential symbols in pattern "'+b+'"');a.Z=!0;a.T=0;c[0]+1<
m&&"+"==b.charAt(c[0]+1)&&(c[0]++,a.Sa=!0);for(;c[0]+1<m&&"0"==b.charAt(c[0]+1);)c[0]++,a.T++;if(1>f+g||1>a.T)throw Error('Malformed exponential pattern "'+b+'"');n=!1;break;default:c[0]--,n=!1}0==g&&0<f&&0<=e&&(g=e,0==g&&g++,k=f-g,f=g-1,g=1);if(0>e&&0<k||0<=e&&(e<f||e>f+g)||0==l)throw Error('Malformed pattern "'+b+'"');k=f+g+k;a.j=0<=e?k-e:0;0<=e&&(a.h=f+g-e,0>a.h&&(a.h=0));a.g=(0<=e?e:k)-f;a.Z&&(a.N=f+a.g,0==a.j&&0==a.g&&(a.g=1));a.ea=Math.max(0,l);a.Ga=0==e||e==k;d=c[0]-d;a.G=ee(a,b,c);c[0]<b.length&&
b.charAt(c[0])==fe?(c[0]++,a.i=ee(a,b,c),c[0]+=d,a.o=ee(a,b,c)):(a.i=a.l+a.i,a.o+=a.G)}function de(a,b){a.p=b;ce(a,Yd.Df);a.h=0;a.j=2;if(0<a.h)throw Error("Can't combine significant digits and minimum fraction digits");a.na=2}
$d.prototype.parse=function(a,b){var c=b||[0];if(this.p!=be)throw Error("Parsing of compact numbers is unimplemented");var d=NaN;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.l,c[0])==c[0],f=a.indexOf(this.i,c[0])==c[0];e&&f&&(this.l.length>this.i.length?f=!1:this.l.length<this.i.length&&(e=!1));e?c[0]+=this.l.length:f&&(c[0]+=this.i.length);if(a.indexOf(Yd.ke,c[0])==c[0])c[0]+=Yd.ke.length,d=Infinity;else{var d=a,g=!1,k=!1,l=!1,m=1,n=Yd.Ef,p=Yd.Gf,r=Yd.Ff;if(this.p!=be)throw Error("Parsing of compact style numbers is not implemented");
for(var t="";c[0]<d.length;c[0]++){var x=d.charAt(c[0]),z=ge(x);if(0<=z&&9>=z)t+=z,l=!0;else if(x==n.charAt(0)){if(g||k)break;t+=".";g=!0}else if(x==p.charAt(0)&&("\u00a0"!=p.charAt(0)||c[0]+1<d.length&&0<=ge(d.charAt(c[0]+1)))){if(g||k)break}else if(x==r.charAt(0)){if(k)break;t+="E";k=!0}else if("+"==x||"-"==x)t+=x;else if(x==Yd.Hf.charAt(0)){if(1!=m)break;m=100;if(l){c[0]++;break}}else if(x==Yd.If.charAt(0)){if(1!=m)break;m=1E3;if(l){c[0]++;break}}else break}d=parseFloat(t)/m}if(e){if(a.indexOf(this.G,
c[0])!=c[0])return NaN;c[0]+=this.G.length}else if(f){if(a.indexOf(this.o,c[0])!=c[0])return NaN;c[0]+=this.o.length}return f?-d:d};function he(a,b){var c=Math.pow(10,a.j),d=0>=a.na?Math.round(b*c):Math.floor(ie(b*c,a.na,a.j)),e;isFinite(d)?(e=Math.floor(d/c),c=Math.floor(d-e*c)):(e=b,c=0);return{jg:e,Rg:c}}
function je(a,b,c,d){if(a.h>a.j)throw Error("Min value must be less than max value");b=he(a,b);var e=Math.pow(10,a.j),f=b.jg,g=b.Rg,k=0<a.h||0<g||!1;b=a.h;k&&(b=a.h);for(var l="",m=f;1E20<m;)l="0"+l,m=Math.round(m/10);var l=m+l,n=Yd.Ef,p=Yd.Gf,m=Yd.le.charCodeAt(0),r=l.length;if(0<f||0<c){for(f=r;f<c;f++)d.push(String.fromCharCode(m));for(f=0;f<r;f++)d.push(String.fromCharCode(m+1*l.charAt(f))),1<r-f&&0<a.ea&&1==(r-f)%a.ea&&d.push(p)}else k||d.push(String.fromCharCode(m));(a.Ga||k)&&d.push(n);a=""+
(g+e);for(c=a.length;"0"==a.charAt(c-1)&&c>b+1;)c--;for(f=1;f<c;f++)d.push(String.fromCharCode(m+1*a.charAt(f)))}function ke(a,b,c){c.push(Yd.Ff);0>b?(b=-b,c.push(Yd.Hg)):a.Sa&&c.push(Yd.Kg);b=""+b;for(var d=Yd.le,e=b.length;e<a.T;e++)c.push(d);c.push(b)}function ge(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Yd.le.charCodeAt(0);return b<=a&&a<b+10?a-b:-1}var fe=";";
function ee(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var g=b.charAt(c[0]);if("'"==g)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case fe:return d;case "\u00a4":if(c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1))c[0]++,d+=a.t;else switch(a.Rb){case ae:d+=Zd[a.t][1];break;case 2:var g=a.t,k=Zd[g],d=d+(g==k[1]?g:g+" "+k[1]);break;case 1:d+=Zd[a.t][2]}break;case "%":if(1!=a.H)throw Error("Too many percent/permill");a.H=100;d+=Yd.Hf;
break;case "\u2030":if(1!=a.H)throw Error("Too many percent/permill");a.H=1E3;d+=Yd.If;break;default:d+=g}}return d}var le={prefix:"",sg:"",ve:0};function me(a,b){var c=1==a.p?Wd.Dg:Wd.Cg;if(3>b)return le;b=Math.min(14,b);c=c[Math.pow(10,b)];if(!c)return le;c=c.other;return c&&"0"!=c?(c=/([^0]*)(0+)(.*)/.exec(c))?{prefix:c[1],sg:c[3],ve:b-(c[2].length-1)}:le:le}function ne(a){for(var b=0;1<=(a/=10);)b++;return b}
function ie(a,b,c){if(!a)return a;b=b-ne(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};function oe(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"}var pe=oe,pe=oe;function qe(a){return 1==a?"one":"other"}var re=qe,re=qe;function se(a){this.g=[];this.i=[];this.j=new $d(1);a&&(a=te(this,a),this.i=ue(this,a))}var ve=RegExp("'([{}#].*?)'","g"),we=RegExp("''","g");
function xe(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var g=b[f].value,k=a,l=e,m=c[g];s(m)?(k.g.push(m),l.push(k.h(k.g))):l.push("Undefined parameter - "+g);break;case 2:g=b[f].value;k=e;l=g.ld;s(c[l])?(l=g[c[l]],s(l)||(l=g.other),xe(a,l,c,d,k)):k.push("Undefined parameter - "+l);break;case 0:g=b[f].value;ye(a,g,c,re,d,e);break;case 1:g=b[f].value;ye(a,g,c,pe,d,e);break;default:Oa("Unrecognized block type.")}}
function ye(a,b,c,d,e,f){var g=b.ld,k=b.Nf,l=+c[g];if(isNaN(l))f.push("Undefined or invalid parameter - "+g);else if(k=l-k,g=b[c[g]],s(g)||(d=d(k),g=b[d],s(g)||(g=b.other)),b=[],xe(a,g,c,e,b),c=b.join(""),e)f.push(c);else{a=a.j;if(isNaN(k))a=Yd.Ig;else{e=[];g=d=k;a.p==be?b=le:(d=Math.abs(d),g=Math.abs(g),b=me(a,1>=d?0:ne(d)).ve,he(a,g/Math.pow(10,b)),d=he(a,d/Math.pow(10,b)),b=me(a,b+ne(d.jg)));k/=Math.pow(10,b.ve);e.push(b.prefix);d=0>k||0==k&&0>1/k;e.push(d?a.i:a.l);if(isFinite(k))if(k=k*(d?-1:
1)*a.H,a.Z)if(0==k)je(a,k,a.g,e),ke(a,0,e);else{g=Math.log(k)/Math.log(10);g=Math.floor(g+2E-15);k/=Math.pow(10,g);l=a.g;if(1<a.N&&a.N>a.g){for(;0!=g%a.N;)k*=10,g--;l=1}else 1>a.g?(g++,k/=10):(g-=a.g-1,k*=Math.pow(10,a.g-1));je(a,k,l,e);ke(a,g,e)}else je(a,k,a.g,e);else e.push(Yd.ke);e.push(d?a.o:a.G);e.push(b.sg);a=e.join("")}f.push(c.replace(/#/g,a))}}
function te(a,b){var c=a.g,d=oa(a.h,a);b=b.replace(we,function(){c.push("'");return d(c)});return b=b.replace(ve,function(a,b){c.push(b);return d(c)})}function ze(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,g),d.push(f),b=g+1)):(0==c.length&&(b=a.substring(b,g),""!=b&&d.push({type:0,value:b}),b=g+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d}
var Ae=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Be=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Ce=/^\s*(\w+)\s*,\s*select\s*,/;
function ue(a,b){for(var c=[],d=ze(b),e=0;e<d.length;e++){var f={};if(0==d[e].type)f.type=4,f.value=d[e].value;else if(1==d[e].type){var g=d[e].value;switch(Ae.test(g)?0:Be.test(g)?1:Ce.test(g)?2:/^\s*\w+\s*/.test(g)?3:5){case 2:f.type=2;f.value=De(a,d[e].value);break;case 0:f.type=0;f.value=Ee(a,d[e].value);break;case 1:f.type=1;f.value=Fe(a,d[e].value);break;case 3:f.type=3;f.value=d[e].value;break;default:Oa("Unknown block type.")}}else Oa("Unknown part of the pattern.");c.push(f)}return c}
function De(a,b){var c="";b=b.replace(Ce,function(a,b){c=b;return""});var d={};d.ld=c;for(var e=ze(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=ue(a,e[f].value);else Oa("Expected block type.");d[g.replace(/\s/g,"")]=k;f++}return d}
function Ee(a,b){var c="",d=0;b=b.replace(Ae,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.ld=c;e.Nf=d;for(var f=ze(b),g=0;g<f.length;){var k=f[g].value;g++;if(1==f[g].type)var l=ue(a,f[g].value);else Oa("Expected block type.");e[k.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=l;g++}return e}
function Fe(a,b){var c="";b=b.replace(Be,function(a,b){c=b;return""});var d={};d.ld=c;d.Nf=0;for(var e=ze(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=ue(a,e[f].value);else Oa("Expected block type.");d[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return d}se.prototype.h=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};function Ge(a,b,c){a=new se(a);b={COUNT:b,TEXT:c};if(0==a.i.length)a="";else{c=[];xe(a,a.i,b,!1,c);for(b=c.join("");0<a.g.length;)b=b.replace(a.h(a.g),a.g.pop());a=b}return a};function He(a){this.g=new od;if(a){a=hd(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])}}function Ie(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+ia(a):b.substr(0,1)+a}h=He.prototype;h.ca=function(){return this.g.ca()};h.add=function(a){this.g.set(Ie(a),a)};h.removeAll=function(a){a=hd(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};h.remove=function(a){return this.g.remove(Ie(a))};h.clear=function(){this.g.clear()};h.Ka=function(){return this.g.Ka()};
h.contains=function(a){a=Ie(a);return qd(this.g.h,a)};h.xa=function(){return this.g.xa()};h.ga=function(){return new He(this)};h.Fb=function(){return this.g.Fb(!1)};function Je(a){return Ke(a||arguments.callee.caller,[])}
function Ke(a,b){var c=[];if(Ya(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Le(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Le(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Ke(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Le(a){if(Me[a])return Me[a];a=String(a);if(!Me[a]){var b=/function ([^\(]+)/.exec(a);Me[a]=b?b[1]:"[Anonymous]"}return Me[a]}var Me={};function Ne(a,b,c,d,e){this.o="number"==typeof e?e:Oe++;this.l=d||A();this.j=a;this.p=b;this.h=c;delete this.i;delete this.g}Ne.prototype.o=0;Ne.prototype.i=null;Ne.prototype.g=null;var Oe=0;Ne.prototype.getMessage=function(){return this.p};function Pe(a){this.l=a}Pe.prototype.i=null;Pe.prototype.h=null;Pe.prototype.j=null;Pe.prototype.g=null;function Qe(a,b){this.name=a;this.value=b}Qe.prototype.toString=function(){return this.name};var Re=new Qe("SHOUT",1200),Se=new Qe("SEVERE",1E3),Te=new Qe("WARNING",900),Ue=new Qe("INFO",800),Ve=new Qe("CONFIG",700),We=new Qe("FINE",500),Xe=new Qe("FINER",400),Ye=new Qe("FINEST",300),Ze=[new Qe("OFF",Infinity),Re,Se,Te,Ue,Ve,We,Xe,Ye,new Qe("ALL",0)],$e=null;h=Pe.prototype;h.getName=function(){return this.l};
function af(a,b){a.g||(a.g=[]);a.g.push(b)}h.getParent=function(){return this.i};h.getChildren=function(){this.j||(this.j={});return this.j};function bf(a){if(a.h)return a.h;if(a.i)return bf(a.i);Oa("Root logger has no level set.");return null}
h.log=function(a,b,c){if(a.value>=bf(this).value)for(ha(b)&&(b=b()),a=this.Ug(a,b,c),b="log:"+a.getMessage(),q.console&&(q.console.timeStamp?q.console.timeStamp(b):q.console.markTimeline&&q.console.markTimeline(b)),q.msWriteProfilerMark&&q.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.g)for(var e=0,f=void 0;f=c.g[e];e++)f(d);b=b.getParent()}};
h.Ug=function(a,b,c){var d=new Ne(a,String(b),this.l);if(c){d.i=c;var e;var f=arguments.callee.caller;try{var g;var k=ba("window.location.href");if(v(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var l,m,n=!1;try{l=c.lineNumber||c.ki||"Not available"}catch(p){l="Not available",n=!0}try{m=c.fileName||c.filename||c.sourceURL||q.$googDebugFname||k}catch(r){m="Not available",n=!0}g=!n&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||
"Not available",name:c.name||"UnknownError",lineNumber:l,fileName:m,stack:c.stack||"Not available"}}e="Message: "+Aa(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+Aa(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+Aa(Je(f)+"-> ")}catch(t){e="Exception trying to expose exception! You win, we lose. "+t}d.g=e}return d};function L(a,b,c){a.log(Te,b,c)}h.info=function(a,b){this.log(Ue,a,b)};
function M(a,b,c){a.log(We,b,c)}function N(a,b){a.log(Xe,b,void 0)}function O(a,b){a.log(Ye,b,void 0)}var cf={},df=null;function ef(){df||(df=new Pe(""),cf[""]=df,df.h=Ve)}function ff(){ef();return df}function P(a){ef();var b;if(!(b=cf[a])){b=new Pe(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=P(a.substr(0,c));c.getChildren()[d]=b;b.i=c;cf[a]=b}return b};function gf(a){vb.call(this);this.h=a;this.g={}}B(gf,vb);var hf=[];h=gf.prototype;h.listen=function(a,b,c,d){u(b)||(hf[0]=b,b=hf);for(var e=0;e<b.length;e++){var f=Bc(a,b[e],c||this.handleEvent,d||!1,this.h||this);if(!f)break;this.g[f.key]=f}return this};h.Ca=function(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)this.Ca(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.h||this,c=Cc(c),d=!!d,b=ec(a)?xc(a.nb,String(b),c,d,e):a?(a=Ec(a))?xc(a,b,c,d,e):null:null,b&&(Jc(b),delete this.g[b.key]);return this};
h.removeAll=function(){ic(this.g,Jc);this.g={}};h.J=function(){gf.m.J.call(this);this.removeAll()};h.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function jf(a,b){Nc.call(this);this.h=a||1;this.g=b||q;this.i=oa(this.Kh,this);this.j=A()}B(jf,Nc);h=jf.prototype;h.Pc=!1;h.da=null;h.setInterval=function(a){this.h=a;this.da&&this.Pc?(this.stop(),kf(this)):this.da&&this.stop()};h.Kh=function(){if(this.Pc){var a=A()-this.j;0<a&&a<0.8*this.h?this.da=this.g.setTimeout(this.i,this.h-a):(this.da&&(this.g.clearTimeout(this.da),this.da=null),this.dispatchEvent(lf),this.Pc&&(this.da=this.g.setTimeout(this.i,this.h),this.j=A()))}};
function kf(a){a.Pc=!0;a.da||(a.da=a.g.setTimeout(a.i,a.h),a.j=A())}h.stop=function(){this.Pc=!1;this.da&&(this.g.clearTimeout(this.da),this.da=null)};h.J=function(){jf.m.J.call(this);this.stop();delete this.g};var lf="tick";function mf(a,b,c){if(ha(a))c&&(a=oa(a,c));else if(a&&"function"==typeof a.handleEvent)a=oa(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:q.setTimeout(a,b||0)};function nf(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return JSON.parse(a)}catch(b){}throw Error("Invalid JSON string: "+a);}function of(){}function pf(a,b){var c=[];qf(a,b,c);return c.join("")}
function qf(a,b,c){switch(typeof b){case "string":rf(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(u(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),qf(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),rf(e,c),c.push(":"),qf(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var sf={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},tf=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function rf(a,b){b.push('"',a.replace(tf,function(a){if(a in sf)return sf[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return sf[a]=e+b.toString(16)}),'"')};function uf(a,b){a&&M(a,b,void 0)};function vf(){}vf.prototype.g=null;function wf(a){var b;(b=a.g)||(b={},xf(a)&&(b[0]=!0,b[1]=!0),b=a.g=b);return b};var yf;function zf(){}B(zf,vf);function Af(a){return(a=xf(a))?new ActiveXObject(a):new XMLHttpRequest}function xf(a){if(!a.h&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.h=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.h}yf=new zf;function Bf(a){Nc.call(this);this.headers=new od;this.ea=a||null;this.h=!1;this.Z=this.S=null;this.Sa=this.t="";this.o=0;this.p="";this.i=this.Ga=this.G=this.na=!1;this.l=0;this.N=null;this.j=Cf;this.T=this.fd=!1}B(Bf,Nc);var Cf="";Bf.prototype.g=P("goog.net.XhrIo");var Df=/^https?$/i,Ef=["POST","PUT"];h=Bf.prototype;h.Yf=function(){return this.j};
h.send=function(a,b,c,d){if(this.S)throw Error("[goog.net.XhrIo] Object is active with another request="+this.t+"; newUri="+a);b=b?b.toUpperCase():"GET";this.t=a;this.p="";this.o=0;this.Sa=b;this.na=!1;this.h=!0;this.S=this.ea?Af(this.ea):Af(yf);this.Z=this.ea?wf(this.ea):wf(yf);this.S.onreadystatechange=oa(this.og,this);try{uf(this.g,Ff(this,"Opening Xhr")),this.Ga=!0,this.S.open(b,a,!0),this.Ga=!1}catch(e){uf(this.g,Ff(this,"Error opening Xhr: "+e.message));Gf(this,e);return}a=c||"";var f=this.headers.ga();
d&&id(d,function(a,b){f.set(b,a)});d=Wa(f.Ma(),Hf);c=q.FormData&&a instanceof q.FormData;!Ya(Ef,b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");id(f,function(a,b){this.S.setRequestHeader(b,a)},this);this.j&&(this.S.responseType=this.j);"withCredentials"in this.S&&(this.S.withCredentials=this.fd);try{If(this),0<this.l&&(this.T=Jf(this.S),uf(this.g,Ff(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.T)),this.T?(this.S.timeout=this.l,this.S.ontimeout=oa(this.tg,
this)):this.N=mf(this.tg,this.l,this)),uf(this.g,Ff(this,"Sending request")),this.G=!0,this.S.send(a),this.G=!1}catch(g){uf(this.g,Ff(this,"Send error: "+g.message)),Gf(this,g)}};function Jf(a){return F&&Ub(9)&&w(a.timeout)&&s(a.ontimeout)}function Hf(a){return"content-type"==a.toLowerCase()}h.tg=function(){"undefined"!=typeof aa&&this.S&&(this.p="Timed out after "+this.l+"ms, aborting",this.o=8,uf(this.g,Ff(this,this.p)),this.dispatchEvent("timeout"),this.abort(8))};
function Gf(a,b){a.h=!1;a.S&&(a.i=!0,a.S.abort(),a.i=!1);a.p=b;a.o=5;Kf(a);Lf(a)}function Kf(a){a.na||(a.na=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}h.abort=function(a){this.S&&this.h&&(uf(this.g,Ff(this,"Aborting")),this.h=!1,this.i=!0,this.S.abort(),this.i=!1,this.o=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Lf(this))};h.J=function(){this.S&&(this.h&&(this.h=!1,this.i=!0,this.S.abort(),this.i=!1),Lf(this,!0));Bf.m.J.call(this)};
h.og=function(){this.H||(this.Ga||this.G||this.i?Mf(this):this.Fh())};h.Fh=function(){Mf(this)};function Mf(a){if(a.h&&"undefined"!=typeof aa)if(a.Z[1]&&4==Nf(a)&&2==a.O())uf(a.g,Ff(a,"Local request error detected and ignored"));else if(a.G&&4==Nf(a))mf(a.og,0,a);else if(a.dispatchEvent("readystatechange"),4==Nf(a)){uf(a.g,Ff(a,"Request complete"));a.h=!1;try{a.Aa()?(a.dispatchEvent("complete"),a.dispatchEvent("success")):(a.o=6,a.p=a.Ha()+" ["+a.O()+"]",Kf(a))}finally{Lf(a)}}}
function Lf(a,b){if(a.S){If(a);var c=a.S,d=a.Z[0]?ca:null;a.S=null;a.Z=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){(c=a.g)&&c.log(Se,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function If(a){a.S&&a.T&&(a.S.ontimeout=null);w(a.N)&&(q.clearTimeout(a.N),a.N=null)}
h.Aa=function(){var a=this.O(),b;a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}if(!b){if(a=0===a)a=sd(String(this.t))[1]||null,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),a=!Df.test(a?a.toLowerCase():"");b=a}return b};function Nf(a){return a.S?a.S.readyState:0}h.O=function(){try{return 2<Nf(this)?this.S.status:-1}catch(a){var b=this.g;b&&L(b,"Can not get status: "+a.message,void 0);return-1}};
h.Ha=function(){try{return 2<Nf(this)?this.S.statusText:""}catch(a){return uf(this.g,"Can not get status: "+a.message),""}};
function Of(a){try{if(!a.S)return null;if("response"in a.S)return a.S.response;switch(a.j){case Cf:case "text":return a.S.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.S)return a.S.mozResponseArrayBuffer}var b=a.g;b&&b.log(Se,"Response type "+a.j+" is not supported on this browser",void 0);return null}catch(c){return uf(a.g,"Can not get response: "+c.message),null}}function Ff(a,b){return b+" ["+a.Sa+" "+a.t+" "+a.O()+"]"};function Pf(){this.i=this.h=0;this.g=[]}function Qf(a){if(a.h!=a.i){var b=a.g[a.h];delete a.g[a.h];a.h++;return b}}h=Pf.prototype;h.ca=function(){return this.i-this.h};h.Ka=function(){return 0==this.i-this.h};h.clear=function(){this.i=this.h=this.g.length=0};h.contains=function(a){return Ya(this.g,a)};h.remove=function(a){a=Qa(this.g,a);if(0>a)return!1;a==this.h?Qf(this):(ab(this.g,a),this.i--);return!0};h.xa=function(){return this.g.slice(this.h,this.i)};function Rf(a,b){vb.call(this);this.o=a||0;this.i=b||10;if(this.o>this.i)throw Error(Sf);this.g=new Pf;this.h=new He;this.l=null;this.jd()}B(Rf,vb);var Sf="[goog.structs.Pool] Min can not be greater than max";h=Rf.prototype;h.Bd=function(){var a=A();if(!(null!=this.l&&0>a-this.l)){for(var b;0<this.g.ca()&&(b=Qf(this.g),!this.lf(b));)this.jd();!b&&this.ca()<this.i&&(b=this.Ie());b&&(this.l=a,this.h.add(b));return b}};h.Td=function(a){return this.h.remove(a)?(this.me(a),!0):!1};
h.me=function(a){this.h.remove(a);if(this.lf(a)&&this.ca()<this.i){var b=this.g;b.g[b.i++]=a}else Tf(a)};h.jd=function(){for(var a=this.g;this.ca()<this.o;){var b=this.Ie();a.g[a.i++]=b}for(;this.ca()>this.i&&0<this.g.ca();)Tf(Qf(a))};h.Ie=function(){return{}};function Tf(a){if("function"==typeof a.qa)a.qa();else for(var b in a)a[b]=null}h.lf=function(a){return"function"==typeof a.Og?a.Og():!0};h.contains=function(a){return this.g.contains(a)||this.h.contains(a)};
h.ca=function(){return this.g.ca()+this.h.ca()};h.Ka=function(){return this.g.Ka()&&this.h.Ka()};h.J=function(){Rf.m.J.call(this);if(0<this.h.ca())throw Error("[goog.structs.Pool] Objects not released");delete this.h;for(var a=this.g;!a.Ka();)Tf(Qf(a));delete this.g};function Uf(a,b){this.g=a;this.h=b}Uf.prototype.V=function(){return this.h};Uf.prototype.ga=function(){return new Uf(this.g,this.h)};function Vf(a){this.g=[];if(a)a:{var b,c;if(a instanceof Vf){if(b=a.Ma(),c=a.xa(),0>=a.ca()){a=this.g;for(var d=0;d<b.length;d++)a.push(new Uf(b[d],c[d]));break a}}else b=kc(a),c=jc(a);for(d=0;d<b.length;d++)Wf(this,b[d],c[d])}}function Wf(a,b,c){var d=a.g;d.push(new Uf(b,c));b=d.length-1;a=a.g;for(c=a[b];0<b;)if(d=b-1>>1,a[d].g>c.g)a[b]=a[d],b=d;else break;a[b]=c}h=Vf.prototype;
h.remove=function(){var a=this.g,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Za(a);else{a[0]=a.pop();for(var a=0,b=this.g,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,g=2*a+2,f=g<d&&b[g].g<b[f].g?g:f;if(b[f].g>e.g)break;b[a]=b[f];a=f}b[a]=e}return c.V()}};h.xa=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].V());return b};h.Ma=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].g);return b};h.ga=function(){return new Vf(this)};h.ca=function(){return this.g.length};
h.Ka=function(){return 0==this.g.length};h.clear=function(){Za(this.g)};function Xf(){Vf.call(this)}B(Xf,Vf);function Yf(a,b){this.j=new Xf;Rf.call(this,a,b)}B(Yf,Rf);h=Yf.prototype;h.Bd=function(a,b){if(!a)return Yf.m.Bd.call(this);Wf(this.j,s(b)?b:100,a);this.Ze()};h.Ze=function(){for(var a=this.j;0<a.ca();){var b=this.Bd();if(b)a.remove().apply(this,[b]);else break}};h.me=function(a){Yf.m.me.call(this,a);this.Ze()};h.jd=function(){Yf.m.jd.call(this);this.Ze()};h.J=function(){Yf.m.J.call(this);q.clearTimeout(void 0);this.j.clear();this.j=null};function Zf(a,b,c){Yf.call(this,b,c);this.p=a}B(Zf,Yf);Zf.prototype.Ie=function(){var a=new Bf,b=this.p;b&&id(b,function(b,d){a.headers.set(d,b)});return a};Zf.prototype.lf=function(a){return!a.H&&!a.S};function $f(a,b,c,d,e){Nc.call(this);this.i=s(a)?a:1;this.j=s(e)?Math.max(0,e):0;this.Dc=new Zf(b,c,d);this.g=new od;this.h=new gf(this)}B($f,Nc);var ag="ready complete success error abort timeout".split(" ");h=$f.prototype;h.send=function(a,b,c,d,e,f,g,k,l){if(this.g.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new bg(b,oa(this.lh,this,a),c,d,e,g,s(k)?k:this.i,l);this.g.set(a,b);a=oa(this.dh,this,a);this.Dc.Bd(a,f);return b};
h.abort=function(a,b){var c=this.g.get(a);if(c){var d=c.be;c.Kf=!0;b&&(d&&(this.h.Ca(d,ag,c.ae),Hc(d,"ready",function(){this.Dc.Td(d)},!1,this)),this.g.remove(a));d&&d.abort()}};h.dh=function(a,b){var c=this.g.get(a);c&&!c.be?(this.h.listen(b,ag,c.ae),b.l=Math.max(0,this.j),b.j=c.Yf(),c.be=b,this.dispatchEvent(new cg("ready",this,a,b)),dg(this,a,b),c.Kf&&b.abort()):this.Dc.Td(b)};
h.lh=function(a,b){var c=b.target;switch(b.type){case "ready":dg(this,a,c);break;case "complete":a:{var d=this.g.get(a);if(7==c.o||c.Aa()||d.md>d.Ge)if(this.dispatchEvent(new cg("complete",this,a,c)),d&&(d.Tf=!0,d.se)){c=d.se.call(c,b);break a}c=null}return c;case "success":this.dispatchEvent(new cg("success",this,a,c));break;case "timeout":case "error":d=this.g.get(a);d.md>d.Ge&&this.dispatchEvent(new cg("error",this,a,c));break;case "abort":this.dispatchEvent(new cg("abort",this,a,c))}return null};
function dg(a,b,c){var d=a.g.get(b);!d||d.Tf||d.md>d.Ge?(d&&(a.h.Ca(c,ag,d.ae),a.g.remove(b)),a.Dc.Td(c)):(d.md++,c.send(d.Mh,d.zd(),d.oa(),d.Nc()))}h.J=function(){$f.m.J.call(this);this.Dc.qa();this.Dc=null;this.h.qa();this.h=null;var a=this.g;id(a,function(a){a.qa()});a.clear();this.g=null};function cg(a,b,c,d){H.call(this,a,b);this.id=c;this.be=d}B(cg,H);
function bg(a,b,c,d,e,f,g,k){vb.call(this);this.Mh=a;this.i=c||"GET";this.g=d;this.h=e||null;this.Ge=s(g)?g:1;this.md=0;this.Kf=this.Tf=!1;this.ae=b;this.se=f;this.j=k||Cf;this.be=null}B(bg,vb);h=bg.prototype;h.zd=function(){return this.i};h.oa=function(){return this.g};h.Nc=function(){return this.h};h.Yf=function(){return this.j};h.J=function(){bg.m.J.call(this);delete this.ae;delete this.se};function eg(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b};function fg(){this.i=[];this.h=this.g=0};function gg(){};function hg(){this.g=[];this.j=[];this.o=[];this.i=[];this.i[0]=128;for(var a=1;64>a;++a)this.i[a]=0;this.g[0]=1732584193;this.g[1]=4023233417;this.g[2]=2562383102;this.g[3]=271733878;this.g[4]=3285377520;this.l=this.h=0}B(hg,gg);
function ig(a,b,c){c||(c=0);var d=a.o;if(v(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.g[0];c=a.g[1];for(var g=a.g[2],k=a.g[3],l=a.g[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.g[0]=a.g[0]+b&4294967295;a.g[1]=a.g[1]+c&4294967295;a.g[2]=a.g[2]+g&4294967295;a.g[3]=a.g[3]+k&4294967295;a.g[4]=a.g[4]+l&4294967295}
hg.prototype.update=function(a,b){s(b)||(b=a.length);for(var c=b-64,d=0,e=this.j,f=this.h;d<b;){if(0==f)for(;d<=c;)ig(this,a,d),d+=64;if(v(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){ig(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){ig(this,e);f=0;break}}this.h=f;this.l+=b};
function jg(a){var b=[],c=8*a.l;56>a.h?a.update(a.i,56-a.h):a.update(a.i,64-(a.h-56));for(var d=63;56<=d;d--)a.j[d]=c&255,c/=256;ig(a,a.j);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.g[d]>>e&255,++c;return b};var kg=null,lg=null;function mg(a){this.g=a;this.h=new of}mg.prototype.set=function(a,b){s(b)?this.g.set(a,pf(this.h,b)):this.g.remove(a)};mg.prototype.get=function(a){var b;try{b=this.g.get(a)}catch(c){return}if(null!==b)try{return nf(b)}catch(d){throw"Storage: Invalid value was encountered";}};mg.prototype.remove=function(a){this.g.remove(a)};function ng(){};function og(a){mg.call(this,a)}B(og,mg);function pg(a){this.data=a}function qg(a){return!s(a)||a instanceof pg?a:new pg(a)}function rg(a){a=a.data;if(!s(a))throw"Storage: Invalid value was encountered";return a}og.prototype.set=function(a,b){og.m.set.call(this,a,qg(b))};og.prototype.Oc=function(a){a=og.m.get.call(this,a);if(!s(a)||a instanceof Object)return a;throw"Storage: Invalid value was encountered";};og.prototype.get=function(a){return(a=this.Oc(a))?rg(a):void 0};function sg(a){mg.call(this,a)}B(sg,og);sg.prototype.set=function(a,b,c){if(b=qg(b)){if(c){if(c<A()){sg.prototype.remove.call(this,a);return}b.expiration=c}b.creation=A()}sg.m.set.call(this,a,b)};sg.prototype.Oc=function(a,b){var c=sg.m.Oc.call(this,a);if(c){var d;if(d=!b){d=c.creation;var e=c.expiration;d=!!e&&e<A()||!!d&&d>A()}if(d)sg.prototype.remove.call(this,a);else return c}};function tg(a){mg.call(this,a)}B(tg,sg);function ug(){}B(ug,ng);ug.prototype.ca=function(){var a=0;md(this.Fb(!0),function(){a++});return a};ug.prototype.clear=function(){var a=nd(this.Fb(!0)),b=this;Ra(a,function(a){b.remove(a)})};function vg(a,b){mg.call(this,a);this.He=eg(b);this.Rf=new of}B(vg,tg);h=vg.prototype;h.He=null;h.Rf=null;
function wg(a,b){var c=new hg;c.update(eg(b));c.update(a.He);c=jg(c);if(!fa(c))throw Error("encodeByteArray takes an array as a parameter");if(!kg){kg={};lg={};for(var d=0;65>d;d++)kg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d),lg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(d)}for(var d=lg,e=[],f=0;f<c.length;f+=3){var g=c[f],k=f+1<c.length,l=k?c[f+1]:0,m=f+2<c.length,n=m?c[f+2]:0,p=g>>2,g=(g&3)<<4|l>>4,l=(l&15)<<2|n>>6,n=n&63;
m||(n=64,k||(l=64));e.push(d[p],d[g],d[l],d[n])}return e.join("")}
function xg(a,b,c,d){if(!(0<b.length))throw Error("Non-empty salt must be provided");var e=new hg;e.update(eg(c));e.update(b);e.update(a.He);a=new fg;var e=jg(e),f;f||(f=e.length);b=a.i;for(c=0;256>c;++c)b[c]=c;var g=0;for(c=0;256>c;++c){var g=g+b[c]+e[c%f]&255,k=b[c];b[c]=b[g];b[g]=k}a.g=0;a.h=0;f=a.g;e=a.h;b=a.i;for(c=0;1536>c;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=g;a.g=f;a.h=e;d=eg(d);var l;l||(l=d.length);f=a.g;e=a.h;b=a.i;for(c=0;c<l;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=
g,d[c]^=b[b[f]+b[e]&255];a.g=f;a.h=e;return String.fromCharCode.apply(null,d)}h.set=function(a,b,c){if(s(b)){for(var d=[],e=0;8>e;++e)d[e]=Math.floor(256*Math.random());b=new pg(xg(this,d,a,pf(this.Rf,b)));b.salt=d;vg.m.set.call(this,wg(this,a),b,c)}else vg.prototype.remove.call(this,a)};
h.Oc=function(a,b){var c=vg.m.Oc.call(this,wg(this,a),b);if(c){var d=rg(c),e=c.salt;if(!v(d)||!u(e)||!e.length)throw"Storage: Invalid value was encountered";d=xg(this,e,a,d);try{c.data=nf(d)}catch(f){throw"Storage: The value could not be decrypted";}return c}};h.remove=function(a){vg.m.remove.call(this,wg(this,a))};function yg(a){this.g=a}B(yg,ug);h=yg.prototype;h.set=function(a,b){try{this.g.setItem(a,b)}catch(c){if(0==this.g.length)throw"Storage mechanism: Storage disabled";throw"Storage mechanism: Quota exceeded";}};h.get=function(a){a=this.g.getItem(a);if(!v(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return a};h.remove=function(a){this.g.removeItem(a)};h.ca=function(){return this.g.length};
h.Fb=function(a){var b=0,c=this.g,d=new kd;d.g=function(){if(b>=c.length)throw jd;var d=c.key(b++);if(a)return d;d=c.getItem(d);if(!v(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};h.clear=function(){this.g.clear()};h.key=function(a){return this.g.key(a)};function zg(){var a=null;try{a=window.localStorage||null}catch(b){}this.g=a}B(zg,yg);var Ag=!F||F&&9<=Wb,Bg=!Ib&&!F||F&&F&&9<=Wb||Ib&&Ub("1.9.1"),Cg=F&&!Ub("9");function Dg(a){a=a.className;return v(a)&&a.match(/\S+/g)||[]}function Eg(a,b){for(var c=Dg(a),d=fb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)Ya(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function Fg(a,b){var c=Dg(a),d=fb(arguments,1),e=Gg(c,d);a.className=e.join(" ");return e.length==c.length-d.length}function Gg(a,b){return Sa(a,function(a){return!Ya(b,a)})};function Hg(a,b){this.x=s(a)?a:0;this.y=s(b)?b:0}Hg.prototype.ga=function(){return new Hg(this.x,this.y)};Hg.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Ig(a,b){return new Hg(a.x-b.x,a.y-b.y)}Hg.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};Hg.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function Jg(a,b){this.width=a;this.height=b}h=Jg.prototype;h.ga=function(){return new Jg(this.width,this.height)};h.toString=function(){return"("+this.width+" x "+this.height+")"};h.Ka=function(){return!(this.width*this.height)};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Kg(a){return a?new Lg(Mg(a)):sa||(sa=new Lg)}function Ng(a,b){var c=b||document,d=null;c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):(c=b||document,d=(c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):Og(document,"*",a,b))[0]);return d||null}
function Og(a,b,c,d){a=d||a;b=b&&"*"!=b?b.toUpperCase():"";if(a.querySelectorAll&&a.querySelector&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){d={};for(var e=0,f=0,g;g=a[f];f++)b==g.nodeName&&(d[e++]=g);d.length=e;return d}return a}a=a.getElementsByTagName(b||"*");if(c){d={};for(f=e=0;g=a[f];f++)b=g.className,"function"==typeof b.split&&Ya(b.split(/\s+/),c)&&(d[e++]=g);d.length=e;return d}return a}
function Pg(a,b){ic(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Qg?a.setAttribute(Qg[d],b):ta(d,"aria-")||ta(d,"data-")?a.setAttribute(d,b):a[d]=b})}var Qg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Rg(a){return Jb||"CSS1Compat"!=a.compatMode?a.body||a.documentElement:a.documentElement}function Sg(a){return a.parentWindow||a.defaultView}function Tg(a,b,c){function d(c){c&&b.appendChild(v(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!fa(f)||y(f)&&0<f.nodeType?d(f):Ra(Ug(f)?cb(f):f,d)}}function Vg(a){for(var b;b=a.firstChild;)a.removeChild(b)}function Wg(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)}function Xg(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function Yg(a){if(void 0!=a.firstElementChild)a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Zg(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Mg(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function $g(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else Vg(a),a.appendChild(Mg(a).createTextNode(String(b)))}var ah={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},bh={IMG:" ",BR:"\n"};function ch(a){a=a.getAttributeNode("tabindex");return null!=a&&a.specified}function dh(a){a=a.tabIndex;return w(a)&&0<=a&&32768>a}
function eh(a){var b=[];fh(a,b,!1);return b.join("")}function fh(a,b,c){if(!(a.nodeName in ah))if(3==a.nodeType)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in bh)b.push(bh[a.nodeName]);else for(a=a.firstChild;a;)fh(a,b,c),a=a.nextSibling}function Ug(a){if(a&&"number"==typeof a.length){if(y(a))return"function"==typeof a.item||"string"==typeof a.item;if(ha(a))return"function"==typeof a.item}return!1}
function gh(a,b,c){if(!b&&!c)return null;var d=b?b.toUpperCase():null;return hh(a,function(a){var b;if(b=!d||a.nodeName==d)(b=!c)||(b=Ya(Dg(a),c));return b})}function ih(a){return gh(a,null,"sidebar")}function hh(a,b){for(var c=0;a;){if(b(a))return a;a=a.parentNode;c++}return null}function Lg(a){this.g=a||q.document||document}h=Lg.prototype;h.n=function(a){return v(a)?this.g.getElementById(a):a};
h.s=function(a,b,c){var d=this.g,e=arguments,f=e[0],g=e[1];if(!Ag&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',Aa(g.name),'"');if(g.type){f.push(' type="',Aa(g.type),'"');var k={};rc(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=d.createElement(f);g&&(v(g)?f.className=g:u(g)?Eg.apply(null,[f].concat(g)):Pg(f,g));2<e.length&&Tg(d,f,e);return f};h.createElement=function(a){return this.g.createElement(a)};function jh(a){return"CSS1Compat"==a.g.compatMode}
function kh(a){var b=a.g;a=Rg(b);b=Sg(b);return F&&Ub("10")&&b.pageYOffset!=a.scrollTop?new Hg(a.scrollLeft,a.scrollTop):new Hg(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}h.appendChild=function(a,b){a.appendChild(b)};h.Bh=Wg;h.getChildren=function(a){return Bg&&void 0!=a.children?a.children:Sa(a.childNodes,function(a){return 1==a.nodeType})};h.Xf=Yg;h.contains=Zg;F&&Ub(8);function lh(a,b,c){vb.call(this);this.h=a;this.o=b||0;this.i=c;this.l=oa(this.j,this)}B(lh,vb);lh.prototype.g=0;lh.prototype.J=function(){lh.m.J.call(this);this.stop();delete this.h;delete this.i};function mh(a){a.stop();a.g=mf(a.l,s(void 0)?void 0:a.o)}lh.prototype.stop=function(){0!=this.g&&q.clearTimeout(this.g);this.g=0};function nh(a){a.stop();a.j()}lh.prototype.j=function(){this.g=0;this.h&&this.h.call(this.i)};function oh(a,b,c){vb.call(this);this.j=a;this.i=b;this.h=c;this.g=oa(this.Hh,this)}B(oh,vb);h=oh.prototype;h.Yd=!1;h.da=null;function ph(a){a.da?a.Yd=!0:qh(a)}h.stop=function(){this.da&&(q.clearTimeout(this.da),this.da=null,this.Yd=!1)};h.J=function(){oh.m.J.call(this);this.stop()};h.Hh=function(){this.da=null;this.Yd&&(this.Yd=!1,qh(this))};function qh(a){a.da=mf(a.g,a.i);a.j.call(a.h)};P("ydn");var rh=Math.pow(2,3),sh=Math.pow(2,6);function th(){Nc.call(this);this.key=this.g=void 0}B(th,Nc);th.prototype.U=function(a,b){if("boolean"!=typeof b)throw Error("Invalid value");if("number"!=typeof a||0>a)throw Error("Invalid state");"undefined"==typeof this.g&&(this.g=0);this.g=b?this.g|a:this.g&~a};function uh(a){a.U(rh,!0);mf(function(){this.dispatchEvent(vh)},0,a)}var vh="a";function wh(a,b,c){H.call(this,a,b);this.url=c}B(wh,H);P("ydn");function xh(a){return!v(a)||wa(a)?{}:JSON.parse(a)}function yh(a){var b;try{b=zh(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function zh(a){return JSON.stringify(a,void 0,void 0)};P("ydn.Store");function Ah(a,b){if(b&&!a)throw Error("Can't create document with namespace and no root tag");if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument(b||"",a||"",null);if("undefined"!=typeof ActiveXObject){var c=Bh();if(c)return a&&c.appendChild(c.createNode(1,a,b||"")),c}throw Error("Your browser does not support creating new documents");}
function Ch(a){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(a,"application/xml");if("undefined"!=typeof ActiveXObject){var b=Bh();b.loadXML(a);return b}throw Error("Your browser does not support loading xml documents");}function Dh(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if(a=a.xml)return a;throw Error("Your browser does not support serializing XML documents");}
function Bh(){var a=new ActiveXObject("MSXML2.DOMDocument");if(a){a.resolveExternals=!1;a.validateOnParse=!1;try{a.setProperty("ProhibitDTD",!0),a.setProperty("MaxXMLSize",2048),a.setProperty("MaxElementDepth",256)}catch(b){}}return a};function Eh(a){Error.captureStackTrace?Error.captureStackTrace(this,Eh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}B(Eh,Error);function Fh(a){Error.captureStackTrace?Error.captureStackTrace(this,Fh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}B(Eh,Error);Fh.prototype.name="ydn.error.NotSupportedException";
function Gh(a){Error.captureStackTrace?Error.captureStackTrace(this,Gh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}B(Gh,Error);function Hh(a){Error.captureStackTrace?Error.captureStackTrace(this,Hh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}B(Hh,Error);Hh.prototype.name="ydn.InternalError";
function Ih(a){Error.captureStackTrace?Error.captureStackTrace(this,Ih):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}B(Ih,Error);Ih.prototype.name="ydn.error.ConstraintError";function Jh(a){Error.captureStackTrace?Error.captureStackTrace(this,Jh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}B(Eh,Error);
function Kh(a){Error.captureStackTrace?Error.captureStackTrace(this,Kh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}B(Kh,Error);var Lh,Mh,Nh,Oh;Oh=Nh=Mh=Lh=!1;var Ph=Db();Ph&&(-1!=Ph.indexOf("Firefox")?Lh=!0:-1!=Ph.indexOf("Camino")||(-1!=Ph.indexOf("iPhone")||-1!=Ph.indexOf("iPod")?Mh=!0:-1!=Ph.indexOf("iPad")?Nh=!0:-1!=Ph.indexOf("Chrome")&&(Oh=!0)));var Qh=Lh,Rh=Mh,Sh=Nh,Th=Oh;function Uh(a){if(!u(a))throw new Eh("Array required.");if(s(void 0))return a=Ta(a,function(a){return a[void 0]}),Uh(a);for(var b=Number.NaN,c=-1,d=0;d<a.length;d++)!isNaN(a[d])&&(isNaN(b)||a[d]>b)&&(b=a[d],c=d);return{value:b,index:c}};function Vh(){th.call(this);this.h=null;Bc(this,"user-login",this.pg,!1,this);Bc(this,"user-logout",this.pg,!1,this);this.p=window.top.location.href.replace(/[?#]\S+/,"")}B(Vh,th);h=Vh.prototype;h.logger=P("ydn.api.AbstractUser");h.pg=function(){this.display?(this.display.i(this.l||""),this.isLogin()?this.j&&this.display.h(this.j):this.i&&this.display.g(this.i),O(this.logger,"Refreshed.")):O(this.logger,"No UI refreshed.")};
h.toJSON=function(){return{nickname:this.o,email:this.l,is_login:this.h,login_url:this.i,logout_url:this.j,user_id:this.user_id}};h.isLogin=function(){return!0===this.h};h.toString=function(){return"User:"+(!0===this.h?this.l:!1===this.h?"logout":"?")};h.Xc=0;
function Wh(a,b){!b&&a.isLogin()?O(a.logger,"Already login"):(a.xc||(a.xc=new oh(function(){this.isLogin()?this.xc.stop():1<this.Xc?(L(this.logger,"Cannot login to the API server, tried "+this.Xc+" times."),this.xc.stop(),this.Xc=0):(this.Xc++,this.Vc())},5E3,a)),a.Xc=0,ph(a.xc))}h.refresh=function(a){Wh(this,a)};function Xh(a,b,c){wh.call(this,a,b,c)}B(Xh,wh);function Yh(){Vh.call(this)}B(Yh,Vh);Yh.prototype.logger=P("ydn.api.User");
Yh.prototype.load=function(a){M(this.logger,"getting user info");if(a.logout_url)return this.o=a.nickname,this.l=a.email,this.user_id=a.user_id,this.h=a.is_login,this.j=a.logout_url,this.i=a.login_url,M(this.logger,a.email+" login"),this.j=a.logout_url,this.user_id=a.Id?a.Id.$t:void 0,this.h=!0,this.i=void 0,this.U(sh,!0),uh(this),!0;a.login_url&&(M(this.logger,"NO user"),this.i=a.login_url,this.h=!1,this.l=this.user_id=this.j=this.o=void 0,this.U(sh,!0),uh(this));return!1};
Yh.prototype.t=function(a,b){O(this.logger,"Receiving "+(b.Aa()?"":"fail")+" login info from server.");if(b.Aa()){var c=a.User;if(c){var d;d=this.load(c)?new Xh("user-login",this,this.j):new Xh("user-logout",this,this.i);mf(function(){this.dispatchEvent(d)},0,this)}}else L(this.logger,"Server return error with: "+b.Ha());this.xc&&this.xc.stop()};
function Zh(a,b){var c=new C,d=$h(ai);if(!d)return D("login server not available.");var e={pm:a.p,state:Math.random().toString().substr(2,6)};if(b)for(var f in b)e[f]=b[f];d.request(new bi("/rpc_login","GET",e)).execute(function(a,b){a?c.C(a.User):c.D(b)},a);return c}Yh.prototype.Vc=function(){M(this.logger,"Sending login request.");var a=$h(ai),b=window.top.location.href.replace(/[?#]\S+/,"");a.request(new bi("/rpc_login","GET",{url:b})).execute(oa(this.t,this));return!1};function ci(){this.g=A()}var di=new ci;ci.prototype.set=function(a){this.g=a};ci.prototype.get=function(){return this.g};function ei(a){this.j=a||"";this.l=di}ei.prototype.g=!0;ei.prototype.h=!1;function fi(a){a=new Date(a.l);return gi(a.getFullYear()-2E3)+gi(a.getMonth()+1)+gi(a.getDate())+" "+gi(a.getHours())+":"+gi(a.getMinutes())+":"+gi(a.getSeconds())+"."+gi(Math.floor(a.getMilliseconds()/10))}function gi(a){return 10>a?"0"+a:String(a)}function hi(a,b){var c=(a.l-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function ii(a){ei.call(this,a)}B(ii,ei);ii.prototype.h=!0;
ii.prototype.i=function(a){var b;switch(a.j.value){case Re.value:b="dbg-sh";break;case Se.value:b="dbg-sev";break;case Te.value:b="dbg-w";break;case Ue.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.j," ");this.g&&c.push("[",fi(a),"] ");c.push("[",Ha(hi(a,this.l.get())),"s] ");c.push("[",Aa(a.h),"] ");c.push('<span class="',b,'">',za(Ha(Aa(a.getMessage()))));this.h&&a.i&&c.push("<br>",za(Ha(a.g||"")));c.push("</span>");c.push("<br>");return c.join("")};
function ji(a){ei.call(this,a)}B(ji,ei);ji.prototype.i=function(a){var b=[];b.push(this.j," ");this.g&&b.push("[",fi(a),"] ");b.push("[",hi(a,this.l.get()),"s] ");b.push("[",a.h,"] ");b.push(a.getMessage());this.h&&a.i&&b.push("\n",a.g);b.push("\n");return b.join("")};function ki(){this.j=oa(this.o,this);this.g=new ji;this.g.g=!1;this.h=this.g.h=!1;this.i="";this.l={}}function li(a){var b=mi;if(a!=b.h){var c=ff();a?af(c,b.j):(c=c.g)&&$a(c,b.j);b.h=a}}ki.prototype.o=function(a){if(!this.l[a.h]){var b=this.g.i(a),c=ni;if(c)switch(a.j){case Re:oi(c,"info",b);break;case Se:oi(c,"error",b);break;case Te:oi(c,"warn",b);break;default:oi(c,"debug",b)}else window.opera?window.opera.postError(b):this.i+=b}};var ni=window.console;
function oi(a,b,c){if(a[b])a[b](c);else a.log(c)};function pi(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}h=pi.prototype;h.ga=function(){return new pi(this.top,this.right,this.bottom,this.left)};h.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};h.contains=function(a){return this&&a?a instanceof pi?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1};
h.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};h.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};function qi(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}h=qi.prototype;h.ga=function(){return new qi(this.left,this.top,this.width,this.height)};h.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};h.contains=function(a){return a instanceof qi?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
h.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function ri(a,b){var c=Mg(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""}function si(a,b){return ri(a,b)||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}
function ti(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}F&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ui(a){if(F&&!(F&&8<=Wb))return a.offsetParent;var b=Mg(a),c=si(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=si(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}
function vi(a){for(var b=new pi(0,Infinity,Infinity,0),c=Kg(a),d=c.g.body,e=c.g.documentElement,f=Rg(c.g);a=ui(a);)if(!(F&&0==a.clientWidth||Jb&&0==a.clientHeight&&a==d||a==d||a==e||"visible"==si(a,"overflow"))){var g=wi(a),k;k=a;if(Ib&&!Ub("1.9")){var l=parseFloat(ri(k,"borderLeftWidth"));if(xi(k))var m=k.offsetWidth-k.clientWidth-l-parseFloat(ri(k,"borderRightWidth")),l=l+m;k=new Hg(l,parseFloat(ri(k,"borderTopWidth")))}else k=new Hg(k.clientLeft,k.clientTop);g.x+=k.x;g.y+=k.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(Sg(c.g)||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new Jg(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}
function wi(a){var b,c=Mg(a),d=si(a,"position"),e=Ib&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Hg(0,0),g;b=c?Mg(c):document;g=!F||F&&9<=Wb||jh(Kg(b))?b.documentElement:b.body;if(a==g)return f;if(a.getBoundingClientRect)b=ti(a),a=kh(Kg(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=
b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(Jb&&"fixed"==si(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Hb||Jb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=ui(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,Hb&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}function yi(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function zi(a){var b=Ai;if("none"!=si(a,"display"))return b(a);var c=a.style,d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}function Ai(a){var b=a.offsetWidth,c=a.offsetHeight,d=Jb&&!b&&!c;return s(b)&&!d||!a.getBoundingClientRect?new Jg(b,c):(a=ti(a),new Jg(a.right-a.left,a.bottom-a.top))}function Bi(a){var b=wi(a);a=zi(a);return new qi(b.x,b.y,a.width,a.height)}
function R(a,b){a.style.display=b?"":"none"}function xi(a){return"rtl"==si(a,"direction")}var Ci=Ib?"MozUserSelect":Jb?"WebkitUserSelect":null;function Di(a,b,c){c=c?null:a.getElementsByTagName("*");if(Ci){if(b=b?"none":"",a.style[Ci]=b,c){a=0;for(var d;d=c[a];a++)d.style[Ci]=b}}else if(F||Hb)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;d=c[a];a++)d.setAttribute("unselectable",b)}
function Ei(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}function Fi(a,b){var c=a.currentStyle?a.currentStyle[b]:null;return c?Ei(a,c):0}var Gi={thin:2,medium:4,thick:6};
function Hi(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:null))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:null;return c in Gi?Gi[c]:Ei(a,c)}function Ii(a){if(F&&!(F&&9<=Wb)){var b=Hi(a,"borderLeft"),c=Hi(a,"borderRight"),d=Hi(a,"borderTop");a=Hi(a,"borderBottom");return new pi(d,c,a,b)}b=ri(a,"borderLeftWidth");c=ri(a,"borderRightWidth");d=ri(a,"borderTopWidth");a=ri(a,"borderBottomWidth");return new pi(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))}var Ji=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Ki(a){this.l=oa(this.o,this);this.h=new ii;this.i=this.h.g=!1;this.g=a;this.j=this.g.ownerDocument||this.g.document;a=Kg(this.g);var b=null,c=a.g;if(F&&c.createStyleSheet)a=b=c.createStyleSheet(),F&&s(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";else{c=Og(a.g,"head",void 0,void 0)[0];c||(b=Og(a.g,"body",void 0,void 0)[0],c=a.s("head"),b.parentNode.insertBefore(c,b));var d=b=a.s("style");F&&s(d.cssText)?d.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
d.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";a.appendChild(c,b)}this.g.className+=" logdiv"}
Ki.prototype.o=function(a){var b=100>=this.g.scrollHeight-this.g.scrollTop-this.g.clientHeight,c=this.j.createElement("div");c.className="logmsg";c.innerHTML=this.h.i(a);this.g.appendChild(c);b&&(this.g.scrollTop=this.g.scrollHeight)};Ki.prototype.clear=function(){this.g.innerHTML=""};var mi=null,Li=null;P("ydn.debug");function Mi(a,b,c){if(w(b))b=new Qe("log",b);else if(v(b)){b=b.toUpperCase();if(!$e){$e={};for(var d=0,e;e=Ze[d];d++)$e[e.value]=e,$e[e.name]=e}b=$e[b]||null}else b=We;P(a||"ydn").h=b;s(c)?Li||(a=Li=new Ki(c),!0!=a.i&&(c=ff(),af(c,a.l),a.i=!0),ff().h=Te):mi||Li||(mi=new ki,li(!0),ff().h=Te)}var Ni=null;function Oi(a){Ni&&setTimeout(function(){Ni.log(a)},10)};var ai="login",Pi=P("ydn.http"),Qi={},Ri=[];var Si,Ti={},Ui=[];function Vi(a,b){Ti[b||"default"]=a}function $h(a){if(!s(a))return Ti["default"];for(var b=a,c=0;c<Ui.length;c++){var d=(0,Ui[c])(a);if(d){b=d;break}}return Ti[b]||null}function Wi(){Si||(Si=new $f);return Si}function Yi(a,b,c,d){v(a)?this.Ac=a:(this.Ac=null,this.status=a,this.body=b,this.headers=c||{},this.g=d)}function Zi(a){if(a.Ac){var b=xh(a.Ac);b.gapiRequest&&(b=b.gapiRequest.data);a.status=b.status;a.g=b.statusText;a.headers=b.headers;a.body=b.body;a.Ac=null}}
Yi.prototype.O=function(){Zi(this);return this.status};Yi.prototype.Aa=function(){Zi(this);return 200<=this.status&&400>this.status};Yi.prototype.Ha=function(){Zi(this);return this.g||""};function $i(a){Zi(a);return a.body}function aj(a,b){Zi(a);return a.headers[b]}Yi.prototype.Nc=function(){Zi(this);return this.headers};
function bj(a){var b;Zi(a);"application/json"==aj(a,"content-type")?b=!0:(b=a.body,b=v(b)&&!wa(b)?/^[\],:{}\s]*$/.test(b.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")):!1);return b&&v(a.body)?JSON.parse(a.body):a.body}function cj(a){return a instanceof Yi?a:v(a)?new Yi(a):new Yi(a.status,a.body,a.headers,a.statusText)}
function bi(a,b,c,d,e){this.path=a;this.method=b?b.toUpperCase():"GET";this.params=c||{};this.headers=d||{};this.body=e}var dj=null;function ej(a,b,c,d){this.l=s(b)?b:Wi();this.j="sr"+fj++;this.o=c||0;this.p=!!d;this.g=a}var fj=0;ej.prototype.F=function(){return this.j};
ej.prototype.execute=function(a,b){var c=this.g,d=new ud(c.path),e;for(e in c.params)d.g.set(e,c.params[e]);this.l.send(this.j,d.toString(),c.method,c.body,c.headers,void 0,function(d){d=d.target;for(var e=(d.S&&4==Nf(d)?d.S.getAllResponseHeaders():"").split("\n"),k={},l=0;l<e.length;l++){var m=e[l].indexOf(":");0<m&&(k[e[l].substr(0,m).toLowerCase()]=e[l].substr(m+1).trim())}e=l=Of(d);if(k["content-type"]&&/json/.test(k["content-type"]))if(y(l))e=l;else if(v(l))try{e=xh(l)}catch(n){e=l}k=new Yi(d.O(),
l,k,d.Ha());dj&&!k.Aa()&&dj.log({"class":"ydn.gdata.Entry",method:"commit",context:"HTTP request",HttpRequestData:{path:c.path,uri:String(d.t),method:c.method,params:c.params,headers:c.headers,body:c.body},HttpRespondData:{status:k.O(),statusText:k.Ha(),body:$i(k),headers:k.Nc()}});a&&(a.call(b,e,k),a=null)},this.o,void 0,this.p);this.l=null};ej.prototype.toString=function(){return"HTTPRequest:"+this.j};function gj(a,b,c){this.h=a;this.i=b;this.g=null;this.Nh=s(c)?c:!0}gj.prototype.request=function(a){return new hj(a,this)};function hj(a,b){ej.call(this,a,b.i);this.parent=b}B(hj,ej);var ij=new Yi(0,null,null,"No access token");
hj.prototype.execute=function(a,b){function c(){this.Nh?d.g.headers.Authorization="Bearer "+d.parent.g.access_token:d.g.params.access_token=d.parent.g.access_token}var d=this;d.parent.g&&d.parent.g.expires>A()?(c(),hj.m.execute.call(this,function(e,f){401==f.O()?jj(d.parent.h).A(function(e){d.parent.g=e;c();hj.m.execute.call(d,a,b)},function(){d.parent.g=null;a.call(b,null,ij)},d):a.call(b,e,f)},this)):jj(this.parent.h).A(function(e){d.parent.g=e;c();hj.m.execute.call(this,a,b)},function(){d.parent.g=
null;a.call(b,null,ij)},this)};function S(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ha(Object.freeze)&&Object.freeze(this)}S.prototype.lower=void 0;S.prototype.upper=void 0;S.prototype.toJSON=function(){return kj(this)};function lj(a){return mj(a)}S.only=function(a){return new S(a,a,!1,!1)};S.bound=function(a,b,c,d){return new S(a,b,c,d)};S.upperBound=function(a,b){return new S(void 0,a,void 0,!!b)};S.lowerBound=function(a,b){return new S(a,void 0,!!b,void 0)};
function nj(a){var b;if(u(a))b=cb(a),b.push("\uffff");else if(v(a))b=a+"\uffff";else if(w(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return S.only(a);return S.bound(a,b,!1,!0)}function kj(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function oj(a){if(null==a)return null;if(a instanceof S)return a;if(y(a))return new S(a.lower,a.upper,a.lowerOpen,a.upperOpen);throw new K("Invalid key range: "+a+" of type "+typeof a);}
function mj(a){return null!=a?null!=a.upper&&null!=a.lower?pj.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?pj.upperBound(a.upper,a.upperOpen):null!=a.lower?pj.lowerBound(a.lower,a.lowerOpen):null:null}function qj(a){if(a instanceof S)return"";if(null!=a){if(y(a)){for(var b in a)if(a.hasOwnProperty(b)&&!Ya(["lower","upper","lowerOpen","upperOpen"],b))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
S.prototype.pe=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return S.bound(b,c,d,e)};function rj(a){if(!a)return"";var b=a.lowerOpen?"(":"[";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function sj(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==tj(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(uj(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(uj(c.upper,b)))}else d.push(a+" = ?"),e.push(uj(c.lower,b))}var pj=q.IDBKeyRange||q.webkitIDBKeyRange||S;function vj(a,b){var c,d;2==arguments.length&&v(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=fa(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],s(a));c++);return a}function wj(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)y(a[e])||(a[e]={}),a=a[e];a[d]=c}}var xj={};
function yj(a){a=[a];for(var b=new zj,c=0,d,e;void 0!==(e=a.pop());){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(xj);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),Aj(b,e);else if(e instanceof Date)c+=2,b.write(c),Aj(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>
2|255,(f|3)<<6)}c.write(0)}else if(e===xj)b.write(0);else return"";c=0}return b.trim().toString()}function Bj(a){for(var b=[],c=b,d=[],e,f,g=new Cj(a);null!=g.read();)if(0===g.current)c=d.pop();else{if(null===g.current)break;do{e=g.current/4|0;a=g.current%4;for(var k=0;k<e;k++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.current+4)g.read();else break}while(1);1===a?c.push(Dj(g)):2===a?c.push(new Date(Dj(g))):3===a?c.push(Ej(g)):0===a&&(c=d.pop())}return b[0]}
function Aj(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Dj(a){var b=a.read()|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=a.read()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.read()|0):a.read()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Ej(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.read();if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Cj(a){this.current=null;this.g=a;this.h=this.g.length-1;this.index=-1}
Cj.prototype.read=function(){return this.current=this.index<this.h?parseInt(this.g[++this.index]+this.g[++this.index],16):null};function zj(){this.g=[];this.h=void 0}zj.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.h=arguments[b].toString(16),this.g.push(2===this.h.length?this.h:this.h="0"+this.h)};zj.prototype.trim=function(){for(var a=this.g.length;"00"===this.g[--a];);this.g.length=++a;return this};zj.prototype.toString=function(){return this.g.length?this.g.join(""):""};
function Fj(a,b){var c=yj(a),d=yj(b);return c>d?1:c==d?0:-1};function Gj(a,b,c,d,e){if(!(b instanceof S))if(v(b)&&s(c)){var f,g,k,l;if("starts"==b||"^"==b)b=nj(c);else{if("<"==b||"<="==b)f=c,k="<"==b;else if(">"==b||">="==b)g=c,l=">"==b;else if("="==b||"=="==b)f=g=c;else throw new K("invalid op: "+b);if("<"==d||"<="==d)f=e,k="<"==d;else if(">"==d||">="==d)g=e,l=">"==d;else if(s(d))throw new K("invalid op2: "+d);b=S.bound(g,f,l,k)}}else b=oj(b);this.g=b;this.h=a}Gj.prototype.h="";Gj.prototype.Mc=function(){return this.h};
Gj.prototype.pe=function(a){if(this.h!=a.h)return null;a=null!=this.g&&null!=a.g?this.g.pe(a.g):this.g||a.g;return new Gj(this.h,a)};var Hj={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Ij=q.IDBRequest&&"LOADING"in q.IDBRequest?q.IDBTransaction:q.webkitIDBRequest&&"LOADING"in q.webkitIDBRequest&&1===q.webkitIDBTransaction.READ_WRITE?q.webkitIDBTransaction:Hj,Jj=Ij.READ_ONLY,Kj=Ij.READ_WRITE,Lj=Ij.VERSION_CHANGE,Mj=q.indexedDB||q.mozIndexedDB||q.webkitIndexedDB||q.moz_indexedDB||q.msIndexedDB;function Nj(a,b,c,d){vb.call(this);this.i=c;this.P=c.getName();this.xb=void 0;this.j=!1;this.aa=null;this.o=a;this.fd=b;this.Sa=0;this.Ga=this.G=!1;this.na=d||4;this.p=this.h=this.g=void 0;this.T=function(){throw new Sc;};this.Z=function(){throw new Sc;};this.Fc=function(){}}B(Nj,vb);h=Nj.prototype;
h.init=function(a,b,c,d,e){if(s(b)){a=this.i;var f,g=b;u(b)?(f=Oj(a,b),g=b.join(", ")):f=Pj(a,b);if(!f)throw new K('require index "'+g+'" not found in store "'+a.getName()+'"');this.xb=f.getName()}this.j=v(this.xb);this.aa=c||null;this.Sa=0;this.Ga=this.G=!1;this.reverse="prev"==d||"prevunique"==d;this.unique="nextunique"==d||"prevunique"==d;this.Db=d;this.Uc=e;this.p=this.h=this.g=void 0};h.Db="";h.aa=null;h.unique=!1;h.reverse=!1;h.Uc=!0;h.logger=P("ydn.db.core.req.AbstractCursor");
h.fc=function(a,b,c){null==a&&(N(this.logger,this+" finished."),this.G=!0);this.g=a;this.h=b;this.p=c;this.Sa++;this.G?(O(this.logger,this+" DONE."),this.T(),Qj(this)):(O(this.logger,this+" new cursor position {"+(this.j?this.g+", "+this.h:this.g)+"}"),this.T(this.g))};h.J=function(){this.o=null};h.toString=function(){return"Cursor:"+this.P+(s(this.xb)?":"+this.xb:"")+"["+(this.o?"":"~")+this.fd+"]"};
function Qj(a){null!=a.h?a.h=Rj(a.h):a.h=void 0;null!=a.g?a.g=Rj(a.g):a.g=void 0;a.Fc(a.Ga,a.g,a.h)}function Sj(a){a.Ga=!0;O(a.logger,a+": exit");Qj(a)}h.ca=function(){return this.Sa};h.ha=function(){return this.j?this.h:this.g};h.V=function(){return this.Uc?this.ha():this.p};h.rd=function(){};function Tj(){};function Uj(a,b,c,d,e,f,g){if(!v(a))throw new TypeError("store name must be a string, but "+a+" found.");this.i=a;this.h=b;this.o=g;this.p=!!this.h;if(s(d)&&!ga(d))throw new K("reverse value must be a boolean, but "+typeof d+" found");if(s(e)&&!ga(e))throw new K("unique value must be a boolean, but "+typeof e+" found");if(s(f)&&!ga(f))throw new K("key_only value must be a boolean, but "+typeof f+" found");this.g=s(f)?f:!!v(this.h);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.l=
a;if(d=qj(c))throw new K("Invalid key range: "+d);this.j=mj(c);this.t=Vj;this.N=NaN}B(Uj,Tj);Uj.prototype.g=!0;function Wj(a,b,c,d,e){if(!v(b))throw new K("index name must be string");Uj.call(this,a,b,c,d,e,!0)}B(Wj,Uj);function Xj(a,b,c){if(3<arguments.length)throw new K("too many argument");Uj.call(this,a,void 0,b,c,void 0,!1)}B(Xj,Uj);function Yj(a,b,c,d,e){if(!v(b))throw new K("index name must be string");Uj.call(this,a,b,c,d,e,!1)}B(Yj,Uj);var Vj="init";h=Uj.prototype;h.logger=P("ydn.db.Iterator");
h.I=function(){return this.i};h.ga=function(){var a=new Uj(this.i,this.h,this.j,Zj(this),ak(this),this.g,this.o);a.N=this.N;return a};h.unique=function(a){return new Uj(this.i,this.h,this.j,Zj(this),a,this.g,this.o)};h.toJSON=function(){return{store:this.i,index:this.h,keyRange:this.j?kj(this.j):null,direction:this.l}};
h.toString=function(){var a=s(this.o)?":"+this.o.join(","):s(this.h)?":"+this.h:"",a=a+rj(this.j);this.t!=Vj&&(a+=this.t+"{"+this.G,this.p&&(a+=", "+this.H),a+="}");var b=this.p?"Index":"",b=b+(this.g?"Key":"Value");return b+"Iterator:"+this.i+a};h.reverse=function(){return new Uj(this.i,this.h,this.j,!Zj(this),ak(this),this.g,this.o)};function Zj(a){return"prev"===a.l||"prevunique"===a.l}function ak(a){return"nextunique"===a.l||"prevunique"===a.l}
h.load=function(a){a=a[0];a.init(this.i,this.o||this.h,this.j,this.l,this.g);this.t="busy";var b=this;a.Fc=function(a,d,e){b.G=d;b.H=e;b.t=a?"rest":"done"};a.openCursor(this.G,this.H);return a};h.ha=function(){return this.H};h.stores=function(){return[this.i]};function bk(a,b,c){Tc.call(this,b,c);this.t=a;this.j=[];this.p=[];this.T=[];this.g=null;this.kb="";this.G=0}B(bk,Tc);h=bk.prototype;h.kb="";h.logger=P("ydn.db.Request");function ck(a,b,c){a.g=b;a.kb=c;N(a.logger,a+" BEGIN");if(b){for(c=0;c<a.p.length;c++)a.p[c][0].call(a.p[c][1],b);a.p.length=0}N(a.logger,a+" END")}function dk(a){var b=new bk(a.t);a.G++;ck(b,a.g,a.kb+"C"+a.G);return b}h.zd=function(){return this.t};
h.abort=function(){if(this.g)if(N(this.logger,this+" aborting"),ha(this.g.abort))this.g.abort();else if(ha(this.g.executeSql))this.g.executeSql("ABORT",[],function(){},function(){return!0});else throw new Pc;else throw new ek("No active transaction");};function T(a,b,c){var d=a.T.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){T(a,b,c)}):c?a.D(b):a.C(b)}function fk(a,b,c){a.T.push([b,c])}function U(a,b,c){a.g?b.call(c,a.g):a.p.push([b,c])}
h.C=function(a){N(this.logger,this+" SUCCESS");bk.m.C.call(this,a);this.g=null;this.kb=this.kb};h.D=function(a){N(this.logger,this+" ERROR");bk.m.D.call(this,a);this.g=null;this.kb=this.kb};function V(a){var b="";a.kb&&(b=a.g?"*":"",b="["+a.kb+b+"]");return a.t+b}function gk(a,b){var c=new bk(a);T(c,b);return c}h.toString=function(){return"Request:"+V(this)};
h.ye=function(){this.o&&this.ob&&sb(this)&&(q.clearTimeout(this.o),delete this.o);this.h&&(this.h.nd--,delete this.h);for(var a=this.i,b=!1;this.l.length&&!this.Hc;){var c=this.l.shift(),d=c[0],e=c[1],c=c[2];if(d=this.Ib?e:d)d=d.call(c||this.H,a),s(d)&&(this.Ib=this.Ib&&(d==a||d instanceof Error),this.i=a=d),a instanceof C&&(this.Hc=b=!0)}this.i=a;b&&(a.A(oa(this.sd,this,!0),oa(this.sd,this,!1)),a.Pf=!0)};
h.toJSON=function(){var a=(this.kb||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.t?this.t.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var tj=Mj&&Mj.cmp?oa(Mj.cmp,Mj):Fj,hk=[];(function(a,b){if(null!=a&&!("push"in a))throw new Eh('output receiver object must have "push" method.');this.limit=b}).prototype.logger=P("ydn.db.algo.AbstractSolver");function ik(a){Error.captureStackTrace?Error.captureStackTrace(this,ik):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}B(ik,Error);ik.prototype.name="ConstraintError";ik.prototype.toString=function(){return this.name+": "+this.message};function jk(a){Error.captureStackTrace?Error.captureStackTrace(this,jk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}B(jk,Error);
jk.prototype.toString=function(){return this.name+": "+this.message};function kk(a){Error.captureStackTrace?Error.captureStackTrace(this,kk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}B(kk,Error);kk.prototype.name="ydn.db.VersionError";kk.prototype.toString=function(){return this.name+": "+this.message};function lk(a){Error.captureStackTrace?Error.captureStackTrace(this,lk):this.stack=Error().stack||"";a&&(this.message=String(a))}B(lk,Error);
lk.prototype.name="ydn.db.InternalError";function ek(a){Error.captureStackTrace?Error.captureStackTrace(this,ek):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}B(ek,Error);function mk(a){Error.captureStackTrace?Error.captureStackTrace(this,mk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}B(mk,Error);
function nk(a){Error.captureStackTrace?Error.captureStackTrace(this,nk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}B(nk,Error);nk.prototype.name="NotFoundError";nk.prototype.toString=function(){return this.name+": "+this.message};function ok(a,b){Error.captureStackTrace?Error.captureStackTrace(this,ok):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}B(ok,Error);
ok.prototype.toString=function(){return this.name+": "+this.message};function pk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,pk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}B(pk,Error);pk.prototype.toString=function(){return this.name+": "+this.message};function qk(a){Error.captureStackTrace?Error.captureStackTrace(this,qk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}
B(qk,Error);function rk(a){Error.captureStackTrace?Error.captureStackTrace(this,rk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}B(rk,Error);function sk(a,b,c){var d;if(y(a))d=a.store,b=a.id,null!=a.parent&&(c=new sk(a.parent));else if(s(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new sk(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!s(b))throw Error("Invalid key value: "+a);this.P=d;this.id=b;this.parent=c||null}h=sk.prototype;h.toJSON=function(){var a={store:this.P,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
h.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.P+"^:"+this.id};h.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};h.I=function(){return this.P};h.F=function(){return this.id};function tk(a){return u(a.id)?a.id.join("^|"):a.id instanceof Date?+a.id:a.id}h.getParent=function(){return this.parent};function uk(a){return w(a)||v(a)||u(a)&&Va(a,uk)||a instanceof Date}
function Rj(a){if(fa(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function vk(a,b){this.g=b}vk.prototype.logger=P("ydn.db.crud.req.RequestExecuto");vk.prototype.toString=function(){return"RequestExecutor"};function wk(a,b,c,d,e,f){this.Ga=a;this.Sa=b;this.g=this.i=0;this.ea=d;this.Z=e;this.l=c||xk;this.N=f||0;this.t=!1;this.H=0}h=wk.prototype;h.logger=P("ydn.db.tr.Thread");h.Eh=function(a){if("complete"==a||"abort"==a)this.t?(O(this.logger,"tx "+this.i+" committed"),this.t=!1):(O(this.logger,"Generator done "+this.t),T(null,this.i,"complete"!=a))};
h.nc=function(){if(s(this.G))if(this.G)O(this.logger,"Receive to commit tx "+this.i+" on yield "+this.H),this.t=!0;else throw new Rc("Coroutine transaction thread has been ended");else throw new Rc("Transaction thread not running in a generator");};
function yk(a,b){a.t?(O(a.logger,"waiting tx to be committed for yielding "+a.H),setTimeout(function(){a.Nb(function(){O(a.logger,"sending result to yield "+a.H);a.G.next(b)},a.ea,a.Z,oa(a.Eh,a))},4)):(O(a.logger,"sending result to yield "+a.H),a.G.next(b));a.H++}h.request=function(a){a=new bk(a);this.G&&a.A(function(a){yk(this,a)},function(a){var c=a;a instanceof Error||(c=Error(),c.error=a);yk(this,c)},this);return a};h.type=function(){return zk(this.Ga)};h.K=function(){return this.Ga};
h.La=function(){return"B"+this.Sa+"T"+this.i};var xk="single";function Ak(a){if(a)if(ha(a.abort))a.abort();else if(ha(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new Pc;else throw new ek("No active transaction");};function Bk(a){this.i=a;this.g=null;this.h=0}Bk.prototype.logger=P("ydn.db.tr.Mutex");Bk.prototype.hb=null;function Ck(a){return!!a.g&&!a.j}Bk.prototype.Wa=null;Bk.prototype.toString=function(){return"Mutex:"+("B"+this.i+"T"+this.h)+(this.g?"*":"")};function Dk(a,b,c,d,e,f){wk.call(this,a,b,c,d,e,f);this.j=[];this.o=[];this.p=null;this.h=new Bk(b);this.T=f||0;this.na=!1}B(Dk,wk);h=Dk.prototype;h.logger=P("ydn.db.tr.Serial");
function Ek(a,b,c){if("multi"==a.l)a:if(a=a.h,!a.hb||!a.mode||c!=a.mode&&(a.mode!=Kj||c!=Jj)||b.length>a.hb.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.hb.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.l)a:if(a=a.h,a.hb&&a.mode&&c==a.mode&&a.hb.length==b.length){for(c=0;c<b.length;c++)if(-1==a.hb.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.l?!0:!1;return b}
function Fk(a){var b=0<a.j.length?a.j[0].hb:null,c=0<a.j.length?a.j[0].mode:null;return null!=b&&null!=c?Ek(a,b,c):!1}function Gk(a,b,c,d,e){O(a.logger,"push tx queue["+a.j.length+"]");a.j.push({wd:b,hb:c,mode:d,Wa:e})}h.abort=function(){N(this.logger,this+": aborting");Ak(this.p)};
h.Nb=function(a,b,c,d){var e=v(b)?[b]:b;if(fa(e)){if(0==e.length)throw new K("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!v(e[f]))throw new K("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.Rb&&!Ya(this.Rb,e[f]))throw new K('store name "'+f+e[f]+'" in scope of '+this);}}else throw new K("store names must be an array");var g=s(c)?c:Jj,k=this;if(this.h.g||!Hk(this.K())&&this.na)Gk(this,a,b,g,d);else{var l=this.La();d&&this.o.push(d);
if(this.T&&this.i>=this.T)throw new Rc("Exceed maximum number of transactions of "+this.T);this.na=!0;Ik(this.K(),function(c){var d=k.h;d.g=c;d.j=!1;d.hb=b;d.mode=g;d.h++;d.Wa=null;l=k.La();M(k.logger,l+" BEGIN "+zh(b)+" "+g);a(k);for(a=null;Fk(k);)c=k.j.shift(),c.Wa&&k.o.push(c.Wa),O(k.logger,"pop tx queue"+(k.j.length+1)+" reusing T"+k.i),c.wd()},e,g,function(a,b){M(k.logger,l+" "+a);var c=k.h;c.g?(c.g=null,c.hb=null,c.mode=null,ha(c.Wa)&&c.Wa(a,b),c.Wa=null):L(c.logger,c+" has no TX to be unlocked for "+
a);for(c=0;c<k.o.length;c++)(0,k.o[c])(a,b);k.o.length=0;(c=k.j.shift())&&k.Nb(c.wd,c.hb,c.mode,c.Wa);k.g=0})}};h.La=function(){var a=this.h;return"B"+a.i+"T"+a.h};h.request=function(a,b,c,d){var e=Dk.m.request.call(this,a,b,c,d);a=c||Jj;var f=this;Ck(this.h)&&Ek(this,b,a)?(b=this.h.g,this.g++,ck(e,b,this.La()+"R"+this.g),d&&this.o.push(d)):f.Nb(function(){var a=f.h.g;f.g++;ck(e,a,f.La()+"R"+f.g)},b,a,d);return e};
h.lc=function(a,b,c,d,e){d=d||Jj;var f=this,g;if(Ck(f.h)&&Ek(this,c,d)){var k=f.h.g;f.g++;g=f.La()+"R"+f.g;N(f.logger,g+" BEGIN");b(k,g,function(b,c){f.p=k;c?(N(f.logger,g+" ERROR"),a.D(b)):(N(f.logger,g+" SUCCESS"),a.C(b));f.p=null});N(f.logger,g+" END");b=null}else f.Nb(function(){var c=f.h.g;f.g++;g=f.La()+"R"+f.g;N(f.logger,g+" BEGIN");b(c,g,function(b,d){f.p=c;d?(N(f.logger,g+" ERROR"),a.D(b)):(N(f.logger,g+" SUCCESS"),a.C(b));f.p=null});N(f.logger,g+" END");b=null},c,d,e)};h.getName=function(){return this.K().getName()};
h.toString=function(){return"Serial:"+this.La()+(this.p?"*":"")};function Jk(a,b){Dk.call(this,a,b)}B(Jk,Dk);Jk.prototype.logger=P("ydn.db.tr.AtomicSerial");Jk.prototype.request=function(a,b,c){var d,e,f,g=Jk.m.request.call(this,a,b,c,function(a,b){g.g=null;if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new rk;T(g,c,!0)}});fk(g,function(a,b,c){f=b;e=a;d=c});return g};
Jk.prototype.lc=function(a,b,c,d,e){var f,g,k=new C;k.A(function(a){g=!1;f=a},function(a){g=!0;f=a});Jk.m.lc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.D(c);else if(!0===g)a.D(f);else if(!1===g)a.C(f);else{var d=new rk;a.D(d)}e&&(e(b,c),e=void 0)})};Jk.prototype.toString=function(){return"Atomic"+Jk.m.toString.call(this)};function Kk(a,b,c,d){this.j=a;this.h=b;this.g=c;this.Qa=d;this.i=null}h=Kk.prototype;h.logger=P("ydn.db.tr.DbOperator");h.abort=function(){this.g.abort()};function W(a){a.i||(a.i=a.j.H());return a.i}h.K=function(){return this.j};h.nc=function(){this.g.nc()};
function Lk(a,b){var c=a.K(),d=b instanceof Mk?b:Nk(b),e=b.name,f=X(c.h,e);if(0==Ok(d,f).length)tb(!1);else if(f=f?"update":"add",c.h instanceof Pk)Qk(c.h,d),c.i?(c.i.de(),c.i=null,Rk(c)):tb(!1);else throw new Ih("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}h.toString=function(){return"TxStorage:"+this.K().getName()};function Sk(a,b,c,d){Kk.call(this,a,b,c,d)}B(Sk,Kk);h=Sk.prototype;h.logger=P("ydn.db.crud.DbOperator");
h.count=function(a,b,c,d){var e,f,g,k;if(null!=a)if(u(a)){if(s(c)||s(b))throw new K("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!Tk(this.h,f[l]))throw new K('store name "'+f[l]+'" at '+l+" not found.");N(this.logger,"countStores: "+zh(f));e=this.g.request("count",f);U(e,function(){W(this).td(e,f)},this)}else if(v(a)){l=X(this.h,a);if(!l)throw new K('store name "'+a+'" not found.');if(s(d)&&!ga(d))throw new K('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(v(b))if(g=
b,y(c)){var m=qj(c);if(m)throw new K("invalid key range: "+yh(c)+" "+m);k=mj(c)}else{if(null!=c)throw new K("invalid key range: "+yh(c)+" of type "+typeof c);k=null}else if(y(b)||null==b)if(y(b)){if(m=qj(b))throw new K("invalid key range: "+yh(b)+" "+m);k=mj(b)}else{if(null!=b)throw new K("key range must be  an object but found "+yh(b)+" of type "+typeof b);k=null}else throw new K('invalid second argument for count "'+yh(c)+'" of type '+typeof b);N(this.logger,"countKeyRange: "+a+" "+(g?g:"")+zh(k));
e=this.g.request("count",f);Uk(l,e,arguments);U(e,function(){W(this).Ic(e,f[0],k,g,!!d)},this)}else throw new K("Invalid store name or store names.");else L(this.logger,"count method requires store name(s)"),l=Vk(this.h),e=this.g.request("count",l),fk(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),U(e,function(){W(this).td(e,f)},this);return e};
h.get=function(a,b){var c=this,d;if(a instanceof sk){var e=a,f=e.I(),g=X(this.h,f);if(!g){if(this.h.Za()){if(Hk(this.K()))return gk("get",void 0);d=new bk("get");this.K().Cb(function(){c.get(a,b).A(function(a){d.C(a)},function(a){d.D(a)})});return d}throw new K("Store: "+f+" not found.");}var k=e.F();N(this.logger,"getByKey: "+f+":"+k);d=this.g.request("get:key",[f]);Uk(g,d,arguments,void 0,this);U(d,function(){W(this).xd(d,f,k)},this)}else if(v(a)&&s(b)){var l=a,g=X(this.h,l);if(!g){if(this.h.Za()){if(Hk(this.K()))return gk("get",
void 0);d=new bk("get");this.K().Cb(function(){c.get(a,b).A(function(a){d.C(a)},function(a){d.D(a)})});return d}throw new K('Store name "'+l+'" not found.');}var m=b;N(this.logger,"getById: "+l+":"+m);d=this.g.request("get",[l]);Uk(g,d,arguments,void 0,this);U(d,function(){W(this).xd(d,l,m)},this)}else throw new K("get require valid input arguments.");return d};
h.keys=function(a,b,c,d,e,f,g){var k,l,m=null,n=!1,p=!1,r=a,t=X(this.h,r);if(!v(r))throw new K("store name must be a string, but "+r+" of type "+typeof r+" is not.");if(!this.h.Za()){if(!t)throw new K('store name "'+r+'" not found.');if(v(b)&&!Pj(t,b))throw new K('index "'+b+'" not found in store "'+r+'".');}if(this.h.Za()&&!t)return gk("keys",[]);var x;if(v(b)){var z=b,G=qj(c);if(G)throw new K("invalid key range: "+c+" "+G);m=mj(c);if(w(d))k=d;else{if(s(d))throw new K("limit must be a number");k=
100}if(w(e))l=e;else{if(s(e))throw new K("offset must be a number");l=0}if(s(f))if(ga(f))n=f;else throw new K("reverse must be a boolean");if(s(g))if(ga(g))p=g;else throw new K("unique must be a boolean");N(this.logger,"keysByIndexKeyRange: "+r);x=this.g.request("keys:iter:index",[r]);Uk(t,x,arguments);U(x,function(){W(this).list(x,2,r,z,m,k,l,n,p)},this)}else{if(y(b)){if(G=qj(b))throw new K("invalid key range: "+yh(b)+" "+G);m=mj(b)}else{if(null!=b)throw new K("invalid key range: "+yh(b)+" of type "+
typeof b);m=null}if(w(c))k=c;else{if(s(c))throw new K("limit must be a number");k=100}if(w(d))l=d;else{if(s(d))throw new K("offset must be a number");l=0}if(s(e))if(ga(e))n=e;else throw new K("reverse must be a boolean");N(this.logger,"keysByKeyRange: "+r);x=this.g.request("keys",[r]);Uk(t,x,arguments);U(x,function(){W(this).list(x,2,r,null,m,k,l,n,!1)},this)}return x};
h.values=function(a,b,c,d,e,f,g){var k=this,l,m,n,p=!1,r=!1;if(v(a)){var t=a,x=X(this.h,t);if(!x){if(this.h.Za()){if(Hk(this.K()))return gk("values",[]);l=new bk("values");this.K().Cb(function(){k.values(a,b,c,d,e,f).A(function(a){l.C(a)},function(a){l.D(a)})});return l}throw new nk(t);}if(u(b)){if(s(c)||s(d))throw new K("too many input arguments");var z=b;N(this.logger,"listByIds: "+t+" "+z.length+" ids");l=this.g.request("values:array",[t]);Uk(x,l,arguments,void 0,this);U(l,function(){W(this).ff(l,
t,z)},this)}else if(v(b)){var G=b;if(!Wk(x,G))throw new K('index "'+G+'" not found in store "'+t+'"');var E=qj(c);if(E)throw new K("invalid key range: "+c+" "+E);var J=mj(c);if(s(d))if(w(d))m=d;else throw new K("limit must be a number.");else m=100;if(s(e))if(w(e))n=e;else throw new K("offset must be a number.");else n=0;if(ga(f))p=f;else if(s(f))throw new K("reverse must be a boolean, but "+f);if(s(g))if(ga(g))r=g;else throw new K("unique must be a boolean");N(this.logger,"listByIndexKeyRange: "+
t+":"+G);l=this.g.request("values:iter:index",[t]);Uk(x,l,arguments);U(l,function(){W(this).list(l,4,t,G,J,m,n,p,r)},this)}else{J=null;if(y(b)){if(E=qj(b))throw new K("invalid key range: "+b+" "+E);J=mj(b)}else if(null!=b)throw new K('expect key range object, but found "'+yh(b)+'" of type '+typeof b);if(s(c))if(w(c))m=c;else throw new K("limit must be a number, but "+c+" is "+typeof c);else m=100;if(s(d))if(w(d))n=d;else throw new K("offset must be a number, but "+d+" is "+typeof d);else n=0;if(s(e))if(ga(e))p=
e;else throw new K("reverse must be a boolean, but "+e+" is "+typeof e);N(this.logger,(J?"listByKeyRange: ":"listByStore: ")+t);l=this.g.request("values",[t]);Uk(x,l,arguments);U(l,function(){W(this).list(l,4,t,null,J,m,n,p,!1)},this)}}else if(u(a))if(a[0]instanceof sk){for(var x=[],Q=a,E=0;E<Q.length;E++){var ma=Q[E].I();if(!Tk(this.h,ma)){if(this.h.Za())return x=[],x[Q.length-1]=void 0,gk("get",x);throw new K("Store: "+ma+" not found.");}Ya(x,ma)||x.push(ma)}N(this.logger,"listByKeys: "+zh(x)+" "+
Q.length+" keys");l=this.g.request("values:keys",x);U(l,function(){W(this).Md(l,Q)},this)}else throw new K("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found.");else throw new K("first argument "+a+" is invalid.");return l};
h.list=function(a,b,c,d,e,f,g,k,l){var m=X(this.h,b);if(!m){if(this.h.Za())return gk("get",[]);throw new nk(b);}var n;if(c&&!Wk(m,c))throw new K('index "'+c+'" not found in store "'+b+'"');if(m=qj(d))throw new K("invalid key range: "+d+" "+m);var p=mj(d),r=100;if(w(e))r=e;else if(null!=e)throw new K('limit must be a number but "'+e+'" of type '+typeof e+" found.");var t=0;if(w(f))t=f;else if(null!=f)throw new K('offset must be a number but "'+f+'" of type '+typeof f+" found.");var x=!1;if(ga(g))x=
g;else if(null!=g)throw new K('reverse must be a boolean but "'+g+'" of type '+typeof g+" found.");var z=!1;if(ga(k))z=k;else if(null!=k)throw new K('unique must be a boolean but "'+k+'" of type '+typeof k+" found.");if(t&&l&&s(l[0]))throw new K("offset must not given when initial cursor position is defined");N(this.logger,a+": "+b+":"+c);n=this.g.request("values:iter:index",[b]);U(n,function(){W(this).list(n,a,b,c||null,p,r,t,x,z,l)},this);return n};
h.add=function(a,b,c){var d=v(a)?a:y(a)?a.name:void 0;if(!v(d))throw new K("store name "+d+" must be a string, but "+typeof d);var e=X(this.h,d);if(!e){if(!this.h.Za())throw new K('store name "'+d+'" not found.');e=Nk(y(a)?a:{name:d});N(this.logger,"Adding object store: "+d);Lk(this,e)}else if(this.h.Za()&&y(a)&&(a=Nk(a),a=Ok(e,a)))throw new Pc(a);var f;if(!e)throw new K('store name "'+d+'" not found.');if(v(e.keyPath)&&s(c))throw new K("key must not be provided while the store uses in-line key.");
if(!e.keyPath&&!e.h&&!s(c))throw new K("out-of-line key must be provided.");if(u(b)){N(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)Xk(e,b[a]);f=this.g.request("add:array",[d],Kj);U(f,function(){W(this).jb(f,!1,!1,d,b,c)},this);e.Ub&&f.B(function(a){a=new Yk(Zk,this.K(),e.getName(),a,b);this.K().Ua(a)},this)}else if(y(b))a="store: "+d+" key: "+$k(e,b,c),N(this.logger,"addObject: "+a),Xk(e,b),f=this.g.request("add",[d],Kj),U(f,function(){W(this).jb(f,!1,!0,d,[b],[c])},
this),e.Ub&&f.B(function(a){a=new al(Zk,this.K(),e.getName(),a,b);this.K().Ua(a)},this);else throw new K("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};
function bl(a,b){var c=v(b)?b:y(b)?b.name:void 0;if(!v(c))throw new K("store name must be a string");var d=X(a.h,c);if(!d){if(!a.h.Za())throw new nk(c);d=Nk(y(b)?b:{name:c});N(a.logger,"Adding object store: "+c);Lk(a,d)}else if(a.h.Za()&&y(b)){var e=Nk(b);if(e=Ok(d,e))throw new Pc(e);}if(!d)throw new nk(c);return d}h.load=function(a,b,c){var d=c||",",e=bl(this,a).getName();a=this.g.request("load",[e]);var f=this;this.g.lc(a,function(a,c,l){W(f).nf(a,c,l,e,b,d)},[e],Kj);return a};
h.search=function(a){var b=cl(a);O(this.logger,"query "+a);var c=this.g.request("search",b,Jj);U(c,function(){var b=W(this);dl(a,function(e,f,g,k){var l=dk(c);b.list(l,4,e,f,mj(g),100,0,!1,!1);l.fa(function(b){var d=null;b instanceof Array||(d=b,b=[]);for(var e=0;e<b.length;e++){var f;f=b[e];var g=f.id,g=v(g)?Bj(g):g,k=g[3];(f=1==this.type&&k!=this.value?null:new el(this,g[0],g[2],g[1],k,f.k,f.loc))&&a.j.push(f)}a.i--;b=0==a.i?!1:a.h[a.h.length-1].l===this.l?!0:null;!0===b?Uc(c,a):!1===b&&c.C(fl(a));
if(d)throw d;},k)})},this);return c};
h.put=function(a,b,c){var d,e=this;if(a instanceof sk){var f=a,g=f.I(),k=X(this.h,g);if(!k)throw new K('store "'+g+'" not found.');if(k.keyPath){var l=$k(k,b);if(null!=l){if(0!=tj(l,f.F()))throw new K("Inline key must be "+f+" but "+l+" found.");}else gl(k,b,f.F());return this.put(g,b)}return this.put(g,b,f.F())}if(u(a)){if(s(c))throw new K("too many arguments");var m=a;if(!s(b))throw new K("record values required");for(var n=b,f=[],g=0,k=m.length;g<k;g++){l=m[g].I();-1==Qa(f,l)&&f.push(l);var p=
X(this.h,l);if(!p)throw new K('store "'+l+'" not found.');p.keyPath&&gl(p,n[g],m[g].F())}N(this.logger,"putByKeys: to "+zh(f)+" "+n.length+" objects");for(g=0;g<n.length;g++)Xk(p,n[g]);d=this.g.request("put:keys",f,Kj);Uk(p,d,arguments);U(d,function(){W(e).Sd(d,n,m)},this)}else if(v(a)||y(a)){var p=bl(this,a),r=p.getName();if(p.keyPath&&s(c))throw new K("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.h&&!s(c))throw new K("out-of-line key must be provided.");if(u(b)){var t=
b,x=c;N(this.logger,"putObjects: "+r+" "+t.length+" objects");for(g=0;g<t.length;g++)Xk(p,t[g]);d=this.g.request("put:array",[r],Kj);Uk(p,d,arguments);U(d,function(){W(this).jb(d,!0,!1,r,t,x)},this);p.Ub&&d.B(function(a){a=new Yk(hl,this.K(),r,a,t);this.K().Ua(a)},this)}else if(y(b)){var z=b,G=c;N(this.logger,"putObject: "+r+" "+G);if(s(q.Blob)&&z instanceof Blob&&p.kc&&!p.keyPath&&0==p.indexes.length&&Jb)d=new bk("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,c=e.g.request("put",
[r],Kj);Uk(p,c,[r,z,G]);U(c,function(){W(e).jb(c,!0,!0,r,[b],[G])},this);c.A(function(a){d.C(a)},function(a){d.D(a)})},f.onerror=function(a){d.D(a)},f.onabort=function(a){d.D(a)},f.readAsDataURL(z);else{Xk(p,z);d=this.g.request("put",[r],Kj);var E=[r,z,G];Uk(p,d,E);U(d,function(){var a=s(G)?[E[2]]:void 0;W(e).jb(d,!0,!0,r,[E[1]],a)},this)}p.Ub&&d.B(function(a){a=new al(hl,this.K(),r,a,z);this.K().Ua(a)},this)}else throw new K("put record value must be Object or array of Objects");}else throw new K("the first argument of put must be store name, store schema or array of keys.");
return d};
function il(a,b,c,d){var e=a.Qa,f,g;if(v(b)){var k=X(a.h,b);if(k){if(!k.keyPath&&!k.h&&null==d)throw new K('key required for store "'+b+'"');}else throw new nk(b);for(var l=0;l<c.length;l++)Xk(k,c[l]);f=[b]}else{g=b;f=[];for(var l=0,m=g.length;l<m;l++){var n=g[l].I(),k=X(a.h,n);-1==Qa(f,n)&&f.push(n);if(!k)throw new nk(n);Xk(k,c[l])}}var p;v(b)?(k=X(a.h,b),p=e.request("put:array",f,Kj),U(p,function(){W(this).jb(p,!0,!1,b,c,d)},a)):(p=e.request("put:keys",f,Kj),U(p,function(){W(this).Sd(p,c,g)},a));
return p}function jl(a,b){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d].I();-1==Qa(c,f)&&c.push(f);if(!Tk(a.h,f))throw new nk(f);}var g=a.Qa.request("rm:keys",c,Kj);U(g,function(){W(this).Vd(g,b)},a);return g}function kl(a,b,c){var d=a.Qa.request("rm:iter",[b],Kj);U(d,function(){W(this).Zc(d,b,c||null)},a);return d}
function ll(a,b,c,d,e,f,g){f=f||100;var k,l=g||0;if(g=X(a.h,b)){if(c&&!Wk(g,c))throw new nk('index "'+c+'" in store "'+b+'"');}else throw new nk(b);var m=mj(d);v(c)?(k=a.Qa.request("values:iter:index",[b]),U(k,function(){W(this).list(k,4,b,c,m,f,l,e,!1)},a)):(k=a.Qa.request("values",[b]),U(k,function(){W(this).list(k,4,b,null,m,f,l,e,!1)},a));return k}
function ml(a,b){var c=[],d=b.length;if(0==d)return gk("keys",[]);for(var e=0;e<d;e++){var f=b[e].I();-1==Qa(c,f)&&c.push(f);if(!Tk(a.h,f))throw new nk(f);}var g=a.Qa.request("keys",c);U(g,function(){W(a).Md(g,b)},a);return g}
function nl(a,b,c,d,e,f,g,k){var l;e=e||100;var m=X(a.h,b);if(m){if(c&&!Wk(m,c))throw new nk('index "'+c+'" in store "'+b+'"');}else throw new nk(b);v(c)?(l=a.Qa.request("keys:iter:index",[b]),U(l,function(){W(this).list(l,2,b,c,d,e,f,g,k)},a)):(l=a.Qa.request("keys",[b]),U(l,function(){W(this).list(l,2,b,null,d,e,f,g,k)},a));return l}
h.clear=function(a,b,c){if(s(c))throw new K("too many input arguments");var d;if(v(a)){c=X(this.h,a);if(!c)throw new K('store name "'+a+'" not found.');if(y(b)){var e=mj(b);if(null===e)throw new K("clear method requires a valid non-null KeyRange object.");N(this.logger,"clearByKeyRange: "+a+":"+zh(e));d=this.g.request("clear",[a],Kj);Uk(c,d,[a,e]);U(d,function(){W(this).re(d,a,e)},this)}else{if(s(b))throw new K("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+
typeof b);N(this.logger,"clearByStore: "+a);d=this.g.request("clear",[a],Kj);U(d,function(){W(this).qd(d,[a])},this)}}else if(!s(a)||u(a)&&v(a[0])){var f=a||Vk(this.h);N(this.logger,"clearByStores: "+zh(f));d=this.g.request("clear",f,Kj);U(d,function(){W(this).qd(d,f)},this)}else throw new K('first argument "'+a+'" is invalid.');return d};
h.remove=function(a,b,c){var d;if(v(a)){var e=X(this.h,a);if(!e)throw new K('store name "'+a+'" not found.');if(s(c))if(v(b)){var f=Pj(e,b);if(!f)throw new K("index: "+b+" not found in "+a);if(y(c)||null===c){var g=mj(c);N(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.g.request("rm:iter:index",[a],Kj);U(d,function(){W(this).of(d,a,f.getName(),g)},this)}else throw new K("key range "+c+' is invalid type "'+typeof c+'".');}else throw new K('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(v(b)||w(b)||fa(b)||b instanceof Date){N(this.logger,"removeById: "+a+":"+b);d=this.g.request("rm",[a],Kj);var k=[a,b];Uk(e,d,k);U(d,function(){W(this).Ud(d,a,k[1])},this);e.Ub&&d.B(function(b){b=new al(ol,this.K(),a,b,void 0);this.K().Ua(b)},this)}else if(y(b))g=mj(b),N(this.logger,"removeByKeyRange: "+a+":"+zh(g)),d=this.g.request("rm:iter",[a],Kj),Uk(e,d,[a,g]),U(d,function(){W(this).Zc(d,a,g)},this),e.Ub&&d.B(function(b){b=new Yk(ol,this.K(),a,b,void 0);this.K().Ua(b)},
this);else throw new K('Invalid key or key range "'+b+'" of type '+typeof b);}else if(a instanceof sk){var l=a.I(),e=X(this.h,l);d=this.g.request("rm",[l],Kj);var m=[l,a.F()];Uk(e,d,m);U(d,function(){W(this).Ud(d,l,m[1])},this)}else if(u(a)){b=[];c=0;for(e=a.length;c<e;c++){if(!(a[c]instanceof sk))throw new K("key list element at "+c+" of "+e+' must be yn.db.Key, but "'+yh(a[c])+'" ('+ea(a[c])+") is not ydn.db.Key.");var n=a[c].I();-1==Qa(b,n)&&b.push(n)}if(1>b.length)throw new K('at least one valid key required in key list "'+
yh(a)+'"');d=this.g.request("rm:keys",b,Kj);U(d,function(){W(this).Vd(d,a)},this)}else throw new K('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+yh(a)+'" ('+ea(a)+") found.");return d};h.toString=function(){return"DbOperator:"+this.K().getName()};function pl(a,b,c,d){Kk.call(this,a,b,c,d)}B(pl,Sk);h=pl.prototype;h.logger=P("ydn.db.core.DbOperator");h.get=function(a,b){if(a instanceof Uj){var c=a.I(),d=X(this.h,c);if(!d)throw new K('store "'+c+'" not found.');var e=a.h;if(s(e)&&!Wk(d,e))throw new K('index "'+e+'" not found in store "'+c+'".');N(this.logger,"getByIterator:"+a);var f=this.g.request("get:iter",[c]);U(f,function(){ql(this,5,f,a,1)},this);return f}return pl.m.get.call(this,a,b)};
h.keys=function(a,b,c,d,e,f,g){if(a instanceof Uj){var k=100;if(w(b)){if(k=b,1>k)throw new K("limit must be a positive value, but "+b);}else if(s(b))throw new K("limit must be a number,  but "+b);if(s(c))throw new K("offset must not be specified");N(this.logger,"keysByIterator:"+a);var l=this.g.request("keys:iter",[a.I()]);U(l,function(){a.p?ql(this,1,l,a,k):ql(this,2,l,a,k)},this);return l}return pl.m.keys.call(this,a,b,c,d,e,f,g)};
h.count=function(a,b,c,d){if(a instanceof Uj){if(s(b)||s(c))throw new K("too many arguments.");N(this.logger,"countIterator:"+a);var e=this.g.request("count",[a.I()]);U(e,function(){ql(this,6,e,a)},this);return e}return pl.m.count.call(this,a,b,c,d)};
h.values=function(a,b,c,d,e,f){if(a instanceof Uj){var g;if(w(b)){if(g=b,1>g)throw new K("limit must be a positive value, but "+g);}else if(s(b))throw new K("limit must be a number, but "+b);if(s(c))throw new K("offset must not be specified");N(this.logger,"listByIterator:"+a);var k=this.g.request("values:iter",[a.I()]);U(k,function(){a.g?ql(this,2,k,a,g):ql(this,4,k,a,g)},this);return k}return pl.m.values.call(this,a,b,c,d,e,f)};
h.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new K('Store "'+e+'" not found.');e=this.g.request("map",d);O(this.logger,"map:"+a);this.g.lc(e,function(d,e,f){O(c.logger,e+" iterating "+a);for(var m=a.stores(),n=[],p=0;p<m.length;p++)n[p]=W(c).h(d,e,m[p]);var r=a.load(n);r.Z=function(a){f(a,!1)};r.T=function(c){if(null!=c){var d;a.p?a.g?d=c:d=r.ha():a.g?d=c:d=r.V();b(d);r.advance(1)}else f(void 0),b=null}},d,Jj);return e};
function ql(a,b,c,d,e){var f=[],g=c.g,k=V(c),l=k+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);N(a.logger,l);for(var m=W(a),n=[],p=d.stores(),r=0;r<p.length;r++)n[r]=m.h(g,k,p[r]);var t=d.load(n);t.Z=function(a){Sj(t);T(c,a,!0)};var x=0,z=!1;t.T=function(d){z||(O(a.logger,l+" starting"),z=!0);null!=d?(t.ha(),x++,1==b?f.push(d):2==b?f.push(t.ha()):3==b?f.push([d,t.ha()]):6!=b&&f.push(t.V()),5==b?(Sj(t),T(c,f[0])):6==b||!s(e)||x<e?t.rd():(N(a.logger,"success:"+l+" yields "+f.length+" records"),Sj(t),
T(c,f))):(N(a.logger,"success:"+l+" yields "+f.length+" records"),Sj(t),T(c,5==b?f[0]:6==b?x:f))}};var Zk="created",ol="deleted",hl="updated";function rl(a,b){H.call(this,a,b)}B(rl,H);rl.prototype.I=function(){return this.P};function sl(a,b,c){H.call(this,a,b);this.version=c}B(sl,rl);sl.prototype.name="ReadyEvent";sl.prototype.version=NaN;function tl(a,b,c){H.call(this,c||"error",a);this.error=b}B(tl,rl);tl.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};tl.prototype.name="ErrorEvent";tl.prototype.error=null;function ul(a,b){tl.call(this,a,b,"fail")}B(ul,tl);
ul.prototype.name="FailEvent";function al(a,b,c,d,e){H.call(this,a,b);this.P=c;this.key=d;this.value=e}B(al,rl);al.prototype.name="RecordEvent";al.prototype.V=function(){return this.value};function Yk(a,b,c,d,e){H.call(this,a,b);this.P=c;this.keys=d;this.values=e}B(Yk,rl);Yk.prototype.name="StoreEvent";Yk.prototype.Ma=function(){return this.keys};Yk.prototype.xa=function(){return this.values};function vl(a,b,c,d,e,f){s(e)||(e=u(a)?a.join(", "):a);if(null!=a&&!v(a)&&!fa(a))throw new K("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);u(a)&&Object.freeze&&Object.freeze(a);!s(a)&&s(e)&&(a=e);this.keyPath=a;this.o=fa(this.keyPath);this.h=e;this.type=wl(b);if(s(b)){if(!s(this.type))throw new K("type invalid in index: "+this.h);if(u(this.keyPath))throw new K('composite key for store "'+this.h+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;this.p=
v(this.type)?this.type:xl;this.j=v(e)?e:u(a)?this.keyPath.join(","):a;this.i=La(this.j);this.g=this.o?null:this.keyPath.split(".");this.l=f||null}function yl(a,b){if(null!=b){if(fa(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=vj(b,a.keyPath[d]);c[d]=f}return c}return vj(b,a.keyPath)}}function zl(a,b,c){for(var d=0;d<a.g.length;d++)d==a.g.length-1?b[a.g[d]]=c:y(b[a.g[d]])||(b[a.g[d]]={})}var xl="TEXT";
function uj(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return null!=b?a:yj(a)}function Al(a,b){return"DATE"==b?new Date(a):s(b)?a:Bj(a)}var Bl=["BLOB","DATE","INTEGER","NUMERIC",xl];function wl(a){if(v(a))return a=Qa(Bl,a),Bl[a]}h=vl.prototype;h.getName=function(){return this.h};h.toJSON=function(){return{name:this.h,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};
h.ga=function(){var a=u(this.keyPath)?cb(this.keyPath):this.keyPath;return new vl(a,this.type,this.unique,this.multiEntry,this.h,this.l)};function Cl(a,b){return null!=a||null!=b?null!=a?null!=b?fa(a)&&fa(b)?gb(a,b)?null:"expect: "+a+", but: "+b:Dl(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}
h.hint=function(a){if(!a)return this;var b=u(this.keyPath)?cb(this.keyPath):this.keyPath,c=this.type;s(a.type)||"TEXT"!=c||(c=void 0);return new vl(b,c,this.unique,this.multiEntry,a.h)};function El(a,b){a.l=b}h.toString=function(){var a=this.multiEntry?"MultiEntry":"";this.g&&1<this.g.length&&(a+="Compound");return a+"Index:"+this.h};function Mk(a,b,c,d,e,f,g,k){this.i=a;if(!v(this.i))throw new K("store name must be a string");this.keyPath=s(b)?b:null;this.t=fa(this.keyPath);if(null!==this.keyPath&&!v(this.keyPath)&&!this.t)throw new K("keyPath must be a string or array");this.h=c;var l;if(null!=d){l=wl(d);if(!s(l))throw new K('type "'+d+'" for primary key in store "'+this.i+'" is invalid.');if(this.t)throw new K('composite key for store "'+this.i+'" must not specified type');}this.type=null!=l?l:this.h?"INTEGER":void 0;this.o=
v(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.Ub=!!f;this.kc=!!g;this.G=v(this.type)?this.type:xl;this.l=u(this.keyPath)?this.keyPath.join(","):v(this.keyPath)?this.keyPath:"_ROWID_";this.j=La(this.l);if(this.H=!!k){if(this.keyPath)throw new K('encrypted store "'+this.i+'" must not use inline key');if(this.h)throw new K('encrypted store "'+this.i+'" must not use key generator');}this.p=[]}h=Mk.prototype;h.Ub=!1;h.kc=!1;
h.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.i,keyPath:this.keyPath,autoIncrement:this.h,type:this.type,indexes:a}};
function Nk(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==Qa(b,c))throw new K('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(u(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==Qa(f,g))throw new K("Unknown field: "+g+" in "+zh(e));e=new vl(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
s(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new Mk(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}function Fl(a,b,c,d,e,f,g){a=Gl(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.Jc;a.va&&(b+=" WHERE "+a.va);a.group&&(b+=" GROUP BY "+a.group);a.gc&&(b+=" ORDER BY "+a.gc);return b}
function Gl(a,b,c,d,e,f,g){var k={select:"",Jc:"",va:"",group:"",gc:""},l=a.l,m=a.j,n=null;d!==l&&v(d)&&(n=Pj(a,d));var p=!!n,r=d||l,t=La(r),x=p?n.type:a.type,z=p&&n.multiEntry;k.Jc=Hl(a);6===c?k.select="COUNT("+m+")":3===c||1===c||2===c?(k.select=m,null!=d&&d!=l&&(k.select+=", "+t)):k.select="*";d=g?"DISTINCT ":"";l=[];z?(z=La("ydn.db.me:"+a.getName()+":"+n.getName()),k.select=6===c?"COUNT("+d+z+"."+t+")":3===c||1===c||2===c?"DISTINCT "+Hl(a)+"."+m+", "+z+"."+t+" AS "+r:"DISTINCT "+Hl(a)+".*, "+
z+"."+t+" AS "+r,k.Jc=z+" INNER JOIN "+Hl(a)+" USING ("+m+")",null!=e&&(sj(z+"."+t,x,e,l,b),0<l.length&&(k.va=k.va?k.va+(" AND "+l.join(" AND ")):l.join(" AND ")))):null!=e&&(sj(t,x,e,l,b),0<l.length&&(k.va=k.va?k.va+(" AND "+l.join(" AND ")):l.join(" AND ")));p&&!n.unique&&g&&(k.group=t);a=f?"DESC":"ASC";k.gc=t+" "+a;p&&(k.gc+=", "+m+" "+a);return k}
function Il(a,b,c,d,e,f,g,k,l){var m,n,p,r;null!=e?(m=e.lower,n=e.upper,p=e.lowerOpen,r=e.upperOpen,f?null!=n?(e=tj(k,n),-1==e?(n=k,r=l):0==e&&(r=l||r)):(n=k,r=l):null!=m?(e=tj(k,m),1==e?(m=k,p=l):0==e&&(p=l||p)):(m=k,p=l)):f?(n=k,r=l):(m=k,p=l);e=new S(m,n,!!p,!!r);d=d?Pj(a,d):null;b=Gl(a,c,b,d?d.j:a.l,e,f,g);b="SELECT "+b.select+" FROM "+b.Jc+(b.va?" WHERE "+b.va:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.gc;d&&(b+=", "+a.j+(f?"DESC":"ASC"));return b}
function Jl(a,b,c,d,e,f,g,k,l,m){var n=Pj(a,d),p=n.j;d=n.i;var r=a.j,t=l?" <":" >",t=g?t+" ":t+"= ";g=uj(f,n.type);k=uj(k,a.type);n="";e?(a=Gl(a,c,b,p,e,l,m),a.va+=" AND ",n=d+t+"?",c.push(g)):(e=l?S.upperBound(f,!0):S.lowerBound(f,!0),a=Gl(a,c,b,p,e,l,m),n=a.va,a.va="");a.va+="("+n+" OR ("+d+" = ? AND "+r+t+"?))";c.push(g);c.push(k);return"SELECT "+a.select+" FROM "+a.Jc+" WHERE "+a.va+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.gc}h.ga=function(){return Nk(this.toJSON())};
h.index=function(a){return this.indexes[a]||null};function Pj(a,b){return Wa(a.indexes,function(a){return a.getName()==b})}function Oj(a,b){for(var c=0;c<a.indexes.length;c++)if(!Cl(a.indexes[c].keyPath,b))return a.indexes[c];return null}function Wk(a,b){return b===a.keyPath?!0:Ua(a.indexes,function(a){return a.getName()==b})}function Hl(a){return La(a.i)}
function Kl(a,b){if(!b)return a;var c=a.h,d=u(a.keyPath)?cb(a.keyPath):a.keyPath,e=a.type,f=Ta(a.indexes,function(a){return a.ga()});s(b.type)||"TEXT"!=e||(e=void 0);u(b.keyPath)&&v(d)&&d==b.keyPath.join(",")&&(d=cb(b.keyPath));for(var g=0,k=b.indexes.length;g<k;g++)if(b.indexes[g].o)for(var l=b.indexes[g].getName(),m=f.length-1;0<=m;m--)if(0<=l.indexOf(f[m].getName())){f[m]=b.indexes[g].ga();break}for(g=0;g<f.length;g++)(k=Pj(b,f[g].getName()))&&(f[g]=f[g].hint(k));return new Mk(b.i,d,c,e,f)}
h.getName=function(){return this.i};function Ll(a){return!!a.keyPath}function $k(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.t){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(vj(b,a.keyPath[d]));return c}if(a.keyPath)return lc(b,a.o)}}function gl(a,b,c){for(var d=0;d<a.o.length;d++){var e=a.o[d];if(d==a.o.length-1){b[e]=c;break}s(b[e])||(b[e]={});b=b[e]}}
function Ml(a,b,c){var d=[],e=[];c=s(c)?c:$k(a,b);s(c)&&(e.push(a.j),d.push(uj(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&g.getName()!==a.keyPath&&"_default_"!=g.getName()){var k=yl(g,b);null!=k&&(d.push(uj(k,g.type)),e.push(g.i))}}a.kc?a.kc&&!a.keyPath&&0==a.indexes.length&&(v(b)&&-1==b.indexOf(";base64,")?d.push(b):d.push(zh(b)),e.push("_default_")):(d.push(zh(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Sf:e,rg:a,values:d,key:c}}
function Ok(a,b){if(!b)return"missing store: "+a.i;if(a.i!=b.i)return"store name, expect: "+a.i+", but: "+b.i;var c=Cl(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(s(a.h)&&s(b.h)&&a.h!=b.h)return"autoIncrement, expect:  "+a.h+", but: "+b.h;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(s(a.type)&&s(b.type)&&(fa(a.type)?!gb(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=
Pj(b,a.indexes[c].getName()),e;e=a.indexes[c];if(d)if(e.h!=d.h)e="name, expect: "+e.h+", but: "+d.h;else{var f=Cl(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:s(e.type)&&s(d.type)&&(fa(e.type)?!gb(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e=
"no index for "+e.h;if(0<e.length)return'index "'+a.indexes[c].getName()+'" '+e}return""}function Xk(a,b){if(b)for(var c=0;c<a.indexes.length;c++){var d=a.indexes[c],e=b;if(d.l){var f=d.l(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||u(f)){for(g=0;g<d.g.length-1;g++)y(e[d.g[g]])||(e[d.g[g]]={});e[d.g[d.g.length-1]]=f}}}}function Nl(a,b){a.p.push(b)}function Uk(a,b,c,d,e){for(var f=0;f<a.p.length;f++)d!==f&&a.p[f].call(e,b,c)}
h.toString=function(){return"Store:"+this.i+"["+this.indexes.length+"index]"};function Ol(a,b,c){if(!a||wa(a))throw new K("store_name must be provided for primary full text index");if(!b||wa(b))throw new K("index_name must be provided for primary full text index");this.P=a;this.g=b;this.h=c||1}Ol.prototype.I=function(){return this.P};function Pl(a,b,c,d){this.name=a;this.indexes=b;this.lang=c||"";if(-1==["","en","fr"].indexOf(this.lang))throw new K('Unsupported lang "'+c+" for full text search index "+a);this.h=d||null;this.g=null}Pl.prototype.getName=function(){return this.name};Pl.prototype.count=function(){return this.indexes.length};Pl.prototype.index=function(a){return this.indexes[a]};function Ql(a,b,c){return Wa(a.indexes,function(a){return a.I()==b&&a.g==c})}
function Rl(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Qa(b,c))throw new K("Unknown field: "+c+" in "+zh(a));if(!u(a.sources))throw new K("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Qa(b,c))throw new K("Unknown field: "+c+" in "+yh(a));return new Ol(a.storeName,a.keyPath,a.weight)});return new Pl(a.name,
b,a.lang)};function Sl(a,b){var c,d,e=b;if(y(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==Qa(c,f))throw new K("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!u(g))throw new K("stores must be array");for(f=0;f<g.length;f++){var k=Nk(g[f]);if(-1!=Xa(e,function(a){return a.name==k.getName()}))throw new K('duplicate store name "'+k.getName()+'".');e.push(k)}}else v(a)?c=0==a.length?void 0:parseFloat(a):w(a)&&(c=a);if(s(c)){if(!w(c)||0>c)throw new K("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(s(b)&&(!u(b)||0<b.length&&!(b[0]instanceof Mk)))throw new K("stores");this.version=c;this.wc=!s(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=Rl(d.fullTextCatalogs[f]),c[f]=e,X(this,e.getName())||(g=[new vl("k",xl),new vl("v",xl)],e=new Mk(e.getName(),"id",!1,void 0,g),this.stores.push(e));this.g=c}h=Sl.prototype;
h.toJSON=function(){var a=Ta(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;s(this.version)&&(b.version=this.version);return b};h.wc=!1;h.Za=function(){return!1};function Vk(a){return Ta(a.stores,function(a){return a.getName()})}h.store=function(a){return this.stores[a]||null};h.count=function(){return this.stores.length};function X(a,b){return Wa(a.stores,function(a){return a.getName()==b})}function Tk(a,b){return Ua(a.stores,function(a){return a.getName()==b})}
function Tl(a,b,c,d){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var e=0;e<a.stores.length;e++){var f=X(b,a.stores[e].getName());if(f){c&&(f=Kl(f,a.stores[e]));if(d)for(var g=f,k=a.stores[e],l=0;l<k.indexes.length;l++){var m=k.indexes[l];Wk(g,m.getName())||"BLOB"!=m.type||(m=new vl(m.keyPath,m.type,m.unique,m.multiEntry,m.getName()),g.indexes.push(m))}f=Ok(a.stores[e],f);if(0<f.length)return'store: "'+a.stores[e].getName()+'" '+f}else return'missing object store "'+
a.stores[e].getName()+'"'}return""}function Ul(a,b){return Wa(a.g,function(a){return a.getName()==b})};function Pk(a,b){Sl.call(this,a,b)}B(Pk,Sl);Pk.prototype.Za=function(){return!0};function Qk(a,b){a.stores.push(b)};function Vl(a){return xh(zh(a))}function Dl(a,b){var c;c=c||{};if(null!=a&&null!=b){if(fa(a)&&fa(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Wa(b,function(b){return Dl(b,a[d])}))return!1;return!0}if(fa(a))return 1==a.length&&Dl(a[0],b);if(fa(b))return 1==b.length&&Dl(b[0],a);if(y(a)&&y(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=Dl(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=Dl(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function Wl(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Xl(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==Qa(d,e))throw new K('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!u(c.mechanisms))throw new K("mechanisms attribute must be an array but "+ea(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!Ya(Yl,c.mechanisms[e]))throw new K('Invalid mechanism "'+c.mechanisms[e]+'"');}this.N=c.mechanisms||Yl;this.G=c.size;this.T=
s(c.connectionTimeout)?c.connectionTimeout:3E4;this.i=null;this.j=[];this.Hd=!1;var f;if(b instanceof Sl)f=b;else if(y(b))for(c.autoSchema||!s(b.stores)?f=new Pk(b):f=new Sl(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=X(f,b.stores[e].name),b.stores[e].Sync&&this.Mf(d,b.stores[e].Sync);else f=new Pk;this.h=f;for(e=0;e<this.h.count();e++)if(this.h.store(e).H)throw Error("encryption option must be defined");if(s(a)){if(this.i)throw new Rc("Already connected with "+this.t);this.t=a;Rk(this)}this.p=
null;this.o=new C}Xl.prototype.logger=P("ydn.db.con.Storage");function Zl(a,b,c){return(a=X(a.h,b))?Wk(a,c):!1}function $l(a){var b;if(s(b)){var c=function(a){b(a.toJSON());b=void 0};a.i?a.i.ib(c):Ik(a,function(b){a.i.ib(c,b)},null,Jj)}return a.h?a.h.toJSON():null}Xl.prototype.getName=function(){return this.t};var Yl="indexeddb websql localstorage sessionstorage userdata memory".split(" ");h=Xl.prototype;h.ue=function(){return null};
function Rk(a){function b(b,e){b?(O(a.logger,a+": ready."),a.kg=NaN,d.dd=function(b){a.Ua(new tl(a,b))},d.ge=function(b){a.Ua(new ul(a,b));a.i=null},d.Qd=function(b){a.Ua(b)},setTimeout(function(){am(a,e);bm(a)},10),c.C(e)):(L(a.logger,a+": database connection fail "+e.name),setTimeout(function(){am(a,new ul(a,e));if(a.j){a.logger.info("Purging "+a.j.length+" transactions request.");for(var b;b=a.j.shift();)b.Wa&&b.Wa("error",e)}},10),c.D(e))}for(var c=new C,d=null,e=a.N,f=0;f<e.length;f++){var g=
e[f].toLowerCase();if(d=a.ue(g)){d=a.ue(g);break}}null===d?(e=new Ih("No storage mechanism found."),b(!1,new ul(a,e))):(a.init(),d.connect(a.t,a.h).A(function(){this.i=d;b(!0,new sl("ready",this,parseFloat(d.ee())))},function(a){L(this.logger,this+": opening fail");b(!1,a)},a))}function zk(a){if(a.i)return a.i.Ec()}h.Cb=function(a,b){this.o.fa(a,b)};function am(a,b){setTimeout(function(){b instanceof tl?a.o.D(b.error):a.o.C();a.Ua(b)},4)}function Hk(a){return!!a.i&&a.i.fe()}h.init=function(){};
function cm(a){a.i&&(a.i.de(),a.i=null,O(a.logger,a+" closed"))}h.kg=NaN;function bm(a){var b=a.j.shift();b&&(O(a.logger,"pop tx queue["+(a.j.length+1)+"]"),Ik(a,b.wd,b.scopes,b.mode,b.Wa));a.kg=A()}function dm(a,b,c,d,e){O(a.logger,"push tx queue["+a.j.length+"]");a.j.push({wd:b,scopes:c,mode:d,Wa:e});100<a.j.length&&0==a.j.length%100&&L(a.logger,"Transaction queue stack size is "+a.j.length+". It is too large, possibility due to incorrect usage.")}h.Hd=!1;
function Ik(a,b,c,d,e){var f=c;if(v(c))f=[c];else if(null!=c)if(fa(c)){if(0==c.length)throw new K("number of store names must more than 0");for(var g=0;g<c.length;g++)if(!v(c[g]))throw new K("store name at "+g+" must be string but found "+typeof c[g]);}else throw new K("store names must be an array");else f=null;if(a.i&&a.i.fe()&&!a.Hd){var k=s(d)?d:Jj;k==Lj&&(a.Hd=!0);a.i.vd(function(a){b(a);b=null},f,k,function(b,c){ha(e)&&(e(b,c),e=void 0);k==Lj&&(a.Hd=!1);bm(a)})}else dm(a,b,f,d,e)}
h.Mf=function(a){L(this.logger,"Synchronization option for "+a.getName()+" ignored.")};h.Lf=function(a){L(this.logger,"Full text indexer option for "+a.getName()+" ignored.")};h.Ua=function(){};h.toString=function(){return"Storage:"+this.i};function em(a,b,c,d){this.j=a;this.l=b;this.g=cb(c);this.h=d;this.i=[]}em.prototype.j=null;em.prototype.onCompleted=function(a,b){for(var c=0;c<this.i.length;c++)this.i[c](a,b);this.i.length=0;this.i=this.g=this.j=null};function fm(a,b,c){if(a.j)c&&a.i.push(c),b(a.j);else throw new Sc("tx committed on ParallelTxExecutor");}em.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.l+" mode:"+this.h+" scopes:"+zh(this.g)};function gm(a,b,c,d,e,f){wk.call(this,a,b,c,d,e,f);this.j=this.h=null}B(gm,wk);h=gm.prototype;h.logger=P("ydn.db.tr.Parallel");h.abort=function(){N(this.logger,this+": aborting");Ak(this.j)};
h.zg=function(a,b){var c;if("multi"==this.l)a:if(c=this.h,!c.g||!c.h||b!=c.h&&(c.h!=Kj||b!=Jj)||a.length>c.g.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.l)a:if(c=this.h,c.g&&c.h&&b==c.h&&c.g.length==a.length){for(d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.l?!0:!1;return c};
h.Nb=function(a,b,c,d){function e(c){l.i++;m=new em(c,l.i,b,k);g=l.La();M(l.logger,g+" BEGIN "+zh(b)+" "+k);l.h=m;fm(l.h,a,d)}function f(a,b){M(l.logger,g+" "+a);if(m)m.onCompleted(a,b);l.g=0}var g;this.ea&&(b=this.ea);this.Z&&(c=this.Z);var k=s(c)?c:Jj,l=this,m;if(this.h&&this.h.j&&this.zg(b,k))fm(this.h,a,d);else{if(this.N&&this.i>=this.N)throw new Rc("Exceed maximum number of transactions of "+this.N);Ik(this.K(),e,b,k,f)}};
h.request=function(a,b,c,d){var e=gm.m.request.call(this,a,b,c,d),f=this;this.Nb(function(a){f.g++;ck(e,a,f.La()+"R"+f.g)},b,c||Jj,d);return e};h.lc=function(a,b,c,d,e){var f=this,g;this.Nb(function(c){f.g++;g=f.La()+"R"+f.g;N(f.logger,g+" BEGIN");b(c,g,function(b,d){f.j=c;g=f.La()+"R"+f.g;d?(N(f.logger,g+" ERROR"),a.D(b)):(N(f.logger,g+" SUCCESS"),a.C(b));f.j=null});b=null;N(f.logger,g+" END")},c,d,e)};h.toString=function(){return"Parallel:"+this.l+":"+this.La()+(this.j?"*":"")};function hm(a,b){gm.call(this,a,b,xk)}B(hm,gm);h=hm.prototype;h.logger=P("ydn.db.tr.AtomicParallel");h.zg=function(){return!1};h.request=function(a,b,c){var d,e,f,g=this,k=hm.m.request.call(this,a,b,c,function(a,b){k.g=null;N(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new rk;T(k,c,!0)}});fk(k,function(a,b,c){f=b;e=a;d=c});return k};
h.lc=function(a,b,c,d,e){var f,g,k=new C;k.A(function(a){g=!1;f=a},function(a){g=!0;f=a});hm.m.lc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.D(c);else if(!0===g)a.D(f);else if(!1===g)a.C(f);else{var d=new rk;a.D(d)}e&&(e(b,c),e=void 0)})};h.toString=function(){return"Atomic"+hm.m.toString.call(this)};function im(a,b,c){Xl.call(this,a,b,c);this.l=0;a=!0;b=xk;c&&(s(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=jm(this,b,a);this.Qa=jm(this,"atomic",!1);this.g=this.yc(c,this.Qa)}B(im,Xl);im.prototype.l=0;im.prototype.yc=function(a,b){return new Kk(this,this.h,a,b)};
function jm(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==xk)return new Dk(a,a.l++,b,d,e,f);if("atomic"==b)return new Jk(a,a.l++);throw new K('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==xk)return new gm(a,a.l++,b,d,e,f);if("atomic"==b)return new hm(a,a.l++);throw new K('Invalid requestType "'+b+'"');}
im.prototype.Z=function(a,b,c){if(3<arguments.length)throw new K("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.l++;var d=b||Vk(this.h),e=Jj;if(c)if("readwrite"==c)e=Kj;else if("readonly"!=c)throw new K('Invalid transaction mode "'+c+'"');var f=jm(this,"all",!1,d,e,1),g=this.yc(f,this.Qa),k=new bk("run"),l=this;f.Nb(function(b){O(l.logger,"executing run in transaction on "+f);ck(k,b,f.La()+"R0");a(g)},d,e,function(a){k.g=null;T(k,f.i,
"complete"!==a)});return k};function km(a,b,c){im.call(this,a,b,c);a=this.h;for(b=0;b<a.g.length;b++){c=a.g[b];var d=X(a,c.getName());if(d){if(!Wk(d,"k"))throw new K('full text index store "'+d.getName()+'" must have "keyword" index');if(!Wk(d,"v"))throw new K('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new K('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new K('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=X(a,e.I());if(f)this.Lf(f,c);else throw new K('full text source store "'+e.I()+'" does not exist for full text index "'+c.getName()+'"');}}}B(km,im);h=km.prototype;h.init=function(){km.m.init.call(this)};h.yc=function(a,b){return new Sk(this,this.h,a,b)};h.add=function(a,b,c){return this.g.add(a,b,c)};h.count=function(a,b,c,d){return this.g.count(a,b,c,d)};h.get=function(a,b){return this.g.get(a,b)};h.keys=function(a,b,c,d,e,f,g){return this.g.keys(a,b,c,d,e,f,g)};
h.values=function(a,b,c,d,e,f){return this.g.values(a,b,c,d,e,f)};h.list=function(a,b,c,d,e,f,g,k,l){return this.g.list(a,b,c,d,e,f,g,k,l)};h.load=function(a,b,c){return this.g.load(a,b,c)};h.put=function(a,b,c){return this.g.put(a,b,c)};h.clear=function(a,b,c){return this.g.clear(a,b,c)};h.remove=function(a,b,c){return this.g.remove(a,b,c)};h.toString=function(){var a="Storage:"+this.getName();Hk(this)&&(a+=" ["+zk(this)+"]");return a};function mm(a,b,c){km.call(this,a,b,c)}B(mm,km);mm.prototype.yc=function(a,b){return new pl(this,this.h,a,b)};mm.prototype.map=function(a,b){return this.g.map(a,b)};function nm(a,b,c,d){Nj.call(this,a,b,c,d);this.l=null}B(nm,Nj);h=nm.prototype;h.logger=P("ydn.db.core.req.IDBCursor");h.Uf=function(a){(a=a.target.result)?this.fc(a.key,a.primaryKey,a.value):this.fc()};
h.openCursor=function(a,b){function c(a,b,c){p.l=n;p.l.onsuccess=oa(p.Uf,p);p.fc(a,p.j?b:void 0,c);n=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");O(this.logger,d);var e=this.aa,d=this.o.objectStore(this.P),f=v(this.xb)?d.index(this.xb):null;if(s(a))var g=f?!s(b):!0,k=e?e.lower:void 0,l=e?e.upper:void 0,m=e?!!e.lowerOpen:!1,e=e?!!e.upperOpen:!1,e=lj(this.reverse?new S(k,a,m,g):new S(a,l,g,e));var n;this.Uc?f?n=null!=this.Db?f.openKeyCursor(e,this.Db):null!=e?f.openKeyCursor(e):
f.openKeyCursor():n=null!=this.Db?d.openCursor(e,this.Db):null!=e?d.openCursor(e):d.openCursor():f?n=null!=this.Db?f.openCursor(e,this.Db):null!=e?f.openCursor(e):f.openCursor():n=null!=this.Db?d.openCursor(e,this.Db):null!=e?d.openCursor(e):d.openCursor();var p=this;n.onerror=function(a){var b=n.error;a.preventDefault();p.Z(b);Qj(p);p.G=!0};null!=a?n.onsuccess=function(d){if(d=d.target.result){var e=Mj.cmp(d.key,a),f=p.reverse?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);
else if(null!=b)if(Mj.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(p.l=n,p.l.onsuccess=oa(p.Uf,p))};h.Gd=function(){return!!this.l};h.update=function(a){var b=this.l.result;if(b){var c=new C;a=b.update(a);a.onsuccess=function(a){c.C(a.target.result)};a.onerror=function(a){a.preventDefault();c.D(a)};return c}throw new mk("cursor gone");};
h.clear=function(){var a=this.l.result;if(a){var b=new C,a=a["delete"]();a.onsuccess=function(){b.C(1)};a.onerror=function(a){a.preventDefault();b.D(a)};return b}throw new mk("cursor gone");};h.advance=function(a){var b=this.l.result;if(1==a)b["continue"]();else b.advance(a)};h.rd=function(a){var b=this.l.result;if(null!=a)b["continue"](a);else b["continue"]()};h.J=function(){nm.m.J.call(this);this.l=null};h.toString=function(){return"IDB"+nm.m.toString.call(this)};function om(a,b,c,d,e,f){C.call(this,e,f);this.j=a;this.g=[];this.p=!!b;this.Z=!!c;this.T=!!d;for(b=this.G=0;b<a.length;b++)a[b].A(oa(this.t,this,b,!0),oa(this.t,this,b,!1));0!=a.length||this.p||this.C(this.g)}B(om,C);om.prototype.t=function(a,b,c){this.G++;this.g[a]=[b,c];this.ob||(this.p&&b?this.C([a,c]):this.Z&&!b?this.D(c):this.G==this.j.length&&this.C(this.g));this.T&&!b&&(c=null);return c};om.prototype.D=function(a){om.m.D.call(this,a);for(a=0;a<this.j.length;a++)mb(this.j[a])};
function pm(a){return(new om(a,!1,!0)).B(function(a){for(var c=[],d=0;d<a.length;d++)c[d]=a[d][1];return c})};function qm(a,b){this.g=b}B(qm,vk);h=qm.prototype;h.logger=P("ydn.db.crud.req.IndexedDb");h.td=function(a,b){function c(e){var f=a.g.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?T(a,d):c(e)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}}var d=[];0==b.length?T(a,[]):c(0)};
h.jb=function(a,b,c,d,e,f){function g(t){if(null==e[t])if(O(n.logger,"empty object at "+t+" of "+e.length),l++,l==e.length)T(a,k,m);else{var z=t+10;z<e.length&&g(z)}var G,z=e[t];G=null!=f?b?r.put(z,f[t]):r.add(z,f[t]):b?r.put(z):r.add(z);G.onsuccess=function(b){l++;k[t]=b.target.result;l==e.length?T(a,c?k[0]:k,m):(b=t+10,b<e.length&&g(b))};G.onerror=function(b){l++;var f=G.error;O(n.logger,V(a)+p+' request to "'+d+'" cause '+f.name+' for object "'+yh(e[t])+'" at index '+t+" of "+e.length+" objects.");
k[t]=f;m=!0;b.preventDefault();l==e.length?T(a,c?k[0]:k,m):(b=t+10,b<e.length&&g(b))}}var k=[],l=0,m=!1,n=this,p=b?"put":"add",r=a.g.objectStore(d);O(this.logger,V(a)+" "+p+" "+e.length+' objects to store "'+d+'"');if(0<e.length)for(var t=0;10>t&&t<e.length;t++)g(t);else T(a,[])};
h.Sd=function(a,b,c){function d(l){var n=c[l],p=n.I(),r=a.g.objectStore(p),t;t=null===r.keyPath?r.put(b[l],n.F()):r.put(b[l]);t.onsuccess=function(c){f++;e[l]=c.target.result;f==b.length?T(a,e,g):(c=l+10,c<b.length&&d(c))};t.onerror=function(c){f++;L(k.logger,"request result "+c.name+' error when put keys to "'+p+'" for object "'+yh(b[l])+'" at index '+l+" of "+b.length+" objects.");e[l]=t.error;g=!0;c.preventDefault();f==b.length?T(a,e,g):(c=l+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,k=this;O(this.logger,
V(a)+" putByKeys: of "+b.length+" objects");if(0<b.length)for(var l=0;10>l&&l<b.length;l++)d(l);else T(a,e,g)};
h.nf=function(a,b,c,d,e,f){function g(){var a={},b=e.indexOf("\n",n),d=!1,t;-1==b?(d=!0,t=e.substring(n)):(t=e.substring(n,b),n=b+1);for(var b=t.split(f),J=0;J<p.length;J++){var Q=b[J];r[J]&&(r[J]==xl?Q=Ia(Q,'"'):"INTEGER"==r[J]?Q=parseInt(Q,10):"NUMERIC"==r[J]&&(Q=parseFloat(Q)));a[p[J]]=Q}var ma=l.put(a);ma.onsuccess=function(a){m.push(a.target.result);d?c(m):g()};ma.onerror=function(a){"DataError"==a.name&&(a=new jk(k+": "+t.substring(0,70)));a.preventDefault();c(ma.error,!0)}}var k=X(this.g,d),
l=a.objectStore(d),m=[],n=e.indexOf("\n"),p=e.substr(0,n).split(f),r=[];for(a=0;a<p.length;a++){var t=Pj(k,p[a]);t?r[a]=t.type:p[a]==k.keyPath&&(r[a]=k.type)}n++;O(this.logger,b+" Loading data  of "+p.length+"-fields record to "+d);g()};
h.Ud=function(a,b,c){var d=a.g.objectStore(b);O(this.logger,V(a)+" clearById: "+b+" "+c);var e=d.openCursor(pj.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){T(a,1)};c.onerror=function(){T(a,c.error,!0)}}else T(a,0)};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};
h.Vd=function(a,b){function c(k){k++;if(k>=b.length)0<g.length?T(a,g,!0):T(a,d);else{b[k].I()!=e&&(e=b[k].I(),f=a.g.objectStore(e));var l=f["delete"](b[k].F());l.onsuccess=function(){d++;c(k)};l.onerror=function(a){a.preventDefault();g[k]=l.error;c(k)}}}var d=0,e,f;O(this.logger,V(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
h.Zc=function(a,b,c){var d=a.g.objectStore(b),e=d.count(c);O(this.logger,V(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,k=d["delete"](c);k.onsuccess=function(){T(a,e)};k.onerror=function(){T(a,k.error,!0)}};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};h.re=function(a,b,c){var d=a.g.objectStore(b);O(this.logger,V(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){T(a,void 0)};e.onerror=function(b){b.preventDefault();T(a,e.error,!0)}};
h.of=function(a,b,c,d){var e=a.g.objectStore(b).index(c);O(this.logger,V(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),k=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){k++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?T(a,f,!0):T(a,k)};g.onerror=function(b){b.preventDefault();T(a,g.error,!0)}};
h.qd=function(a,b){var c=b.length,d=0;O(this.logger,V(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.g.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&T(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&T(a,f.error,!0)}}};
h.xd=function(a,b,c){var d=this;O(this.logger,V(a)+b+":"+c);var e=a.g.objectStore(b),f=e.get(c);f.onsuccess=function(b){O(d.logger,V(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");var f=b.target.result;if(!e.keyPath&&0==e.indexNames.length&&Jb&&v(f)&&0<=f.indexOf(";base64,")){'"'==f.charAt(0)&&'"'==f.charAt(f.length-1)&&(f=f.substr(1,f.length-2));f=f.split(";base64,");b=f[0].split(":")[1];for(var f=window.atob(f[1]),l=f.length,m=new Uint8Array(l),n=0;n<l;++n)m[n]=f.charCodeAt(n);
T(a,new Blob([m.buffer],{type:b}))}else T(a,b.target.result)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}};
h.ff=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==k)T(a,e);else{var m=b+10;m<k&&d(m)}var n;n=g.get(c[b]);n.onsuccess=function(c){f++;e[b]=c.target.result;f==k?T(a,e):(c=b+10,c<k&&d(c))};n.onerror=function(b){f++;b.preventDefault();T(a,n.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.g.objectStore(b),k=c.length;O(this.logger,V(a)+" "+b+":"+k+" ids");if(0<k)for(b=0;10>b&&b<k;b++)d(b);else T(a,[])};
h.Md=function(a,b){function c(f){var k=b[f],l=a.g.objectStore(k.I()).get(k.F());l.onsuccess=function(k){e++;d[f]=k.target.result;e==b.length?T(a,d):(k=f+10,k<b.length&&c(k))};l.onerror=function(b){e++;b.preventDefault();T(a,l.error,!0)}}var d=[];d.length=b.length;var e=0;O(this.logger,V(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else T(a,[])};
h.Ic=function(a,b,c,d,e){if(d&&e)throw new Rc("unique count not available in IndexedDB");e=a.g.objectStore(b);b=V(a)+" "+b+(d?":"+d:"")+(c?":"+zh(c):"");O(this.logger,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){T(a,b.target.result)};f.onerror=function(b){b.preventDefault();T(a,f.error,!0)}};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=[],p=a.g.objectStore(c),r=k?l?"prevunique":"prev":l?"nextunique":"next";c=V(a)+" "+b+" "+c+(d?":"+d:"")+(e?zh(e):"");k&&(c+=" reverse");l&&(c+=" unique");if(m&&s(m[0])){l=d?!s(m[1]):!0;var t=m[0],x=e?e.lower:void 0,z=e?e.upper:void 0,G=e?!!e.lowerOpen:!1;e=e?!!e.upperOpen:!1;e=lj(k?new S(x,t,G,l):new S(t,z,l,e));c+=" starting from "+zh(m[0]);s(m[1])&&(c+=", "+zh(m[1]))}O(this.logger,c);var E;E=1==b||2==b||3==b?d?p.index(d).openKeyCursor(e,r):p.openCursor(e,
r):d?p.index(d).openCursor(e,r):p.openCursor(e,r);var J=!1;E.onsuccess=function(c){if(c=c.target.result){if(!J){if(0<g){J=!0;c.advance(g);return}if(m&&d&&s(m[0]))if(s(m[1])){var e=Mj.cmp(c.key,m[0]),l=k?-1:1;if(0==e){e=Mj.cmp(c.primaryKey,m[1]);if(0==e){J=!0;c["continue"]();return}if(e==l)J=!0;else{c["continue"]();return}}else J=!0}else J=!0;else J=!0}1==b?n.push(c.key):2==b?n.push(c.primaryKey):3==b?(l={},d&&(l[d]=c.key),p.keyPath?l[p.keyPath]=c.primaryKey:l._ROWID_=c.primaryKey,n.push(l)):4==b?
n.push(c.value):n.push([c.key,c.primaryKey,c.value]);if(n.length<f)c["continue"]();else m&&(m[0]=Rj(c.key),m[1]=Rj(c.primaryKey)),T(a,n)}else m&&(m[0]=void 0,m[1]=void 0),T(a,n)};E.onerror=function(b){b.preventDefault();T(a,E.error,!0)}};function rm(a,b){this.g=b}B(rm,qm);rm.prototype.logger=P("ydn.db.core.req.IndexedDb");rm.prototype.h=function(a,b,c,d){c=X(this.g,c);return new nm(a,b,c,d)};function sm(){this.g=!1}sm.prototype.g=!1;function tm(a,b,c,d){Nj.call(this,a,b,c,d);this.p=this.h=this.g=void 0;this.t=this.l=null;this.N=new sm;this.Zd=this.Sb=null}B(tm,Nj);h=tm.prototype;h.logger=P("ydn.db.core.req.SimpleCursor");h.Gd=function(){return!!this.o};h.update=function(a){um(this.Zd,this.ha(),a);return tb()};h.advance=function(a){function b(b){d++;if(!b||d>=a)return vm(c,b)}var c=this,d=this.l?-1:0;this.reverse?wm(this.Sb,b,this.l):xm(this.Sb,b,this.l)};
h.rd=function(a){if(null!=a){var b=this,c=new ym(a),d=function(c){b.l=c;if(!c)return vm(b,c);var d=tj(c.value.key,a);if(b.reverse){if(1!=d)return vm(b,c)}else if(-1!=d)return vm(b,c)};this.reverse?wm(this.Sb,d,c):xm(this.Sb,d,c)}else this.advance(1)};function zm(a){setTimeout(function(){a.N.g?(a.N.g=!1,a.fc(a.g,a.h,a.p),zm(a)):(a.t(),a.t=null)},4)}
function vm(a,b){if(a.l=b){var c=b.value;if(a.aa)if(a.reverse||null==a.aa.upper)a.reverse&&null!=a.aa.lower&&(d=tj(c.key,a.aa.lower),-1==d||0==d&&a.aa.lowerOpen)&&(a.l=null);else{var d=tj(c.key,a.aa.upper);if(1==d||0==d&&a.aa.upperOpen)a.l=null}if(a.l){if(a.unique&&null!=a.g&&null!=c.key&&0==tj(a.g,c.key))return;a.g=c.key;a.h=a.j?c.ha():a.g;4==a.na&&(a.Uc?a.p=a.h:a.p=a.Zd.pa(null,a.h))}}a.l||(a.g=void 0,a.h=void 0,a.p=void 0);return a.N.g=!0}
h.openCursor=function(a,b){var c=null;if(this.aa)if(this.reverse){var d=this.j?"\uffff":void 0;null!=this.aa.upper&&(c=new ym(this.aa.upper,d))}else null!=this.aa.lower&&(c=new ym(this.aa.lower));null!=a&&(c=this.j?new ym(a,b):new ym(a));this.t=this.o.K(function(b){function d(b){var e=b.value,f=e.key;if(b&&null!=f)if(null!=a){if(0==Am(c,e))return}else if(this.aa&&(!this.reverse&&this.aa.lowerOpen&&null!=this.aa.lower&&(e=tj(f,this.aa.lower),0==e)||this.reverse&&this.aa.upperOpen&&null!=this.aa.upper&&
(e=tj(f,this.aa.upper),0==e)))return;return vm(this,b)}this.Zd=Bm(b,this.P);this.Sb=Cm(this.Zd,this.xb);this.reverse?wm(this.Sb,oa(d,this),c):xm(this.Sb,oa(d,this),c);zm(this)},this)};h.clear=function(){throw new Qc;};h.toString=function(){return"Simple"+tm.m.toString.call(this)};function Dm(a,b,c){a=["ydn.db",a];s(b)&&(a.push(b),s(c)&&(a.push(c),s(void 0)&&a.push(yj(void 0))));return a.join("^|")};function ym(a,b){this.key=a;this.g=b}ym.prototype.ha=function(){return this.g};ym.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.g?", "+this.g+")":")")};function Am(a,b){var c=tj(a.key,b.key);return 0===c?null!=a.g?null!=b.g?tj(a.g,b.g):1:null!=b.g?-1:0:c};function Em(a){this.Ta=a||Fm}function Fm(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}h=Em.prototype;h.Ba=null;h.Ta=null;h.Ab=null;h.yb=null;
h.add=function(a){if(null==this.Ba)return this.yb=this.Ab=this.Ba=new Gm(a),!0;var b=null;Hm(this,function(c){var d=null;0<this.Ta(c.value,a)?(d=c.left,null==c.left&&(b=new Gm(a,c),c.left=b,c==this.Ab&&(this.Ab=b))):0>this.Ta(c.value,a)&&(d=c.right,null==c.right&&(b=new Gm(a,c),c.right=b,c==this.yb&&(this.yb=b)));return d});b&&(Hm(this,function(a){a.count++;return a.parent},b.parent),Im(this,b.parent));return!!b};
h.remove=function(a){var b=null;Hm(this,function(c){var d=null;0<this.Ta(c.value,a)?d=c.left:0>this.Ta(c.value,a)?d=c.right:(b=c.value,Jm(this,c));return d});return b};h.clear=function(){this.yb=this.Ab=this.Ba=null};h.contains=function(a){var b=!1;Hm(this,function(c){var d=null;0<this.Ta(c.value,a)?d=c.left:0>this.Ta(c.value,a)?d=c.right:b=!0;return d});return b};h.ca=function(){return this.Ba?this.Ba.count:0};h.xa=function(){var a=[];Km(this,function(b){a.push(b)});return a};
function Km(a,b){if(a.Ba){var c,d=c=Lm(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Hm(a,b,c){for(c=c?c:a.Ba;c&&null!=c;)c=b.call(a,c)}
function Im(a,b){Hm(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Mm(this,a.left),Nm(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Nm(this,a.right),Mm(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Mm(a,b){Om(b)?(b.parent.left=b.right,b.right.parent=b.parent):Pm(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.Ba=b.right,a.Ba.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Nm(a,b){Om(b)?(b.parent.left=b.left,b.left.parent=b.parent):Pm(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.Ba=b.left,a.Ba.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Jm(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Qm(a,b.left);Hm(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.yb&&(a.yb=d)}else{d=Lm(a,b.right);Hm(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.Ab&&(a.Ab=d)}d.count=b.count;Om(b)?b.parent.left=d:Pm(b)?b.parent.right=d:a.Ba=d;Im(a,c?c:d)}else Hm(a,function(a){a.count--;return a.parent},b.parent),Om(b)?(b.parent.left=null,b==a.Ab&&(a.Ab=b.parent),Im(a,b.parent)):Pm(b)?(b.parent.right=null,b==a.yb&&(a.yb=b.parent),Im(a,b.parent)):a.clear()}function Lm(a,b){if(!b)return a.Ab;var c=b;Hm(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Qm(a,b){if(!b)return a.yb;var c=b;Hm(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Gm(a,b){this.value=a;this.parent=b?b:null;this.count=1}Gm.prototype.left=null;Gm.prototype.right=null;Gm.prototype.height=1;function Pm(a){return!!a.parent&&a.parent.right==a}function Om(a){return!!a.parent&&a.parent.left==a};function Rm(a){this.Ta=a||Fm}B(Rm,Em);function xm(a,b,c){if(a.Ba){var d;if(c instanceof Gm)d=c;else if(c){if(Hm(a,function(a){var b=null;0<this.Ta(a.value,c)?(b=a.left,d=a):0>this.Ta(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Lm(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function wm(a,b,c){if(a.Ba){var d;if(c instanceof Gm)d=c;else if(c){if(Hm(a,oa(function(a){var b=null;0<this.Ta(a.value,c)?b=a.left:(0>this.Ta(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Qm(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Sm(a,b,c){this.l=a;this.storage=b;this.h=c;this.g={};a=this.h.keyPath;this.i=u(a)?a.join(","):a||"_ROWID_";this.g[this.i]=null;this.j=Dm(this.l,this.h.getName(),this.i)+"^|"}
function Cm(a,b){var c=b||a.i;if(!a.g[c]){a.g[c]=new Rm(Am);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&ta(f,a.j)){var g=Bj(f.substr(a.j.length));if(c==a.i)a.g[c].add(new ym(g));else{var k=a.storage.getItem(f);if(null!==k)if(f=Pj(a.h,c),k=xh(k),k=yl(f,k),f.multiEntry){if(u(k))for(f=0;f<k.length;f++)a.g[c].add(new ym(k[f],g))}else a.g[c].add(new ym(k,g))}}}}return a.g[c]}
function Tm(a,b,c){for(var d in a.g){var e=a.g[d];if(e)if(d==a.i)e.remove(new ym(b));else{var f=Pj(a.h,d),f=vj(c,f.keyPath);e.remove(new ym(b,f))}}}function Um(a){for(var b in a.g){var c=a.g[b];c&&c.clear()}a.g={}}
function um(a,b,c,d){if(null==b&&(a.h.keyPath&&(b=$k(a.h,c)),a.h.h&&null==b)){b=a.j+yj(void 0);var e=xh(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,zh(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.j+yj(b)));if(d)return null;a.storage.setItem(a.j+yj(b),zh(c));d=b;for(var f in a.g)if(e=a.g[f])if(f==a.i)e.add(new ym(d));else{var g=Pj(a.h,f),g=vj(c,g.keyPath);null!=g&&e.add(new ym(d,g))}return b}
function Vm(a,b){var c=a.j+yj(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=xh(d);Tm(a,b,c);return 1}h=Sm.prototype;h.clear=function(){Um(this);Wm(this)};h.pa=function(a,b){if(a&&a!=this.i)throw"impl";var c=this.storage.getItem(this.j+yj(b)),d=void 0;if(null!==c)for(var d=xh(c),c=0,e=this.h.indexes.length;c<e;c++){var f=this.h.index(c);if("DATE"==f.type){var g=yl(f,d);g&&zl(f,d,new Date(g))}}return d};h.getName=function(){return this.h.getName()};
function Xm(a,b,c){b=b||a.i;a=Cm(a,b);var d=null,e=null,f=0,g=!1,k=!1;null!=c&&(null!=c.lower&&(d=new ym(c.lower)),null!=c.upper&&(e=new ym(c.upper)),g=c.lowerOpen,k=c.upperOpen);xm(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=tj(a.key,d.key))){if(null!=e&&(a=tj(a.key,e.key),1===a||0===a&&k))return!0;f++}},d);return f}
function Wm(a,b){var c=Cm(a,a.i),d=null,e=null,f=0,g=[],k=[],l=!1,m=!1;null!=b&&(null!=b.lower&&(d=new ym(b.lower)),null!=b.upper&&(e=new ym(b.upper)),l=b.lowerOpen,m=b.upperOpen);xm(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=Am(b,d))){if(null!=e){var c=Am(b,e);if(1===c||0===c&&m)return!0}var c=a.j+yj(b.key),r=a.storage.getItem(c);null!==r&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),k.push(xh(r))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Tm(a,g[c],k[c]);else Um(a);return f}
h.yd=function(a,b,c,d,e,f,g,k){function l(b){if(b&&(z++,!(z<f))){var c=b.value;if(d){if(E&&null!=x&&(b=p?Am(c,x):tj(c.key,x.key),0==b))return;if(null!=t&&(b=p?Am(c,t):tj(c.key,t.key),-1==b||0==b&&G))return k&&(k[0]=void 0,k[1]=void 0),!0}else{if(G&&null!=t&&(b=p?Am(c,t):tj(c.key,t.key),0==b))return;if(null!=x&&(b=p?Am(c,x):tj(c.key,x.key),1==b||0==b&&E))return k&&(k[0]=void 0,k[1]=void 0),!0}b=c.key;if(!g||!r||null==n||0!=tj(n,b)){c=r?c.ha():b;if(2==a)m.push(c);else if(1==a)m.push(b);else if(3==a)m.push([b,
c]);else if(4==a){var l=Q.pa(null,c);m.push(l)}else m.push([b,c,Q.pa(null,c)]);k&&(k[0]=b,k[1]=c)}n=b;if(s(e)&&m.length>=e)return!0}}var m=[],n,p=!!k&&null!=k[0];b=b||this.i;var r=b!=this.i;b=Cm(this,b);var t=null,x=null;s(f)||(f=0);var z=-1,G=!1,E=!1;null!=c&&(null!=c.lower&&(t=r&&d?new ym(c.lower,"\uffff"):new ym(c.lower)),null!=c.upper&&(x=r&&!d?new ym(c.upper,"\uffff"):new ym(c.upper)),G=!!c.lowerOpen,E=!!c.upperOpen);if(p){d?E=!0:G=!0;c=k[0];var J=s(k[1])?k[1]:"\uffff";d?x=r?new ym(c,J):new ym(c):
t=r?new ym(c,J):new ym(c)}var Q=this;d?wm(b,l,x):xm(b,l,t);return m};h.Ma=function(a,b,c,d,e){return this.yd(2,a,b,c,d,e)};h.toString=function(){return"ydn.db.con.simple.Store:"+this.l+":"+this.h.getName()};function Ym(){this.clear()}h=Ym.prototype;h.te=function(){return this};h.setItem=function(a,b){s(this.g[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.g[a]=b};h.getItem=function(a){return s(this.g[a])?this.g[a]:null};h.removeItem=function(a){delete this.g[a];$a(this.keys,a.toString());this.length=this.keys.length};h.length=0;h.key=function(a){a=this.keys[a];return s(a)?this.g[a]:null};h.clear=function(){this.g={};this.keys=[];this.length=0};function Zm(a){this.o=a||new Ym;this.l={}}function Bm(a,b){var c=X(a.g,b);if(c)a.l[b]||(a.l[b]=new Sm(a.i,a.j,c));else throw new Sc('store name "'+b+'" not found.');return a.l[b]}Zm.prototype.ib=function(a){var b=this;setTimeout(function(){var c=Dm(b.i),c=b.j.getItem(c),c=new Sl(c);a(c)},10)};function $m(a,b){this.h=a;this.g=b}$m.prototype.K=function(a,b){var c=this.h;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.g("complete",null);d.g=null;d.h=null}};function an(a,b){this.g=b}B(an,vk);h=an.prototype;h.logger=P("ydn.db.crud.req.SimpleStore");h.Sd=function(a,b,c){this.jb(a,!0,!1,null,b,c)};
h.jb=function(a,b,c,d,e,f){O(this.logger,V(a)+" "+(b?"put":"add")+"Object"+(c?"":"s "+e.length+" objects"));var g=a.g.K(function(k){var l;if(c)l=Bm(k,d),k=f?f[0]:void 0,k=um(l,k,e[0],!b),null!=k?T(a,k):(l=yh(k),l=new ik(l),T(a,l,!0));else{for(var m=d,n=[],p=!1,r=f||{},t=0;t<e.length;t++){var x;d?x=r[t]:(m=f[t],x=m.F(),m=m.I());l&&l.getName()==m||(l=Bm(k,m));x=um(l,x,e[t],!b);null!=x?n.push(x):(p=!0,n.push(new ik))}T(a,n,p)}g();g=null},this)};h.nf=function(){throw new Qc("putData");};
h.xd=function(a,b,c){var d=a.g.K(function(e){e=Bm(e,b).pa(null,c);T(a,e);d();d=null},this)};function bn(a,b,c,d){var e=b.g.K(function(a){for(var g=[],k=c,l,m=0;m<d.length;m++){var n=d[m];n instanceof sk&&(k=n,n=k.F(),k=k.I());l&&l.getName()==k||(l=Bm(a,k));n=l.pa(null,n);g[m]=n}T(b,g,!1);e();e=null},a)}h.ff=function(a,b,c){bn(this,a,b,c)};h.Md=function(a,b){bn(this,a,null,b)};
h.Ud=function(a,b,c){var d=V(a)+" removeById "+b+" "+c;O(this.logger,d);var e=this,f=a.g.K(function(g){g=Vm(Bm(g,b),c);N(e.logger,"success "+d+(0==g?" [not found]":""));T(a,g);f();f=null},this)};h.Vd=function(a,b){O(this.logger,V(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=a.g.K(function(f){for(var g=0;g<b.length;g++){var k=b[g].I(),l=b[g].F();c&&c.getName()==k||(c=Bm(f,k));d+=Vm(c,l)}T(a,d);e();e=null},this)};h.re=function(a,b,c){this.Zc(a,b,c)};
h.Zc=function(a,b,c){var d=V(a)+" removeByKeyRange "+(c?zh(c):"");O(this.logger,d);var e=this,f=a.g.K(function(g){g=Wm(Bm(g,b),c);N(e.logger,d+" deleted "+g+" records.");T(a,g);f();f=null},this)};h.of=function(a,b,c,d){var e=V(a)+" removeByIndexKeyRange "+(d?zh(d):"");O(this.logger,e);var f=a.g.K(function(e){e=Bm(e,b);for(var k=e.Ma(c,d),l=k.length,m=0;m<l;m++)Vm(e,k[m]);T(a,l);f();f=null},this)};
h.qd=function(a,b){var c=V(a)+" clearByStores";O(this.logger,c);var d=a.g.K(function(e){for(var f=0;f<b.length;f++)Bm(e,b[f]).clear();N(this.logger,"success "+c);T(a,b.length);d();d=null},this)};h.td=function(a,b){var c=a.g.K(function(d){for(var e=[],f=0;f<b.length;f++){var g=Bm(d,b[f]);e.push(Xm(g))}T(a,e);c();c=null},this)};
h.Ic=function(a,b,c,d){var e=V(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");O(this.logger,e);var f=a.g.K(function(g){g=Xm(Bm(g,b),d,c);N(this.logger,"success "+e);T(a,g);f();f=null},this)};h.list=function(a,b,c,d,e,f,g,k,l,m){var n=V(a)+" "+c+" "+(e?yh(e):"");O(this.logger,n);var p=a.g.K(function(r){r=Bm(r,c).yd(b,d,e,k,f,g,l,m);N(this.logger,n+" "+r.length+" records found.");T(a,r);p();p=null},this)};function cn(a,b){this.g=b}B(cn,an);cn.prototype.h=function(a,b,c,d){c=X(this.g,c);return new tm(a,b,c,d)};function dn(a,b,c,d){Nj.call(this,a,b,c,d);this.N=null;this.t=this.l=void 0}B(dn,Nj);h=dn.prototype;h.logger=P("ydn.db.core.req.WebsqlCursor");h.ha=function(){return this.t};h.init=function(a,b,c,d,e){dn.m.init.call(this,a,b,c,d,e);this.N=v(b)?Pj(this.i,b):null};h.V=function(){return this.ea};function en(a,b){a.l=void 0;a.t=void 0;a.ea=void 0;if(s(b))if(y(b)){var c=Al(b[a.i.l],a.i.type);a.t=c;if(a.j){var d=Pj(a.i,a.xb);a.l=Al(b[a.xb],d.type)}else a.l=c;a.ea=a.Uc?c:fn(b,a.i)}else a.ea=b}
function gn(a,b,c,d,e,f){var g=!d;d=[];a.j&&null!=f&&null!=c?c=Jl(a.i,a.na,d,a.N.getName(),a.aa,c,g,f,a.reverse,a.unique):null!=c?(f=a.N?a.N.getName():null,c=Il(a.i,a.na,d,f,a.aa,a.reverse,a.unique,c,g)):(c=Fl(a.i,d,a.na,a.j?a.N.j:a.i.l,a.aa,a.reverse,a.unique),a.j&&(c+=", "+a.i.j+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);O(a.logger,a+": continue:  SQL: "+c+" : "+zh(d));a.o.executeSql(c,d,function(c,d){0<d.rows.length?en(a,d.rows.item(0)):en(a);b.call(a,a.l,a.t,a.ea);b=null},function(c,d){L(a.logger,
"get error: "+d.message);a.Z(d);Qj(a);a.G=!0;en(a);b.call(a,a.t,a.l,a.ea);b=null;return!1})}h.Gd=function(){return!!this.o};h.update=function(a){if(!this.Gd())throw new mk;var b=new C,c=this.ha();a=Ml(this.i,a,c);var d="REPLACE INTO "+Hl(this.i)+" ("+a.Sf.join(", ")+") VALUES ("+a.rg.join(", ")+")";O(this.logger,this+': update "'+d+'" : '+zh(a.values));this.o.executeSql(d,a.values,function(){b.C(c)},function(a,c){b.D(c);return!1});return b};
h.advance=function(a){var b=this.l,c=this.t,d=!0;null==this.l||this.j&&null==this.t||(a-=1,d=!1);gn(this,function(a,d,g){var k=null!=b&&null!=a&&0==tj(b,a);if(this.j){var l=null!=d&&null!=c&&0==tj(d,c);if(k&&l)throw new Sc("current: "+b+";"+c+" next: "+a+";"+d);}else if(k)throw new Sc("current: "+b+" next: "+a);this.fc(a,d,g)},this.l,d,a,this.t)};h.rd=function(a){null!=a?gn(this,this.fc,a,!0):this.advance(1)};h.openCursor=function(a,b){gn(this,this.fc,a,!1,0,b)};
h.clear=function(){if(!this.Gd())throw new mk;var a=new C,b=this.i.l,b="DELETE FROM "+Hl(this.i)+" WHERE "+b+" = ?",c=[this.ha()];O(this.logger,this+': clear "'+b+'" : '+zh(c));this.o.executeSql(b,c,function(b,c){a.C(c.rowsAffected)},function(b,c){a.D(c);return!1});return a};h.toString=function(){return"WebSql"+dn.m.toString.call(this)};function hn(a,b){this.g=b}B(hn,vk);h=hn.prototype;h.logger=P("ydn.db.crud.req.WebSql");
function fn(a,b){if(b.kc&&!b.keyPath&&0==b.indexes.length&&a._default_){var c=a._default_;if(-1==c.indexOf(";base64,"))return xh(c);'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substr(1,c.length-2));for(var d=c.split(";base64,"),c=d[0].split(":")[1],d=window.atob(d[1]),e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f.buffer],{type:c})}c=a._default_?xh(a._default_):{};null!=b.keyPath&&(d=Al(a[b.keyPath],b.type),null!=d&&gl(b,c,d));for(d=0;d<b.indexes.length;d++)e=
b.index(d),f=e.j,"_default_"==f||e.o||e.multiEntry||"DATE"!=e.type&&!b.kc||(f=Al(a[f],e.type),s(f)&&zl(e,c,f));return c}h.nf=function(){throw new Qc("putData");};
h.jb=function(a,b,c,d,e,f){function g(b,d){if(null==e[b])if(O(m.logger,"empty object at "+b+" of "+e.length),p++,p==e.length)N(m.logger,r+" success "+r),T(a,n,t);else{var G=b+2;G<e.length&&g(G,d)}var E;E=s(f)?Ml(k,e[b],f[b]):Ml(k,e[b]);G=l+Hl(k)+" ("+E.Sf.join(", ")+") VALUES ("+E.rg.join(", ")+");";O(m.logger,V(a)+" SQL: "+G+" PARAMS: "+E.values+" REQ: "+b+" of "+e.length);d.executeSql(G,E.values,function(f,r){function G(b,c){var e="ydn.db.me:"+k.getName()+":"+b.getName(),e=l+La(e)+" ("+k.j+", "+
b.i+") VALUES (?, ?)",f=[uj(I,k.type),uj(c,b.type)];O(m.logger,V(a)+" multiEntry "+e+" "+f);d.executeSql(e,f,function(){},function(a,b){L(m.logger,"multiEntry index insert error: "+b.message);return!1})}p++;var I=s(E.key)?E.key:r.insertId;1>r.rowsAffected&&(t=!0,I=new ik(I+" no-op"));for(var vc=0,Xi=k.indexes.length;vc<Xi;vc++){var dd=k.index(vc);if(dd.multiEntry)for(var Vd=vj(e[b],dd.keyPath),wv=(Vd?Vd.length:0)||0,lm=0;lm<wv;lm++)G(dd,Vd[lm])}c?T(a,I):(n[b]=I,p==e.length?T(a,n,t):(vc=b+2,vc<e.length&&
g(vc,f)))},function(d,f){p++;t=!0;6==f.code?f.name="ConstraintError":L(m.logger,"error: "+f.message+" "+r);if(c)T(a,f,!0);else if(n[b]=f,p==e.length)O(m.logger,"success "+r),T(a,n,t);else{var k=b+2;k<e.length&&g(k,d)}return!1})}b=!b;var k=X(this.g,d),l=b?"INSERT INTO ":"INSERT OR REPLACE INTO ";d=a.g;var m=this,n=[],p=0,r=V(a)+" inserting "+e.length+" objects.",t=!1;if(0<e.length)for(b=0;2>b&&b<e.length;b++)g(b,d);else N(this.logger,"success"),T(a,[])};
h.Sd=function(a,b,c){if(0==c.length)T(a,[]);else{for(var d=[],e=0,f=0,g=this,k=function(k,l){var m=[];O(g.logger,"put "+l.length+" objects to "+k);for(var n=Ll(X(g.g,k)),p=n?void 0:[],r=0;r<l.length;r++)m.push(b[l[r]]),n||p.push(c[l[r]].F());n=dk(a);n.A(function(b){for(var c=0;c<l.length;c++)d[l[c]]=b[c];e++;e==f&&T(a,d)},function(){e++;e==f&&T(a,d,!0)});g.jb(n,!1,!1,k,m,p)},l="",m=[],n=[],p=0;p<c.length;p++){var r=c[p].I(),t=c[p].F();r!=l?(f++,0<m.length&&k(l,m),m=[p],n=[t],l=r):(m.push(p),n.push(t))}0<
m.length&&k(l,m)}};h.xd=function(a,b,c){var d=a.g,e=X(this.g,b),f=this;b=e.j;c=[uj(c,e.type)];b="SELECT * FROM "+Hl(e)+" WHERE "+b+" = ?";var g=V(a)+" SQL: "+b+" PARAMS: "+c;O(this.logger,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=fn(d,e),T(a,d)):(N(f.logger,"success no result: "+g),T(a,void 0))}else N(f.logger,"success no result: "+g),T(a,void 0)},function(b,c){L(f.logger,"error: "+g+" "+c.message);T(a,c,!0);return!1})};
h.ff=function(a,b,c){function d(b,e){var p=l.j,r=[uj(c[b],l.type)],t="SELECT * FROM "+Hl(l)+" WHERE "+p+" = ?";O(f.logger,"SQL: "+t+" PARAMS: "+r);e.executeSql(t,r,function(e,f){k++;if(0<f.rows.length){var n=f.rows.item(0);null!=n&&(g[b]=fn(n,l))}else g[b]=void 0;k==c.length?T(a,g):(n=b+10,n<c.length&&d(n,e))},function(e,l){k++;L(f.logger,"error: "+t+" "+l.message);if(k==c.length)T(a,g);else{var n=b+10;n<c.length&&d(n,e)}return!1})}var e=a.g,f=this,g=[],k=0,l=X(this.g,b);if(0<c.length)for(b=0;10>
b&&b<c.length;b++)d(b,e);else N(f.logger,"success"),T(a,[])};
h.Md=function(a,b){function c(d,k){var n=b[d],p=X(e.g,n.I()),r=tk(n),n=p.j,r=[uj(r,p.type)],t="SELECT * FROM "+Hl(p)+" WHERE "+n+" = ?";O(e.logger,"SQL: "+t+" PARAMS: "+r);k.executeSql(t,r,function(k,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=fn(n,p))}else f[d]=void 0;g==b.length?(O(e.logger,"success "+t),T(a,f)):(n=d+10,n<b.length&&c(n,k))},function(b,c){T(a,c,!0);return!1})}var d=a.g,e=this,f=[],g=0;if(0<b.length)for(var k=0;10>k&&k<b.length;k++)c(k,d);else O(this.logger,"success"),
T(a,[])};
h.qd=function(a,b){function c(d,g){function k(a){a="ydn.db.me:"+l.getName()+":"+a.getName();a="DELETE FROM  "+La(a);O(e.logger,"SQL: "+a);g.executeSql(a,[])}var l=X(e.g,b[d]),m="DELETE FROM  "+Hl(l);O(e.logger,"SQL: "+m+" PARAMS: []");g.executeSql(m,[],function(g){d==b.length-1?(O(e.logger,"success "+m),T(a,b.length)):c(d+1,g)},function(b,c){T(a,c,!0);return!1});for(var n=0,p=l.indexes.length;n<p;n++){var r=l.index(n);r.multiEntry&&k(r)}}var d=a.g,e=this;0<b.length?c(0,d):(O(this.logger,"success"),
T(a,0))};
h.Vd=function(a,b){function c(k){if(k>=b.length)T(a,f,g);else{var l=X(e.g,b[k].I()),m=uj(b[k].F(),l.type),n=" WHERE "+l.j+" = ?",p="DELETE FROM "+Hl(l)+n,r=V(a)+" SQL: "+p+" PARAMS: "+[m];d.executeSql(p,[m],function(){f++;c(k)},function(a,b){L(e.logger,"error: "+r+b.message);g=!0;c(k);return!1});k++;for(var p=function(b){b="ydn.db.me:"+l.getName()+":"+b.getName();b="DELETE FROM  "+La(b)+n;O(e.logger,V(a)+NaN+b);d.executeSql(b,[m])},t=0,x=l.indexes.length;t<x;t++){var z=l.index(t);z.multiEntry&&p(z)}}}
var d=a.g,e=this,f=0,g=!1;O(this.logger,V(a)+" removeByKeys: "+b.length+" keys");c(0)};
h.Ud=function(a,b,c){function d(b){b="ydn.db.me:"+f.getName()+":"+b.getName();b="DELETE FROM  "+La(b)+l;O(k.logger,V(a)+NaN+b);e.executeSql(b,[g])}var e=a.g,f=X(this.g,b),g=uj(c,f.type),k=this,l=" WHERE "+f.j+" = ?";b="DELETE FROM "+Hl(f)+l;O(this.logger,V(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){T(a,c.rowsAffected)},function(b,c){T(a,c,!0);return!1});b=0;for(c=f.indexes.length;b<c;b++){var m=f.index(b);m.multiEntry&&d(m)}};h.re=function(a,b,c){jn(this,a,b,void 0,c)};
h.Zc=function(a,b,c){jn(this,a,b,void 0,c)};h.of=function(a,b,c,d){jn(this,a,b,c,d)};
function jn(a,b,c,d,e){function f(c){c="ydn.db.me:"+k.getName()+":"+c.getName();c="DELETE FROM  "+La(c)+n;O(a.logger,V(b)+NaN+c);g.executeSql(c,m)}var g=b.g,k=X(a.g,c);c="DELETE FROM "+Hl(k);var l=[],m=[],n="";null!=e&&(s(d)?(d=Pj(k,d),sj(d.i,d.type,e,m,l)):sj(k.j,k.type,e,m,l),n=" WHERE "+m.join(" AND "));c+=n;var p=V(b)+" SQL: "+c+" PARAMS: "+l;O(a.logger,p);g.executeSql(c,l,function(c,d){O(a.logger,"success "+p);T(b,d.rowsAffected)},function(c,d){L(a.logger,"error: "+p+d.message);T(b,d,!0);return!1});
e=0;for(d=k.indexes.length;e<d;e++)c=k.index(e),c.multiEntry&&f(c)}h.td=function(a,b){function c(g){var k="SELECT COUNT(*) FROM "+La(b[g]);O(e.logger,"SQL: "+k+" PARAMS: []");d.executeSql(k,[],function(d,e){var k=e.rows.item(0);f[g]=parseInt(k["COUNT(*)"],10);g++;g==b.length?T(a,f):c(g)},function(b,c){T(a,c,!0);return!1})}var d=a.g,e=this,f=[];0==b.length?(O(this.logger,"success"),T(a,0)):c(0)};
h.Ic=function(a,b,c,d,e){var f=[];b=Fl(X(this.g,b),f,6,d,c,!1,e);O(this.logger,V(a)+" SQL: "+b+" PARAMS: "+f);a.g.executeSql(b,f,function(b,c){var d=c.rows.item(0);T(a,Wl(d))},function(b,c){T(a,c,!0);return!1})};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=this,p=[],r=X(this.g,c),t=r.l,x=r.type,z=x,G=null!=d&&d!==t?Pj(r,d):null,E=d||t;G&&(z=G.type);c=[];if(m&&s(m[0])){var J=m[0];G&&s(m[1])?(d=m[1],e=Jl(r,b,c,G.getName(),e,J,!0,d,k,l)):e=Il(r,b,c,d,e,k,l,J,!0)}else e=Fl(r,c,b,E,e,k,l);w(f)&&(e+=" LIMIT "+f);w(g)&&(e+=" OFFSET "+g);var Q=a+" SQL: "+e+" ;params= "+zh(c);O(this.logger,Q);a.g.executeSql(e,c,function(c,d){for(var e=d.rows.length,f,g=0;g<e;g++)f=d.rows.item(g),2==b?p[g]=Al(f[t],x):1==b?p[g]=Al(f[E],
z):3==b?p[g]=[Al(f[E],z),Al(f[t],x)]:null!=f&&(p[g]=fn(f,r));N(n.logger,"success "+a);m&&f&&(m[0]=Al(f[E],z),m[1]=Al(f[t],x));T(a,p)},function(b,c){L(n.logger,"error: "+Q+c.message);T(a,c,!0);return!1})};function kn(a,b){this.g=b}B(kn,hn);kn.prototype.logger=P("ydn.db.core.req.WebSql");kn.prototype.h=function(a,b,c,d){c=X(this.g,c);return new dn(a,b,c,d)};mm.prototype.H=function(){var a=zk(this);if("indexeddb"==a)return new rm(0,this.h);if("websql"==a)return new kn(0,this.h);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new cn(0,this.h);throw new Sc("No executor for "+a);};function ln(a){return v(a)?a.replace(/\D/g,"").replace(/^0+/,""):null}function mn(a){if(!v(a)||!/[\w\+]+@\w+\.\w+/.test(a))return null;a=a.replace(/.*</,"").replace(/>.*/,"");a=a.toLowerCase();a=a.replace(/\+\w*?@/,"@");for(var b=a.indexOf("@");0<=b;b--);return a};function nn(a){if(!v(a))throw new Eh;this.Ya=a;this.j=Kj;this.g=[];on(this,a);this.cd=""}h=nn.prototype;h.Ya="";h.lg=NaN;h.ng=NaN;h.wf=!1;h.cd="";
function on(a,b){var c=b.split(/\sFROM\s/i);if(2==c.length){var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==c.length){a.l=c[1].toUpperCase();if("SELECT"==a.l)a.j=Jj;else if("INSERT"==a.l)a.j=Kj;else if("UPDATE"==a.l)a.j=Kj;else if("DELETE"==a.l)a.j=Kj;else return;var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.i=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.i=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-
1):new qk("missing closing parentheses"));a.H=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.h=d.substring(c),d=d.substring(0,c)):a.h="";c=d.search(/WHERE/i);0<c?(a.o=d.substring(c+6).trim(),d=d.substring(0,c)):a.o="";a.g=d.trim().split(",").map(function(a){a=Ia(a,'"');a=Ia(a,"'");return a.trim()})}}}
h.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.Ya=this.Ya.replace("?",a[b]);on(this,this.Ya)}this.p=pn(this);if(!this.p)return this.cd;a=this.h.length;if(b=/OFFSET\s+(\d+)/i.exec(this.h))this.ng=parseInt(b[1],10),a=this.h.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.h))this.lg=parseInt(b[1],10),b=this.h.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.h.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.wf="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.wf=!1,this.t=Ia(Ia(a,'"'),"'")):this.t=void 0;return""};function qn(a){if("*"==a.H)return null;a=a.H.split(",");return a=a.map(function(a){return Ia(a.trim(),'"')})}h.toJSON=function(){return{sql:this.Ya}};
function pn(a){function b(a){return Xa(c,function(b){return b.Mc()==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.o.length)for(var e=a.o.split("AND"),f=0;f<e.length;f++){var g=e[f],k=d.exec(g);if(k){var l=k[1].trim(),l=Ia(l,'"'),l=Ia(l,"'");if(0<l.length){var m=k[3].trim();ta(m,'"')?m=Ia(m,'"'):ta(m,"'")?m=Ia(m,"'"):m=parseFloat(m);k=new Gj(l,k[2],m);l=b(l);if(0<=l){if(c[l]=c[l].pe(k),!c[l])return a.cd='where clause "'+g+'" conflict',null}else c.push(k)}else return a.cd='Invalid clause "'+g+'"',
null}else return a.cd='Invalid clause "'+g+'"',null}return c}h.toString=function(){return"query:"+this.Ya};function rn(a,b){this.g=b;this.h=a}rn.prototype.logger=P("ydn.db.sql.req.nosql.Node");rn.prototype.toJSON=function(){return{sql:this.g}};rn.prototype.toString=function(){return"idb.Node:"};
rn.prototype.execute=function(a,b){var c=cb(this.g.g)[0],d=this.g.p,e=this.g.lg,e=isNaN(e)?100:e,f=this.g.ng,f=isNaN(f)?0:f,g=this.g.t,k=qn(this.g),l=null,m=this.g.wf;if(0==d.length)l=null;else if(1==d.length)l=mj(d[0].g);else throw new Pc("too many conditions.");null===k||fk(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=k.length;if(1==b)return vj(a,k[0]);for(var c={},d=0;d<b;d++)c[k[d]]=vj(a,k[d]);return c}));c(d,b)});var d=0<d.length?d[0].Mc():void 0,n=V(a)+" executing on"+c;d&&(n+=":"+
d);n+=" "+rj(l);N(this.logger,n);g&&g!=this.h.keyPath?b.list(a,4,c,g,l,e,f,m,!1):s(d)&&d!=this.h.keyPath?b.list(a,4,c,d,l,e,f,m,!1):b.list(a,4,c,null,l,e,f,m,!1)};function sn(a,b){rn.call(this,a,b)}B(sn,rn);
sn.prototype.execute=function(a,b){var c,d=cb(this.g.g)[0],e=this.g.p,f=null;if(0==e.length)f=null;else if(1==e.length)f=mj(e[0].g);else throw new Pc("too many conditions.");var g=this.g.i,e=0<e.length?e[0].Mc():void 0,k=V(a)+" executing "+g+" on "+d;e&&(k+=":"+e);k+=" "+rj(f);N(this.logger,k);if("COUNT"==g)f?b.Ic(a,d,f,e,!1):b.Ic(a,d,null,void 0,!1);else{var l,k=qn(this.g);if(!k||0==k.length)throw new Kh("field name require for reduce operation: "+g);k=k[0];if("MIN"==g)l=tn(k);else if("MAX"==g)l=
un(k);else if("AVG"==g)c=0,l=vn(k);else if("SUM"==g)c=0,l=wn(k);else throw new Fh(g);var m;s(e)?m=new Yj(d,e,f):m=new Xj(d,f);var d=b.h(a.g,V(a),d,4),n=m.load([d]);n.Z=function(b){T(a,b,!0)};var p=0;n.T=function(b){null!=b?(b=m.g?n.ha():n.V(),c=l(b,c,p),n.advance(1),p++):T(a,c)}}};function vn(a){return function(b,c,d){s(c)||(c=0);return(c*d+b[a])/(d+1)}}function wn(a){return function(b,c){return c+b[a]}}function tn(a){return function(b,c){var d=b[a];return s(c)?c<d?c:d:d}}
function un(a){return function(b,c){var d=b[a];return s(c)?c>d?c:d:d}};function xn(a,b){this.g=b}B(xn,rm);xn.prototype.logger=P("ydn.db.sql.req.IndexedDb");xn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new qk(c);c=cb(b.g);if(1==c.length){var d=X(this.g,c[0]);if(!d)throw new nk(c[0]);var e=qn(b);if(e)for(var f=0;f<e.length;f++)if(!Wk(d,e[f]))throw new nk('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new sn(d,b):g=new rn(d,b);g.execute(a,this)}else throw new Fh(b.Ya);};function yn(a,b){this.h=b;this.i=a;this.g=qn(b)}yn.prototype.logger=P("ydn.db.sql.req.websql.Node");yn.prototype.toJSON=function(){return{sql:this.h.Ya}};yn.prototype.toString=function(){return"websql.Node:"};function zn(a,b){if(a.g){if(1==a.g.length){if(y(b))return lc(b,a.g[0]);return}for(var c={},d=0;d<a.g.length;d++)c[a.g[d]]=lc(b,a.g[d]);return c}return fn(b,a.i)}
yn.prototype.execute=function(a,b,c){var d=this,e=[];b.executeSql(this.h.Ya,c,function(b,c){for(var k=c.rows.length,l=0;l<k;l++){var m=c.rows.item(l);if(y(m))var n=zn(d,m);e.push(n)}a(e)},function(b,c){L(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function An(a,b){yn.call(this,a,b)}B(An,yn);An.prototype.execute=function(a,b,c){var d=this;b.executeSql(this.h.Ya,c,function(b,c){var d=c.rows.length;if(1==d)d=Wl(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new lk;},function(b,c){L(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function Bn(a,b){this.g=b}B(Bn,kn);Bn.prototype.logger=P("ydn.db.sql.req.WebSql");Bn.prototype.executeSql=function(a,b,c){var d=cb(b.g);if(1==d.length){var e=X(this.g,d[0]);if(!e)throw new nk(d[0]);var f=qn(b);if(f)for(var g=0;g<f.length;g++)if(!Wk(e,f[g]))throw new nk('Index "'+f[g]+'" not found in '+d[0]);var k;b.i?k=new An(e,b):k=new yn(e,b);k.execute(function(b,c){T(a,b,c)},a.g,c)}else throw new Fh(b.Ya);};function Cn(a,b){this.g=b}B(Cn,cn);Cn.prototype.logger=P("ydn.db.sql.req.SimpleStore");Cn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new qk(c);c=cb(b.g);if(1==c.length){var d=X(this.g,c[0]);if(!d)throw new nk(c[0]);var e=qn(b);if(e)for(var f=0;f<e.length;f++)if(!Wk(d,e[f]))throw new K('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new sn(d,b):g=new rn(d,b);g.execute(a,this)}else throw new Pc(b.Ya);};function Dn(a,b,c,d){Kk.call(this,a,b,c,d)}B(Dn,pl);Dn.prototype.executeSql=function(a,b){for(var c=new nn(a),d=cb(c.g),e=0;e<d.length;e++){var f=X(this.h,d[e]);if(!f)throw new K("store: "+f+" not exists.");}N(this.logger,"executeSql: "+a+" params: "+b);var g=this.g.request("sql",cb(c.g),c.j);U(g,function(){W(this).executeSql(g,c,b||[])},this);return g};function En(a,b,c){km.call(this,a,b,c)}B(En,mm);En.prototype.yc=function(a,b){return new Dn(this,this.h,a,b)};En.prototype.executeSql=function(a,b){return this.g.executeSql(a,b)};En.prototype.H=function(){var a=zk(this);if("indexeddb"==a)return new xn(0,this.h);if("websql"==a)return new Bn(0,this.h);if("memory"==a||"localstorage"==a||"sessionstorage"==a)return new Cn(0,this.h);throw new Sc("No executor for "+a);};function Fn(a,b){s(a)&&5242880<a&&L(this.logger,"storage size request ignored, use Quota Management API instead");this.ia=null;this.ad=b||NaN}h=Fn.prototype;
h.connect=function(a,b){function c(a,c,d){N(e.logger,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)Gn(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Tk(b,c[d])||(a.deleteObjectStore(c[d]),N(e.logger,"store: "+c[d]+" deleted."))}function d(a,b){f.ob?L(e.logger,"database already set."):s(b)?(L(e.logger,b?b.message:"Error received."),e.ia=null,f.D(b)):(e.ia=a,e.ia.onabort=function(a){O(e.logger,e+": abort");e.dd(a.target.error)},
e.ia.onerror=function(a){O(e.logger,e+": error");e.dd(a.target.error)},e.ia.onversionchange=function(a){O(e.logger,e+" closing connection for onversionchange to: "+a.version);if(e.ia&&(e.ia.onabort=null,e.ia.onblocked=null,e.ia.onerror=null,e.ia.onversionchange=null,e.Qd(a),!a.defaultPrevented)){e.ia.close();e.ia=null;var b=Error();b.name=a.type;e.ge(b)}},f.C(parseFloat(g)))}var e=this,f=new C,g=void 0,k=b.version;N(e.logger,"Opening database: "+a+" ver: "+(b.wc?"auto":k));var l;l=s(k)?Mj.open(a,
k):Mj.open(a);l.onsuccess=function(f){var k=f.target.result;s(g)||(g=k.version);N(e.logger,"Database: "+k.name+", ver: "+k.version+" opened.");if(b.wc)e.ib(function(f){if(b instanceof Pk)for(var g=0;g<f.stores.length;g++)Tk(b,f.stores[g].getName())||Qk(b,f.stores[g].ga());f=Tl(b,f,!1,!0);if(0<f.length){N(e.logger,"Schema change require for difference in "+f);var l=w(k.version)?k.version+1:1;if("IDBOpenDBRequest"in q){k.close();var m=Mj.open(a,l);m.onupgradeneeded=function(a){a=a.target.result;N(e.logger,
"re-open for version "+a.version);c(a,m.transaction,!1)};m.onsuccess=function(a){d(a.target.result)};m.onerror=function(){N(e.logger,e+": fail.");d(null)}}else{var p=k.setVersion(l+"");p.g=function(a){L(e.logger,"migrating from "+k.version+" to "+l+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=E;c(k,p.transaction,!0)};var E=function(){var b=Mj.open(a);b.onsuccess=function(a){a=a.target.result;N(e.logger,e+": OK.");d(a)};b.onerror=function(){N(e.logger,e+": fail.");d(null)}};
null!=p.transaction&&(p.transaction.oncomplete=E)}}else d(k)},void 0,k);else if(b.version>k.version){var l=k.setVersion(b.version);l.g=function(a){L(e.logger,"migrating from "+k.version+" to "+b.version+" failed.");d(null,a)};l.onsuccess=function(){c(k,l.transaction,!0)}}else b.version==k.version?N(e.logger,"database version "+k.version+" ready to go"):L(e.logger,"connected database version "+k.version+" is higher than requested version."),e.ib(function(a){a=Tl(b,a,!1,!0);0<a.length?(N(e.logger,a),
d(null,new Ih("different schema: "+a))):d(k)},void 0,k)};l.onupgradeneeded=function(a){a=a.target.result;g=NaN;N(e.logger,"upgrade needed for version "+a.version);c(a,l.transaction,!1)};l.onerror=function(c){e.logger.log(Se,'open request to database "'+a+'" '+(s(b.version)?" with version "+b.version:"")+" cause error of "+l.error.name,void 0);d(null,c)};l.onblocked=function(c){e.logger.log(Se,"database "+a+" "+b.version+" block, close other connections.",void 0);d(null,c)};w(this.ad)&&!isNaN(this.ad)&&
setTimeout(function(){"done"!=l.readyState&&(e.logger.log(Se,e+": database state is still "+l.readyState,void 0),d(null,new rk("connection timeout after "+e.ad)))},this.ad);return f};h.ad=18E4;h.ge=function(){};h.dd=function(){};h.Qd=function(){};h.Ec=function(){return"indexeddb"};h.fe=function(){return!!this.ia};h.logger=P("ydn.db.con.IndexedDb");h.ia=null;h.ee=function(){return this.ia?parseFloat(this.ia.version):void 0};
h.ib=function(a,b,c){c=c||this.ia;if(s(b)){if(null===b){if(0==c.objectStoreNames.length){a(new Sl(c.version));return}throw new Hh;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new Sl(c.version));return}b=c.transaction(b,Jj)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var k=b.objectStore(e[d]),l=[],m=0,n=k.indexNames.length;m<n;m++){var p=k.index(k.indexNames[m]);l[m]=new vl(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new Mk(k.name,k.keyPath,k.autoIncrement,void 0,l)}b=new Sl(c.version,f);a(b)};
function Gn(a,b,c,d){function e(){var a={autoIncrement:!!d.h};null!=d.keyPath&&(a.keyPath=d.keyPath);return b.createObjectStore(d.getName(),a)}O(a.logger,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName())){c=c.objectStore(d.getName());Cl(d.keyPath||"",c.keyPath||"")?(b.deleteObjectStore(d.getName()),L(a.logger,"store: "+d.getName()+" deleted due to keyPath change."),c=e()):ga(c.autoIncrement)&&ga(d.h)&&c.autoIncrement!=d.h&&(b.deleteObjectStore(d.getName()),
L(a.logger,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e());for(var f=c.indexNames,g=0;g<d.indexes.length;g++){var k=d.index(g);!f.contains(k.getName())&&k.l&&(c.clear(),L(a.logger,"store: "+d.getName()+" cleared since generator index need re-indexing."))}for(var l=0,m=0,n=0,g=0;g<d.indexes.length;g++){var k=d.index(g),p=!1;if(f.contains(k.getName())){var r=c.index(k.getName()),t=null!=r.unique&&null!=k.unique&&r.unique!=k.unique,x=null!=r.multiEntry&&null!=k.multiEntry&&r.multiEntry!=
k.multiEntry,r=null!=r.keyPath&&null!=k.keyPath&&!!Cl(r.keyPath,k.keyPath);if(t||x||r)c.deleteIndex(k.getName()),p=!0,l--,n++}else"BLOB"!=k.type&&(p=!0);p&&(k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath),l++)}for(g=0;g<f.length;g++)Wk(d,f[g])||(c.deleteIndex(f[g]),m++);O(a.logger,"Updated store: "+c.name+", "+l+" index created, "+m+" index deleted, "+n+" modified.")}else{c=e();for(g=0;g<d.indexes.length;g++)k=
d.index(g),"BLOB"==k.type?a.logger.info("Index "+k+" of blob data type ignored."):(O(a.logger,"Creating index: "+k),k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath));O(a.logger,"Created store: "+c)}}
h.vd=function(a,b,c,d){var e=this.ia;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};h.de=function(){O(this.logger,this+" closing connection");this.ia.close()};h.toString=function(){return"IndexedDB:"+(this.ia?this.ia.name+":"+this.ia.version:"")};
hk.push(function(a,b){if(!Mj||b&&"indexeddb"!=b)return null;var c=Mj.deleteDatabase(a),d=new bk("IDBVersionChangeEvent ");c.onblocked=function(a){Uc(d,a)};c.onerror=function(a){d.D(a)};c.onsuccess=function(a){d.C(a)};return d});function Hn(a){Zm.call(this,a);this.h=NaN}B(Hn,Zm);h=Hn.prototype;h.logger=P("ydn.db.con.SimpleStorage");h.ee=function(){return this.h};
h.connect=function(a,b){function c(a,b){setTimeout(function(){b?(N(d.logger,d+" opening fail"),e.D(b)):(N(d.logger,d+" version "+d.ee()+" open"),e.C(a))},10)}var d=this,e=new C;this.j=this.o.te(a);this.i=a;this.g=b;var f=Dm(this.i);this.h=NaN;var g=xh(this.j.getItem(f));s(g.version)&&!w(g.version)&&(g.version=NaN);if(g)if(g=new Sl(g),Tl(this.g,g,!1,!1))if(!this.g.wc&&!isNaN(g.version)&&this.g.version>g.version)c(NaN,new kk("existing version "+g.version+" is larger than "+this.g.version));else{var k=
this.g.version;this.h=s(k)?k:g.version+1;for(k=0;k<this.g.count();k++)var l=this.g.store(k);if(this.g instanceof Pk)for(k=0;k<g.count();k++)l=g.store(k),Qk(this.g,l);k=this.g.toJSON();k.version=this.h||NaN;this.j.setItem(f,zh(k));c(g.version||NaN)}else{for(k=0;k<this.g.count();k++)l=this.g.store(k);this.h=g.version||NaN;c(this.h)}else g=b.toJSON(),this.h=1,g.version=this.h,this.j.setItem(f,zh(g)),c(NaN);return e};h.fe=function(){return!!this.i};h.ge=function(){};h.dd=function(){};h.Qd=function(){};
h.Ec=function(){return"memory"};h.de=function(){};h.vd=function(a,b,c,d){a(new $m(this,function(a,b){d(a,b)}))};h.toString=function(){return"SimpleStorage:"+this.Ec()+":"+(this.i+":"+this.h)};function In(){Hn.call(this,this)}B(In,Hn);In.prototype.te=function(){return window.localStorage};In.prototype.Ec=function(){return"localstorage"};hk.push(function(a,b){if(!b||"localstorage"==b){var c=new In,d=new Pk;c.connect(a,d);c.ib(function(a){for(var b=0;b<a.stores.length;b++)Bm(c,a.stores[b].getName()).clear()})}});function Jn(){Hn.call(this,this)}B(Jn,Hn);Jn.prototype.te=function(){return window.sessionStorage};Jn.prototype.Ec=function(){return"sessionstorage"};
hk.push(function(a,b){if(!b||"sessionstorage"==b){var c=new Jn,d=new Pk;c.connect(a,d);c.ib(function(a){for(var b=0;b<a.stores.length;b++)Bm(c,a.stores[b].getName()).clear()})}});function Kn(a){this.g=s(a)?a:4194304}h=Kn.prototype;
h.connect=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,g=c.wc?isNaN(f)?1:f+1:c.version;M(e.logger,a+": changing version from "+b.version+" to "+g);var k=!1,l=0;b.changeVersion(b.version,g+"",function(a){e.ib(function(b){k=!0;for(var d=0;d<c.count();d++){var f=X(b,c.store(d).getName()),f=f?Kl(f,c.store(d)):null;Ln(e,a,c.store(d),function(a){a&&l++},f)}for(d=0;d<b.count();d++)f=b.store(d),Tk(c,f.getName())||(c instanceof Pk?Qk(c,f):(f="DROP TABLE "+Hl(f),N(e.logger,f),a.executeSql(f,
[],function(){},function(a,b){throw b;})))},a,b)},function(c){e.logger.log(Se,"SQLError "+c+" "+c.code+"("+c.message+") while changing version from "+b.version+" to "+g+" on "+a,void 0);throw c;},function(){if(k){var f=".";l!=c.stores.length&&(f=" but unexpected stores exists.");O(e.logger,a+":"+b.version+" ready"+f);d(b)}else L(e.logger,a+": changing version voided.")})}function d(a,b){s(b)?(e.Ea=null,g.D(b)):(e.Ea=a,g.C(parseFloat(f)))}var e=this,f=NaN,g=new C,k=null;try{k=q.openDatabase(a,"",a,
this.g)}catch(l){if("SECURITY_ERR"==l.name)L(this.logger,"SECURITY_ERR for opening "+a),k=null,this.xf=new pk(l);else throw l;}if(k){var f=k.version,m="database "+a+(0==k.version.length?"":" version "+k.version);null!=b.version&&b.version==k.version?(M(e.logger,"Existing "+m+" opened as requested."),d(k)):this.ib(function(a){(a=Tl(b,a,!0,!1))?(0==k.version.length?M(e.logger,"New "+m+" created."):b.wc?M(e.logger,"Existing "+m+" opened and schema change for "+a):M(e.logger,"Existing "+m+" opened and  schema change to version "+
b.version+" for "+a),c(k,b)):(M(e.logger,"Existing "+m+" with same schema opened."),d(k))},null,k)}else d(null,this.xf);return g};h.Ec=function(){return"websql"};h.xf=null;h.Ea=null;h.logger=P("ydn.db.con.WebSql");h.ge=function(){};h.dd=function(){};
function Mn(a){var b=a.G,c="CREATE TABLE IF NOT EXISTS "+Hl(a)+" (",d=a.j,c=c+(d+" "+b+" PRIMARY KEY ");a.h&&(c+=" AUTOINCREMENT ");if(!a.kc||!a.keyPath&&0==a.indexes.length)c+=" ,_default_ BLOB";for(var e=[],f=[d],g=0,k=a.indexes.length;g<k;g++){var l=a.index(g),m="";if(l.multiEntry){var m="ydn.db.me:"+a.getName()+":"+l.getName(),n=l.unique?" UNIQUE ":"",l="CREATE TABLE IF NOT EXISTS "+La(m)+" ("+d+" "+b+", "+l.i+" "+l.p+n+")";e.push(l)}else l.unique&&(m=" UNIQUE "),n=l.keyPath,"BLOB"!=l.type&&v(n)&&
(n="CREATE "+m+" INDEX IF NOT EXISTS "+La(a.getName()+"-"+l.getName())+" ON "+Hl(a)+" ("+l.i+")",e.push(n)),n=l.i,-1==f.indexOf(n)&&(c+=", "+n+" "+l.p+m,f.push(n))}e.unshift(c+")");return e}h.ee=function(){return this.Ea?parseFloat(this.Ea.version):void 0};
h.ib=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var r=nc(e,"sql");O(f.logger,"Parsing table schema from SQL: "+r);for(var t=r.substr(r.indexOf("("),r.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),x=void 0,z,r=[],G=!1,E=!1,J=0;J<t.length;J++){var Q=t[J].match(/\w+|"[^"]+"/g),ma=Ta(Q,function(a){return a.toUpperCase()}),I=Ia(Q[0],'"'),
Q=wl(ma[1]);if(-1!=ma.indexOf("PRIMARY")&&-1!=ma.indexOf("KEY")){z=Q;if(v(I)&&!wa(I)&&"_ROWID_"!=I){var vc=I.split(","),x=I;1<vc.length&&(x=vc,z=void 0)}-1!=ma.indexOf("AUTOINCREMENT")&&(G=!0)}else if("_ROWID_"!=I)if("_default_"==I)E=!0;else{var Xi="UNIQUE"==ma[2];ta(I,e.tbl_name+"-")&&(I=I.substr(e.tbl_name.length+1));ma=new vl(I,Q,Xi);r.push(ma)}}if(ta(e.name,"ydn.db.me:")){var dd=e.name.split(":");if(3<=dd.length){var Vd=dd[1],x=new vl(dd[2],Q,Xi,!0),t=Xa(r,function(a){return a.getName()==dd[2]});
0<=t?r[t]=x:r.push(x);t=Xa(k,function(a){return a.getName()===Vd});0<=t?(J=k[t],k[t]=new Mk(J.getName(),J.keyPath,G,z,r,void 0,!E)):k.push(new Mk(Vd,void 0,!1,void 0,[x]));O(f.logger,'multi entry index "'+x.getName()+'" found in '+Vd+(-1==t?"*":""))}else L(f.logger,'Invalid multiEntry store name "'+e.name+'"')}else J=Xa(k,function(a){return a.getName()===e.name}),0<=J?(t=k[J].index(0),r.push(t),k[J]=new Mk(e.name,x,G,z,r,void 0,!E)):(r=new Mk(e.name,x,G,z,r,void 0,!E),k.push(r))}}d=new Sl(g,k);a(d)}}
var f=this,g=(c=c||this.Ea)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,k=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.ib(a,b,c)},function(a){f.logger.log(Se,"opening tx: "+a.message,void 0);throw a;},e)};
function Ln(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==k.length&&(d(!0),d=null)},function(b,e){g++;g==k.length&&(d(!1),d=null);var f="SQLError creating table: "+c.getName()+" "+e.message+' for executing "'+a;throw new ok(e,f);})}var g=0,k=Mn(c),l="Create";if(e){e=Ok(c,e);if(0==e.length){O(a.logger,"same table "+c.getName()+" exists.");d(!0);d=null;return}l="Modify";L(a.logger,"table: "+c.getName()+" has changed by "+e+" ALTER TABLE cannot run in WebSql, dropping old table.");k.unshift("DROP TABLE IF EXISTS "+
La(c.getName()))}O(a.logger,l+" table: "+c.getName()+": "+k.join(";"));for(a=0;a<k.length;a++)f(k[a])}h.fe=function(){return!!this.Ea};h.de=function(){this.Ea=null};
h.vd=function(a,b,c,d){function e(a){O(k.logger,k+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var k=this;null===this.Ea&&(a(null),d("abort",this.xf));c==Jj?this.Ea.readTransaction(g,e,f):c==Lj?this.Ea.changeVersion(this.Ea.version,this.Ea.version+1+"",g,e,f):this.Ea.transaction(g,e,f)};
hk.push(function(a,b){if(ha(q.openDatabase)&&(!b||"websql"==b)){var c=new Kn,d=new Pk;N(c.logger,"deleting websql database: "+a);var d=c.connect(a,d),e=function(){c.logger.info("all tables in "+a+" deleted.")};d.B(function(){c.vd(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var l=e.rows.length,m=0,n=0;n<l;n++){var p=e.rows.item(n);"__WebKitDatabaseInfoTable__"!=p.name&&"sqlite_sequence"!=p.name&&(m++,O(c.logger,"deleting table: "+p.name),
b.executeSql("DROP TABLE "+p.name))}N(c.logger,m+' tables deleted from "'+a+'"')}},function(a,b){throw b;})},[],Kj,e)});d.Gc(function(){L(c.logger,"Connecting "+a+" failed.")})}});Kn.prototype.Qd=function(){};Kn.prototype.toString=function(){return"WebSql:"+(this.Ea?":"+this.Ea.version:"")};im.prototype.ue=function(a){return"indexeddb"==a&&Mj?new Fn(this.G,this.T):"websql"==a&&ha(q.openDatabase)?new Kn(this.G):"localstorage"==a&&window.localStorage?new In:"sessionstorage"==a&&window.sessionStorage?new Jn:"memory"==a?new Hn:null};function Nn(a,b){vb.call(this);this.j=b;this.g=[];if(a>this.j)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.g.push(this.h())}B(Nn,vb);Nn.prototype.Td=function(a){this.g.length<this.j?this.g.push(a):this.i(a)};Nn.prototype.h=function(){return{}};Nn.prototype.i=function(a){if(y(a))if(ha(a.qa))a.qa();else for(var b in a)delete a[b]};Nn.prototype.J=function(){Nn.m.J.call(this);for(var a=this.g;a.length;)this.i(a.pop());delete this.g};function On(){this.g=[];this.i=new od;this.j=new od;this.o=1;this.l=new Nn(0,4E3);this.l.h=function(){return new Pn};this.p=new Nn(0,50);this.p.h=function(){return new Qn};var a=this;this.h=new Nn(0,2E3);this.h.h=function(){return String(a.o++)};this.h.i=function(){}}P("goog.debug.Trace");function Qn(){this.time=this.count=0}Qn.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function Pn(){}
function Rn(a,b,c){var d=[];-1==b?d.push("    "):d.push(Sn(a.h-b));d.push(" ",Tn(a.h-0));0==a.g?d.push(" Start        "):1==a.g?(d.push(" Done "),d.push(Sn(a.l-a.startTime)," ms ")):d.push(" Comment      ");d.push(c,a);0<a.j&&d.push("[VarAlloc ",a.j,"] ");return d.join("")}Pn.prototype.toString=function(){return null==this.type?this.i:"["+this.type+"] "+this.i};
On.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.g.length;d++){var e=this.g[d];1==e.g&&c.pop();a.push(" ",Rn(e,b,c.join("")));b=e.h;a.push("\n");0==e.g&&c.push("|  ")}if(0!=this.i.ca()){var f=A();a.push(" Unstopped timers:\n");md(this.i,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Tn(b.startTime),")\n")})}b=this.j.Ma();for(d=0;d<b.length;d++)c=this.j.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",0,"\n","Total comments created ",
0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function Sn(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Tn(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new On;/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Un(a){a.p||(a.p=new Nc);return a.p}im.prototype.removeEventListener=function(a,b,c,d){Ic(Un(this),a,b,c,d)};im.prototype.Ua=function(a){Un(this).dispatchEvent(a)};function Vn(a,b,c){km.call(this,a,b,c)}B(Vn,En);P("ydn.gdata.base");function Wn(a){this.i=a||null;this.g=this.h=null;a&&Xn(this,a)}Wn.prototype.logger=P("ydn.crm.UserSetting");
var Yn={stores:[{name:"general"},{name:"sugar"}]},Zn={stores:[{name:"contact",keyPath:"id.$t",type:"TEXT",indexes:[{name:"updated.$t",type:"TEXT"},{name:"ydn$emails",multiEntry:!0,generator:function(a){var b=[];a=u(a.gd$email)?a.gd$email:y(a.gd$email)?[a.gd$email]:[];for(var c=0;c<a.length;c++){var d=mn(a[c].address);d&&b.push(d)}return b}},{name:"ydn$externalIds",multiEntry:!0,generator:function(a){return(u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:
[]).map(function(a){return a.value})}}]}]};function Xn(a,b){if(!a.i||a.i!=b){q.sessionStorage.setItem("last-user-id",b);var c=b+"-setting",d=b+"-gdata";a.h&&a.h.getName()!=c&&(cm(a.h),a.h=null);a.g&&a.g.getName()!=d&&(cm(a.g),a.g=null);a.h||(a.h=new Vn(c,Yn));a.g||(a.g=new Vn(d,Zn))}}function $n(a){return a.i?a.i+"-sd":q.sessionStorage.getItem("last-user-id")+"-sd"}function ao(a){var b=$n(a),c=new C;chrome.storage.local.get(b,function(a){c.C(a[b])});return c}
function bo(a,b){var c=$n(a),d=new C,e={};e[c]=b;chrome.storage.local.set(e,function(){d.C(!0)})};function co(){var a=new C;chrome.storage.sync.get("user-setting",function(b){a.C(b["user-setting"])});return a};function eo(){}eo.prototype.logger=P("ydn.crm.Client");function fo(a,b,c){this.client=a;this.g=b;this.h=c}fo.prototype.request=function(a){a=this.g.call(this.h,a);return this.client.request(a)};function go(a,b,c){this.h=a;this.i=b;this.g=c}go.prototype.request=function(a){return this.h(a)?this.i.request(a):this.g.request(a)};function ho(a,b){this.client=a;this.h=b;this.Wc=NaN;this.i=[];this.g=!1}ho.prototype.request=function(a){return new jo(a,this)};function jo(a,b){a.path=b.h+a.path;this.req=b.client.request(a);this.parent=b;this.i=null;this.h=void 0}B(jo,ej);
jo.prototype.execute=function(a,b){if(this.parent.g)this.i=a,this.h=b,this.parent.i.push(this);else{this.parent.g=!0;var c=function(c,d){var g=aj(d,"retry-after");g?(this.parent.Wc=/[^0-9|\.]/.test(g)?(new Date(g)).getTime():1E3*parseFloat(g)+A(),q.console.info("Next retry "+this.parent.Wc+", now "+A())):this.parent.Wc=NaN;a&&a.call(b,c,d);this.parent.g=!1;if(g=this.parent.i.pop())g.execute(g.i,g.h),g.i=null,g.h=null},d=this.parent.Wc-A();0<d?(q.console.info("Proxy will call after "+d+" ms"),mf(function(){this.parent.Wc=
NaN;this.req.execute(c,this)},d,this)):this.req.execute(c,this)}};function ko(a,b,c,d,e){this.l=s(a)?a:Wi();this.g=b;this.h=c;this.i=d||0;this.j=!!e}ko.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new ej(a,this.l,this.i,this.j)};function lo(a,b,c){this.i=s(a)?a:Wi();this.g=b;this.h=c}lo.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new ej(a,this.i)};function mo(a){for(var b=$l(a),c=0;c<b.stores.length;c++);b=(b=xk)||xk;b=jm(a,b,!1,void 0,void 0,void 0);this.g=a.yc(b,a.Qa);this.j=!1;a.Cb(this.H,this);this.h=1E4;this.l=Ye.value;this.i=0;this.t=oa(this.G,this);this.p=!1;this.o={}}function no(a){if(a.h&&a.i>=a.h){var b=a.h/100;100<b&&(b=100);a.g.keys("db-logger",null,b).B(function(a){a=a.map(function(a){return new sk("db-logger",a)});this.g.remove(a).B(function(){this.g.count("db-logger").B(function(a){this.i=a},this)},this)},a)}}
function oo(){var a=po;a.h=1E4;no(a)}mo.prototype.H=function(){this.h&&(this.j=!0,this.g.count("db-logger").B(function(a){this.i=a;no(this)},this))};function qo(a){var b=po;if(a!=b.p){var c=ff();a?af(c,b.t):(c=c.g)&&$a(c,b.t);b.p=a}}mo.prototype.G=function(a){if(this.j){var b=a.h;ta(b,"ydn.db.")||this.o[b]||!(b=a.j)||b.value<=this.l||(a={exception:a.g,level:b.value,logger:a.h,name:b.name,time:a.l,message:a.getMessage(),seq:a.o},this.g.put("db-logger",a),this.i++,no(this))}};
function ro(a,b){var c=po,d=a||100,e=b||0,f=nj(["INFO"]);return c.g.values("db-logger","name, time",f,d,e,!0)}var po=null;var so,to,uo,vo,wo=P("ydn.crm");function xo(){so||(so=new $f(0));return so}var yo=null;function zo(a,b){b&&"local"!=b||(s(a["logging-captureConsole"])&&li(!!a["logging-captureConsole"]),s(a["logging-bugReport"])&&qo(!!a["logging-bugReport"]))}
function Ao(){var a;a="Yathit CRM Bridge ydn.crm.version 0.7.13 (dev)";Mi("ydn.crm","fine");Mi("ydn.ds","fine");q.console.log(a);q.console.log("API documentation: http://dev.yathit.com/\nFeedback and suggestion: https://yathit.uservoice.com/\nBug report: https://github.com/yathit/sugarcrm-gmail-chrome-extension");yo=new Vn("ydn.crm",{stores:[{name:"log",keyPath:"key"},{name:"db-logger",autoIncrement:!0,indexes:[{name:"level"},{name:"time"},{name:"name"},{name:"name, time",keyPath:["name","time"]}]}]});
po=new mo(yo);oo();po.l=300;po.o["ydn.db.tr.DbOperator"]=!0;qo(!0);wo.info("Starting ydn.crm.App:0.7.13");chrome.storage.local.get(["logging-captureConsole","logging-bugReport"],zo);chrome.storage.onChanged.addListener(zo);var b=A();dj=Ni=new Bo(yo,function(a){if(!a||a.HttpRequestData&&"https://mail.google.com/mail/feed/atom/bazinga"==a.HttpRequestData.path)return null;a.uptime=b;return a})}function Co(){to||(to=new lo(xo()),Vi(to,"default"));return to}
function Do(a){var b=Co();a=new gj(a,so,!1);Vi(a,"gc");var c=new fo(a,function(a){a.path="https://yathit-app.appspot.com/proxy/"+a.path;return a});Vi(new ho(b,"https://yathit-app.appspot.com/proxy/"),"proxy");Vi(new go(function(a){return"GET"==a.method},a,c),"gse")}function Eo(){vo||(vo=new ko(xo(),void 0,"https://yathit-app.appspot.com/a/cm",1,!0),Vi(vo,"auth"));return vo};function Fo(a,b){this.j=b||A();this.type=a;this.i=this.g=this.h=void 0}function Go(a,b){y(b)?a.h=Vl(b):a.h=b}Fo.prototype.toJSON=function(){return{type:this.type,timestamp:this.j,newValue:this.g,oldValue:this.h,meta:this.i}};function Ho(a){this.g=a}Ho.prototype.add=function(a){this.g.add("history",a.toJSON())};function Io(a,b){if(a.link){if(u(a.link)){for(var c=0;c<a.link.length;c++)if(a.link[c].rel==b)return a.link[c];return null}return a.link.rel==b?a.link:null}return null};function Jo(a,b){this.entry=a;this.data=b;this.g=!1}Jo.prototype.data=null;Jo.prototype.preventDefault=function(){this.g=!0};function Ko(a,b,c,d){H.call(this,a,b);this.status=c;this.entry=d}B(Ko,H);Ko.prototype.status=NaN;Ko.prototype.O=function(){return this.status};Ko.prototype.tb=function(){return this.entry.tb()};function Lo(a,b,c){Ko.call(this,"conflict",a,b,c.entry)}B(Lo,Ko);function Mo(a,b){this.g=a;if(b)throw new Pc("optional key paths");}var No={ei:"key",bi:"date",fi:"modified",di:"expires",ci:"etag",gi:"updated",hi:"uri",NEXT:"next"};Mo.prototype.V=function(a,b){return b&&this.g[a]?vj(b,this.g[a]):void 0};function Oo(a,b,c,d){a.g[b]&&wj(c,a.g[b],d)};function Po(a,b,c,d){this.key=a;this.h=(this.h=d?b[d]:b)||{};this.g=c}function Qo(a){return null!=a.key?a.key:a.g.V("key",a.h)}Po.prototype.getDate=function(){return this.g.V("date",this.h)};function Ro(a){return a.g.V("updated",a.h)}function So(a){return a.g.V("etag",a.h)}function To(a){var b={},c=So(a);c&&1<c.length?b["if-none-match"]=c:(a=Ro(a))&&(b["if-modified-since"]=a);return b}
Po.prototype.toJSON=function(){var a={};Oo(this.g,"key",a,Qo(this));var b=this.getDate();b&&Oo(this.g,"date",a,b);(b=this.g.V("expires",this.h))&&Oo(this.g,"expires",a,b);(b=Ro(this))&&Oo(this.g,"updated",a,b);(b=So(this))&&Oo(this.g,"etag",a,b);return a};function Uo(a,b,c){b.expires&&Oo(c,"expires",b,(new Date(b.expires)).getTime());b["last-updated"]&&Oo(c,"updated",b,(new Date(b["last-updated"])).getTime());b.etag&&Oo(c,"etag",b,(new Date(b.etag)).getTime());Oo(c,"date",b,NaN);Po.call(this,a,b,c)}B(Uo,Po);function Vo(a,b,c){this.g=a;this.o=c||null;this.i=this.h=null;this.key=b}h=Vo.prototype;h.logger=P("ydn.db.sync.entry.Rest");h.tb=function(){if(this.i&&this.g.p&&this.j){var a=this.g.t;this.g.T||delete this.i[a]}return this.i||null};h.V=function(){return this.o};h.F=function(){return this.key};h.he=function(){return this.g.af(this.F())};function Wo(a,b){var c=a.F();return new Uo(c,b.Nc(),a.g.o)}
h.De=function(a,b){if(a)return a;if(b.Aa())return bj(b);try{return bj(b)}catch(c){var d=$i(b);return y(d)?d:{body:d}}};h.save=function(a){var b=this.F();if(a&&!this.g.p)return A(),Xo(this.g,[this.j.toJSON()]);var c=this.i;if(a&&!c)return tb();a=void 0;null!=this.j&&(A(),a=[this.j.toJSON()]);return Yo(this.g,[c],a,[b])};
h.hc=function(a,b){if(this.g.G&&y(this.h))a.call(b,304),a=null;else{var c=this;Zo(this,function(d){if(d){var e=d.g.V("expires",d.h);if(e&&e>A()){O(this.logger,this+" not expired");a.call(b,304);a=null;return}}e=c.he();d=c.ec(e,"GET",d);this.g.ta().request(d).execute(function(d,e){c.j=Wo(c,e);c.i=c.De(d,e);a.call(b,e.O());a=null})},this)}};
h.ec=function(a,b,c,d){a=new bi(a,b);if(c){var e;"POST"==a.method||"PUT"==a.method||"DELETE"==a.method?(e={},(b=Ro(c))&&(e["if-unmodified-since"]=b),(c=So(c))&&1<c.length&&(e["if-match"]=c),c=e):c=To(c);e=c;a.headers?rc(a.headers,e):a.headers=e}a.body=y(d)?JSON.stringify(d):d;O(this.logger,this+" "+a.method+" "+a.path+" "+yh(e));return a};
function $o(a,b,c){Zo(a,function(a){var e=this.V();a=this.ec(this.he(),"PUT",a,e);this.g.ta().request(a).execute(function(a,d){this.j=Wo(this,d);this.i=a;b&&(b.call(c,d.O()),b=null)},this)},a)}function Zo(a,b,c){a.l?b.call(c,a.l):ap(a.g,a.F(),function(d){a.l=d;b.call(c,d)})}
h.load=function(a,b){if(this.h&&this.l)a&&(a.call(b,this.h,this.l),a=void 0);else{var c=this.F();this.g.load(c,function(c,e){this.h=c;var f=this.g.t;this.h&&f&&this.h[f]&&(this.l=new Po(this.key,this.h,this.g.o,f),this.g.T||delete this.h[f]);this.h=c;this.l=e;a&&(a.call(b,c),a=void 0)},this)}};function bp(a,b){var c=a.he(),d=a.g.ta();Zo(a,function(a){a=this.ec(c,"DELETE",a);d.request(a).execute(function(a,d){O(this.logger,"deleted "+c+" "+d.O());b.call(this,d.O())},this)},a)}
h.toString=function(){return"sync.entry{"+this.g.I()+":"+this.key+"}"};function cp(a,b,c){this.storage=a;this.store=b;this.P=b.getName();a="format readRequestTimeout writeRequestTimeout transport Options fetchStrategies baseUri immutable keepMeta metaStoreName metaDataName prefetch prefetchRefractoryPeriod".split(" ");for(var d in c)if(-1==Qa(a,d))throw new K('Unknown Sync attribute "'+d+'"  in Sync.');this.G=!!c.immutable;this.h=c.baseUri;this.zb=c.metaStoreName||this.P;this.t=c.metaDataName;this.p=this.zb==this.P;a=c.Options||{};if(!this.zb)throw new K("metadata store name required.");
b=this.rb();for(d in a)if(-1==Qa(b,d))throw new K('Unknown Sync.Options attribute "'+d+'" in Sync.Options');this.na=a.delimiter||"";this.j=a.prefix||"";this.T=!!c.keepMeta;this.N=c.prefetch||w(c.prefetchRefractoryPeriod)?"full":null;this.ea=w(c.prefetchRefractoryPeriod)?c.prefetchRefractoryPeriod:5E3;this.g=dp(c.transport);this.o=new Mo(this.qb(),c.metaData);this.l=null;this.H=NaN}h=cp.prototype;h.qb=function(){var a={},b;for(b in No)a[b]=b;return a};h.rb=function(){return[]};h.I=function(){return this.P};
h.logger=P("ydn.db.sync.Rest");h.Eb=function(){return this.h};h.ta=function(){this.g||(this.g=new lo);return this.g};h.toString=function(){return"sync:"+this.P};function Xo(a,b){return il(a.storage.g,a.zb,b).Gc(function(a){throw a;})}function ep(a,b,c){a.store.keyPath&&null==$k(a.store,b)&&null!=c&&wj(b,a.store.keyPath,c)}
function Yo(a,b,c,d){d=a.store.keyPath?void 0:d;if(c){if(a.p){for(g=0;g<b.length;g++)null!=c[g]&&rc(b[g],c[g]);return il(a.storage.g,a.P,b,d)}if(b){for(var e=[],f=b.concat(c),g=0;g<b.length;g++){var k=a.store.keyPath?NaN:d[g];e.push(new sk(a.P,k))}for(g=0;g<c.length;g++)e.push(new sk(a.zb,NaN));return il(a.storage.g,e,f)}return il(a.storage.g,a.zb,c)}for(g=0;g<b.length;g++)k=d?d[g]:void 0,ep(a,b[g],k);return il(a.storage.g,a.P,b,d)}
function fp(a,b){var c=[new sk(a.P,b)];a.p||c.push(new sk(a.zb,b));return jl(a.storage.g,c)}h.af=function(a){return this.Eb()+a};h.add=function(a,b,c){null!=c?ep(this,b,c):this.store.keyPath&&(c=$k(this.store,b));var d=this.wa(c,b),e=this;$o(d,function(a){201==a||200==a?(O(e.logger,d+" created"),d.save(!0)):L(e.logger,"Unexpected respond "+a+" for add "+d)})};
function ap(a,b,c){var d=new sk(a.zb,b);gp(a,[d]).A(function(a){c.call(void 0,new Po(b,a[0],this.o,this.t))},function(a){L(this.logger,this+" error loading meta data "+a);c.call(void 0,null)},a)}h.Nd=function(a,b){var c=a.map(function(a){return new sk(this.zb,a)});gp(this,c).A(function(c){for(var e=[],f=0;f<a.length;f++)e[f]=new Po(a[f],c[f],this.o,this.t);b(e)},function(a){L(this.logger,this+" error loading meta data "+a);b([])},this)};
h.load=function(a,b,c){var d=this.zb,e=[new sk(this.I(),a)];this.p||e.push(new sk(d,a));gp(this,e).A(function(d){var e=d[0];b.call(c,e,new Po(a,this.p?e:d[1],this.o,this.t))},function(a){L(this.logger,this+" error loading meta data "+a);b.call(c,null,null)},this)};function gp(a,b){return ml(a.storage.g,b)}
h.get=function(a,b){this.H||this.Vb();fk(a,function(c,d,e){if(d)e(c,d);else{Uc(a,c);var f=s(c);if(f&&this.G)e(c);else{var g=this.wa(b,c);g.hc(function(a){if(304==a){if(e(c),!f)throw new Sc(g+" not modified, but not exist in server");}else if(200==a)g.save().fa(function(){e(g.tb())});else if(404==a)fp(g.g,g.F()).fa(function(){e(g.tb())});else throw e(g.tb()),new Rc("Invalid HTTP respond "+a+" for GET "+b);},this)}}},this)};
function hp(a,b,c,d,e,f){var g=[],k=a.logger;N(a.logger,d.length+", "+e.length+", "+f.length+", "+g.length+" records to fetch, update, delete, save");var l=d.length+e.length+f.length+g.length;if(0==l)b(c);else{for(var m=!1,n=function(){l--;0==l&&(b(c,m),b=null)},g=0;g<d.length;g++){var p=a.wa(d[g]);p.index=g;p.hc(function(a){200==a?(O(k,"A new "+this+" received from server"),this.save().A(function(){c[this.index]=this.tb();n()},function(){m=!0;n()},this)):304==a?this.save(!0).A(function(){O(k,this+
" expires date updated");n()},function(){m=!0;n()},this):(L(k,"Invalid status "+a+" for fetching "+this),n())},p)}for(g=0;g<e.length;g++)p=a.wa(e[g]),p.index=g,p.load(function(){this.hc(function(a){200==a?(O(k,this+" updated from server"),this.save().A(function(){c[this.index]=this.tb();n()},function(){m=!0;n()},this)):(L(k,"Invalid status "+a+" for fetching "+this),n())})});for(g=0;g<f.length;g++)p=a.wa(f[g]),p.index=g,fp(p.g,p.F()).A(function(){c[this.index]=new Jo(p,null);n()},function(){m=!0;
n()},p)}}function ip(a,b,c){fk(b,function(a,e,f){if(e)f(a,e);else if(Va(a,function(a){return s(a)})&&this.G)f(a);else{Uc(b,a);var g=a.length;for(e=0;e<c.length;e++)if(this.G&&s(a[e]))g--,0==g&&f(a);else{var k=this.wa(c[e],a[e]);k.index=e;k.hc(function(b){200==b?(a[this.index]=this.tb(),this.save()):404==b&&(a[this.index]=void 0);g--;0==g&&f(a)},k)}}},a)}h.wa=function(a,b){return new Vo(this,a,b)};h.count=function(a){return a};h.gf=function(){throw new Pc;};
h.values=function(a,b,c){jp(this)?(O(this.logger,"prefetch queued"),fk(a,function(d,e,f){Uc(a,d);e?f(d,e):kp(this,function(a){a?ll(this.storage.g,this.P,null,null,!1,b,c).A(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(){L(this.logger,this+" prefetch fail");f(d)},this)},this)):this.gf(a,b,c)};
h.keys=function(a,b,c,d,e,f,g){fk(a,function(k,l,m){Uc(a,k);l?m(k,l):kp(this,function(a){a?nl(this.storage.g,this.P,b,c,d,e,f,g).A(function(a){m(a)},function(a){m(a,!0)},this):m(k)},function(){L(this.logger,this+" prefetch fail");m(k)},this)},this)};h.Be=function(){};
h.put=function(a,b,c){c=s(c)?c:this.store.keyPath?$k(this.store,b):null;var d=this.wa(c,b);U(a,function(){d.load()},this);fk(a,function(c,f,g){Uc(a,c);$o(d,function(c){409==c?d.hc(function(){var c=new Jo(d,b);Uc(a,c);c.g?g(null,f):g(void 0,f)}):200==c||201==c?(d.save(!0),g(b,f)):(L(this.logger,"Unexpected response for PUT: "+c),g(null,f))},this)},this)};
h.remove=function(a,b){var c=this,d=this.wa(b);d.load(function(){fk(a,function(e,f,g){bp(d,function(f){if(409==f){f=new Jo(d,null);Uc(a,f);var l=new Lo(c.storage,409,f);c.storage.Ua(l)}else 200==f?O(c.logger,"Successfully deleted object "+b):(L(c.logger,"Unexpected response for DELETE: "+f+" "+b),Uc(a,l));g(e)})})})};
h.Vb=function(){O(this.logger,this+" starting prefetch");var a=new C;ll(this.storage.g,this.P,"updated.$t",null,!0,1).A(function(b){var c={};if(b=b[0])b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b;var d=this,c=new bi(this.Eb(),"GET",c);d.ta().request(c).execute(function(b,c){if(200==c.O()){if(!b){var g=$i(c);v(g)&&(b=JSON.parse(g))}g=(g=(b.feed||b).entry)?u(g)?g:[g]:[];0<g.length?Yo(d,g).fa(function(){a.C(!0)}):a.C(!1)}else 302==c.O()?a.C():(g=d+": Invalid response status "+
c.O()+" on prefetching",L(d.logger,g),a.D(Error(g)))})},function(b){a.D(b)},this);return a};function jp(a){return a.N?a.H?A()-a.H>a.ea:!0:!1}function kp(a,b,c,d){jp(a)?a.l?a.l.A(b,c,d):(a.l=a.Vb(),a.H=A(),a.l.A(b,c,d),a.l.A(function(a){O(this.logger,"prefetch "+(a?"updated":"no update"));this.l=null},function(a){this.l=null;throw a;},a)):b.call(d,!1)};function lp(a,b,c){cp.call(this,a,b,c)}B(lp,cp);lp.prototype.logger=P("ydn.db.sync.Atom");lp.prototype.rb=function(){return lp.m.rb.call(this)};lp.prototype.F=function(a){return a.key};function mp(a){this.data=a}h=mp.prototype;h.F=function(){return this.data.id.$t};h.uf=function(){return this.data.title?this.data.title.$t:void 0};h.ce=function(a){return Io(this.data,a)};h.Ph=function(){var a=this.ce("self");return a?a.href:void 0};h.Oh=function(){var a=this.ce("http://schemas.google.com/g/2005#batch");return a?a.href:""};h.oa=function(){return this.data.content||null};function np(a,b,c){Vo.call(this,a,b,c)}B(np,Vo);np.prototype.logger=P("ydn.db.sync.entry.S3");np.prototype.getName=function(){return this.g.j+this.key};np.prototype.ec=function(a,b,c,d){b=np.m.ec.call(this,a,b,c,d);if("PUT"==b.method||"POST"==b.method){c=Hd(new ud(a)).substr(1);if(1>c.length)throw new Rc("invalid url "+a);b.headers.Key=c;a=b.headers["Content-Type"]||"application/json";d instanceof File?a=d.type:v(d)&&(a=/<*DOCTYPE html/i.test(d)?"text/html":"text/plain");b.headers.ContentType=a}return b};function op(a){this.data=a}B(op,mp);var pp={atom:"http://www.w3.org/2005/Atom",ydn:"http://www.yathit.com/2012/ydn",app:"http://www.w3.org/2007/app",openSearch:"http://a9.com/-/spec/opensearch/1.1/",gAcl:"http://schemas.google.com/acl/2007",sites:"http://schemas.google.com/sites/2008",gs:"http://schemas.google.com/spreadsheets/2006",dc:"http://purl.org/dc/terms",batch:"http://schemas.google.com/gdata/batch",gd:"http://schemas.google.com/g/2005",gContact:"http://schemas.google.com/contact/2008",thr:"http://purl.org/syndication/thread/1.0",
xhtml:"http://www.w3.org/1999/xhtml"};function qp(a,b){for(var c=a.indexOf(" "),d=0;d<b.length;d++){var e=b[d],e=(0==d?"xmlns":"xmlns:"+e)+'="'+pp[e]+'"';-1==a.indexOf(e)&&(a=a.substring(0,c+1)+e+" "+a.substr(c+1))}return a}P("ydn.xml");function rp(a){return pp[a]||pp.xhtml};function sp(a,b,c){c=!!c;if(a.getName()!=b.getName())return!1;var d=tp(a),e=tp(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;for(d=0;d<e.length;d++)if(a.getAttribute(e[d])!=b.getAttribute(e[d]))return!1;d=up(a);e=up(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;if(0==d.length||0==d.length)return a.data.$t===b.data.$t;for(d=0;d<e.length;d++){var f=vp(a,e[d]),g=vp(b,e[d]);if(!c&&f.length!=g.length||c&&g.length>f.length)return!1;for(var k=0;k<g.length;k++)if(-1==Xa(f,function(a){return sp(a,
g[k],c)}))return!1}return!0};function wp(a,b,c){if(s(b))xp(this,b),s(c)||(c=a[b]);else for(var d in a)if(a.hasOwnProperty(d)&&y(a[d])&&v(a[d].xmlns)){this.ed=[d].xmlns;xp(this,d);c=a[d];break}this.data=c;this.parent=a}h=wp.prototype;h.ed="http://www.w3.org/2005/Atom";function xp(a,b){var c=b.split(":");1<c.length&&(a.ed=rp(c[0])||wp.prototype.ed,b=c[1]);a.tagName=b}
h.n=function(a,b){var c;c=a;var d=b,e=c;if(s(d))"atom"!=d&&(e=d+"$"+c);else{var f=c.split(":"),e=c.replace(/:/,"$");2==f.length&&(d=f[0],c=f[1])}d=s(d)?rp(d):void 0;c=s(this.data[c])&&s(d)&&this.data[c].xmlns==d?c:e;return u(this.data[c])?new wp(this.data,c,this.data[c][0]):y(this.data[c])?new wp(this.data,c,this.data[c]):null};h.toString=function(){return"JsonElement:"+this.tagName};h.getName=function(){return this.tagName};
function yp(a,b){for(var c in a.data)a.data.hasOwnProperty(c)&&y(a.data[c])&&delete a.data[c];a.data.$t=b}h.getAttribute=function(a){a=a.replace(/:/,"$");return this.data[a]};h.setAttribute=function(a,b){a=a.replace(/:/,"$");this.data[a]=b};h.removeAttribute=function(a){a=a.replace(/:/,"$");delete this.data[a]};function tp(a){var b=[],c;for(c in a.data)a.data.hasOwnProperty(c)&&v(a.data[c])&&"$t"!=c&&b.push(c);return b}
function vp(a,b){s(void 0)?b="undefined$"+b:s(b)&&(b=b.replace(/:/,"$"));var c=[];if(s(b)){var d=a.data[b];if(u(d))for(var e=0;e<d.length;e++)c.push(new wp(a.data,b,d[e]));else y(d)&&c.push(new wp(a.data,b,d))}else for(d in a.data)if(u(a.data[d]))for(e=0;e<a.data[d].length;e++)c.push(new wp(a.data,d,a.data[d][e]));else y(a.data[d])&&c.push(new wp(a.data,d,a.data[d]));return c}function up(a){var b=[],c;for(c in a.data)y(a.data[c])&&b.push(c.replace("$",":"));return b}
h.appendChild=function(a){var b=a.getName();this.data[b]?(u(this.data[b])||(this.data[b]=[this.data[b]]),this.data[b].push(Vl(a.data))):this.data[b]=Vl(a.data)};
h.update=function(a,b,c,d,e){var f=!1;c=c||{};var g=s(b),k=!0===b||!g,l=!1===b,m=tp(this),n=tp(a);if(!g)for(var p=0;p<m.length;p++)s(e)&&!e[m[p].replace("$",":")]||Ya(n,m[p])||(this.removeAttribute(m[p]),f=!0);for(p=0;p<n.length;p++){var r=a.getAttribute(n[p]);if(!s(e)||e[n[p].replace("$",":")])Ya(m,n[p])?l||r==this.getAttribute(n[p])||(this.setAttribute(n[p],r),f=!0):(this.setAttribute(n[p],r),f=!0)}if(0==zp(a)&&k&&(e=this.data.$t,l=a.data.$t,s(l)&&e!=l))return yp(this,l),!0;if(!g)for(var t in this.data)d&&
!d[t.replace("$",":")]||!y(this.data[t])||y(a.data[t])||(delete this.data[t],f=!0);t=up(a);for(e=0;e<t.length;e++)if(l=t[e],!d||!0==d[l]){var x=vp(a,l),m=vp(this,l),z=l.replace(":","$");if(1==x.length)0==m.length?(this.data[z]=Vl(x[0].data),f=!0):1==m.length?c[l]?k&&!sp(m[0],x[0],!0)&&(u(this.data[z])||(this.data[z]=[this.data[z]]),this.data[z].push(Vl(x[0].data)),f=!0):f=m[0].update(x[0],b)||f:g?(l=Xa(m,function(a){return sp(a,x[0],!0)}),-1==l&&k&&(this.data[z].push(Vl(x[0].data)),f=!0)):(this.data[z]=
Vl(x[0].data),f=!0);else if(!u(this.data[z]))if(k)this.data[z]=Vl(a.data[z]),f=!0;else{if(g){var m=Vl(a.data[z]),G=this,l=Xa(m,function(a){return Dl(G.data[z],a)});-1==l&&(m.push(this.data[z]),this.data[z]=m,f=!0)}}else if(k)for(m.length>x.length&&(this.data[z].splice(x.length,m.length-x.length),f=!0),p=0;p<x.length;p++)s(m[p])?Dl(m[p].data,x[p].data)||(this.data[z][p]=Vl(x[p].data),f=!0):(this.data[z][p]=Vl(x[p].data),f=!0);else if(g)for(p=0;p<a.data[z].length;p++)l=Xa(this.data[z],function(b){return Dl(a.data[z][p],
b)}),-1==l&&(this.data[z].push(Vl(a.data[z][p])),f=!0)}return f};h.hf=function(a,b,c,d,e){s(b)||(b=!1);return this.update(a,b,c,d,e)};h.toJSON=function(){return{data:this.data,tagName:this.tagName}};
function Ap(a){function b(a,g){d(g,a);var k,l;for(l in a)if(a.hasOwnProperty(l)&&!v(a[l]))if(v(a[l].$t)&&"xhtml"==a[l].type){k=c(l);d(k,a[l]);var m=Ch(a[l].$t);e.importNode(m.documentElement,!0);k.appendChild(m.documentElement);g.appendChild(k)}else if(v(a[l].$t))k=c(l),k.textContent=a[l].$t,d(k,a[l]),g.appendChild(k);else if(u(a[l])&&a[l][0]&&v(a[l][0].$t))for(m=0;m<a[l].length;m++)k=c(l),k.textContent=a[l][m].$t,d(k,a[l][m]),g.appendChild(k);else if(u(a[l]))for(m=0;m<a[l].length;m++)k=c(l),g.appendChild(k),
b(a[l][m],k);else y(a[l])&&(k=c(l),g.appendChild(k),b(a[l],k))}function c(a){return e.createElement(a.replace("$",":"))}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&"$t"!=c&&v(b[c])&&a.setAttribute(c.replace("$",":"),b[c])}var e=Ah(a.getName(),a.ed);b(a.data,e.documentElement);return Dh(e.documentElement)}
function zp(a){function b(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&(u(a[c])?b+=a[c].length:y(a[c])&&b++);return b}var c;s(void 0)?c="undefined$"+c:s(c)&&(c=c.replace(/:/,"$"));return s(c)?u(a.data[c])?a.data[c].length:y(a.data[c])?b(a.data[c]):0:b(a.data)}h.ga=function(a){var b={};if(s(a))for(var c in this.data){var d=c.replace("$",":");v(this.data[c])?b[c]=this.data[c]:!0==a[d]&&(b[c]=Vl(this.data[c]))}else b=Vl(this.data);return new wp(null,this.tagName,b)};
function Bp(a,b){var c=b.ownerDocument.createElementNS(a.ed,a.getName()),d;for(d in a.data)if(a.data.hasOwnProperty(d)){var e=d.replace("$",":");if(v(a.data[d]))"$t"==d?c.textContent=a.data[d]:(e=c.ownerDocument.createAttribute(e),e.nodeValue=a.data[d],c.setAttributeNode(e));else if(u(a.data[d]))for(var f=0;f<a.data[d].length;f++){var g=new wp(a.data[d],e,a.data[d][f]);Bp(g,c)}else y(a.data[d])&&(g=new wp(a.data,e,a.data[d]),Bp(g,c))}return b.appendChild(c)};function Cp(a){var b;if(s(a.id))b=a.id.$t;else if(s(a.batch$id))b=a.batch$id.$t;else if(s(a.g))b=a.g.$t;else throw new Eh("id or batch:id required.");this.id=b;this.h=void 0;this.data=a}B(Cp,op);h=Cp.prototype;h.logger=P("ydn.gdata.Entry");h.yf=function(){return this.kind};h.uf=mp.prototype.uf;h.F=function(){return this.id};function Dp(a){return a.id.match(/\w+$/)[0]}h.mc=["link","category"];h.fg=["id","batch$id","link","category"];h.oa=mp.prototype.oa;
function Ep(a,b){if(b)a.data.status=""==b?void 0:b;else{var c=a.data;c.status&&(c.status=b)}}function Fp(a){return s(a.gd$deleted)?"gd:deleted":(a=a.status)?a:""}function Gp(a){return"gd:deleted"==Fp(a.data)}h.setTitle=function(){throw new Gh;};
h.nc=function(){if(!Hp(this.data))throw Error("nothing to commit");var a=new C;Ip(this,function(b,c){if(c.Aa())a.C(b);else{var d=$i(c);if(v(d)&&/html/.test(aj(c,"content-type")))try{var e=(new DOMParser).parseFromString(d,"text/html");e.body&&(d=e.body.innerHTML)}catch(f){}a.D(c.O()+" "+c.Ha()+" "+d)}},this);return a};
function Ip(a,b,c){var d=$h("gse");if(Hp(a.data)){var e={"Content-Type":"application/atom+xml"};a.g&&(e["GData-Version"]=a.g);var f={},g="POST",k,l,m;m="full";s(l)||(l="base"!=m);var n=a.kind||"contact";k=k?"/"+k:"";k=(l?"https":"http")+"://www.google.com/m8/feeds/"+n+"s/"+a.user_id.replace("@","%40")+"/"+m+k;k=k.replace("%40","@");if(l=(l=a.ce("edit"))?l.href:void 0)g="delete"==Fp(a.data)?"DELETE":"PUT",k=l;try{var p=Jp(a)}catch(r){Oi({"class":"ydn.gdata.Entry",method:"ydn.gdata.Entry.commit","entry.data":a.data,
context:"toXmlString",error:{name:r.name,message:r.message,stack:r.stack}})}l=a.type;m=["atom","app","gd","batch","ydn"];if("sites"==l||"site"==l||"content"==l||"webpage"==l)m=m.concat("xhtml","sites");else if("m8"==l||"contact"==l)m=m.concat("gContact");p=qp(p,m);Cp.g&&(a.h=[k,f,g,e,p]);d.request(new bi(k,g,f,e,p)).execute(b,c)}else N(a.logger,a+" commit ignore since not modified."),b&&b.call(c,null,null)}function Hp(a){if(null==a.id)return!0;a=Fp(a);return"modified"===a||"delete"===a}h.Ce=function(){return this.data};
function Jp(a){var b=new wp(null,"entry",a.Ce()),c=!1;b.xmlns||(b.xmlns="http://www.w3.org/2005/Atom",c=!0);var d=["atom"],e;for(e in a.data)if(a=e.match(/^(\w+)\$\w+/))a=a[1],a in pp&&(Ya(d,a)||d.push(a));e=Ap(b);c&&delete b.xmlns;return qp(e,d)}h.update=function(a){var b=["batch$status","batch$operation","status"],c;for(c in a.data)a.data.hasOwnProperty(c)&&y(a.data[c])&&!Ya(b,c)&&!Ya(this.fg,c)&&(this.data[c]=a.data[c])};h.jf=function(a,b){if(Dl(this.data[a],b))return!1;this.data[a]=Vl(b);return!0};
h.hf=function(a){if(a.data.updated.$t>=this.data.updated.$t&&Gp(a)){if(Gp(this)||"delete"==Fp(this.data))return!1;Ep(this,"delete");return!0}var b=!1,c;for(c in a.data)a.data.hasOwnProperty(c)&&y(a.data[c])&&!Ya(this.fg,c)&&this.jf(c,a.data[c])&&(b=!0);b&&(a=Fp(this.data),"delete"==a?L(this.logger,this+" marked for deletion. Cannot mark modify flag."):"committed"==a?this.logger.log(Se,this+" already committed. All changes must wait until updated from the server.",void 0):Ep(this,"modified"));return b};function Kp(a,b,c){Vo.call(this,a,b,c)}B(Kp,Vo);Kp.prototype.he=function(){return this.key};Kp.prototype.ec=function(a,b,c,d){a=Kp.m.ec.call(this,a,b,c,d);this.g.vg(a.method)&&q.gapi&&q.gapi.auth&&(b=gapi.auth.getToken())&&b.access_token&&(a.headers.Authorization=b.token_type+" "+b.access_token);if("GET"==a.method)a.params.alt="json";else if("PUT"==a.method||"POST"==a.method)d=new Cp(d),a.body=Jp(d),a.headers["Content-Type"]="application/atom+xml";return a};
Kp.prototype.De=function(a,b){a=Kp.m.De.call(this,a,b);a.feed&&(a=a.feed);a.entry&&(a=a.entry);return a};function Lp(a,b,c){cp.call(this,a,b,c);a=c.Options;this.kind=a.kind;this.version=a.version;this.projection=a.projection;this.i=a.maxResults}B(Lp,lp);h=Lp.prototype;h.projection=null;h.version=null;h.logger=P("ydn.db.sync.GData");h.wa=function(a,b){return new Kp(this,a,b)};h.qb=function(){var a=Lp.m.qb.call(this);a.key=["id","$t"];a.etag="gd$etag";a.updated=["updated","$t"];return a};h.rb=function(){var a=Lp.m.rb.call(this);return a=a.concat(["version","projection","kind","maxResults"])};
h.Eb=function(){return"https://www.googleapis.com/"+this.kind+"/"};h.vg=function(){return!1};h.F=function(a){return a?a.id?a.id.$t:"":""};
function Mp(a,b,c){var d=c||a.Eb();c&&O(a.logger,"continuing "+c);b=new bi(d,"GET",b);var e=new C;a.ta().request(b).execute(function(b,d){if(200==d.O()){if(!b){var k=$i(d);v(k)&&(b=JSON.parse(k))}var k=b.feed||b,l=k.entry,l=l?u(l)?l:[l]:[];0<l.length&&Yo(a,l);for(var l=null,k=k.link,k=u(k)?k:[k],m=0;m<k.length;m++)"next"==k[m].rel&&(l=k[m].href);l?rb(Mp(a,{},l),e):(O(a.logger,"prefetch "+a.P+" done"),e.C(!!c))}else 302==d.O()?e.C():(k=a+": Invalid response status "+d.O()+" on prefetching",L(a.logger,
k),e.D(Error(k)))});return e}h.Vb=function(){O(this.logger,"starting prefetch");var a=new C;ll(this.storage.g,this.P,"updated.$t",null,!0,1).B(function(b){var c={alt:"json",kind:this.kind};this.i&&(c["max-results"]=this.i);(b=b[0])?(b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b,O(this.logger,this.P+" fetching entries later then "+b)):O(this.logger,this.P+" fetching entries from beginning");rb(Mp(this,c),a)},this);return a};
h.count=function(a){var b=Oj(this.store,"updated.$t");if(!b)return a;var c=dk(a);a.A(function(a){Uc(c,a);ll(this.storage.g,this.P,b.getName(),null,!1,1).A(function(b){var f={alt:"json"};if(b=u(b)?b[0]:b)b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),f["updated-min"]=b;var g=this,f=new bi(this.Eb(),"GET",f);this.ta().request(f).execute(function(b,e){if(200==e.O()){if(!b){var f=$i(e);v(f)&&(b=JSON.parse(f))}f=lc(b.feed,"openSearch$totalResults");c.C(a+parseFloat(f||0))}else L(g.logger,
g+":Unexpected respond status "+e.O())})},function(a){c.D(a)},this)},function(a){c.D(a)},this);return c};function Np(a,b,c){Vo.call(this,a,b,c)}B(Np,Kp);function Op(a,b,c){Lp.call(this,a,b,c);this.h=this.h.substr(27);this.Lb=c.Options.prefix}B(Op,Lp);Op.prototype.ta=function(){this.g||(this.g=new Pp(gapi.client));return this.g};Op.prototype.wa=function(a,b){return new Np(this,a,b)};Op.prototype.Eb=function(){return this.h+this.Lb};
Op.prototype.Vb=function(){O(this.logger,"starting prefetch");var a=new C;ll(this.storage.g,this.P,"updated",null,!0,1).A(function(b){var c={alt:"json"};if(b=b[0])b=lc(b,"updated"),b=(new Date(1+ +new Date(b))).toISOString(),c.updatedMin=b;var d=this,c=new bi(this.Eb(),"GET",c);d.ta().request(c).execute(function(b,c){if(b){var g=b.items||[];0<g.length?Yo(d,g).fa(function(){a.C(!0)}):a.C(!1)}else 302==c.O()?a.C():(g=d+": Invalid response status "+c.O()+" on prefetching",L(d.logger,g),a.D(Error(g)))})},
function(b){a.D(b)},this);return a};function Qp(a,b){if(!s(q.AWS))throw new Rc("AWS JS SDK not loaded");this.h=a;this.i=b;this.g=null}Qp.prototype.request=function(a){return new Rp(this,a)};function Sp(a){var b={params:{Bucket:a.h,region:a.i}};if(!a.h)throw new K("bucket name required");a.g||(a.g=new AWS.S3(b));return a.g}function Rp(a,b){this.parent=a;this.g=b}
function Tp(a,b,c,d,e){var f=NaN,g="",k={};a=Sp(a.parent)[b](c);a.on("complete",function(a){a.httpResponse&&(f=a.httpResponse.statusCode,v(f)&&(f=parseInt(f,10)),k=a.httpResponse.headers);a.error&&(g=a.error.message,f||(f=400))});a.send(function(a,b){var c=new Yi(f,b,k,g);a?d.call(e,null,c):d.call(e,b,c)})}
Rp.prototype.execute=function(a,b){var c=Hd(new ud(this.g.path)),c="/"==c.charAt(0)?c.substr(1):c,d=this.g.headers||{};c&&(d.Key=c);if(c)if("GET"==this.g.method)Tp(this,"getObject",d,a,b);else if("PUT"==this.g.method)Tp(this,"putObject",d,a,b);else throw new Pc("HTTP method "+this.g.method);};function Up(a,b){this.g=a;this.prefix=Vp(this,"Prefix")[0];this.h=b.type}Up.prototype.ca=function(){return this.g.documentElement.getElementsByTagName("Contents").length};Up.prototype.keys=function(){var a=Vp(this,"Key");if(this.prefix){var b=this.prefix.length,a=a.map(function(a){return a.substr(b)});"INTEGER"==this.h?a=a.map(function(a){return parseInt(a,10)}):"NUMERIC"==this.h&&(a=a.map(function(a){return parseFloat(a)}))}return a};
function Vp(a,b){for(var c=[],d=a.g.documentElement.getElementsByTagName(b),e=d.length,f=0;f<e;f++)c[f]=d[f].textContent;return c}function Wp(a){return Vp(a,"LastModified").map(function(a){return(new Date(Date.parse(a))).toGMTString()})}
function Xp(a){var b=a.g.documentElement.getElementsByTagName("NextMarker");return 1==b.length?b[0].textContent:"true"==a.g.documentElement.getElementsByTagName("IsTruncated")[0].textContent&&(a=a.g.documentElement.firstElementChild.lastElementChild)&&"Contents"==a.tagName?a.getElementsByTagName("Key")[0]:null};function Yp(a,b,c){cp.call(this,a,b,c);this.i=c.Options.bucket;if(!v(this.i)||wa(this.i))throw new K("bucket name required.");this.h||(this.h="https://"+this.i+".s3.amazonaws.com/");if(!0===b.h)throw new K('S3 object store "'+b.getName()+'" must not set autoIncrement to true.');}B(Yp,cp);h=Yp.prototype;h.logger=P("ydn.db.sync.S3");h.rb=function(){var a=Yp.m.rb.call(this);return a=a.concat(["bucket","maxKeys","prefix","delimiter"])};h.ta=function(){this.g||(this.g=new Qp(this.i));return this.g};
h.af=function(a){return this.h+this.j+a};h.wa=function(a,b){return new np(this,a,b)};
h.gf=function(a,b){var c=this;fk(a,function(d,e,f){Uc(a,d);c.Nd(d,function(a){var e={},l=a[0]?Qo(a[0]):null;null!=l&&(e.marker=l);0<c.j.length&&(e.prefix=c.j);0<b&&(e["max-keys"]=b);O(c.logger,c+" querying for newer entries starting from "+l);e=new bi(c.h,"GET",e);c.ta().request(e).execute(function(b,e){if(200==e.O()){for(var k=$i(e),k=k instanceof Document?k:Ch(k),l=new Up(k,c.store),k=l.keys(),l=Wp(l),t=[],x=[],z=[],G=0,E=0;G<=a.length&&E<k.length;){var J=a[G]?Qo(a[G]):null,Q=k[E];if(G==a.length)x.push(Q),
E++;else{var ma=J?tj(J,Q):-1;0==ma?((Q=Ro(a[G]))&&l[E]&&Q!=l[E]&&(l[E]>Q?z.push(J):L(c.logger,'record "'+J+'" in database is more recent than server '+Q+" vs "+l[E])),G++,E++):1==ma?(t.push(J),G++):(x.push(Q),E++)}}hp(c,f,d,x,z,t)}else L(c.logger,"Invalid response status "+e.O())})})},this)};
function Zp(a,b){function c(f){null!=f&&(d.marker=f);O(a.logger,a+" querying for newer entries starting from "+f);e.request(new bi(a.h,"GET",d)).execute(function(d,e){if(200==e.O()){var f=$i(e),f=f instanceof Document?f:Ch(f),f=new Up(f,a.store),m=Xp(f),f=f.keys(),n=f.length;if(0==n)b([]),b=null;else for(var p=0,r=0;r<n;r++)a.wa(f[r]).hc(function(){p++;p==n&&(m?c(m):b&&(b([this.tb()]),b=null))})}else L(a.logger,"Invalid response status "+e.O())})}var d={};0<a.j.length&&(d.prefix=a.j);var e=a.ta();
c();a.Z=!0}function $p(a,b){a.Z||fk(b,function(a,b,e){s(a[0])?e(a):Zp(this,e)},a)};function aq(a,b,c){Vo.call(this,a,b,c)}B(aq,np);aq.prototype.logger=P("ydn.db.sync.entry.Gcs");function bq(a,b,c){Yp.call(this,a,b,c);this.h="https://"+this.i+".storage.googleapis.com/"}B(bq,Yp);bq.prototype.logger=P("ydn.db.sync.Gcs");bq.prototype.ta=function(){this.g||(this.g=new lo);return this.g};bq.prototype.wa=function(a,b){return new aq(this,a,b)};function Pp(a,b){this.h=a;this.g=!!b}Pp.prototype.request=function(a){var b={path:a.path,method:a.method,headers:a.headers,params:a.params,body:a.body};this.g&&(b.callback=function(a,e){c.C(a,e);b.callback=null});a=this.h.request(b);var c=new cq(a);return c};function cq(a){this.h=a||null}cq.prototype.C=function(a,b){this.i&&(this.i(a,cj(b)),this.i=null);this.g={json:a,Ac:b}};
cq.prototype.execute=function(a){this.h?(this.h.execute(function(b,c){a(b,cj(c))}),this.h=null):this.g?(a(this.g.json,cj(this.g.Ac)),this.g=null):this.i=a};function dp(a){if(a){if(a instanceof lo)return a;if(ha(a))return new Pp({request:function(b){a(b)}},!0);if("request"in a)return new Pp(a);throw new K(a+" is not a valid HTTP Client");}return null};function dq(a,b,c){Vo.call(this,a,b,c)}B(dq,aq);dq.prototype.logger=P("ydn.db.sync.entry.GcsJson");dq.prototype.hc=function(a){var b=this.g,c=this;Zo(this,function(d){var e={method:"GET",path:"storage/v1beta2/b/"+b.i+"/o/"+encodeURIComponent(c.getName())};d&&(e.headers=To(d));gapi.client.request(e).execute(function(d,e){var k=cj(e);c.j=new Uo(c.F(),k.Nc(),b.o);d?(O(c.logger,c+": readServer updated"),c.i=d):(O(c.logger,c+": readServer request fail "+e),c.j=null,c.i=null);a.call(c,200)},e)})};function eq(a,b,c){bq.call(this,a,b,c)}B(eq,bq);h=eq.prototype;h.logger=P("ydn.db.sync.GcsJson");h.qb=function(){var a=eq.m.qb.call(this);a.key="name";return a};h.ta=function(){if(!this.g)if(s(q.gapi))this.g=new Pp(gapi.client);else throw new Rc("gapi not loaded");return eq.m.ta.call(this)};h.wa=function(a,b){return new dq(this,a,b)};
h.Vb=function(){N(this.logger,"starting prefetch");var a=new C;nl(this.storage.g,this.P,null,null,1,0,!0,!1).A(function(b){var c={bucket:this.i};(b=b[0])&&(c.marker=b);var d=this;if(!q.Tg||q.Tg.client)throw Error("gapi lib not loaded");gapi.client.load("storage","v1beta2",function(){var b=gapi.client.storage.objects.list({bucket:d.i});this.Lb&&(c.prefix=this.Lb);b.execute(function(b,c){if(b&&!b.error){var e=b.items||[];0<e.length?Yo(d,null,e).fa(function(){a.C(!0)}):a.C(!1)}else e=d+": "+c,L(d.logger,
e),a.D(Error(e))})})},function(b){a.D(b)},this);return a};function fq(a,b,c){bq.call(this,a,b,c);this.N="full"}B(fq,bq);h=fq.prototype;h.logger=P("ydn.db.sync.GcsMeta");h.qb=function(){var a=fq.m.qb.call(this);a.key="name";return a};h.ta=function(){!this.g&&gapi&&(this.g=new Pp(gapi.client));return fq.m.ta.call(this)};h.wa=function(a,b){return new dq(this,a,b)};
h.Vb=function(){N(this.logger,"starting prefetch");var a=new C;if(!q.gapi||!q.gapi.client)throw Error("gapi lib not loaded");var b=this;gapi.client.load("storage","v1beta2",function(){function c(e){e&&(d.pageToken=e);gapi.client.storage.objects.list(d).execute(function(e,g){if(e&&!e.error){var k=e.items||[];if(e.nextPageToken)O(b.logger,"receiving "+k.length+" meta records, continuing next"),Yo(b,k),c(e.nextPageToken);else if(0<k.length)Yo(b,k).fa(function(){O(b.logger,"receiving "+k.length+" meta records, prefetching dane.");
a.C(!0)});else{var l=!!d.pageToken;O(b.logger,"prefetching done");a.C(l)}}else l=b+": "+g,L(b.logger,l),a.D(Error(l))})}var d={bucket:b.i};this.Lb&&(d.prefix=this.Lb);c()});return a};h.Nd=function(a,b){if(0==a.length)b([]);else{var c=this.I(),d=Ta(a,function(a){return new sk(c,a)});gp(this,d).A(function(d){for(var f=[],g=0;g<a.length;g++)f[g]=new Po(a[g],d[g],this.o,c);b(f)},function(a){L(this.logger,this+" error loading meta data "+a);b([])},this)}};function gq(a,b,c){cp.call(this,a,b,c)}B(gq,cp);gq.prototype.af=function(a){return this.h+this.j+this.P+this.na+a};gq.prototype.logger=P("ydn.db.sync.Json");
gq.prototype.gf=function(a){function b(a,b){var c=new bi(e);d.ta().request(c).execute(function(c){if(200==c.status){var e=(c.response instanceof Object?c.response:xh(c.responseText)).items;c=Ta(e,function(a){return a.id});for(var e=Ta(e,function(a){return a.updated}),k=[],p=[],r=[],t=0,x=0;t<=a.length&&x<c.length;){var z=Qo(a[t]),G=c[x];if(t==a.length)p.push(G),x++;else{var E=tj(z,G);0==E?((G=Ro(a[t]))&&e[x]&&G!=e[x]&&(new Date(e[x])>G?r.push(z):L(d.logger,'record "'+z+'" in database is more recent than server '+
G+" vs "+e[x])),t++,x++):1==E?(k.push(z),t++):(p.push(G),x++)}}hp(d,function(){},b,p,r,k)}else L(d.logger,"Invalid response status "+c.status)})}var c=new Tc,d=this,e=this.h+this.j+this.P;a.B(function(a){Uc(c,a);this.Nd(a,function(c){b(c,a)})},this)};function hq(a,b,c){cp.call(this,a,b,c)}B(hq,lp);function iq(a,b,c){Vo.call(this,a,b,c)}B(iq,np);iq.prototype.logger=P("ydn.db.sync.entry.S3Meta");function jq(a,b,c){Yp.call(this,a,b,c);this.Lb=c.Options.prefix;if("Key"!=b.keyPath)throw new K('s3-meta store "'+b.getName()+'" must use inline key with keyPath "Key"');this.N="meta"}B(jq,Yp);h=jq.prototype;h.logger=P("ydn.db.sync.S3Meta");h.qb=function(){var a=jq.m.qb.call(this);a.key="Key";a.modified="LastModified";a.etag="ETag";return a};h.wa=function(a,b){return new iq(this,a,b)};
h.Vb=function(){function a(f){f&&(e.marker=f);c.listObjects(e).send(function(c,f){if(c){var l=d+": "+yh(c);L(d.logger,l);b.D(c instanceof Error?c:Error(l))}else{var m=f.Contents||[];f.IsTruncated?(O(d.logger,"receiving "+m.length+" meta records, continuing next"),Yo(d,m),a(m[m.length-1].Key+"\uffff")):0<m.length?Yo(d,m).fa(function(){O(d.logger,"receiving "+m.length+" meta records, prefetching dane.");b.C(!0)}):(l=!!e.marker,O(d.logger,"prefetching done"),b.C(l))}})}N(this.logger,"starting prefetch");
var b=new C,c=Sp(this.ta()),d=this,e={};this.Lb&&(e.prefix=this.Lb);a();return b};h.Nd=function(){throw new Rc("loading meta data should not be necessary");};function kq(a,b,c){Vo.call(this,a,b,c)}B(kq,Kp);function lq(a,b,c){Lp.call(this,a,b,c);a=c.Options;this.domain=a.domain;this.Z=a.siteName;if(a=Pj(b,"sites$parent"))El(a,function(a){for(var b=a.link||[],c=0;c<b.length;c++)if("http://schemas.google.com/sites/2008#parent"==b[c].rel)return b[c].href;return a.id.$t.replace(/\w+$/,"0")}),M(this.logger,"index sites$parent in "+b.getName()+" has set a generator.");if(a=Pj(b,"alternate"))El(a,function(a){a=a.link||[];for(var b=0;b<a.length;b++)if("alternate"==a[b].rel)return a[b].href}),M(this.logger,"index alternate in "+
b.getName()+" has set a generator.")}B(lq,Lp);h=lq.prototype;h.wa=function(a,b){return new kq(this,a,b)};h.rb=function(){var a=lq.m.rb.call(this);return a=a.concat(["domain","siteName"])};h.Eb=function(){return"https://sites.google.com/feeds/content/"+this.domain+"/"+this.Z+"/"};h.vg=function(a){return"GET"!=a};
function mq(a,b,c,d){var e={alt:"json",kind:a.kind};"sites$parent"==c?(c=d.match(/\w+$/)[0],e.parent=c):"alternate"==c&&(c=d.replace(/https:\/\/sites.google.com\/a\/[^\/]+\/[^\/]+/,""),e.path=c);var f={},g=a.Eb();fk(b,function(c,l,m){Uc(b,c);if(l=c[0])l=lc(l,"updated","$t"),l=(new Date(1+ +new Date(l))).toISOString(),e["updated-min"]=l;l=new bi(g,"GET",e,f);a.ta().request(l).execute(function(b,e){if(200==e.O()){if(!b){var f=$i(e);v(f)&&(b=JSON.parse(f))}var g=(f=(b.feed||b).entry)?u(f)?f:[f]:[];0<
g.length?Yo(a,g).fa(function(){m(g)}):m(c)}else 302==e.O()?m(c):(f=a+": Invalid response status "+e.O()+" for querying pageName: "+d,L(a.logger,f),m(Error(f),!0))})},a)}h.Be=function(a,b,c){if(jp(this))fk(a,function(d,e,f){Uc(a,d);kp(this,function(a){!0===a?ll(this.storage.g,this.P,b,S.only(c),!1,0).A(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(a){f(a,!0)},this)},this);else return"alternate"==b||"alternate"==b?mq(this,a,b,c):lq.m.Be.call(this,a,b,c)};Mk.prototype.g=null;
km.prototype.Mf=function(a,b){var c=b.format;if("gdata-sites"==c)a.g=new lq(this,a,b);else if("gdata"==c)a.g=new Lp(this,a,b);else if("gdata-json"==c)a.g=new Op(this,a,b);else if("odata"==c)a.g=new hq(this,a,b);else if("s3"==c)a.g=new Yp(this,a,b);else if("s3-meta"==c)a.g=new jq(this,a,b);else if("gcs"==c)a.g=new bq(this,a,b);else if("gcs-json"==c)a.g=new eq(this,a,b);else if("gcs-meta"==c)a.g=new fq(this,a,b);else if("atom"==c)a.g=new lp(this,a,b);else if("json"==c)a.g=new gq(this,a,b);else if("rest"==
c)a.g=new cp(this,a,b);else throw new Pc("Sync format: "+c);Nl(a,function(b,c){var f=b.zd();if(!(this instanceof Kk)||this.Qa)if(!window.navigator||!s(window.navigator.onLine)||window.navigator.onLine)if("add"==f)f=c[1],a.g.add(b,f);else if("count"==f)c[1]||c[2]||a.g.count(b);else if("put"==f){var f=c[1],g=c[2];a.g.put(b,f,g)}else if("rm:iter"==f)g=c[1],a.g.remove(b,g);else if("values:iter:index"==f){var f=c[1],g=c[2],k=c[3],l=c[4],m=c[5];!k&&!m&&g&&null!=g.lower&&null!=g.upper&&0==tj(g.lower,g.upper)&&
a.g.Be(b,f,g.lower)}else if("keys"==f)g=c[1],l=c[2],k=c[3],m=c[4],a.g.keys(b,null,g,l,k,m,!1);else if("keys:iter:index"==f)f=c[1],g=c[2],l=c[3],k=c[4],m=c[5],a.g.keys(b,f,g,l,k,m,c[6]);else if("values"==f)g=c[1],l=c[2],k=c[3],m=c[4],g||m?g&&g.lower&&v(g.lower)&&g.lower==g.upper||!g&&m&&1==l&&k&&$p(a.g,b):a.g.values(b,l,k);else if(""!=f)if("get"==f)g=c[1],a.g.get(b,g);else if("values:array"==f)ip(a.g,b,c[1]);else throw Error(f);})};var nq="Accounts Campaigns Contacts Documents Emails EmailTemplates Employees Leads Notes Opportunities Tasks Teams TeamSets Users".split(" "),oq="Accounts Contacts EmailTemplates Leads Notes Emails".split(" "),pq=["Accounts","Contacts","Leads"],qq=["Accounts","Contacts","Leads"],rq=["Contacts","Leads"],sq=["Notes"];function tq(a,b,c){return"https://"+a+"/index.php?module="+b+"&action=DetailView&record="+c};function uq(a){this.h=a||[]}uq.prototype.g=function(a){return-1==this.h.indexOf(a)?a:null};function vq(){}
vq.prototype.g=function(a){var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};a=a.toLowerCase();var d,e,f=a;if(3>a.length)return a;var g,k;a=a.substr(0,1);"y"==a&&(f=a.toUpperCase()+f.substr(1));g=/^(.+?)(ss|i)es$/;e=/^(.+?)([^s])s$/;
g.test(f)?f=f.replace(g,"$1$2"):e.test(f)&&(f=f.replace(e,"$1$2"));g=/^(.+?)eed$/;e=/^(.+?)(ed|ing)$/;g.test(f)?(e=g.exec(f),g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(e[1])&&(g=/.$/,f=f.replace(g,""))):e.test(f)&&(e=e.exec(f),d=e[1],e=/^([^aeiou][^aeiouy]*)?[aeiouy]/,e.test(d)&&(f=d,e=/(at|bl|iz)$/,k=/([^aeiouylsz])\1$/,d=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,e.test(f)?f+="e":k.test(f)?(g=/.$/,f=f.replace(g,"")):d.test(f)&&(f+="e")));g=/^(.+?)y$/;g.test(f)&&(e=g.exec(f),
d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy]/,g.test(d)&&(f=d+"i"));g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+b[e]));g=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+c[e]));g=
/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;e=/^(.+?)(s|t)(ion)$/;g.test(f)?(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d)):e.test(f)&&(e=e.exec(f),d=e[1]+e[2],e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,e.test(d)&&(f=d));g=/^(.+?)e$/;g.test(f)&&(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,g.test(d)||e.test(d)&&!k.test(d))&&(f=d);g=/ll$/;e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;g.test(f)&&e.test(f)&&(g=/.$/,f=f.replace(g,""));"y"==a&&(f=a.toLowerCase()+f.substr(1));return f};function wq(a){this.h=a}
wq.prototype.g=function(a){a=a.toLowerCase();a=a.replace(/([^c])\1/g,"$1");a=function(a){return a.match(/^(kn|gn|pn|ae|wr)/)?a.substr(1,a.length-1):a}(a);a=a.replace(/mb$/,"m");a=a.replace(/ck/g,"k");a=function(a){a=a.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim();a=a.replace(/cia/g,"xia");a=a.replace(/c(i|e|y)/g,"s$1");return a=a.replace(/c/g,"k")}(a);a=function(a){a=a.replace(/d(ge|gy|gi)/g,"j$1");return a=a.replace(/d/g,"t")}(a);a=function(a){a=a.replace(/gh(^$|[^aeiou])/g,"h$1");return a=a.replace(/g(n|ned)$/g,
"$1")}(a);a=function(a){a=a.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3");a=a.replace(/gg/g,"g");return a=a.replace(/g/g,"k")}(a);a=a.replace(/([aeiou])h([^aeiou])/g,"$1$2");a=a.replace(/ph/g,"f");a=a.replace(/q/g,"k");a=a.replace(/s(h|io|ia)/g,"x$1");a=function(a){a=a.replace(/^x/,"s");return a=a.replace(/x/g,"ks")}(a);a=function(a){a=a.replace(/t(ia|io)/g,"x$1");return a=a.replace(/th/,"0")}(a);a=a.replace(/tch/g,"ch");a=a.replace(/v/g,"f");a=a.replace(/^wh/,"w");a=a.replace(/w([^aeiou]|$)/g,"$1");a=a.replace(/y([^aeiou]|$)/g,
"$1");a=a.replace(/z/,"s");a=a.charAt(0)+a.substr(1,a.length).replace(/[aeiou]/g,"");a.length>=this.h&&(a=a.substring(0,this.h));return a=a.toUpperCase()};var xq=new wq(32),yq=new vq,zq=new uq("a a's able about above according accordingly across actually after afterwards again against ain't all allow allows almost alone along already also although always am among amongst an and another any anybody anyhow anyone anything anyway anyways anywhere apart appear appreciate appropriate are aren't around as aside ask asking associated at available away awfully b be became because become becomes becoming been before beforehand behind being believe below beside besides best better between beyond both brief but by c c'mon c's came can can't cannot cant cause causes certain certainly changes clearly co com come comes concerning consequently consider considering contain containing contains corresponding could couldn't course currently d definitely described despite did didn't different do does doesn't doing don't done down downwards during e each edu eg eight either else elsewhere enough entirely especially et etc even ever every everybody everyone everything everywhere ex exactly example except f far few fifth first five followed following follows for former formerly forth four from further furthermore g get gets getting given gives go goes going gone got gotten greetings h had hadn't happens hardly has hasn't have haven't having he he's hello help hence her here here's hereafter hereby herein hereupon hers herself hi him himself his hither hopefully how howbeit however i i'd i'll i'm i've ie if ignored immediate in inasmuch inc indeed indicate indicated indicates inner insofar instead into inward is isn't it it'd it'll it's its itself j just k keep keeps kept know knows known l last lately later latter latterly least less lest let let's like liked likely little look looking looks ltd m mainly many may maybe me mean meanwhile merely might more moreover most mostly much must my myself n name namely nd near nearly necessary need needs neither never nevertheless new next nine no nobody non none noone nor normally not nothing novel now nowhere o obviously of off often oh ok okay old on once one ones only onto or other others otherwise ought our ours ourselves out outside over overall own p particular particularly per perhaps placed please plus possible presumably probably provides q que quite qv r rather rd re really reasonably regarding regardless regards relatively respectively right s said same saw say saying says second secondly see seeing seem seemed seeming seems seen self selves sensible sent serious seriously seven several shall she should shouldn't since six so some somebody somehow someone something sometime sometimes somewhat somewhere soon sorry specified specify specifying still sub such sup sure t t's take taken tell tends th than thank thanks thanx that that's thats the their theirs them themselves then thence there there's thereafter thereby therefore therein theres thereupon these they they'd they'll they're they've think third this thorough thoroughly those though three through throughout thru thus to together too took toward towards tried tries truly try trying twice two u un under unfortunately unless unlikely until unto up upon us use used useful uses using usually uucp v value various very via viz vs w want wants was wasn't way we we'd we'll we're we've welcome well went were weren't what what's whatever when whence whenever where where's whereafter whereas whereby wherein whereupon wherever whether which while whither who who's whoever whole whom whose why will willing wish with within without won't wonder would wouldn't x y yes yet you you'd you'll you're you've your yours yourself yourselves z zero".split(" "));function Aq(a){this.data=a;this.h=0}Aq.prototype.g=function(a){for(var b=this.h,c=this.data[b],c=1,d=0;0<=b&&b<this.data.length;){c=this.data[b];if(c instanceof Array)if(a<c[0])c=-1;else if(a>c[1])c=1;else return this.h=b,!0;else{if(c==a)return this.h=b,!0;c=a<c?-1:1}if(0==d)d=c;else if(d!=c)break;b+=c;if(b>this.data.length||0>b)break}return!1};
function Bq(a,b){for(var c=0,d=0,e=a.length,f=0;f<e;++f){a:{var d=a.charCodeAt(f),g=new Aq(categ_letters_numbers_data);if(w(d))d=g.g(d);else{for(var k=0,l=d.length;k<l;++k)if(!1===g.g(d[k])){d=!1;break a}d=!0}}d||((d=f-c)&&b(c,d),c=f+1)}(d=e-c)&&b(c,d)};function Cq(a,b){this.j=b;this.value=a}Cq.prototype.V=function(){return this.value};Cq.prototype.sb=function(){return 1};var Dq=Th||Qh;Cq.prototype.F=function(){return this.value};Cq.prototype.toString=function(){return"Entry:"+this.value};function Eq(a,b,c,d,e,f){Cq.call(this,d,e);this.P=a;this.h=b;this.i=c;this.Od=f||[]}B(Eq,Cq);h=Eq.prototype;h.bd=function(){return{k:this.j,v:this.value.toLowerCase(),id:this.F(),loc:this.Od}};h.F=function(){var a=[this.P,this.i,this.h,this.value];return Dq?a:yj(a)};h.I=function(){return this.P};h.ha=function(){return this.i};h.toString=function(){return["IndexEntry",this.P,this.i,this.value].join(":")};function Fq(a,b,c,d,e){Cq.call(this,b,c);this.l=d;this.g=e;this.type=a;this.Of=1}B(Fq,Cq);Fq.prototype.sb=function(){return this.g*this.type*this.Of};Fq.prototype.F=function(){return this.value+"|"+this.l};function Gq(a,b){Eq.call(this,b.I(),b.h,b.ha(),b.V(),b.j,[]);this.o=a;this.g=[b]}B(Gq,Eq);h=Gq.prototype;h.count=function(){return this.g.length};h.entry=function(a){return this.g[a]};h.hf=function(a){a=a.g[0];for(var b=0;b<this.g.length;b++)if(this.g[b].h==a.h&&this.g[b].value==a.value)return;this.g.push(a)};h.sb=function(){for(var a=0,b=0;b<this.g.length;b++)var c=this.g[b],d=Ql(this.o,c.I(),c.h),c=c.sb(),a=a+c*d.h;return a};function kb(a,b){var c=a.sb(),d=b.sb();return c<=d?1:-1}
h.bd=function(){for(var a={value:this.value,primaryKey:this.i,storeName:this.P,score:this.sb(),tokens:[]},b=0;b<this.g.length;b++)a.tokens[b]=this.g[b].bd();return a};h.toString=function(){return["RankEntry",this.P,this.i,this.value].join(":")+"["+this.g.length+"]"};function Hq(a){var b=[],c;a=a.split(/\s+/);for(var d=0;d<a.length;d++){c=a[d];for(var e=c.length-1,f=Array(e),g=0;g<e;g++)f[g]=c.substring(g,g+2);c=f;b.push.apply(b,c)}return b};function el(a,b,c,d,e,f,g){Eq.call(this,b,c,d,e,f,g);this.query=a}B(el,Eq);el.prototype.sb=function(){var a,b=this.value;a=Hq(this.query.value.toLowerCase().replace(/^\s+|\s+$/g,""));var b=Hq(b.toLowerCase().replace(/^\s+|\s+$/g,"")),c=0,d=a.length+b.length,e,f,g,k;for(e=0;e<a.length;e++)for(g=a[e],f=0;f<b.length;f++)if(k=b[f],g==k){c++;delete b[f];break}a=2*c/d;b=Math.log(this.Od.length+1);c=this.query.sb();return b*a*c};el.prototype.bd=function(){return{keyPath:this.h,value:this.value,loc:this.Od.slice()}};
el.prototype.toString=function(){return["ResultEntry",this.P,this.i,this.value].join(":")};function Iq(a,b,c){this.g=a;this.h=b;this.j=[];this.limit=c||1E3;this.i=0}function dl(a,b){for(var c,d,e=a.g.getName(),f=0;f<a.h.length;f++){var g=a.h[f],k=g.type;0.4==k||0.6==k?(d="v",c=g.V().toLowerCase(),c=nj(c)):(d="v",c=g.V().toLowerCase(),c=S.only(c));b(e,d,c,g);a.i++;0.6==k&&(d="k",c=g.j,c=S.only(c),b(e,d,c,g),a.i++)}}function cl(a){for(var b=[a.g.getName()],c=0;c<a.g.count();c++){var d=a.g.index(c).I();-1==b.indexOf(d)&&b.push(d)}return b}
function fl(a){for(var b=[],c=[],d=0;d<a.j.length;d++){var e=a.j[d];if(0==e.query.type)-1==Xa(c,function(a){return a.ha()==e.ha()&&a.I()==e.I()})&&c.push(e);else{var f=new Gq(a.g,e),g=Xa(b,function(a){return a.ha()==f.ha()&&a.I()==f.I()});if(0<=g){var k=b[g];ab(b,g);k.hf(f);f=k}jb(b,f)}}for(a=0;a<c.length;a++)for(g=c[a],d=b.length-1;0<=d;--d)if(k=b[d],g.ha()==k.ha()&&g.I()==k.I()){b.splice(a,1);break}return b.map(function(a){return a.bd()})};function Jq(a){this.g=a;if("en"==a.lang){a=a.h||["stop","stemmer","metaphone"];for(var b=[],c=0;c<a.length;c++)if("metaphone"==a[c])b.push(xq);else if("stemmer"==a[c])b.push(yq);else if("stop"==a[c])b.push(zq);else throw Error('Invalid normalizer "'+a[c]+'" for English lang');a=b}else a=[];this.h=a}function Kq(a,b){for(var c=0;c<a.h.length;c++){var d=a.h[c].g(b);if(d)b=d;else return null}return b}Jq.prototype.parse=function(a){var b=[];Bq(a,function(c,d){b.push(a.substr(c,d))});return b};
Jq.prototype.query=function(a,b,c){a=Lq(this,b);return 0==a.length?null:new Iq(this.g,a,c||10)};
function Lq(a,b){var c=[],d=[];Bq(b,function(a,e){c.push(b.substr(a,e));d.push(a)});for(var e=[],f=0;f<c.length;f++)e[f]=Kq(a,c[f]);for(var g=[],k=0,f=0;f<c.length;f++){var l=c[f],m=e[f],n="*"==b.charAt(d[f]+l.length),p=n?d[f]+l.length+1:d[f]+l.length,p='"'==b.charAt(d[f]-1)&&'"'==b.charAt(p),r="-"==b.charAt(p?d[f]-2:d[f]-1),t=0.8;n?t=0.4:p?t=1:r?t=0:null!=m&&(t=0.6);l=new Fq(t,l,m,d[f],1/(f+2));g.push(l);k+=l.sb()}for(f=0;f<g.length;++f)g[f].Of=1/k;return g}
function Mq(a,b,c,d){var e=[],f=[];Bq(b,function(a,c){e.push(b.substr(a,c));f.push(a)});for(var g=[],k=0;k<e.length;k++)g[k]=Kq(a,e[k]);a=c.I();c=c.g;for(var l=[],k=0;k<e.length;k++){var m=e[k],n=g[k];if(null!=n){var p=Wa(l,function(a){return a.V()==m});p||(p=new Eq(a,c,d,m,n),l.push(p));p.Od.push(f[k])}}return l}function Nq(a,b,c,d){for(var e=[],f=0;f<a.g.count();f++){var g=a.g.index(f);if(g.I()==b){var k=vj(d,g.g);v(k)&&(e=e.concat(Mq(a,k,g,c)))}}return e};km.prototype.Lf=function(a,b){var c=this;b.g=new Jq(b);Nl(a,function(d,e){function f(e){var f=a.getName();uk(e)&&fk(d,function(a,g,k){if(g)k(a,g);else{Uc(d,a);var l=lj(S.bound([f,e],[f,e,"\uffff"])),z=b.getName();kl(c.g,z,l).fa(function(){k(a,g)})}})}function g(b){var e=a.getName();fk(d,function(a,f,g){f?g(a,f):(Uc(d,a),b&&(b=lj(S.bound([e,b.lower],[e,b.upper,"\uffff"]))),kl(c.g,e,b).fa(function(){g(a,f)}))})}function k(e,f){var g=a.getName();fk(d,function(a,k,l){Uc(d,a);if(k)l(a,k);else{var z=b.getName();
u(a)||(a=[a]);for(var G=0;G<a.length;G++){var E=a[G];if(uk(E)){if(f){var J=lj(S.bound([g,E],[g,E,"\uffff"]));kl(c.g,z,J)}E=Nq(b.g,g,E,e[G]).map(function(a){return a.bd()});E=il(c.g,z,E);G==a.length-1&&E.fa(function(){l(a,k)})}}}})}var l=d.zd();"put"==l?k([e[1]],!0):"put:array"==l?k(e[1],!0):"add"==l?k([e[1]],!1):"add:array"==l?k(e[1],!1):"rm:iter"==l||"clear"==l?g(e[1]):"rm"==l&&f(e[1])})};
km.prototype.search=function(a,b,c,d){var e=Ul(this.h,a);if(!e)throw new K('full text index catalog "'+a+'" not found.');a=e.g.query(a,b,c,d);return a?this.g.search(a):(N(this.logger,'query "'+b+'" contains only noise and search is ignored'),gk("search",null))};function Oq(a){this.name=a;this.info=null;this.h={};this.g=null}
var Pq={Accounts:{GeneratorIndex:{ydn$emails:["email","email1","email_addresses_non_primary"],ydn$phones:["phone_office","phone_alternate","phone_fax"]}},Contacts:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Documents:{FullTextIndex:{content:["name","document_name","filename","description"]},indexes:[{name:"parent",keyPath:["doc_type","doc_id"]}]},
Emails:{FullTextIndex:{content:["name","description"]},GeneratorIndex:{ydn$emails:["bcc_addrs","cc_addrs","from_addr","to_addrs","reply_to_addr"]},indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]},{name:"message_id"}]},Leads:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Notes:{FullTextIndex:{content:["name","description"]},
indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]}]}};
function Qq(a,b){return"ydn$emails"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=a.indexOf(e))if(v(b[e]))if(/addrs$/.test(e))for(var f=b[e].split(","),g=0;g<f.length;g++){var k=mn(f[g]);k&&d.push(k)}else(k=mn(b[e]))&&d.push(k);else if(fa(b[e])&&b[e][0]&&b[e][0].email_address)for(f=b[e],g=0;g<f.length;g++)f[g]&&v(f[g].email_address)&&(k=mn(f[g].email_address))&&d.push(k);return d}}:"ydn$phones"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=
a.indexOf(e)){var f=ln(b[e]);f&&d.push(f)}return d}}:null}function Rq(a,b){if(a.g)for(var c=0;c<a.g.stores.length;c++)if(a.g.stores[c].name==b)return a.g.stores[c];var c=a.h[b]||Pq[b]||{},d={name:b,keyPath:c.keyPath||"id",indexes:[{name:"name"},{name:"date_modified"}]},e=["ydn$emails","ydn$phones","ydn$names"];c.indexes&&(d.indexes=d.indexes.concat(c.indexes));for(var f=c.GeneratorIndex||{},c=0;c<e.length;c++){var g=e[c],k=f[g];!k||u(k)&&0==k.length||d.indexes.push(Qq(k,g))}return d}
function Sq(a){if(a.g)return a.g;for(var b={fullTextCatalogs:[],stores:[{name:"history",indexes:[{keyPath:"type"},{keyPath:"timestamp"}]},{name:"Meta"}]},c=0;c<oq.length;c++){var d=oq[c];b.stores.push(Rq(a,d));var e=a.h[d]||Pq[d]||{};if(e.FullTextIndex)for(var f in e.FullTextIndex){var g=e.FullTextIndex[f];if(0<g.length){for(var k={name:"ft-"+d+"-"+f,lang:"en",sources:[]},l=0;l<g.length;l++)k.sources.push({storeName:d,keyPath:g[l]});b.fullTextCatalogs.push(k)}}}a.g=b;Object.freeze(a.g);return a.g}
;function Tq(a,b,c){this.domain=a;this.module=b;this.g=c||null}Tq.prototype.L=function(){return this.domain};function Uq(a,b){if(b){a.g||(a.g={});for(var c in b)a.g[c]=b[c]}}Tq.prototype.F=function(){return this.g.id};function Vq(a){return a.g?+new Date(a.g.date_modified+" GMT"):NaN}function Wq(a){if(!a.g)return"";var b=a.g.full_name||a.g.name;return b?b:a.g.first_name||a.g.last_name?(b=(a.g.first_name||"").trim(),a=(a.g.last_name||"").trim(),b+" "+a):a.g.id}
Tq.prototype.value=function(a){return this.g?this.g[a]:null};Tq.prototype.toString=function(){return"Record:"+this.module+":"+(this.g?this.g.id:void 0)};function Xq(a,b,c){var d=0;if(!b)return d;b.gd$city&&a[c+"_address_city"]!=b.gd$city.$t&&(a[c+"_address_city"]=b.gd$city.$t,d++);b.gd$country&&a[c+"_address_country"]!=b.gd$country.$t&&(a[c+"_address_country"]=b.gd$country.$t,d++);b.gd$postcode&&a[c+"_address_postalcode"]!=b.gd$postcode.$t&&(a[c+"_address_postalcode"]=b.gd$postcode.$t,d++);b.gd$region&&a[c+"_address_state"]!=b.gd$region.$t&&(a[c+"_address_state"]=b.gd$region.$t,d++);b.gd$street&&a[c+"_address_street"]!=b.gd$street.$t&&(a[c+"_address_street"]=
b.gd$street.$t,d++);b.gd$housename&&a[c+"_address_street_2"]!=b.gd$neighborhood.$t&&(a[c+"_address_street_2"]=b.gd$neighborhood.$t,d++);b.gd$neighborhood&&a[c+"_address_street_3"]!=b.gd$city.$t&&(a[c+"_address_street_3"]=b.gd$city.$t,d++);return d}
function Yq(a,b,c){function d(d,g){!a[c+g]||b[d]&&b[d].$t==a[c+g]||(e++,b[d]={$t:a[c+g]})}var e=0;if(!a)return 0;b||(b={});d("gd$city","_address_city");d("gd$country","_address_country");d("gd$postcode","_address_postalcode");d("gd$region","_address_state");d("gd$street","_address_street");d("gd$neighborhood","_address_street_2");d("gd$city","_address_street_3");return e}
function Zq(a,b){var c=0;!a.title||b.name&&b.name==a.title.$t||(b.name=a.title.$t,c++);for(var d=0;a.gd$email&&d<a.gd$email.length;d++){var e=a.gd$email[d];"http://schemas.google.com/g/2005#work"==e.rel?b.email1!=e.address&&(c++,b.email1=e.address):"http://schemas.google.com/g/2005#home"==e.rel?b.email2!=e.address&&(c++,b.email2=e.address):"http://schemas.google.com/g/2005#other"==e.rel&&b.email!=e.address&&(c++,b.email=e.address)}a.gd$name?(a.gd$name.gd$namePrefix&&b.salutation!=a.gd$name.gd$namePrefix.$t&&
(c++,b.salutation=a.gd$name.gd$namePrefix.$t),a.gd$name.gd$givenName&&b.first_name!=a.gd$name.gd$givenName.$t&&(b.first_name=a.gd$name.gd$givenName.$t,c++),a.gd$name.gd$familyName&&b.last_name!=a.gd$name.gd$familyName.$t&&(b.last_name=a.gd$name.gd$familyName.$t,c++),a.gd$name.gd$fullName&&b.full_name!=a.gd$name.gd$fullName.$t&&(b.full_name=a.gd$name.gd$fullName.$t,c++)):b.full_name=a.title.$t;a.gd$organization&&a.gd$organization[0]&&(d=a.gd$organization[0],d.gd$orgTitle&&d.gd$orgTitle.$t!=b.title&&
(b.title=d.gd$orgTitle.$t,c++),d.gd$orgDepartment&&d.gd$orgDepartment.$t!=b.department&&(b.department=d.gd$orgDepartment.$t,c++),d.gd$orgJobDescription&&d.gd$orgJobDescription.$t!=b.description&&(b.description=d.gd$orgJobDescription.$t,c++));if(a.gd$im)for(d=0;d<a.gd$im.length;d++)"Twitter"==a.gd$im[d].label&&b.twitter!=a.gd$im[d].address?(b.twitter=a.gd$im[d].address,c++):"Facebook"==a.gd$im[d].label&&b.facebook!=a.gd$im[d].address?(b.facebook=a.gd$im[d].address,c++):"Google Plus"==a.gd$im[d].label&&
b.googleplus!=a.gd$im[d].address?(b.googleplus=a.gd$im[d].address,c++):"Linkedin"==a.gd$im[d].label&&b.linkedin!=a.gd$im[d].address&&(b.linkedin=a.gd$im[d].address,c++);a.gContact$birthday&&b.birthdate!=a.gContact$birthday.when&&(b.birthdate=a.gContact$birthday.when,c++);for(d=0;a.gd$phoneNumber&&d<a.gd$phoneNumber.length;d++)if(e=a.gd$phoneNumber[d],e.$t)if("http://schemas.google.com/g/2005#mobile"==e.rel)b.phone_mobile!=e.$t&&(b.phone_mobile=e.$t,c++);else if("http://schemas.google.com/g/2005#work"==
e.rel)b.phone_work!=e.$t&&(b.phone_work=e.$t,c++);else if("http://schemas.google.com/g/2005#home"==e.rel)b.phone_home!=e.$t&&(b.phone_home=e.$t,c++);else if("http://schemas.google.com/g/2005#fax"==e.rel||"http://schemas.google.com/g/2005#home_fax"==e.rel||"http://schemas.google.com/g/2005#work_fax"==e.rel)b.phone_fax!=e.$t&&(b.phone_fax=e.$t,c++);else if(b.phone_other=e.$t)b.phone_other=e.$t,c++;if(a.gd$structuredPostalAddress){for(var f=e=-1,d=0;d<a.gd$structuredPostalAddress.length;d++){var g=a.gd$structuredPostalAddress[d];
"http://schemas.google.com/g/2005#work"==g.rel||g.primary?e=d:f=d}-1==e&&(f=-1);c+=Xq(b,a.gd$structuredPostalAddress[e],"primary");c+=Xq(b,a.gd$structuredPostalAddress[f],"alt")}return c}
function $q(a,b){function c(a,c){if(g[a]){b.gd$phoneNumber||(b.gd$phoneNumber=[]);var d;a:{for(d=0;b.gd$phoneNumber&&d<b.gd$phoneNumber.length;d++)if(b.gd$phoneNumber[d].rel==c){d=b.gd$phoneNumber[d];break a}d=null}d?d.$t!=g[a]&&(d.$t=g[a],k++):(b.gd$phoneNumber.push({rel:c,$t:g[a]}),k++)}}function d(a){b.gd$im||(b.gd$im=[]);for(var c=0;c<b.gd$im.length;c++)if(b.gd$im[c].label==a)return b.gd$im[c];return null}function e(){b.gd$name||(b.gd$name={},k++)}function f(a,c){if(g[a]){b.gd$email?fa(b.gd$email)||
(b.gd$email=[b.gd$email]):b.gd$email=[];var d;a:{for(d=0;b.gd$email&&d<b.gd$email.length;d++)if(!(0<=l.indexOf(d))&&b.gd$email[d].address==g[a])break a;d=-1}if(0<=d){var e=b.gd$email[d];e.rel!=c&&(k++,e.rel=c);l.push(d)}else b.gd$email.push({rel:c,address:g[a]}),l.push(b.gd$email.length-1),k++}}var g=a.g,k=0;!g.name||b.title&&b.title.$t==g.name||(b.title={$t:g.name},k++);var l=[];f("email1","http://schemas.google.com/g/2005#work");f("email2","http://schemas.google.com/g/2005#home");f("email","http://schemas.google.com/g/2005#other");
g.salutation&&(e(),b.gd$name.gd$namePrefix&&b.gd$name.gd$namePrefix.$t==g.salutation||(b.gd$name.gd$namePrefix={$t:g.salutation},k++));g.first_name&&(e(),b.gd$name.gd$givenName&&b.gd$name.gd$givenName.$t==g.first_name||(b.gd$name.gd$givenName={$t:g.first_name},k++));g.last_name&&(e(),b.gd$name.gd$familyName&&b.gd$name.gd$familyName.$t==g.last_name||(b.gd$name.gd$familyName={$t:g.last_name},k++));g.full_name&&(e(),b.gd$name.gd$fullName&&b.gd$name.gd$fullName.$t==g.full_name||(b.gd$name.gd$fullName=
{$t:g.full_name},k++));if(g.twitter){var m=d("Twitter");m?m.address!=g.twitter&&(m.address=g.twitter,k++):(b.gd$im.push({label:"Twitter",address:g.twitter}),k++)}g.facebook&&((m=d("Facebook"),m)?m.address!=g.facebook&&(m.address=g.facebook,k++):(b.gd$im.push({label:"Facebook",address:g.facebook}),k++));g.googleplus&&((m=d("Google Plus"),m)?m.address!=g.googleplus&&(m.address=g.googleplus,k++):(b.gd$im.push({label:"Google Plus",address:g.googleplus}),k++));g.linkedin&&((m=d("Linkedin"),m)?m.address!=
g.linkedin&&(m.address=g.linkedin,k++):(b.gd$im.push({label:"Linkedin",address:g.linkedin}),k++));!g.birthdate||b.gContact$birthday&&b.gContact$birthday.when==g.birthdate||(b.gContact$birthday={when:g.birthdate},k++);c("phone_mobile","http://schemas.google.com/g/2005#mobile");c("phone_work","http://schemas.google.com/g/2005#work");c("phone_home","http://schemas.google.com/g/2005#home");c("phone_fax","http://schemas.google.com/g/2005#work_fax");c("phone_other","http://schemas.google.com/g/2005#other");
for(var n=-1,m=-1,p=0;b.gd$structuredPostalAddress&&p<b.gd$structuredPostalAddress.length;p++)-1==n&&"true"==b.gd$structuredPostalAddress[p].primary||"http://schemas.google.com/g/2005#work"==b.gd$structuredPostalAddress[p].rel?n=p:-1==m&&(m=p);-1==n&&0<=m&&(n=m,b.gd$structuredPostalAddress[n].primary="true",m=-1);0<=n?k+=Yq(g,b.gd$structuredPostalAddress[n],"primary"):(n={primary:"true",rel:"http://schemas.google.com/g/2005#work"},p=Yq(g,n,"primary"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=
[]),b.gd$structuredPostalAddress.push(n),k+=p));0<=m?k+=Yq(g,b.gd$structuredPostalAddress[m],"alt"):(n={},p=Yq(g,n,"alt"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=[]),b.gd$structuredPostalAddress.push(n),k+=p));return k};function ar(a){if(u(a))return a.map(function(a){return ar(a)});if(y(a)){var b={},c;for(c in a.name_value_list)b[c]=a.name_value_list[c].value;return b}throw Error("Invalid name_value_entries");};function br(a,b,c,d,e){c=ta(c,"http")?new ud(c):vd(wd(new ud,c),"https");Ad(c,"");zd(c,null);this.p=c.L();this.N=b;this.l=c.toString().replace(/\/$/,"");this.i=d;this.o=e;this.g=null;this.j=a;this.T=new Oq(this.p);this.db=new Vn(this.p,Sq(this.T),{isSerial:!0,policy:"single",mechanisms:["indexeddb"]});this.h=null;this.t=this.H=NaN;this.G=!1;this.history=new Ho(this.db)}B(br,eo);h=br.prototype;h.L=function(){return this.p};
h.request=function(a,b,c,d,e,f){function g(){m.execute(function(g,k){this.H=A();var l=g;if(v(l))try{g=JSON.parse(l)}catch(m){}f||!g||11!=g.number&&10!=g.number?d.call(e,g,k):this.Vc().A(function(){this.request(a,b,c,d,e,!0)},function(){d.call(e,null,new Yi(0,null,{},"Login fail"))},this)},this)}for(var k="{",l=0;l<b.length;l++)k+=(0==l?"":",")+'"'+b[l]+'":'+JSON.stringify(c[l]);k+="}";l=new Bd;l.add("method",a);l.add("input_type","json");l.add("response_type","json");l.add("rest_data",k);var m=this.j.request(new bi(this.l+
"/service/v4/rest.php","POST",{},{"Content-Type":"application/x-www-form-urlencoded"},l.toString())),k=A()-this.H;0<k&&100>k?(this.H=100+this.H,O(this.logger,"request will call after "+k+" ms."),mf(g,k,this)):g.call(this)};
function cr(a,b,c){var d=["session","module_name"];a=[a.g?a.g.id:null,c.module_name];var e=[!1,!1];if("get_entry_list"==b)b=c.query||"",d.push("query"),a.push(b),e.push(""==b),d.push("order_by"),b=c.order_by||"",a.push(b),e.push(""==b),b=c.offset||0,d.push("offset"),a.push(b),e.push(0==b),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length),b=c.max_results||25,d.push("max_results"),
a.push(b),e.push(null!=c.max_results),b=c.deleted||0,d.push("deleted"),a.push(b),e.push(0==b),c=!!c.favorites,d.push("favorites"),a.push(c),e.push(!1==c);else if("get_available_modules"==b)c=c.filter||"",d.push("filter"),a.push(c),e.push(0==c.length);else if("get_module_fields"==b)c=c.fields||[],d.push("fields"),a.push(c),e.push(0==c.length);else if("get_entries"==b)b=c.ids||[],d.push("ids"),a.push(b),e.push(!1),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||
[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length);else for(var f in c)"module_name"!=f&&(d.push(f),a.push(c[f]),e.push(!1));for(c=e.length-1;0<=c;c--)if(e[c])d.pop(),a.pop();else break;return{keys:d,values:a}}
function dr(a,b){var c=b.entry_list;if(u(c)&&0<c.length){var d=c.map(function(a){return'"'+a.id+'"'});return er(a,"get_entry_list",{module_name:"EmailText",max_results:b.length,query:"email_id IN ("+d.join(",")+")"}).B(function(a){a=a.entry_list;c.length!=a.length&&L(this.logger,"number of entries retrived for EmailText exptected to have "+c.length+" but found only "+a.length);for(var d=0;d<a.length;d++){var g=a[d];if(a[d]){var k=lc(g,"name_value_list","email_id","value"),l=Xa(c,function(a){return a.id==
k});if(0<=l)for(var m in g.name_value_list)c[l].name_value_list[m]=g.name_value_list[m];else M(this.logger,"key "+k+" not found in EmailText")}}return b},a)}}
function fr(a,b){var c=b.module_name;a.t=A();var d=er(a,"get_entry_list",b);"Emails"==c&&(d=d.B(function(a){return dr(this,a)},a));return d.B(function(a){var d=a.result_count,g=a.offset||0,k=a.entry_list,l=parseInt(a.next_offset,10);if(s(d)&&u(k)){if(0<k.length){a=ar(k);var m=this.N,n=this.L(),p=a;if(m.h)for(var p=u(p)?p:[p],r=0;r<p.length;r++)p[r]&&gr(m,new Tq(n,c,p[r]));this.db.put(c,a)}return 0<k.length&&d>=k.length&&l>g?(b.offset=l,fr(this,b)):l}throw Error("Invalid REST respond on entry list query on "+
c+": "+JSON.stringify(a));},a)}function hr(a,b){var c={module_name:b},d="module/"+b;return a.db.get("Meta",d).B(function(a){return a?a:er(this,"get_module_fields",c).B(function(a){a&&a.module_name&&a.module_fields?this.db.put("Meta",a,d):L(this.logger,"Invalid module for "+b+" "+yh(a));return a},this)},a)}
function ir(a,b){var c=new Wj(b,"date_modified",null,!0);return a.db.keys(c,1).B(function(a){var c={};a[0]&&(c.query=b.toLowerCase()+".date_modified>'"+a[0]+"'");c.module_name=b;c.order_by="date_modified";a=fr(this,c);a.A(function(a){this.logger.info(this+" module "+b+" synced, "+a+" records updated.")},function(a){var c=".";a&&(c=" with "+a.name+": "+a.message);L(this.logger,this+" module "+b+" failed"+c)},this);return a},a)}
function er(a,b,c,d){var e=d||0,f=new C;if(!a.g||!a.g.id)return 2>e?(O(a.logger,"Request require login, tried "+e),a.Vc().B(function(){e++;rb(er(a,b,c,e),f)})):(N(a.logger,"Cannot do request, not login. Give up after "+e+" retry"),f.D()),f;d=cr(a,b,c);a.request(b,d.keys,d.values,function(d,k){k.Aa()&&y(d)?11==d.number&&/invalid/i.test(d.name)?(this.g=null,rb(er(a,b,c,e),f)):f.C(d):f.D(k.O()+" "+k.Ha())},a);return f}
h.list=function(a){if(!u(a)||0==a.length)return D("invalid query");for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.limit||5,f=d.offset||0,g=!!d.reverse;if(!y(d))return D("invalid query at "+c+"");var k=d.store;if(-1==oq.indexOf(k))return D("invalid store name at "+c+": "+k);var l=d.index;if(!v(l)||0==l.length)return D("index name missing in "+k);var m=null;null!=d.key?(m=d.key,"ydn$phones"==l?m=ln(m):"ydn$emails"==l&&(m=m.toLowerCase()),m=d.prefix?nj(m):S.only(m)):null!=d.keyRange&&(m=oj(d.keyRange));
"id"==l?b.push(this.db.values(k,m,e,f,g)):Zl(this.db,k,l)?b.push(this.db.values(k,l,m,e,f,g)):b.push(tb([]))}return(new om(b)).A(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].result=b[c][1]:(L(this.logger,"query "+c+" failed."),a[c].result=[]);return a},function(b){L(this.logger,"list failed "+b);return a},this)};
h.search=function(a){if(!u(a)||0==a.length)return D("invalid query");for(var b=[],c=Sq(this.T),d=0;d<a.length;d++){var e=a[d];if(!y(e))return D("invalid query at "+d+"");var f=e.q;if(!v(f)||0==f.length)return D("query term missing "+d+"");var g="ft-"+e.store+"-"+(e.index||"name");0<=Xa(c.fullTextCatalogs,function(a){return a.name==g})?(f=this.db.search(g,e.q),e.fetchFull&&(f=f.B(function(a){if(0<a.length){for(var b=[],c=0;c<a.length;c++)b.push(new sk(a[c].storeName,a[c].primaryKey));return this.db.values(b).B(function(b){for(var c=
0;c<b.length;c++)a.record=b[c];return a})}},this)),b.push(f)):b.push(tb([]))}return(new om(b)).A(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].fullTextResult=b[c][1]:(L(this.logger,"query "+c+" failed."),a[c].fullTextResult=[]);return a},function(b){L(this.logger,"list failed "+b);return a},this)};
function jr(a){if(a.h&&a.h.isLogin)return tb(a.h);var b=new C;a.db.get("Meta","info/server").fa(function(a){a&&a.version?(this.h=a,b.C(a)):this.request("get_server_info",[],[],function(a,c){if(0==c.O())this.h=null,b.D("service "+(this.l+"/service/v4/rest.php")+" not responding");else if(c.Aa()){var f=$i(c);if((!a||!a.version)&&v(f))try{a=JSON.parse(f)}catch(g){a=$i(c)}a&&a.version?(f=a,this.h=oc(f),b.C({info:f,about:kr(this)}),this.db.put("Meta",f,"info/server")):(this.h=null,b.D("invalid respond "+
$i(c)))}else this.h=null,b.D("request fail "+c.O()+" "+c.Ha())},this)},a);return b}function lr(a){var b=new C;a.request("get_available_modules",["filter"],["all"],function(a){b.C(a)},a);return b}function kr(a){var b=a.j,b=b instanceof ho&&/proxy/.test(b.h);return{baseUrl:a.l,domain:a.L(),userName:a.i,isLogin:a.isLogin(),hostPermission:!b}}function mr(a){return(new om([jr(a),lr(a)])).B(function(a){return{serverInfo:a[0][1],availableModules:a[1][1],about:kr(this)}},a)}
function nr(a,b,c){var d=[],e;for(e in c)d.push({name:e,value:c[e]});return er(a,"set_entry",{module_name:b,name_value_list:d}).B(function(a){if(a&&a.id){var c={id:a.id};a=a.entry_list||{};for(var d in a)c[d]=a[d].value;this.db.put(b,c);return c}throw Error("creating "+b+" entry fail");},a)}
function or(a,b,c){if(c){var d=pr(b,qr,a.L(),void 0,c.id),e=d.module,f=new Tq(a.L(),e,c);N(a.logger,"synchronizing "+b+" to "+f);if(Vq(f)==d.g){var g=new Fo("update-gdata-record");Go(g,c);b=b.data;y(b)&&Vl(b);Zq(b,c)&&nr(a,e,c).A(function(a){y(a)?g.g=Vl(a):g.g=a;this.history.add(g)},function(a){L(this.logger,"Fail to put record "+c.id+" to server "+a.message)},a)}}}
function rr(a,b){for(var c=sr(b),d=0;d<c.length;d++)0<=oq.indexOf(c[d].module)&&a.db.get(c[d].module,c[d].Yc).B(function(a){or(this,b,a)},a)}function tr(a,b,c){var d={};Zq(c,d);return nr(a,b,d)}h.isLogin=function(){return!(!this.g||!this.g.id)};
h.update=function(){if(this.j&&this.j instanceof ho)this.logger.info(this+" updating skipped since no direct connection is not available.");else{var a;if(this.G)M(this.logger,"Modules are already updating now at "+a+" / "+oq.length);else{this.G=!0;this.t=A();a=0;var b=this,c=function(){var d=oq[a];d?(N(b.logger,"Syncing module "+d),a++,ir(b,d).fa(function(){b.t=A();q.setTimeout(function(){c()},500)})):(M(b.logger,"Updating module done"),b.G=!1)};c();q.setTimeout(function(){2E3<b.t-A()&&c()},2E3)}}};
h.Vc=function(a,b){a&&(this.i=a);b&&(this.o=b);if(!this.i)return D("username required.");if(!this.o)return D("password required.");var c=new C;this.request("login",["user_auth","application_name","name_value_list"],[{user_name:this.i,password:this.o},"Yathit CRM",{language:"",notifyonsave:"false"}],function(a,b){if(a&&a.id)this.g=oc(a),c.C(a);else if(a&&a.description)c.D(a.description+" ("+a.name+")");else{var f=b.O()+" "+b.Ha()+" "+$i(b);c.D("Login fail: "+f.substr(0,200))}},this,!0);return c};
function ur(a){var b=new C;a.request("logout",[],[],function(a,d){this.g=null;d.Aa()?(L(this.logger,"Logout request fail with "+d.O()+" "+d.Ha()),b.C(!0)):b.D(d.O()+" "+d.Ha())},a,!0);return b}
function vr(a){function b(){f.request(new bi(e.toString())).execute(function(a,b){/sugarcrm/i.test($i(b))?d.D("Look like SugarCRM web site, but REST V4 API is not available."):200==b.O()?d.D("Not a SugarCRM web site"):d.D("Invalid respond, "+b.O())})}function c(a,b){var c=new Bd;c.add("method","get_server_info");c.add("input_type","json");c.add("response_type","json");c.add("rest_data","{}");f.request(new bi(a,"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},c.toString())).execute(b)}
var d=new C;a=a.trim();ta(a,"http")||(a="https://"+a);var e=new ud(a);Ad(e,"");zd(e,null);var f=$h("proxy"),g=e.ga();a=e.zc;/rest.php$/.test(a)||(/index.php$/.test(a)?yd(g,a.replace("/index.php","")):yd(g,""));var k=g.toString();(function(a,b){c(a+"/service/v4/rest.php",function(a,c){if(200==c.O()){if(!a||!a.version){var d=$i(c);if(v(d))try{a=JSON.parse(d)}catch(e){b(null,c);return}else a=d}a&&a.version&&b(a,c)}else b(0,c)})})(k,function(a,f){a?(a.isLogin=!1,a.userName=null,a.domain=g.L(),a.baseUrl=
k,d.C(a)):0==a?"https"==e.ic?(vd(g,"http"),setTimeout(function(){c(g.toString(),function(a,c){c.Aa()?d.C(a):b()})},100)):d.D(f.O()+" "+f.Ha()+" "+$i(f)):b()});return d}h.toString=function(){return"SugarClient:"+this.p};
function wr(a,b,c){if("about"==b)return tb(kr(a));if("details"==b)return mr(a);if("get"==b)return b=c.module,c=c.id,Tk(a.db.h,b)?D("store: "+b+" not found"):v(c)&&0!=c.length?a.db.get(b,c):D("record id required.");if("fetch-module"==b)return ir(a,c);if("info-module"==b){if(y(c)&&v(c.module))c=c.module;else if(!v(c))return D("module name required");return hr(a,c)}if("list"==b)return u(c)?a.list(c):D("query must be an array");if("list-module"==b)return lr(a);if("put-record"==b||"new-record"==b){b=c.module;
if(!b||-1==nq.indexOf(b))return D("invalid module name: "+b);c=c.record;return y(c)?nr(a,b,c):D("record object required")}if("search"==b)return u(c)?a.search(c):D("query must be an array");if("server-info"==b)return jr(a);if("rest"==b){if(!y(c))return D("REST parameter must be an object");b=c.method;c=c.params;return v(b)&&0!=b.length?y(c)?er(a,b,c):D("REST parameter must be an object"):D("method must be valid string")}return D("invalid req "+b)};function xr(a){Error.captureStackTrace?Error.captureStackTrace(this,xr):this.stack=Error().stack||"";a&&(this.message=String(a))}B(xr,Error);xr.prototype.name="ydn.gdata.error.InvalidAtomFormatError";function yr(a){Error.captureStackTrace?Error.captureStackTrace(this,yr):this.stack=Error().stack||"";a&&(this.message=String(a))}B(yr,Error);yr.prototype.name="ydn.gdata.error.IncompatibleError";var zr="atom app gd xhtml batch openSearch".split(" ");function Ar(a){if(!s(this.type))throw new Jh("Abstract class cannot be instantiated.");if(v(a))a={id:{$t:a}};else if(!s(a.id)||!v(a.id.$t))throw new Eh("Invalid GDataFeed");this.id=a.id.$t;this.data=a;s(this.data.entry)?u(this.data.entry)||(this.data.entry=[this.data.entry]):this.data.entry=[];this.j={};this.o={};a=u(this.data.entry)?this.data.entry.length:0;for(var b=0;b<a;b++){var c=this.data.entry[b],c=c.id?c.id.$t:c.Ng?c.Ng.$t:"";if(0==c.length)throw new xr("entry "+b);if(0==c.match(/\w+$/)[0].length)throw new xr("entry "+
b+" of "+c);var d=c.match(/\w+$/)[0];this.j[c]=this.data.entry[b];this.o[d]=this.data.entry[b]}this.i=!0;this.G=[];this.t=new lh(function(){this.dispatchEvent(Br)},300,this);this.ug=null;this.h=NaN;this.p=void 0}B(Ar,th);var Br="i";h=Ar.prototype;h.Bf=function(){return this.kind};h.logger=P("ydn.gdata.Feed");
h.Cb=function(a){var b=new C;O(this.logger,this+" receiving a task, ready: "+this.i);var c=this;this.i?(this.i=!1,b.fa(function(){O(c.logger,c+" finish the task.");c.i=!0;var a=c.G.shift();a&&a.call(this)}),a.call(this,b)):this.G.push(pa(oa(a,this),b));return b};h.ug=null;function Cr(a){var b;if(!(b=a.ug))if(a=a.je(),s(a)){b=a;for(var c=0;c<Ri.length;c++){var d=(0,Ri[c])(a);if(d){b=d;break}}O(Pi,"Resolving "+a+" to "+b);b=Qi[b]||null}else b=Qi["default"];return b}h.bf=function(){this.dispatchEvent("e")};
h.Vf=function(){return zr};h.Pg=function(a){a.g()||L(this.logger,"Batch submission failed. "+a.responseText)};
h.nc=function(a,b){var c=this.Vf(),d=void 0;s(c)||(c=zr);for(var e="",f=0;f<c.length;f++)var g=c[f],e=0==f?e+(' xmlns="'+pp[g]+'" '):e+(" xmlns:"+g+'="'+pp[g]+'" ');d=s(d)?"<id>"+d+"</id>":"";d=Ch("<feed"+e+">"+d+"</feed>");for(f=c=0;e=this.pc(f);f++)if(Gp(e))Ep(e,"");else if(Hp(e.data)){var g="delete"==Fp(e.data),k=!(!e.data.id||!e.data.id.$t);Ep(e,null);var l=Bp(new wp(null,"entry",e.data),d.documentElement),m=l.getElementsByTagNameNS(rp("batch"),"operation");m[0]?m=m[0]:m=l.appendChild(d.createElementNS(rp("batch"),
"operation"));l=d.createAttribute("type");l.nodeValue=g?"delete":k?"update":"insert";m.setAttributeNode(l);Ep(e,"committed");c++;a&&a.message({id:this.Af(),code:"operation: "+l.nodeValue+" "+e})}if(0==c)return M(this.logger,this+" Nothing to commit."),0;M(this.logger,this+" committing "+c+" entries.");d=Dh(d);b?(this.logger.info("Commit ignored for dry run."),window.console.log(d)):(e=oa(this.Pg,this),this.N&&this.N.stop(),f=Cr(this),g=this.Ae(),f.send(g,e,{method:"POST",body:d,headers:{"Content-Type":"application/atom+xml"},
params:{}}));return c};h.ie=function(a){return new Cp(a)};h.pc=function(a){return 0<=a&&a<this.data.entry.length?this.ie(this.data.entry[a]):null};h.zf=function(a){return(a=this.j[a])?this.ie(a):null};
h.save=function(a){if(this.store){var b=this;this.l||(this.l=new lh(function(){this.Cb(function(a){var d=b.toJSON(),e=b.data.entry,f,g,k;b.store.Z(function(a){a.put("ydn.gdata.feed",d).Gc(function(a){throw a;}).B(function(){f=!0});a.put("ydn.gdata.entry",e).Gc(function(a){throw a;}).B(function(a){k=a.length;g=!0})},["ydn.gdata.feed","ydn.gdata.entry"],"readwrite").A(function(){f&&g?O(this.logger,b+": saved "+k+" entries."):O(this.logger,b+": saved failed"+e.length+" entries.");a.C(!0)},function(a){throw a;
},this)})},1E3,this));a?nh(this.l):mh(this.l)}};
function Dr(a,b,c){c=c||new C;var d=Cr(a);if(!d)return L(a.logger,a+": No transport available."),c.D(Error("No transport available.")),c;d.send(b,function(b){if(200==b.status){a.h=A();b=b.S?nf(b.S.responseText):void 0;if(!b.feed)throw new xr("feed missing.");var d=b.feed;if(!s(d))throw b=zh(d),new xr(b.substr(0,50));if(d.id.$t!=a.F())throw new yr(d.id.$t+" is not "+a.F());var g=b=0,k=u(d.entry)?d.entry:d.entry?[d.entry]:[];b=k.length;0==b&&O(a.logger,a+": fetch return no result.");for(var l=0;l<b;l++){for(var m=
a,n=k[l],p=n instanceof Cp?n:m.ie(n),r=p,t=0;t<r.mc.length;t++)null!=r.data[r.mc[t]]&&!u(r.data[r.mc[t]])&&(r.data[r.mc[t]]=[r.data[r.mc[t]]]);Ep(r,null);r=r.data;r.batch$status&&(r.batch$status=void 0);r.batch$operation&&(r.batch$operation=void 0);var r=p.F(),x=m.zf(r);(t=!!x)?x.update(p):(x=Dp(p),m.data.entry.push(n),m.j[r]=p.data,m.o[x]=p.data);!t&&g++}M(a.logger,a+" "+b+" ("+g+" new) entries received");a.bf();(d=Io(d,"next"))?(a.save(),mh(a.t),a.p=d.$t,Dr(a,d.href,c)):(0<b&&(a.save(),mh(a.t)),
c.C(!0))}else L(a.logger,"Fetching "+b.uri+" failed: "+b.status),c.D(!1)});return c}h.toString=function(){return this.type+":"+this.id};function Er(a,b){a.Bg&&b.g.set("v",a.Bg);b.g.set("alt","json");b.g.set("showdeleted",!0)}
function Fr(a,b){var c="lu",d=!1;if("lf"==c){if(a.h){var d=!0,e=new Date(a.h),e=e.toISOString();b.g.set("updated-min",e)}}else if("lu"==c){for(var e=0,f=-1,g,k=0;g=a.pc(k);k++)g=g.data.updated.$t,e<g&&(e=g,f=k);if(e=a.pc(f))e=new Date(e.data.updated.$t),e=new Date(1+ +e),e=e.toISOString(),b.g.set("updated-min",e)}else"lo"==c?(b.g.set("orderby","lastmodified"),a.h&&b.g.set("max-results","1")):c="no";O(a.logger,a+" updating "+(d?"continue":"begin")+" by "+c)}h.Zh=mp.prototype.ce;h.F=mp.prototype.F;
h.ai=mp.prototype.Ph;h.$h=mp.prototype.Oh;h.je=function(){return this.ai()||""};h.Af=function(){return this.id};h.Ae=function(){return this.$h()};function Gr(a){return a.Cb(function(a){var c=new ud(this.je());Er(this,c);Fr(this,c);this.U(rh,!1);Dr(this,c.toString()).fa(function(c){uh(this);c?a.C(!0):a.D(void 0)},this)})}h.update=function(a){return a||!0!==("undefined"==typeof this.g?null:(this.g&rh)==rh)?Gr(this):(O(this.logger,this+" already loaded."),tb(!1))};
h.count=function(a){if(a){a=0;for(var b,c=0;b=this.pc(c);c++)Gp(b)||"deleted"==Fp(b.data)||a++;return a}return this.data.entry.length};h.toJSON=function(){return{id:this.id,key:this.Af(),last_fetch_next_uri:this.p,last_fetch:this.h}};function Hr(a){var b,c=a.match(/^\D*0*(\d{1,2}\D)?\D*0*(.+)/);c?(b=c[1].replace(/\D/g,""),a=c[2].replace(/\D/g,"")):a=a.replace(/\D/g,"");return{lb:b,fb:a}}function Ir(a,b){var c=Hr(a),d=Hr(b);if(s(c.lb)&&s(d.lb)&&0!=c.lb.length&&0!=d.lb.length&&c.lb!==d.lb)return 0;if(s(c.eb)&&0!=c.eb.length){if(s(d.eb)&&0!=d.eb.length){if(c.eb.length>=d.eb.length){for(var e=0;e<d.eb.length;e++)if(c.eb[e]!=d.eb[e])return 0;return 1}for(e=0;e<c.eb.length;e++)if(c.eb[e]!=d.eb[e])return 0}return-1}return 1};function Jr(a){Cp.call(this,a);a=(a=this.id.match(/https?:\/\/www.google.com\/m8\/feeds\/(group|contact|batch)s?\/([^\/]+)\/?(\w+)\/?(\w*)?/))?{ji:"m8",kind:a[1],user_id:a[2]?a[2].replace("%40","@"):"",projection:a[3],id:a[4]}:null;window.console.assert(!!a,"Invalid m8 entry: "+this.id);this.user_id=a.user_id;window.console.assert(a.kind==this.kind,"Invalid kind: "+a.kind+" vs "+this.kind)}B(Jr,Cp);Jr.prototype.logger=P("ydn.gdata.m8.Entry");Jr.prototype.g="3.0";Jr.prototype.type="m8";
Jr.prototype.toString=function(){var a=this.id?Dp(this):void 0;return"m8.Entry."+this.kind+":"+a};function Kr(a){if(!s(this.kind))throw new Jh("Abstract class cannot be instantiated.");Ar.call(this,a);this.user_id=this.F()}B(Kr,Ar);h=Kr.prototype;h.Bf=function(){return this.kind};h.Bg="3.0";h.type="m8";h.toString=function(){return"Feed:"+this.kind+":"+this.user_id};h.je=function(){return"https://www.google.com/m8/feeds/"+this.Bf()+"s/"+this.user_id.replace("@","%40")+"/full?v=3.0"};
h.Ae=function(){var a=Kr.m.Ae.call(this);return a?a:"https://www.google.com/m8/feeds/"+this.Bf()+"s/"+this.user_id.replace("@","%40")+"/full/batch?v=3.0"};var Lr=zr.concat(["gContact"]);Kr.prototype.Vf=function(){return Lr};function Mr(a,b,c,d,e,f){this.scheme=a;this.domain=b;this.module=c;this.Yc=d;this.h=w(e)?e:NaN;this.g=w(f)?f:NaN}var qr="sugarcrm";function Nr(a){if(!y(a)||!v(a.value))return null;var b=Or(a.value);if(!b)return null;var c=NaN,d=NaN;if(v(a.label)){a=a.label;var e=a.indexOf("#"),f=a.indexOf("-");0<e&&0<f&&f>e&&(c=parseInt(a.substring(e,f),10),d=parseInt(a.substring(f),10))}return new Mr(b[1],b[2],b[3],b[4],c,d)}function Or(a){return a?a.match(/(\w+):\/\/([^\/]+)\/([^\/]+)\/(.*)/):null}
Mr.prototype.V=function(){return this.scheme+"://"+this.domain+"/"+this.module+"/"+this.Yc};function Pr(a){Jr.call(this,a)}B(Pr,Jr);h=Pr.prototype;h.kind="contact";h.logger=P("ydn.gdata.m8.ContactEntry");h.yf=function(){return"contact"};h.getName=function(a){var b=a?"":this.uf();if(a||0==b.length)a=this.data.gd$name,y(a)&&(b=a.gd$fullName.$t||"",0==b.length&&(b=(a.gd$givenName.$t||"")+" "+(a.gd$familyName.$t||"")));return ya(b)};function Qr(a){var b=a.data.gd$email;a=[];for(var b=u(b)?b:b?[b]:[],c=0;c<b.length;c++)a.push(b[c].address);return a}
function Rr(a){a=a.data.gd$phoneNumber;a=u(a)?a:y(a)?[a]:[];for(var b=[],c=0;c<a.length;c++)a[c].$t&&!wa(a[c].$t)&&b.push(a[c].$t);return b}h.Ce=function(){var a=Pr.m.Ce.call(this);if(a.ydn$emails||a.ydn$xp||a.ydn$externalIds)a==this.data&&(a=Vl(this.data)),delete a.ydn$emails,delete a.ydn$xp,delete a.ydn$externalIds;return a};h.mc="link category gd$email gd$im gd$organization gd$phoneNumber gd$structuredPostalAddress gd$formattedAddress".split(" ");
function Sr(a,b){function c(a){var b=Wa(e,function(b){return b.address===a.address});b?b.rel=s(a.rel)?a.rel:b.rel:d(a)}function d(a){a=Vl(a);f&&delete a.primary;s(void 0)&&(a.rel=void 0);e.push(a)}for(var e=[Vl(a.data.gd$email[0])],f=!!a.data.gd$email[0].primary,g=1;g<a.data.gd$email.length;g++)c(a.data.gd$email[g]);for(g=0;g<b.length;g++)c(b[g]);g=Dl(e,a.data.gd$email);g||(a.data.gd$email=e);return!g}
function Tr(a,b){function c(a){var b=Ta(e,function(b){var c=b.$t;b=a.$t;c&&b&&0!=c.length&&0!=b.length?(c=c.trim(),b=b.trim(),c=Hr(c),b=Hr(b),b=c.lb&&c.fb&&c.lb==b.lb&&c.fb==b.fb?6<=c.fb.length?1:4<=c.fb.length?0.8:0.4:c.fb&&4<=c.fb.length&&c.fb==b.fb?8<=c.fb.length?0.8:4<=c.fb.length?0.6:0.4:0):b=0;return b}),c=Uh(b);if(0.4<c.value){var b=e[c.index],f=s(a.rel)?a.rel:b.rel;1==c.value?(b.rel=f,b.$t=a.$t):s(a.rel)&&s(b.rel)&&b.rel!==a.rel?d(a,f):(b.rel=f,c=Ir(b,a),-1==c?b.$t=a.$t:0==c&&(b.$t=a.$t))}else d(a)}
function d(a,b){a=Vl(a);f&&delete a.primary;s(b)&&(a.rel=b);e.push(a)}for(var e=[Vl(a.data.gd$phoneNumber[0])],f=!!a.data.gd$phoneNumber[0].primary,g=1;g<a.data.gd$phoneNumber.length;g++)c(a.data.gd$phoneNumber[g]);for(g=0;g<b.length;g++)c(b[g]);g=Dl(e,a.data.gd$phoneNumber);g||(a.data.gd$phoneNumber=e);return!g}
h.jf=function(a,b){if("gd$phoneNumber"==a){if(null!=this.data.gd$phoneNumber)return Tr(this,b);this.data.gd$phoneNumber=Vl(b);return!0}if("gd$email"==a){if(null!=this.data.gd$email)return Sr(this,b);this.data.gd$email=Vl(b);return!0}return Pr.m.jf.call(this,a,b)};
function pr(a,b,c,d,e){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var f=0;f<a.length;f++){var g=Nr(a[f]);if(g&&!(b&&b!=g.scheme||c&&c!=g.domain||e&&e!=g.Yc||d&&d!=g.module))return g}return null}function sr(a){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var b=[],c=0;c<a.length;c++){var d=Nr(a[c]);d&&b.push(d)}return b};function Ur(a){Kr.call(this,a)}B(Ur,Kr);h=Ur.prototype;h.logger=P("ydn.gdata.m8.ContactFeed");h.kind="contact";h.bf=function(){Ur.m.bf.call(this)};h.zf=function(a){return Ur.m.zf.call(this,a)};h.ie=function(a){return new Pr(a)};h.pc=function(a){return Ur.m.pc.call(this,a)};h.je=function(){return"https://www.google.com/m8/feeds/contacts/"+this.F()+"/full"};h.Af=function(){return"http://www.google.com/m8/feeds/contacts/"+this.F().replace("@","%40")};function Vr(a){function b(a){ta(a,"atom:")&&(a=a.substring(5,a.length));return a.replace("#text","$t").replace(/:/g,"$")}v(a)&&(a=Ch(a));var c={};if(1==a.nodeType){if(0<a.attributes.length)for(var d=0;d<a.attributes.length;d++){var e=a.attributes.item(d);c[b(e.nodeName)]=e.nodeValue}}else 3==a.nodeType&&(c=a.nodeValue);if(a.hasChildNodes())for(d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d),f=b(e.nodeName);if("undefined"==typeof c[f])"content"==f?(c[f]={$t:Dh(e)},e.namespaceURI&&(c[f].xmlns=
e.namespaceURI)):c[f]=Vr(e);else{if("undefined"==typeof c[f].length){var g=c[f];c[f]=[];c[f].push(g)}c[f].push(Vr(e))}}return c};function Wr(a,b){this.id=b.replace("@","%40");this.client=this.g=null;this.i=new oh(function(){M(this.logger,"updating gdata "+this);Xr(this).A(function(a){this.logger.info(this+" synced, "+a+" new entries updated.")},function(){L(this.logger,this+" update failed.")},this)},6E4,this);this.j=a;this.h=null}h=Wr.prototype;h.logger=P("ydn.ds.gdata.GData");h.update=function(){ph(this.i)};h.K=function(){return this.j};function Yr(a){var b=new C;a.execute(function(a,d){a?b.C(a):b.D(d)});return b}
function Zr(a,b){var c=(a.client?a.client:$h("gse")).request(b);return Yr(c).A(function(a){a=a.feed;if(!a.entry)return 0;for(var b=(new Ur(a)).Zh("next"),c=a.entry.length,g=!!this.h,k=0;g&&k<c;k++){var l=a.entry[k];l.gContact$externalId&&this.h(l)}return this.K().put(this.I(),a.entry).B(function(){return b?Zr(this,new bi(b.href)).B(function(a){return c+a},this):c},this)},function(a){L(this.logger,"fetching fail "+(a?a.O()+" "+a.Ha():""))},a)}h.getParams=function(){return{alt:"json"}};
h.get=function(a){return v(a)&&0!=a.length?this.K().get(this.I(),a):D("invalid key")};h.put=function(a){return this.K().put(this.I(),a)};h.Ag=function(a){return new Cp(a)};function $r(a,b){return a.Ag(b).nc().B(function(a){a=Vr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+yh(a));this.K().put(this.I(),b);return b},a)}
function Xr(a){if(!a.K().getName())return D(Error("database not ready"));if(!a.g){var b=new Wj(a.I(),"updated.$t",null,!0);a.g=a.K().keys(b,1).B(function(a){var b=this.getParams();b.orderby="lastmodified";a[0]?(b.sortorder="descending",a=(new Date(1+ +new Date(a[0]))).toISOString(),b["updated-min"]=a):b.sortorder="ascending";return Zr(this,new bi(as(this)+"/full","GET",b)).fa(function(){this.g=null},this)},a)}return a.g}h.toString=function(){return"GData:contact:"+this.id.replace("%40","@")};function bs(a,b){Wr.call(this,a,b)}B(bs,Wr);bs.prototype.I=function(){return"contact"};bs.prototype.getParams=function(){var a=bs.m.getParams.call(this);a.v="3.0";return a};function as(a){return"https://www.google.com/m8/feeds/contacts/"+a.id}bs.prototype.Ag=function(a){var b=!!a.id;b||(a.id={$t:as(this)+"/base/0"});var c=new Pr(a);b||delete a.id;return c};function cs(a,b){return v(b)?0==b.length?tb([]):a.K().values(a.I(),"ydn$emails",S.only(b),100,0,!1,!0):D("invalid key for email "+b)}
function ds(a,b){var c=b.V();if(!v(c)||0==c.length)return D("invalid key for external id "+c);c=S.only(c);return a.K().values(a.I(),"ydn$externalIds",c).B(function(){},a)}
function es(a,b,c){return a.K().get(a.I(),b).B(function(a){if(a){if(!c||!c.label||!c.value)return D("invalid external_id_data");var e=c.label,f=c.value;a.gContact$externalId=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var g=new Pr(a),k=!1,l=0;l<a.gContact$externalId.length;l++)if(a.gContact$externalId[l].value==f){a.gContact$externalId[l].label=e;k=!0;break}k||a.gContact$externalId.push({label:e,value:f});Ep(g,"modified");return g.nc().B(function(a){a=
Vr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+yh(a));this.K().put(this.I(),b);return b},this)}throw Error("gdata entry "+b+" not found");},a)};function fs(a){this.g=a;this.i=0;this.j=[];this.l=[0,0,0,0];this.h=new Kinetic.Layer;a=this.g/2;var b=a/3;this.o=[a,a,b,this.g-b];this.p=[a,b,this.g-b,this.g-b]}fs.prototype.clear=function(){this.h=new Kinetic.Layer};var gs=Math.pow(2,2),hs=Math.pow(2,3),is=Math.pow(2,4),js=Math.pow(2,5);fs.prototype.U=function(a,b){this.i=b?this.i|a:this.i&~a};
function ks(a){a.clear();for(var b=[["#C2C2C2","#6B6B6B","#525252","#3D3D3D"],["#FAFAFA","#D8D8D8","#D8D8D8","#C2C2C2"],["#FCCA03","#DD1812","#0140CA","#16A61E"]],c=["m252,324c0,-59.647 48.354,-108 108,-108c26.90799,0 51.51501,9.843 70.42401,26.121c1.03198,-8.564 1.57599,-17.27901 1.57599,-26.121c0,-119.126 -96.43701,-215.722 -215.49899,-215.994c40.89099,0.137 73.99899,33.321 73.99899,74.244c0,41.007 -33.24301,74.25 -74.25,74.25c-41.008,0 -74.25,-33.243 -74.25,-74.25c0,-40.979 33.19701,-74.203 74.16701,-74.248c-0.05602,0 -0.11201,-0.002 -0.16701,-0.002c-119.294,0 -216,96.707 -216,216c0,8.843 0.544,17.55701 1.577,26.121c18.908,-16.278 43.515,-26.121 70.423,-26.121c59.646,0 108,48.353 108,108c0,37.93399 -19.561,71.29401 -49.14301,90.56c26.127,11.21701 54.90701,17.44 85.14301,17.44s59.01599,-6.22299 85.14301,-17.44c-29.582,-19.26599 -49.14301,-52.62601 -49.14301,-90.56z",
"m142,74.25c0,41.007 33.242,74.25 74.25,74.25c41.00699,0 74.25,-33.243 74.25,-74.25c0,-40.923 -33.108,-74.107 -73.99899,-74.244c-0.112,0 -0.22301,-0.004 -0.334,-0.004c-40.97,0.045 -74.16701,33.269 -74.16701,74.248z","m180,324c0,-59.647 -48.354,-108 -108,-108c-26.908,0 -51.515,9.843 -70.424,26.121c9.366,77.69 59.967,142.67798 129.28099,172.43799c29.582,-19.26498 49.14301,-52.625 49.14301,-90.55899z","m430.42401,242.121c-18.909,-16.278 -43.51602,-26.121 -70.42401,-26.121c-59.646,0 -108,48.353 -108,108c0,37.93399 19.561,71.29401 49.142,90.56c69.315,-29.76199 119.91602,-94.74899 129.28201,-172.439z"],
d=b[0].slice(),e=[gs,hs,is,js],f=0;f<e.length;f++){var g=e[f];(a.i&g)==g&&(d[f]=b[2][f])}b=new Kinetic.Group({scaleX:a.g/435,scaleY:a.g/435});e=new Kinetic.Group;for(f=0;f<c.length;f++)a.j[f]=new Kinetic.Path({data:c[f],fill:d[f]}),0<a.l[f]&&(g=a.g/19*8,g=new Kinetic.Text({x:a.o[f]-g/4,y:a.p[f]-g/2,text:String(a.l[f]),fontSize:g,fontFamily:"sans-serif",fill:"white"}),e.add(g)),b.add(a.j[f]);a.h.add(b);a.h.add(e);return a.h};function ls(a){this.g=document.createElement("div");this.h=a||19;this.i=new fs(this.h);this.j=new lh(function(){this.render()},100,this);chrome.runtime.onSuspend&&chrome.runtime.onSuspend.addListener(function(){chrome.browserAction.setTitle({title:"suspended"});this.U(hs,!1);this.U(is,!1);this.U(js,!1);this.U(gs,!1);this.render()}.bind(this))}ls.prototype.n=function(){return this.g};ls.prototype.U=function(a,b){this.i.U(a,b);nh(this.j)};
ls.prototype.render=function(){this.g.parentElement||document.body.appendChild(this.g);(new Kinetic.Stage({container:this.g,width:this.h,height:this.h})).add(ks(this.i));if(chrome.browserAction){var a=this.g.querySelector("canvas"),b=a.getContext("2d");chrome.browserAction.setIcon({imageData:b.getImageData(0,0,a.width,a.height)})}};function Bo(a,b){this.g=a;this.filter=b||null;var c=this;setTimeout(function(){ms(c)},6E5*Math.random())}
function ms(a){var b=a.g.getName(),c={"Content-Type":"application/json"};a.g.values("log",null,20).B(function(a){if(0!=a.length){var e=a.map(function(a){return a.key});a=JSON.stringify(a);a=new bi("https://mhardartway.s3.amazonaws.com/"+(b+"/"+e[0]),"PUT",null,c,a);var f=$h(),e=e.map(function(a){return new sk("log",a)});f.request(a).execute(function(a,b){b.Aa()&&this.g.remove(e).B(function(a){a==e.length&&ms(this)},this)},this)}},a)}Bo.prototype.log=function(){};function ns(){this.Z=null;this.g={};this.h=null;var a=this.N=new Yh,b=chrome.extension.getURL("option-page.html");a.p=b;this.H=new Wn;this.i=this.p=this.l=this.t=null;this.G=new vg(new zg,"XMLHttpRequest"+location.host);this.o=new ls;chrome.permissions.onAdded.addListener(this.qh.bind(this))}h=ns.prototype;h.logger=P("ydn.crm.app.App");
h.qh=function(a){for(var b=(a=a.origins)?a.length:0,c=0;c<b;c++){var d=a[c].match(/https:\/\/([^\/]+)/);if(d){var d=d[1],e=this.g[d];if(e&&(M(this.logger,"host permission granted to "+e),e.j instanceof ho)){var f=$h("default");this.g[d]=new br(f,e.N,e.l,e.i,e.o);this.g[d].update()}}}};h.init=function(){N(this.logger,"init "+this);this.o.U(gs,!0);uo||(Co(),uo=new ko(xo(),void 0,"https://yathit-app.appspot.com",1,!0),Vi(uo,ai))};
function os(a,b){function c(a){return a.Vc().B(function(){var b=a.isLogin()?a.i+"@":" (not login) ";this.logger.info("connected to sugarcrm client: "+b+e);a.isLogin()&&(this.g[e]=a,this.G.set(k,l),b=Object.keys(this.g),bo(this.H,b),a.update(),ps(this));return kr(a)},this)}var d=b.baseUrl,e=b.domain||d;if(!e)return D("domain or url required.");e=e.trim();ta(e,"http")&&(e=(new ud(e)).L());/\//.test(e)&&(e=(new ud("https://"+e)).L());if(d&&(d=d.trim(),!ta(d,"http"))){var d=d.replace(/:?\/\//,""),f=new ud("https://"+
d);f.zc||yd(f,"/");d=f.toString()}var g=a.g[e],k="sugar-client-"+e,l=a.G.get(k)||{};if(g)return g.isLogin()?tb(kr(g)):c.call(a,g);var m=b.userName||l.userName;d||(d=l.base_url);d||(d="https://"+e+"/");if(!m)return N(a.logger,"username not found in "+JSON.stringify(b)),D("username required");var n=b.password;n?b.hashed||(n=CryptoJS.MD5(n).toString()):n=l.password;if(!n)return N(a.logger,"password not found in "+JSON.stringify(b)),D("password required.");l.userName=m;l.password=n;l.base_url=d;var p=
new C;chrome.permissions.contains({origins:[d+"/"]},function(b){b||L(a.logger,"host permission required for "+d);b=b?$h("default"):$h("proxy");g=new br(b,a,d,m,n);rb(c.call(a,g),p)});return p}function qs(a,b,c,d){return 0<=nq.indexOf(b)?a.h.get(c).B(function(a){if(a){var f=nq[nq.indexOf(b)];return tr(d,f,a).B(function(a){if(a&&a.id)return a;throw Error("Set Entry to "+f+" failed");},this)}throw Error("contact entry "+c+" not found");},a):D(new Eh("invalid module name "+b))}
function gr(a,b){var c=new Mr(qr,b.L(),b.module,b.F());ds(a.h,c).B(function(a){for(var c=0;c<a.length;c++){var f=a[c];0<$q(b,f)&&this.h.put(f)}},a)}function ps(a){var b=!1,c;for(c in a.g)if(a.g[c].isLogin()){b=!0;break}a.o.U(gs,!0);a.o.U(js,a.isLogin());a.o.U(hs,b)}
function rs(a,b){if(!b)return D("domain required");a.G.remove("sugar-client-"+b);return ao(a.H).B(function(a){a=a||[];var d=a.indexOf(b);0<=d&&(a.splice(d,1),bo(this.H,a));return this.g[b]?ur(this.g[b]).B(function(){delete this.g[b];this.logger.info("SugarCRM "+b+" removed.");ps(this);return!0},this):!1},a)}
h.Ah=function(a){for(var b=u(a.gContact$externalId)?a.gContact$externalId:[a.gContact$externalId],c=0;c<b.length;c++)if(b[c]&&b[c].value&&b[c].label){var d=Or(b[c].value);d&&"sugarcrm"==d[1]&&(d=d[2],this.g[d]&&rr(this.g[d],new Pr(a)))}};function ss(a){a.h=new bs(a.H.g,a.i.email);var b=$h("gse");a.h.client=b;a.h.h=a.Ah.bind(a);a.h.update()}
function ts(a,b){var c=new C,d=b.email||"";if(a.i&&a.i.email==d)return N(a.logger,"already running for "+d),c.C(a.i),c;a.i=b;a.i.updated=A();d?(a.logger.info(d+" login to YDN server"),Do(a),Xn(a.H,b.Id.$t),ss(a),ao(a.H).B(function(a){a=a||[];for(var b=0;b<a.length;b++)a[b]&&os(this,{domain:a[b]})},a),c.C(a.i),a.isLogin()?(a.o.U(js,!0),chrome.browserAction.setTitle({title:"Ready"})):(a.o.U(js,!1),chrome.browserAction.setTitle({title:"Login required."}))):(a.logger.info("Not login to YDN server"),c.C(a.i),
a.o.U(js,!1),chrome.browserAction.setTitle({title:"Login required."}));return c}function us(a){var b=new C;Eo().request(new bi("/token","DELETE")).execute(function(a,d){d.Aa()?(this.l=this.t=null,b.C(null)):b.D("error "+d.Ha())},a);return b}
function vs(a,b){var c=y(b)?b:{last_login:"1"},d=Eo(),e=new C;d.request(new bi("/audit","GET",c)).execute(function(a,b){if(b.Aa()){if(a.LastLoginRecord){var c=a.LastLoginRecord;if(c.timestamp){var d;d=c.timestamp-A();d=Math.abs(d);if(6E4>d)d="0 minutes";else{var m=Math.floor(d/864E5);d%=864E5;var n=Math.floor(d/36E5),p=Math.floor(d%36E5/6E4),r=Td(String(m)),t=Td(String(n)),x=Td(String(p));d=m*(n+p)?" ":"";var z=n*p?" ":"",m=Ge("{COUNT, plural, =0 {}=1 {{TEXT} day}other {{TEXT} days}}",m,r),n=Ge("{COUNT, plural, =0 {}=1 {{TEXT} hour}other {{TEXT} hours}}",
n,t),p=Ge("{COUNT, plural, =0 {}=1 {{TEXT} minute}other {{TEXT} minutes}}",p,x);d=m+(d+(n+(z+p)))}c.ago=d}}e.C(a)}else e.D(b)},a);return e}
function jj(a,b){if(a.l)return a.l;if(a.t&&a.t.expires<A())return tb(a.t);a.l=new C;var c={url:b||chrome.extension.getURL("option-page.html")},c=new bi("/token","GET",c);Eo().request(c).execute(function(a,b){if(b.Aa()){var c=a.Tokens[0];c.has_token?(c.expires=1E3*c.expires_in+A(),this.t=c,this.l.C(c)):this.l.D(c)}else this.t=null,this.l.D(b);this.l=null},a);return a.l}h.isLogin=function(){return!!this.i&&this.i.is_login};
function ws(a,b){if(a.p)return a.p;a.p=Zh(a.N,b).B(function(b){return ts(this,b).B(function(){a.isLogin()?setTimeout(function(){a.p=null},9E5):a.p=null},function(a){this.logger.info("Attamping to login YDN server fail: "+yh(a))})},a);return a.p}function xs(a){a.p=null;a.i=null;a.o.U(js,!1)}h.toString=function(){return"SugarApp:0.7.13"};function ys(){ns.call(this);this.j={};zs(this)}B(ys,ns);ys.prototype.logger=P("ydn.crm.app.EventPage");
function As(a,b,c){var d=c.req;c.done=!0;var e=null!=c.data?c.data:{};N(a.logger,"service req: "+d+":"+c.id);if("app-setting"==d)c.data=q.localStorage.getItem("app-setting"),b.postMessage(c);else if("echo"==d)N(a.logger,"resp: "+d+":"+c.id),b.postMessage(c);else if("gdata-fetch"==d)e=c.data,"contact"==e?a.h?Xr(a.h).A(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):(c.error="gdata not ready",b.postMessage(c)):(c.error="invalid kind "+e,b.postMessage(c));
else if("gdata-list-contact-by-email"==d)cs(a.h,c.data).B(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token"==d)jj(a,c.data).fa(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("feed-log"==d){var f=e.offset||0,e=e.limit||100;po.g.values("db-logger",null,e||100,f||0,!0).fa(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c)}else if("feed-log-info"==d)f=
e.offset||0,e=e.limit||100,ro(e,f).fa(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token-revoke"==d)us(a).A(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("list-sugarcrm"==d){e=[];for(f in a.g)e.push(kr(a.g[f]));N(a.logger,"resp: "+c.req+":"+c.id);c.data=e;b.postMessage(c)}else"log-bug"==d?(Oi(c.data),
b.postMessage(c)):"login-info"==d?ws(a,c.data).A(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="invalid login";b.postMessage(this)},c):"logged-in"==d?(ws(a,null).B(function(b){Bs(a,{req:d,info:b})}),b.postMessage(c)):"logout"==d?(xs(a),Bs(a,{req:d}),b.postMessage(c)):"new-entry"==d?y(c.data)?$r(a.h,c.data).A(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error=
"failed to create a new entry";b.postMessage(this)},c):(c.error="Invalid gdata entry data",b.postMessage(c)):"new-sugarcrm"==d?os(a,c.data).A(function(){N(a.logger,"resp: "+this.req+":"+this.id);this.data=!0;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"remove-sugar"==d?rs(a,c.data).fa(function(a){this.data=a;b.postMessage(this)},c):"server-audit-log"==d?vs(a,e).A(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"sugar-server-info"==
d?(e=c.data,e=/https?:/.test(e)?new ud(e):wd(new ud,e),(e=a.g[e.L()])?jr(e).B(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c):vr(c.data).A(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){N(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},c)):"user-setting"==d?co().B(function(a){this.data=a;b.postMessage(this)},c):L(a.logger,"Main channel unknown req: "+d)}
function Cs(a,b,c,d){var e=d.req;d.done=!0;M(a.logger,"sugar service req: "+c+":"+e+":"+d.id);if(a.isLogin())if("echo"==e)b.postMessage(d);else if("import-gdata"==e){var f=d.data,g=f?f["gdata-id"]:"";g?qs(a,f.module,g,c).A(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(L(a.logger,"resp error: "+e+":"+d.id),d.error="gdata id required",b.postMessage(d))}else"link"==e?(c=a.h,(e=d.data["gdata-id"])?es(c,e,d.data["external-id"]).A(function(a){this.data=a;
b.postMessage(this)},function(c){L(a.logger,"error linking gdata "+this.req+":"+this.id);this.error=c.name+": "+c.message;b.postMessage(this)},d):(d.error="gdata-id not required",b.postMessage(d))):"login"==e?os(a,d.data).A(function(c){this.data=c;b.postMessage(this);ps(a)},function(a){this.error=a;b.postMessage(this)},d):"sync-entry"==e?(e=d.data,a.h.get(e).A(function(c){c?new Pr(c):(c="GData entry "+this.data+" not found.",N(a.logger,c),this.error=c,b.postMessage(this))},function(c){N(a.logger,
"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d)):wr(c,e,d.data).A(function(c){N(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){N(a.logger,"resp error: "+this.req+":"+this.id+" "+(c&&c instanceof Error?c.name+" "+c.message:c));this.error=c;b.postMessage(this)},d);else d.error="Not login",b.postMessage(d)}function Ds(a){var b=!1,c;for(c in a.j)"gmail"==a.j[c].group&&(b=!0);a.o.U(is,b)}
function Bs(a,b){for(var c in a.j){var d=a.j[c];"gmail"==d.group&&d.port.postMessage(b)}}ys.prototype.T=function(){var a=Object.keys(this.g)[0];return{sugars:this.g,s0:a?this.g[a]:null,gdata:this.h,ports:this.j,user_info:this.i}};
function zs(a){chrome.runtime.onMessage.addListener(function(b,c,d){var e=c.url;e&&/https?:\/\/mail.google.com/.test(e)?(c=b?b.req:null,"inject"==c?chrome.storage.local.get("ydn-crm-src",function(b){var c=b["ydn-crm-src"];M(a.logger,"injecting "+c+" to "+e);chrome.tabs.executeScript(null,{file:c},function(){chrome.tabs.executeScript(null,{code:"app = runInjApp();"},function(){M(a.logger,c+" injected");d(c)})})}):"attach"==c&&(M(a.logger,"attaching crm-ex/sidebar.html to "+e),chrome.tabs.executeScript(null,
{code:'var parent = document.getElementById("'+b.parent+'");var f = document.createElement("iframe"); f.src = "crm-ex/sidebar.html"; parent.appendChild(f);'},function(){M(a.logger,"crm-ex/sidebar.html attached");d("crm-ex/sidebar.html")}))):M(a.logger,"invalid sender "+e)});chrome.runtime.onConnect.addListener(function(b){var c=b.sender.url,d=b.name.substr(0,b.name.lastIndexOf("-"));Ya(fd,d)?(M(a.logger,"Channel "+b.name+" connected for "+c),a.j[b.name]={name:b.name,group:d,port:b},Ds(a),b.onMessage.addListener(function(c){if(c&&
y(c)){if("close"==c.req)a.logger.info("closing "+b.name),delete a.j[b.name],b.disconnect(),Ds(a);else if(!c.id){L(a.logger,"Unknown group in pipe info "+b.name);return}if("sugarcrm"==c.group){var f=c.name,g=a.g[f];g?Cs(a,b,g,c):L(a.logger,"SugarCRM instance "+f+" not found.")}else if("gmail"==c.group||"dev"==c.group||"host-permission"==c.group||"popup"==c.group||"options"==c.group)for(f in a.j)g=a.j[f],g.group!=c.group||c.name&&c.name!=g.name||(c.group=d,c.name=b.name,g.port.postMessage(c));else As(a,
b,c)}else L(a.logger,"invalid message package: "+c)}),b.onDisconnect.addListener(function(){M(a.logger,"disconnected "+b.name);delete a.j[b.name];Ds(a)})):L(a.logger,"channel "+b.name+" ignored from "+c)});M(a.logger,"event page start listening incoming connection")};qa("ydn.debug.log",Mi);qa("loadApp",function(a){chrome.storage.local.get("ydn-crm-track",function(b){var c=b["ydn-crm-track"];b="jsc/ydn.crm-0.7.13.js";navigator.onLine&&"Edge"==c?b="https://ydn-src-1.storage.googleapis.com/jsc/ydn.crm-edge.js":"Beta"==c?b="jsc/ydn.crm-0.7.13.js":"RC"==c&&(b="jsc/ydn.crm-0.7.13.js");c=document.createElement("script");c.onload=a;c.type="text/javascript";var d={};d["ydn-crm-src"]=b;chrome.storage.local.set(d);c.src=b;document.getElementsByTagName("head")[0].appendChild(c)})});function Es(a){H.call(this,"navigate");this.g=a}B(Es,H);function Fs(a){Nc.call(this);this.g=a||window;Bc(this.g,"popstate",this.Pd,!1,this);Bc(this.g,"hashchange",this.Pd,!1,this)}B(Fs,Nc);h=Fs.prototype;h.Fe=!1;h.Ih="/";h.setEnabled=function(a){a!=this.Fe&&(this.Fe=a)&&this.dispatchEvent(new Es(this.getToken()))};h.getToken=function(){var a=this.g.location.href,b=a.indexOf("#");return 0>b?"":a.substring(b+1)};h.J=function(){Ic(this.g,"popstate",this.Pd,!1,this);Ic(this.g,"hashchange",this.Pd,!1,this)};h.Pd=function(){this.Fe&&this.dispatchEvent(new Es(this.getToken()))};function Gs(){}da(Gs);Gs.prototype.g=0;function Y(a){Nc.call(this);this.g=a||Kg();this.Wd=Hs}B(Y,Nc);Y.prototype.ea=Gs.W();var Hs=null;function Is(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?"highlight":"unhighlight";case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close"}throw Error("Invalid component state");}h=Y.prototype;h.sc=null;h.$=!1;h.X=null;h.Wd=null;h.w=null;h.Ja=null;h.ya=null;h.$a=null;
h.wg=!1;h.F=function(){return this.sc||(this.sc="ydn:"+(this.ea.g++).toString(36))};function Js(a,b){if(a.Ja&&a.Ja.$a){var c=a.Ja.$a,d=a.sc;d in c&&delete c[d];mc(a.Ja.$a,b,a)}a.sc=b}h.n=function(){return this.X};function Ks(a){return a.l||(a.l=new gf(a))}function Ls(a,b){if(a==b)throw Error("Unable to set parent component");if(b&&a.Ja&&a.sc&&Ms(a.Ja,a.sc)&&a.Ja!=b)throw Error("Unable to set parent component");a.Ja=b;Y.m.qf.call(a,b)}h.getParent=function(){return this.Ja};
h.qf=function(a){if(this.Ja&&this.Ja!=a)throw Error("Method not supported");Y.m.qf.call(this,a)};h.Q=function(){this.X=this.g.createElement("div")};h.render=function(a){Ns(this,a)};function Ns(a,b,c){if(a.$)throw Error("Component already rendered");a.X||a.Q();b?b.insertBefore(a.X,c||null):a.g.g.body.appendChild(a.X);a.Ja&&!a.Ja.$||a.M()}
function Os(a,b){if(a.$)throw Error("Component already rendered");if(b&&a.Ke(b)){a.wg=!0;var c=Mg(b);a.g&&a.g.g==c||(a.g=Kg(b));a.Tb(b);a.M()}else throw Error("Invalid element to decorate");}h.Ke=function(){return!0};h.Tb=function(a){this.X=a};h.M=function(){this.$=!0;Ps(this,function(a){!a.$&&a.n()&&a.M()})};h.ab=function(){Ps(this,function(a){a.$&&a.ab()});this.l&&this.l.removeAll();this.$=!1};
h.J=function(){this.$&&this.ab();this.l&&(this.l.qa(),delete this.l);Ps(this,function(a){a.qa()});!this.wg&&this.X&&Xg(this.X);this.Ja=this.w=this.X=this.$a=this.ya=null;Y.m.J.call(this)};h.ba=function(a){this.w=a};h.R=function(a,b){this.hd(a,Qs(this),b)};
h.hd=function(a,b,c){if(a.$&&(c||!this.$))throw Error("Component already rendered");if(0>b||b>Qs(this))throw Error("Child component index out of bounds");this.$a&&this.ya||(this.$a={},this.ya=[]);if(a.getParent()==this){var d=a.F();this.$a[d]=a;$a(this.ya,a)}else mc(this.$a,a.F(),a);Ls(a,this);eb(this.ya,b,0,a);a.$&&this.$&&a.getParent()==this?(c=this.ra(),c.insertBefore(a.n(),c.childNodes[b]||null)):c?(this.X||this.Q(),b=Z(this,b+1),Ns(a,this.ra(),b?b.X:null)):this.$&&!a.$&&a.X&&a.X.parentNode&&
1==a.X.parentNode.nodeType&&a.M()};h.ra=function(){return this.X};function Rs(a){null==a.Wd&&(a.Wd=xi(a.$?a.X:a.g.g.body));return a.Wd}function Qs(a){return a.ya?a.ya.length:0}function Ms(a,b){return a.$a&&b?nc(a.$a,b)||null:null}function Z(a,b){return a.ya?a.ya[b]||null:null}function Ps(a,b,c){a.ya&&Ra(a.ya,b,c)}function Ss(a,b){return a.ya&&b?Qa(a.ya,b):-1}
h.tc=function(a,b){if(a){var c=v(a)?a:a.F();a=Ms(this,c);if(c&&a){var d=this.$a;c in d&&delete d[c];$a(this.ya,a);b&&(a.ab(),a.X&&Xg(a.X));Ls(a,null)}}if(!a)throw Error("Child is not in parent component");return a};function Ts(a,b,c,d,e){if(!(F||Jb&&Ub("525")))return!0;if(Cb&&e)return Us(a);if(e&&!d)return!1;w(b)&&(b=Vs(b));if(!c&&(17==b||18==b||Cb&&91==b))return!1;if(Jb&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(F&&d&&b==a)return!1;switch(a){case 13:return!(F&&F&&9<=Wb);case 27:return!Jb}return Us(a)}
function Us(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||Jb&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function Vs(a){if(Ib)a=Ws(a);else if(Cb&&Jb)a:switch(a){case 93:a=91;break a}return a}
function Ws(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function Xs(a,b){Nc.call(this);a&&Ys(this,a,b)}B(Xs,Nc);h=Xs.prototype;h.qc=null;h.Kd=null;h.cf=null;h.Ld=null;h.Va=-1;h.Jb=-1;h.oe=!1;
var Zs={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},$s={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},at=F||Jb&&Ub("525"),bt=Cb&&Ib;h=Xs.prototype;
h.nh=function(a){Jb&&(17==this.Va&&!a.ctrlKey||18==this.Va&&!a.altKey||Cb&&91==this.Va&&!a.metaKey)&&(this.Jb=this.Va=-1);-1==this.Va&&(a.ctrlKey&&17!=a.g?this.Va=17:a.altKey&&18!=a.g?this.Va=18:a.metaKey&&91!=a.g&&(this.Va=91));at&&!Ts(a.g,this.Va,a.shiftKey,a.ctrlKey,a.altKey)?this.handleEvent(a):(this.Jb=Vs(a.g),bt&&(this.oe=a.altKey))};h.oh=function(a){this.Jb=this.Va=-1;this.oe=a.altKey};
h.handleEvent=function(a){var b=a.h,c,d,e=b.altKey;F&&"keypress"==a.type?c=this.Jb:Jb&&"keypress"==a.type?c=this.Jb:Hb?c=this.Jb:(c=b.keyCode||this.Jb,d=b.charCode||0,bt&&(e=this.oe),Cb&&63==d&&224==c&&(c=191));d=c=Vs(c);var f=b.keyIdentifier;c?63232<=c&&c in Zs?d=Zs[c]:25==c&&a.shiftKey&&(d=9):f&&f in $s&&(d=$s[f]);this.Va=d;a=new ct(d,0,0,b);a.altKey=e;this.dispatchEvent(a)};h.n=function(){return this.qc};
function Ys(a,b,c){a.Ld&&dt(a);a.qc=b;a.Kd=Bc(a.qc,"keypress",a,c);a.cf=Bc(a.qc,"keydown",a.nh,c,a);a.Ld=Bc(a.qc,"keyup",a.oh,c,a)}function dt(a){a.Kd&&(Jc(a.Kd),Jc(a.cf),Jc(a.Ld),a.Kd=null,a.cf=null,a.Ld=null);a.qc=null;a.Va=-1;a.Jb=-1}h.J=function(){Xs.m.J.call(this);dt(this)};function ct(a,b,c,d){ac.call(this,d);this.type="key";this.g=a}B(ct,ac);var et;function ft(a,b){b?a.setAttribute("role",b):a.removeAttribute("role")}function gt(a,b,c){fa(c)&&(c=c.join(" "));var d="aria-"+b;""===c||void 0==c?(et||(et={atomic:!1,autocomplete:"none",dropeffect:"none",haspopup:!1,live:"off",multiline:!1,multiselectable:!1,orientation:"vertical",readonly:!1,relevant:"additions text",required:!1,sort:"none",busy:!1,disabled:!1,hidden:!1,invalid:"false"}),c=et,b in c?a.setAttribute(d,c[b]):a.removeAttribute(d)):a.setAttribute(d,c)};function ht(){}var it;da(ht);h=ht.prototype;h.Gb=function(){};h.Y=function(a){var b=a.g.s("div",jt(this,a).join(" "),a.oa());kt(this,a,b);return b};h.za=function(a){return a};function lt(a,b,c){if(a=a.n?a.n():a)if(F&&!Ub("7")){var d=mt(Dg(a),b);d.push(b);pa(c?Eg:Fg,a).apply(null,d)}else c?Eg(a,b):Fg(a,b)}h.Dd=function(){return!0};
h.ua=function(a,b){b.id&&Js(a,b.id);var c=this.za(b);c&&c.firstChild?nt(a,c.firstChild.nextSibling?cb(c.childNodes):c.firstChild):a.wb=null;var d=0,e=this.u(),f=this.u(),g=!1,k=!1,c=!1,l=Dg(b);Ra(l,function(a){g||a!=e?k||a!=f?d|=this.Ee(a):k=!0:(g=!0,f==e&&(k=!0))},this);a.Hb=d;g||(l.push(e),f==e&&(k=!0));k||l.push(f);var m=a.xe;m&&l.push.apply(l,m);if(F&&!Ub("7")){var n=mt(l);0<n.length&&(l.push.apply(l,n),c=!0)}if(!g||!k||m||c)b.className=l.join(" ");kt(this,a,b);return b};
h.ag=function(a){Rs(a)&&this.Re(a.n(),!0);a.isEnabled()&&this.uc(a,a.Da)};function kt(a,b,c){b.Da||gt(c,"hidden",!b.Da);b.isEnabled()||a.Ra(c,1,!b.isEnabled());b.ma&8&&a.Ra(c,8,ot(b,8));b.ma&16&&a.Ra(c,16,ot(b,16));b.ma&64&&a.Ra(c,64,ot(b,64))}h.Ed=function(a,b){Di(a,!b,!F&&!Hb)};h.Re=function(a,b){lt(a,this.u()+"-rtl",b)};h.Qe=function(a){var b;return a.ma&32&&(b=a.i.Zb(a))?ch(b)&&dh(b):!1};
h.uc=function(a,b){var c;if(a.ma&32&&(c=a.i.Zb(a))){if(!b&&ot(a,32)){try{c.blur()}catch(d){}ot(a,32)&&a.Fd(null)}(ch(c)&&dh(c))!=b&&(b?c.tabIndex=0:(c.tabIndex=-1,c.removeAttribute("tabIndex")))}};h.U=function(a,b,c){var d=a.n();if(d){var e=this.Kc(b);e&&lt(a,e,c);this.Ra(d,b,c)}};h.Ra=function(a,b,c){it||(it={1:"disabled",8:"selected",16:"checked",64:"expanded"});(b=it[b])&&gt(a,b,c)};
h.$b=function(a,b){var c=this.za(a);if(c&&(Vg(c),b))if(v(b))$g(c,b);else{var d=function(a){if(a){var b=Mg(c);c.appendChild(v(a)?b.createTextNode(a):a)}};u(b)?Ra(b,d):!fa(b)||"nodeType"in b?d(b):Ra(cb(b),d)}};h.Zb=function(a){return a.n()};h.u=function(){return"goog-control"};function jt(a,b){var c=a.u(),d=[c],e=a.u();e!=c&&d.push(e);c=b.Hb;for(e=[];c;){var f=c&-c;e.push(a.Kc(f));c&=~f}d.push.apply(d,e);(c=b.xe)&&d.push.apply(d,c);F&&!Ub("7")&&d.push.apply(d,mt(d));return d}
function mt(a,b){var c=[];b&&(a=a.concat([b]));Ra([],function(d){!Va(d,pa(Ya,a))||b&&!Ya(d,b)||c.push(d.join("_"))});return c}h.Kc=function(a){this.g||pt(this);return this.g[a]};h.Ee=function(a){this.i||(this.g||pt(this),this.i=pc(this.g));a=parseInt(this.i[a],10);return isNaN(a)?0:a};function pt(a){var b=a.u();a.g={1:b+"-disabled",2:b+"-hover",4:b+"-active",8:b+"-selected",16:b+"-checked",32:b+"-focused",64:b+"-open"}};var qt=!!q.DOMTokenList,rt=qt?function(a){return a.classList}:function(a){a=a.className;return v(a)&&a.match(/\S+/g)||[]},st=qt?function(a,b){return a.classList.contains(b)}:function(a,b){return Ya(rt(a),b)},tt=qt?function(a,b){a.classList.add(b)}:function(a,b){st(a,b)||(a.className+=0<a.className.length?" "+b:b)},ut=qt?function(a,b){Ra(b,function(b){tt(a,b)})}:function(a,b){var c={};Ra(rt(a),function(a){c[a]=!0});Ra(b,function(a){c[a]=!0});a.className="";for(var d in c)a.className+=0<a.className.length?
" "+d:d},vt=qt?function(a,b){a.classList.remove(b)}:function(a,b){st(a,b)&&(a.className=Sa(rt(a),function(a){return a!=b}).join(" "))};function wt(a,b){if(!ha(a))throw Error("Invalid component class "+a);if(!ha(b))throw Error("Invalid renderer class "+b);var c=ia(a);xt[c]=b}function yt(a,b){if(!a)throw Error("Invalid class name "+a);if(!ha(b))throw Error("Invalid decorator function "+b);zt[a]=b}var xt={},zt={};function At(a,b,c){Y.call(this,c);if(!b){b=this.constructor;for(var d;b;){d=ia(b);if(d=xt[d])break;b=b.m?b.m.constructor:null}b=d?ha(d.W)?d.W():new d:null}this.i=b;this.wb=s(a)?a:null}B(At,Y);h=At.prototype;h.wb=null;h.Hb=0;h.ma=39;h.qe=255;h.jc=0;h.Da=!0;h.xe=null;h.We=!0;h.kd=!1;h.mf=null;function Bt(a,b){a.$&&b!=a.We&&Ct(a,b);a.We=b}h.Q=function(){var a=this.i.Y(this);this.X=a;var b=this.mf||this.i.Gb();b&&ft(a,b);this.kd||this.i.Ed(a,!1);this.Da||(R(a,!1),a&&gt(a,"hidden",!0))};h.ra=function(){return this.i.za(this.n())};
h.Ke=function(a){return this.i.Dd(a)};h.Tb=function(a){this.X=a=this.i.ua(this,a);var b=this.mf||this.i.Gb();b&&ft(a,b);this.kd||this.i.Ed(a,!1);this.Da="none"!=a.style.display};h.M=function(){At.m.M.call(this);this.i.ag(this);if(this.ma&-2&&(this.We&&Ct(this,!0),this.ma&32)){var a=this.i.Zb(this);if(a){var b=this.j||(this.j=new Xs);Ys(b,a);Ks(this).listen(b,"key",this.cb).listen(a,"focus",this.Zg).listen(a,"blur",this.Fd)}}};
function Ct(a,b){var c=Ks(a),d=a.n();b?(c.listen(d,"mouseover",a.Ye).listen(d,"mousedown",a.Sc).listen(d,"mouseup",a.ac).listen(d,"mouseout",a.Xe),a.Tc!=ca&&c.listen(d,"contextmenu",a.Tc),F&&c.listen(d,"dblclick",a.bg)):(c.Ca(d,"mouseover",a.Ye).Ca(d,"mousedown",a.Sc).Ca(d,"mouseup",a.ac).Ca(d,"mouseout",a.Xe),a.Tc!=ca&&c.Ca(d,"contextmenu",a.Tc),F&&c.Ca(d,"dblclick",a.bg))}h.ab=function(){At.m.ab.call(this);this.j&&dt(this.j);this.Da&&this.isEnabled()&&this.i.uc(this,!1)};
h.J=function(){At.m.J.call(this);this.j&&(this.j.qa(),delete this.j);delete this.i;this.xe=this.wb=null};h.oa=function(){return this.wb};function nt(a,b){a.wb=b}h.pb=function(){var a=this.oa();if(!a)return"";if(!v(a))if(u(a))a=Ta(a,eh).join("");else{if(Cg&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];fh(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");Cg||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""))}return xa(a)};
function Dt(a){a.kd=!0;var b=a.n();b&&a.i.Ed(b,!0)}h.Se=function(a,b){if(b||this.Da!=a&&this.dispatchEvent(a?"show":"hide")){var c=this.n();c&&(R(c,a),c&&gt(c,"hidden",!a));this.isEnabled()&&this.i.uc(this,a);this.Da=a;return!0}return!1};h.isEnabled=function(){return!ot(this,1)};h.setEnabled=function(a){var b=this.getParent();b&&"function"==typeof b.isEnabled&&!b.isEnabled()||!Et(this,1,!a)||(a||(Ft(this,!1),this.Xa(!1)),this.Da&&this.i.uc(this,a),this.U(1,!a))};
h.Xa=function(a){Et(this,2,a)&&this.U(2,a)};function Ft(a,b){Et(a,4,b)&&a.U(4,b)}h.Bc=function(a){Et(this,8,a)&&this.U(8,a)};h.la=function(a){Et(this,64,a)&&this.U(64,a)};function ot(a,b){return!!(a.Hb&b)}h.U=function(a,b){this.ma&a&&b!=ot(this,a)&&(this.i.U(this,a,b),this.Hb=b?this.Hb|a:this.Hb&~a)};function Gt(a,b,c){if(a.$&&ot(a,b)&&!c)throw Error("Component already rendered");!c&&ot(a,b)&&a.U(b,!1);a.ma=c?a.ma|b:a.ma&~b}function Ht(a,b){return!!(a.qe&b)&&!!(a.ma&b)}function It(a){a.qe&=-256}
function Et(a,b,c){return!!(a.ma&b)&&ot(a,b)!=c&&(!(a.jc&b)||a.dispatchEvent(Is(b,c)))&&!a.H}h.Ye=function(a){!Jt(a,this.n())&&this.dispatchEvent("enter")&&this.isEnabled()&&Ht(this,2)&&this.Xa(!0)};h.Xe=function(a){!Jt(a,this.n())&&this.dispatchEvent("leave")&&(Ht(this,4)&&Ft(this,!1),Ht(this,2)&&this.Xa(!1))};h.Tc=ca;function Jt(a,b){return!!a.j&&Zg(b,a.j)}
h.Sc=function(a){this.isEnabled()&&(Ht(this,2)&&this.Xa(!0),!cc(a)||Jb&&Cb&&a.ctrlKey||(Ht(this,4)&&Ft(this,!0),this.i.Qe(this)&&this.i.Zb(this).focus()));this.kd||!cc(a)||Jb&&Cb&&a.ctrlKey||a.preventDefault()};h.ac=function(a){this.isEnabled()&&(Ht(this,2)&&this.Xa(!0),ot(this,4)&&this.Mb(a)&&Ht(this,4)&&Ft(this,!1))};h.bg=function(a){this.isEnabled()&&this.Mb(a)};
h.Mb=function(a){if(Ht(this,16)){var b=!ot(this,16);Et(this,16,b)&&this.U(16,b)}Ht(this,8)&&this.Bc(!0);Ht(this,64)&&this.la(!ot(this,64));b=new H("action",this);a&&(b.altKey=a.altKey,b.ctrlKey=a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.l=a.l);return this.dispatchEvent(b)};h.Zg=function(){Ht(this,32)&&Et(this,32,!0)&&this.U(32,!0)};h.Fd=function(){Ht(this,4)&&Ft(this,!1);Ht(this,32)&&Et(this,32,!1)&&this.U(32,!1)};
h.cb=function(a){return this.Da&&this.isEnabled()&&this.vc(a)?(a.preventDefault(),a.Qc(),!0):!1};h.vc=function(a){return 13==a.g&&this.Mb(a)};wt(At,ht);yt("goog-control",function(){return new At(null)});function Kt(){}B(Kt,ht);da(Kt);h=Kt.prototype;h.u=function(){return"goog-tab"};h.Gb=function(){return"tab"};h.Y=function(a){var b=Kt.m.Y.call(this,a);(a=a.ub())&&this.Qb(b,a);return b};h.ua=function(a,b){b=Kt.m.ua.call(this,a,b);var c=this.ub(b);c&&a.Xd(c);ot(a,8)&&(c=a.getParent())&&ha(c.Cc)&&(a.U(8,!1),c.Cc(a));return b};h.ub=function(a){return a.title||""};h.Qb=function(a,b){a&&(a.title=b||"")};function Lt(a,b,c){At.call(this,a,b||Kt.W(),c);Gt(this,8,!0);this.jc|=9}B(Lt,At);Lt.prototype.ub=function(){return this.h};Lt.prototype.Qb=function(a){this.i.Qb(this.n(),a);this.Xd(a)};Lt.prototype.Xd=function(a){this.h=a};yt("goog-tab",function(){return new Lt(null)});function Mt(){}da(Mt);h=Mt.prototype;h.Cd=function(){};function Nt(a,b){a&&(a.tabIndex=b?0:-1)}h.Le=function(a){return"DIV"==a.tagName};function Ot(a,b,c){c.id&&Js(b,c.id);var d=a.u(),e=!1,f=rt(c);f&&Ra(f,function(a){a==d?e=!0:a&&this.rf(b,a,d)},a);e||tt(c,d);Pt(a,b,c);return c}h.rf=function(a,b,c){b==c+"-disabled"?a.setEnabled(!1):b==c+"-horizontal"?Qt(a,Rt):b==c+"-vertical"&&Qt(a,St)};
function Pt(a,b,c){if(c)for(var d=c.firstChild,e;d&&d.parentNode==c;){e=d.nextSibling;if(1==d.nodeType){var f=a.Lc(d);f&&(f.X=d,b.isEnabled()||f.setEnabled(!1),b.R(f),Os(f,d))}else d.nodeValue&&""!=ya(d.nodeValue)||c.removeChild(d);d=e}}h.Lc=function(a){a:{var b;a=rt(a);for(var c=0,d=a.length;c<d;c++)if(b=a[c],b=b in zt?zt[b]():null){a=b;break a}a=null}return a};h.Ne=function(a){a=a.n();Di(a,!0,Ib);F&&(a.hideFocus=!0);var b=this.Cd();b&&ft(a,b)};h.u=function(){return"goog-container"};
h.Me=function(a){var b=this.u(),c=[b,a.Kb==Rt?b+"-horizontal":b+"-vertical"];a.isEnabled()||c.push(b+"-disabled");return c};h.Wf=function(){return St};function Tt(a,b,c){Y.call(this,c);this.vb=b||Mt.W();this.Kb=a||this.vb.Wf()}B(Tt,Y);var Rt="horizontal",St="vertical";h=Tt.prototype;h.df=null;h.Yb=null;h.vb=null;h.Kb=null;h.Na=!0;h.Xb=!0;h.oc=!0;h.Oa=-1;h.sa=null;h.Bb=!1;h.mb=null;function Ut(a){return a.df||a.n()}h.Q=function(){this.X=this.g.s("div",this.vb.Me(this).join(" "))};h.ra=function(){return this.n()};h.Ke=function(a){return this.vb.Le(a)};h.Tb=function(a){this.X=Ot(this.vb,this,a);"none"==a.style.display&&(this.Na=!1)};
h.M=function(){Tt.m.M.call(this);Ps(this,function(a){a.$&&Vt(this,a)},this);var a=this.n();this.vb.Ne(this);this.Rc(this.Na,!0);Ks(this).listen(this,"enter",this.Ue).listen(this,"highlight",this.Wg).listen(this,"unhighlight",this.Yg).listen(this,"open",this.rh).listen(this,"close",this.hh).listen(a,"mousedown",this.Xg).listen(Mg(a),"mouseup",this.kh).listen(a,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.eh);this.oc&&Wt(this,!0)};
function Wt(a,b){var c=Ks(a),d=Ut(a);b?c.listen(d,"focus",a.Oe).listen(d,"blur",a.$f).listen(a.Yb||(a.Yb=new Xs(Ut(a))),"key",a.cb):c.Ca(d,"focus",a.Oe).Ca(d,"blur",a.$f).Ca(a.Yb||(a.Yb=new Xs(Ut(a))),"key",a.cb)}h.ab=function(){this.Pb(-1);this.sa&&this.sa.la(!1);this.Bb=!1;Tt.m.ab.call(this)};h.J=function(){Tt.m.J.call(this);this.Yb&&(this.Yb.qa(),this.Yb=null);this.vb=this.sa=this.mb=this.df=null};h.Ue=function(){return!0};
h.Wg=function(a){var b=Ss(this,a.target);if(-1<b&&b!=this.Oa){var c=Xt(this);c&&c.Xa(!1);this.Oa=b;c=Xt(this);this.Bb&&Ft(c,!0);this.sa&&c!=this.sa&&(c.ma&64?c.la(!0):this.sa.la(!1))}b=this.n();null!=a.target.n()&&gt(b,"activedescendant",a.target.n().id)};h.Yg=function(a){a.target==Xt(this)&&(this.Oa=-1);this.n().removeAttribute("aria-activedescendant")};h.rh=function(a){(a=a.target)&&a!=this.sa&&a.getParent()==this&&(this.sa&&this.sa.la(!1),this.sa=a)};
h.hh=function(a){a.target==this.sa&&(this.sa=null)};h.Xg=function(a){this.Xb&&(this.Bb=!0);var b=Ut(this);b&&ch(b)&&dh(b)?b.focus():a.preventDefault()};h.kh=function(){this.Bb=!1};h.eh=function(a){var b;a:{b=a.target;if(this.mb)for(var c=this.n();b&&b!==c;){var d=b.id;if(d in this.mb){b=this.mb[d];break a}b=b.parentNode}b=null}if(b)switch(a.type){case "mousedown":b.Sc(a);break;case "mouseup":b.ac(a);break;case "mouseover":b.Ye(a);break;case "mouseout":b.Xe(a);break;case "contextmenu":b.Tc(a)}};
h.Oe=function(){};h.$f=function(){this.Pb(-1);this.Bb=!1;this.sa&&this.sa.la(!1)};h.cb=function(a){return this.isEnabled()&&this.Na&&(0!=Qs(this)||this.df)&&this.Pe(a)?(a.preventDefault(),a.Qc(),!0):!1};
h.Pe=function(a){var b=Xt(this);if(b&&"function"==typeof b.cb&&b.cb(a)||this.sa&&this.sa!=b&&"function"==typeof this.sa.cb&&this.sa.cb(a))return!0;if(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)return!1;switch(a.g){case 27:if(this.oc)Ut(this).blur();else return!1;break;case 36:Yt(this);break;case 35:Zt(this);break;case 38:if(this.Kb==St)$t(this);else return!1;break;case 37:if(this.Kb==Rt)Rs(this)?au(this):$t(this);else return!1;break;case 40:if(this.Kb==St)au(this);else return!1;break;case 39:if(this.Kb==
Rt)Rs(this)?$t(this):au(this);else return!1;break;default:return!1}return!0};function Vt(a,b){var c=b.n(),c=c.id||(c.id=b.F());a.mb||(a.mb={});a.mb[c]=b}h.R=function(a,b){Tt.m.R.call(this,a,b)};h.hd=function(a,b,c){a.jc|=2;a.jc|=64;Gt(a,32,!1);Bt(a,!1);Tt.m.hd.call(this,a,b,c);a.$&&this.$&&Vt(this,a);b<=this.Oa&&this.Oa++};
h.tc=function(a,b){if(a=v(a)?Ms(this,a):a){var c=Ss(this,a);-1!=c&&(c==this.Oa?(a.Xa(!1),this.Oa=-1):c<this.Oa&&this.Oa--);var d=a.n();d&&d.id&&this.mb&&(c=this.mb,d=d.id,d in c&&delete c[d])}a=Tt.m.tc.call(this,a,b);Bt(a,!0);return a};function Qt(a,b){if(a.n())throw Error("Component already rendered");a.Kb=b}
h.Rc=function(a,b){if(b||this.Na!=a&&this.dispatchEvent(a?"show":"hide")){this.Na=a;var c=this.n();c&&(R(c,a),this.oc&&Nt(Ut(this),this.Xb&&this.Na),b||this.dispatchEvent(this.Na?"aftershow":"afterhide"));return!0}return!1};h.isEnabled=function(){return this.Xb};
h.setEnabled=function(a){this.Xb!=a&&this.dispatchEvent(a?"enable":"disable")&&(a?(this.Xb=!0,Ps(this,function(a){a.xg?delete a.xg:a.setEnabled(!0)})):(Ps(this,function(a){a.isEnabled()?a.setEnabled(!1):a.xg=!0}),this.Bb=this.Xb=!1),this.oc&&Nt(Ut(this),a&&this.Na))};function bu(a,b){b!=a.oc&&a.$&&Wt(a,b);a.oc=b;a.Xb&&a.Na&&Nt(Ut(a),b)}h.Pb=function(a){(a=Z(this,a))?a.Xa(!0):-1<this.Oa&&Xt(this).Xa(!1)};h.Xa=function(a){this.Pb(Ss(this,a))};function Xt(a){return Z(a,a.Oa)}
function Yt(a){cu(a,function(a,c){return(a+1)%c},Qs(a)-1)}function Zt(a){cu(a,function(a,c){a--;return 0>a?c-1:a},0)}function au(a){cu(a,function(a,c){return(a+1)%c},a.Oa)}function $t(a){cu(a,function(a,c){a--;return 0>a?c-1:a},a.Oa)}function cu(a,b,c){c=0>c?Ss(a,a.sa):c;var d=Qs(a);c=b.call(a,c,d);for(var e=0;e<=d;){var f=Z(a,c);if(f&&a.Qf(f)){a.pf(c);break}e++;c=b.call(a,c,d)}}h.Qf=function(a){return a.Da&&a.isEnabled()&&!!(a.ma&2)};h.pf=function(a){this.Pb(a)};function du(){}B(du,Mt);da(du);du.prototype.u=function(){return"goog-tab-bar"};du.prototype.Cd=function(){return"tablist"};du.prototype.rf=function(a,b,c){this.h||(this.g||eu(this),this.h=pc(this.g));var d=this.h[b];d?(Qt(a,d==fu||d==gu?St:Rt),a.i=d):du.m.rf.call(this,a,b,c)};du.prototype.Me=function(a){var b=du.m.Me.call(this,a);this.g||eu(this);b.push(this.g[a.i]);return b};function eu(a){var b=a.u();a.g=sc(hu,b+"-top",iu,b+"-bottom",fu,b+"-start",gu,b+"-end")};function ju(a,b,c){a=a||hu;Qt(this,a==fu||a==gu?St:Rt);this.i=a;Tt.call(this,this.Kb,b||du.W(),c);ku(this)}B(ju,Tt);var hu="top",iu="bottom",fu="start",gu="end";h=ju.prototype;h.gb=null;h.M=function(){ju.m.M.call(this);ku(this)};h.J=function(){ju.m.J.call(this);this.gb=null};h.tc=function(a,b){lu(this,a);return ju.m.tc.call(this,a,b)};h.pf=function(a){ju.m.pf.call(this,a);this.Cc(Z(this,a))};h.Cc=function(a){a?a.Bc(!0):this.gb&&this.gb.Bc(!1)};
function lu(a,b){if(b&&b==a.gb){for(var c=Ss(a,b),d=c-1;b=Z(a,d);d--)if(b.Da&&b.isEnabled()){a.Cc(b);return}for(c+=1;b=Z(a,c);c++)if(b.Da&&b.isEnabled()){a.Cc(b);return}a.Cc(null)}}h.xh=function(a){this.gb&&this.gb!=a.target&&this.gb.Bc(!1);this.gb=a.target};h.yh=function(a){a.target==this.gb&&(this.gb=null)};h.vh=function(a){lu(this,a.target)};h.wh=function(a){lu(this,a.target)};h.Oe=function(){Xt(this)||this.Xa(this.gb||Z(this,0))};
function ku(a){Ks(a).listen(a,"select",a.xh).listen(a,"unselect",a.yh).listen(a,"disable",a.vh).listen(a,"hide",a.wh)}yt("goog-tab-bar",function(){return new ju});function mu(a,b){this.g=a;this.h=b};function nu(a,b){this.parent=a;this.g=b}function ou(a){var b=a.parent.pa();return b?b.value(a.g):null}nu.prototype.Mc=function(){return ou(this)};function pu(a){a=qu(a.parent.module).module_fields[a.g];return v(a.label)?a.label.replace(/:$/,""):a.label}nu.prototype.toString=function(){return this.parent+";Field:"+this.g};function ru(a,b){this.module=a;this.bb=b||"";this.g={}}ru.prototype.L=function(){return this.module.L()};ru.prototype.pa=function(){return this.module.pa()};function su(a){var b=qu(a.module),c=[],d;for(d in b.module_fields){var e=b.module_fields[d];a.bb&&e.group==a.bb?c.push(d):a.bb||e.group||c.push(d)}return c}function tu(a,b){var c=qu(a.module),d;for(d in c.module_fields)if(d==b)return!0;return!1}function uu(a,b){a.g[b]||(a.g[b]=new nu(a,b));return a.g[b]}
function vu(a){a=a.bb.replace("_"," ");return a=a.charAt(0).toUpperCase()+a.substr(1)};function wu(a,b){Nc.call(this);this.parent=a;this.h=b;this.i={}}B(wu,Nc);h=wu.prototype;h.logger=P("ydn.crm.sugar.model.Record");h.L=function(){return this.parent.L()};h.F=function(){return this.h.F()};h.value=function(a){return this.h.value(a)};function $(a){return a.h.module}function qu(a){return a.parent.j[$(a)]}
h.save=function(){var a=this.pa();return a.g?this.parent.send("put-record",{module:a.module,record:a.g}).B(function(b){var c=this,d=!xu(this);Uq(a,b);setTimeout(function(){d?c.dispatchEvent(new yu(0,c)):c.dispatchEvent(new zu(0,c))},10)},this):D("empty record to save")};h.J=function(){wu.m.J.call(this);this.i=null};h.pa=function(){return this.h};
function Au(a,b){b=b?b.g?b:null:null;var c=!1,d=!1,e=!1;b?b!==a.h&&(c=!0,(d=a.h.module!=b.module)||(e=xu(a)?a.h.F()!=b.F():!0),a.h=b):!b&&xu(a)&&(e=c=!0,a.h.g=null);var f=a.h.module;d?a.dispatchEvent(new Bu(f,b,a)):e?a.dispatchEvent(new yu(0,a)):c&&a.dispatchEvent(new zu(0,a))}function xu(a){return!!a.h.g}function Cu(a){var b=[];a=qu(a);for(var c in a.module_fields){var d=a.module_fields[c].group;-1==b.indexOf(d)&&b.push(d)}return b}function Du(a,b){a.i[b]||(a.i[b]=new ru(a,b));return a.i[b]}
h.toString=function(){return"ydn.crm.sugar.model.Record:"+this.h};function Eu(a,b){H.call(this,a,b)}B(Eu,H);function yu(a,b){H.call(this,"record-change",b)}B(yu,Eu);function Bu(a,b,c){H.call(this,"record-change",c);this.module=a;this.update=b}B(Bu,Eu);function zu(a,b){H.call(this,"record-update",b)}B(zu,Eu);function Fu(a,b,c,d){H.call(this,"gdata-change",d);this.module_name=a}B(Fu,Eu);function Gu(a,b){Nc.call(this);this.g=a;this.j=b;this.info={};this.i=this.h=null;this.bc=new gf(this)}B(Gu,Nc);h=Gu.prototype;h.isLogin=function(){return!!this.g.isLogin};function Hu(a){return gd("sugarcrm",a.L())}h.L=function(){return this.g.domain};function Iu(a,b,c){var d={};d.domain=a.L();d.baseUrl=a.g.baseUrl||null;d.mi=b;d.password=c;return a.send("login",d).B(function(a){this.g=a},a)}h.send=function(a,b){return gd("sugarcrm",this.L()).send(a,b)};
h.Cb=function(){this.h||(this.h=this.send("server-info"),this.h.B(function(a){if(a){var b=a.info;b&&(this.info=b);if(a=a.about)this.g=a}else this.h=null},this));return this.h};function Ju(a,b,c,d){b={store:b};c&&(b.index=c);d&&(d instanceof S?b.range=d.toJSON():b.key=d);b.prefix=!0;return Hu(a).send("list",[b])}function Ku(a,b,c){c={store:b,index:"name",q:c,fetchFull:!1};"Notes"==b&&(c.index="content");return Hu(a).send("search",[c])}
function Lu(a,b,c,d){var e=document.createElement("div");e.innerHTML=b.$e;var f=b.Qg.toISOString().replace("T"," ").replace(/\..+/,"");return a.send("new-record",{module:"Emails",record:{assigned_user_id:a.g?a.g.userName||"":"",assigned_user_name:a.g.userName||null,type:"archived",date_sent:f,description:e.textContent,description_html:b.$e,name:b.Jh,from_addr:b.Sg,to_addrs:b.Lh,parent_id:d||"",parent_type:c||"",mailbox_id:b.Dh||"",message_id:b.kf||"",status:"read"}})}
h.J=function(){Gu.m.J.call(this);this.i=this.info=null;this.bc.qa();this.bc=null};h.toString=function(){return"ydn.crm.sugar.model.Sugar:"+this.L()};function Mu(a,b){Y.call(this);this.ba(a);this.parent=b||null;this.h=new Nu}B(Mu,Y);h=Mu.prototype;h.logger=P("ydn.crm.ui.GmailCmd");h.u=function(){return"gmail-cmd-panel"};h.Q=function(){Mu.m.Q.call(this);var a=this.n(),b=this.g;a.classList.add(this.u());b=b.s("a",{"class":"archive"},".");Ou(this.h,b);a.appendChild(b)};function Pu(a,b){Qu(a.h,"View",tq(a.w.L(),"Emails",b.id));a.h.n().setAttribute("target","gmail")}
function Ru(a){Qu(a.h,".");setTimeout(function(){Qu(a.h,"..");var b=Su(a.n());b.kf?(Qu(a.h,"..."),a.w.send("list",[{store:"Emails",index:"message_id",key:b.kf}]).A(function(b){(b=b[0]&&b[0].result?b[0].result[0]:null)?Pu(a,b):Qu(a.h,"Archive","#archive")},function(b){Qu(a.h,"Archive","#archive");throw b;})):1<b.$e.length?Qu(a.h,"Archive","#archive"):Tu(a.h,"gmail message cannot be parsed")},100)}h.M=function(){Mu.m.M.call(this);Ks(this).listen(this.h,"click",this.bh);Ru(this)};
function Su(a){var b="",c="",d="",e="",f="",g=gh(a,"TR");if(b=g.children[0].querySelector("span[email]"))b=b.getAttribute("email");else return L(wo,"cannot sniff sender email"),null;if(a=g.children[1].querySelector("span[alt]"))a=a.getAttribute("alt"),a=new Date(a.replace(" at",""));else return L(wo,"cannot sniff date sent"),null;var k=g.nextElementSibling;if(!k||"TR"!=k.tagName)return L(wo,"to email address TR expect after title TR"),null;for(var l=k.querySelectorAll("span[email]"),k=0;k<l.length;k++)c&&
(c+=", "),c+=l[k].getAttribute("email");for(var g=gh(g,"TABLE"),m=g.parentElement.nextElementSibling,k=0;m&&10>k;k++)if(l=m.querySelector("div[style]")){d=l.parentElement.className.split(/\s/);k=d.map(function(a){return a.length});k=k.indexOf(Math.max.apply(Math,k));10<d[k].length&&(e=d[k].substring(1),"m"!=d[k].charAt(0)&&N(wo,"not start with m? "+d[k]));d=l.innerHTML;break}else m=m.nextElementSibling;g=gh(g.parentElement,"TABLE");for(k=0;g&&10>k&&"presentation"!=g.getAttribute("role");k++)g=gh(g,
"TABLE");"presentation"==g.getAttribute("role")?(g=g.querySelector("h2"))?f=g.textContent:L(wo,"email subject cannot be sniff"):L(wo,"expect a presentation role TABLE");g=Uu().g.email;return{Sg:b,Lh:c,Qg:a,$e:d,Dh:g,kf:e,Jh:f}}h.bh=function(a){if(ua(a.target.href)){a.preventDefault();Qu(this.h,"archiving...");var b=a=void 0,c=this.parent?Vu(Z(this.parent,1)):[];c[0]&&(a=c[0].module,b=c[0].id);(c=Su(this.n()))?Lu(this.w,c,a,b).A(function(a){Pu(this,a)},function(a){Tu(this.h,a)},this):Tu(this.h,"Cannot gather email message")}};function Wu(a,b){this.h=a;this.parent=b||null;this.g=[];(new MutationObserver(this.i.bind(this))).observe(document.body,{childList:!1,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,attributeFilter:["data-tooltip"]})}Wu.prototype.logger=P("ydn.crm.ui.GmailCmdInjector");
Wu.prototype.i=function(a){for(var b=0;b<a.length;b++){var c=a[b].target;if("Reply"==c.getAttribute("data-tooltip")){var d;a:{for(d=0;d<this.g.length;d++)if(!document.body.contains(this.g[d].n())){this.g[d].$&&this.g[d].ab();d=this.g[d];break a}d=new Mu(this.h);this.g.push(d)}var e=document.createElement("span");c.parentElement.insertBefore(e,c);d.render(e)}}};function Xu(){}B(Xu,ht);Xu.prototype.logger=P("ydn.crm.inj.sugar.FeedPanelRenderer");Xu.prototype.u=function(){return"feed-panel"};Xu.prototype.Y=function(a){var b=Xu.m.Y.call(this,a);a=a.g.s("div","feed","Feed panel");b.appendChild(a);return b};Xu.prototype.refresh=function(){};function Yu(a,b){At.call(this,null,null,a);this.ba(b)}B(Yu,At);Yu.prototype.refresh=function(){var a=this.w,b=this.n();this.i.refresh(b,a)};wt(Yu,Xu);function Zu(a,b){var c=a.type;if(s(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b?"checked":null;break;case "select-one":a.selectedIndex=-1;if(v(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":c=b;v(c)&&(c=[c]);for(var e=0;d=a.options[e];e++)if(d.selected=!1,c)for(var f,g=0;f=c[g];g++)d.value==f&&(d.selected=!0);break;default:a.value=null!=b?b:""}};function $u(){}B($u,ht);da($u);$u.prototype.u=function(){return"field"};function av(a){var b=qu(a.parent.module).module_fields[a.g];a="ydnf-"+($(a.parent.module)+"-"+a.g);if("enum"==b.type&&b.options&&!document.getElementById(a)){var c=document.createElement("datalist");c.id=a;for(var d in b.options)d&&(b=document.createElement("option"),b.setAttribute("value",d),c.appendChild(b));document.body.appendChild(c)}return a}
$u.prototype.Y=function(a){var b=$u.m.Y.call(this,a);a.X=b;var c=a.w;a=a.g;var d,e,f=pu(c);d=qu(c.parent.module).module_fields[c.g].type||"varchar";"bool"==d?(d=a.s("input",{"class":"value",type:"checkbox",disabled:"1"}),e=a.s("span","name")):"enum"==d?(d=a.s("input",{"class":"value enum",type:"text",disabled:"1"}),d.setAttribute("list",av(c))):(d=a.s("label","value"),e=a.s("sup","name"));b.classList.add(this.u());b.setAttribute("name",c.g);b.appendChild(d);e&&(e.textContent=f,b.appendChild(e));return b};
$u.prototype.refresh=function(a,b){R(a,!!b);if(b){var c=ou(b),d=v(c)?!wa(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":Zu(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function bv(a,b,c){At.call(this,null,b,c);Bt(this,!1);Dt(this);It(this);Gt(this,32,!1);Gt(this,8,!1);this.ba(a)}B(bv,At);wt(bv,$u);bv.prototype.refresh=function(){this.i.refresh(this.n(),this.w)};wt(bv,$u);function cv(){}B(cv,ht);da(cv);cv.prototype.u=function(){return"record-group"};
cv.prototype.Y=function(a){var b=cv.m.Y.call(this,a),c=a.g,d=c.s("div"),e=c.s("div","content");b.appendChild(d);b.appendChild(e);a.X=b;b.setAttribute("name",a.w.bb);for(var d=a.w,e=su(d),f=$u.W(),g=0;g<e.length;g++){var k=uu(d,e[g]),k=new bv(k,f,c);a.R(k,!0)}a=d.module;c=a.parent.i||null;a=y(c)?lc(c,["modules",$(a)]):null;(a=y(a)?lc(a,["groups",d.bb]):null)?d=a.normallyHide:(d=d.bb,d=/address/i.test(d)?!1:0<=["email","name","phone"].indexOf(d)?!1:!0);d&&b.classList.add("normally-hide");return b};function dv(a,b,c){At.call(this,null,b,c);Bt(this,!1);Dt(this);It(this);Gt(this,32,!1);Gt(this,8,!1);this.ba(a)}B(dv,At);dv.prototype.ra=function(){return Ng("content",this.n())};dv.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)Z(this,a).refresh()};wt(dv,cv);function ev(){}B(ev,$u);da(ev);
ev.prototype.Y=function(a){var b=a.g.s("span",jt(this,a).join(" "),a.oa());kt(this,a,b);a.X=b;var c=a.w,d=a.g;a=pu(c);var e=qu(c.parent.module).module_fields[c.g].type||"varchar";"bool"==e?d=d.s("input",{"class":"value",type:"checkbox",disabled:"1"}):"enum"==e?(d=d.s("input",{"class":"value enum",type:"text",disabled:"1"}),d.setAttribute("list",av(c))):d=d.s("label","value");d.setAttribute("title",a);b.classList.add(this.u());b.setAttribute("name",c.g);b.appendChild(d);return b};
ev.prototype.refresh=function(a,b){R(a,!!b);if(b){var c=ou(b),d=v(c)?!wa(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":Zu(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function fv(){}B(fv,ht);da(fv);fv.prototype.u=function(){return"address"};fv.prototype.Y=function(a){var b=fv.m.Y.call(this,a),c=a.w,d=a.g;b.setAttribute("name",c.bb);b.classList.add("record-group");var e=d.s("details"),f=d.s("summary");f.textContent=vu(c);b.appendChild(f);var g=d.s("div","content");e.appendChild(f);e.appendChild(g);b.appendChild(e);a.X=b;e=su(c);f=ev.W();for(g=0;g<e.length;g++){var k=uu(c,e[g]),k=new bv(k,f,d);a.R(k,!0)}return b};function gv(a,b){var c=fv.W();dv.call(this,a,c,b)}B(gv,dv);gv.prototype.ra=function(){return this.n().querySelector("summary").nextElementSibling};gv.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)Z(this,a).refresh()};wt(gv,fv);function hv(){}B(hv,ht);da(hv);hv.prototype.u=function(){return"email"};hv.prototype.Y=function(a){var b=hv.m.Y.call(this,a),c=a.w,d=a.g;b.setAttribute("name",c.bb);b.classList.add("record-group");var e=d.s("div");e.setAttribute("title",vu(c));b.appendChild(e);c=d.s("div","content");b.appendChild(e);b.appendChild(c);return a.X=b};
function iv(a,b,c,d,e,f){b?(a.textContent=c||b,a.setAttribute("name",b),b="",d&&(b+=" primary"),e&&(b+=" optout"),f&&(b+=" deleted"),a.className=b):(a.textContent="",a.className="empty")}
hv.prototype.refresh=function(a){var b=a.n(),c=a.w;R(b,!!c);if(c){var b=a.g,d=uu(c,"email"),e=d?d.Mc():null,d=u(e);a=a.ra();if(d){for(d=0;d<e.length;d++){var c=e[d],f=a.children[d];f||(f=b.s("SPAN"),a.appendChild(f));c&&iv(f,c.email_address,void 0,"1"==c.primary_address?!0:!1,"1"==c.opt_out?!0:!1,"1"==c.deleted?!0:!1)}for(d=a.childElementCount-1;d>=e.length;d--)a.removeChild(a.children[d])}else{e=su(c);for(d=0;d<e.length;d++){var g=e[d],f=a.children[d];f||(f=b.s("SPAN"),a.appendChild(f));(g=uu(c,
g))&&iv(f,ou(g))}for(d=a.childElementCount-1;d>=e.length;d--)a.removeChild(a.children[d])}}};function jv(a,b){var c=hv.W();dv.call(this,a,c,b)}B(jv,dv);jv.prototype.ra=function(){return Ng("content",this.n())};jv.prototype.refresh=function(){this.i.refresh(this)};wt(jv,hv);function kv(){}B(kv,ht);da(kv);kv.prototype.u=function(){return"list"};kv.prototype.Y=function(a){var b=kv.m.Y.call(this,a),c=a.w,d=a.g;b.setAttribute("name",c.bb);b.classList.add("record-group");var e=d.s("div");e.setAttribute("title",vu(c));b.appendChild(e);var f=d.s("div","content");b.appendChild(e);b.appendChild(f);a.X=b;for(var e=su(c),f=ev.W(),g=0;g<e.length;g++){var k=uu(c,e[g]),k=new bv(k,f,d);a.R(k,!0)}return b};function lv(a,b){var c=kv.W();dv.call(this,a,c,b)}B(lv,dv);lv.prototype.ra=function(){return Ng("content",this.n())};lv.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)Z(this,a).refresh()};wt(lv,kv);function mv(){}B(mv,ht);da(mv);mv.prototype.u=function(){return"name"};
mv.prototype.Y=function(a){var b=mv.m.Y.call(this,a),c=a.w,d=a.g;b.setAttribute("name",c.bb);b.classList.add("record-group");var e=d.s("div");e.setAttribute("title",vu(c));b.appendChild(e);var f=d.s("div","content");b.appendChild(e);b.appendChild(f);a.X=b;su(c);e=ev.W();tu(c,"salutation")&&(f=uu(c,"salutation"),f=new bv(f,e,d),a.R(f,!0));tu(c,"first_name")&&a.R(new bv(uu(c,"first_name"),e,d),!0);tu(c,"last_name")&&a.R(new bv(uu(c,"last_name"),e,d),!0);return b};function nv(a,b){var c=mv.W();dv.call(this,a,c,b)}B(nv,dv);nv.prototype.ra=function(){return Ng("content",this.n())};nv.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)Z(this,a).refresh()};wt(nv,mv);function ov(){}B(ov,ht);da(ov);ov.prototype.u=function(){return"record-panel"};
ov.prototype.Y=function(a){var b=ov.m.Y.call(this,a),c=a.g,d=c.s("div","record-header"),e=c.s("div","record-content");b.appendChild(d);b.appendChild(e);a.X=b;e=c.s("a",{name:"detail"},"detail");e.href="#";d.appendChild(e);for(var d=a.w,e=Cu(d),f=cv.W(),g=0;g<e.length;g++){var k=e[g],l,m=Du(d,k);/address/i.test(k)?l=new gv(m,c):"email"==k?l=new jv(m,c):"phone"==k?l=new lv(m,c):"name"==k?l=new nv(m,c):l=new dv(m,f,c);a.R(l,!0)}return b};function pv(a){return a.querySelector("a[name=detail]")};function qv(a,b,c){b=b||ov.W();At.call(this,null,b,c);Bt(this,!1);Dt(this);It(this);this.ba(a)}B(qv,At);h=qv.prototype;h.logger=P("ydn.crm.inj.sugar.module.RecordCtrl");h.ra=function(){return Ng("record-content",this.n())};h.M=function(){qv.m.M.call(this);var a=Ks(this),b=this.w;b&&a.listen(b,"record-change",this.refresh);a.listen(pv(this.n()),"click",this.Th,!1)};
h.Th=function(a){a.preventDefault();var b=this.n();a=Ng("record-header",b);b=Ng("record-content",b);a=pv(a);b.classList.contains("detail")?(a.textContent="detail",b.classList.remove("detail")):(a.textContent="less",b.classList.add("detail"))};
h.refresh=function(a){var b=this.w,c=this.n();if(b.pa())for(R(c,!0),a&&"record-change"==a.type&&(a=this.n(),b=Ng("record-header",a),Ng("record-content",a),a=pv(b),a.textContent="detail",R(a,!0)),a=0;a<Qs(this);a++)b=Z(this,a),b instanceof dv&&b.refresh();else R(c,!1)};wt(qv,ov);function rv(){}B(rv,ht);rv.prototype.logger=P("ydn.crm.inj.sugar.module.GDataPanelRenderer");rv.prototype.u=function(){return"record-panel"};
rv.prototype.Y=function(a){var b=rv.m.Y.call(this,a),c=a.w,d=$(c),e=a.g,f=e.s("div","record-root");b.appendChild(f);var g=e.s("div","record-header"),k=e.s("div","record-content");f.appendChild(g);f.appendChild(k);a.X=f;f.classList.add(d);f=e.s("span",{"class":"icon"},d.substr(0,2));k=e.s("a",{href:"#","class":"title"});k.target=c.L();var l=e.s("a",{href:"#link","class":"link"},"link"),m=e.s("span","synced");R(l,!1);R(m,!1);f=e.s("div","header",[f,k,l,m]);d=e.s("a",{"class":"import",href:"#import"},
"Add to "+d);d.style.zIndex=1E3;d=e.s("div",{"class":"import"},d);g.appendChild(d);g.appendChild(f);c=new qv(c,null,e);a.R(c,!0);return b};
rv.prototype.refresh=function(a,b){var c=a.querySelector(".import"),d=a.querySelector(".header"),e=a.querySelector(".title"),f=c.nextElementSibling,c=c.querySelector("a"),g=a.querySelector("a.link"),f=f.querySelector(".synced");b.tf||b.gg?R(a,!0):R(a,!1);R(d,!!b.title);e.textContent=b.title;b.tf?e.href=b.tf:e.removeAttribute("href");c.textContent=b.gg;c.setAttribute("title",b.hg);(g.textContent=b.ef)?(g.setAttribute("title",b.hg),g.href="#"+b.ef):g.removeAttribute("href");R(f,b.Ch)};function Nu(){Nc.call(this);this.h=this.g=null}B(Nu,Nc);Nu.prototype.J=function(){this.g&&(this.g.qa(),this.h=this.g=null)};function Ou(a,b){a.h=b;a.g=new gf(a);a.g.listen(b,"click",a.i,!0)}Nu.prototype.n=function(){return this.h};Nu.prototype.i=function(a){var b=this.n(),c=this.n();(c.classList.contains("error")?sv:c.href?"n":"v")==sv?(a.preventDefault(),b.textContent="Error reported, thanks.",b.removeAttribute("href"),b.removeAttribute("title"),b.classList.remove("error")):this.dispatchEvent(a)};
var sv="e";function Qu(a,b,c,d){a=a.n();a.classList.remove("error");c?a.href=c:a.removeAttribute("href");b?(a.textContent=b,R(a,!0)):R(a,!1);d?a.setAttribute("title",d):a.removeAttribute("title")}function Tu(a,b,c){a=a.n();a.classList.add("error");a.href="#error";a.textContent="error";b&&b instanceof Error&&(b=b.name+": "+b.message);a.setAttribute("title","Click to report error"+(b?" for "+b:""));c&&gd().send("log-bug",c)};function tv(a,b){At.call(this,null,null,a);this.ba(b);this.h=new Nu;this.o=new Nu}B(tv,At);h=tv.prototype;h.logger=P("ydn.crm.inj.sugar.module.GDataPanel");h.ra=function(){return Ng("record-content",this.n())};
h.M=function(){tv.m.M.call(this);var a=this.n();Ou(this.h,Og(document,"A","import",a)[0]);Ou(this.o,Og(document,"A","link",a)[0]);Ks(this).listen(this.h,"click",this.Rh,!1);Ks(this).listen(this.o,"click",this.Sh,!1);a=this.w;Ks(this).listen(a,["record-change"],this.refresh);Ks(this).listen(a.parent,["gdata-change"],this.refresh)};h.refresh=function(){var a=this.w,b=Ng("record-header",this.n());this.i.refresh(b,uv(this));b=this.ra();R(b,!!a.pa())};
function uv(a){a=a.w;var b=a.p(),c=b?null:a.j(),d=a.o(),e=a.pa(),f=$(a),g="",k=null,l=!1,m="",n="",p="",r="";d&&(m="Add to "+f,n="Add current contact "+d.g+" to SugarCRM "+f,e&&e.g?(g=Wq(e),k=tq(e.domain,e.module,e.F()),n=m="",p="export",r="Export this SugarCRM "+f+" to Gmail My Contacts address book",b&&(a.G()?(l=!0,r=p=""):(p="link",r="Link Gmail contact "+Dp(b)+" with this SugarCRM "+f+" "+e.F()))):c&&(m+=" and sync",n+=" and then synchronize between the two records.",r=p=""));return{title:g,tf:k,
gg:m,hg:n,Ch:l,ef:p,li:r}}h.Sh=function(){var a=this.w;Qu(this.o,"Linking...");a.g().A(function(){Qu(this.o,"Done.");this.dispatchEvent(new H("record-change"))},function(a){a=a instanceof Error?a.name+" "+a.message:y(a)?yh(a):a;var c=ih(this.n());Tu(this.o,a,{"class":"RecordHeader",method:"handleLinkClick",context:"link",html:c?c.outerHTML:"",error:a})},this)};
h.Rh=function(){var a=this.w;Qu(this.h,"Adding... to "+$(a));var b;a.j()?b=a.t().B(function(){Qu(this.h,"Linking GData and SugarCRM...");return a.g()},this):(b=a.l(),b=b.B(function(){return a.g()},this));b.A(function(){Qu(this.h,null);this.dispatchEvent(new H("change",this))},function(a){a=a instanceof Error?a.name+" "+a.message:y(a)?yh(a):a;var b=ih(this.n());Tu(this.h,a,{"class":"RecordHeader",method:"handleImportClick",context:"link",html:b?b.outerHTML:"",error:a})},this)};wt(tv,rv);function vv(a,b){var c;c=a.replace("@","%40");c="http://www.google.com/m8/feeds/contacts/"+c+"/base/"+ ++xv;b.id={$t:c};Jr.call(this,b)}B(vv,Pr);var xv=0;function yv(a,b,c){wu.call(this,b,new Tq(b.L(),c));this.g=null;this.j=a}B(yv,wu);yv.prototype.logger=P("ydn.crm.sugar.model.GData");
function zv(a,b,c,d,e){if(b){var f=[{store:$(a),index:"id",key:b}];Hu(a.parent).send("list",f).A(function(a){(a=a[0])&&a.result[0]?Au(this,new Tq(this.L(),$(this),a.result[0])):(L(this.logger,"record id "+b+" not in "+$(this)),zv(this,null,c,d,e))},function(a){throw a;},a)}else f=[{store:$(a),index:"ydn$emails",key:c}],Hu(a.parent).send("list",f).B(function(a){(a=a[0])&&a.result[0]&&Au(this,new Tq(this.L(),$(this),a.result[0]))},a)}
yv.prototype.update=function(a,b,c){Au(this,null);if(a){var d={gd$email:[{address:a}]};b&&(d.gd$name={gd$fullName:{$t:b}});c&&(d.gd$phoneNumber=[{$t:c}]);this.g=new vv(this.j,d);gd().send("gdata-list-contact-by-email",a).A(function(d){var f=null;d&&1<=d.length&&(this.g=d.map(function(a){return new Pr(a)})[0],d=pr(this.g,qr,this.L(),$(this)))&&(f=d.Yc);zv(this,f,a,b,c);this.dispatchEvent(new Fu($(this),0,0,this))},function(d){zv(this,null,a,b,c);throw d;},this)}else this.g=null,this.dispatchEvent(new Fu($(this),
0,0,this))};function Av(a){var b={module:$(a),kind:a.g.yf(),"gdata-id":a.g.F()};N(a.logger,"sending import-gdata "+JSON.stringify(b));return Hu(a.parent).send("import-gdata",b).B(function(a){a=new Tq(this.L(),$(this),a);N(this.logger,a+" created.");Au(this,a)},a)}
function Bv(a){a.pa();var b=lc(a.g.data,"gd$name","gd$fullName","$t")||"",c={email1:Qr(a.g)[0],full_name:b};b&&0<b.length&&(b=b.split(/\s/),b[0]&&(c.first_name=b[0]),b[1]&&(c.last_name=b[b.length-1]));b=Rr(a.g);b[0]&&(c.phone_work=b[0]);c={module:$(a),record:c};N(a.logger,"sending put-record "+JSON.stringify(c));return Hu(a.parent).send("put-record",c).B(function(a){a=new Tq(this.L(),$(this),a);N(this.logger,a+" created.");Au(this,a)},a)}
function Cv(a){var b=a.pa();if(!b)return D("no Record to link.");b.F();var c=a.g;if(!c)return D("Not contact data to link.");var d=pr(c,qr,a.L(),$(a),b.F());if(d)return D("Contact "+Dp(c)+" already link to "+d.Yc);b=new Mr(qr,a.L(),$(a),b.F(),+new Date(c.data.updated.$t),Vq(b));c={kind:c.yf(),"gdata-id":c.F(),"external-id":{label:b.module+"#"+b.h+"-"+b.g,value:b.V()}};return Hu(a.parent).send("link",c).B(function(a){this.g=new Pr(a);this.dispatchEvent(new Fu($(this),0,0,this))},a)}
yv.prototype.save=function(){var a=this.pa(),b=Hu(this.parent).send("put-record",a);b.B(function(b){a.g=b},this);return b};yv.prototype.toString=function(){var a="";this.h&&(a+=":"+this.h);var b=this.g;b&&(a+=":"+b);return"RecordModel:"+$(this)+a};function Dv(){this.i=0}var Ev=new Dv;Dv.prototype.render=function(){};Dv.prototype.h=function(){return++this.i};Dv.prototype.ca=function(){return this.i};function Fv(){this.i=0;this.g=document.createElement("div");var a=document.createElement("div");a.className="statusbar";this.g.className="message";a.appendChild(this.g)}B(Fv,Dv);Fv.prototype.render=function(a){a.appendChild(this.g.parentElement)};
Fv.prototype.h=function(a,b){var c=Fv.m.h.call(this,a,b);this.g.g=a;b?this.g.classList.add("error"):this.g.classList.remove("error");return c};function Gv(a,b){Y.call(this,b);this.ba(a)}B(Gv,Y);h=Gv.prototype;h.M=function(){Gv.m.M.call(this);this.n();var a=this.w,b=Ks(this);b.listen(a,"record-change",this.vf);b.listen(a,"record-update",this.vf);this.vf()};h.vf=function(){this.refresh()};h.u=function(){return"record-body"};h.Q=function(){Gv.m.Q.call(this);var a=this.n();a.classList.add(this.u());a.classList.add("view")};h.yg=function(){return null};h.refresh=function(){for(var a=0;a<Qs(this);a++)Z(this,a).refresh()};function Hv(a,b){Y.call(this,b);this.ba(a)}B(Hv,Y);Hv.prototype.u=function(){return"field"};Hv.prototype.Q=function(){Hv.m.Q.call(this);var a=this.n(),b=this.g,c=this.w;a.classList.add(this.u());a.classList.add(c.g);b=b.s("INPUT",{type:"text",name:c.g});a.appendChild(b)};Hv.prototype.refresh=function(){var a=this.w;this.n().querySelector("input").value=ou(a)};function Iv(a,b){Y.call(this,b);this.ba(a)}B(Iv,Y);Iv.prototype.u=function(){return"field"};Iv.prototype.Q=function(){Iv.m.Q.call(this);var a=this.n(),b=this.g,c=this.w;a.classList.add(this.u());a.classList.add(c.g);b=b.s("TEXTAREA",{name:c.g});a.appendChild(b)};Iv.prototype.refresh=function(){var a=this.w;this.n().querySelector("textarea").value=ou(a)};function Jv(a,b){Gv.call(this,a,b)}B(Jv,Gv);Jv.prototype.Q=function(){Jv.m.Q.call(this);this.n();for(var a=this.g,b=this.w,c=Cu(b),d=cv.W(),e=0;e<c.length;e++){var f=c[e],g,k=Du(b,f);/address/i.test(f)?g=new gv(k,a):"email"==f?g=new jv(k,a):"phone"==f?g=new lv(k,a):"name"==f?g=new nv(k,a):g=new dv(k,d,a);this.R(g,!0)}};function Kv(){}da(Kv);function Lv(a){return a.querySelector(".record-footer")}function Mv(a){return a.querySelector(".record-footer button[name=save]")}function Nv(a){var b;b=a.n().querySelector(".record-footer div.message");b.textContent="";b.classList.remove("error");a=Mv(a.n());a.textContent="Save";a.removeAttribute("disabled")};function Ov(){}da(Ov);Ov.prototype.refresh=function(a){var b=a.w;a=a.n().querySelector(".record-header .title");if(xu(b)){a.textContent=b.h.g?Wq(b.h):"";var c;c=b.pa();c=tq(c.domain,c.module,c.F());a.href=c;a.target=b.L()}else a.textContent="",a.href=""};function Pv(a){return a.querySelector(".record-header")};function Qv(a,b){Gv.call(this,a,b)}B(Qv,Gv);Qv.prototype.Q=function(){Qv.m.Q.call(this);var a=this.g,b=this.w,c=Du(b,"name"),b=Du(b,""),c=uu(c,"name"),b=uu(b,"description");this.R(new Hv(c,a),!0);this.R(new Iv(b,a),!0)};
Qv.prototype.yg=function(a){var b=Z(this,0).n().querySelector("input").value,c=Z(this,1).n().querySelector("textarea").value;if(!b)return Ev.h("Note title required.",!0),null;b={name:b,description:c};if(a=a.o)a=a.w,b.parent_type=$(a),b.parent_id=a.F(),b.parent_name=a.value("name");return b};function Rv(a,b){Y.call(this,b);this.ba(a)}B(Rv,Y);Rv.prototype.u=function(){return"secondary"};Rv.prototype.Q=function(){Rv.m.Q.call(this);this.n().classList.add(this.u())};Rv.prototype.M=function(){Rv.m.M.call(this);var a=this.w;if(0<=pq.indexOf($(a))){var b=Ks(this);b.listen(a,"record-change",this.h);b.listen(a,"record-change",this.h);this.h()}};
Rv.prototype.h=function(){for(;this.ya&&0!=this.ya.length;){var a=Z(this,0);this.tc(a,!0);a.qa()}a=this.w;if(xu(a)){var b=a.pa(),c=a.parent,a=[{store:"Notes",index:"parent",reverse:!0,keyRange:nj([$(a),b.F()])}];c.send("list",a).A(function(a){for(var b=0;b<a.length;b++){var f=a[b];f.result&&0<f.result.length&&(f=new wu(this.w.parent,new Tq(c.L(),"Notes",f.result[0])),f=new Sv(f,this.g),this.R(f,!0))}},function(a){throw a;},this)}};function Sv(a,b,c){Y.call(this,b);this.ba(a);this.o=c||null;this.i=Ov.W();this.h=Tv(this);this.j=new Rv(a,b);Kv.W()}B(Sv,Y);h=Sv.prototype;h.logger=P("ydn.crm.ui.sugar.record.Record");h.u=function(){return"record-panel"};function Tv(a){var b=a.w;a=a.g;return"Notes"==$(b)?new Qv(b,a):new Jv(b,a)}h.ra=function(){return this.n().querySelector(".content")};
h.Q=function(){Sv.m.Q.call(this);var a=this.n(),b=this.g;a.classList.add(this.u());var c=b.s("div","record-header"),d=b.s("div","content");a.appendChild(c);a.appendChild(d);var c=Pv(this.n()),d=this.g,e=this.w,f=d.s("div","record-header");c.appendChild(f);var e=$(e),g=d.s("a","title"),k=d.s("span","icon",e.substr(0,2));f.appendChild(k);f.appendChild(g);f.classList.add(e);e=d.s("a",{href:"#link","class":"link"},"link");g=d.s("span","synced");R(e,!1);R(g,!1);e=d.s("div","toolbar");e.appendChild(d.s("a",
{name:"Notes","class":"new-item",href:"#new-Notes"},"Add Note"));e.appendChild(d.s("a",{name:"edit",href:"#edit"},"edit"));e.appendChild(d.s("a",{name:"detail",href:"#detail"},"detail"));c.appendChild(f);c.appendChild(e);this.R(this.h,!0);this.R(this.j,!0);b=b.s("div","record-footer");a.appendChild(b);c=this.g;a=Lv(this.n());b=c.s("button",{type:"button",name:"save"},"Save");c=c.s("div","message");a.appendChild(b);a.appendChild(c)};
h.M=function(){Sv.m.M.call(this);var a=Ks(this),b=this.w;a.listen(b,"click",this.dg,!1);a.listen(Mv(this.n()),"click",this.th,!0);a.listen(b,"record-change",this.dg);a.listen(b,"gdata-change",this.eg);a.listen(b,"record-change",this.eg);a.listen(b,"record-update",this.sh);a.listen(this.n(),"click",this.gh,!1);a.listen(this.n(),"dblclick",this.ih,!1);Uv(this)};
h.gh=function(a){this.n().classList.add("activated");var b=a.target.getAttribute("name");a.target.classList.contains("new-item")?(a.preventDefault(),a=this.w.parent,b=new wu(a,new Tq(a.L(),nq[nq.indexOf(b)])),b=new Sv(b,this.g,this),this.j.R(b,!0),Vv(b,!0)):"detail"==b?(a.preventDefault(),a=this.n(),b=this.h.n(),a=a.querySelector("a[name=detail]"),"detail"!=a.textContent?(a.textContent="detail",b.classList.remove("detail")):(a.textContent="less",b.classList.add("detail"))):"edit"==b&&(a.preventDefault(),
b=this.h.n().classList.contains("edit"),Vv(this,!b))};h.ih=function(){};function Vv(a,b){var c=a.h;b?(c.n().classList.add("edit"),c.n().classList.remove("view")):(c.n().classList.remove("edit"),c.n().classList.add("view"));c=Lv(a.n());b?(c.classList.add("edit"),c.classList.remove("view")):(c.classList.remove("edit"),c.classList.add("view"));b?a.n().classList.remove("empty"):xu(a.w)&&a.n().classList.add("empty")}
h.th=function(a){var b=a.target;if(a=this.h.yg(this)){b.textContent="saving...";b.setAttribute("disabled","1");var c=this.w;Uq(c.pa(),a);c.save().A(function(){Ev.h("saved",void 0);Vv(this,!1);b.textContent="Save";b.removeAttribute("disabled")},function(a){b.textContent="Save";Ev.h("error saving "+a.message,!0)},this)}};h.dg=function(){Uv(this);this.tc(this.h,!0);this.h.qa();this.h=Tv(this);this.hd(this.h,0,!0)};h.eg=function(){Uv(this)};h.sh=function(){this.refresh()};
function Uv(a){var b=a.w;a.n().classList.remove("activated");var c=a.i,d=a.n().querySelector("a[name=detail]");d.textContent="detail";R(d,!0);for(var d=0<=qq.indexOf($(a.w)),e=a.n().querySelectorAll(".new-item"),f=e.length-1;0<=f;f--)R(e[f],d);d=a.w;e=$(d);f=Pv(a.n());Ng("icon",f).textContent=e.substring(0,2);e=f.querySelector("a[name=edit]");R(e,0<=sq.indexOf($(d)));c.refresh(a);Nv(a);xu(b)?a.n().classList.remove("empty"):a.n().classList.add("empty")}
h.refresh=function(){xu(this.w)?this.n().classList.remove("empty"):this.n().classList.add("empty");this.i.refresh(this);Nv(this)};h.toString=function(){return"ydn.crm.ui.sugar.record.Record:"+this.w};function Wv(a,b){Y.call(this,b);this.ba(a);this.h=new Nu;this.i=new Nu}B(Wv,Y);h=Wv.prototype;h.logger=P("ydn.crm.ui.GDataPanel");h.ra=function(){return Ng("record-content",this.n())};
h.Q=function(){Wv.m.Q.call(this);var a=this.n(),b=this.w,c=$(b),d=this.g,e=d.s("div","record-root");a.appendChild(e);var a=d.s("div","record-header"),f=d.s("div","record-content");e.appendChild(a);e.appendChild(f);e.classList.add(c);d.s("span",{"class":"icon"},c.substr(0,2));c=d.s("a",{"class":"import",href:"#import"},"Add to "+c);c.style.zIndex=1E3;c=d.s("div",{"class":"import"},c);a.appendChild(c);b=new Sv(b,d);this.R(b,!0)};
h.M=function(){Wv.m.M.call(this);var a=this.n(),b=Ks(this),c=this.w;Ou(this.h,Og(document,"A","import",a)[0]);b.listen(this.h,"click",this.Uh,!1);b.listen(this.i,"click",this.Vh,!1);b.listen(c,["gdata-change"],this.cg);b.listen(c,"record-change",this.cg)};
h.cg=function(){var a,b;b=this.w;var c=Ng("record-header",this.n());if(xu(b))R(c,!1);else{R(c,!0);a=this.w;var d=a.g,e=a.pa(),f=$(a),g="Add to "+f;b="Add current contact "+(a.g?Qr(a.g)[0]:null)+" to SugarCRM "+f;if(xu(a)){if(b=g="",d&&(f=a.g,!xu(a)||a.g instanceof vv||!pr(f,qr,a.L(),$(a),a.F())))Dp(d),e.F()}else!a.g||a.g instanceof vv||(g="Import to "+f,b="Import existing gmail contact "+(a.g?Qr(a.g)[0]:null)+" to SugarCRM "+f);a=g;c.querySelector(".import").querySelector("a");a?(R(c,!0),Qu(this.h,
a,"#import",b)):R(c,!1)}};h.Vh=function(){var a=this.w;Qu(this.i,"Linking...");Cv(a).A(function(){Qu(this.i,"Done.");this.dispatchEvent(new H("record-change"))},function(a){a=a instanceof Error?a.name+" "+a.message:y(a)?yh(a):a;var c=ih(this.n());Tu(this.i,a,{"class":"RecordHeader",method:"handleLinkClick",context:"link",html:c?c.outerHTML:"",error:a})},this)};
h.Uh=function(){var a=this.w;Qu(this.h,"Adding... to "+$(a));var b;a.g instanceof vv?b=Bv(a):(b=Av(a),b=b.B(function(){Qu(this.h,"Linking GData and SugarCRM...");return Cv(a)},this));b.A(function(){Qu(this.h,null);this.dispatchEvent(new H("change",this))},function(a){a=a instanceof Error?a.name+" "+a.message:y(a)?yh(a):a;var b=ih(this.n());Tu(this.h,a,{"class":"RecordHeader",method:"handleImportClick",context:"link",html:b?b.outerHTML:"",error:a})},this)};function Xv(a,b,c){Y.call(this,c);this.ba(b);this.i=a;this.h=[]}B(Xv,Y);Xv.prototype.u=function(){return"feed-panel"};Xv.prototype.ra=function(){return Ng("feed-body",this.n())};function Vu(a){for(var b=[],c=0;c<Qs(a);c++){var d=Z(a,c).w;xu(d)&&b.push({module:$(d),id:d.F()})}return b}
Xv.prototype.Q=function(){Xv.m.Q.call(this);var a=this.n(),b=this.g,c=b.s("div","feed-header"),d=b.s("div","feed-body");a.appendChild(c);a.appendChild(d);a=b.s("div","feed-title");c.appendChild(a);for(c=0;c<rq.length;c++){a:{a=rq[c];for(b=0;b<this.h.length;b++)if(d=this.h[b],$(d.w)==a){ab(this.h,b);a=d;break a}a=new yv(this.i,this.w,a);a=new Wv(a,this.g)}this.R(a,!0)}R(this.n(),!1)};Xv.prototype.update=function(a,b,c){R(this.n(),!!a);for(var d=0;d<Qs(this);d++)Z(this,d).w.update(a,b,c)};function Yv(){}B(Yv,ht);da(Yv);Yv.prototype.u=function(){return"goog-menuheader"};function Zv(a,b,c){At.call(this,a,c||Yv.W(),b);Gt(this,1,!1);Gt(this,2,!1);Gt(this,4,!1);Gt(this,32,!1);this.Hb=1}B(Zv,At);yt("goog-menuheader",function(){return new Zv(null)});function $v(){this.h=[]}B($v,ht);da($v);function aw(a,b){var c=a.h[b];if(!c){switch(b){case 0:c=a.u()+"-highlight";break;case 1:c=a.u()+"-checkbox";break;case 2:c=a.u()+"-content"}a.h[b]=c}return c}h=$v.prototype;h.Gb=function(){return"menuitem"};h.Y=function(a){var b=a.g.s("div",jt(this,a).join(" "),bw(this,a.oa(),a.g));cw(this,a,b,!!(a.ma&8)||!!(a.ma&16));kt(this,a,b);return b};h.za=function(a){return a&&a.firstChild};
h.ua=function(a,b){var c=Yg(b),d=aw(this,2);c&&st(c,d)||b.appendChild(bw(this,b.childNodes,a.g));st(b,"goog-option")&&(Gt(a,16,!0),(c=a.n())&&dw(a.i,a,c),dw(this,a,b));return $v.m.ua.call(this,a,b)};h.$b=function(a,b){var c=this.za(a),d=ew(this,a)?c.firstChild:null;$v.m.$b.call(this,a,b);d&&!ew(this,a)&&c.insertBefore(d,c.firstChild||null)};function bw(a,b,c){a=aw(a,2);return c.s("div",a,b)}function dw(a,b,c){c&&(ft(c,"menuitemcheckbox"),cw(a,b,c,!0))}
function ew(a,b){var c=a.za(b);if(c){var c=c.firstChild,d=aw(a,1);return!!c&&y(c)&&1==c.nodeType&&st(c,d)}return!1}function cw(a,b,c,d){d!=ew(a,c)&&(d?tt(c,"goog-option"):vt(c,"goog-option"),c=a.za(c),d?(a=aw(a,1),c.insertBefore(b.g.s("div",a),c.firstChild||null)):c.removeChild(c.firstChild))}h.Kc=function(a){switch(a){case 2:return aw(this,0);case 16:case 8:return"goog-option-selected";default:return $v.m.Kc.call(this,a)}};
h.Ee=function(a){var b=aw(this,0);switch(a){case "goog-option-selected":return 16;case b:return 2;default:return $v.m.Ee.call(this,a)}};h.u=function(){return"goog-menuitem"};function fw(a,b,c,d){At.call(this,a,d||$v.W(),c);this.ba(b)}B(fw,At);h=fw.prototype;h.V=function(){var a=this.w;return null!=a?a:this.pb()};h.pb=function(){var a=this.oa();return u(a)?(a=Ta(a,function(a){return y(a)&&1==a.nodeType&&(st(a,"goog-menuitem-accel")||st(a,"goog-menuitem-mnemonic-separator"))?"":eh(a)}).join(""),xa(a)):fw.m.pb.call(this)};
h.ac=function(a){var b=this.getParent();if(b){var c=b.h;b.h=null;if(b=c&&w(a.clientX))b=new Hg(a.clientX,a.clientY),b=c==b?!0:c&&b?c.x==b.x&&c.y==b.y:!1;if(b)return}fw.m.ac.call(this,a)};h.vc=function(a){return a.g==this.mg&&this.Mb(a)?!0:fw.m.vc.call(this,a)};h.Vg=function(){return this.mg};yt("goog-menuitem",function(){return new fw(null)});function gw(){}B(gw,ht);da(gw);gw.prototype.Y=function(a){return a.g.s("div",this.u())};gw.prototype.ua=function(a,b){b.id&&Js(a,b.id);if("HR"==b.tagName){var c=b;b=this.Y(a);Wg(b,c);Xg(c)}else tt(b,this.u());return b};gw.prototype.$b=function(){};gw.prototype.u=function(){return"goog-menuseparator"};function hw(a,b){At.call(this,null,a||gw.W(),b);Gt(this,1,!1);Gt(this,2,!1);Gt(this,4,!1);Gt(this,32,!1);this.Hb=1}B(hw,At);hw.prototype.M=function(){hw.m.M.call(this);var a=this.n();ft(a,"separator")};yt("goog-menuseparator",function(){return new hw});function iw(){}B(iw,Mt);da(iw);h=iw.prototype;h.Cd=function(){return"menu"};h.Le=function(a){return"UL"==a.tagName||iw.m.Le.call(this,a)};h.Lc=function(a){return"HR"==a.tagName?new hw:iw.m.Lc.call(this,a)};h.u=function(){return"goog-menu"};h.Ne=function(a){iw.m.Ne.call(this,a);a=a.n();gt(a,"haspopup","true")};yt("goog-menuseparator",function(){return new hw});function jw(a,b){Tt.call(this,St,b||iw.W(),a);bu(this,!1)}B(jw,Tt);h=jw.prototype;h.ne=!0;h.u=function(){return this.vb.u()};h.yd=function(){var a=[];Ps(this,function(b){a.push(b)});return a};h.Rc=function(a,b,c){(b=jw.m.Rc.call(this,a,b))&&a&&this.$&&this.ne&&Ut(this).focus();a&&c&&w(c.clientX)?this.h=new Hg(c.clientX,c.clientY):this.h=null;return b};h.Ue=function(a){this.ne&&Ut(this).focus();return jw.m.Ue.call(this,a)};h.Qf=function(a){return a.isEnabled()&&a.Da&&!!(a.ma&2)};
h.Tb=function(a){for(var b=this.vb,c=Og(this.g.g,"div",b.u()+"-content",a),d=c.length,e=0;e<d;e++)Pt(b,this,c[e]);jw.m.Tb.call(this,a)};h.Pe=function(a){var b=jw.m.Pe.call(this,a);b||Ps(this,function(c){!b&&c.Vg&&c.mg==a.g&&(this.isEnabled()&&this.Xa(c),b=c.cb(a))},this);return b};
h.Pb=function(a){jw.m.Pb.call(this,a);if(a=Z(this,a)){var b=a.n();a=this.n();var c=wi(b),d=wi(a),e=Ii(a),f=c.x-d.x-e.left,c=c.y-d.y-e.top,d=a.clientHeight-b.offsetHeight,e=a.scrollLeft,g=a.scrollTop,e=e+Math.min(f,Math.max(f-(a.clientWidth-b.offsetWidth),0)),g=g+Math.min(c,Math.max(c-d,0)),b=new Hg(e,g);a.scrollLeft=b.x;a.scrollTop=b.y}};function kw(){}B(kw,gw);da(kw);kw.prototype.Y=function(a){return a.g.s("div",this.u()+" goog-inline-block","\u00a0")};kw.prototype.ua=function(a,b){b=kw.m.ua.call(this,a,b);tt(b,"goog-inline-block");return b};kw.prototype.u=function(){return"goog-toolbar-separator"};function lw(){}B(lw,Mt);da(lw);lw.prototype.Cd=function(){return"toolbar"};lw.prototype.Lc=function(a){return"HR"==a.tagName?new hw(kw.W()):lw.m.Lc.call(this,a)};lw.prototype.u=function(){return"goog-toolbar"};lw.prototype.Wf=function(){return Rt};function mw(a,b,c){Tt.call(this,b,a||lw.W(),c)}B(mw,Tt);function nw(a,b,c,d,e,f,g,k,l){var m,n;if(m=c.offsetParent){var p="HTML"==m.tagName||"BODY"==m.tagName;p&&"static"==si(m,"position")||(n=wi(m),p||(p=(p=xi(m))&&Ib?-m.scrollLeft:!p||F&&Ub("8")||"visible"==si(m,"overflowX")?m.scrollLeft:m.scrollWidth-m.clientWidth-m.scrollLeft,n=Ig(n,new Hg(p,m.scrollTop))))}m=n||new Hg;n=Bi(a);if(p=vi(a)){var r=new qi(p.left,p.top,p.right-p.left,p.bottom-p.top),p=Math.max(n.left,r.left),t=Math.min(n.left+n.width,r.left+r.width);if(p<=t){var x=Math.max(n.top,r.top),
r=Math.min(n.top+n.height,r.top+r.height);x<=r&&(n.left=p,n.top=x,n.width=t-p,n.height=r-x)}}p=Kg(a);x=Kg(c);if(p.g!=x.g){var t=p.g.body,x=Sg(x.g),r=new Hg(0,0),z;z=(z=Mg(t))?Sg(z):window;var G=t;do{var E;if(z==x)E=wi(G);else{var J=G;E=void 0;if(J.getBoundingClientRect)E=ti(J),E=new Hg(E.left,E.top);else{E=kh(Kg(J));var Q=wi(J);E=new Hg(Q.x-E.x,Q.y-E.y)}if(Ib&&!Ub(12)){Q=void 0;F?Q="-ms-transform":Jb?Q="-webkit-transform":Hb?Q="-o-transform":Ib&&(Q="-moz-transform");var ma=void 0;Q&&(ma=si(J,Q));
ma||(ma=si(J,"transform"));J=ma?(J=ma.match(Ji))?new Hg(parseFloat(J[1]),parseFloat(J[2])):new Hg(0,0):new Hg(0,0);E=new Hg(E.x+J.x,E.y+J.y)}}r.x+=E.x;r.y+=E.y}while(z&&z!=x&&(G=z.frameElement)&&(z=z.parent));t=Ig(r,wi(t));F&&!jh(p)&&(t=Ig(t,kh(p)));n.left+=t.x;n.top+=t.y}a=ow(a,b);b=new Hg(a&2?n.left+n.width:n.left,a&1?n.top+n.height:n.top);b=Ig(b,m);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var I;if(g)if(l)I=l;else if(I=vi(c))I.top-=m.y,I.right-=m.x,I.bottom-=m.y,I.left-=m.x;a:{l=b.ga();e=0;
a=ow(c,d);d=zi(c);k=k?k.ga():d.ga();if(f||0!=a)a&2?l.x-=k.width+(f?f.right:0):f&&(l.x+=f.left),a&1?l.y-=k.height+(f?f.bottom:0):f&&(l.y+=f.top);if(g&&(I?(f=l,e=0,65==(g&65)&&(f.x<I.left||f.x>=I.right)&&(g&=-2),132==(g&132)&&(f.y<I.top||f.y>=I.bottom)&&(g&=-5),f.x<I.left&&g&1&&(f.x=I.left,e|=1),f.x<I.left&&f.x+k.width>I.right&&g&16&&(k.width=Math.max(k.width-(f.x+k.width-I.right),0),e|=4),f.x+k.width>I.right&&g&1&&(f.x=Math.max(I.right-k.width,I.left),e|=1),g&2&&(e=e|(f.x<I.left?16:0)|(f.x+k.width>
I.right?32:0)),f.y<I.top&&g&4&&(f.y=I.top,e|=2),f.y<=I.top&&f.y+k.height<I.bottom&&g&32&&(k.height=Math.max(k.height-(I.top-f.y),0),f.y=I.top,e|=8),f.y>=I.top&&f.y+k.height>I.bottom&&g&32&&(k.height=Math.max(k.height-(f.y+k.height-I.bottom),0),e|=8),f.y+k.height>I.bottom&&g&4&&(f.y=Math.max(I.bottom-k.height,I.top),e|=2),g&8&&(e=e|(f.y<I.top?64:0)|(f.y+k.height>I.bottom?128:0)),g=e):g=256,e=g,e&496)){c=e;break a}f=Ib&&(Cb||Lb)&&Ub("1.9");l instanceof Hg?(g=l.x,l=l.y):(g=l,l=void 0);c.style.left=yi(g,
f);c.style.top=yi(l,f);d==k||d&&k&&d.width==k.width&&d.height==k.height||(f=jh(Kg(Mg(c))),!F||f&&Ub("8")?(c=c.style,Ib?c.MozBoxSizing="border-box":Jb?c.WebkitBoxSizing="border-box":c.boxSizing="border-box",c.width=Math.max(k.width,0)+"px",c.height=Math.max(k.height,0)+"px"):(g=c.style,f?(F?(f=Fi(c,"paddingLeft"),d=Fi(c,"paddingRight"),l=Fi(c,"paddingTop"),I=Fi(c,"paddingBottom"),f=new pi(l,d,I,f)):(f=ri(c,"paddingLeft"),d=ri(c,"paddingRight"),l=ri(c,"paddingTop"),I=ri(c,"paddingBottom"),f=new pi(parseFloat(l),
parseFloat(d),parseFloat(I),parseFloat(f))),c=Ii(c),g.pixelWidth=k.width-c.left-f.left-f.right-c.right,g.pixelHeight=k.height-c.top-f.top-f.bottom-c.bottom):(g.pixelWidth=k.width,g.pixelHeight=k.height)));c=e}return c}function ow(a,b){return(b&4&&xi(a)?b^2:b)&-5};function pw(){}pw.prototype.l=function(){};function qw(a,b,c){this.g=a;this.h=b;this.p=c}B(qw,pw);qw.prototype.l=function(a,b,c){nw(this.g,this.h,a,b,void 0,c,this.p)};function rw(a,b,c,d){qw.call(this,a,b);this.i=c?5:0;this.j=d||void 0}B(rw,qw);rw.prototype.o=function(){return this.i};rw.prototype.l=function(a,b,c,d){var e=nw(this.g,this.h,a,b,null,c,10,d,this.j);if(e&496){var f=sw(e,this.h);b=sw(e,b);e=nw(this.g,f,a,b,null,c,10,d,this.j);e&496&&(f=sw(e,f),b=sw(e,b),nw(this.g,f,a,b,null,c,this.i,d,this.j))}};function sw(a,b){a&48&&(b^=2);a&192&&(b^=1);return b};function tw(a,b,c,d){rw.call(this,a,b,c||d);if(c||d)this.i=65|(d?32:132)}B(tw,rw);function uw(){}B(uw,ht);da(uw);h=uw.prototype;h.Gb=function(){return"button"};h.Ra=function(a,b,c){switch(b){case 8:case 16:gt(a,"pressed",c);break;default:case 64:case 1:uw.m.Ra.call(this,a,b,c)}};h.Y=function(a){var b=uw.m.Y.call(this,a);this.Qb(b,a.ub());var c=a.V();c&&this.Je(b,c);a.ma&16&&this.Ra(b,16,ot(a,16));return b};h.ua=function(a,b){b=uw.m.ua.call(this,a,b);var c=this.V(b);a.N=c;a.Xd(this.ub(b));a.ma&16&&this.Ra(b,16,ot(a,16));return b};h.V=ca;h.Je=ca;h.ub=function(a){return a.title};
h.Qb=function(a,b){a&&b&&(a.title=b)};h.u=function(){return"goog-button"};function vw(){}B(vw,uw);da(vw);h=vw.prototype;h.Gb=function(){};h.Y=function(a){Bt(a,!1);It(a);Gt(a,32,!1);return a.g.s("button",{"class":jt(this,a).join(" "),disabled:!a.isEnabled(),title:a.ub()||"",value:a.V()||""},a.pb()||"")};h.Dd=function(a){return"BUTTON"==a.tagName||"INPUT"==a.tagName&&("button"==a.type||"submit"==a.type||"reset"==a.type)};h.ua=function(a,b){Bt(a,!1);It(a);Gt(a,32,!1);if(b.disabled){var c=this.Kc(1);tt(b,c)}return vw.m.ua.call(this,a,b)};
h.ag=function(a){Ks(a).listen(a.n(),"click",a.Mb)};h.Ed=ca;h.Re=ca;h.Qe=function(a){return a.isEnabled()};h.uc=ca;h.U=function(a,b,c){vw.m.U.call(this,a,b,c);(a=a.n())&&1==b&&(a.disabled=c)};h.V=function(a){return a.value};h.Je=function(a,b){a&&(a.value=b)};h.Ra=ca;function ww(a,b,c){At.call(this,a,b||vw.W(),c)}B(ww,At);h=ww.prototype;h.V=function(){return this.N};h.Zf=function(a){this.N=a;this.i.Je(this.n(),a)};h.ub=function(){return this.G};h.Qb=function(a){this.G=a;this.i.Qb(this.n(),a)};h.Xd=function(a){this.G=a};h.J=function(){ww.m.J.call(this);delete this.N;delete this.G};h.M=function(){ww.m.M.call(this);if(this.ma&32){var a=this.i.Zb(this);a&&Ks(this).listen(a,"keyup",this.vc)}};
h.vc=function(a){return 13==a.g&&"key"==a.type||32==a.g&&"keyup"==a.type?this.Mb(a):32==a.g};yt("goog-button",function(){return new ww(null)});function xw(){}B(xw,uw);da(xw);h=xw.prototype;h.Y=function(a){var b=jt(this,a),b=a.g.s("div",{"class":"goog-inline-block "+b.join(" ")},this.ud(a.oa(),a.g));this.Qb(b,a.ub());kt(this,a,b);return b};h.Gb=function(){return"button"};h.za=function(a){return a&&a.firstChild.firstChild};h.ud=function(a,b){return b.s("div","goog-inline-block "+(this.u()+"-outer-box"),b.s("div","goog-inline-block "+(this.u()+"-inner-box"),a))};h.Dd=function(a){return"DIV"==a.tagName};
h.ua=function(a,b){yw(b,!0);yw(b,!1);var c;a:{c=a.g.Xf(b);var d=this.u()+"-outer-box";if(c&&st(c,d)&&(c=a.g.Xf(c),d=this.u()+"-inner-box",c&&st(c,d))){c=!0;break a}c=!1}c||b.appendChild(this.ud(b.childNodes,a.g));ut(b,["goog-inline-block",this.u()]);return xw.m.ua.call(this,a,b)};h.u=function(){return"goog-custom-button"};
function yw(a,b){if(a)for(var c=b?a.firstChild:a.lastChild,d;c&&c.parentNode==a;){d=b?c.nextSibling:c.previousSibling;if(3==c.nodeType){var e=c.nodeValue;if(""==ya(e))a.removeChild(c);else{c.nodeValue=b?e.replace(/^[\s\xa0]+/,""):e.replace(/[\s\xa0]+$/,"");break}}else break;c=d}};function zw(){}B(zw,xw);da(zw);Ib&&(zw.prototype.$b=function(a,b){var c=zw.m.za.call(this,a&&a.firstChild);if(c){var d;d=Kg(a).s("div","goog-inline-block "+(this.u()+"-caption"),b);var e=c.parentNode;e&&e.replaceChild(d,c)}});h=zw.prototype;h.za=function(a){a=zw.m.za.call(this,a&&a.firstChild);Ib&&a&&a.__goog_wrapper_div&&(a=a.firstChild);return a};h.Ra=function(a,b,c){64!=b&&zw.m.Ra.call(this,a,b,c)};
h.ua=function(a,b){var c=Og(document,"*","goog-menu",b)[0];if(c){R(c,!1);Mg(c).body.appendChild(c);var d=new jw;Os(d,c);a.$c(d)}return zw.m.ua.call(this,a,b)};h.ud=function(a,b){return zw.m.ud.call(this,[b.s("div","goog-inline-block "+(this.u()+"-caption"),a),b.s("div","goog-inline-block "+(this.u()+"-dropdown"),"\u00a0")],b)};h.u=function(){return"goog-menu-button"};function Aw(a,b,c,d){ww.call(this,a,c||zw.W(),d);Gt(this,64,!0);this.o=new tw(null,5);b&&this.$c(b);this.da=new jf(500);!Rh&&!Sh||Ub("533.17.9")||(this.Jd=!0)}B(Aw,ww);h=Aw.prototype;h.Jd=!1;h.M=function(){Aw.m.M.call(this);this.h&&Bw(this,this.h,!0);gt(this.X,"haspopup",!!this.h)};h.ab=function(){Aw.m.ab.call(this);if(this.h){this.la(!1);this.h.ab();Bw(this,this.h,!1);var a=this.h.n();a&&Xg(a)}};h.J=function(){Aw.m.J.call(this);this.h&&(this.h.qa(),delete this.h);delete this.na;this.da.qa()};
h.Sc=function(a){Aw.m.Sc.call(this,a);ot(this,4)&&(this.la(!ot(this,64),a),this.h&&(this.h.Bb=ot(this,64)))};h.ac=function(a){Aw.m.ac.call(this,a);this.h&&!ot(this,4)&&(this.h.Bb=!1)};h.Mb=function(){Ft(this,!1);return!0};h.jh=function(a){this.h&&this.h.Na&&!this.Te(a.target)&&this.la(!1)};h.Te=function(a){var b;if(!(b=a&&Zg(this.n(),a))){if(b=this.h)a:if(b=this.h,Zg(b.n(),a))b=!0;else{for(var c=0,d=Qs(b);c<d;c++){var e=Z(b,c);if("function"==typeof e.Te&&e.Te(a)){b=!0;break a}}b=!1}b=b||!1}return b};
h.vc=function(a){if(32==a.g){if(a.preventDefault(),"keyup"!=a.type)return!0}else if("key"!=a.type)return!1;if(this.h&&this.h.Na){var b=this.h.cb(a);return 27==a.g?(this.la(!1),!0):b}return 40==a.g||38==a.g||32==a.g||13==a.g?(this.la(!0),!0):!1};h.Ve=function(){this.la(!1)};h.ph=function(){ot(this,4)||this.la(!1)};h.Fd=function(a){this.Jd||this.la(!1);Aw.m.Fd.call(this,a)};
h.$c=function(a){var b=this.h;if(a!=b&&(b&&(this.la(!1),this.$&&Bw(this,b,!1),delete this.h),this.$&&gt(this.X,"haspopup",!!a),a)){this.h=a;Ls(a,this);a.Rc(!1);var c=this.Jd;(a.ne=c)&&bu(a,!0);this.$&&Bw(this,a,!0)}return b};h.Se=function(a,b){var c=Aw.m.Se.call(this,a,b);c&&!this.Da&&this.la(!1);return c};h.setEnabled=function(a){Aw.m.setEnabled.call(this,a);this.isEnabled()||this.la(!1)};
h.la=function(a,b){Aw.m.la.call(this,a);if(this.h&&ot(this,64)==a){if(a)this.h.$||this.h.render(),this.Z=vi(this.n()),this.T=Bi(this.n()),Cw(this),this.h.Pb(-1);else{Ft(this,!1);this.h.Bb=!1;var c=this.n();c&&gt(c,"activedescendant","");if(null!=this.p&&(this.p=void 0,c=this.h.n())){var d="",e;d instanceof Jg?(e=d.height,d=d.width):e="";c.style.width=yi(d,!0);c.style.height=yi(e,!0)}}this.h.Rc(a,!1,b);this.H||(c=Ks(this),d=a?c.listen:c.Ca,d.call(c,this.g.g,"mousedown",this.jh,!0),this.Jd&&d.call(c,
this.h,"blur",this.ph),d.call(c,this.da,lf,this.Gh),a?kf(this.da):this.da.stop())}};function Cw(a){if(a.h.$){var b=a.na||a.n(),c=a.o;a.o.g=b;b=a.h.n();a.h.Na||(b.style.visibility="hidden",R(b,!0));!a.p&&a.o.o&&a.o.i&32&&(a.p=zi(b));c.l(b,c.h^1,null,a.p);a.h.Na||(R(b,!1),b.style.visibility="visible")}}
h.Gh=function(){var a=Bi(this.n()),b=vi(this.n()),c=this.T;(c=!(c==a||c&&a&&c.left==a.left&&c.width==a.width&&c.top==a.top&&c.height==a.height))||(c=this.Z,c=!(c==b||c&&b&&c.top==b.top&&c.right==b.right&&c.bottom==b.bottom&&c.left==b.left));c&&(this.T=a,this.Z=b,Cw(this))};function Bw(a,b,c){var d=Ks(a);c=c?d.listen:d.Ca;c.call(d,b,"action",a.Ve);c.call(d,b,"highlight",a.$g);c.call(d,b,"unhighlight",a.ah)}h.$g=function(a){var b=this.n();null!=a.target.n()&&gt(b,"activedescendant",a.target.n().id)};
h.ah=function(){if(!Xt(this.h)){var a=this.n();gt(a,"activedescendant","")}};yt("goog-menu-button",function(){return new Aw(null)});function Dw(a){Nc.call(this);this.g=[];Ew(this,a)}B(Dw,Nc);Dw.prototype.h=null;function Ew(a,b){b&&(Ra(b,function(a){Fw(a,!1)},a),db(a.g,b))}Dw.prototype.yd=function(){return cb(this.g)};function Gw(a){var b=a.h;return b?Qa(a.g,b):-1}Dw.prototype.clear=function(){Za(this.g);this.h=null};Dw.prototype.J=function(){Dw.m.J.call(this);delete this.g;this.h=null};function Fw(a,b){a&&"function"==typeof a.Bc&&a.Bc(b)};function Hw(a,b,c,d){Aw.call(this,a,b,c,d);this.t=this.oa()}B(Hw,Aw);h=Hw.prototype;h.ka=null;h.M=function(){Hw.m.M.call(this);Iw(this);Jw(this)};h.Tb=function(a){Hw.m.Tb.call(this,a);(a=this.pb())?(this.t=a,Iw(this)):this.ka&&Kw(this,this.ka.g[0]||null)};h.J=function(){Hw.m.J.call(this);this.ka&&(this.ka.qa(),this.ka=null);this.t=null};h.Ve=function(a){Kw(this,a.target);Hw.m.Ve.call(this,a);a.Qc();this.dispatchEvent("action")};h.uh=function(){var a=Lw(this);Hw.m.Zf.call(this,a&&a.V());Iw(this)};
h.$c=function(a){var b=Hw.m.$c.call(this,a);a!=b&&(this.ka&&this.ka.clear(),a&&(this.ka?Ps(a,function(a){Mw(a);var b=this.ka,e=b.g.length;a&&(Fw(a,!1),eb(b.g,e,0,a))},this):Nw(this,a)));return b};function Kw(a,b){if(a.ka){var c=Lw(a),d=a.ka;b!=d.h&&(Fw(d.h,!1),d.h=b,Fw(b,!0));d.dispatchEvent("select");b!=c&&a.dispatchEvent("change")}}h.Zf=function(a){if(null!=a&&this.ka)for(var b=0,c;c=this.ka.g[b]||null;b++)if(c&&"function"==typeof c.V&&c.V()==a){Kw(this,c);return}Kw(this,null)};
function Lw(a){return a.ka?a.ka.h:null}function Nw(a,b){a.ka=new Dw;b&&Ps(b,function(a){Mw(a);var b=this.ka,e=b.g.length;a&&(Fw(a,!1),eb(b.g,e,0,a))},a);Jw(a)}function Jw(a){a.ka&&Ks(a).listen(a.ka,"select",a.uh)}function Iw(a){var b=Lw(a),b=b?b.pb():a.t;a.i.$b(a.n(),b);a.wb=b}function Mw(a){a.mf=a instanceof fw?"option":"separator"}h.la=function(a,b){Hw.m.la.call(this,a,b);ot(this,64)&&(this.h||this.$c(new jw(this.g)),(this.h||null).Pb(this.ka?Gw(this.ka):-1))};yt("goog-select",function(){return new Hw(null)});function Ow(){}B(Ow,zw);da(Ow);Ow.prototype.u=function(){return"goog-toolbar-menu-button"};function Pw(a,b,c,d){Hw.call(this,a,b,c||Ow.W(),d)}B(Pw,Hw);yt("goog-toolbar-select",function(){return new Pw(null)});function Qw(){}B(Qw,ht);da(Qw);h=Qw.prototype;h.Gb=function(){};function Rw(a,b,c,d){var e=d.s("div",a.u()+"-inner-box"),f=d.s("div",a.u()+"-clear","\u00d7");a=d.s("div",a.u()+"-outer-box",[e,f]);d.appendChild(b,a);d.appendChild(e,c)}h.ua=function(a,b){var c=a.g,d=b;b=c.s("div","goog-inline-block");c.Bh(b,d);Rw(this,b,d,c);Qw.m.ua.call(this,a,b);a.wb=d.value;return b};
h.Y=function(a){var b=a.g,c=b.s("div","goog-inline-block "+jt(this,a).join(" "));a=b.s("input",{type:"text",value:a.oa()||"",disabled:!a.isEnabled()});Rw(this,c,a,b);return c};h.Dd=function(a){return"INPUT"==a.tagName&&(!a.type||"TEXT"==a.type.toUpperCase())};h.za=function(a){if(a)a:{a=a.getElementsByTagName("input");for(var b=0;b<a.length;++b){var c=a[b];if(!c.type||"TEXT"==c.type.toUpperCase()){a=c;break a}}a=null}else a=null;return a};h.Zb=function(a){return this.za(a.n())};h.Re=ca;h.Qe=function(a){return a.isEnabled()};
h.uc=ca;h.U=function(a,b,c){Qw.m.U.call(this,a,b,c);1==b&&(a=this.za(a.n()))&&(a.disabled=c)};h.Ra=ca;h.$b=function(a,b){var c=this.za(a);c&&(c.value=b)};h.oa=function(a){return(a=this.za(a))?a.value:null};h.u=function(){return"wgui-textinput"};function Sw(a,b,c){At.call(this,a,b||Qw.W(),c);Bt(this,!1);Dt(this);It(this);Gt(this,32,!1);a||(this.wb="")}B(Sw,At);h=Sw.prototype;h.M=function(){Sw.m.M.call(this);var a=this.i.Zb(this);if(a){var b=this.j||(this.j=new Xs);Ys(b,a);Ks(this).listen(b,"key",this.cb)}(a=Ng(this.i.u()+"-clear",this.n()))&&Ks(this).listen(a,"click",this.fh)};h.fh=function(a){a.preventDefault();this.i.$b(this.n(),"");this.wb="";this.dispatchEvent(new H("action",this))};
h.oa=function(){return this.n()?this.i.oa(this.n()):null};h.V=function(){return this.oa()};h.pb=function(){return this.oa()||""};function Tw(a,b){this.result=b;wu.call(this,a,new Tq(a.L(),b.storeName,b.record));this.h.g||Uw(this)}B(Tw,wu);function Uw(a){a.parent.send("list",[{store:a.result.storeName,index:"id",key:a.result.primaryKey}]).B(function(a){a=a[0].result;a[0]&&Au(this,new Tq(this.parent.L(),nq[nq.indexOf(this.result.storeName)],a[0]))},a)}function Vw(a,b){b&&(a.result=b,b.record?Au(a,new Tq(a.L(),b.storeName,b.record)):b.storeName&&s(b.primaryKey)&&Uw(a))}
Tw.prototype.clear=function(){this.Ka()||(Au(this,null),this.result=null)};Tw.prototype.toString=function(){return"ydn.crm.sugar.model.ResultRecord:"+this.h};Tw.prototype.Ka=function(){return!xu(this)&&!this.result};function Ww(a,b){Y.call(this,a);this.ba(b);this.i=new Y(a);this.h=null;this.j=[];this.o=0}B(Ww,Y);h=Ww.prototype;h.u=function(){return"search-panel"};
h.Q=function(){Ww.m.Q.call(this);var a=this.g,b=this.n();b.classList.add(this.u());var c=a.s("div","header");b.appendChild(c);this.h=new mw(null,null,a);for(var d=new jw(a),e=0;e<oq.length;e++)d.R(new fw(oq[e]),!0);d=new Pw("Module",d,null,a);this.h.R(d,!0);this.h.R(new Sw(""),!0);this.h.render(c);d.Se(!1);a=a.s("div","content");b.appendChild(a);this.R(this.i,!0)};h.M=function(){Ww.m.M.call(this);var a=Z(this.h,1);Ks(this).listen(a,"action",this.Yh,!0)};
function Xw(a,b){if(b){for(var c=Qs(a.i),d=0;d<c;d++){var e=Z(a.i,d).w;if(e.Ka()){Vw(e,b);return}}30<c?(e=Z(a.i,0).w,Vw(e,b)):(c=new Tw(a.w,b),c=new Sv(c,a.g),a.i.R(c,!0))}}function Yw(a,b,c,d){Ju(a.w,b,c,d).A(function(a){a=a[0];if(a.result[0]){var b=a.result[0];Xw(this,{storeName:nq[nq.indexOf(a.store)],primaryKey:b.id,record:b,value:d,tokens:[{keyPath:c}]})}Zw(this)},function(a){Zw(this);throw a;},a)}
function $w(a){var b=a+0.1,c=["rgb(255, 255, 255) 0%"];99>a&&(c[1]="rgb(135, 224, 253) "+a.toFixed(1)+"%",c[2]="rgb(255, 255, 255) "+b.toFixed(1)+"%");c.push("rgb(255, 255, 255) 100%");return"linear-gradient(to right, "+c.join(", ")+")"}function ax(a,b){0==a.o&&(a.o=b);var c=100*(a.o-b)/a.o,d=Z(a.h,1).n();Og(document,"input",null,d)[0].style.background=$w(c)}
function Zw(a){var b=a.j[0];if(b){b.Fa++;ax(a,4*(a.j.length-1)+(4-b.Fa));var c=a.w;0==b.Fa?Yw(a,b.module,"id",b.Pa):1==b.Fa?Yw(a,b.module,"ydn$emails",b.Pa):2==b.Fa?(c=b.Pa.match(/\d/g),3>(c?c.length:0)?Zw(a):Yw(a,b.module,"ydn$phones",b.Pa)):3==b.Fa?Ku(c,b.module,b.Pa).A(function(a){a=a[0].fullTextResult;for(var b=a.length||0,c=0;c<b;c++)Xw(this,a[c]);Zw(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&Zw(a))}}
h.Yh=function(){for(var a=Z(this.h,1).oa(),b=Qs(this.i)-1;0<=b;b--)Z(this.i,b).w.clear();this.o=0;if(a&&(a=a.trim(),2<=a.length)){b=(b=Lw(Z(this.h,0)))?b.pb():null;this.j.length=0;if(b)this.j[0]={module:b,Pa:a,Fa:-1};else for(b=0;b<oq.length;b++)this.j[b]={module:oq[b],Pa:a,Fa:-1};Zw(this)}};h.ra=function(){return Ng("content",this.n())};function bx(a,b){Y.call(this,a);this.ba(b)}B(bx,Y);h=bx.prototype;h.logger=P("ydn.crm.ui.sugar.Header");h.u=function(){return"sugar-header"};
h.Q=function(){bx.m.Q.call(this);var a=this.n(),b=this.w,c=this.g;Eg(a,this.u());var d=c.s("a");d.textContent=b.L();d.href=b.g.baseUrl?b.g.baseUrl:"https://"+b.g.domain;d=c.s("div",{"class":"main-title",title:"SugarCRM"},[d]);a.appendChild(d);var d=[],e=chrome.extension.getURL("option-page.html")+"#credentials",e=c.s("a",{href:e,target:"option-page"},"Setup host permission");e.setAttribute("title","Your permission is required to connect your server from this extension. Without permission request to server will be slow.");
d.push(e);d=c.s("div",{"class":"host-permission"},d);a.appendChild(d);var e=c.s("input",{name:"username",type:"text"}),e=c.s("div",null,[e]),f=c.s("input",{name:"password",type:"password"}),f=c.s("div",null,[f]),g=c.s("div","message"),e=c.s("div","login-form",[e,f,g]);R(d,!1);R(e,!1);a.appendChild(e);b=new Ww(c,b);this.R(b);c=c.s("div");a.appendChild(c);b.render(c)};
h.M=function(){bx.m.M.call(this);var a=this.n(),b=Ks(this);this.n().querySelector(".host-permission");a=a.querySelector(".login-form");a=new Xs(a);b.listen(a,"key",this.Xh);b.listen(cd(),"post",function(a){a=a.getMessage();if("update-host-permission"==a.req&&(a=a.data)&&a.origins){a=a.origins;for(var b=this.info.L(),e=0;e<a.length;e++)if((new ud(a[e])).L()==b){N(this.logger,"has host permission on "+b);var f=this.w;f.g.hostPermission=!0;this.ba(f)}}},!1)};
h.Xh=function(a){if(13==a.g){var b=this.n().querySelector(".login-form"),c=this.w;a=b.querySelector("input[name=username]").value;var d=b.querySelector("input[name=password]").value,e=b.querySelector(".message");e.textContent="logging in...";Iu(c,a,d).A(function(){c.isLogin()?(e.textContent="",R(b,!1)):e.textContent="login failed"},function(a){e.textContent="Error: "+a},this)}};h.L=function(){return this.w.L()};function cx(a,b,c){Y.call(this,c);this.ba(b);this.h=a;new Wu(b)}B(cx,Y);h=cx.prototype;h.u=function(){return"sugar-panel"};h.Q=function(){cx.m.Q.call(this);var a=this.g,b=this.n();Eg(b,this.u());b=new bx(a,this.w);this.R(b,!0);a=new Xv(this.h,this.w,a);this.R(a,!0)};h.M=function(){cx.m.M.call(this)};h.logger=P("ydn.crm.ui.sugar.SugarPanel");h.update=function(a,b,c){N(this.logger,"update for "+a);Z(this,1).update(a,b,c)};function dx(){this.g=null;var a=gd().send("user-setting").B(function(){},this),b=gd().send("login-info").A(function(a){a||L(this.logger,"login fail");this.g=a},function(){this.g=null;L(this.logger,"login fail")},this);this.j=pm([a,b])}var ex;dx.prototype.logger=P("ydn.crm.inj.UserSetting");function Uu(){ex||(ex=new dx);return ex}dx.prototype.Cb=function(){return this.j};dx.prototype.i=function(){return this.g.email};
dx.prototype.h=function(a){a=gd("sugarcrm",a);for(var b=[],c=0;c<oq.length;c++){var d=a.send("info-module",oq[c]).B(function(a){var b="",c="",d;for(d in a.module_fields){var l=a.module_fields[d];if(0<=["salutation","name","last_name","first_name","full_name"].indexOf(d))l.group="name";else if(/^email\d?$/.test(d))l.group="email";else if(/^phone?/.test(d))l.group="phone";else if(!l.group&&ta(d,b)){l.group=c;continue}b=d;c=l.group}for(d in a.link_fields)b=a.link_fields[d],"contact"!=d||b.module||(b.module=
"Contacts")},this);b.push(d)}return(new om(b)).B(function(a){for(var b={},c=0;c<oq.length;c++)b[oq[c]]=a[c][1];return b},this)};function fx(a){Y.call(this,a)}B(fx,Y);fx.prototype.Q=function(){fx.m.Q.call(this);var a=this.n(),b=this.g;Eg(a,"sugarcrm-link-panel");b=b.createElement("a");b.textContent="Setup SugarCRM";b.href=chrome.extension.getURL("option-page.html")+"#credentials";b.className="sugarcrm-setup-link";a.appendChild(b);R(a,!1)};fx.prototype.ba=function(a){fx.m.ba.call(this,a);a=u(a)&&0<a.length;R(this.n(),!a)};function gx(a){Y.call(this,a);this.h=Uu()}B(gx,Y);h=gx.prototype;h.u=function(){return"inj"};h.Q=function(){gx.m.Q.call(this);this.n().classList.add(this.u());var a=new fx;this.R(a,!0)};h.M=function(){gx.m.M.call(this)};h.logger=P("ydn.crm.inj.SidebarPanel");
function hx(a,b){var c=b.domain;return a.h.h(c).B(function(a){var e=this.h.g.email;a=new Gu(b,a);e=new cx(e,a,this.g);for(a=0;a<Qs(this);a++){var f=Z(this,a);if(f instanceof cx&&f.w.L()==c)return}N(this.logger,"sugar panel "+c+" created");this.R(e,!0)},a)}h.update=function(a){for(var b=0;b<Qs(this);b++){var c=Z(this,b);c instanceof cx&&(a?c.update(a.g,a.h,null):c.update(null,null,null))}};
h.init=function(){return 1<Qs(this)?tb():gd().send("list-sugarcrm").B(function(a){Z(this,0).ba(a);for(var b=[],c=0;c<a.length;c++){var d;a:{for(d=1;d<Qs(this);d++){var e=Z(this,d);if(e instanceof cx&&e.w.L()==a[c]){d=!0;break a}}d=!1}d||b.push(hx(this,a[c]))}return pm(b)},this)};function ix(){this.g=this.h=null}ix.prototype.init=function(a){this.h=a;a=document.getElementById("user-login");Bc(a,"click",function(a){a.preventDefault();window.open(a.target.href,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=400, top="+(screen.height/2-200)+", left="+(screen.width/2-300));return!0},!0,this)};
function jx(a,b){if(!b||b instanceof Error)a.g=null;else if(a.g=b,a.h){var c=document.getElementById("user-login"),d=document.getElementById("user-name"),e=Ng("login-message",a.h);b instanceof Error?(e.textContent=b.message,R(e,!0),R(c,!1)):a.g.is_login?(c.href=a.g.logout_url,c.textContent="logout",d.textContent=a.g.email,R(e,!1),R(c,!1)):(c.href=a.g.login_url,c.textContent="login",c.style.display="",d.textContent="",R(e,!0),R(c,!0))}};function kx(){this.g=document.createElement("div");document.body.appendChild(this.g);R(this.g,!1);this.j=new jf(400);Bc(this.j,lf,this.zh,!0,this);this.i=0;this.t="";ed("gmail");this.h=new gx;this.h.render(this.g);this.p=!1;var a=this.history=new Fs,b=Hd(new ud(document.location.href))+"/";a.Ih=b;Bc(this.history,"navigate",this.mh,!1,this);this.H=null;this.l=!1;new ju;this.o=new ix}h=kx.prototype;h.logger=P("ydn.crm.inj.App");h.isLogin=function(){return this.l};
h.zh=function(){this.i++;this.t!=location.href&&(L(this.logger,"url already changed"),this.j.stop());40<this.i&&(L(this.logger,"sniff give up after "+this.i),this.j.stop());var a;this.h.n();a=(a=document.querySelector('table[role="presentation"]'))?a.querySelector("tr").children[2].querySelector("table"):null;if(a&&!this.p){for(var b,c=a,d=0;4>d;d++)if(c&&c.parentElement&&(c=c.parentElement,c.nextElementSibling&&"DIV"==c.nextElementSibling.tagName)){var c=c.parentElement,d=c.lastElementChild,e=!!d.querySelector("a[href]");
b=document.createElement("div");e?c.parentElement.insertBefore(b,d):c.appendChild(b);break}b||(L(this.logger,"usual root position is not available, locating on second best position"),c=a.ownerDocument,b=c.createElement("td"),b.setAttribute("colspan","2"),c=c.createElement("tr"),c.className="widget-topraw",c.appendChild(b),(a.querySelector("tbody")||a).appendChild(c));c=this.g;c.parentElement&&c.parentElement.removeChild(c);b.appendChild(c);R(c,!0);this.p=!0;R(this.g,!0)}a:if(c=5<this.i,b=a.querySelector("img[jid]")){for(a=
b.getAttribute("jid");b&&"TD"!=b.tagName;)b=b.parentElement;b=b.nextElementSibling.querySelector("span[title]").getAttribute("title");a=new mu(a,b)}else{if(c&&(a=a.querySelector("span[title]"))&&(b=a.getAttribute("title").trim(),0<b.length&&(a=document.querySelector('span[name="'+b+'"][email]')))){a=a.getAttribute("email");a=new mu(a,b);break a}a=null}a&&(this.j.stop(),this.h.update(a))};h.mh=function(a){a.g!=this.H&&(this.H=a.g,/^contact/.test(a.g)||/\w+\/[\w\d]{10,18}$/.test(a.g)&&this.update())};
h.update=function(){O(this.logger,"updating sidebar");this.i=0;this.t=location.href;this.p=!1;R(this.g,!0);this.h.update(null);kf(this.j)};h.init=function(){N(this.logger,"init "+this);lx(this);var a=window.setInterval(function(){document.querySelector('a[href="http://mail.google.com/mail/help/terms.html"]')&&window.clearTimeout(a)},500);window.setTimeout(function(){window.clearTimeout(a)},15E3)};h.toString=function(){return"inj.Main:0.7.13"};
function lx(a){gd().send("login-info").A(function(a){a:{if(a&&a.email){O(this.logger,"user "+a.email+" login");this.l=!0;var c=this.o.g;if(c&&c.email==a.email)break a;this.h.init();this.history.setEnabled(!0)}else this.l&&(this.l=!1,this.history.setEnabled(!1));jx(this.o,a)}},function(a){L(this.logger,a.name+" "+a.message);jx(this.o,a)},a)}h.Qh=function(){return{sidebar:this.h,setting:this.o}};qa("ydn.crm.version","0.7.13");qa("runInjApp",function(){Ao();var a=new kx;a.init();return a});qa("runEventApp",function(){Ao();var a=new ys;a.init();ws(a);return a});qa("ydn.crm.ui.StatusBar",Dv);qa("ydn.crm.ui.SimpleStatusBar",Fv);Dv.instance=Ev;ys.prototype.xp=ys.prototype.T;kx.prototype.xp=kx.prototype.Qh;qa("goog.async.Deferred",C);C.prototype.addCallback=C.prototype.B;C.prototype.addErrback=C.prototype.Gc;C.prototype.addBoth=C.prototype.fa;C.prototype.addCallbacks=C.prototype.A;function mx(a){Y.call(this,a);this.h=Uu()}B(mx,Y);h=mx.prototype;h.u=function(){return"inj"};h.Q=function(){mx.m.Q.call(this);this.n().classList.add(this.u());var a=new fx;this.R(a,!0)};h.M=function(){mx.m.M.call(this)};h.logger=P("ydn.crm.ui.SidebarPanel");
function nx(a,b){var c=b.domain;return a.h.h(c).B(function(a){var e=this.h.g.email;a=new Gu(b,a);e=new cx(e,a,this.g);for(a=0;a<Qs(this);a++){var f=Z(this,a);if(f instanceof cx&&f.w.L()==c)return}N(this.logger,"sugar panel "+c+" created");this.R(e,!0)},a)}h.update=function(a){R(this.n(),!0);for(var b=0;b<Qs(this);b++){var c=Z(this,b);c instanceof cx&&(a?c.update(a.g,a.h,null):c.update(null,null,null))}};
h.init=function(){return 1<Qs(this)?tb():gd().send("list-sugarcrm").B(function(a){Z(this,0).ba(a);for(var b=[],c=0;c<a.length;c++){var d;a:{for(d=1;d<Qs(this);d++){var e=Z(this,d);if(e instanceof cx&&e.w.L()==a[c]){d=!0;break a}}d=!1}d||b.push(nx(this,a[c]))}return pm(b)},this)};function ox(a,b){Y.call(this,a);this.ba(b);this.i=new Y(a);this.h=null;this.j=[];this.o=0}B(ox,Y);h=ox.prototype;h.Q=function(){ox.m.Q.call(this);var a=this.g,b=this.n(),c=a.s("div","header");b.appendChild(c);this.h=new mw(null,null,a);for(var d=new jw(a),e=0;e<oq.length;e++)d.R(new fw(oq[e]),!0);d=new Pw("Module",d,null,a);this.h.R(d,!0);this.h.R(new Sw(""),!0);this.h.render(c);a=a.s("div","content");b.appendChild(a);this.R(this.i,!0)};
h.M=function(){ox.m.M.call(this);var a=Z(this.h,1);Ks(this).listen(a,"action",this.Wh,!0)};h.u=function(){return"browse-panel"};function px(a,b){if(b){for(var c=Qs(a.i),d=0;d<c;d++){var e=Z(a.i,d).w;if(e.Ka()){Vw(e,b);return}}30<c?(e=Z(a.i,0).w,Vw(e,b)):(c=new Tw(a.w,b),c=new Sv(c,a.g),a.i.R(c,!0))}}
function qx(a,b,c,d){Ju(a.w,b,c,d).A(function(a){a=a[0];if(a.result[0]){var b=a.result[0];px(this,{storeName:nq[nq.indexOf(a.store)],primaryKey:b.id,record:b,value:d,tokens:[{keyPath:c}]})}rx(this)},function(a){rx(this);throw a;},a)}function sx(a,b){0==a.o&&(a.o=b);var c=100*(a.o-b)/a.o,d=Z(a.h,1).n();Og(document,"input",null,d)[0].style.background=$w(c)}
function rx(a){var b=a.j[0];if(b){b.Fa++;sx(a,4*(a.j.length-1)+(4-b.Fa));var c=a.w;0==b.Fa?qx(a,b.module,"id",b.Pa):1==b.Fa?qx(a,b.module,"ydn$emails",b.Pa):2==b.Fa?(c=b.Pa.match(/\d/g),3>(c?c.length:0)?rx(a):qx(a,b.module,"ydn$phones",b.Pa)):3==b.Fa?Ku(c,b.module,b.Pa).A(function(a){a=a[0].fullTextResult;for(var b=a.length||0,c=0;c<b;c++)px(this,a[c]);rx(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&rx(a))}}
h.Wh=function(){for(var a=Z(this.h,1).oa(),b=Qs(this.i)-1;0<=b;b--)Z(this.i,b).w.clear();this.o=0;if(a&&(a=a.trim(),2<=a.length)){b=(b=Lw(Z(this.h,0)))?b.pb():null;this.j.length=0;if(b)this.j[0]={module:b,Pa:a,Fa:-1};else for(b=0;b<oq.length;b++)this.j[b]={module:oq[b],Pa:a,Fa:-1};rx(this)}};h.ra=function(){return Ng("content",this.n())};function tx(a,b,c){fw.call(this,a,b,c);Gt(this,8,!0);if(a=this.n())b=this.i,a&&(ft(a,"menuitemradio"),cw(b,this,a,!0))}B(tx,fw);tx.prototype.Mb=function(){return this.dispatchEvent("action")};yt("goog-option",function(){return new tx(null)});function ux(){}B(ux,xw);da(ux);ux.prototype.u=function(){return"goog-toolbar-button"};function vx(a,b,c){ww.call(this,a,b||ux.W(),c)}B(vx,ww);yt("goog-toolbar-button",function(){return new vx(null)});function wx(a,b,c,d){Aw.call(this,a,b,c||Ow.W(),d)}B(wx,Aw);yt("goog-toolbar-menu-button",function(){return new wx(null)});function xx(a,b){hw.call(this,a||kw.W(),b)}B(xx,hw);yt("goog-toolbar-separator",function(){return new xx});function yx(a,b,c){ww.call(this,a,b||xw.W(),c);Gt(this,16,!0)}B(yx,ww);yt("goog-toggle-button",function(){return new yx(null)});function zx(a,b,c){yx.call(this,a,b||ux.W(),c)}B(zx,yx);yt("goog-toolbar-toggle-button",function(){return new zx(null)});function Ax(){}B(Ax,ht);da(Ax);Ax.prototype.u=function(){return"record"};Ax.prototype.Y=function(a){return Ax.m.Y.call(this,a)};function Bx(a,b){At.call(this,null,null,a);this.ba(b)}B(Bx,At);wt(Bx,Ax);function Cx(a,b){Y.call(this,a);this.ba(b);this.i=new Y(a);this.h=new Y(a)}B(Cx,Y);Cx.prototype.ra=function(){return Ng("content",this.n())};
Cx.prototype.Q=function(){Cx.m.Q.call(this);var a=this.n(),b;y('<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>')?(Oa('Soy template output is unsafe for use as HTML: <div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>'),
b="zSoyz"):b='<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>';
a.innerHTML=b;Os(new mw,Ng("goog-toolbar",a));this.R(this.i,!0);this.R(this.h,!0);R(this.h.n(),!1)};Cx.prototype.M=function(){Cx.m.M.call(this);this.n()};Cx.prototype.refresh=function(){};qa("ydn.crm.sugar.model.Sugar",Gu);qa("ydn.crm.ui.SidebarPanel",mx);qa("ydn.crm.ui.sugar.SyncPanel",Cx);qa("ydn.crm.ui.sugar.SearchPanel",Ww);qa("ydn.crm.ui.sugar.BrowsePanel",ox);qa("ydn.crm.inj.UserSetting",dx);dx.getInstance=Uu;dx.prototype.getModuleInfo=dx.prototype.h;dx.prototype.getGmail=dx.prototype.i;
Gu.list=function(){var a=Uu();return gd().send("list-sugarcrm").B(function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.isLogin&&c.push(a.h(e.domain).B(function(a){return new Gu(this,a)},e))}return pm(c)})};mx.prototype.update=mx.prototype.update;qa("ydn.msg.Pipe",Xc);qa("ydn.msg.initPipe",ed);qa("ydn.msg.getChannel",gd);Xc.prototype.listen=Xc.prototype.listen;Xc.prototype.getChannel=Xc.prototype.j;$c.prototype.send=$c.prototype.send;})();

            //# sourceMappingURL=https://ydn-src-1.storage.googleapis.com/jsc/ydn.crm-0.7.13.js.map
        