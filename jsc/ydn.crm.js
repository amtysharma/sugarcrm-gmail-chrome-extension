(function(){var h,aa=aa||{},r=this;function ba(a){a=a.split(".");for(var b=r,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}function ca(){}function da(a){a.Y=function(){return a.fg?a.fg:a.fg=new a}}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function t(a){return void 0!==a}function u(a){return"array"==ea(a)}function w(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function x(a){return"string"==typeof a}function fa(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function ga(a){return"function"==ea(a)}function A(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ia(a){return a[ja]||(a[ja]=++ka)}
var ja="closure_uid_"+(1E9*Math.random()>>>0),ka=0;function la(a,b,c){return a.call.apply(a.bind,arguments)}function ma(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function B(a,b,c){B=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?la:ma;return B.apply(null,arguments)}function na(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var D=Date.now||function(){return+new Date};
function oa(a,b){var c=a.split("."),d=r;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function E(a,b){function c(){}c.prototype=b.prototype;a.m=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.Qh=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function pa(a){Error.captureStackTrace?Error.captureStackTrace(this,pa):this.stack=Error().stack||"";a&&(this.message=String(a))}E(pa,Error);pa.prototype.name="CustomError";var qa;function ra(a,b){return 0==a.lastIndexOf(b,0)}function sa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function ta(a){return/^[\s\xa0]*$/.test(a)}function ua(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}function va(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function wa(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}
function xa(a){if(!ya.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(za,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Aa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ba,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ca,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Da,"&#39;"));return a}var za=/&/g,Aa=/</g,Ba=/>/g,Ca=/"/g,Da=/'/g,ya=/[&<>"']/;function Ea(a){return wa(a.replace(/  /g," &#160;"),void 0)}
function Fa(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ga={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ha={"'":"\\'"};
function Ia(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,k;if(!(k=Ga[d])){if(!(31<e&&127>e))if(d in Ha)d=Ha[d];else if(d in Ga)d=Ha[d]=Ga[d];else{e=d;k=d.charCodeAt(0);if(31<k&&127>k)e=d;else{if(256>k){if(e="\\x",16>k||256<k)e+="0"}else e="\\u",4096>k&&(e+="0");e+=k.toString(16).toUpperCase()}d=Ha[d]=e}k=d}f[g]=k}b.push('"');return b.join("")}function Ja(a,b){return a<b?-1:a>b?1:0};function Ka(a,b){b.unshift(a);pa.call(this,sa.apply(null,b));b.shift()}E(Ka,pa);Ka.prototype.name="AssertionError";function La(a,b){throw new Ka("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Ma=Array.prototype,Na=Ma.indexOf?function(a,b,c){return Ma.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(x(a))return x(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Oa=Ma.forEach?function(a,b,c){Ma.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Pa=Ma.filter?function(a,b,c){return Ma.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,g=x(a)?a.split(""):a,k=0;k<d;k++)if(k in g){var l=g[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},Qa=Ma.map?function(a,b,c){return Ma.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=x(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ra=Ma.some?function(a,b,c){return Ma.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},Sa=Ma.every?function(a,b,c){return Ma.every.call(a,b,c)}:function(a,
b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Ta(a,b){var c=Ua(a,b,void 0);return 0>c?null:x(a)?a.charAt(c):a[c]}function Ua(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Va(a,b){return 0<=Na(a,b)}function Wa(a){if(!u(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Xa(a,b){var c=Na(a,b),d;(d=0<=c)&&Ya(a,c);return d}
function Ya(a,b){Ma.splice.call(a,b,1)}function Za(a){return Ma.concat.apply(Ma,arguments)}function $a(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function ab(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(u(d)||(e=w(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,k=0;k<g;k++)a[f+k]=d[k];else a.push(d)}}function bb(a,b,c,d){Ma.splice.apply(a,cb(arguments,1))}
function cb(a,b,c){return 2>=arguments.length?Ma.slice.call(a,b):Ma.slice.call(a,b,c)}function db(a,b,c){for(var d=0,e=a.length,f;d<e;){var g=d+e>>1,k;k=b(c,a[g]);0<k?d=g+1:(e=g,f=!k)}return f?d:~d}function eb(a,b){if(!w(a)||!w(b)||a.length!=b.length)return!1;for(var c=a.length,d=fb,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function gb(a,b){return a>b?1:a<b?-1:0}function fb(a,b){return a===b}function hb(a,b){var c=db(a,ib||gb,b);0>c&&bb(a,-(c+1),0,b)};function jb(){return null}function kb(a){return function(){throw a;}};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function F(a,b){this.l=[];this.K=a;this.I=b||null}h=F.prototype;h.rb=!1;h.Lb=!1;h.Jc=!1;h.Of=!1;h.tf=!1;h.rd=0;function lb(a,b){if(a.rb)a.i instanceof F&&lb(a.i);else{if(a.h){var c=a.h;delete a.h;b?lb(c,b):(c.rd--,0>=c.rd&&lb(c))}a.K?a.K.call(a.I,a):a.tf=!0;a.rb||a.w(new mb)}}h.wd=function(a,b){this.Jc=!1;nb(this,a,b)};function nb(a,b,c){a.rb=!0;a.i=c;a.Lb=!b;a.Ce()}function ob(a){if(a.rb){if(!a.tf)throw new pb;a.tf=!1}}h.u=function(a){ob(this);nb(this,!0,a)};h.w=function(a){ob(this);nb(this,!1,a)};
h.B=function(a,b){return this.t(a,null,b)};h.Ic=function(a,b){return this.t(null,a,b)};h.da=function(a,b){return this.t(a,a,b)};h.t=function(a,b,c){this.l.push([a,b,c]);this.rb&&this.Ce();return this};function qb(a,b){a.t(b.u,b.w,b)}function rb(a){return Ra(a.l,function(a){return ga(a[1])})}
h.Ce=function(){this.n&&this.rb&&rb(this)&&(r.clearTimeout(this.n),delete this.n);this.h&&(this.h.rd--,delete this.h);for(var a=this.i,b=!1,c=!1;this.l.length&&!this.Jc;){var d=this.l.shift(),e=d[0],f=d[1],d=d[2];if(e=this.Lb?f:e)try{var g=e.call(d||this.I,a);t(g)&&(this.Lb=this.Lb&&(g==a||g instanceof Error),this.i=a=g);a instanceof F&&(this.Jc=c=!0)}catch(k){a=k,this.Lb=!0,rb(this)||(b=!0)}}this.i=a;c&&(a.t(B(this.wd,this,!0),B(this.wd,this,!1)),a.Of=!0);b&&(this.n=r.setTimeout(kb(a),0))};
function sb(a){var b=new F;b.u(a);return b}function tb(a){var b=new F;b.w(a);return b}function ub(a){Error.captureStackTrace?Error.captureStackTrace(this,ub):this.stack=Error().stack||"";a&&(this.message=String(a))}E(ub,Error);function pb(){ub.call(this)}E(pb,ub);pb.prototype.message="Deferred has already fired";pb.prototype.name="AlreadyCalledError";function mb(){ub.call(this)}E(mb,ub);mb.prototype.message="Deferred was canceled";mb.prototype.name="CanceledError";function vb(){0!=wb&&(xb[ia(this)]=this)}var wb=0,xb={};vb.prototype.I=!1;vb.prototype.qa=function(){if(!this.I&&(this.I=!0,this.G(),0!=wb)){var a=ia(this);delete xb[a]}};vb.prototype.G=function(){if(this.Vb)for(;this.Vb.length;)this.Vb.shift()()};var yb,zb,Ab,Bb,Cb,Db;function Eb(){return r.navigator?r.navigator.userAgent:null}function Fb(){return r.navigator}Cb=Bb=Ab=zb=yb=!1;var Gb;if(Gb=Eb()){var Hb=Fb();yb=ra(Gb,"Opera");zb=!yb&&(-1!=Gb.indexOf("MSIE")||-1!=Gb.indexOf("Trident"));Bb=(Ab=!yb&&-1!=Gb.indexOf("WebKit"))&&-1!=Gb.indexOf("Mobile");Cb=!yb&&!Ab&&!zb&&"Gecko"==Hb.product}var Ib=yb,H=zb,Jb=Cb,Kb=Ab,Lb=Bb,Mb=Fb();Db=-1!=(Mb&&Mb.platform||"").indexOf("Mac");var Nb=!!Fb()&&-1!=(Fb().appVersion||"").indexOf("X11");
function Ob(){var a=r.document;return a?a.documentMode:void 0}var Pb;a:{var Qb="",Rb;if(Ib&&r.opera)var Sb=r.opera.version,Qb="function"==typeof Sb?Sb():Sb;else if(Jb?Rb=/rv\:([^\);]+)(\)|;)/:H?Rb=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Kb&&(Rb=/WebKit\/(\S+)/),Rb)var Tb=Rb.exec(Eb()),Qb=Tb?Tb[1]:"";if(H){var Ub=Ob();if(Ub>parseFloat(Qb)){Pb=String(Ub);break a}}Pb=Qb}var Vb={};
function Wb(a){var b;if(!(b=Vb[a])){b=0;for(var c=va(String(Pb)).split("."),d=va(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",l=/(\d*)(\D*)/g,m=/(\d*)(\D*)/g;do{var n=l.exec(g)||["","",""],p=m.exec(k)||["","",""];if(0==n[0].length&&0==p[0].length)break;b=Ja(0==n[1].length?0:parseInt(n[1],10),0==p[1].length?0:parseInt(p[1],10))||Ja(0==n[2].length,0==p[2].length)||Ja(n[2],p[2])}while(0==b)}b=Vb[a]=0<=b}return b}
var Xb=r.document,Yb=Xb&&H?Ob()||("CSS1Compat"==Xb.compatMode?parseInt(Pb,10):5):void 0;var Zb=!H||H&&9<=Yb,$b=!H||H&&9<=Yb,ac=H&&!Wb("9");!Kb||Wb("528");Jb&&Wb("1.9b")||H&&Wb("8")||Ib&&Wb("9.5")||Kb&&Wb("528");Jb&&!Wb("8")||H&&Wb("9");function K(a,b){this.type=a;this.i=this.target=b}h=K.prototype;h.qa=function(){};h.Rb=!1;h.ng=!0;h.Rc=function(){this.Rb=!0};h.preventDefault=function(){this.ng=!1};function bc(a){bc[" "](a);return a}bc[" "]=ca;function cc(a,b){K.call(this,a?a.type:"");this.j=this.i=this.target=null;this.g=this.clientY=this.clientX=0;this.l=this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.h=null;a&&this.init(a,b)}E(cc,K);var dc=[1,4,2];
cc.prototype.init=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.i=b;var d=a.relatedTarget;if(d){if(Jb){var e;a:{try{bc(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.j=d;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.g=a.keyCode||0;this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.l=Db?a.metaKey:
a.ctrlKey;this.h=a;a.defaultPrevented&&this.preventDefault();delete this.Rb};function ec(a){return Zb?0==a.h.button:"click"==a.type?!0:!!(a.h.button&dc[0])}cc.prototype.Rc=function(){cc.m.Rc.call(this);this.h.stopPropagation?this.h.stopPropagation():this.h.cancelBubble=!0};cc.prototype.preventDefault=function(){cc.m.preventDefault.call(this);var a=this.h;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,ac)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var fc="closure_listenable_"+(1E6*Math.random()|0);function gc(a){try{return!(!a||!a[fc])}catch(b){return!1}}var hc=0;function ic(a,b,c,d,e){this.hc=a;this.proxy=null;this.src=b;this.type=c;this.td=!!d;this.Ua=e;this.key=++hc;this.removed=this.sd=!1}function jc(a){a.removed=!0;a.hc=null;a.proxy=null;a.src=null;a.Ua=null};function kc(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function mc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function nc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function oc(a,b){for(var c=w(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}function pc(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');a[b]=c}function qc(a,b){return b in a?a[b]:void 0}function rc(a){var b={},c;for(c in a)b[c]=a[c];return b}
function sc(a){var b={},c;for(c in a)b[a[c]]=c;return b}var tc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function uc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<tc.length;f++)c=tc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}
function vc(a){var b=arguments.length;if(1==b&&u(arguments[0]))return vc.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};function wc(a){this.src=a;this.g={};this.h=0}wc.prototype.add=function(a,b,c,d,e){var f=this.g[a];f||(f=this.g[a]=[],this.h++);var g=xc(f,b,d,e);-1<g?(a=f[g],c||(a.sd=!1)):(a=new ic(b,this.src,a,!!d,e),a.sd=c,f.push(a));return a};wc.prototype.remove=function(a,b,c,d){if(!(a in this.g))return!1;var e=this.g[a];b=xc(e,b,c,d);return-1<b?(jc(e[b]),Ya(e,b),0==e.length&&(delete this.g[a],this.h--),!0):!1};
function yc(a,b){var c=b.type;if(!(c in a.g))return!1;var d=Xa(a.g[c],b);d&&(jc(b),0==a.g[c].length&&(delete a.g[c],a.h--));return d}wc.prototype.removeAll=function(a){var b=0,c;for(c in this.g)if(!a||c==a){for(var d=this.g[c],e=0;e<d.length;e++)++b,jc(d[e]);delete this.g[c];this.h--}return b};function zc(a,b,c,d,e){a=a.g[b];b=-1;a&&(b=xc(a,c,d,e));return-1<b?a[b]:null}function xc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.hc==b&&f.td==!!c&&f.Ua==d)return e}return-1};var Ac="closure_lm_"+(1E6*Math.random()|0),Bc={},Cc=0;function Dc(a,b,c,d,e){if(u(b)){for(var f=0;f<b.length;f++)Dc(a,b[f],c,d,e);return null}c=Ec(c);return gc(a)?a.listen(b,c,d,e):Fc(a,b,c,!1,d,e)}function Fc(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,k=Gc(a);k||(a[Ac]=k=new wc(a));c=k.add(b,c,d,e,f);if(c.proxy)return c;d=Hc();c.proxy=d;d.src=a;d.hc=c;a.addEventListener?a.addEventListener(b,d,g):a.attachEvent(b in Bc?Bc[b]:Bc[b]="on"+b,d);Cc++;return c}
function Hc(){var a=Ic,b=$b?function(c){return a.call(b.src,b.hc,c)}:function(c){c=a.call(b.src,b.hc,c);if(!c)return c};return b}function Jc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Jc(a,b[f],c,d,e);else c=Ec(c),gc(a)?a.pb.add(String(b),c,!0,d,e):Fc(a,b,c,!0,d,e)}function Kc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Kc(a,b[f],c,d,e);else c=Ec(c),gc(a)?a.Ca(b,c,d,e):a&&(a=Gc(a))&&(b=zc(a,b,c,!!d,e))&&Lc(b)}
function Lc(a){if(y(a)||!a||a.removed)return!1;var b=a.src;if(gc(b))return yc(b.pb,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.td):b.detachEvent&&b.detachEvent(c in Bc?Bc[c]:Bc[c]="on"+c,d);Cc--;(c=Gc(b))?(yc(c,a),0==c.h&&(c.src=null,b[Ac]=null)):jc(a);return!0}function Mc(a,b,c,d){var e=1;if(a=Gc(a))if(b=a.g[b])for(b=$a(b),a=0;a<b.length;a++){var f=b[a];f&&f.td==c&&!f.removed&&(e&=!1!==Nc(f,d))}return Boolean(e)}
function Nc(a,b){var c=a.hc,d=a.Ua||a.src;a.sd&&Lc(a);return c.call(d,b)}
function Ic(a,b){if(a.removed)return!0;if(!$b){var c=b||ba("window.event"),d=new cc(c,this),e=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==c.returnValue)c.returnValue=!0}c=[];for(f=d.i;f;f=f.parentNode)c.push(f);for(var f=a.type,k=c.length-1;!d.Rb&&0<=k;k--)d.i=c[k],e&=Mc(c[k],f,!0,d);for(k=0;!d.Rb&&k<c.length;k++)d.i=c[k],e&=Mc(c[k],f,!1,d)}return e}return Nc(a,new cc(b,this))}
function Gc(a){a=a[Ac];return a instanceof wc?a:null}var Oc="__closure_events_fn_"+(1E9*Math.random()>>>0);function Ec(a){return ga(a)?a:a[Oc]||(a[Oc]=function(b){return a.handleEvent(b)})};function L(){vb.call(this);this.pb=new wc(this);this.Hc=this}E(L,vb);L.prototype[fc]=!0;h=L.prototype;h.Vd=null;h.rf=function(a){this.Vd=a};h.removeEventListener=function(a,b,c,d){Kc(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.Vd;if(c)for(b=[];c;c=c.Vd)b.push(c);var c=this.Hc,d=a.type||a;if(x(a))a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);uc(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.Rb&&0<=g;g--)f=a.i=b[g],e=Pc(f,d,!0,a)&&e;a.Rb||(f=a.i=c,e=Pc(f,d,!0,a)&&e,a.Rb||(e=Pc(f,d,!1,a)&&e));if(b)for(g=0;!a.Rb&&g<b.length;g++)f=a.i=b[g],e=Pc(f,d,!1,a)&&e;return e};h.G=function(){L.m.G.call(this);this.pb&&this.pb.removeAll(void 0);this.Vd=null};
h.listen=function(a,b,c,d){return this.pb.add(String(a),b,!1,c,d)};h.Ca=function(a,b,c,d){return this.pb.remove(String(a),b,c,d)};function Pc(a,b,c,d){b=a.pb.g[String(b)];if(!b)return!0;b=$a(b);for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.td==c){var k=g.hc,l=g.Ua||g.src;g.sd&&yc(a.pb,g);e=!1!==k.call(l,d)&&e}}return e&&!1!=d.ng};function M(a){pa.call(this,a);this.name="ydn.error.ArgumentException"}E(M,pa);function Qc(a){pa.call(this,a);this.name="ydn.error.NotSupportedException"}E(Qc,pa);function Rc(a){pa.call(this,a);this.name="ydn.error.NotImplementedException"}E(Rc,pa);function Sc(a){pa.call(this,a);this.name="ydn.error.InvalidOperationException"}E(Sc,pa);
function Tc(a){Error.captureStackTrace?Error.captureStackTrace(this,Tc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}E(Tc,Error);Tc.prototype.name="ydn.error.InternalError";function Uc(a,b){F.call(this,a,b);this.j=[]}E(Uc,F);function Vc(a,b){for(var c=0;c<a.j.length;c++)a.j[c][0].call(a.j[c][1],b)}Uc.prototype.u=function(a){this.j.length=0;Uc.m.u.call(this,a)};Uc.prototype.w=function(a){this.j.length=0;Uc.m.w.call(this,a)};function Wc(a){this.id="i"+this.count();this.req=a;this.i=!0;this.g=this.h=null;this.j=new Uc;this.l=NaN}Wc.prototype.D=function(){return this.id};var Xc=0;Wc.prototype.count=function(){Xc++;return Xc};
Wc.prototype.listen=function(a){if(a&&a.id==this.id){this.h=a.data;var b=a.error;b&&(b instanceof Error?this.g=b:A(b)?(this.g=Error(b.message),this.g.name=b.name,this.g.source=b,this.g.result=this.h):(this.g=Error(b),this.g.name="UnknownError"));a.done?(this.i=!1,this.g?this.j.w(this.g):this.j.u(this.h),window.clearTimeout(this.l)):Vc(this.j,a.data);return!0}return!1};Wc.prototype.toString=function(){return"Message:"+this.id+(this.i?"*":"")};
Wc.prototype.toJSON=function(){var a=this;this.l=window.setTimeout(function(){if(a.i){var b=Error("message timeout");b.name="TimeOutError";a.listen({id:a.id,req:a.req,error:b})}},5E3);return{id:this.id,req:this.req,group:this.n,name:this.o,data:this.h}};function Zc(a){L.call(this);var b=x(a)?null:a;this.name=x(a)?a:a.name;this.g=[];this.n=b;this.h=null;this.i={}}E(Zc,L);Zc.prototype.G=function(){if(this.h){var a=this;this.h.disconnect(function(){a.h=null;a.g.length=0})}else this.g.length=0};function $c(a){K.call(this,"post");this.message=a}E($c,K);$c.prototype.getMessage=function(){return this.message};
Zc.prototype.l=function(a){if(a)if(a.id)for(var b=this.g.length-1;0<=b;b--){if(this.g[b].D()==a.id&&this.g[b].listen(a)){this.g[b].i?25<b&&(a=this.g.splice(b,1),this.g.unshift(a[0])):this.g.splice(b,1);break}}else"info"==a.req?(a.data=this.n,this.h.postMessage(a)):this.dispatchEvent(new $c(a))};Zc.prototype.toString=function(){return"Pipe:"+this.name};Zc.prototype.j=function(a,b){var c=a||ad,d=c+(b?"-"+b:"");this.i[d]||(this.i[d]=new bd(this,c,b||""));return this.i[d]};
function cd(a){if(!a.h){a.h=chrome.runtime.connect({name:a.name});var b=B(a.l,a);a.h.onMessage.addListener(b);a.h.onDisconnect.addListener(function(){a.h.onMessage.removeListener(b);a.h=null;a.g.length=0})}return a.h}var dd=null;function ed(){if(!dd){var a=ad+"-"+D();dd=new Zc(a)}return dd}function fd(a){var b=a;x(a)&&(b={group:a,name:a+"-"+D()});dd=new Zc(b)}var ad="default",gd=["gmail","host-permission","popup","options"];function hd(a,b){return ed().j(a,b)}
function bd(a,b,c){this.g=a;this.h=b;this.i=c}bd.prototype.send=function(a,b){var c=new Wc(a),d=this.i;c.n=this.h;c.o=d;b&&(c.h=b);var d=c.j,e=this.g,f=c.toJSON();cd(e).postMessage(f);e.g.push(c);50<e.g.length&&(e.g.length-=1);return d};function id(a){if("function"==typeof a.ya)return a.ya();if(x(a))return a.split("");if(w(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return mc(a)}function jd(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(w(a)||x(a))Oa(a,b,c);else{var d;if("function"==typeof a.La)d=a.La();else if("function"!=typeof a.ya)if(w(a)||x(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=nc(a);else d=void 0;for(var e=id(a),f=e.length,g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)}};var kd="StopIteration"in r?r.StopIteration:Error("StopIteration");function ld(){}ld.prototype.g=function(){throw kd;};ld.prototype.Fb=function(){return this};function md(a){if(a instanceof ld)return a;if("function"==typeof a.Fb)return a.Fb(!1);if(w(a)){var b=0,c=new ld;c.g=function(){for(;;){if(b>=a.length)throw kd;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function nd(a,b){if(w(a))try{Oa(a,b,void 0)}catch(c){if(c!==kd)throw c;}else{a=md(a);try{for(;;)b.call(void 0,a.g(),void 0,a)}catch(d){if(d!==kd)throw d;}}}function od(a){if(w(a))return $a(a);a=md(a);var b=[];nd(a,function(a){b.push(a)});return b};function pd(a,b){this.h={};this.g=[];this.j=this.i=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof pd?(c=a.La(),d=a.ya()):(c=nc(a),d=mc(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=pd.prototype;h.fa=function(){return this.i};h.ya=function(){qd(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a};h.La=function(){qd(this);return this.g.concat()};
h.Va=function(){return 0==this.i};h.clear=function(){this.h={};this.j=this.i=this.g.length=0};h.remove=function(a){return rd(this.h,a)?(delete this.h[a],this.i--,this.j++,this.g.length>2*this.i&&qd(this),!0):!1};function qd(a){if(a.i!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];rd(a.h,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.i!=a.g.length){for(var e={},c=b=0;b<a.g.length;)d=a.g[b],rd(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}h.get=function(a,b){return rd(this.h,a)?this.h[a]:b};
h.set=function(a,b){rd(this.h,a)||(this.i++,this.g.push(a),this.j++);this.h[a]=b};h.ea=function(){return new pd(this)};h.Fb=function(a){qd(this);var b=0,c=this.g,d=this.h,e=this.j,f=this,g=new ld;g.g=function(){for(;;){if(e!=f.j)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw kd;var g=c[b++];return a?g:d[g]}};return g};function rd(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var sd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function td(a){if(ud){ud=!1;var b=r.location;if(b){var c=b.href;if(c&&(c=(c=td(c)[3]||null)&&decodeURIComponent(c))&&c!=b.hostname)throw ud=!0,Error();}}return a.match(sd)}var ud=Kb;function vd(a,b){var c;if(a instanceof vd)this.bc=t(b)?b:a.bc,wd(this,a.mc),this.de=a.de,xd(this,a.M()),yd(this,a.Ed),zd(this,a.Ac),Ad(this,a.g.ea()),Bd(this,a.De);else if(a&&(c=td(String(a)))){this.bc=!!b;wd(this,c[1]||"",!0);var d=c[2]||"";this.de=d?decodeURIComponent(d):"";xd(this,c[3]||"",!0);yd(this,c[4]);zd(this,c[5]||"",!0);Ad(this,c[6]||"",!0);Bd(this,c[7]||"",!0)}else this.bc=!!b,this.g=new Cd(null,0,this.bc)}h=vd.prototype;h.mc="";h.de="";h.Ae="";h.Ed=null;h.Ac="";h.De="";h.bc=!1;
h.toString=function(){var a=[],b=this.mc;b&&a.push(Dd(b,Ed),":");if(b=this.M()){a.push("//");var c=this.de;c&&a.push(Dd(c,Ed),"@");a.push(encodeURIComponent(String(b)));b=this.Ed;null!=b&&a.push(":",String(b))}if(b=this.Ac)this.Ae&&"/"!=b.charAt(0)&&a.push("/"),a.push(Dd(b,"/"==b.charAt(0)?Fd:Gd));(b=this.g.toString())&&a.push("?",b);(b=this.De)&&a.push("#",Dd(b,Hd));return a.join("")};h.ea=function(){return new vd(this)};
function wd(a,b,c){a.mc=c?b?decodeURIComponent(b):"":b;a.mc&&(a.mc=a.mc.replace(/:$/,""));return a}h.M=function(){return this.Ae};function xd(a,b,c){a.Ae=c?b?decodeURIComponent(b):"":b;return a}function yd(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Ed=b}else a.Ed=null}function Id(a){return a.Ac}function zd(a,b,c){a.Ac=c?b?decodeURIComponent(b):"":b}function Ad(a,b,c){b instanceof Cd?(a.g=b,Kd(a.g,a.bc)):(c||(b=Dd(b,Ld)),a.g=new Cd(b,0,a.bc))}
function Bd(a,b,c){a.De=c?b?decodeURIComponent(b):"":b}function Dd(a,b){return x(a)?encodeURI(a).replace(b,Md):null}function Md(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Ed=/[#\/\?@]/g,Gd=/[\#\?:]/g,Fd=/[\#\?]/g,Ld=/[\#\?@]/g,Hd=/#/g;function Cd(a,b,c){this.g=a||null;this.h=!!c}
function Nd(a){if(!a.ja&&(a.ja=new pd,a.Ha=0,a.g))for(var b=a.g.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=null,f=null;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=Od(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}h=Cd.prototype;h.ja=null;h.Ha=null;h.fa=function(){Nd(this);return this.Ha};h.add=function(a,b){Nd(this);this.g=null;a=Od(this,a);var c=this.ja.get(a);c||this.ja.set(a,c=[]);c.push(b);this.Ha++;return this};
h.remove=function(a){Nd(this);a=Od(this,a);return rd(this.ja.h,a)?(this.g=null,this.Ha-=this.ja.get(a).length,this.ja.remove(a)):!1};h.clear=function(){this.ja=this.g=null;this.Ha=0};h.Va=function(){Nd(this);return 0==this.Ha};function Pd(a,b){Nd(a);b=Od(a,b);return rd(a.ja.h,b)}h.La=function(){Nd(this);for(var a=this.ja.ya(),b=this.ja.La(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
h.ya=function(a){Nd(this);var b=[];if(x(a))Pd(this,a)&&(b=Za(b,this.ja.get(Od(this,a))));else{a=this.ja.ya();for(var c=0;c<a.length;c++)b=Za(b,a[c])}return b};h.set=function(a,b){Nd(this);this.g=null;a=Od(this,a);Pd(this,a)&&(this.Ha-=this.ja.get(a).length);this.ja.set(a,[b]);this.Ha++;return this};h.get=function(a,b){var c=a?this.ya(a):[];return 0<c.length?String(c[0]):b};
h.toString=function(){if(this.g)return this.g;if(!this.ja)return"";for(var a=[],b=this.ja.La(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.ya(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.g=a.join("&")};h.ea=function(){var a=new Cd;a.g=this.g;this.ja&&(a.ja=this.ja.ea(),a.Ha=this.Ha);return a};function Od(a,b){var c=String(b);a.h&&(c=c.toLowerCase());return c}
function Kd(a,b){b&&!a.h&&(Nd(a),a.g=null,jd(a.ja,function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.g=null,this.ja.set(Od(this,e),$a(a)),this.Ha+=a.length))},a));a.h=b};var Qd;
Qd={i:["BC","AD"],h:["Before Christ","Anno Domini"],o:"JFMAMJJASOND".split(""),$:"JFMAMJJASOND".split(""),n:"January February March April May June July August September October November December".split(" "),V:"January February March April May June July August September October November December".split(" "),H:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),xa:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Hc:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Vb:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
P:"Sun Mon Tue Wed Thu Fri Sat".split(" "),Pa:"Sun Mon Tue Wed Thu Fri Sat".split(" "),s:"SMTWTFS".split(""),na:"SMTWTFS".split(""),K:["Q1","Q2","Q3","Q4"],I:["1st quarter","2nd quarter","3rd quarter","4th quarter"],g:["AM","PM"],Bf:["EEEE, MMMM d, y","MMMM d, y","MMM d, y","M/d/yy"],If:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],Bg:["{1} 'at' {0}","{1} 'at' {0}","{1}, {0}","{1}, {0}"],j:6,md:[5,6],l:5};function Rd(a){this.h=[];this.g=Qd;"number"==typeof a?Sd(this,a):Td(this,a)}var Ud=[/^\'(?:[^\']|\'\')*\'/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|w+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvwzZ]+/];function Td(a,b){for(;b;)for(var c=0;c<Ud.length;++c){var d=b.match(Ud[c]);if(d){d=d[0];b=b.substring(d.length);0==c&&("''"==d?d="'":(d=d.substring(1,d.length-1),d=d.replace(/\'\'/,"'")));a.h.push({text:d,type:c});break}}}
function Sd(a,b){var c;if(4>b)c=a.g.Bf[b];else if(8>b)c=a.g.If[b-4];else if(12>b)c=a.g.Bg[b-8],c=c.replace("{1}",a.g.Bf[b-8]),c=c.replace("{0}",a.g.If[b-8]);else{Sd(a,10);return}Td(a,c)}function Vd(a){var b=Rd.prototype;if(void 0===b.g||void 0===b.g.Ig)return a;for(var c=[],d=0;d<a.length;d++){var e=a.charCodeAt(d);c.push(48<=e&&57>=e?String.fromCharCode(b.g.Ig+e-48):a.charAt(d))}return c.join("")};var Wd={zg:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},yg:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Xd=Wd,Xd=Wd;var Yd={Df:".",Ff:",",Gf:"%",pe:"0",Gg:"+",Dg:"-",Ef:"E",Hf:"\u2030",oe:"\u221e",Eg:"NaN",Cf:"#,##0.###",Hg:"#E0",Fg:"#,##0%",Ag:"\u00a4#,##0.00;(\u00a4#,##0.00)",Cg:"USD"},Zd=Yd,Zd=Yd;var $d={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[0,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[18,"kr","kr"],DOP:[2,"$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[0,"Ft",
"Ft"],IDR:[0,"Rp","Rp"],ILS:[2,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],LVL:[2,"Ls","Ls"],MNT:[0,"\u20ae","MN\u20ae"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u0440\u0443\u0431.",
"\u0440\u0443\u0431."],SAR:[2,"Rial","Rial"],SEK:[2,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u20b4","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[0,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};function ae(a,b,c){this.s=b||Zd.Cg;this.Vb=c||be;this.K=40;this.g=1;this.na=0;this.j=3;this.P=this.h=0;this.Pa=!1;this.H=this.l="";this.i="-";this.n="";this.I=1;this.$=3;this.V=this.xa=!1;this.o=ce;if("number"==typeof a)switch(a){case 1:de(this,Zd.Cf);break;case 2:de(this,Zd.Hg);break;case 3:de(this,Zd.Fg);break;case 4:a=Zd.Ag;b=["0"];c=$d[this.s][0]&7;if(0<c){b.push(".");for(var d=0;d<c;d++)b.push("0")}a=a.replace(/0.00/g,b.join(""));de(this,a);break;case 5:ee(this,1);break;case 6:ee(this,2);break;
default:throw Error("Unsupported pattern type.");}else de(this,a)}var be=0,ce=0;
function de(a,b){b.replace(/ /g,"\u00a0");var c=[0];a.l=fe(a,b,c);for(var d=c[0],e=-1,f=0,g=0,k=0,l=-1,m=b.length,n=!0;c[0]<m&&n;c[0]++)switch(b.charAt(c[0])){case "#":0<g?k++:f++;0<=l&&0>e&&l++;break;case "0":if(0<k)throw Error('Unexpected "0" in pattern "'+b+'"');g++;0<=l&&0>e&&l++;break;case ",":l=0;break;case ".":if(0<=e)throw Error('Multiple decimal separators in pattern "'+b+'"');e=f+g+k;break;case "E":if(a.V)throw Error('Multiple exponential symbols in pattern "'+b+'"');a.V=!0;a.P=0;c[0]+1<
m&&"+"==b.charAt(c[0]+1)&&(c[0]++,a.Pa=!0);for(;c[0]+1<m&&"0"==b.charAt(c[0]+1);)c[0]++,a.P++;if(1>f+g||1>a.P)throw Error('Malformed exponential pattern "'+b+'"');n=!1;break;default:c[0]--,n=!1}0==g&&0<f&&0<=e&&(g=e,0==g&&g++,k=f-g,f=g-1,g=1);if(0>e&&0<k||0<=e&&(e<f||e>f+g)||0==l)throw Error('Malformed pattern "'+b+'"');k=f+g+k;a.j=0<=e?k-e:0;0<=e&&(a.h=f+g-e,0>a.h&&(a.h=0));a.g=(0<=e?e:k)-f;a.V&&(a.K=f+a.g,0==a.j&&0==a.g&&(a.g=1));a.$=Math.max(0,l);a.xa=0==e||e==k;d=c[0]-d;a.H=fe(a,b,c);c[0]<b.length&&
b.charAt(c[0])==ge?(c[0]++,a.i=fe(a,b,c),c[0]+=d,a.n=fe(a,b,c)):(a.i=a.l+a.i,a.n+=a.H)}function ee(a,b){a.o=b;de(a,Zd.Cf);a.h=0;a.j=2;if(0<a.h)throw Error("Can't combine significant digits and minimum fraction digits");a.na=2}
ae.prototype.parse=function(a,b){var c=b||[0];if(this.o!=ce)throw Error("Parsing of compact numbers is unimplemented");var d=NaN;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.l,c[0])==c[0],f=a.indexOf(this.i,c[0])==c[0];e&&f&&(this.l.length>this.i.length?f=!1:this.l.length<this.i.length&&(e=!1));e?c[0]+=this.l.length:f&&(c[0]+=this.i.length);if(a.indexOf(Zd.oe,c[0])==c[0])c[0]+=Zd.oe.length,d=Infinity;else{var d=a,g=!1,k=!1,l=!1,m=1,n=Zd.Df,p=Zd.Ff,q=Zd.Ef;if(this.o!=ce)throw Error("Parsing of compact style numbers is not implemented");
for(var s="";c[0]<d.length;c[0]++){var v=d.charAt(c[0]),z=he(v);if(0<=z&&9>=z)s+=z,l=!0;else if(v==n.charAt(0)){if(g||k)break;s+=".";g=!0}else if(v==p.charAt(0)&&("\u00a0"!=p.charAt(0)||c[0]+1<d.length&&0<=he(d.charAt(c[0]+1)))){if(g||k)break}else if(v==q.charAt(0)){if(k)break;s+="E";k=!0}else if("+"==v||"-"==v)s+=v;else if(v==Zd.Gf.charAt(0)){if(1!=m)break;m=100;if(l){c[0]++;break}}else if(v==Zd.Hf.charAt(0)){if(1!=m)break;m=1E3;if(l){c[0]++;break}}else break}d=parseFloat(s)/m}if(e){if(a.indexOf(this.H,
c[0])!=c[0])return NaN;c[0]+=this.H.length}else if(f){if(a.indexOf(this.n,c[0])!=c[0])return NaN;c[0]+=this.n.length}return f?-d:d};function ie(a,b){var c=Math.pow(10,a.j),d=0>=a.na?Math.round(b*c):Math.floor(je(b*c,a.na,a.j)),e;isFinite(d)?(e=Math.floor(d/c),c=Math.floor(d-e*c)):(e=b,c=0);return{gg:e,Mg:c}}
function ke(a,b,c,d){if(a.h>a.j)throw Error("Min value must be less than max value");b=ie(a,b);var e=Math.pow(10,a.j),f=b.gg,g=b.Mg,k=0<a.h||0<g||!1;b=a.h;k&&(b=a.h);for(var l="",m=f;1E20<m;)l="0"+l,m=Math.round(m/10);var l=m+l,n=Zd.Df,p=Zd.Ff,m=Zd.pe.charCodeAt(0),q=l.length;if(0<f||0<c){for(f=q;f<c;f++)d.push(String.fromCharCode(m));for(f=0;f<q;f++)d.push(String.fromCharCode(m+1*l.charAt(f))),1<q-f&&0<a.$&&1==(q-f)%a.$&&d.push(p)}else k||d.push(String.fromCharCode(m));(a.xa||k)&&d.push(n);a=""+
(g+e);for(c=a.length;"0"==a.charAt(c-1)&&c>b+1;)c--;for(f=1;f<c;f++)d.push(String.fromCharCode(m+1*a.charAt(f)))}function le(a,b,c){c.push(Zd.Ef);0>b?(b=-b,c.push(Zd.Dg)):a.Pa&&c.push(Zd.Gg);b=""+b;for(var d=Zd.pe,e=b.length;e<a.P;e++)c.push(d);c.push(b)}function he(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Zd.pe.charCodeAt(0);return b<=a&&a<b+10?a-b:-1}var ge=";";
function fe(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var g=b.charAt(c[0]);if("'"==g)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case ge:return d;case "\u00a4":if(c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1))c[0]++,d+=a.s;else switch(a.Vb){case be:d+=$d[a.s][1];break;case 2:var g=a.s,k=$d[g],d=d+(g==k[1]?g:g+" "+k[1]);break;case 1:d+=$d[a.s][2]}break;case "%":if(1!=a.I)throw Error("Too many percent/permill");a.I=100;d+=Zd.Gf;
break;case "\u2030":if(1!=a.I)throw Error("Too many percent/permill");a.I=1E3;d+=Zd.Hf;break;default:d+=g}}return d}var me={prefix:"",pg:"",ze:0};function ne(a,b){var c=1==a.o?Xd.zg:Xd.yg;if(3>b)return me;b=Math.min(14,b);c=c[Math.pow(10,b)];if(!c)return me;c=c.other;return c&&"0"!=c?(c=/([^0]*)(0+)(.*)/.exec(c))?{prefix:c[1],pg:c[3],ze:b-(c[2].length-1)}:me:me}function oe(a){for(var b=0;1<=(a/=10);)b++;return b}
function je(a,b,c){if(!a)return a;b=b-oe(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};function pe(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"}var qe=pe,qe=pe;function re(a){return 1==a?"one":"other"}var se=re,se=re;function te(a){this.g=[];this.i=[];this.j=new ae(1);a&&(a=ue(this,a),this.i=ve(this,a))}var we=/'([{}#].*?)'/g,xe=/''/g;
function ye(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var g=b[f].value,k=a,l=e,m=c[g];t(m)?(k.g.push(m),l.push(k.h(k.g))):l.push("Undefined parameter - "+g);break;case 2:g=b[f].value;k=e;l=g.pd;t(c[l])?(l=g[c[l]],t(l)||(l=g.other),ye(a,l,c,d,k)):k.push("Undefined parameter - "+l);break;case 0:g=b[f].value;ze(a,g,c,se,d,e);break;case 1:g=b[f].value;ze(a,g,c,qe,d,e);break;default:La("Unrecognized block type.")}}
function ze(a,b,c,d,e,f){var g=b.pd,k=b.Mf,l=+c[g];if(isNaN(l))f.push("Undefined or invalid parameter - "+g);else if(k=l-k,g=b[c[g]],t(g)||(d=d(k),g=b[d],t(g)||(g=b.other)),b=[],ye(a,g,c,e,b),c=b.join(""),e)f.push(c);else{a=a.j;if(isNaN(k))a=Zd.Eg;else{e=[];g=d=k;a.o==ce?b=me:(d=Math.abs(d),g=Math.abs(g),b=ne(a,1>=d?0:oe(d)).ze,ie(a,g/Math.pow(10,b)),d=ie(a,d/Math.pow(10,b)),b=ne(a,b+oe(d.gg)));k/=Math.pow(10,b.ze);e.push(b.prefix);d=0>k||0==k&&0>1/k;e.push(d?a.i:a.l);if(isFinite(k))if(k=k*(d?-1:
1)*a.I,a.V)if(0==k)ke(a,k,a.g,e),le(a,0,e);else{g=Math.log(k)/Math.log(10);g=Math.floor(g+2E-15);k/=Math.pow(10,g);l=a.g;if(1<a.K&&a.K>a.g){for(;0!=g%a.K;)k*=10,g--;l=1}else 1>a.g?(g++,k/=10):(g-=a.g-1,k*=Math.pow(10,a.g-1));ke(a,k,l,e);le(a,g,e)}else ke(a,k,a.g,e);else e.push(Zd.oe);e.push(d?a.n:a.H);e.push(b.pg);a=e.join("")}f.push(c.replace(/#/g,a))}}
function ue(a,b){var c=a.g,d=B(a.h,a);b=b.replace(xe,function(){c.push("'");return d(c)});return b=b.replace(we,function(a,b){c.push(b);return d(c)})}function Ae(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,g),d.push(f),b=g+1)):(0==c.length&&(b=a.substring(b,g),""!=b&&d.push({type:0,value:b}),b=g+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d}
var Be=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Ce=/^\s*(\w+)\s*,\s*selectordinal\s*,/,De=/^\s*(\w+)\s*,\s*select\s*,/;
function ve(a,b){for(var c=[],d=Ae(b),e=0;e<d.length;e++){var f={};if(0==d[e].type)f.type=4,f.value=d[e].value;else if(1==d[e].type){var g=d[e].value;switch(Be.test(g)?0:Ce.test(g)?1:De.test(g)?2:/^\s*\w+\s*/.test(g)?3:5){case 2:f.type=2;f.value=Ee(a,d[e].value);break;case 0:f.type=0;f.value=Fe(a,d[e].value);break;case 1:f.type=1;f.value=Ge(a,d[e].value);break;case 3:f.type=3;f.value=d[e].value;break;default:La("Unknown block type.")}}else La("Unknown part of the pattern.");c.push(f)}return c}
function Ee(a,b){var c="";b=b.replace(De,function(a,b){c=b;return""});var d={};d.pd=c;for(var e=Ae(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=ve(a,e[f].value);else La("Expected block type.");d[g.replace(/\s/g,"")]=k;f++}return d}
function Fe(a,b){var c="",d=0;b=b.replace(Be,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.pd=c;e.Mf=d;for(var f=Ae(b),g=0;g<f.length;){var k=f[g].value;g++;if(1==f[g].type)var l=ve(a,f[g].value);else La("Expected block type.");e[k.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=l;g++}return e}
function Ge(a,b){var c="";b=b.replace(Ce,function(a,b){c=b;return""});var d={};d.pd=c;d.Mf=0;for(var e=Ae(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=ve(a,e[f].value);else La("Expected block type.");d[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return d}te.prototype.h=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};function He(a,b,c){a=new te(a);b={COUNT:b,TEXT:c};if(0==a.i.length)a="";else{c=[];ye(a,a.i,b,!1,c);for(b=c.join("");0<a.g.length;)b=b.replace(a.h(a.g),a.g.pop());a=b}return a};function Ie(a){this.g=new pd;if(a){a=id(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])}}function Je(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+ia(a):b.substr(0,1)+a}h=Ie.prototype;h.fa=function(){return this.g.fa()};h.add=function(a){this.g.set(Je(a),a)};h.removeAll=function(a){a=id(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};h.remove=function(a){return this.g.remove(Je(a))};h.clear=function(){this.g.clear()};h.Va=function(){return this.g.Va()};
h.contains=function(a){a=Je(a);return rd(this.g.h,a)};h.ya=function(){return this.g.ya()};h.ea=function(){return new Ie(this)};h.Fb=function(){return this.g.Fb(!1)};function Ke(a){return Le(a||arguments.callee.caller,[])}
function Le(a,b){var c=[];if(Va(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Me(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Me(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Le(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Me(a){if(Ne[a])return Ne[a];a=String(a);if(!Ne[a]){var b=/function ([^\(]+)/.exec(a);Ne[a]=b?b[1]:"[Anonymous]"}return Ne[a]}var Ne={};function Oe(a,b,c,d,e){this.n="number"==typeof e?e:Pe++;this.l=d||D();this.j=a;this.o=b;this.h=c;delete this.i;delete this.g}Oe.prototype.n=0;Oe.prototype.i=null;Oe.prototype.g=null;var Pe=0;Oe.prototype.getMessage=function(){return this.o};function Qe(a){this.l=a}Qe.prototype.i=null;Qe.prototype.h=null;Qe.prototype.j=null;Qe.prototype.g=null;function Re(a,b){this.name=a;this.value=b}Re.prototype.toString=function(){return this.name};var Se=new Re("SHOUT",1200),Te=new Re("SEVERE",1E3),Ue=new Re("WARNING",900),Ve=new Re("INFO",800),We=new Re("CONFIG",700),Xe=new Re("FINE",500),Ye=new Re("FINER",400),Ze=new Re("FINEST",300),$e=[new Re("OFF",Infinity),Se,Te,Ue,Ve,We,Xe,Ye,Ze,new Re("ALL",0)],af=null;h=Qe.prototype;h.getName=function(){return this.l};
function bf(a,b){a.g||(a.g=[]);a.g.push(b)}h.getParent=function(){return this.i};h.getChildren=function(){this.j||(this.j={});return this.j};function cf(a){if(a.h)return a.h;if(a.i)return cf(a.i);La("Root logger has no level set.");return null}
h.log=function(a,b,c){if(a.value>=cf(this).value)for(ga(b)&&(b=b()),a=this.Og(a,b,c),b="log:"+a.getMessage(),r.console&&(r.console.timeStamp?r.console.timeStamp(b):r.console.markTimeline&&r.console.markTimeline(b)),r.msWriteProfilerMark&&r.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.g)for(var e=0,f=void 0;f=c.g[e];e++)f(d);b=b.getParent()}};
h.Og=function(a,b,c){var d=new Oe(a,String(b),this.l);if(c){d.i=c;var e;var f=arguments.callee.caller;try{var g;var k=ba("window.location.href");if(x(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var l,m,n=!1;try{l=c.lineNumber||c.Sh||"Not available"}catch(p){l="Not available",n=!0}try{m=c.fileName||c.filename||c.sourceURL||r.$googDebugFname||k}catch(q){m="Not available",n=!0}g=!n&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||
"Not available",name:c.name||"UnknownError",lineNumber:l,fileName:m,stack:c.stack||"Not available"}}e="Message: "+xa(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+xa(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+xa(Ke(f)+"-> ")}catch(s){e="Exception trying to expose exception! You win, we lose. "+s}d.g=e}return d};function O(a,b,c){a.log(Ue,b,c)}h.info=function(a,b){this.log(Ve,a,b)};
function df(a,b,c){a.log(Xe,b,c)}function P(a,b){a.log(Ye,b,void 0)}function Q(a,b){a.log(Ze,b,void 0)}var ef={},ff=null;function gf(){ff||(ff=new Qe(""),ef[""]=ff,ff.h=We)}function hf(){gf();return ff}function R(a){gf();var b;if(!(b=ef[a])){b=new Qe(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=R(a.substr(0,c));c.getChildren()[d]=b;b.i=c;ef[a]=b}return b};function jf(a){vb.call(this);this.h=a;this.g={}}E(jf,vb);var kf=[];h=jf.prototype;h.listen=function(a,b,c,d){u(b)||(kf[0]=b,b=kf);for(var e=0;e<b.length;e++){var f=Dc(a,b[e],c||this.handleEvent,d||!1,this.h||this);if(!f)break;this.g[f.key]=f}return this};h.Ca=function(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)this.Ca(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.h||this,c=Ec(c),d=!!d,b=gc(a)?zc(a.pb,String(b),c,d,e):a?(a=Gc(a))?zc(a,b,c,d,e):null:null,b&&(Lc(b),delete this.g[b.key]);return this};
h.removeAll=function(){kc(this.g,Lc);this.g={}};h.G=function(){jf.m.G.call(this);this.removeAll()};h.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function lf(a,b){L.call(this);this.h=a||1;this.g=b||r;this.i=B(this.zh,this);this.j=D()}E(lf,L);h=lf.prototype;h.Qc=!1;h.ca=null;h.setInterval=function(a){this.h=a;this.ca&&this.Qc?(this.stop(),mf(this)):this.ca&&this.stop()};h.zh=function(){if(this.Qc){var a=D()-this.j;0<a&&a<0.8*this.h?this.ca=this.g.setTimeout(this.i,this.h-a):(this.ca&&(this.g.clearTimeout(this.ca),this.ca=null),this.dispatchEvent(nf),this.Qc&&(this.ca=this.g.setTimeout(this.i,this.h),this.j=D()))}};
function mf(a){a.Qc=!0;a.ca||(a.ca=a.g.setTimeout(a.i,a.h),a.j=D())}h.stop=function(){this.Qc=!1;this.ca&&(this.g.clearTimeout(this.ca),this.ca=null)};h.G=function(){lf.m.G.call(this);this.stop();delete this.g};var nf="tick";function of(a,b,c){if(ga(a))c&&(a=B(a,c));else if(a&&"function"==typeof a.handleEvent)a=B(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:r.setTimeout(a,b||0)};function pf(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return JSON.parse(a)}catch(b){}throw Error("Invalid JSON string: "+a);}function qf(){}function rf(a,b){var c=[];sf(a,b,c);return c.join("")}
function sf(a,b,c){switch(typeof b){case "string":tf(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(u(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),sf(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),tf(e,c),c.push(":"),sf(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var uf={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},vf=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function tf(a,b){b.push('"',a.replace(vf,function(a){if(a in uf)return uf[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return uf[a]=e+b.toString(16)}),'"')};function wf(a,b){a&&df(a,b,void 0)};function xf(){}xf.prototype.g=null;function yf(a){var b;(b=a.g)||(b={},zf(a)&&(b[0]=!0,b[1]=!0),b=a.g=b);return b};var Af;function Bf(){}E(Bf,xf);function Cf(a){return(a=zf(a))?new ActiveXObject(a):new XMLHttpRequest}function zf(a){if(!a.h&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.h=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.h}Af=new Bf;function Df(a){L.call(this);this.headers=new pd;this.$=a||null;this.h=!1;this.V=this.Q=null;this.Pa=this.s="";this.n=0;this.o="";this.i=this.xa=this.H=this.na=!1;this.l=0;this.K=null;this.j=Ef;this.P=this.md=!1}E(Df,L);var Ef="";Df.prototype.g=R("goog.net.XhrIo");var Ff=/^https?$/i,Gf=["POST","PUT"];h=Df.prototype;h.Xf=function(){return this.j};
h.send=function(a,b,c,d){if(this.Q)throw Error("[goog.net.XhrIo] Object is active with another request="+this.s+"; newUri="+a);b=b?b.toUpperCase():"GET";this.s=a;this.o="";this.n=0;this.Pa=b;this.na=!1;this.h=!0;this.Q=this.$?Cf(this.$):Cf(Af);this.V=this.$?yf(this.$):yf(Af);this.Q.onreadystatechange=B(this.lg,this);try{wf(this.g,Hf(this,"Opening Xhr")),this.xa=!0,this.Q.open(b,a,!0),this.xa=!1}catch(e){wf(this.g,Hf(this,"Error opening Xhr: "+e.message));If(this,e);return}a=c||"";var f=this.headers.ea();
d&&jd(d,function(a,b){f.set(b,a)});d=Ta(f.La(),Jf);c=r.FormData&&a instanceof r.FormData;!Va(Gf,b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");jd(f,function(a,b){this.Q.setRequestHeader(b,a)},this);this.j&&(this.Q.responseType=this.j);"withCredentials"in this.Q&&(this.Q.withCredentials=this.md);try{Kf(this),0<this.l&&(this.P=Lf(this.Q),wf(this.g,Hf(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.P)),this.P?(this.Q.timeout=this.l,this.Q.ontimeout=B(this.qg,
this)):this.K=of(this.qg,this.l,this)),wf(this.g,Hf(this,"Sending request")),this.H=!0,this.Q.send(a),this.H=!1}catch(g){wf(this.g,Hf(this,"Send error: "+g.message)),If(this,g)}};function Lf(a){return H&&Wb(9)&&y(a.timeout)&&t(a.ontimeout)}function Jf(a){return"content-type"==a.toLowerCase()}h.qg=function(){"undefined"!=typeof aa&&this.Q&&(this.o="Timed out after "+this.l+"ms, aborting",this.n=8,wf(this.g,Hf(this,this.o)),this.dispatchEvent("timeout"),this.abort(8))};
function If(a,b){a.h=!1;a.Q&&(a.i=!0,a.Q.abort(),a.i=!1);a.o=b;a.n=5;Mf(a);Nf(a)}function Mf(a){a.na||(a.na=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}h.abort=function(a){this.Q&&this.h&&(wf(this.g,Hf(this,"Aborting")),this.h=!1,this.i=!0,this.Q.abort(),this.i=!1,this.n=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Nf(this))};h.G=function(){this.Q&&(this.h&&(this.h=!1,this.i=!0,this.Q.abort(),this.i=!1),Nf(this,!0));Df.m.G.call(this)};
h.lg=function(){this.I||(this.xa||this.H||this.i?Of(this):this.uh())};h.uh=function(){Of(this)};function Of(a){if(a.h&&"undefined"!=typeof aa)if(a.V[1]&&4==Pf(a)&&2==a.N())wf(a.g,Hf(a,"Local request error detected and ignored"));else if(a.H&&4==Pf(a))of(a.lg,0,a);else if(a.dispatchEvent("readystatechange"),4==Pf(a)){wf(a.g,Hf(a,"Request complete"));a.h=!1;try{a.Aa()?(a.dispatchEvent("complete"),a.dispatchEvent("success")):(a.n=6,a.o=a.Ga()+" ["+a.N()+"]",Mf(a))}finally{Nf(a)}}}
function Nf(a,b){if(a.Q){Kf(a);var c=a.Q,d=a.V[0]?ca:null;a.Q=null;a.V=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){(c=a.g)&&c.log(Te,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Kf(a){a.Q&&a.P&&(a.Q.ontimeout=null);y(a.K)&&(r.clearTimeout(a.K),a.K=null)}
h.Aa=function(){var a=this.N(),b;a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}if(!b){if(a=0===a)a=td(String(this.s))[1]||null,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),a=!Ff.test(a?a.toLowerCase():"");b=a}return b};function Pf(a){return a.Q?a.Q.readyState:0}h.N=function(){try{return 2<Pf(this)?this.Q.status:-1}catch(a){var b=this.g;b&&O(b,"Can not get status: "+a.message,void 0);return-1}};
h.Ga=function(){try{return 2<Pf(this)?this.Q.statusText:""}catch(a){return wf(this.g,"Can not get status: "+a.message),""}};
function Qf(a){try{if(!a.Q)return null;if("response"in a.Q)return a.Q.response;switch(a.j){case Ef:case "text":return a.Q.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.Q)return a.Q.mozResponseArrayBuffer}var b=a.g;b&&b.log(Te,"Response type "+a.j+" is not supported on this browser",void 0);return null}catch(c){return wf(a.g,"Can not get response: "+c.message),null}}function Hf(a,b){return b+" ["+a.Pa+" "+a.s+" "+a.N()+"]"};function Rf(){this.i=this.h=0;this.g=[]}function Sf(a){if(a.h!=a.i){var b=a.g[a.h];delete a.g[a.h];a.h++;return b}}h=Rf.prototype;h.fa=function(){return this.i-this.h};h.Va=function(){return 0==this.i-this.h};h.clear=function(){this.i=this.h=this.g.length=0};h.contains=function(a){return Va(this.g,a)};h.remove=function(a){a=Na(this.g,a);if(0>a)return!1;a==this.h?Sf(this):(Ya(this.g,a),this.i--);return!0};h.ya=function(){return this.g.slice(this.h,this.i)};function Tf(a,b){vb.call(this);this.n=a||0;this.i=b||10;if(this.n>this.i)throw Error(Uf);this.g=new Rf;this.h=new Ie;this.l=null;this.nd()}E(Tf,vb);var Uf="[goog.structs.Pool] Min can not be greater than max";h=Tf.prototype;h.Fd=function(){var a=D();if(!(null!=this.l&&0>a-this.l)){for(var b;0<this.g.fa()&&(b=Sf(this.g),!this.mf(b));)this.nd();!b&&this.fa()<this.i&&(b=this.Me());b&&(this.l=a,this.h.add(b));return b}};h.Xd=function(a){return this.h.remove(a)?(this.re(a),!0):!1};
h.re=function(a){this.h.remove(a);if(this.mf(a)&&this.fa()<this.i){var b=this.g;b.g[b.i++]=a}else Vf(a)};h.nd=function(){for(var a=this.g;this.fa()<this.n;){var b=this.Me();a.g[a.i++]=b}for(;this.fa()>this.i&&0<this.g.fa();)Vf(Sf(a))};h.Me=function(){return{}};function Vf(a){if("function"==typeof a.qa)a.qa();else for(var b in a)a[b]=null}h.mf=function(a){return"function"==typeof a.Kg?a.Kg():!0};h.contains=function(a){return this.g.contains(a)||this.h.contains(a)};
h.fa=function(){return this.g.fa()+this.h.fa()};h.Va=function(){return this.g.Va()&&this.h.Va()};h.G=function(){Tf.m.G.call(this);if(0<this.h.fa())throw Error("[goog.structs.Pool] Objects not released");delete this.h;for(var a=this.g;!a.Va();)Vf(Sf(a));delete this.g};function Wf(a,b){this.g=a;this.h=b}Wf.prototype.T=function(){return this.h};Wf.prototype.ea=function(){return new Wf(this.g,this.h)};function Xf(a){this.g=[];if(a)a:{var b,c;if(a instanceof Xf){if(b=a.La(),c=a.ya(),0>=a.fa()){a=this.g;for(var d=0;d<b.length;d++)a.push(new Wf(b[d],c[d]));break a}}else b=nc(a),c=mc(a);for(d=0;d<b.length;d++)Yf(this,b[d],c[d])}}function Yf(a,b,c){var d=a.g;d.push(new Wf(b,c));b=d.length-1;a=a.g;for(c=a[b];0<b;)if(d=b-1>>1,a[d].g>c.g)a[b]=a[d],b=d;else break;a[b]=c}h=Xf.prototype;
h.remove=function(){var a=this.g,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Wa(a);else{a[0]=a.pop();for(var a=0,b=this.g,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,g=2*a+2,f=g<d&&b[g].g<b[f].g?g:f;if(b[f].g>e.g)break;b[a]=b[f];a=f}b[a]=e}return c.T()}};h.ya=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].T());return b};h.La=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].g);return b};h.ea=function(){return new Xf(this)};h.fa=function(){return this.g.length};
h.Va=function(){return 0==this.g.length};h.clear=function(){Wa(this.g)};function Zf(){Xf.call(this)}E(Zf,Xf);function $f(a,b){this.j=new Zf;Tf.call(this,a,b)}E($f,Tf);h=$f.prototype;h.Fd=function(a,b){if(!a)return $f.m.Fd.call(this);Yf(this.j,t(b)?b:100,a);this.bf()};h.bf=function(){for(var a=this.j;0<a.fa();){var b=this.Fd();if(b)a.remove().apply(this,[b]);else break}};h.re=function(a){$f.m.re.call(this,a);this.bf()};h.nd=function(){$f.m.nd.call(this);this.bf()};h.G=function(){$f.m.G.call(this);r.clearTimeout(void 0);this.j.clear();this.j=null};function ag(a,b,c){$f.call(this,b,c);this.o=a}E(ag,$f);ag.prototype.Me=function(){var a=new Df,b=this.o;b&&jd(b,function(b,d){a.headers.set(d,b)});return a};ag.prototype.mf=function(a){return!a.I&&!a.Q};function bg(a,b,c,d,e){L.call(this);this.i=t(a)?a:1;this.j=t(e)?Math.max(0,e):0;this.Fc=new ag(b,c,d);this.g=new pd;this.h=new jf(this)}E(bg,L);var cg="ready complete success error abort timeout".split(" ");h=bg.prototype;h.send=function(a,b,c,d,e,f,g,k,l){if(this.g.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new dg(b,B(this.bh,this,a),c,d,e,g,t(k)?k:this.i,l);this.g.set(a,b);a=B(this.Wg,this,a);this.Fc.Fd(a,f);return b};
h.abort=function(a,b){var c=this.g.get(a);if(c){var d=c.fe;c.Jf=!0;b&&(d&&(this.h.Ca(d,cg,c.ee),Jc(d,"ready",function(){this.Fc.Xd(d)},!1,this)),this.g.remove(a));d&&d.abort()}};h.Wg=function(a,b){var c=this.g.get(a);c&&!c.fe?(this.h.listen(b,cg,c.ee),b.l=Math.max(0,this.j),b.j=c.Xf(),c.fe=b,this.dispatchEvent(new eg("ready",this,a,b)),fg(this,a,b),c.Jf&&b.abort()):this.Fc.Xd(b)};
h.bh=function(a,b){var c=b.target;switch(b.type){case "ready":fg(this,a,c);break;case "complete":a:{var d=this.g.get(a);if(7==c.n||c.Aa()||d.qd>d.Ke)if(this.dispatchEvent(new eg("complete",this,a,c)),d&&(d.Sf=!0,d.we)){c=d.we.call(c,b);break a}c=null}return c;case "success":this.dispatchEvent(new eg("success",this,a,c));break;case "timeout":case "error":d=this.g.get(a);d.qd>d.Ke&&this.dispatchEvent(new eg("error",this,a,c));break;case "abort":this.dispatchEvent(new eg("abort",this,a,c))}return null};
function fg(a,b,c){var d=a.g.get(b);!d||d.Sf||d.qd>d.Ke?(d&&(a.h.Ca(c,cg,d.ee),a.g.remove(b)),a.Fc.Xd(c)):(d.qd++,c.send(d.Ah,d.Dd(),d.ra(),d.Oc()))}h.G=function(){bg.m.G.call(this);this.Fc.qa();this.Fc=null;this.h.qa();this.h=null;var a=this.g;jd(a,function(a){a.qa()});a.clear();this.g=null};function eg(a,b,c,d){K.call(this,a,b);this.id=c;this.fe=d}E(eg,K);
function dg(a,b,c,d,e,f,g,k){vb.call(this);this.Ah=a;this.i=c||"GET";this.g=d;this.h=e||null;this.Ke=t(g)?g:1;this.qd=0;this.Jf=this.Sf=!1;this.ee=b;this.we=f;this.j=k||Ef;this.fe=null}E(dg,vb);h=dg.prototype;h.Dd=function(){return this.i};h.ra=function(){return this.g};h.Oc=function(){return this.h};h.Xf=function(){return this.j};h.G=function(){dg.m.G.call(this);delete this.ee;delete this.we};function gg(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b};function hg(){this.i=[];this.h=this.g=0};function ig(){};function jg(){this.g=[];this.j=[];this.n=[];this.i=[];this.i[0]=128;for(var a=1;64>a;++a)this.i[a]=0;this.g[0]=1732584193;this.g[1]=4023233417;this.g[2]=2562383102;this.g[3]=271733878;this.g[4]=3285377520;this.l=this.h=0}E(jg,ig);
function kg(a,b,c){c||(c=0);var d=a.n;if(x(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.g[0];c=a.g[1];for(var g=a.g[2],k=a.g[3],l=a.g[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.g[0]=a.g[0]+b&4294967295;a.g[1]=a.g[1]+c&4294967295;a.g[2]=a.g[2]+g&4294967295;a.g[3]=a.g[3]+k&4294967295;a.g[4]=a.g[4]+l&4294967295}
jg.prototype.update=function(a,b){t(b)||(b=a.length);for(var c=b-64,d=0,e=this.j,f=this.h;d<b;){if(0==f)for(;d<=c;)kg(this,a,d),d+=64;if(x(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){kg(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){kg(this,e);f=0;break}}this.h=f;this.l+=b};
function lg(a){var b=[],c=8*a.l;56>a.h?a.update(a.i,56-a.h):a.update(a.i,64-(a.h-56));for(var d=63;56<=d;d--)a.j[d]=c&255,c/=256;kg(a,a.j);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.g[d]>>e&255,++c;return b};var mg=null,ng=null;function og(a){this.g=a;this.h=new qf}og.prototype.set=function(a,b){t(b)?this.g.set(a,rf(this.h,b)):this.g.remove(a)};og.prototype.get=function(a){var b;try{b=this.g.get(a)}catch(c){return}if(null!==b)try{return pf(b)}catch(d){throw"Storage: Invalid value was encountered";}};og.prototype.remove=function(a){this.g.remove(a)};function pg(){};function qg(a){og.call(this,a)}E(qg,og);function rg(a){this.data=a}function sg(a){return!t(a)||a instanceof rg?a:new rg(a)}function tg(a){a=a.data;if(!t(a))throw"Storage: Invalid value was encountered";return a}qg.prototype.set=function(a,b){qg.m.set.call(this,a,sg(b))};qg.prototype.Pc=function(a){a=qg.m.get.call(this,a);if(!t(a)||a instanceof Object)return a;throw"Storage: Invalid value was encountered";};qg.prototype.get=function(a){return(a=this.Pc(a))?tg(a):void 0};function ug(a){og.call(this,a)}E(ug,qg);ug.prototype.set=function(a,b,c){if(b=sg(b)){if(c){if(c<D()){ug.prototype.remove.call(this,a);return}b.expiration=c}b.creation=D()}ug.m.set.call(this,a,b)};ug.prototype.Pc=function(a,b){var c=ug.m.Pc.call(this,a);if(c){var d;if(d=!b){d=c.creation;var e=c.expiration;d=!!e&&e<D()||!!d&&d>D()}if(d)ug.prototype.remove.call(this,a);else return c}};function vg(a){og.call(this,a)}E(vg,ug);function wg(){}E(wg,pg);wg.prototype.fa=function(){var a=0;nd(this.Fb(!0),function(){a++});return a};wg.prototype.clear=function(){var a=od(this.Fb(!0)),b=this;Oa(a,function(a){b.remove(a)})};function xg(a,b){og.call(this,a);this.Le=gg(b);this.Qf=new qf}E(xg,vg);h=xg.prototype;h.Le=null;h.Qf=null;
function yg(a,b){var c=new jg;c.update(gg(b));c.update(a.Le);c=lg(c);if(!w(c))throw Error("encodeByteArray takes an array as a parameter");if(!mg){mg={};ng={};for(var d=0;65>d;d++)mg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d),ng[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(d)}for(var d=ng,e=[],f=0;f<c.length;f+=3){var g=c[f],k=f+1<c.length,l=k?c[f+1]:0,m=f+2<c.length,n=m?c[f+2]:0,p=g>>2,g=(g&3)<<4|l>>4,l=(l&15)<<2|n>>6,n=n&63;
m||(n=64,k||(l=64));e.push(d[p],d[g],d[l],d[n])}return e.join("")}
function zg(a,b,c,d){if(!(0<b.length))throw Error("Non-empty salt must be provided");var e=new jg;e.update(gg(c));e.update(b);e.update(a.Le);a=new hg;var e=lg(e),f;f||(f=e.length);b=a.i;for(c=0;256>c;++c)b[c]=c;var g=0;for(c=0;256>c;++c){var g=g+b[c]+e[c%f]&255,k=b[c];b[c]=b[g];b[g]=k}a.g=0;a.h=0;f=a.g;e=a.h;b=a.i;for(c=0;1536>c;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=g;a.g=f;a.h=e;d=gg(d);var l;l||(l=d.length);f=a.g;e=a.h;b=a.i;for(c=0;c<l;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=
g,d[c]^=b[b[f]+b[e]&255];a.g=f;a.h=e;return String.fromCharCode.apply(null,d)}h.set=function(a,b,c){if(t(b)){for(var d=[],e=0;8>e;++e)d[e]=Math.floor(256*Math.random());b=new rg(zg(this,d,a,rf(this.Qf,b)));b.salt=d;xg.m.set.call(this,yg(this,a),b,c)}else xg.prototype.remove.call(this,a)};
h.Pc=function(a,b){var c=xg.m.Pc.call(this,yg(this,a),b);if(c){var d=tg(c),e=c.salt;if(!x(d)||!u(e)||!e.length)throw"Storage: Invalid value was encountered";d=zg(this,e,a,d);try{c.data=pf(d)}catch(f){throw"Storage: The value could not be decrypted";}return c}};h.remove=function(a){xg.m.remove.call(this,yg(this,a))};function Ag(a){this.g=a}E(Ag,wg);h=Ag.prototype;h.set=function(a,b){try{this.g.setItem(a,b)}catch(c){if(0==this.g.length)throw"Storage mechanism: Storage disabled";throw"Storage mechanism: Quota exceeded";}};h.get=function(a){a=this.g.getItem(a);if(!x(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return a};h.remove=function(a){this.g.removeItem(a)};h.fa=function(){return this.g.length};
h.Fb=function(a){var b=0,c=this.g,d=new ld;d.g=function(){if(b>=c.length)throw kd;var d=c.key(b++);if(a)return d;d=c.getItem(d);if(!x(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};h.clear=function(){this.g.clear()};h.key=function(a){return this.g.key(a)};function Bg(){var a=null;try{a=window.localStorage||null}catch(b){}this.g=a}E(Bg,Ag);var Cg=!H||H&&9<=Yb,Dg=!Jb&&!H||H&&H&&9<=Yb||Jb&&Wb("1.9.1"),Eg=H&&!Wb("9");function Fg(a){a=a.className;return x(a)&&a.match(/\S+/g)||[]}function Gg(a,b){for(var c=Fg(a),d=cb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)Va(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function Hg(a,b){var c=Fg(a),d=cb(arguments,1),e=Ig(c,d);a.className=e.join(" ");return e.length==c.length-d.length}function Ig(a,b){return Pa(a,function(a){return!Va(b,a)})};function Jg(a,b){this.x=t(a)?a:0;this.y=t(b)?b:0}Jg.prototype.ea=function(){return new Jg(this.x,this.y)};Jg.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Kg(a,b){return new Jg(a.x-b.x,a.y-b.y)}Jg.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};Jg.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function Lg(a,b){this.width=a;this.height=b}h=Lg.prototype;h.ea=function(){return new Lg(this.width,this.height)};h.toString=function(){return"("+this.width+" x "+this.height+")"};h.Va=function(){return!(this.width*this.height)};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Mg(a){return a?new Ng(Og(a)):qa||(qa=new Ng)}function Pg(a,b){var c=b||document,d=null;c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):(c=b||document,d=(c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):Qg(document,"*",a,b))[0]);return d||null}
function Qg(a,b,c,d){a=d||a;b=b&&"*"!=b?b.toUpperCase():"";if(a.querySelectorAll&&a.querySelector&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){d={};for(var e=0,f=0,g;g=a[f];f++)b==g.nodeName&&(d[e++]=g);d.length=e;return d}return a}a=a.getElementsByTagName(b||"*");if(c){d={};for(f=e=0;g=a[f];f++)b=g.className,"function"==typeof b.split&&Va(b.split(/\s+/),c)&&(d[e++]=g);d.length=e;return d}return a}
function Rg(a,b){kc(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Sg?a.setAttribute(Sg[d],b):ra(d,"aria-")||ra(d,"data-")?a.setAttribute(d,b):a[d]=b})}var Sg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Tg(a){return Kb||"CSS1Compat"!=a.compatMode?a.body||a.documentElement:a.documentElement}function Ug(a){return a.parentWindow||a.defaultView}function Vg(a,b,c){function d(c){c&&b.appendChild(x(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!w(f)||A(f)&&0<f.nodeType?d(f):Oa(Wg(f)?$a(f):f,d)}}function Xg(a){for(var b;b=a.firstChild;)a.removeChild(b)}function Yg(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)}function Zg(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function $g(a){if(void 0!=a.firstElementChild)a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function ah(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Og(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function bh(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else Xg(a),a.appendChild(Og(a).createTextNode(String(b)))}var ch={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},dh={IMG:" ",BR:"\n"};function eh(a){a=a.getAttributeNode("tabindex");return null!=a&&a.specified}function fh(a){a=a.tabIndex;return y(a)&&0<=a&&32768>a}
function gh(a){var b=[];hh(a,b,!1);return b.join("")}function hh(a,b,c){if(!(a.nodeName in ch))if(3==a.nodeType)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in dh)b.push(dh[a.nodeName]);else for(a=a.firstChild;a;)hh(a,b,c),a=a.nextSibling}function Wg(a){if(a&&"number"==typeof a.length){if(A(a))return"function"==typeof a.item||"string"==typeof a.item;if(ga(a))return"function"==typeof a.item}return!1}
function ih(a){return jh(a,function(a){return Va(Fg(a),"sidebar")})}function jh(a,b){for(var c=0;a;){if(b(a))return a;a=a.parentNode;c++}return null}function Ng(a){this.g=a||r.document||document}h=Ng.prototype;h.p=function(a){return x(a)?this.g.getElementById(a):a};
h.A=function(a,b,c){var d=this.g,e=arguments,f=e[0],g=e[1];if(!Cg&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',xa(g.name),'"');if(g.type){f.push(' type="',xa(g.type),'"');var k={};uc(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=d.createElement(f);g&&(x(g)?f.className=g:u(g)?Gg.apply(null,[f].concat(g)):Rg(f,g));2<e.length&&Vg(d,f,e);return f};h.createElement=function(a){return this.g.createElement(a)};function kh(a){return"CSS1Compat"==a.g.compatMode}
function lh(a){var b=a.g;a=Tg(b);b=Ug(b);return H&&Wb("10")&&b.pageYOffset!=a.scrollTop?new Jg(a.scrollLeft,a.scrollTop):new Jg(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}h.appendChild=function(a,b){a.appendChild(b)};h.rh=Yg;h.getChildren=function(a){return Dg&&void 0!=a.children?a.children:Pa(a.childNodes,function(a){return 1==a.nodeType})};h.Wf=$g;h.contains=ah;H&&Wb(8);function mh(a,b){null!=a&&this.Yf.apply(this,arguments)}h=mh.prototype;h.Da="";h.set=function(a){this.Da=""+a};h.Yf=function(a,b,c){this.Da+=a;if(null!=b)for(var d=1;d<arguments.length;d++)this.Da+=arguments[d];return this};h.clear=function(){this.Da=""};h.toString=function(){return this.Da};function nh(a,b,c){vb.call(this);this.h=a;this.n=b||0;this.i=c;this.l=B(this.j,this)}E(nh,vb);nh.prototype.g=0;nh.prototype.G=function(){nh.m.G.call(this);this.stop();delete this.h;delete this.i};function oh(a){a.stop();a.g=of(a.l,t(void 0)?void 0:a.n)}nh.prototype.stop=function(){0!=this.g&&r.clearTimeout(this.g);this.g=0};function ph(a){a.stop();a.j()}nh.prototype.j=function(){this.g=0;this.h&&this.h.call(this.i)};function qh(a,b,c){vb.call(this);this.j=a;this.i=b;this.h=c;this.g=B(this.wh,this)}E(qh,vb);h=qh.prototype;h.be=!1;h.ca=null;function rh(a){a.ca?a.be=!0:sh(a)}h.stop=function(){this.ca&&(r.clearTimeout(this.ca),this.ca=null,this.be=!1)};h.G=function(){qh.m.G.call(this);this.stop()};h.wh=function(){this.ca=null;this.be&&(this.be=!1,sh(this))};function sh(a){a.ca=of(a.g,a.i);a.j.call(a.h)};R("ydn");var th=Math.pow(2,3),uh=Math.pow(2,6);function vh(){L.call(this);this.key=this.g=void 0}E(vh,L);vh.prototype.R=function(a,b){if("boolean"!=typeof b)throw Error("Invalid value");if("number"!=typeof a||0>a)throw Error("Invalid state");"undefined"==typeof this.g&&(this.g=0);this.g=b?this.g|a:this.g&~a};function wh(a){a.R(th,!0);of(function(){this.dispatchEvent(xh)},0,a)}var xh="a";function yh(a,b,c){K.call(this,a,b);this.url=c}E(yh,K);R("ydn");function zh(a){return!x(a)||ta(a)?{}:JSON.parse(a)}function Ah(a){var b;try{b=S(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function S(a){return JSON.stringify(a,void 0,void 0)};R("ydn.Store");function Bh(a,b){if(b&&!a)throw Error("Can't create document with namespace and no root tag");if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument(b||"",a||"",null);if("undefined"!=typeof ActiveXObject){var c=Ch();if(c)return a&&c.appendChild(c.createNode(1,a,b||"")),c}throw Error("Your browser does not support creating new documents");}
function Dh(a){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(a,"application/xml");if("undefined"!=typeof ActiveXObject){var b=Ch();b.loadXML(a);return b}throw Error("Your browser does not support loading xml documents");}function Eh(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if(a=a.xml)return a;throw Error("Your browser does not support serializing XML documents");}
function Ch(){var a=new ActiveXObject("MSXML2.DOMDocument");if(a){a.resolveExternals=!1;a.validateOnParse=!1;try{a.setProperty("ProhibitDTD",!0),a.setProperty("MaxXMLSize",2048),a.setProperty("MaxElementDepth",256)}catch(b){}}return a};function Fh(a){Error.captureStackTrace?Error.captureStackTrace(this,Fh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}E(Fh,Error);function Gh(a){Error.captureStackTrace?Error.captureStackTrace(this,Gh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}E(Fh,Error);Gh.prototype.name="ydn.error.NotSupportedException";
function Hh(a){Error.captureStackTrace?Error.captureStackTrace(this,Hh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}E(Hh,Error);function Ih(a){Error.captureStackTrace?Error.captureStackTrace(this,Ih):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}E(Ih,Error);Ih.prototype.name="ydn.InternalError";
function Jh(a){Error.captureStackTrace?Error.captureStackTrace(this,Jh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}E(Jh,Error);Jh.prototype.name="ydn.error.ConstraintError";function Kh(a){Error.captureStackTrace?Error.captureStackTrace(this,Kh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}E(Fh,Error);
function Lh(a){Error.captureStackTrace?Error.captureStackTrace(this,Lh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}E(Lh,Error);var Mh,Nh,Oh,Ph;Ph=Oh=Nh=Mh=!1;var Qh=Eb();Qh&&(-1!=Qh.indexOf("Firefox")?Mh=!0:-1!=Qh.indexOf("Camino")||(-1!=Qh.indexOf("iPhone")||-1!=Qh.indexOf("iPod")?Nh=!0:-1!=Qh.indexOf("iPad")?Oh=!0:-1!=Qh.indexOf("Chrome")&&(Ph=!0)));var Rh=Mh,Sh=Nh,Th=Oh,Uh=Ph;function Vh(a){if(!u(a))throw new Fh("Array required.");if(t(void 0))return a=Qa(a,function(a){return a[void 0]}),Vh(a);for(var b=Number.NaN,c=-1,d=0;d<a.length;d++)!isNaN(a[d])&&(isNaN(b)||a[d]>b)&&(b=a[d],c=d);return{value:b,index:c}};function Wh(){vh.call(this);this.h=null;Dc(this,"user-login",this.mg,!1,this);Dc(this,"user-logout",this.mg,!1,this);this.o=window.top.location.href.replace(/[?#]\S+/,"")}E(Wh,vh);function Xh(a){var b=chrome.extension.getURL(Yh);a.o=b}h=Wh.prototype;h.logger=R("ydn.api.AbstractUser");h.mg=function(){this.display?(this.display.i(this.l||""),this.isLogin()?this.j&&this.display.h(this.j):this.i&&this.display.g(this.i),Q(this.logger,"Refreshed.")):Q(this.logger,"No UI refreshed.")};
h.toJSON=function(){return{nickname:this.n,email:this.l,is_login:this.h,login_url:this.i,logout_url:this.j,user_id:this.user_id}};h.isLogin=function(){return!0===this.h};h.toString=function(){return"User:"+(!0===this.h?this.l:!1===this.h?"logout":"?")};h.ad=0;
function Zh(a,b){!b&&a.isLogin()?Q(a.logger,"Already login"):(a.zc||(a.zc=new qh(function(){this.isLogin()?this.zc.stop():1<this.ad?(O(this.logger,"Cannot login to the API server, tried "+this.ad+" times."),this.zc.stop(),this.ad=0):(this.ad++,this.Yc())},5E3,a)),a.ad=0,rh(a.zc))}h.refresh=function(a){Zh(this,a)};function $h(a,b,c){yh.call(this,a,b,c)}E($h,yh);function ai(){Wh.call(this)}E(ai,Wh);ai.prototype.logger=R("ydn.api.User");
ai.prototype.load=function(a){df(this.logger,"getting user info");if(a.logout_url)return this.n=a.nickname,this.l=a.email,this.user_id=a.user_id,this.h=a.is_login,this.j=a.logout_url,this.i=a.login_url,df(this.logger,a.email+" login"),this.j=a.logout_url,this.user_id=a.Id?a.Id.$t:void 0,this.h=!0,this.i=void 0,this.R(uh,!0),wh(this),!0;a.login_url&&(df(this.logger,"NO user"),this.i=a.login_url,this.h=!1,this.l=this.user_id=this.j=this.n=void 0,this.R(uh,!0),wh(this));return!1};
ai.prototype.s=function(a,b){Q(this.logger,"Receiving "+(b.Aa()?"":"fail")+" login info from server.");if(b.Aa()){var c=a.User;if(c){var d;d=this.load(c)?new $h("user-login",this,this.j):new $h("user-logout",this,this.i);of(function(){this.dispatchEvent(d)},0,this)}}else O(this.logger,"Server return error with: "+b.Ga());this.zc&&this.zc.stop()};
function bi(a,b){var c=new F,d=ci(di);if(!d)return tb("login server not available.");var e={pm:a.o,state:Math.random().toString().substr(2,6)};if(b)for(var f in b)e[f]=b[f];d.request(new ei("/rpc_login","GET",e)).execute(function(a,b){a?c.u(a.User):c.w(b)},a);return c}ai.prototype.Yc=function(){df(this.logger,"Sending login request.");var a=ci(di),b=window.top.location.href.replace(/[?#]\S+/,"");a.request(new ei("/rpc_login","GET",{url:b})).execute(B(this.s,this));return!1};function fi(){this.g=D()}var gi=new fi;fi.prototype.set=function(a){this.g=a};fi.prototype.get=function(){return this.g};function hi(a){this.j=a||"";this.l=gi}hi.prototype.g=!0;hi.prototype.h=!1;function ii(a){a=new Date(a.l);return ji(a.getFullYear()-2E3)+ji(a.getMonth()+1)+ji(a.getDate())+" "+ji(a.getHours())+":"+ji(a.getMinutes())+":"+ji(a.getSeconds())+"."+ji(Math.floor(a.getMilliseconds()/10))}function ji(a){return 10>a?"0"+a:String(a)}function ki(a,b){var c=(a.l-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function li(a){hi.call(this,a)}E(li,hi);li.prototype.h=!0;
li.prototype.i=function(a){var b;switch(a.j.value){case Se.value:b="dbg-sh";break;case Te.value:b="dbg-sev";break;case Ue.value:b="dbg-w";break;case Ve.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.j," ");this.g&&c.push("[",ii(a),"] ");c.push("[",Ea(ki(a,this.l.get())),"s] ");c.push("[",xa(a.h),"] ");c.push('<span class="',b,'">',wa(Ea(xa(a.getMessage()))));this.h&&a.i&&c.push("<br>",wa(Ea(a.g||"")));c.push("</span>");c.push("<br>");return c.join("")};
function mi(a){hi.call(this,a)}E(mi,hi);mi.prototype.i=function(a){var b=[];b.push(this.j," ");this.g&&b.push("[",ii(a),"] ");b.push("[",ki(a,this.l.get()),"s] ");b.push("[",a.h,"] ");b.push(a.getMessage());this.h&&a.i&&b.push("\n",a.g);b.push("\n");return b.join("")};function ni(){this.j=B(this.n,this);this.g=new mi;this.g.g=!1;this.h=this.g.h=!1;this.i="";this.l={}}function oi(a){var b=pi;if(a!=b.h){var c=hf();a?bf(c,b.j):(c=c.g)&&Xa(c,b.j);b.h=a}}ni.prototype.n=function(a){if(!this.l[a.h]){var b=this.g.i(a),c=qi;if(c)switch(a.j){case Se:si(c,"info",b);break;case Te:si(c,"error",b);break;case Ue:si(c,"warn",b);break;default:si(c,"debug",b)}else window.opera?window.opera.postError(b):this.i+=b}};var qi=window.console;
function si(a,b,c){if(a[b])a[b](c);else a.log(c)};function ti(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}h=ti.prototype;h.ea=function(){return new ti(this.top,this.right,this.bottom,this.left)};h.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};h.contains=function(a){return this&&a?a instanceof ti?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1};
h.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};h.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};function ui(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}h=ui.prototype;h.ea=function(){return new ui(this.left,this.top,this.width,this.height)};h.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};h.contains=function(a){return a instanceof ui?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
h.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function vi(a,b){var c=Og(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""}function wi(a,b){return vi(a,b)||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}
function xi(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}H&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function yi(a){if(H&&!(H&&8<=Yb))return a.offsetParent;var b=Og(a),c=wi(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=wi(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}
function zi(a){for(var b=new ti(0,Infinity,Infinity,0),c=Mg(a),d=c.g.body,e=c.g.documentElement,f=Tg(c.g);a=yi(a);)if(!(H&&0==a.clientWidth||Kb&&0==a.clientHeight&&a==d||a==d||a==e||"visible"==wi(a,"overflow"))){var g=Ai(a),k;k=a;if(Jb&&!Wb("1.9")){var l=parseFloat(vi(k,"borderLeftWidth"));if(Bi(k))var m=k.offsetWidth-k.clientWidth-l-parseFloat(vi(k,"borderRightWidth")),l=l+m;k=new Jg(l,parseFloat(vi(k,"borderTopWidth")))}else k=new Jg(k.clientLeft,k.clientTop);g.x+=k.x;g.y+=k.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(Ug(c.g)||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new Lg(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}
function Ai(a){var b,c=Og(a),d=wi(a,"position"),e=Jb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Jg(0,0),g;b=c?Og(c):document;g=!H||H&&9<=Yb||kh(Mg(b))?b.documentElement:b.body;if(a==g)return f;if(a.getBoundingClientRect)b=xi(a),a=lh(Mg(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=
b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(Kb&&"fixed"==wi(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Ib||Kb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=yi(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,Ib&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}function Ci(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function Di(a){var b=Ei;if("none"!=wi(a,"display"))return b(a);var c=a.style,d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}function Ei(a){var b=a.offsetWidth,c=a.offsetHeight,d=Kb&&!b&&!c;return t(b)&&!d||!a.getBoundingClientRect?new Lg(b,c):(a=xi(a),new Lg(a.right-a.left,a.bottom-a.top))}function Fi(a){var b=Ai(a);a=Di(a);return new ui(b.x,b.y,a.width,a.height)}
function T(a,b){a.style.display=b?"":"none"}function Bi(a){return"rtl"==wi(a,"direction")}var Gi=Jb?"MozUserSelect":Kb?"WebkitUserSelect":null;function Hi(a,b,c){c=c?null:a.getElementsByTagName("*");if(Gi){if(b=b?"none":"",a.style[Gi]=b,c){a=0;for(var d;d=c[a];a++)d.style[Gi]=b}}else if(H||Ib)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;d=c[a];a++)d.setAttribute("unselectable",b)}
function Ii(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}function Ji(a,b){var c=a.currentStyle?a.currentStyle[b]:null;return c?Ii(a,c):0}var Ki={thin:2,medium:4,thick:6};
function Li(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:null))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:null;return c in Ki?Ki[c]:Ii(a,c)}function Mi(a){if(H&&!(H&&9<=Yb)){var b=Li(a,"borderLeft"),c=Li(a,"borderRight"),d=Li(a,"borderTop");a=Li(a,"borderBottom");return new ti(d,c,a,b)}b=vi(a,"borderLeftWidth");c=vi(a,"borderRightWidth");d=vi(a,"borderTopWidth");a=vi(a,"borderBottomWidth");return new ti(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))}var Ni=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Oi(a){this.l=B(this.n,this);this.h=new li;this.i=this.h.g=!1;this.g=a;this.j=this.g.ownerDocument||this.g.document;a=Mg(this.g);var b=null,c=a.g;if(H&&c.createStyleSheet)a=b=c.createStyleSheet(),H&&t(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";else{c=Qg(a.g,"head",void 0,void 0)[0];c||(b=Qg(a.g,"body",void 0,void 0)[0],c=a.A("head"),b.parentNode.insertBefore(c,b));var d=b=a.A("style");H&&t(d.cssText)?d.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
d.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";a.appendChild(c,b)}this.g.className+=" logdiv"}
Oi.prototype.n=function(a){var b=100>=this.g.scrollHeight-this.g.scrollTop-this.g.clientHeight,c=this.j.createElement("div");c.className="logmsg";c.innerHTML=this.h.i(a);this.g.appendChild(c);b&&(this.g.scrollTop=this.g.scrollHeight)};Oi.prototype.clear=function(){this.g.innerHTML=""};var pi=null,Pi=null;R("ydn.debug");function Qi(a,b,c){if(y(b))b=new Re("log",b);else if(x(b)){b=b.toUpperCase();if(!af){af={};for(var d=0,e;e=$e[d];d++)af[e.value]=e,af[e.name]=e}b=af[b]||null}else b=Xe;R(a||"ydn").h=b;t(c)?Pi||(a=Pi=new Oi(c),!0!=a.i&&(c=hf(),bf(c,a.l),a.i=!0),hf().h=Ue):pi||Pi||(pi=new ni,oi(!0),hf().h=Ue)}var Ri=null;function Si(a){Ri&&setTimeout(function(){Ri.log(a)},10)};var di="login",Ti=R("ydn.http"),Ui={},Vi=[];var Wi,Xi={},Yi=[];function Zi(a,b){Xi[b||"default"]=a}function ci(a){if(!t(a))return Xi["default"];for(var b=a,c=0;c<Yi.length;c++){var d=(0,Yi[c])(a);if(d){b=d;break}}return Xi[b]||null}function $i(){Wi||(Wi=new bg);return Wi}function aj(a,b,c,d){x(a)?this.Bc=a:(this.Bc=null,this.status=a,this.body=b,this.headers=c||{},this.g=d)}function bj(a){if(a.Bc){var b=zh(a.Bc);b.gapiRequest&&(b=b.gapiRequest.data);a.status=b.status;a.g=b.statusText;a.headers=b.headers;a.body=b.body;a.Bc=null}}
aj.prototype.N=function(){bj(this);return this.status};aj.prototype.Aa=function(){bj(this);return 200<=this.status&&400>this.status};aj.prototype.Ga=function(){bj(this);return this.g||""};function cj(a){bj(a);return a.body}function dj(a,b){bj(a);return a.headers[b]}aj.prototype.Oc=function(){bj(this);return this.headers};
function ej(a){var b;bj(a);"application/json"==dj(a,"content-type")?b=!0:(b=a.body,b=x(b)&&!ta(b)?/^[\],:{}\s]*$/.test(b.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")):!1);return b&&x(a.body)?JSON.parse(a.body):a.body}function fj(a){return a instanceof aj?a:x(a)?new aj(a):new aj(a.status,a.body,a.headers,a.statusText)}
function ei(a,b,c,d,e){this.path=a;this.method=b?b.toUpperCase():"GET";this.params=c||{};this.headers=d||{};this.body=e}var gj=null;function hj(a,b,c,d){this.l=t(b)?b:$i();this.j="sr"+ij++;this.n=c||0;this.o=!!d;this.g=a}var ij=0;hj.prototype.D=function(){return this.j};
hj.prototype.execute=function(a,b){var c=this.g,d=new vd(c.path),e;for(e in c.params)d.g.set(e,c.params[e]);this.l.send(this.j,d.toString(),c.method,c.body,c.headers,void 0,function(d){d=d.target;for(var e=(d.Q&&4==Pf(d)?d.Q.getAllResponseHeaders():"").split("\n"),k={},l=0;l<e.length;l++){var m=e[l].indexOf(":");0<m&&(k[e[l].substr(0,m).toLowerCase()]=e[l].substr(m+1).trim())}e=l=Qf(d);if(k["content-type"]&&/json/.test(k["content-type"]))if(A(l))e=l;else if(x(l))try{e=zh(l)}catch(n){e=l}k=new aj(d.N(),
l,k,d.Ga());gj&&!k.Aa()&&gj.log({"class":"ydn.gdata.Entry",method:"commit",context:"HTTP request",HttpRequestData:{path:c.path,uri:String(d.s),method:c.method,params:c.params,headers:c.headers,body:c.body},HttpRespondData:{status:k.N(),statusText:k.Ga(),body:cj(k),headers:k.Oc()}});a&&(a.call(b,e,k),a=null)},this.n,void 0,this.o);this.l=null};hj.prototype.toString=function(){return"HTTPRequest:"+this.j};function jj(a,b,c){this.h=a;this.i=b;this.g=null;this.Bh=t(c)?c:!0}jj.prototype.request=function(a){return new kj(a,this)};function kj(a,b){hj.call(this,a,b.i);this.parent=b}E(kj,hj);var lj=new aj(0,null,null,"No access token");
kj.prototype.execute=function(a,b){function c(){this.Bh?d.g.headers.Authorization="Bearer "+d.parent.g.access_token:d.g.params.access_token=d.parent.g.access_token}var d=this;d.parent.g&&d.parent.g.expires>D()?(c(),kj.m.execute.call(this,function(e,f){401==f.N()?mj(d.parent.h).t(function(e){d.parent.g=e;c();kj.m.execute.call(d,a,b)},function(){d.parent.g=null;a.call(b,null,lj)},d):a.call(b,e,f)},this)):mj(this.parent.h).t(function(e){d.parent.g=e;c();kj.m.execute.call(this,a,b)},function(){d.parent.g=
null;a.call(b,null,lj)},this)};function U(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ga(Object.freeze)&&Object.freeze(this)}U.prototype.lower=void 0;U.prototype.upper=void 0;U.prototype.toJSON=function(){return nj(this)};function oj(a){return pj(a)}U.only=function(a){return new U(a,a,!1,!1)};U.bound=function(a,b,c,d){return new U(a,b,c,d)};U.upperBound=function(a,b){return new U(void 0,a,void 0,!!b)};U.lowerBound=function(a,b){return new U(a,void 0,!!b,void 0)};
function qj(a){var b;if(u(a))b=$a(a),b.push("\uffff");else if(x(a))b=a+"\uffff";else if(y(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return U.only(a);return U.bound(a,b,!1,!0)}function nj(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function rj(a){if(null==a)return null;if(a instanceof U)return a;if(A(a))return new U(a.lower,a.upper,a.lowerOpen,a.upperOpen);throw new M("Invalid key range: "+a+" of type "+typeof a);}
function pj(a){return null!=a?null!=a.upper&&null!=a.lower?sj.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?sj.upperBound(a.upper,a.upperOpen):null!=a.lower?sj.lowerBound(a.lower,a.lowerOpen):null:null}function tj(a){if(a instanceof U)return"";if(null!=a){if(A(a)){for(var b in a)if(a.hasOwnProperty(b)&&!Va(["lower","upper","lowerOpen","upperOpen"],b))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
U.prototype.ue=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return U.bound(b,c,d,e)};function uj(a){if(!a)return"";var b=a.lowerOpen?"(":"[";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function vj(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==wj(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(xj(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(xj(c.upper,b)))}else d.push(a+" = ?"),e.push(xj(c.lower,b))}var sj=r.IDBKeyRange||r.webkitIDBKeyRange||U;function yj(a,b){var c,d;2==arguments.length&&x(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=w(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}function zj(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)A(a[e])||(a[e]={}),a=a[e];a[d]=c}}var Aj={};
function Bj(a){a=[a];for(var b=new Cj,c=0,d,e;void 0!==(e=a.pop());){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(Aj);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),Dj(b,e);else if(e instanceof Date)c+=2,b.write(c),Dj(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>
2|255,(f|3)<<6)}c.write(0)}else if(e===Aj)b.write(0);else return"";c=0}return b.trim().toString()}function Ej(a){for(var b=[],c=b,d=[],e,f,g=new Fj(a);null!=g.read();)if(0===g.current)c=d.pop();else{if(null===g.current)break;do{e=g.current/4|0;a=g.current%4;for(var k=0;k<e;k++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.current+4)g.read();else break}while(1);1===a?c.push(Gj(g)):2===a?c.push(new Date(Gj(g))):3===a?c.push(Hj(g)):0===a&&(c=d.pop())}return b[0]}
function Dj(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Gj(a){var b=a.read()|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=a.read()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.read()|0):a.read()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Hj(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.read();if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Fj(a){this.current=null;this.g=a;this.h=this.g.length-1;this.index=-1}
Fj.prototype.read=function(){return this.current=this.index<this.h?parseInt(this.g[++this.index]+this.g[++this.index],16):null};function Cj(){this.g=[];this.h=void 0}Cj.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.h=arguments[b].toString(16),this.g.push(2===this.h.length?this.h:this.h="0"+this.h)};Cj.prototype.trim=function(){for(var a=this.g.length;"00"===this.g[--a];);this.g.length=++a;return this};Cj.prototype.toString=function(){return this.g.length?this.g.join(""):""};
function Ij(a,b){var c=Bj(a),d=Bj(b);return c>d?1:c==d?0:-1};function Jj(a,b,c,d,e){if(!(b instanceof U))if(x(b)&&t(c)){var f,g,k,l;if("starts"==b||"^"==b)b=qj(c);else{if("<"==b||"<="==b)f=c,k="<"==b;else if(">"==b||">="==b)g=c,l=">"==b;else if("="==b||"=="==b)f=g=c;else throw new M("invalid op: "+b);if("<"==d||"<="==d)f=e,k="<"==d;else if(">"==d||">="==d)g=e,l=">"==d;else if(t(d))throw new M("invalid op2: "+d);b=U.bound(g,f,l,k)}}else b=rj(b);this.g=b;this.ac=a}Jj.prototype.ac="";
Jj.prototype.ue=function(a){if(this.ac!=a.ac)return null;a=null!=this.g&&null!=a.g?this.g.ue(a.g):this.g||a.g;return new Jj(this.ac,a)};var Kj={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Lj=r.IDBRequest&&"LOADING"in r.IDBRequest?r.IDBTransaction:r.webkitIDBRequest&&"LOADING"in r.webkitIDBRequest&&1===r.webkitIDBTransaction.READ_WRITE?r.webkitIDBTransaction:Kj,Mj=Lj.READ_ONLY,Nj=Lj.READ_WRITE,Oj=Lj.VERSION_CHANGE,Pj=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.moz_indexedDB||r.msIndexedDB;function Qj(a,b,c,d){vb.call(this);this.i=c;this.O=c.getName();this.yb=void 0;this.j=!1;this.aa=null;this.n=a;this.md=b;this.Pa=0;this.xa=this.H=!1;this.na=d||4;this.o=this.h=this.g=void 0;this.P=function(){throw new Tc;};this.V=function(){throw new Tc;};this.Hc=function(){}}E(Qj,vb);h=Qj.prototype;
h.init=function(a,b,c,d,e){if(t(b)){a=this.i;var f,g=b;u(b)?(f=Rj(a,b),g=b.join(", ")):f=Sj(a,b);if(!f)throw new M('require index "'+g+'" not found in store "'+a.getName()+'"');this.yb=f.getName()}this.j=x(this.yb);this.aa=c||null;this.Pa=0;this.xa=this.H=!1;this.reverse="prev"==d||"prevunique"==d;this.unique="nextunique"==d||"prevunique"==d;this.Db=d;this.Xc=e;this.o=this.h=this.g=void 0};h.Db="";h.aa=null;h.unique=!1;h.reverse=!1;h.Xc=!0;h.logger=R("ydn.db.core.req.AbstractCursor");
h.jc=function(a,b,c){null==a&&(P(this.logger,this+" finished."),this.H=!0);this.g=a;this.h=b;this.o=c;this.Pa++;this.H?(Q(this.logger,this+" DONE."),this.P(),Tj(this)):(Q(this.logger,this+" new cursor position {"+(this.j?this.g+", "+this.h:this.g)+"}"),this.P(this.g))};h.G=function(){this.n=null};h.toString=function(){return"Cursor:"+this.O+(t(this.yb)?":"+this.yb:"")+"["+(this.n?"":"~")+this.md+"]"};
function Tj(a){null!=a.h?a.h=Uj(a.h):a.h=void 0;null!=a.g?a.g=Uj(a.g):a.g=void 0;a.Hc(a.xa,a.g,a.h)}function Vj(a){a.xa=!0;Q(a.logger,a+": exit");Tj(a)}h.fa=function(){return this.Pa};h.ga=function(){return this.j?this.h:this.g};h.T=function(){return this.Xc?this.ga():this.o};h.vd=function(){};function Wj(){};function Xj(a,b,c,d,e,f,g){if(!x(a))throw new TypeError("store name must be a string, but "+a+" found.");this.i=a;this.h=b;this.n=g;this.o=!!this.h;if(t(d)&&!fa(d))throw new M("reverse value must be a boolean, but "+typeof d+" found");if(t(e)&&!fa(e))throw new M("unique value must be a boolean, but "+typeof e+" found");if(t(f)&&!fa(f))throw new M("key_only value must be a boolean, but "+typeof f+" found");this.g=t(f)?f:!!x(this.h);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.l=
a;if(d=tj(c))throw new M("Invalid key range: "+d);this.j=pj(c);this.s=Yj;this.K=NaN}E(Xj,Wj);Xj.prototype.g=!0;function Zj(a,b,c,d,e){if(!x(b))throw new M("index name must be string");Xj.call(this,a,b,c,d,e,!0)}E(Zj,Xj);function ak(a,b,c){if(3<arguments.length)throw new M("too many argument");Xj.call(this,a,void 0,b,c,void 0,!1)}E(ak,Xj);function bk(a,b,c,d,e){if(!x(b))throw new M("index name must be string");Xj.call(this,a,b,c,d,e,!1)}E(bk,Xj);var Yj="init";h=Xj.prototype;h.logger=R("ydn.db.Iterator");
h.F=function(){return this.i};h.ea=function(){var a=new Xj(this.i,this.h,this.j,ck(this),dk(this),this.g,this.n);a.K=this.K;return a};h.unique=function(a){return new Xj(this.i,this.h,this.j,ck(this),a,this.g,this.n)};h.toJSON=function(){return{store:this.i,index:this.h,keyRange:this.j?nj(this.j):null,direction:this.l}};
h.toString=function(){var a=t(this.n)?":"+this.n.join(","):t(this.h)?":"+this.h:"",a=a+uj(this.j);this.s!=Yj&&(a+=this.s+"{"+this.H,this.o&&(a+=", "+this.I),a+="}");var b=this.o?"Index":"",b=b+(this.g?"Key":"Value");return b+"Iterator:"+this.i+a};h.reverse=function(){return new Xj(this.i,this.h,this.j,!ck(this),dk(this),this.g,this.n)};function ck(a){return"prev"===a.l||"prevunique"===a.l}function dk(a){return"nextunique"===a.l||"prevunique"===a.l}
h.load=function(a){a=a[0];a.init(this.i,this.n||this.h,this.j,this.l,this.g);this.s="busy";var b=this;a.Hc=function(a,d,e){b.H=d;b.I=e;b.s=a?"rest":"done"};a.openCursor(this.H,this.I);return a};h.ga=function(){return this.I};h.stores=function(){return[this.i]};function ek(a,b,c){Uc.call(this,b,c);this.s=a;this.j=[];this.o=[];this.P=[];this.g=null;this.mb="";this.H=0}E(ek,Uc);h=ek.prototype;h.mb="";h.logger=R("ydn.db.Request");function fk(a,b,c){a.g=b;a.mb=c;P(a.logger,a+" BEGIN");if(b){for(c=0;c<a.o.length;c++)a.o[c][0].call(a.o[c][1],b);a.o.length=0}P(a.logger,a+" END")}function gk(a){var b=new ek(a.s);a.H++;fk(b,a.g,a.mb+"C"+a.H);return b}h.Dd=function(){return this.s};
h.abort=function(){if(this.g)if(P(this.logger,this+" aborting"),ga(this.g.abort))this.g.abort();else if(ga(this.g.executeSql))this.g.executeSql("ABORT",[],function(){},function(){return!0});else throw new Qc;else throw new hk("No active transaction");};function V(a,b,c){var d=a.P.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){V(a,b,c)}):c?a.w(b):a.u(b)}function ik(a,b,c){a.P.push([b,c])}function W(a,b,c){a.g?b.call(c,a.g):a.o.push([b,c])}
h.u=function(a){P(this.logger,this+" SUCCESS");ek.m.u.call(this,a);this.g=null;this.mb=this.mb};h.w=function(a){P(this.logger,this+" ERROR");ek.m.w.call(this,a);this.g=null;this.mb=this.mb};function X(a){var b="";a.mb&&(b=a.g?"*":"",b="["+a.mb+b+"]");return a.s+b}function jk(a,b){var c=new ek(a);V(c,b);return c}h.toString=function(){return"Request:"+X(this)};
h.Ce=function(){this.n&&this.rb&&rb(this)&&(r.clearTimeout(this.n),delete this.n);this.h&&(this.h.rd--,delete this.h);for(var a=this.i,b=!1;this.l.length&&!this.Jc;){var c=this.l.shift(),d=c[0],e=c[1],c=c[2];if(d=this.Lb?e:d)d=d.call(c||this.I,a),t(d)&&(this.Lb=this.Lb&&(d==a||d instanceof Error),this.i=a=d),a instanceof F&&(this.Jc=b=!0)}this.i=a;b&&(a.t(B(this.wd,this,!0),B(this.wd,this,!1)),a.Of=!0)};
h.toJSON=function(){var a=(this.mb||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.s?this.s.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var wj=Pj&&Pj.cmp?B(Pj.cmp,Pj):Ij,kk=[];(function(a){if(null!=a&&!("push"in a))throw new Fh('output receiver object must have "push" method.');}).prototype.logger=R("ydn.db.algo.AbstractSolver");function lk(a){Error.captureStackTrace?Error.captureStackTrace(this,lk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}E(lk,Error);lk.prototype.name="ConstraintError";lk.prototype.toString=function(){return this.name+": "+this.message};function mk(a){Error.captureStackTrace?Error.captureStackTrace(this,mk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}E(mk,Error);
mk.prototype.toString=function(){return this.name+": "+this.message};function nk(a){Error.captureStackTrace?Error.captureStackTrace(this,nk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}E(nk,Error);nk.prototype.name="ydn.db.VersionError";nk.prototype.toString=function(){return this.name+": "+this.message};function ok(a){Error.captureStackTrace?Error.captureStackTrace(this,ok):this.stack=Error().stack||"";a&&(this.message=String(a))}E(ok,Error);
ok.prototype.name="ydn.db.InternalError";function hk(a){Error.captureStackTrace?Error.captureStackTrace(this,hk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}E(hk,Error);function pk(a){Error.captureStackTrace?Error.captureStackTrace(this,pk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}E(pk,Error);
function qk(a){Error.captureStackTrace?Error.captureStackTrace(this,qk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}E(qk,Error);qk.prototype.name="NotFoundError";qk.prototype.toString=function(){return this.name+": "+this.message};function rk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,rk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}E(rk,Error);
rk.prototype.toString=function(){return this.name+": "+this.message};function sk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,sk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}E(sk,Error);sk.prototype.toString=function(){return this.name+": "+this.message};function tk(a){Error.captureStackTrace?Error.captureStackTrace(this,tk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}
E(tk,Error);function uk(a){Error.captureStackTrace?Error.captureStackTrace(this,uk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}E(uk,Error);function vk(a,b,c){var d;if(A(a))d=a.store,b=a.id,null!=a.parent&&(c=new vk(a.parent));else if(t(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new vk(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!t(b))throw Error("Invalid key value: "+a);this.O=d;this.id=b;this.parent=c||null}h=vk.prototype;h.toJSON=function(){var a={store:this.O,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
h.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.O+"^:"+this.id};h.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};h.F=function(){return this.O};h.D=function(){return this.id};function wk(a){return u(a.id)?a.id.join("^|"):a.id instanceof Date?+a.id:a.id}h.getParent=function(){return this.parent};function xk(a){return y(a)||x(a)||u(a)&&Sa(a,xk)||a instanceof Date}
function Uj(a){if(w(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function yk(a,b){this.g=b}yk.prototype.logger=R("ydn.db.crud.req.RequestExecuto");yk.prototype.toString=function(){return"RequestExecutor"};function zk(a,b,c,d,e,f){this.xa=a;this.Pa=b;this.g=this.i=0;this.$=d;this.V=e;this.l=c||Ak;this.K=f||0;this.s=!1;this.I=0}h=zk.prototype;h.logger=R("ydn.db.tr.Thread");h.th=function(a){if("complete"==a||"abort"==a)this.s?(Q(this.logger,"tx "+this.i+" committed"),this.s=!1):(Q(this.logger,"Generator done "+this.s),V(null,this.i,"complete"!=a))};
h.sc=function(){if(t(this.H))if(this.H)Q(this.logger,"Receive to commit tx "+this.i+" on yield "+this.I),this.s=!0;else throw new Sc("Coroutine transaction thread has been ended");else throw new Sc("Transaction thread not running in a generator");};
function Bk(a,b){a.s?(Q(a.logger,"waiting tx to be committed for yielding "+a.I),setTimeout(function(){a.Qb(function(){Q(a.logger,"sending result to yield "+a.I);a.H.next(b)},a.$,a.V,B(a.th,a))},4)):(Q(a.logger,"sending result to yield "+a.I),a.H.next(b));a.I++}h.request=function(a){a=new ek(a);this.H&&a.t(function(a){Bk(this,a)},function(a){var c=a;a instanceof Error||(c=Error(),c.error=a);Bk(this,c)},this);return a};h.type=function(){return Ck(this.xa)};h.J=function(){return this.xa};
h.Ka=function(){return"B"+this.Pa+"T"+this.i};var Ak="single";function Dk(a){if(a)if(ga(a.abort))a.abort();else if(ga(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new Qc;else throw new hk("No active transaction");};function Ek(a){this.i=a;this.g=null;this.h=0}Ek.prototype.logger=R("ydn.db.tr.Mutex");Ek.prototype.hb=null;function Fk(a){return!!a.g&&!a.j}Ek.prototype.Ya=null;Ek.prototype.toString=function(){return"Mutex:"+("B"+this.i+"T"+this.h)+(this.g?"*":"")};function Gk(a,b,c,d,e,f){zk.call(this,a,b,c,d,e,f);this.j=[];this.n=[];this.o=null;this.h=new Ek(b);this.P=f||0;this.na=!1}E(Gk,zk);h=Gk.prototype;h.logger=R("ydn.db.tr.Serial");
function Hk(a,b,c){if("multi"==a.l)a:if(a=a.h,!a.hb||!a.mode||c!=a.mode&&(a.mode!=Nj||c!=Mj)||b.length>a.hb.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.hb.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.l)a:if(a=a.h,a.hb&&a.mode&&c==a.mode&&a.hb.length==b.length){for(c=0;c<b.length;c++)if(-1==a.hb.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.l?!0:!1;return b}
function Ik(a){var b=0<a.j.length?a.j[0].hb:null,c=0<a.j.length?a.j[0].mode:null;return null!=b&&null!=c?Hk(a,b,c):!1}function Jk(a,b,c,d,e){Q(a.logger,"push tx queue["+a.j.length+"]");a.j.push({Ad:b,hb:c,mode:d,Ya:e})}h.abort=function(){P(this.logger,this+": aborting");Dk(this.o)};
h.Qb=function(a,b,c,d){var e=x(b)?[b]:b;if(w(e)){if(0==e.length)throw new M("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!x(e[f]))throw new M("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.Vb&&!Va(this.Vb,e[f]))throw new M('store name "'+f+e[f]+'" in scope of '+this);}}else throw new M("store names must be an array");var g=t(c)?c:Mj,k=this;if(this.h.g||!Kk(this.J())&&this.na)Jk(this,a,b,g,d);else{var l=this.Ka();d&&this.n.push(d);
if(this.P&&this.i>=this.P)throw new Sc("Exceed maximum number of transactions of "+this.P);this.na=!0;Lk(this.J(),function(c){var d=k.h;d.g=c;d.j=!1;d.hb=b;d.mode=g;d.h++;d.Ya=null;l=k.Ka();df(k.logger,l+" BEGIN "+S(b)+" "+g);a(k);for(a=null;Ik(k);)c=k.j.shift(),c.Ya&&k.n.push(c.Ya),Q(k.logger,"pop tx queue"+(k.j.length+1)+" reusing T"+k.i),c.Ad()},e,g,function(a,b){df(k.logger,l+" "+a);var c=k.h;c.g?(c.g=null,c.hb=null,c.mode=null,ga(c.Ya)&&c.Ya(a,b),c.Ya=null):O(c.logger,c+" has no TX to be unlocked for "+
a);for(c=0;c<k.n.length;c++)(0,k.n[c])(a,b);k.n.length=0;(c=k.j.shift())&&k.Qb(c.Ad,c.hb,c.mode,c.Ya);k.g=0})}};h.Ka=function(){var a=this.h;return"B"+a.i+"T"+a.h};h.request=function(a,b,c,d){var e=Gk.m.request.call(this,a,b,c,d);a=c||Mj;var f=this;Fk(this.h)&&Hk(this,b,a)?(b=this.h.g,this.g++,fk(e,b,this.Ka()+"R"+this.g),d&&this.n.push(d)):f.Qb(function(){var a=f.h.g;f.g++;fk(e,a,f.Ka()+"R"+f.g)},b,a,d);return e};
h.pc=function(a,b,c,d,e){d=d||Mj;var f=this,g;if(Fk(f.h)&&Hk(this,c,d)){var k=f.h.g;f.g++;g=f.Ka()+"R"+f.g;P(f.logger,g+" BEGIN");b(k,g,function(b,c){f.o=k;c?(P(f.logger,g+" ERROR"),a.w(b)):(P(f.logger,g+" SUCCESS"),a.u(b));f.o=null});P(f.logger,g+" END");b=null}else f.Qb(function(){var c=f.h.g;f.g++;g=f.Ka()+"R"+f.g;P(f.logger,g+" BEGIN");b(c,g,function(b,d){f.o=c;d?(P(f.logger,g+" ERROR"),a.w(b)):(P(f.logger,g+" SUCCESS"),a.u(b));f.o=null});P(f.logger,g+" END");b=null},c,d,e)};h.getName=function(){return this.J().getName()};
h.toString=function(){return"Serial:"+this.Ka()+(this.o?"*":"")};function Mk(a,b){Gk.call(this,a,b)}E(Mk,Gk);Mk.prototype.logger=R("ydn.db.tr.AtomicSerial");Mk.prototype.request=function(a,b,c){var d,e,f,g=Mk.m.request.call(this,a,b,c,function(a,b){g.g=null;if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new uk;V(g,c,!0)}});ik(g,function(a,b,c){f=b;e=a;d=c});return g};
Mk.prototype.pc=function(a,b,c,d,e){var f,g,k=new F;k.t(function(a){g=!1;f=a},function(a){g=!0;f=a});Mk.m.pc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.w(c);else if(!0===g)a.w(f);else if(!1===g)a.u(f);else{var d=new uk;a.w(d)}e&&(e(b,c),e=void 0)})};Mk.prototype.toString=function(){return"Atomic"+Mk.m.toString.call(this)};function Nk(a,b,c,d){this.j=a;this.h=b;this.g=c;this.$a=d;this.i=null}h=Nk.prototype;h.logger=R("ydn.db.tr.DbOperator");h.abort=function(){this.g.abort()};function Y(a){a.i||(a.i=a.j.I());return a.i}h.J=function(){return this.j};h.sc=function(){this.g.sc()};
function Ok(a,b){var c=a.J(),d=b instanceof Pk?b:Qk(b),e=b.name,f=Z(c.h,e);if(0==Rk(d,f).length)sb(!1);else if(f=f?"update":"add",c.h instanceof Sk)Tk(c.h,d),c.i?(c.i.he(),c.i=null,Uk(c)):sb(!1);else throw new Jh("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}h.toString=function(){return"TxStorage:"+this.J().getName()};function Vk(a,b,c,d){Nk.call(this,a,b,c,d)}E(Vk,Nk);h=Vk.prototype;h.logger=R("ydn.db.crud.DbOperator");
h.count=function(a,b,c,d){var e,f,g,k;if(null!=a)if(u(a)){if(t(c)||t(b))throw new M("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!Wk(this.h,f[l]))throw new M('store name "'+f[l]+'" at '+l+" not found.");P(this.logger,"countStores: "+S(f));e=this.g.request("count",f);W(e,function(){Y(this).xd(e,f)},this)}else if(x(a)){l=Z(this.h,a);if(!l)throw new M('store name "'+a+'" not found.');if(t(d)&&!fa(d))throw new M('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(x(b))if(g=
b,A(c)){var m=tj(c);if(m)throw new M("invalid key range: "+Ah(c)+" "+m);k=pj(c)}else{if(null!=c)throw new M("invalid key range: "+Ah(c)+" of type "+typeof c);k=null}else if(A(b)||null==b)if(A(b)){if(m=tj(b))throw new M("invalid key range: "+Ah(b)+" "+m);k=pj(b)}else{if(null!=b)throw new M("key range must be  an object but found "+Ah(b)+" of type "+typeof b);k=null}else throw new M('invalid second argument for count "'+Ah(c)+'" of type '+typeof b);P(this.logger,"countKeyRange: "+a+" "+(g?g:"")+S(k));
e=this.g.request("count",f);Xk(l,e,arguments);W(e,function(){Y(this).Kc(e,f[0],k,g,!!d)},this)}else throw new M("Invalid store name or store names.");else O(this.logger,"count method requires store name(s)"),l=Yk(this.h),e=this.g.request("count",l),ik(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),W(e,function(){Y(this).xd(e,f)},this);return e};
h.get=function(a,b){var c=this,d;if(a instanceof vk){var e=a,f=e.F(),g=Z(this.h,f);if(!g){if(this.h.g()){if(Kk(this.J()))return jk("get",void 0);d=new ek("get");this.J().Xa(function(){c.get(a,b).t(function(a){d.u(a)},function(a){d.w(a)})});return d}throw new M("Store: "+f+" not found.");}var k=e.D();P(this.logger,"getByKey: "+f+":"+k);d=this.g.request("get:key",[f]);Xk(g,d,arguments,void 0,this);W(d,function(){Y(this).Bd(d,f,k)},this)}else if(x(a)&&t(b)){var l=a,g=Z(this.h,l);if(!g){if(this.h.g()){if(Kk(this.J()))return jk("get",
void 0);d=new ek("get");this.J().Xa(function(){c.get(a,b).t(function(a){d.u(a)},function(a){d.w(a)})});return d}throw new M('Store name "'+l+'" not found.');}var m=b;P(this.logger,"getById: "+l+":"+m);d=this.g.request("get",[l]);Xk(g,d,arguments,void 0,this);W(d,function(){Y(this).Bd(d,l,m)},this)}else throw new M("get require valid input arguments.");return d};
h.keys=function(a,b,c,d,e,f,g){var k,l,m=null,n=!1,p=!1,q=a,s=Z(this.h,q);if(!x(q))throw new M("store name must be a string, but "+q+" of type "+typeof q+" is not.");if(!this.h.g()){if(!s)throw new M('store name "'+q+'" not found.');if(x(b)&&!Sj(s,b))throw new M('index "'+b+'" not found in store "'+q+'".');}if(this.h.g()&&!s)return jk("keys",[]);var v;if(x(b)){var z=b,C=tj(c);if(C)throw new M("invalid key range: "+c+" "+C);m=pj(c);if(y(d))k=d;else{if(t(d))throw new M("limit must be a number");k=100}if(y(e))l=
e;else{if(t(e))throw new M("offset must be a number");l=0}if(t(f))if(fa(f))n=f;else throw new M("reverse must be a boolean");if(t(g))if(fa(g))p=g;else throw new M("unique must be a boolean");P(this.logger,"keysByIndexKeyRange: "+q);v=this.g.request("keys:iter:index",[q]);Xk(s,v,arguments);W(v,function(){Y(this).list(v,2,q,z,m,k,l,n,p)},this)}else{if(A(b)){if(C=tj(b))throw new M("invalid key range: "+Ah(b)+" "+C);m=pj(b)}else{if(null!=b)throw new M("invalid key range: "+Ah(b)+" of type "+typeof b);
m=null}if(y(c))k=c;else{if(t(c))throw new M("limit must be a number");k=100}if(y(d))l=d;else{if(t(d))throw new M("offset must be a number");l=0}if(t(e))if(fa(e))n=e;else throw new M("reverse must be a boolean");P(this.logger,"keysByKeyRange: "+q);v=this.g.request("keys",[q]);Xk(s,v,arguments);W(v,function(){Y(this).list(v,2,q,null,m,k,l,n,!1)},this)}return v};
h.values=function(a,b,c,d,e,f,g){var k=this,l,m,n,p=!1,q=!1;if(x(a)){var s=a,v=Z(this.h,s);if(!v){if(this.h.g()){if(Kk(this.J()))return jk("values",[]);l=new ek("values");this.J().Xa(function(){k.values(a,b,c,d,e,f).t(function(a){l.u(a)},function(a){l.w(a)})});return l}throw new qk(s);}if(u(b)){if(t(c)||t(d))throw new M("too many input arguments");var z=b;P(this.logger,"listByIds: "+s+" "+z.length+" ids");l=this.g.request("values:array",[s]);Xk(v,l,arguments,void 0,this);W(l,function(){Y(this).hf(l,
s,z)},this)}else if(x(b)){var C=b;if(!Zk(v,C))throw new M('index "'+C+'" not found in store "'+s+'"');var G=tj(c);if(G)throw new M("invalid key range: "+c+" "+G);var J=pj(c);if(t(d))if(y(d))m=d;else throw new M("limit must be a number.");else m=100;if(t(e))if(y(e))n=e;else throw new M("offset must be a number.");else n=0;if(fa(f))p=f;else if(t(f))throw new M("reverse must be a boolean, but "+f);if(t(g))if(fa(g))q=g;else throw new M("unique must be a boolean");P(this.logger,"listByIndexKeyRange: "+
s+":"+C);l=this.g.request("values:iter:index",[s]);Xk(v,l,arguments);W(l,function(){Y(this).list(l,4,s,C,J,m,n,p,q)},this)}else{J=null;if(A(b)){if(G=tj(b))throw new M("invalid key range: "+b+" "+G);J=pj(b)}else if(null!=b)throw new M('expect key range object, but found "'+Ah(b)+'" of type '+typeof b);if(t(c))if(y(c))m=c;else throw new M("limit must be a number, but "+c+" is "+typeof c);else m=100;if(t(d))if(y(d))n=d;else throw new M("offset must be a number, but "+d+" is "+typeof d);else n=0;if(t(e))if(fa(e))p=
e;else throw new M("reverse must be a boolean, but "+e+" is "+typeof e);P(this.logger,(J?"listByKeyRange: ":"listByStore: ")+s);l=this.g.request("values",[s]);Xk(v,l,arguments);W(l,function(){Y(this).list(l,4,s,null,J,m,n,p,!1)},this)}}else if(u(a))if(a[0]instanceof vk){for(var v=[],N=a,G=0;G<N.length;G++){var ha=N[G].F();if(!Wk(this.h,ha)){if(this.h.g())return v=[],v[N.length-1]=void 0,jk("get",v);throw new M("Store: "+ha+" not found.");}Va(v,ha)||v.push(ha)}P(this.logger,"listByKeys: "+S(v)+" "+
N.length+" keys");l=this.g.request("values:keys",v);W(l,function(){Y(this).Qd(l,N)},this)}else throw new M("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found.");else throw new M("first argument "+a+" is invalid.");return l};
h.list=function(a,b,c,d,e,f,g,k,l){var m=Z(this.h,b);if(!m){if(this.h.g())return jk("get",[]);throw new qk(b);}var n;if(c&&!Zk(m,c))throw new M('index "'+c+'" not found in store "'+b+'"');if(m=tj(d))throw new M("invalid key range: "+d+" "+m);var p=pj(d),q=100;if(y(e))q=e;else if(null!=e)throw new M('limit must be a number but "'+e+'" of type '+typeof e+" found.");var s=0;if(y(f))s=f;else if(null!=f)throw new M('offset must be a number but "'+f+'" of type '+typeof f+" found.");var v=!1;if(fa(g))v=
g;else if(null!=g)throw new M('reverse must be a boolean but "'+g+'" of type '+typeof g+" found.");var z=!1;if(fa(k))z=k;else if(null!=k)throw new M('unique must be a boolean but "'+k+'" of type '+typeof k+" found.");if(s&&l&&t(l[0]))throw new M("offset must not given when initial cursor position is defined");P(this.logger,a+": "+b+":"+c);n=this.g.request("values:iter:index",[b]);W(n,function(){Y(this).list(n,a,b,c||null,p,q,s,v,z,l)},this);return n};
h.add=function(a,b,c){var d=x(a)?a:A(a)?a.name:void 0;if(!x(d))throw new M("store name "+d+" must be a string, but "+typeof d);var e=Z(this.h,d);if(!e){if(!this.h.g())throw new M('store name "'+d+'" not found.');e=Qk(A(a)?a:{name:d});P(this.logger,"Adding object store: "+d);Ok(this,e)}else if(this.h.g()&&A(a)&&(a=Qk(a),a=Rk(e,a)))throw new Qc(a);var f;if(!e)throw new M('store name "'+d+'" not found.');if(x(e.keyPath)&&t(c))throw new M("key must not be provided while the store uses in-line key.");
if(!e.keyPath&&!e.h&&!t(c))throw new M("out-of-line key must be provided.");if(u(b)){P(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)$k(e,b[a]);f=this.g.request("add:array",[d],Nj);W(f,function(){Y(this).lb(f,!1,!1,d,b,c)},this);e.Zb&&f.B(function(a){a=new al(bl,this.J(),e.getName(),a,b);this.J().Ra(a)},this)}else if(A(b))a="store: "+d+" key: "+cl(e,b,c),P(this.logger,"addObject: "+a),$k(e,b),f=this.g.request("add",[d],Nj),W(f,function(){Y(this).lb(f,!1,!0,d,[b],[c])},
this),e.Zb&&f.B(function(a){a=new dl(bl,this.J(),e.getName(),a,b);this.J().Ra(a)},this);else throw new M("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};
function el(a,b){var c=x(b)?b:A(b)?b.name:void 0;if(!x(c))throw new M("store name must be a string");var d=Z(a.h,c);if(!d){if(!a.h.g())throw new qk(c);d=Qk(A(b)?b:{name:c});P(a.logger,"Adding object store: "+c);Ok(a,d)}else if(a.h.g()&&A(b)){var e=Qk(b);if(e=Rk(d,e))throw new Qc(e);}if(!d)throw new qk(c);return d}h.load=function(a,b,c){var d=c||",",e=el(this,a).getName();a=this.g.request("load",[e]);var f=this;this.g.pc(a,function(a,c,l){Y(f).of(a,c,l,e,b,d)},[e],Nj);return a};
h.search=function(a){var b=fl(a);Q(this.logger,"query "+a);var c=this.g.request("search",b,Mj);W(c,function(){var b=Y(this);gl(a,function(e,f,g,k){var l=gk(c);b.list(l,4,e,f,pj(g),100,0,!1,!1);l.da(function(b){var d=null;b instanceof Array||(d=b,b=[]);for(var e=0;e<b.length;e++){var f;f=b[e];var g=f.id,g=x(g)?Ej(g):g,k=g[3];(f=1==this.type&&k!=this.value?null:new hl(this,g[0],g[2],g[1],k,f.k,f.loc))&&a.j.push(f)}a.i--;b=0==a.i?!1:a.h[a.h.length-1].l===this.l?!0:null;!0===b?Vc(c,a):!1===b&&c.u(il(a));
if(d)throw d;},k)})},this);return c};
h.put=function(a,b,c){var d,e=this;if(a instanceof vk){var f=a,g=f.F(),k=Z(this.h,g);if(!k)throw new M('store "'+g+'" not found.');if(k.keyPath){var l=cl(k,b);if(null!=l){if(0!=wj(l,f.D()))throw new M("Inline key must be "+f+" but "+l+" found.");}else jl(k,b,f.D());return this.put(g,b)}return this.put(g,b,f.D())}if(u(a)){if(t(c))throw new M("too many arguments");var m=a;if(!t(b))throw new M("record values required");for(var n=b,f=[],g=0,k=m.length;g<k;g++){l=m[g].F();-1==Na(f,l)&&f.push(l);var p=
Z(this.h,l);if(!p)throw new M('store "'+l+'" not found.');p.keyPath&&jl(p,n[g],m[g].D())}P(this.logger,"putByKeys: to "+S(f)+" "+n.length+" objects");for(g=0;g<n.length;g++)$k(p,n[g]);d=this.g.request("put:keys",f,Nj);Xk(p,d,arguments);W(d,function(){Y(e).Wd(d,n,m)},this)}else if(x(a)||A(a)){var p=el(this,a),q=p.getName();if(p.keyPath&&t(c))throw new M("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.h&&!t(c))throw new M("out-of-line key must be provided.");if(u(b)){var s=
b,v=c;P(this.logger,"putObjects: "+q+" "+s.length+" objects");for(g=0;g<s.length;g++)$k(p,s[g]);d=this.g.request("put:array",[q],Nj);Xk(p,d,arguments);W(d,function(){Y(this).lb(d,!0,!1,q,s,v)},this);p.Zb&&d.B(function(a){a=new al(kl,this.J(),q,a,s);this.J().Ra(a)},this)}else if(A(b)){var z=b,C=c;P(this.logger,"putObject: "+q+" "+C);if(t(r.Blob)&&z instanceof Blob&&p.oc&&!p.keyPath&&0==p.indexes.length&&Kb)d=new ek("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,c=e.g.request("put",
[q],Nj);Xk(p,c,[q,z,C]);W(c,function(){Y(e).lb(c,!0,!0,q,[b],[C])},this);c.t(function(a){d.u(a)},function(a){d.w(a)})},f.onerror=function(a){d.w(a)},f.onabort=function(a){d.w(a)},f.readAsDataURL(z);else{$k(p,z);d=this.g.request("put",[q],Nj);var G=[q,z,C];Xk(p,d,G);W(d,function(){var a=t(C)?[G[2]]:void 0;Y(e).lb(d,!0,!0,q,[G[1]],a)},this)}p.Zb&&d.B(function(a){a=new dl(kl,this.J(),q,a,z);this.J().Ra(a)},this)}else throw new M("put record value must be Object or array of Objects");}else throw new M("the first argument of put must be store name, store schema or array of keys.");
return d};
function ll(a,b,c,d){var e=a.$a,f,g;if(x(b)){var k=Z(a.h,b);if(k){if(!k.keyPath&&!k.h&&null==d)throw new M('key required for store "'+b+'"');}else throw new qk(b);for(var l=0;l<c.length;l++)$k(k,c[l]);f=[b]}else{g=b;f=[];for(var l=0,m=g.length;l<m;l++){var n=g[l].F(),k=Z(a.h,n);-1==Na(f,n)&&f.push(n);if(!k)throw new qk(n);$k(k,c[l])}}var p;x(b)?(k=Z(a.h,b),p=e.request("put:array",f,Nj),W(p,function(){Y(this).lb(p,!0,!1,b,c,d)},a)):(p=e.request("put:keys",f,Nj),W(p,function(){Y(this).Wd(p,c,g)},a));
return p}function ml(a,b){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d].F();-1==Na(c,f)&&c.push(f);if(!Wk(a.h,f))throw new qk(f);}var g=a.$a.request("rm:keys",c,Nj);W(g,function(){Y(this).Zd(g,b)},a);return g}function nl(a,b,c){var d=a.$a.request("rm:iter",[b],Nj);W(d,function(){Y(this).cd(d,b,c||null)},a);return d}
function ol(a,b,c,d,e,f,g){f=f||100;var k,l=g||0;if(g=Z(a.h,b)){if(c&&!Zk(g,c))throw new qk('index "'+c+'" in store "'+b+'"');}else throw new qk(b);var m=pj(d);x(c)?(k=a.$a.request("values:iter:index",[b]),W(k,function(){Y(this).list(k,4,b,c,m,f,l,e,!1)},a)):(k=a.$a.request("values",[b]),W(k,function(){Y(this).list(k,4,b,null,m,f,l,e,!1)},a));return k}
function pl(a,b){var c=[],d=b.length;if(0==d)return jk("keys",[]);for(var e=0;e<d;e++){var f=b[e].F();-1==Na(c,f)&&c.push(f);if(!Wk(a.h,f))throw new qk(f);}var g=a.$a.request("keys",c);W(g,function(){Y(a).Qd(g,b)},a);return g}
function ql(a,b,c,d,e,f,g,k){var l;e=e||100;var m=Z(a.h,b);if(m){if(c&&!Zk(m,c))throw new qk('index "'+c+'" in store "'+b+'"');}else throw new qk(b);x(c)?(l=a.$a.request("keys:iter:index",[b]),W(l,function(){Y(this).list(l,2,b,c,d,e,f,g,k)},a)):(l=a.$a.request("keys",[b]),W(l,function(){Y(this).list(l,2,b,null,d,e,f,g,k)},a));return l}
h.clear=function(a,b,c){if(t(c))throw new M("too many input arguments");var d;if(x(a)){c=Z(this.h,a);if(!c)throw new M('store name "'+a+'" not found.');if(A(b)){var e=pj(b);if(null===e)throw new M("clear method requires a valid non-null KeyRange object.");P(this.logger,"clearByKeyRange: "+a+":"+S(e));d=this.g.request("clear",[a],Nj);Xk(c,d,[a,e]);W(d,function(){Y(this).ve(d,a,e)},this)}else{if(t(b))throw new M("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+
typeof b);P(this.logger,"clearByStore: "+a);d=this.g.request("clear",[a],Nj);W(d,function(){Y(this).ud(d,[a])},this)}}else if(!t(a)||u(a)&&x(a[0])){var f=a||Yk(this.h);P(this.logger,"clearByStores: "+S(f));d=this.g.request("clear",f,Nj);W(d,function(){Y(this).ud(d,f)},this)}else throw new M('first argument "'+a+'" is invalid.');return d};
h.remove=function(a,b,c){var d;if(x(a)){var e=Z(this.h,a);if(!e)throw new M('store name "'+a+'" not found.');if(t(c))if(x(b)){var f=Sj(e,b);if(!f)throw new M("index: "+b+" not found in "+a);if(A(c)||null===c){var g=pj(c);P(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.g.request("rm:iter:index",[a],Nj);W(d,function(){Y(this).pf(d,a,f.getName(),g)},this)}else throw new M("key range "+c+' is invalid type "'+typeof c+'".');}else throw new M('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(x(b)||y(b)||w(b)||b instanceof Date){P(this.logger,"removeById: "+a+":"+b);d=this.g.request("rm",[a],Nj);var k=[a,b];Xk(e,d,k);W(d,function(){Y(this).Yd(d,a,k[1])},this);e.Zb&&d.B(function(b){b=new dl(rl,this.J(),a,b,void 0);this.J().Ra(b)},this)}else if(A(b))g=pj(b),P(this.logger,"removeByKeyRange: "+a+":"+S(g)),d=this.g.request("rm:iter",[a],Nj),Xk(e,d,[a,g]),W(d,function(){Y(this).cd(d,a,g)},this),e.Zb&&d.B(function(b){b=new al(rl,this.J(),a,b,void 0);this.J().Ra(b)},
this);else throw new M('Invalid key or key range "'+b+'" of type '+typeof b);}else if(a instanceof vk){var l=a.F(),e=Z(this.h,l);d=this.g.request("rm",[l],Nj);var m=[l,a.D()];Xk(e,d,m);W(d,function(){Y(this).Yd(d,l,m[1])},this)}else if(u(a)){b=[];c=0;for(e=a.length;c<e;c++){if(!(a[c]instanceof vk))throw new M("key list element at "+c+" of "+e+' must be yn.db.Key, but "'+Ah(a[c])+'" ('+ea(a[c])+") is not ydn.db.Key.");var n=a[c].F();-1==Na(b,n)&&b.push(n)}if(1>b.length)throw new M('at least one valid key required in key list "'+
Ah(a)+'"');d=this.g.request("rm:keys",b,Nj);W(d,function(){Y(this).Zd(d,a)},this)}else throw new M('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+Ah(a)+'" ('+ea(a)+") found.");return d};h.toString=function(){return"DbOperator:"+this.J().getName()};function sl(a,b,c,d){Nk.call(this,a,b,c,d)}E(sl,Vk);h=sl.prototype;h.logger=R("ydn.db.core.DbOperator");h.get=function(a,b){if(a instanceof Xj){var c=a.F(),d=Z(this.h,c);if(!d)throw new M('store "'+c+'" not found.');var e=a.h;if(t(e)&&!Zk(d,e))throw new M('index "'+e+'" not found in store "'+c+'".');P(this.logger,"getByIterator:"+a);var f=this.g.request("get:iter",[c]);W(f,function(){tl(this,5,f,a,1)},this);return f}return sl.m.get.call(this,a,b)};
h.keys=function(a,b,c,d,e,f,g){if(a instanceof Xj){var k=100;if(y(b)){if(k=b,1>k)throw new M("limit must be a positive value, but "+b);}else if(t(b))throw new M("limit must be a number,  but "+b);if(t(c))throw new M("offset must not be specified");P(this.logger,"keysByIterator:"+a);var l=this.g.request("keys:iter",[a.F()]);W(l,function(){a.o?tl(this,1,l,a,k):tl(this,2,l,a,k)},this);return l}return sl.m.keys.call(this,a,b,c,d,e,f,g)};
h.count=function(a,b,c,d){if(a instanceof Xj){if(t(b)||t(c))throw new M("too many arguments.");P(this.logger,"countIterator:"+a);var e=this.g.request("count",[a.F()]);W(e,function(){tl(this,6,e,a)},this);return e}return sl.m.count.call(this,a,b,c,d)};
h.values=function(a,b,c,d,e,f){if(a instanceof Xj){var g;if(y(b)){if(g=b,1>g)throw new M("limit must be a positive value, but "+g);}else if(t(b))throw new M("limit must be a number, but "+b);if(t(c))throw new M("offset must not be specified");P(this.logger,"listByIterator:"+a);var k=this.g.request("values:iter",[a.F()]);W(k,function(){a.g?tl(this,2,k,a,g):tl(this,4,k,a,g)},this);return k}return sl.m.values.call(this,a,b,c,d,e,f)};
h.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new M('Store "'+e+'" not found.');e=this.g.request("map",d);Q(this.logger,"map:"+a);this.g.pc(e,function(d,e,f){Q(c.logger,e+" iterating "+a);for(var m=a.stores(),n=[],p=0;p<m.length;p++)n[p]=Y(c).h(d,e,m[p]);var q=a.load(n);q.V=function(a){f(a,!1)};q.P=function(c){if(null!=c){var d;a.o?a.g?d=c:d=q.ga():a.g?d=c:d=q.T();b(d);q.advance(1)}else f(void 0),b=null}},d,Mj);return e};
function tl(a,b,c,d,e){var f=[],g=c.g,k=X(c),l=k+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);P(a.logger,l);for(var m=Y(a),n=[],p=d.stores(),q=0;q<p.length;q++)n[q]=m.h(g,k,p[q]);var s=d.load(n);s.V=function(a){Vj(s);V(c,a,!0)};var v=0,z=!1;s.P=function(d){z||(Q(a.logger,l+" starting"),z=!0);null!=d?(s.ga(),v++,1==b?f.push(d):2==b?f.push(s.ga()):3==b?f.push([d,s.ga()]):6!=b&&f.push(s.T()),5==b?(Vj(s),V(c,f[0])):6==b||!t(e)||v<e?s.vd():(P(a.logger,"success:"+l+" yields "+f.length+" records"),Vj(s),
V(c,f))):(P(a.logger,"success:"+l+" yields "+f.length+" records"),Vj(s),V(c,5==b?f[0]:6==b?v:f))}};var bl="created",rl="deleted",kl="updated";function ul(a,b){K.call(this,a,b)}E(ul,K);ul.prototype.F=function(){return this.O};function vl(a,b,c){K.call(this,a,b);this.version=c}E(vl,ul);vl.prototype.name="ReadyEvent";vl.prototype.version=NaN;function wl(a,b,c){K.call(this,c||"error",a);this.error=b}E(wl,ul);wl.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};wl.prototype.name="ErrorEvent";wl.prototype.error=null;function xl(a,b){wl.call(this,a,b,"fail")}E(xl,wl);
xl.prototype.name="FailEvent";function dl(a,b,c,d,e){K.call(this,a,b);this.O=c;this.key=d;this.value=e}E(dl,ul);dl.prototype.name="RecordEvent";dl.prototype.T=function(){return this.value};function al(a,b,c,d,e){K.call(this,a,b);this.O=c;this.keys=d;this.values=e}E(al,ul);al.prototype.name="StoreEvent";al.prototype.La=function(){return this.keys};al.prototype.ya=function(){return this.values};function yl(a,b,c,d,e,f){t(e)||(e=u(a)?a.join(", "):a);if(null!=a&&!x(a)&&!w(a))throw new M("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);u(a)&&Object.freeze&&Object.freeze(a);!t(a)&&t(e)&&(a=e);this.keyPath=a;this.n=w(this.keyPath);this.h=e;this.type=zl(b);if(t(b)){if(!t(this.type))throw new M("type invalid in index: "+this.h);if(u(this.keyPath))throw new M('composite key for store "'+this.h+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;this.o=x(this.type)?
this.type:Al;this.j=x(e)?e:u(a)?this.keyPath.join(","):a;this.i=Ia(this.j);this.g=this.n?null:this.keyPath.split(".");this.l=f||null}function Bl(a,b){if(null!=b){if(w(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=yj(b,a.keyPath[d]);c[d]=f}return c}return yj(b,a.keyPath)}}function Cl(a,b,c){for(var d=0;d<a.g.length;d++)d==a.g.length-1?b[a.g[d]]=c:A(b[a.g[d]])||(b[a.g[d]]={})}var Al="TEXT";function xj(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return null!=b?a:Bj(a)}
function Dl(a,b){return"DATE"==b?new Date(a):t(b)?a:Ej(a)}var El=["BLOB","DATE","INTEGER","NUMERIC",Al];function zl(a){if(x(a))return a=Na(El,a),El[a]}h=yl.prototype;h.getName=function(){return this.h};h.toJSON=function(){return{name:this.h,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};h.ea=function(){var a=u(this.keyPath)?$a(this.keyPath):this.keyPath;return new yl(a,this.type,this.unique,this.multiEntry,this.h,this.l)};
function Fl(a,b){return null!=a||null!=b?null!=a?null!=b?w(a)&&w(b)?eb(a,b)?null:"expect: "+a+", but: "+b:Gl(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}h.hint=function(a){if(!a)return this;var b=u(this.keyPath)?$a(this.keyPath):this.keyPath,c=this.type;t(a.type)||"TEXT"!=c||(c=void 0);return new yl(b,c,this.unique,this.multiEntry,a.h)};function Il(a,b){a.l=b}
h.toString=function(){var a=this.multiEntry?"MultiEntry":"";this.g&&1<this.g.length&&(a+="Compound");return a+"Index:"+this.h};function Pk(a,b,c,d,e,f,g,k){this.i=a;if(!x(this.i))throw new M("store name must be a string");this.keyPath=t(b)?b:null;this.s=w(this.keyPath);if(null!==this.keyPath&&!x(this.keyPath)&&!this.s)throw new M("keyPath must be a string or array");this.h=c;var l;if(null!=d){l=zl(d);if(!t(l))throw new M('type "'+d+'" for primary key in store "'+this.i+'" is invalid.');if(this.s)throw new M('composite key for store "'+this.i+'" must not specified type');}this.type=null!=l?l:this.h?"INTEGER":void 0;this.n=
x(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.Zb=!!f;this.oc=!!g;this.H=x(this.type)?this.type:Al;this.l=u(this.keyPath)?this.keyPath.join(","):x(this.keyPath)?this.keyPath:"_ROWID_";this.j=Ia(this.l);if(this.I=!!k){if(this.keyPath)throw new M('encrypted store "'+this.i+'" must not use inline key');if(this.h)throw new M('encrypted store "'+this.i+'" must not use key generator');}this.o=[]}h=Pk.prototype;h.Zb=!1;h.oc=!1;
h.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.i,keyPath:this.keyPath,autoIncrement:this.h,type:this.type,indexes:a}};
function Qk(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==Na(b,c))throw new M('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(u(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==Na(f,g))throw new M("Unknown field: "+g+" in "+S(e));e=new yl(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
t(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new Pk(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}function Jl(a,b,c,d,e,f,g){a=Kl(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.Lc;a.va&&(b+=" WHERE "+a.va);a.group&&(b+=" GROUP BY "+a.group);a.kc&&(b+=" ORDER BY "+a.kc);return b}
function Kl(a,b,c,d,e,f,g){var k={select:"",Lc:"",va:"",group:"",kc:""},l=a.l,m=a.j,n=null;d!==l&&x(d)&&(n=Sj(a,d));var p=!!n,q=d||l,s=Ia(q),v=p?n.type:a.type,z=p&&n.multiEntry;k.Lc=Ll(a);6===c?k.select="COUNT("+m+")":3===c||1===c||2===c?(k.select=m,null!=d&&d!=l&&(k.select+=", "+s)):k.select="*";d=g?"DISTINCT ":"";l=[];z?(z=Ia("ydn.db.me:"+a.getName()+":"+n.getName()),k.select=6===c?"COUNT("+d+z+"."+s+")":3===c||1===c||2===c?"DISTINCT "+Ll(a)+"."+m+", "+z+"."+s+" AS "+q:"DISTINCT "+Ll(a)+".*, "+
z+"."+s+" AS "+q,k.Lc=z+" INNER JOIN "+Ll(a)+" USING ("+m+")",null!=e&&(vj(z+"."+s,v,e,l,b),0<l.length&&(k.va=k.va?k.va+(" AND "+l.join(" AND ")):l.join(" AND ")))):null!=e&&(vj(s,v,e,l,b),0<l.length&&(k.va=k.va?k.va+(" AND "+l.join(" AND ")):l.join(" AND ")));p&&!n.unique&&g&&(k.group=s);a=f?"DESC":"ASC";k.kc=s+" "+a;p&&(k.kc+=", "+m+" "+a);return k}
function Ml(a,b,c,d,e,f,g,k,l){var m,n,p,q;null!=e?(m=e.lower,n=e.upper,p=e.lowerOpen,q=e.upperOpen,f?null!=n?(e=wj(k,n),-1==e?(n=k,q=l):0==e&&(q=l||q)):(n=k,q=l):null!=m?(e=wj(k,m),1==e?(m=k,p=l):0==e&&(p=l||p)):(m=k,p=l)):f?(n=k,q=l):(m=k,p=l);e=new U(m,n,!!p,!!q);d=d?Sj(a,d):null;b=Kl(a,c,b,d?d.j:a.l,e,f,g);b="SELECT "+b.select+" FROM "+b.Lc+(b.va?" WHERE "+b.va:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.kc;d&&(b+=", "+a.j+(f?"DESC":"ASC"));return b}
function Nl(a,b,c,d,e,f,g,k,l,m){var n=Sj(a,d),p=n.j;d=n.i;var q=a.j,s=l?" <":" >",s=g?s+" ":s+"= ";g=xj(f,n.type);k=xj(k,a.type);n="";e?(a=Kl(a,c,b,p,e,l,m),a.va+=" AND ",n=d+s+"?",c.push(g)):(e=l?U.upperBound(f,!0):U.lowerBound(f,!0),a=Kl(a,c,b,p,e,l,m),n=a.va,a.va="");a.va+="("+n+" OR ("+d+" = ? AND "+q+s+"?))";c.push(g);c.push(k);return"SELECT "+a.select+" FROM "+a.Lc+" WHERE "+a.va+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.kc}h.ea=function(){return Qk(this.toJSON())};
h.index=function(a){return this.indexes[a]||null};function Sj(a,b){return Ta(a.indexes,function(a){return a.getName()==b})}function Rj(a,b){for(var c=0;c<a.indexes.length;c++)if(!Fl(a.indexes[c].keyPath,b))return a.indexes[c];return null}function Zk(a,b){return b===a.keyPath?!0:Ra(a.indexes,function(a){return a.getName()==b})}function Ll(a){return Ia(a.i)}
function Ol(a,b){if(!b)return a;var c=a.h,d=u(a.keyPath)?$a(a.keyPath):a.keyPath,e=a.type,f=Qa(a.indexes,function(a){return a.ea()});t(b.type)||"TEXT"!=e||(e=void 0);u(b.keyPath)&&x(d)&&d==b.keyPath.join(",")&&(d=$a(b.keyPath));for(var g=0,k=b.indexes.length;g<k;g++)if(b.indexes[g].n)for(var l=b.indexes[g].getName(),m=f.length-1;0<=m;m--)if(0<=l.indexOf(f[m].getName())){f[m]=b.indexes[g].ea();break}for(g=0;g<f.length;g++)(k=Sj(b,f[g].getName()))&&(f[g]=f[g].hint(k));return new Pk(b.i,d,c,e,f)}
h.getName=function(){return this.i};function Pl(a){return!!a.keyPath}function cl(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.s){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(yj(b,a.keyPath[d]));return c}if(a.keyPath)return oc(b,a.n)}}function jl(a,b,c){for(var d=0;d<a.n.length;d++){var e=a.n[d];if(d==a.n.length-1){b[e]=c;break}t(b[e])||(b[e]={});b=b[e]}}
function Ql(a,b,c){var d=[],e=[];c=t(c)?c:cl(a,b);t(c)&&(e.push(a.j),d.push(xj(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&g.getName()!==a.keyPath&&"_default_"!=g.getName()){var k=Bl(g,b);null!=k&&(d.push(xj(k,g.type)),e.push(g.i))}}a.oc?a.oc&&!a.keyPath&&0==a.indexes.length&&(x(b)&&-1==b.indexOf(";base64,")?d.push(b):d.push(S(b)),e.push("_default_")):(d.push(S(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Rf:e,og:a,values:d,key:c}}
function Rk(a,b){if(!b)return"missing store: "+a.i;if(a.i!=b.i)return"store name, expect: "+a.i+", but: "+b.i;var c=Fl(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(t(a.h)&&t(b.h)&&a.h!=b.h)return"autoIncrement, expect:  "+a.h+", but: "+b.h;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(t(a.type)&&t(b.type)&&(w(a.type)?!eb(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=
Sj(b,a.indexes[c].getName()),e;e=a.indexes[c];if(d)if(e.h!=d.h)e="name, expect: "+e.h+", but: "+d.h;else{var f=Fl(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:t(e.type)&&t(d.type)&&(w(e.type)?!eb(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e=
"no index for "+e.h;if(0<e.length)return'index "'+a.indexes[c].getName()+'" '+e}return""}function $k(a,b){if(b)for(var c=0;c<a.indexes.length;c++){var d=a.indexes[c],e=b;if(d.l){var f=d.l(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||u(f)){for(g=0;g<d.g.length-1;g++)A(e[d.g[g]])||(e[d.g[g]]={});e[d.g[d.g.length-1]]=f}}}}function Rl(a,b){a.o.push(b)}function Xk(a,b,c,d,e){for(var f=0;f<a.o.length;f++)d!==f&&a.o[f].call(e,b,c)}
h.toString=function(){return"Store:"+this.i+"["+this.indexes.length+"index]"};function Sl(a,b,c){if(!a||ta(a))throw new M("store_name must be provided for primary full text index");if(!b||ta(b))throw new M("index_name must be provided for primary full text index");this.O=a;this.g=b;this.h=c||1}Sl.prototype.F=function(){return this.O};function Tl(a,b,c,d){this.name=a;this.indexes=b;this.lang=c||"";if(-1==["","en","fr"].indexOf(this.lang))throw new M('Unsupported lang "'+c+" for full text search index "+a);this.h=d||null;this.g=null}Tl.prototype.getName=function(){return this.name};Tl.prototype.count=function(){return this.indexes.length};Tl.prototype.index=function(a){return this.indexes[a]};function Ul(a,b,c){return Ta(a.indexes,function(a){return a.F()==b&&a.g==c})}
function Vl(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Na(b,c))throw new M("Unknown field: "+c+" in "+S(a));if(!u(a.sources))throw new M("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Na(b,c))throw new M("Unknown field: "+c+" in "+Ah(a));return new Sl(a.storeName,a.keyPath,a.weight)});return new Tl(a.name,
b,a.lang)};function Wl(a,b){var c,d,e=b;if(A(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==Na(c,f))throw new M("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!u(g))throw new M("stores must be array");for(f=0;f<g.length;f++){var k=Qk(g[f]);if(-1!=Ua(e,function(a){return a.name==k.getName()}))throw new M('duplicate store name "'+k.getName()+'".');e.push(k)}}else x(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(t(c)){if(!y(c)||0>c)throw new M("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(t(b)&&(!u(b)||0<b.length&&!(b[0]instanceof Pk)))throw new M("stores");this.version=c;this.h=!t(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=Vl(d.fullTextCatalogs[f]),c[f]=e,Z(this,e.getName())||(g=[new yl("k",Al),new yl("v",Al)],e=new Pk(e.getName(),"id",!1,void 0,g),this.stores.push(e));this.i=c}
Wl.prototype.toJSON=function(){var a=Qa(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;t(this.version)&&(b.version=this.version);return b};Wl.prototype.h=!1;Wl.prototype.g=function(){return!1};function Yk(a){return Qa(a.stores,function(a){return a.getName()})}Wl.prototype.count=function(){return this.stores.length};function Z(a,b){return Ta(a.stores,function(a){return a.getName()==b})}function Wk(a,b){return Ra(a.stores,function(a){return a.getName()==b})}
function Xl(a,b,c,d){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var e=0;e<a.stores.length;e++){var f=Z(b,a.stores[e].getName());if(f){c&&(f=Ol(f,a.stores[e]));if(d)for(var g=f,k=a.stores[e],l=0;l<k.indexes.length;l++){var m=k.indexes[l];Zk(g,m.getName())||"BLOB"!=m.type||(m=new yl(m.keyPath,m.type,m.unique,m.multiEntry,m.getName()),g.indexes.push(m))}f=Rk(a.stores[e],f);if(0<f.length)return'store: "'+a.stores[e].getName()+'" '+f}else return'missing object store "'+
a.stores[e].getName()+'"'}return""}function Yl(a,b){return Ta(a.i,function(a){return a.getName()==b})};function Sk(a,b){Wl.call(this,a,b)}E(Sk,Wl);Sk.prototype.g=function(){return!0};function Tk(a,b){a.stores.push(b)};function Zl(a){return zh(S(a))}function Gl(a,b){var c;c=c||{};if(null!=a&&null!=b){if(w(a)&&w(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Ta(b,function(b){return Gl(b,a[d])}))return!1;return!0}if(w(a))return 1==a.length&&Gl(a[0],b);if(w(b))return 1==b.length&&Gl(b[0],a);if(A(a)&&A(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=Gl(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=Gl(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function $l(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function am(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==Na(d,e))throw new M('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!u(c.mechanisms))throw new M("mechanisms attribute must be an array but "+ea(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!Va(bm,c.mechanisms[e]))throw new M('Invalid mechanism "'+c.mechanisms[e]+'"');}this.K=c.mechanisms||bm;this.H=c.size;this.P=
t(c.connectionTimeout)?c.connectionTimeout:3E4;this.i=null;this.j=[];this.Md=!1;var f;if(b instanceof Wl)f=b;else if(A(b))for(c.autoSchema||!t(b.stores)?f=new Sk(b):f=new Wl(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=Z(f,b.stores[e].name),b.stores[e].Sync&&this.Lf(d,b.stores[e].Sync);else f=new Sk;this.h=f;for(e=0;e<this.h.count();e++)if((this.h.stores[e]||null).I)throw Error("encryption option must be defined");if(t(a)){if(this.i)throw new Sc("Already connected with "+this.s);this.s=a;Uk(this)}this.o=
null;this.n=new F}am.prototype.logger=R("ydn.db.con.Storage");function cm(a,b,c){return(a=Z(a.h,b))?Zk(a,c):!1}function dm(a){var b;if(t(b)){var c=function(a){b(a.toJSON());b=void 0};a.i?a.i.ib(c):Lk(a,function(b){a.i.ib(c,b)},null,Mj)}return a.h?a.h.toJSON():null}am.prototype.getName=function(){return this.s};var bm="indexeddb websql localstorage sessionstorage userdata memory".split(" ");h=am.prototype;h.ye=function(){return null};
function Uk(a){function b(b,e){b?(Q(a.logger,a+": ready."),a.hg=NaN,d.kd=function(b){a.Ra(new wl(a,b))},d.ke=function(b){a.Ra(new xl(a,b));a.i=null},d.Ud=function(b){a.Ra(b)},setTimeout(function(){em(a,e);fm(a)},10),c.u(e)):(O(a.logger,a+": database connection fail "+e.name),setTimeout(function(){em(a,new xl(a,e));if(a.j){a.logger.info("Purging "+a.j.length+" transactions request.");for(var b;b=a.j.shift();)b.Ya&&b.Ya("error",e)}},10),c.w(e))}for(var c=new F,d=null,e=a.K,f=0;f<e.length;f++){var g=
e[f].toLowerCase();if(d=a.ye(g)){d=a.ye(g);break}}null===d?(e=new Jh("No storage mechanism found."),b(!1,new xl(a,e))):(a.init(),d.connect(a.s,a.h).t(function(){this.i=d;b(!0,new vl("ready",this,parseFloat(d.ie())))},function(a){O(this.logger,this+": opening fail");b(!1,a)},a))}function Ck(a){if(a.i)return a.i.Gc()}h.Xa=function(a,b){this.n.da(a,b)};function em(a,b){setTimeout(function(){b instanceof wl?a.n.w(b.error):a.n.u();a.Ra(b)},4)}function Kk(a){return!!a.i&&a.i.je()}h.init=function(){};
function gm(a){a.i&&(a.i.he(),a.i=null,Q(a.logger,a+" closed"))}h.hg=NaN;function fm(a){var b=a.j.shift();b&&(Q(a.logger,"pop tx queue["+(a.j.length+1)+"]"),Lk(a,b.Ad,b.scopes,b.mode,b.Ya));a.hg=D()}function hm(a,b,c,d,e){Q(a.logger,"push tx queue["+a.j.length+"]");a.j.push({Ad:b,scopes:c,mode:d,Ya:e});100<a.j.length&&0==a.j.length%100&&O(a.logger,"Transaction queue stack size is "+a.j.length+". It is too large, possibility due to incorrect usage.")}h.Md=!1;
function Lk(a,b,c,d,e){var f=c;if(x(c))f=[c];else if(null!=c)if(w(c)){if(0==c.length)throw new M("number of store names must more than 0");for(var g=0;g<c.length;g++)if(!x(c[g]))throw new M("store name at "+g+" must be string but found "+typeof c[g]);}else throw new M("store names must be an array");else f=null;if(a.i&&a.i.je()&&!a.Md){var k=t(d)?d:Mj;k==Oj&&(a.Md=!0);a.i.zd(function(a){b(a);b=null},f,k,function(b,c){ga(e)&&(e(b,c),e=void 0);k==Oj&&(a.Md=!1);fm(a)})}else hm(a,b,f,d,e)}
h.Lf=function(a){O(this.logger,"Synchronization option for "+a.getName()+" ignored.")};h.Kf=function(a){O(this.logger,"Full text indexer option for "+a.getName()+" ignored.")};h.Ra=function(){};h.toString=function(){return"Storage:"+this.i};function im(a,b,c,d){this.j=a;this.l=b;this.g=$a(c);this.h=d;this.i=[]}im.prototype.j=null;im.prototype.onCompleted=function(a,b){for(var c=0;c<this.i.length;c++)this.i[c](a,b);this.i.length=0;this.i=this.g=this.j=null};function jm(a,b,c){if(a.j)c&&a.i.push(c),b(a.j);else throw new Tc("tx committed on ParallelTxExecutor");}im.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.l+" mode:"+this.h+" scopes:"+S(this.g)};function km(a,b,c,d,e,f){zk.call(this,a,b,c,d,e,f);this.j=this.h=null}E(km,zk);h=km.prototype;h.logger=R("ydn.db.tr.Parallel");h.abort=function(){P(this.logger,this+": aborting");Dk(this.j)};
h.vg=function(a,b){var c;if("multi"==this.l)a:if(c=this.h,!c.g||!c.h||b!=c.h&&(c.h!=Nj||b!=Mj)||a.length>c.g.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.l)a:if(c=this.h,c.g&&c.h&&b==c.h&&c.g.length==a.length){for(d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.l?!0:!1;return c};
h.Qb=function(a,b,c,d){function e(c){l.i++;m=new im(c,l.i,b,k);g=l.Ka();df(l.logger,g+" BEGIN "+S(b)+" "+k);l.h=m;jm(l.h,a,d)}function f(a,b){df(l.logger,g+" "+a);if(m)m.onCompleted(a,b);l.g=0}var g;this.$&&(b=this.$);this.V&&(c=this.V);var k=t(c)?c:Mj,l=this,m;if(this.h&&this.h.j&&this.vg(b,k))jm(this.h,a,d);else{if(this.K&&this.i>=this.K)throw new Sc("Exceed maximum number of transactions of "+this.K);Lk(this.J(),e,b,k,f)}};
h.request=function(a,b,c,d){var e=km.m.request.call(this,a,b,c,d),f=this;this.Qb(function(a){f.g++;fk(e,a,f.Ka()+"R"+f.g)},b,c||Mj,d);return e};h.pc=function(a,b,c,d,e){var f=this,g;this.Qb(function(c){f.g++;g=f.Ka()+"R"+f.g;P(f.logger,g+" BEGIN");b(c,g,function(b,d){f.j=c;g=f.Ka()+"R"+f.g;d?(P(f.logger,g+" ERROR"),a.w(b)):(P(f.logger,g+" SUCCESS"),a.u(b));f.j=null});b=null;P(f.logger,g+" END")},c,d,e)};h.toString=function(){return"Parallel:"+this.l+":"+this.Ka()+(this.j?"*":"")};function lm(a,b){km.call(this,a,b,Ak)}E(lm,km);h=lm.prototype;h.logger=R("ydn.db.tr.AtomicParallel");h.vg=function(){return!1};h.request=function(a,b,c){var d,e,f,g=this,k=lm.m.request.call(this,a,b,c,function(a,b){k.g=null;P(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new uk;V(k,c,!0)}});ik(k,function(a,b,c){f=b;e=a;d=c});return k};
h.pc=function(a,b,c,d,e){var f,g,k=new F;k.t(function(a){g=!1;f=a},function(a){g=!0;f=a});lm.m.pc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.w(c);else if(!0===g)a.w(f);else if(!1===g)a.u(f);else{var d=new uk;a.w(d)}e&&(e(b,c),e=void 0)})};h.toString=function(){return"Atomic"+lm.m.toString.call(this)};function mm(a,b,c){am.call(this,a,b,c);this.l=0;a=!0;b=Ak;c&&(t(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=nm(this,b,a);this.$a=nm(this,"atomic",!1);this.g=this.Zc(c,this.$a)}E(mm,am);mm.prototype.l=0;mm.prototype.Zc=function(a,b){return new Nk(this,this.h,a,b)};
function nm(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==Ak)return new Gk(a,a.l++,b,d,e,f);if("atomic"==b)return new Mk(a,a.l++);throw new M('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==Ak)return new km(a,a.l++,b,d,e,f);if("atomic"==b)return new lm(a,a.l++);throw new M('Invalid requestType "'+b+'"');}
mm.prototype.V=function(a,b,c){if(3<arguments.length)throw new M("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.l++;var d=b||Yk(this.h),e=Mj;if(c)if("readwrite"==c)e=Nj;else if("readonly"!=c)throw new M('Invalid transaction mode "'+c+'"');var f=nm(this,"all",!1,d,e,1),g=this.Zc(f,this.$a),k=new ek("run"),l=this;f.Qb(function(b){Q(l.logger,"executing run in transaction on "+f);fk(k,b,f.Ka()+"R0");a(g)},d,e,function(a){k.g=null;V(k,f.i,
"complete"!==a)});return k};function om(a,b,c){mm.call(this,a,b,c);a=this.h;for(b=0;b<a.i.length;b++){c=a.i[b];var d=Z(a,c.getName());if(d){if(!Zk(d,"k"))throw new M('full text index store "'+d.getName()+'" must have "keyword" index');if(!Zk(d,"v"))throw new M('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new M('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new M('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=Z(a,e.F());if(f)this.Kf(f,c);else throw new M('full text source store "'+e.F()+'" does not exist for full text index "'+c.getName()+'"');}}}E(om,mm);h=om.prototype;h.init=function(){om.m.init.call(this)};h.Zc=function(a,b){return new Vk(this,this.h,a,b)};h.add=function(a,b,c){return this.g.add(a,b,c)};h.count=function(a,b,c,d){return this.g.count(a,b,c,d)};h.get=function(a,b){return this.g.get(a,b)};h.keys=function(a,b,c,d,e,f,g){return this.g.keys(a,b,c,d,e,f,g)};
h.values=function(a,b,c,d,e,f){return this.g.values(a,b,c,d,e,f)};h.list=function(a,b,c,d,e,f,g,k,l){return this.g.list(a,b,c,d,e,f,g,k,l)};h.load=function(a,b,c){return this.g.load(a,b,c)};h.put=function(a,b,c){return this.g.put(a,b,c)};h.clear=function(a,b,c){return this.g.clear(a,b,c)};h.remove=function(a,b,c){return this.g.remove(a,b,c)};h.toString=function(){var a="Storage:"+this.getName();Kk(this)&&(a+=" ["+Ck(this)+"]");return a};function pm(a,b,c){om.call(this,a,b,c)}E(pm,om);pm.prototype.Zc=function(a,b){return new sl(this,this.h,a,b)};pm.prototype.map=function(a,b){return this.g.map(a,b)};function qm(a,b,c,d){Qj.call(this,a,b,c,d);this.l=null}E(qm,Qj);h=qm.prototype;h.logger=R("ydn.db.core.req.IDBCursor");h.Tf=function(a){(a=a.target.result)?this.jc(a.key,a.primaryKey,a.value):this.jc()};
h.openCursor=function(a,b){function c(a,b,c){p.l=n;p.l.onsuccess=B(p.Tf,p);p.jc(a,p.j?b:void 0,c);n=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");Q(this.logger,d);var e=this.aa,d=this.n.objectStore(this.O),f=x(this.yb)?d.index(this.yb):null;if(t(a))var g=f?!t(b):!0,k=e?e.lower:void 0,l=e?e.upper:void 0,m=e?!!e.lowerOpen:!1,e=e?!!e.upperOpen:!1,e=oj(this.reverse?new U(k,a,m,g):new U(a,l,g,e));var n;this.Xc?f?n=null!=this.Db?f.openKeyCursor(e,this.Db):null!=e?f.openKeyCursor(e):
f.openKeyCursor():n=null!=this.Db?d.openCursor(e,this.Db):null!=e?d.openCursor(e):d.openCursor():f?n=null!=this.Db?f.openCursor(e,this.Db):null!=e?f.openCursor(e):f.openCursor():n=null!=this.Db?d.openCursor(e,this.Db):null!=e?d.openCursor(e):d.openCursor();var p=this;n.onerror=function(a){var b=n.error;a.preventDefault();p.V(b);Tj(p);p.H=!0};null!=a?n.onsuccess=function(d){if(d=d.target.result){var e=Pj.cmp(d.key,a),f=p.reverse?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);
else if(null!=b)if(Pj.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(p.l=n,p.l.onsuccess=B(p.Tf,p))};h.Ld=function(){return!!this.l};h.update=function(a){var b=this.l.result;if(b){var c=new F;a=b.update(a);a.onsuccess=function(a){c.u(a.target.result)};a.onerror=function(a){a.preventDefault();c.w(a)};return c}throw new pk("cursor gone");};
h.clear=function(){var a=this.l.result;if(a){var b=new F,a=a["delete"]();a.onsuccess=function(){b.u(1)};a.onerror=function(a){a.preventDefault();b.w(a)};return b}throw new pk("cursor gone");};h.advance=function(a){var b=this.l.result;if(1==a)b["continue"]();else b.advance(a)};h.vd=function(a){var b=this.l.result;if(null!=a)b["continue"](a);else b["continue"]()};h.G=function(){qm.m.G.call(this);this.l=null};h.toString=function(){return"IDB"+qm.m.toString.call(this)};function rm(a,b,c,d,e,f){F.call(this,e,f);this.j=a;this.g=[];this.o=!!b;this.V=!!c;this.P=!!d;for(b=this.H=0;b<a.length;b++)a[b].t(B(this.s,this,b,!0),B(this.s,this,b,!1));0!=a.length||this.o||this.u(this.g)}E(rm,F);rm.prototype.s=function(a,b,c){this.H++;this.g[a]=[b,c];this.rb||(this.o&&b?this.u([a,c]):this.V&&!b?this.w(c):this.H==this.j.length&&this.u(this.g));this.P&&!b&&(c=null);return c};rm.prototype.w=function(a){rm.m.w.call(this,a);for(a=0;a<this.j.length;a++)lb(this.j[a])};function sm(a,b){this.g=b}E(sm,yk);h=sm.prototype;h.logger=R("ydn.db.crud.req.IndexedDb");h.xd=function(a,b){function c(e){var f=a.g.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?V(a,d):c(e)};f.onerror=function(b){b.preventDefault();V(a,f.error,!0)}}var d=[];0==b.length?V(a,[]):c(0)};
h.lb=function(a,b,c,d,e,f){function g(s){if(null==e[s])if(Q(n.logger,"empty object at "+s+" of "+e.length),l++,l==e.length)V(a,k,m);else{var z=s+10;z<e.length&&g(z)}var C,z=e[s];C=null!=f?b?q.put(z,f[s]):q.add(z,f[s]):b?q.put(z):q.add(z);C.onsuccess=function(b){l++;k[s]=b.target.result;l==e.length?V(a,c?k[0]:k,m):(b=s+10,b<e.length&&g(b))};C.onerror=function(b){l++;var f=C.error;Q(n.logger,X(a)+p+' request to "'+d+'" cause '+f.name+' for object "'+Ah(e[s])+'" at index '+s+" of "+e.length+" objects.");
k[s]=f;m=!0;b.preventDefault();l==e.length?V(a,c?k[0]:k,m):(b=s+10,b<e.length&&g(b))}}var k=[],l=0,m=!1,n=this,p=b?"put":"add",q=a.g.objectStore(d);Q(this.logger,X(a)+" "+p+" "+e.length+' objects to store "'+d+'"');if(0<e.length)for(var s=0;10>s&&s<e.length;s++)g(s);else V(a,[])};
h.Wd=function(a,b,c){function d(l){var n=c[l],p=n.F(),q=a.g.objectStore(p),s;s=null===q.keyPath?q.put(b[l],n.D()):q.put(b[l]);s.onsuccess=function(c){f++;e[l]=c.target.result;f==b.length?V(a,e,g):(c=l+10,c<b.length&&d(c))};s.onerror=function(c){f++;O(k.logger,"request result "+c.name+' error when put keys to "'+p+'" for object "'+Ah(b[l])+'" at index '+l+" of "+b.length+" objects.");e[l]=s.error;g=!0;c.preventDefault();f==b.length?V(a,e,g):(c=l+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,k=this;Q(this.logger,
X(a)+" putByKeys: of "+b.length+" objects");if(0<b.length)for(var l=0;10>l&&l<b.length;l++)d(l);else V(a,e,g)};
h.of=function(a,b,c,d,e,f){function g(){var a={},b=e.indexOf("\n",n),d=!1,s;-1==b?(d=!0,s=e.substring(n)):(s=e.substring(n,b),n=b+1);for(var b=s.split(f),J=0;J<p.length;J++){var N=b[J];q[J]&&(q[J]==Al?N=Fa(N,'"'):"INTEGER"==q[J]?N=parseInt(N,10):"NUMERIC"==q[J]&&(N=parseFloat(N)));a[p[J]]=N}var ha=l.put(a);ha.onsuccess=function(a){m.push(a.target.result);d?c(m):g()};ha.onerror=function(a){"DataError"==a.name&&(a=new mk(k+": "+s.substring(0,70)));a.preventDefault();c(ha.error,!0)}}var k=Z(this.g,d),
l=a.objectStore(d),m=[],n=e.indexOf("\n"),p=e.substr(0,n).split(f),q=[];for(a=0;a<p.length;a++){var s=Sj(k,p[a]);s?q[a]=s.type:p[a]==k.keyPath&&(q[a]=k.type)}n++;Q(this.logger,b+" Loading data  of "+p.length+"-fields record to "+d);g()};
h.Yd=function(a,b,c){var d=a.g.objectStore(b);Q(this.logger,X(a)+" clearById: "+b+" "+c);var e=d.openCursor(sj.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){V(a,1)};c.onerror=function(){V(a,c.error,!0)}}else V(a,0)};e.onerror=function(b){b.preventDefault();V(a,e.error,!0)}};
h.Zd=function(a,b){function c(k){k++;if(k>=b.length)0<g.length?V(a,g,!0):V(a,d);else{b[k].F()!=e&&(e=b[k].F(),f=a.g.objectStore(e));var l=f["delete"](b[k].D());l.onsuccess=function(){d++;c(k)};l.onerror=function(a){a.preventDefault();g[k]=l.error;c(k)}}}var d=0,e,f;Q(this.logger,X(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
h.cd=function(a,b,c){var d=a.g.objectStore(b),e=d.count(c);Q(this.logger,X(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,k=d["delete"](c);k.onsuccess=function(){V(a,e)};k.onerror=function(){V(a,k.error,!0)}};e.onerror=function(b){b.preventDefault();V(a,e.error,!0)}};h.ve=function(a,b,c){var d=a.g.objectStore(b);Q(this.logger,X(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){V(a,void 0)};e.onerror=function(b){b.preventDefault();V(a,e.error,!0)}};
h.pf=function(a,b,c,d){var e=a.g.objectStore(b).index(c);Q(this.logger,X(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),k=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){k++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?V(a,f,!0):V(a,k)};g.onerror=function(b){b.preventDefault();V(a,g.error,!0)}};
h.ud=function(a,b){var c=b.length,d=0;Q(this.logger,X(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.g.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&V(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&V(a,f.error,!0)}}};
h.Bd=function(a,b,c){var d=this;Q(this.logger,X(a)+b+":"+c);var e=a.g.objectStore(b),f=e.get(c);f.onsuccess=function(b){Q(d.logger,X(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");var f=b.target.result;if(!e.keyPath&&0==e.indexNames.length&&Kb&&x(f)&&0<=f.indexOf(";base64,")){'"'==f.charAt(0)&&'"'==f.charAt(f.length-1)&&(f=f.substr(1,f.length-2));f=f.split(";base64,");b=f[0].split(":")[1];for(var f=window.atob(f[1]),l=f.length,m=new Uint8Array(l),n=0;n<l;++n)m[n]=f.charCodeAt(n);
V(a,new Blob([m.buffer],{type:b}))}else V(a,b.target.result)};f.onerror=function(b){b.preventDefault();V(a,f.error,!0)}};
h.hf=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==k)V(a,e);else{var m=b+10;m<k&&d(m)}var n;n=g.get(c[b]);n.onsuccess=function(c){f++;e[b]=c.target.result;f==k?V(a,e):(c=b+10,c<k&&d(c))};n.onerror=function(b){f++;b.preventDefault();V(a,n.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.g.objectStore(b),k=c.length;Q(this.logger,X(a)+" "+b+":"+k+" ids");if(0<k)for(b=0;10>b&&b<k;b++)d(b);else V(a,[])};
h.Qd=function(a,b){function c(f){var k=b[f],l=a.g.objectStore(k.F()).get(k.D());l.onsuccess=function(k){e++;d[f]=k.target.result;e==b.length?V(a,d):(k=f+10,k<b.length&&c(k))};l.onerror=function(b){e++;b.preventDefault();V(a,l.error,!0)}}var d=[];d.length=b.length;var e=0;Q(this.logger,X(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else V(a,[])};
h.Kc=function(a,b,c,d,e){if(d&&e)throw new Sc("unique count not available in IndexedDB");e=a.g.objectStore(b);b=X(a)+" "+b+(d?":"+d:"")+(c?":"+S(c):"");Q(this.logger,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){V(a,b.target.result)};f.onerror=function(b){b.preventDefault();V(a,f.error,!0)}};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=[],p=a.g.objectStore(c),q=k?l?"prevunique":"prev":l?"nextunique":"next";c=X(a)+" "+b+" "+c+(d?":"+d:"")+(e?S(e):"");k&&(c+=" reverse");l&&(c+=" unique");if(m&&t(m[0])){l=d?!t(m[1]):!0;var s=m[0],v=e?e.lower:void 0,z=e?e.upper:void 0,C=e?!!e.lowerOpen:!1;e=e?!!e.upperOpen:!1;e=oj(k?new U(v,s,C,l):new U(s,z,l,e));c+=" starting from "+S(m[0]);t(m[1])&&(c+=", "+S(m[1]))}Q(this.logger,c);var G;G=1==b||2==b||3==b?d?p.index(d).openKeyCursor(e,q):p.openCursor(e,
q):d?p.index(d).openCursor(e,q):p.openCursor(e,q);var J=!1;G.onsuccess=function(c){if(c=c.target.result){if(!J){if(0<g){J=!0;c.advance(g);return}if(m&&d&&t(m[0]))if(t(m[1])){var e=Pj.cmp(c.key,m[0]),l=k?-1:1;if(0==e){e=Pj.cmp(c.primaryKey,m[1]);if(0==e){J=!0;c["continue"]();return}if(e==l)J=!0;else{c["continue"]();return}}else J=!0}else J=!0;else J=!0}1==b?n.push(c.key):2==b?n.push(c.primaryKey):3==b?(l={},d&&(l[d]=c.key),p.keyPath?l[p.keyPath]=c.primaryKey:l._ROWID_=c.primaryKey,n.push(l)):4==b?
n.push(c.value):n.push([c.key,c.primaryKey,c.value]);if(n.length<f)c["continue"]();else m&&(m[0]=Uj(c.key),m[1]=Uj(c.primaryKey)),V(a,n)}else m&&(m[0]=void 0,m[1]=void 0),V(a,n)};G.onerror=function(b){b.preventDefault();V(a,G.error,!0)}};function tm(a,b){this.g=b}E(tm,sm);tm.prototype.logger=R("ydn.db.core.req.IndexedDb");tm.prototype.h=function(a,b,c,d){c=Z(this.g,c);return new qm(a,b,c,d)};function um(){this.g=!1}um.prototype.g=!1;function vm(a,b,c,d){Qj.call(this,a,b,c,d);this.o=this.h=this.g=void 0;this.s=this.l=null;this.K=new um;this.ce=this.Da=null}E(vm,Qj);h=vm.prototype;h.logger=R("ydn.db.core.req.SimpleCursor");h.Ld=function(){return!!this.n};h.update=function(a){wm(this.ce,this.ga(),a);return sb()};h.advance=function(a){function b(b){d++;if(!b||d>=a)return xm(c,b)}var c=this,d=this.l?-1:0;this.reverse?ym(this.Da,b,this.l):zm(this.Da,b,this.l)};
h.vd=function(a){if(null!=a){var b=this,c=new Am(a),d=function(c){b.l=c;if(!c)return xm(b,c);var d=wj(c.value.key,a);if(b.reverse){if(1!=d)return xm(b,c)}else if(-1!=d)return xm(b,c)};this.reverse?ym(this.Da,d,c):zm(this.Da,d,c)}else this.advance(1)};function Bm(a){setTimeout(function(){a.K.g?(a.K.g=!1,a.jc(a.g,a.h,a.o),Bm(a)):(a.s(),a.s=null)},4)}
function xm(a,b){if(a.l=b){var c=b.value;if(a.aa)if(a.reverse||null==a.aa.upper)a.reverse&&null!=a.aa.lower&&(d=wj(c.key,a.aa.lower),-1==d||0==d&&a.aa.lowerOpen)&&(a.l=null);else{var d=wj(c.key,a.aa.upper);if(1==d||0==d&&a.aa.upperOpen)a.l=null}if(a.l){if(a.unique&&null!=a.g&&null!=c.key&&0==wj(a.g,c.key))return;a.g=c.key;a.h=a.j?c.ga():a.g;4==a.na&&(a.Xc?a.o=a.h:a.o=a.ce.ha(null,a.h))}}a.l||(a.g=void 0,a.h=void 0,a.o=void 0);return a.K.g=!0}
h.openCursor=function(a,b){var c=null;if(this.aa)if(this.reverse){var d=this.j?"\uffff":void 0;null!=this.aa.upper&&(c=new Am(this.aa.upper,d))}else null!=this.aa.lower&&(c=new Am(this.aa.lower));null!=a&&(c=this.j?new Am(a,b):new Am(a));this.s=this.n.J(function(b){function d(b){var e=b.value,f=e.key;if(b&&null!=f)if(null!=a){if(0==Cm(c,e))return}else if(this.aa&&(!this.reverse&&this.aa.lowerOpen&&null!=this.aa.lower&&(e=wj(f,this.aa.lower),0==e)||this.reverse&&this.aa.upperOpen&&null!=this.aa.upper&&
(e=wj(f,this.aa.upper),0==e)))return;return xm(this,b)}this.ce=Dm(b,this.O);this.Da=Em(this.ce,this.yb);this.reverse?ym(this.Da,B(d,this),c):zm(this.Da,B(d,this),c);Bm(this)},this)};h.clear=function(){throw new Rc;};h.toString=function(){return"Simple"+vm.m.toString.call(this)};function Fm(a,b,c){a=["ydn.db",a];t(b)&&(a.push(b),t(c)&&(a.push(c),t(void 0)&&a.push(Bj(void 0))));return a.join("^|")};function Am(a,b){this.key=a;this.g=b}Am.prototype.ga=function(){return this.g};Am.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.g?", "+this.g+")":")")};function Cm(a,b){var c=wj(a.key,b.key);return 0===c?null!=a.g?null!=b.g?wj(a.g,b.g):1:null!=b.g?-1:0:c};function Gm(a){this.Qa=a||Hm}function Hm(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}h=Gm.prototype;h.Ba=null;h.Qa=null;h.Bb=null;h.zb=null;
h.add=function(a){if(null==this.Ba)return this.zb=this.Bb=this.Ba=new Im(a),!0;var b=null;Jm(this,function(c){var d=null;0<this.Qa(c.value,a)?(d=c.left,null==c.left&&(b=new Im(a,c),c.left=b,c==this.Bb&&(this.Bb=b))):0>this.Qa(c.value,a)&&(d=c.right,null==c.right&&(b=new Im(a,c),c.right=b,c==this.zb&&(this.zb=b)));return d});b&&(Jm(this,function(a){a.count++;return a.parent},b.parent),Km(this,b.parent));return!!b};
h.remove=function(a){var b=null;Jm(this,function(c){var d=null;0<this.Qa(c.value,a)?d=c.left:0>this.Qa(c.value,a)?d=c.right:(b=c.value,Lm(this,c));return d});return b};h.clear=function(){this.zb=this.Bb=this.Ba=null};h.contains=function(a){var b=!1;Jm(this,function(c){var d=null;0<this.Qa(c.value,a)?d=c.left:0>this.Qa(c.value,a)?d=c.right:b=!0;return d});return b};h.fa=function(){return this.Ba?this.Ba.count:0};h.ya=function(){var a=[];Mm(this,function(b){a.push(b)});return a};
function Mm(a,b){if(a.Ba){var c,d=c=Nm(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Jm(a,b,c){for(c=c?c:a.Ba;c&&null!=c;)c=b.call(a,c)}
function Km(a,b){Jm(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Om(this,a.left),Pm(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Pm(this,a.right),Om(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Om(a,b){Qm(b)?(b.parent.left=b.right,b.right.parent=b.parent):Rm(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.Ba=b.right,a.Ba.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Pm(a,b){Qm(b)?(b.parent.left=b.left,b.left.parent=b.parent):Rm(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.Ba=b.left,a.Ba.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Lm(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Sm(a,b.left);Jm(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.zb&&(a.zb=d)}else{d=Nm(a,b.right);Jm(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.Bb&&(a.Bb=d)}d.count=b.count;Qm(b)?b.parent.left=d:Rm(b)?b.parent.right=d:a.Ba=d;Km(a,c?c:d)}else Jm(a,function(a){a.count--;return a.parent},b.parent),Qm(b)?(b.parent.left=null,b==a.Bb&&(a.Bb=b.parent),Km(a,b.parent)):Rm(b)?(b.parent.right=null,b==a.zb&&(a.zb=b.parent),Km(a,b.parent)):a.clear()}function Nm(a,b){if(!b)return a.Bb;var c=b;Jm(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Sm(a,b){if(!b)return a.zb;var c=b;Jm(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Im(a,b){this.value=a;this.parent=b?b:null;this.count=1}Im.prototype.left=null;Im.prototype.right=null;Im.prototype.height=1;function Rm(a){return!!a.parent&&a.parent.right==a}function Qm(a){return!!a.parent&&a.parent.left==a};function Tm(a){this.Qa=a||Hm}E(Tm,Gm);function zm(a,b,c){if(a.Ba){var d;if(c instanceof Im)d=c;else if(c){if(Jm(a,function(a){var b=null;0<this.Qa(a.value,c)?(b=a.left,d=a):0>this.Qa(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Nm(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function ym(a,b,c){if(a.Ba){var d;if(c instanceof Im)d=c;else if(c){if(Jm(a,B(function(a){var b=null;0<this.Qa(a.value,c)?b=a.left:(0>this.Qa(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Sm(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Um(a,b,c){this.l=a;this.storage=b;this.h=c;this.g={};a=this.h.keyPath;this.i=u(a)?a.join(","):a||"_ROWID_";this.g[this.i]=null;this.j=Fm(this.l,this.h.getName(),this.i)+"^|"}
function Em(a,b){var c=b||a.i;if(!a.g[c]){a.g[c]=new Tm(Cm);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&ra(f,a.j)){var g=Ej(f.substr(a.j.length));if(c==a.i)a.g[c].add(new Am(g));else{var k=a.storage.getItem(f);if(null!==k)if(f=Sj(a.h,c),k=zh(k),k=Bl(f,k),f.multiEntry){if(u(k))for(f=0;f<k.length;f++)a.g[c].add(new Am(k[f],g))}else a.g[c].add(new Am(k,g))}}}}return a.g[c]}
function Vm(a,b,c){for(var d in a.g){var e=a.g[d];if(e)if(d==a.i)e.remove(new Am(b));else{var f=Sj(a.h,d),f=yj(c,f.keyPath);e.remove(new Am(b,f))}}}function Wm(a){for(var b in a.g){var c=a.g[b];c&&c.clear()}a.g={}}
function wm(a,b,c,d){if(null==b&&(a.h.keyPath&&(b=cl(a.h,c)),a.h.h&&null==b)){b=a.j+Bj(void 0);var e=zh(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,S(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.j+Bj(b)));if(d)return null;a.storage.setItem(a.j+Bj(b),S(c));d=b;for(var f in a.g)if(e=a.g[f])if(f==a.i)e.add(new Am(d));else{var g=Sj(a.h,f),g=yj(c,g.keyPath);null!=g&&e.add(new Am(d,g))}return b}
function Xm(a,b){var c=a.j+Bj(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=zh(d);Vm(a,b,c);return 1}h=Um.prototype;h.clear=function(){Wm(this);Ym(this)};h.ha=function(a,b){if(a&&a!=this.i)throw"impl";var c=this.storage.getItem(this.j+Bj(b)),d=void 0;if(null!==c)for(var d=zh(c),c=0,e=this.h.indexes.length;c<e;c++){var f=this.h.index(c);if("DATE"==f.type){var g=Bl(f,d);g&&Cl(f,d,new Date(g))}}return d};h.getName=function(){return this.h.getName()};
function Zm(a,b,c){b=b||a.i;a=Em(a,b);var d=null,e=null,f=0,g=!1,k=!1;null!=c&&(null!=c.lower&&(d=new Am(c.lower)),null!=c.upper&&(e=new Am(c.upper)),g=c.lowerOpen,k=c.upperOpen);zm(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=wj(a.key,d.key))){if(null!=e&&(a=wj(a.key,e.key),1===a||0===a&&k))return!0;f++}},d);return f}
function Ym(a,b){var c=Em(a,a.i),d=null,e=null,f=0,g=[],k=[],l=!1,m=!1;null!=b&&(null!=b.lower&&(d=new Am(b.lower)),null!=b.upper&&(e=new Am(b.upper)),l=b.lowerOpen,m=b.upperOpen);zm(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=Cm(b,d))){if(null!=e){var c=Cm(b,e);if(1===c||0===c&&m)return!0}var c=a.j+Bj(b.key),q=a.storage.getItem(c);null!==q&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),k.push(zh(q))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Vm(a,g[c],k[c]);else Wm(a);return f}
h.Cd=function(a,b,c,d,e,f,g,k){function l(b){if(b&&(z++,!(z<f))){var c=b.value;if(d){if(G&&null!=v&&(b=p?Cm(c,v):wj(c.key,v.key),0==b))return;if(null!=s&&(b=p?Cm(c,s):wj(c.key,s.key),-1==b||0==b&&C))return k&&(k[0]=void 0,k[1]=void 0),!0}else{if(C&&null!=s&&(b=p?Cm(c,s):wj(c.key,s.key),0==b))return;if(null!=v&&(b=p?Cm(c,v):wj(c.key,v.key),1==b||0==b&&G))return k&&(k[0]=void 0,k[1]=void 0),!0}b=c.key;if(!g||!q||null==n||0!=wj(n,b)){c=q?c.ga():b;if(2==a)m.push(c);else if(1==a)m.push(b);else if(3==a)m.push([b,
c]);else if(4==a){var l=N.ha(null,c);m.push(l)}else m.push([b,c,N.ha(null,c)]);k&&(k[0]=b,k[1]=c)}n=b;if(t(e)&&m.length>=e)return!0}}var m=[],n,p=!!k&&null!=k[0];b=b||this.i;var q=b!=this.i;b=Em(this,b);var s=null,v=null;t(f)||(f=0);var z=-1,C=!1,G=!1;null!=c&&(null!=c.lower&&(s=q&&d?new Am(c.lower,"\uffff"):new Am(c.lower)),null!=c.upper&&(v=q&&!d?new Am(c.upper,"\uffff"):new Am(c.upper)),C=!!c.lowerOpen,G=!!c.upperOpen);if(p){d?G=!0:C=!0;c=k[0];var J=t(k[1])?k[1]:"\uffff";d?v=q?new Am(c,J):new Am(c):
s=q?new Am(c,J):new Am(c)}var N=this;d?ym(b,l,v):zm(b,l,s);return m};h.La=function(a,b,c,d,e){return this.Cd(2,a,b,c,d,e)};h.toString=function(){return"ydn.db.con.simple.Store:"+this.l+":"+this.h.getName()};function $m(){this.clear()}h=$m.prototype;h.xe=function(){return this};h.setItem=function(a,b){t(this.g[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.g[a]=b};h.getItem=function(a){return t(this.g[a])?this.g[a]:null};h.removeItem=function(a){delete this.g[a];Xa(this.keys,a.toString());this.length=this.keys.length};h.length=0;h.key=function(a){a=this.keys[a];return t(a)?this.g[a]:null};h.clear=function(){this.g={};this.keys=[];this.length=0};function an(a){this.n=a||new $m;this.l={}}function Dm(a,b){var c=Z(a.g,b);if(c)a.l[b]||(a.l[b]=new Um(a.i,a.j,c));else throw new Tc('store name "'+b+'" not found.');return a.l[b]}an.prototype.ib=function(a){var b=this;setTimeout(function(){var c=Fm(b.i),c=b.j.getItem(c),c=new Wl(c);a(c)},10)};function bn(a,b){this.h=a;this.g=b}bn.prototype.J=function(a,b){var c=this.h;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.g("complete",null);d.g=null;d.h=null}};function cn(a,b){this.g=b}E(cn,yk);h=cn.prototype;h.logger=R("ydn.db.crud.req.SimpleStore");h.Wd=function(a,b,c){this.lb(a,!0,!1,null,b,c)};
h.lb=function(a,b,c,d,e,f){Q(this.logger,X(a)+" "+(b?"put":"add")+"Object"+(c?"":"s "+e.length+" objects"));var g=a.g.J(function(k){var l;if(c)l=Dm(k,d),k=f?f[0]:void 0,k=wm(l,k,e[0],!b),null!=k?V(a,k):(l=Ah(k),l=new lk(l),V(a,l,!0));else{for(var m=d,n=[],p=!1,q=f||{},s=0;s<e.length;s++){var v;d?v=q[s]:(m=f[s],v=m.D(),m=m.F());l&&l.getName()==m||(l=Dm(k,m));v=wm(l,v,e[s],!b);null!=v?n.push(v):(p=!0,n.push(new lk))}V(a,n,p)}g();g=null},this)};h.of=function(){throw new Rc("putData");};
h.Bd=function(a,b,c){var d=a.g.J(function(e){e=Dm(e,b).ha(null,c);V(a,e);d();d=null},this)};function dn(a,b,c,d){var e=b.g.J(function(a){for(var g=[],k=c,l,m=0;m<d.length;m++){var n=d[m];n instanceof vk&&(k=n,n=k.D(),k=k.F());l&&l.getName()==k||(l=Dm(a,k));n=l.ha(null,n);g[m]=n}V(b,g,!1);e();e=null},a)}h.hf=function(a,b,c){dn(this,a,b,c)};h.Qd=function(a,b){dn(this,a,null,b)};
h.Yd=function(a,b,c){var d=X(a)+" removeById "+b+" "+c;Q(this.logger,d);var e=this,f=a.g.J(function(g){g=Xm(Dm(g,b),c);P(e.logger,"success "+d+(0==g?" [not found]":""));V(a,g);f();f=null},this)};h.Zd=function(a,b){Q(this.logger,X(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=a.g.J(function(f){for(var g=0;g<b.length;g++){var k=b[g].F(),l=b[g].D();c&&c.getName()==k||(c=Dm(f,k));d+=Xm(c,l)}V(a,d);e();e=null},this)};h.ve=function(a,b,c){this.cd(a,b,c)};
h.cd=function(a,b,c){var d=X(a)+" removeByKeyRange "+(c?S(c):"");Q(this.logger,d);var e=this,f=a.g.J(function(g){g=Ym(Dm(g,b),c);P(e.logger,d+" deleted "+g+" records.");V(a,g);f();f=null},this)};h.pf=function(a,b,c,d){var e=X(a)+" removeByIndexKeyRange "+(d?S(d):"");Q(this.logger,e);var f=a.g.J(function(e){e=Dm(e,b);for(var k=e.La(c,d),l=k.length,m=0;m<l;m++)Xm(e,k[m]);V(a,l);f();f=null},this)};
h.ud=function(a,b){var c=X(a)+" clearByStores";Q(this.logger,c);var d=a.g.J(function(e){for(var f=0;f<b.length;f++)Dm(e,b[f]).clear();P(this.logger,"success "+c);V(a,b.length);d();d=null},this)};h.xd=function(a,b){var c=a.g.J(function(d){for(var e=[],f=0;f<b.length;f++){var g=Dm(d,b[f]);e.push(Zm(g))}V(a,e);c();c=null},this)};
h.Kc=function(a,b,c,d){var e=X(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");Q(this.logger,e);var f=a.g.J(function(g){g=Zm(Dm(g,b),d,c);P(this.logger,"success "+e);V(a,g);f();f=null},this)};h.list=function(a,b,c,d,e,f,g,k,l,m){var n=X(a)+" "+c+" "+(e?Ah(e):"");Q(this.logger,n);var p=a.g.J(function(q){q=Dm(q,c).Cd(b,d,e,k,f,g,l,m);P(this.logger,n+" "+q.length+" records found.");V(a,q);p();p=null},this)};function en(a,b){this.g=b}E(en,cn);en.prototype.h=function(a,b,c,d){c=Z(this.g,c);return new vm(a,b,c,d)};function fn(a,b,c,d){Qj.call(this,a,b,c,d);this.K=null;this.s=this.l=void 0}E(fn,Qj);h=fn.prototype;h.logger=R("ydn.db.core.req.WebsqlCursor");h.ga=function(){return this.s};h.init=function(a,b,c,d,e){fn.m.init.call(this,a,b,c,d,e);this.K=x(b)?Sj(this.i,b):null};h.T=function(){return this.$};function gn(a,b){a.l=void 0;a.s=void 0;a.$=void 0;if(t(b))if(A(b)){var c=Dl(b[a.i.l],a.i.type);a.s=c;if(a.j){var d=Sj(a.i,a.yb);a.l=Dl(b[a.yb],d.type)}else a.l=c;a.$=a.Xc?c:hn(b,a.i)}else a.$=b}
function jn(a,b,c,d,e,f){var g=!d;d=[];a.j&&null!=f&&null!=c?c=Nl(a.i,a.na,d,a.K.getName(),a.aa,c,g,f,a.reverse,a.unique):null!=c?(f=a.K?a.K.getName():null,c=Ml(a.i,a.na,d,f,a.aa,a.reverse,a.unique,c,g)):(c=Jl(a.i,d,a.na,a.j?a.K.j:a.i.l,a.aa,a.reverse,a.unique),a.j&&(c+=", "+a.i.j+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);Q(a.logger,a+": continue:  SQL: "+c+" : "+S(d));a.n.executeSql(c,d,function(c,d){0<d.rows.length?gn(a,d.rows.item(0)):gn(a);b.call(a,a.l,a.s,a.$);b=null},function(c,d){O(a.logger,
"get error: "+d.message);a.V(d);Tj(a);a.H=!0;gn(a);b.call(a,a.s,a.l,a.$);b=null;return!1})}h.Ld=function(){return!!this.n};h.update=function(a){if(!this.Ld())throw new pk;var b=new F,c=this.ga();a=Ql(this.i,a,c);var d="REPLACE INTO "+Ll(this.i)+" ("+a.Rf.join(", ")+") VALUES ("+a.og.join(", ")+")";Q(this.logger,this+': update "'+d+'" : '+S(a.values));this.n.executeSql(d,a.values,function(){b.u(c)},function(a,c){b.w(c);return!1});return b};
h.advance=function(a){var b=this.l,c=this.s,d=!0;null==this.l||this.j&&null==this.s||(a-=1,d=!1);jn(this,function(a,d,g){var k=null!=b&&null!=a&&0==wj(b,a);if(this.j){var l=null!=d&&null!=c&&0==wj(d,c);if(k&&l)throw new Tc("current: "+b+";"+c+" next: "+a+";"+d);}else if(k)throw new Tc("current: "+b+" next: "+a);this.jc(a,d,g)},this.l,d,a,this.s)};h.vd=function(a){null!=a?jn(this,this.jc,a,!0):this.advance(1)};h.openCursor=function(a,b){jn(this,this.jc,a,!1,0,b)};
h.clear=function(){if(!this.Ld())throw new pk;var a=new F,b=this.i.l,b="DELETE FROM "+Ll(this.i)+" WHERE "+b+" = ?",c=[this.ga()];Q(this.logger,this+': clear "'+b+'" : '+S(c));this.n.executeSql(b,c,function(b,c){a.u(c.rowsAffected)},function(b,c){a.w(c);return!1});return a};h.toString=function(){return"WebSql"+fn.m.toString.call(this)};function kn(a,b){this.g=b}E(kn,yk);h=kn.prototype;h.logger=R("ydn.db.crud.req.WebSql");
function hn(a,b){if(b.oc&&!b.keyPath&&0==b.indexes.length&&a._default_){var c=a._default_;if(-1==c.indexOf(";base64,"))return zh(c);'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substr(1,c.length-2));for(var d=c.split(";base64,"),c=d[0].split(":")[1],d=window.atob(d[1]),e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f.buffer],{type:c})}c=a._default_?zh(a._default_):{};null!=b.keyPath&&(d=Dl(a[b.keyPath],b.type),null!=d&&jl(b,c,d));for(d=0;d<b.indexes.length;d++)e=
b.index(d),f=e.j,"_default_"==f||e.n||e.multiEntry||"DATE"!=e.type&&!b.oc||(f=Dl(a[f],e.type),t(f)&&Cl(e,c,f));return c}h.of=function(){throw new Rc("putData");};
h.lb=function(a,b,c,d,e,f){function g(b,d){if(null==e[b])if(Q(m.logger,"empty object at "+b+" of "+e.length),p++,p==e.length)P(m.logger,q+" success "+q),V(a,n,s);else{var C=b+2;C<e.length&&g(C,d)}var G;G=t(f)?Ql(k,e[b],f[b]):Ql(k,e[b]);C=l+Ll(k)+" ("+G.Rf.join(", ")+") VALUES ("+G.og.join(", ")+");";Q(m.logger,X(a)+" SQL: "+C+" PARAMS: "+G.values+" REQ: "+b+" of "+e.length);d.executeSql(C,G.values,function(f,q){function C(b,c){var e="ydn.db.me:"+k.getName()+":"+b.getName(),e=l+Ia(e)+" ("+k.j+", "+
b.i+") VALUES (?, ?)",f=[xj(I,k.type),xj(c,b.type)];Q(m.logger,X(a)+" multiEntry "+e+" "+f);d.executeSql(e,f,function(){},function(a,b){O(m.logger,"multiEntry index insert error: "+b.message);return!1})}p++;var I=t(G.key)?G.key:q.insertId;1>q.rowsAffected&&(s=!0,I=new lk(I+" no-op"));for(var lc=0,ri=k.indexes.length;lc<ri;lc++){var Yc=k.index(lc);if(Yc.multiEntry)for(var Jd=yj(e[b],Yc.keyPath),Nu=(Jd?Jd.length:0)||0,Hl=0;Hl<Nu;Hl++)C(Yc,Jd[Hl])}c?V(a,I):(n[b]=I,p==e.length?V(a,n,s):(lc=b+2,lc<e.length&&
g(lc,f)))},function(d,f){p++;s=!0;6==f.code?f.name="ConstraintError":O(m.logger,"error: "+f.message+" "+q);if(c)V(a,f,!0);else if(n[b]=f,p==e.length)Q(m.logger,"success "+q),V(a,n,s);else{var k=b+2;k<e.length&&g(k,d)}return!1})}b=!b;var k=Z(this.g,d),l=b?"INSERT INTO ":"INSERT OR REPLACE INTO ";d=a.g;var m=this,n=[],p=0,q=X(a)+" inserting "+e.length+" objects.",s=!1;if(0<e.length)for(b=0;2>b&&b<e.length;b++)g(b,d);else P(this.logger,"success"),V(a,[])};
h.Wd=function(a,b,c){if(0==c.length)V(a,[]);else{for(var d=[],e=0,f=0,g=this,k=function(k,l){var m=[];Q(g.logger,"put "+l.length+" objects to "+k);for(var n=Pl(Z(g.g,k)),p=n?void 0:[],q=0;q<l.length;q++)m.push(b[l[q]]),n||p.push(c[l[q]].D());n=gk(a);n.t(function(b){for(var c=0;c<l.length;c++)d[l[c]]=b[c];e++;e==f&&V(a,d)},function(){e++;e==f&&V(a,d,!0)});g.lb(n,!1,!1,k,m,p)},l="",m=[],n=[],p=0;p<c.length;p++){var q=c[p].F(),s=c[p].D();q!=l?(f++,0<m.length&&k(l,m),m=[p],n=[s],l=q):(m.push(p),n.push(s))}0<
m.length&&k(l,m)}};h.Bd=function(a,b,c){var d=a.g,e=Z(this.g,b),f=this;b=e.j;c=[xj(c,e.type)];b="SELECT * FROM "+Ll(e)+" WHERE "+b+" = ?";var g=X(a)+" SQL: "+b+" PARAMS: "+c;Q(this.logger,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=hn(d,e),V(a,d)):(P(f.logger,"success no result: "+g),V(a,void 0))}else P(f.logger,"success no result: "+g),V(a,void 0)},function(b,c){O(f.logger,"error: "+g+" "+c.message);V(a,c,!0);return!1})};
h.hf=function(a,b,c){function d(b,e){var p=l.j,q=[xj(c[b],l.type)],s="SELECT * FROM "+Ll(l)+" WHERE "+p+" = ?";Q(f.logger,"SQL: "+s+" PARAMS: "+q);e.executeSql(s,q,function(e,f){k++;if(0<f.rows.length){var n=f.rows.item(0);null!=n&&(g[b]=hn(n,l))}else g[b]=void 0;k==c.length?V(a,g):(n=b+10,n<c.length&&d(n,e))},function(e,l){k++;O(f.logger,"error: "+s+" "+l.message);if(k==c.length)V(a,g);else{var n=b+10;n<c.length&&d(n,e)}return!1})}var e=a.g,f=this,g=[],k=0,l=Z(this.g,b);if(0<c.length)for(b=0;10>
b&&b<c.length;b++)d(b,e);else P(f.logger,"success"),V(a,[])};
h.Qd=function(a,b){function c(d,k){var n=b[d],p=Z(e.g,n.F()),q=wk(n),n=p.j,q=[xj(q,p.type)],s="SELECT * FROM "+Ll(p)+" WHERE "+n+" = ?";Q(e.logger,"SQL: "+s+" PARAMS: "+q);k.executeSql(s,q,function(k,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=hn(n,p))}else f[d]=void 0;g==b.length?(Q(e.logger,"success "+s),V(a,f)):(n=d+10,n<b.length&&c(n,k))},function(b,c){V(a,c,!0);return!1})}var d=a.g,e=this,f=[],g=0;if(0<b.length)for(var k=0;10>k&&k<b.length;k++)c(k,d);else Q(this.logger,"success"),
V(a,[])};
h.ud=function(a,b){function c(d,g){function k(a){a="ydn.db.me:"+l.getName()+":"+a.getName();a="DELETE FROM  "+Ia(a);Q(e.logger,"SQL: "+a);g.executeSql(a,[])}var l=Z(e.g,b[d]),m="DELETE FROM  "+Ll(l);Q(e.logger,"SQL: "+m+" PARAMS: []");g.executeSql(m,[],function(g){d==b.length-1?(Q(e.logger,"success "+m),V(a,b.length)):c(d+1,g)},function(b,c){V(a,c,!0);return!1});for(var n=0,p=l.indexes.length;n<p;n++){var q=l.index(n);q.multiEntry&&k(q)}}var d=a.g,e=this;0<b.length?c(0,d):(Q(this.logger,"success"),
V(a,0))};
h.Zd=function(a,b){function c(k){if(k>=b.length)V(a,f,g);else{var l=Z(e.g,b[k].F()),m=xj(b[k].D(),l.type),n=" WHERE "+l.j+" = ?",p="DELETE FROM "+Ll(l)+n,q=X(a)+" SQL: "+p+" PARAMS: "+[m];d.executeSql(p,[m],function(){f++;c(k)},function(a,b){O(e.logger,"error: "+q+b.message);g=!0;c(k);return!1});k++;for(var p=function(b){b="ydn.db.me:"+l.getName()+":"+b.getName();b="DELETE FROM  "+Ia(b)+n;Q(e.logger,X(a)+NaN+b);d.executeSql(b,[m])},s=0,v=l.indexes.length;s<v;s++){var z=l.index(s);z.multiEntry&&p(z)}}}
var d=a.g,e=this,f=0,g=!1;Q(this.logger,X(a)+" removeByKeys: "+b.length+" keys");c(0)};
h.Yd=function(a,b,c){function d(b){b="ydn.db.me:"+f.getName()+":"+b.getName();b="DELETE FROM  "+Ia(b)+l;Q(k.logger,X(a)+NaN+b);e.executeSql(b,[g])}var e=a.g,f=Z(this.g,b),g=xj(c,f.type),k=this,l=" WHERE "+f.j+" = ?";b="DELETE FROM "+Ll(f)+l;Q(this.logger,X(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){V(a,c.rowsAffected)},function(b,c){V(a,c,!0);return!1});b=0;for(c=f.indexes.length;b<c;b++){var m=f.index(b);m.multiEntry&&d(m)}};h.ve=function(a,b,c){ln(this,a,b,void 0,c)};
h.cd=function(a,b,c){ln(this,a,b,void 0,c)};h.pf=function(a,b,c,d){ln(this,a,b,c,d)};
function ln(a,b,c,d,e){function f(c){c="ydn.db.me:"+k.getName()+":"+c.getName();c="DELETE FROM  "+Ia(c)+n;Q(a.logger,X(b)+NaN+c);g.executeSql(c,m)}var g=b.g,k=Z(a.g,c);c="DELETE FROM "+Ll(k);var l=[],m=[],n="";null!=e&&(t(d)?(d=Sj(k,d),vj(d.i,d.type,e,m,l)):vj(k.j,k.type,e,m,l),n=" WHERE "+m.join(" AND "));c+=n;var p=X(b)+" SQL: "+c+" PARAMS: "+l;Q(a.logger,p);g.executeSql(c,l,function(c,d){Q(a.logger,"success "+p);V(b,d.rowsAffected)},function(c,d){O(a.logger,"error: "+p+d.message);V(b,d,!0);return!1});
e=0;for(d=k.indexes.length;e<d;e++)c=k.index(e),c.multiEntry&&f(c)}h.xd=function(a,b){function c(g){var k="SELECT COUNT(*) FROM "+Ia(b[g]);Q(e.logger,"SQL: "+k+" PARAMS: []");d.executeSql(k,[],function(d,e){var k=e.rows.item(0);f[g]=parseInt(k["COUNT(*)"],10);g++;g==b.length?V(a,f):c(g)},function(b,c){V(a,c,!0);return!1})}var d=a.g,e=this,f=[];0==b.length?(Q(this.logger,"success"),V(a,0)):c(0)};
h.Kc=function(a,b,c,d,e){var f=[];b=Jl(Z(this.g,b),f,6,d,c,!1,e);Q(this.logger,X(a)+" SQL: "+b+" PARAMS: "+f);a.g.executeSql(b,f,function(b,c){var d=c.rows.item(0);V(a,$l(d))},function(b,c){V(a,c,!0);return!1})};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=this,p=[],q=Z(this.g,c),s=q.l,v=q.type,z=v,C=null!=d&&d!==s?Sj(q,d):null,G=d||s;C&&(z=C.type);c=[];if(m&&t(m[0])){var J=m[0];C&&t(m[1])?(d=m[1],e=Nl(q,b,c,C.getName(),e,J,!0,d,k,l)):e=Ml(q,b,c,d,e,k,l,J,!0)}else e=Jl(q,c,b,G,e,k,l);y(f)&&(e+=" LIMIT "+f);y(g)&&(e+=" OFFSET "+g);var N=a+" SQL: "+e+" ;params= "+S(c);Q(this.logger,N);a.g.executeSql(e,c,function(c,d){for(var e=d.rows.length,f,g=0;g<e;g++)f=d.rows.item(g),2==b?p[g]=Dl(f[s],v):1==b?p[g]=Dl(f[G],
z):3==b?p[g]=[Dl(f[G],z),Dl(f[s],v)]:null!=f&&(p[g]=hn(f,q));P(n.logger,"success "+a);m&&f&&(m[0]=Dl(f[G],z),m[1]=Dl(f[s],v));V(a,p)},function(b,c){O(n.logger,"error: "+N+c.message);V(a,c,!0);return!1})};function mn(a,b){this.g=b}E(mn,kn);mn.prototype.logger=R("ydn.db.core.req.WebSql");mn.prototype.h=function(a,b,c,d){c=Z(this.g,c);return new fn(a,b,c,d)};pm.prototype.I=function(){var a=Ck(this);if("indexeddb"==a)return new tm(0,this.h);if("websql"==a)return new mn(0,this.h);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new en(0,this.h);throw new Tc("No executor for "+a);};function nn(a){return x(a)?a.replace(/\D/g,"").replace(/^0+/,""):null}function on(a){if(!x(a)||!/[\w\+]+@\w+\.\w+/.test(a))return null;a=a.toLowerCase();return a=a.replace(/\+\w*?@/,"@")};function pn(a){if(!x(a))throw new Fh;this.Za=a;this.j=Nj;this.g=[];qn(this,a);this.jd=""}h=pn.prototype;h.Za="";h.ig=NaN;h.kg=NaN;h.vf=!1;h.jd="";
function qn(a,b){var c=b.split(/\sFROM\s/i);if(2==c.length){var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==c.length){a.l=c[1].toUpperCase();if("SELECT"==a.l)a.j=Mj;else if("INSERT"==a.l)a.j=Nj;else if("UPDATE"==a.l)a.j=Nj;else if("DELETE"==a.l)a.j=Nj;else return;var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.i=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.i=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-
1):new tk("missing closing parentheses"));a.I=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.h=d.substring(c),d=d.substring(0,c)):a.h="";c=d.search(/WHERE/i);0<c?(a.n=d.substring(c+6).trim(),d=d.substring(0,c)):a.n="";a.g=d.trim().split(",").map(function(a){a=Fa(a,'"');a=Fa(a,"'");return a.trim()})}}}
h.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.Za=this.Za.replace("?",a[b]);qn(this,this.Za)}this.o=rn(this);if(!this.o)return this.jd;a=this.h.length;if(b=/OFFSET\s+(\d+)/i.exec(this.h))this.kg=parseInt(b[1],10),a=this.h.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.h))this.ig=parseInt(b[1],10),b=this.h.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.h.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.vf="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.vf=!1,this.s=Fa(Fa(a,'"'),"'")):this.s=void 0;return""};function sn(a){if("*"==a.I)return null;a=a.I.split(",");return a=a.map(function(a){return Fa(a.trim(),'"')})}h.toJSON=function(){return{sql:this.Za}};
function rn(a){function b(a){return Ua(c,function(b){return b.ac==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.n.length)for(var e=a.n.split("AND"),f=0;f<e.length;f++){var g=e[f],k=d.exec(g);if(k){var l=k[1].trim(),l=Fa(l,'"'),l=Fa(l,"'");if(0<l.length){var m=k[3].trim();ra(m,'"')?m=Fa(m,'"'):ra(m,"'")?m=Fa(m,"'"):m=parseFloat(m);k=new Jj(l,k[2],m);l=b(l);if(0<=l){if(c[l]=c[l].ue(k),!c[l])return a.jd='where clause "'+g+'" conflict',null}else c.push(k)}else return a.jd='Invalid clause "'+g+'"',null}else return a.jd=
'Invalid clause "'+g+'"',null}return c}h.toString=function(){return"query:"+this.Za};function tn(a,b){this.g=b;this.h=a}tn.prototype.logger=R("ydn.db.sql.req.nosql.Node");tn.prototype.toJSON=function(){return{sql:this.g}};tn.prototype.toString=function(){return"idb.Node:"};
tn.prototype.execute=function(a,b){var c=$a(this.g.g)[0],d=this.g.o,e=this.g.ig,e=isNaN(e)?100:e,f=this.g.kg,f=isNaN(f)?0:f,g=this.g.s,k=sn(this.g),l=null,m=this.g.vf;if(0==d.length)l=null;else if(1==d.length)l=pj(d[0].g);else throw new Qc("too many conditions.");null===k||ik(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=k.length;if(1==b)return yj(a,k[0]);for(var c={},d=0;d<b;d++)c[k[d]]=yj(a,k[d]);return c}));c(d,b)});var d=0<d.length?d[0].ac:void 0,n=X(a)+" executing on"+c;d&&(n+=":"+
d);n+=" "+uj(l);P(this.logger,n);g&&g!=this.h.keyPath?b.list(a,4,c,g,l,e,f,m,!1):t(d)&&d!=this.h.keyPath?b.list(a,4,c,d,l,e,f,m,!1):b.list(a,4,c,null,l,e,f,m,!1)};function un(a,b){tn.call(this,a,b)}E(un,tn);
un.prototype.execute=function(a,b){var c,d=$a(this.g.g)[0],e=this.g.o,f=null;if(0==e.length)f=null;else if(1==e.length)f=pj(e[0].g);else throw new Qc("too many conditions.");var g=this.g.i,e=0<e.length?e[0].ac:void 0,k=X(a)+" executing "+g+" on "+d;e&&(k+=":"+e);k+=" "+uj(f);P(this.logger,k);if("COUNT"==g)f?b.Kc(a,d,f,e,!1):b.Kc(a,d,null,void 0,!1);else{var l,k=sn(this.g);if(!k||0==k.length)throw new Lh("field name require for reduce operation: "+g);k=k[0];if("MIN"==g)l=vn(k);else if("MAX"==g)l=wn(k);
else if("AVG"==g)c=0,l=xn(k);else if("SUM"==g)c=0,l=yn(k);else throw new Gh(g);var m;t(e)?m=new bk(d,e,f):m=new ak(d,f);var d=b.h(a.g,X(a),d,4),n=m.load([d]);n.V=function(b){V(a,b,!0)};var p=0;n.P=function(b){null!=b?(b=m.g?n.ga():n.T(),c=l(b,c,p),n.advance(1),p++):V(a,c)}}};function xn(a){return function(b,c,d){t(c)||(c=0);return(c*d+b[a])/(d+1)}}function yn(a){return function(b,c){return c+b[a]}}function vn(a){return function(b,c){var d=b[a];return t(c)?c<d?c:d:d}}
function wn(a){return function(b,c){var d=b[a];return t(c)?c>d?c:d:d}};function zn(a,b){this.g=b}E(zn,tm);zn.prototype.logger=R("ydn.db.sql.req.IndexedDb");zn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new tk(c);c=$a(b.g);if(1==c.length){var d=Z(this.g,c[0]);if(!d)throw new qk(c[0]);var e=sn(b);if(e)for(var f=0;f<e.length;f++)if(!Zk(d,e[f]))throw new qk('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new un(d,b):g=new tn(d,b);g.execute(a,this)}else throw new Gh(b.Za);};function An(a,b){this.h=b;this.i=a;this.g=sn(b)}An.prototype.logger=R("ydn.db.sql.req.websql.Node");An.prototype.toJSON=function(){return{sql:this.h.Za}};An.prototype.toString=function(){return"websql.Node:"};function Bn(a,b){if(a.g){if(1==a.g.length){if(A(b))return oc(b,a.g[0]);return}for(var c={},d=0;d<a.g.length;d++)c[a.g[d]]=oc(b,a.g[d]);return c}return hn(b,a.i)}
An.prototype.execute=function(a,b,c){var d=this,e=[];b.executeSql(this.h.Za,c,function(b,c){for(var k=c.rows.length,l=0;l<k;l++){var m=c.rows.item(l);if(A(m))var n=Bn(d,m);e.push(n)}a(e)},function(b,c){O(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function Cn(a,b){An.call(this,a,b)}E(Cn,An);Cn.prototype.execute=function(a,b,c){var d=this;b.executeSql(this.h.Za,c,function(b,c){var d=c.rows.length;if(1==d)d=$l(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new ok;},function(b,c){O(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function Dn(a,b){this.g=b}E(Dn,mn);Dn.prototype.logger=R("ydn.db.sql.req.WebSql");Dn.prototype.executeSql=function(a,b,c){var d=$a(b.g);if(1==d.length){var e=Z(this.g,d[0]);if(!e)throw new qk(d[0]);var f=sn(b);if(f)for(var g=0;g<f.length;g++)if(!Zk(e,f[g]))throw new qk('Index "'+f[g]+'" not found in '+d[0]);var k;b.i?k=new Cn(e,b):k=new An(e,b);k.execute(function(b,c){V(a,b,c)},a.g,c)}else throw new Gh(b.Za);};function En(a,b){this.g=b}E(En,en);En.prototype.logger=R("ydn.db.sql.req.SimpleStore");En.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new tk(c);c=$a(b.g);if(1==c.length){var d=Z(this.g,c[0]);if(!d)throw new qk(c[0]);var e=sn(b);if(e)for(var f=0;f<e.length;f++)if(!Zk(d,e[f]))throw new M('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new un(d,b):g=new tn(d,b);g.execute(a,this)}else throw new Qc(b.Za);};function Fn(a,b,c,d){Nk.call(this,a,b,c,d)}E(Fn,sl);Fn.prototype.executeSql=function(a,b){for(var c=new pn(a),d=$a(c.g),e=0;e<d.length;e++){var f=Z(this.h,d[e]);if(!f)throw new M("store: "+f+" not exists.");}P(this.logger,"executeSql: "+a+" params: "+b);var g=this.g.request("sql",$a(c.g),c.j);W(g,function(){Y(this).executeSql(g,c,b||[])},this);return g};function Gn(a,b,c){om.call(this,a,b,c)}E(Gn,pm);Gn.prototype.Zc=function(a,b){return new Fn(this,this.h,a,b)};Gn.prototype.executeSql=function(a,b){return this.g.executeSql(a,b)};Gn.prototype.I=function(){var a=Ck(this);if("indexeddb"==a)return new zn(0,this.h);if("websql"==a)return new Dn(0,this.h);if("memory"==a||"localstorage"==a||"sessionstorage"==a)return new En(0,this.h);throw new Tc("No executor for "+a);};function Hn(a,b){t(a)&&5242880<a&&O(this.logger,"storage size request ignored, use Quota Management API instead");this.ia=null;this.ed=b||NaN}h=Hn.prototype;
h.connect=function(a,b){function c(a,c,d){P(e.logger,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)In(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Wk(b,c[d])||(a.deleteObjectStore(c[d]),P(e.logger,"store: "+c[d]+" deleted."))}function d(a,b){f.rb?O(e.logger,"database already set."):t(b)?(O(e.logger,b?b.message:"Error received."),e.ia=null,f.w(b)):(e.ia=a,e.ia.onabort=function(a){Q(e.logger,e+": abort");e.kd(a.target.error)},
e.ia.onerror=function(a){Q(e.logger,e+": error");e.kd(a.target.error)},e.ia.onversionchange=function(a){Q(e.logger,e+" closing connection for onversionchange to: "+a.version);if(e.ia&&(e.ia.onabort=null,e.ia.onblocked=null,e.ia.onerror=null,e.ia.onversionchange=null,e.Ud(a),!a.defaultPrevented)){e.ia.close();e.ia=null;var b=Error();b.name=a.type;e.ke(b)}},f.u(parseFloat(g)))}var e=this,f=new F,g=void 0,k=b.version;P(e.logger,"Opening database: "+a+" ver: "+(b.h?"auto":k));var l;l=t(k)?Pj.open(a,k):
Pj.open(a);l.onsuccess=function(f){var k=f.target.result;t(g)||(g=k.version);P(e.logger,"Database: "+k.name+", ver: "+k.version+" opened.");if(b.h)e.ib(function(f){if(b instanceof Sk)for(var g=0;g<f.stores.length;g++)Wk(b,f.stores[g].getName())||Tk(b,f.stores[g].ea());f=Xl(b,f,!1,!0);if(0<f.length){P(e.logger,"Schema change require for difference in "+f);var l=y(k.version)?k.version+1:1;if("IDBOpenDBRequest"in r){k.close();var m=Pj.open(a,l);m.onupgradeneeded=function(a){a=a.target.result;P(e.logger,
"re-open for version "+a.version);c(a,m.transaction,!1)};m.onsuccess=function(a){d(a.target.result)};m.onerror=function(){P(e.logger,e+": fail.");d(null)}}else{var p=k.setVersion(l+"");p.g=function(a){O(e.logger,"migrating from "+k.version+" to "+l+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=G;c(k,p.transaction,!0)};var G=function(){var b=Pj.open(a);b.onsuccess=function(a){a=a.target.result;P(e.logger,e+": OK.");d(a)};b.onerror=function(){P(e.logger,e+": fail.");d(null)}};
null!=p.transaction&&(p.transaction.oncomplete=G)}}else d(k)},void 0,k);else if(b.version>k.version){var l=k.setVersion(b.version);l.g=function(a){O(e.logger,"migrating from "+k.version+" to "+b.version+" failed.");d(null,a)};l.onsuccess=function(){c(k,l.transaction,!0)}}else b.version==k.version?P(e.logger,"database version "+k.version+" ready to go"):O(e.logger,"connected database version "+k.version+" is higher than requested version."),e.ib(function(a){a=Xl(b,a,!1,!0);0<a.length?(P(e.logger,a),
d(null,new Jh("different schema: "+a))):d(k)},void 0,k)};l.onupgradeneeded=function(a){a=a.target.result;g=NaN;P(e.logger,"upgrade needed for version "+a.version);c(a,l.transaction,!1)};l.onerror=function(c){e.logger.log(Te,'open request to database "'+a+'" '+(t(b.version)?" with version "+b.version:"")+" cause error of "+l.error.name,void 0);d(null,c)};l.onblocked=function(c){e.logger.log(Te,"database "+a+" "+b.version+" block, close other connections.",void 0);d(null,c)};y(this.ed)&&!isNaN(this.ed)&&
setTimeout(function(){"done"!=l.readyState&&(e.logger.log(Te,e+": database state is still "+l.readyState,void 0),d(null,new uk("connection timeout after "+e.ed)))},this.ed);return f};h.ed=18E4;h.ke=function(){};h.kd=function(){};h.Ud=function(){};h.Gc=function(){return"indexeddb"};h.je=function(){return!!this.ia};h.logger=R("ydn.db.con.IndexedDb");h.ia=null;h.ie=function(){return this.ia?parseFloat(this.ia.version):void 0};
h.ib=function(a,b,c){c=c||this.ia;if(t(b)){if(null===b){if(0==c.objectStoreNames.length){a(new Wl(c.version));return}throw new Ih;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new Wl(c.version));return}b=c.transaction(b,Mj)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var k=b.objectStore(e[d]),l=[],m=0,n=k.indexNames.length;m<n;m++){var p=k.index(k.indexNames[m]);l[m]=new yl(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new Pk(k.name,k.keyPath,k.autoIncrement,void 0,l)}b=new Wl(c.version,f);a(b)};
function In(a,b,c,d){function e(){var a={autoIncrement:!!d.h};null!=d.keyPath&&(a.keyPath=d.keyPath);return b.createObjectStore(d.getName(),a)}Q(a.logger,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName()))if(c=c.objectStore(d.getName()),Fl(d.keyPath||"",c.keyPath||""))b.deleteObjectStore(d.getName()),O(a.logger,"store: "+d.getName()+" deleted due to keyPath change."),c=e();else if(fa(c.autoIncrement)&&fa(d.h)&&c.autoIncrement!=d.h)b.deleteObjectStore(d.getName()),
O(a.logger,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e();else{for(var f=c.indexNames,g=0,k=0,l=0,m=0;m<d.indexes.length;m++){var n=d.index(m),p=!1;if(f.contains(n.getName())){var q=c.index(n.getName()),s=null!=q.unique&&null!=n.unique&&q.unique!=n.unique,v=null!=q.multiEntry&&null!=n.multiEntry&&q.multiEntry!=n.multiEntry,q=null!=q.keyPath&&null!=n.keyPath&&!!Fl(q.keyPath,n.keyPath);if(s||v||q)c.deleteIndex(n.getName()),p=!0,g--,l++}else"BLOB"!=n.type&&(p=!0);p&&(n.unique||
n.multiEntry?(p={unique:n.unique,multiEntry:n.multiEntry},c.createIndex(n.getName(),n.keyPath,p)):c.createIndex(n.getName(),n.keyPath),g++)}for(m=0;m<f.length;m++)Zk(d,f[m])||(c.deleteIndex(f[m]),k++);Q(a.logger,"Updated store: "+c.name+", "+g+" index created, "+k+" index deleted, "+l+" modified.")}else{c=e();for(m=0;m<d.indexes.length;m++)n=d.index(m),"BLOB"==n.type?a.logger.info("Index "+n+" of blob data type ignored."):(Q(a.logger,"Creating index: "+n),n.unique||n.multiEntry?(p={unique:n.unique,
multiEntry:n.multiEntry},c.createIndex(n.getName(),n.keyPath,p)):c.createIndex(n.getName(),n.keyPath));Q(a.logger,"Created store: "+c)}}h.zd=function(a,b,c,d){var e=this.ia;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};h.he=function(){Q(this.logger,this+" closing connection");this.ia.close()};
h.toString=function(){return"IndexedDB:"+(this.ia?this.ia.name+":"+this.ia.version:"")};kk.push(function(a,b){if(!Pj||b&&"indexeddb"!=b)return null;var c=Pj.deleteDatabase(a),d=new ek("IDBVersionChangeEvent ");c.onblocked=function(a){Vc(d,a)};c.onerror=function(a){d.w(a)};c.onsuccess=function(a){d.u(a)};return d});function Jn(a){an.call(this,a);this.h=NaN}E(Jn,an);h=Jn.prototype;h.logger=R("ydn.db.con.SimpleStorage");h.ie=function(){return this.h};
h.connect=function(a,b){function c(a,b){setTimeout(function(){b?(P(d.logger,d+" opening fail"),e.w(b)):(P(d.logger,d+" version "+d.ie()+" open"),e.u(a))},10)}var d=this,e=new F;this.j=this.n.xe(a);this.i=a;this.g=b;var f=Fm(this.i);this.h=NaN;var g=zh(this.j.getItem(f));t(g.version)&&!y(g.version)&&(g.version=NaN);if(g)if(g=new Wl(g),Xl(this.g,g,!1,!1))if(!this.g.h&&!isNaN(g.version)&&this.g.version>g.version)c(NaN,new nk("existing version "+g.version+" is larger than "+this.g.version));else{var k=
this.g.version;this.h=t(k)?k:g.version+1;for(k=0;k<this.g.count();k++)var l=this.g.stores[k]||null;if(this.g instanceof Sk)for(k=0;k<g.count();k++)l=g.stores[k]||null,Tk(this.g,l);k=this.g.toJSON();k.version=this.h||NaN;this.j.setItem(f,S(k));c(g.version||NaN)}else{for(k=0;k<this.g.count();k++)l=this.g.stores[k]||null;this.h=g.version||NaN;c(this.h)}else g=b.toJSON(),this.h=1,g.version=this.h,this.j.setItem(f,S(g)),c(NaN);return e};h.je=function(){return!!this.i};h.ke=function(){};h.kd=function(){};
h.Ud=function(){};h.Gc=function(){return"memory"};h.he=function(){};h.zd=function(a,b,c,d){a(new bn(this,function(a,b){d(a,b)}))};h.toString=function(){return"SimpleStorage:"+this.Gc()+":"+(this.i+":"+this.h)};function Kn(){Jn.call(this,this)}E(Kn,Jn);Kn.prototype.xe=function(){return window.localStorage};Kn.prototype.Gc=function(){return"localstorage"};kk.push(function(a,b){if(!b||"localstorage"==b){var c=new Kn,d=new Sk;c.connect(a,d);c.ib(function(a){for(var b=0;b<a.stores.length;b++)Dm(c,a.stores[b].getName()).clear()})}});function Ln(){Jn.call(this,this)}E(Ln,Jn);Ln.prototype.xe=function(){return window.sessionStorage};Ln.prototype.Gc=function(){return"sessionstorage"};
kk.push(function(a,b){if(!b||"sessionstorage"==b){var c=new Ln,d=new Sk;c.connect(a,d);c.ib(function(a){for(var b=0;b<a.stores.length;b++)Dm(c,a.stores[b].getName()).clear()})}});function Mn(a){this.g=t(a)?a:4194304}h=Mn.prototype;
h.connect=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,g=c.h?isNaN(f)?1:f+1:c.version;df(e.logger,a+": changing version from "+b.version+" to "+g);var k=!1,l=0;b.changeVersion(b.version,g+"",function(a){e.ib(function(b){k=!0;for(var d=0;d<c.count();d++){var f=Z(b,(c.stores[d]||null).getName()),f=f?Ol(f,c.stores[d]||null):null;Nn(e,a,c.stores[d]||null,function(a){a&&l++},f)}for(d=0;d<b.count();d++)f=b.stores[d]||null,Wk(c,f.getName())||(c instanceof Sk?Tk(c,f):(f="DROP TABLE "+
Ll(f),P(e.logger,f),a.executeSql(f,[],function(){},function(a,b){throw b;})))},a,b)},function(c){e.logger.log(Te,"SQLError "+c+" "+c.code+"("+c.message+") while changing version from "+b.version+" to "+g+" on "+a,void 0);throw c;},function(){if(k){var f=".";l!=c.stores.length&&(f=" but unexpected stores exists.");Q(e.logger,a+":"+b.version+" ready"+f);d(b)}else O(e.logger,a+": changing version voided.")})}function d(a,b){t(b)?(e.Fa=null,g.w(b)):(e.Fa=a,g.u(parseFloat(f)))}var e=this,f=NaN,g=new F,
k=null;try{k=r.openDatabase(a,"",a,this.g)}catch(l){if("SECURITY_ERR"==l.name)O(this.logger,"SECURITY_ERR for opening "+a),k=null,this.wf=new sk(l);else throw l;}if(k){var f=k.version,m="database "+a+(0==k.version.length?"":" version "+k.version);null!=b.version&&b.version==k.version?(df(e.logger,"Existing "+m+" opened as requested."),d(k)):this.ib(function(a){(a=Xl(b,a,!0,!1))?(0==k.version.length?df(e.logger,"New "+m+" created."):b.h?df(e.logger,"Existing "+m+" opened and schema change for "+a):
df(e.logger,"Existing "+m+" opened and  schema change to version "+b.version+" for "+a),c(k,b)):(df(e.logger,"Existing "+m+" with same schema opened."),d(k))},null,k)}else d(null,this.wf);return g};h.Gc=function(){return"websql"};h.wf=null;h.Fa=null;h.logger=R("ydn.db.con.WebSql");h.ke=function(){};h.kd=function(){};
function On(a){var b=a.H,c="CREATE TABLE IF NOT EXISTS "+Ll(a)+" (",d=a.j,c=c+(d+" "+b+" PRIMARY KEY ");a.h&&(c+=" AUTOINCREMENT ");if(!a.oc||!a.keyPath&&0==a.indexes.length)c+=" ,_default_ BLOB";for(var e=[],f=[d],g=0,k=a.indexes.length;g<k;g++){var l=a.index(g),m="";if(l.multiEntry){var m="ydn.db.me:"+a.getName()+":"+l.getName(),n=l.unique?" UNIQUE ":"",l="CREATE TABLE IF NOT EXISTS "+Ia(m)+" ("+d+" "+b+", "+l.i+" "+l.o+n+")";e.push(l)}else l.unique&&(m=" UNIQUE "),n=l.keyPath,"BLOB"!=l.type&&x(n)&&
(n="CREATE "+m+" INDEX IF NOT EXISTS "+Ia(a.getName()+"-"+l.getName())+" ON "+Ll(a)+" ("+l.i+")",e.push(n)),n=l.i,-1==f.indexOf(n)&&(c+=", "+n+" "+l.o+m,f.push(n))}e.unshift(c+")");return e}h.ie=function(){return this.Fa?parseFloat(this.Fa.version):void 0};
h.ib=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var q=qc(e,"sql");Q(f.logger,"Parsing table schema from SQL: "+q);for(var s=q.substr(q.indexOf("("),q.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),v=void 0,z,q=[],C=!1,G=!1,J=0;J<s.length;J++){var N=s[J].match(/\w+|"[^"]+"/g),ha=Qa(N,function(a){return a.toUpperCase()}),I=Fa(N[0],'"'),
N=zl(ha[1]);if(-1!=ha.indexOf("PRIMARY")&&-1!=ha.indexOf("KEY")){z=N;if(x(I)&&!ta(I)&&"_ROWID_"!=I){var lc=I.split(","),v=I;1<lc.length&&(v=lc,z=void 0)}-1!=ha.indexOf("AUTOINCREMENT")&&(C=!0)}else if("_ROWID_"!=I)if("_default_"==I)G=!0;else{var ri="UNIQUE"==ha[2];ra(I,e.tbl_name+"-")&&(I=I.substr(e.tbl_name.length+1));ha=new yl(I,N,ri);q.push(ha)}}if(ra(e.name,"ydn.db.me:")){var Yc=e.name.split(":");if(3<=Yc.length){var Jd=Yc[1],v=new yl(Yc[2],N,ri,!0),s=Ua(q,function(a){return a.getName()==Yc[2]});
0<=s?q[s]=v:q.push(v);s=Ua(k,function(a){return a.getName()===Jd});0<=s?(J=k[s],k[s]=new Pk(J.getName(),J.keyPath,C,z,q,void 0,!G)):k.push(new Pk(Jd,void 0,!1,void 0,[v]));Q(f.logger,'multi entry index "'+v.getName()+'" found in '+Jd+(-1==s?"*":""))}else O(f.logger,'Invalid multiEntry store name "'+e.name+'"')}else J=Ua(k,function(a){return a.getName()===e.name}),0<=J?(s=k[J].index(0),q.push(s),k[J]=new Pk(e.name,v,C,z,q,void 0,!G)):(q=new Pk(e.name,v,C,z,q,void 0,!G),k.push(q))}}d=new Wl(g,k);a(d)}}
var f=this,g=(c=c||this.Fa)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,k=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.ib(a,b,c)},function(a){f.logger.log(Te,"opening tx: "+a.message,void 0);throw a;},e)};
function Nn(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==k.length&&(d(!0),d=null)},function(b,e){g++;g==k.length&&(d(!1),d=null);var f="SQLError creating table: "+c.getName()+" "+e.message+' for executing "'+a;throw new rk(e,f);})}var g=0,k=On(c),l="Create";if(e){e=Rk(c,e);if(0==e.length){Q(a.logger,"same table "+c.getName()+" exists.");d(!0);d=null;return}l="Modify";O(a.logger,"table: "+c.getName()+" has changed by "+e+" ALTER TABLE cannot run in WebSql, dropping old table.");k.unshift("DROP TABLE IF EXISTS "+
Ia(c.getName()))}Q(a.logger,l+" table: "+c.getName()+": "+k.join(";"));for(a=0;a<k.length;a++)f(k[a])}h.je=function(){return!!this.Fa};h.he=function(){this.Fa=null};
h.zd=function(a,b,c,d){function e(a){Q(k.logger,k+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var k=this;null===this.Fa&&(a(null),d("abort",this.wf));c==Mj?this.Fa.readTransaction(g,e,f):c==Oj?this.Fa.changeVersion(this.Fa.version,this.Fa.version+1+"",g,e,f):this.Fa.transaction(g,e,f)};
kk.push(function(a,b){if(!b||"websql"==b){var c=new Mn,d=new Sk;P(c.logger,"deleting websql database: "+a);var d=c.connect(a,d),e=function(){c.logger.info("all tables in "+a+" deleted.")};d.B(function(){c.zd(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var l=e.rows.length,m=0,n=0;n<l;n++){var p=e.rows.item(n);"__WebKitDatabaseInfoTable__"!=p.name&&"sqlite_sequence"!=p.name&&(m++,Q(c.logger,"deleting table: "+p.name),b.executeSql("DROP TABLE "+
p.name))}P(c.logger,m+' tables deleted from "'+a+'"')}},function(a,b){throw b;})},[],Nj,e)});d.Ic(function(){O(c.logger,"Connecting "+a+" failed.")})}});Mn.prototype.Ud=function(){};Mn.prototype.toString=function(){return"WebSql:"+(this.Fa?":"+this.Fa.version:"")};mm.prototype.ye=function(a){return"indexeddb"==a&&Pj?new Hn(this.H,this.P):"websql"==a&&ga(r.openDatabase)?new Mn(this.H):"localstorage"==a&&window.localStorage?new Kn:"sessionstorage"==a&&window.sessionStorage?new Ln:"memory"==a?new Jn:null};function Pn(a,b){vb.call(this);this.j=b;this.g=[];if(a>this.j)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.g.push(this.h())}E(Pn,vb);Pn.prototype.Xd=function(a){this.g.length<this.j?this.g.push(a):this.i(a)};Pn.prototype.h=function(){return{}};Pn.prototype.i=function(a){if(A(a))if(ga(a.qa))a.qa();else for(var b in a)delete a[b]};Pn.prototype.G=function(){Pn.m.G.call(this);for(var a=this.g;a.length;)this.i(a.pop());delete this.g};function Qn(){this.g=[];this.i=new pd;this.j=new pd;this.n=1;this.l=new Pn(0,4E3);this.l.h=function(){return new Rn};this.o=new Pn(0,50);this.o.h=function(){return new Sn};var a=this;this.h=new Pn(0,2E3);this.h.h=function(){return String(a.n++)};this.h.i=function(){}}R("goog.debug.Trace");function Sn(){this.time=this.count=0}Sn.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function Rn(){}
function Tn(a,b,c){var d=[];-1==b?d.push("    "):d.push(Un(a.h-b));d.push(" ",Vn(a.h-0));0==a.g?d.push(" Start        "):1==a.g?(d.push(" Done "),d.push(Un(a.l-a.startTime)," ms ")):d.push(" Comment      ");d.push(c,a);0<a.j&&d.push("[VarAlloc ",a.j,"] ");return d.join("")}Rn.prototype.toString=function(){return null==this.type?this.i:"["+this.type+"] "+this.i};
Qn.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.g.length;d++){var e=this.g[d];1==e.g&&c.pop();a.push(" ",Tn(e,b,c.join("")));b=e.h;a.push("\n");0==e.g&&c.push("|  ")}if(0!=this.i.fa()){var f=D();a.push(" Unstopped timers:\n");nd(this.i,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Vn(b.startTime),")\n")})}b=this.j.La();for(d=0;d<b.length;d++)c=this.j.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",0,"\n","Total comments created ",
0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function Un(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Vn(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new Qn;/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Wn(a){a.o||(a.o=new L);return a.o}mm.prototype.removeEventListener=function(a,b,c,d){Kc(Wn(this),a,b,c,d)};mm.prototype.Ra=function(a){Wn(this).dispatchEvent(a)};function Xn(a,b,c){om.call(this,a,b,c)}E(Xn,Gn);R("ydn.gdata.base");function Yn(a){this.i=a||null;this.g=this.h=null;a&&Zn(this,a)}Yn.prototype.logger=R("ydn.crm.UserSetting");
var $n={stores:[{name:"general"},{name:"sugar"}]},ao={stores:[{name:"contact",keyPath:"id.$t",type:"TEXT",indexes:[{name:"updated.$t",type:"TEXT"},{name:"ydn$emails",multiEntry:!0,generator:function(a){var b=[];a=u(a.gd$email)?a.gd$email:A(a.gd$email)?[a.gd$email]:[];for(var c=0;c<a.length;c++){var d=on(a[c].address);d&&b.push(d)}return b}},{name:"ydn$externalIds",multiEntry:!0,generator:function(a){return(u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:
[]).map(function(a){return a.value})}}]}]};function Zn(a,b){if(!a.i||a.i!=b){r.sessionStorage.setItem("last-user-id",b);var c=b+"-setting",d=b+"-gdata";a.h&&a.h.getName()!=c&&(gm(a.h),a.h=null);a.g&&a.g.getName()!=d&&(gm(a.g),a.g=null);a.h||(a.h=new Xn(c,$n));a.g||(a.g=new Xn(d,ao))}}function bo(a){return a.i?a.i+"-sd":r.sessionStorage.getItem("last-user-id")+"-sd"}function co(a){var b=bo(a),c=new F;chrome.storage.local.get(b,function(a){c.u(a[b])});return c}
function eo(a,b){var c=bo(a),d=new F,e={};e[c]=b;chrome.storage.local.set(e,function(){d.u(!0)})};var fo="chrome-extension://fmhdpfhfppingdiiefgnanjceieflpkj/"==chrome.extension.getURL("")?"crm-ex/":"",Yh=fo+"option-page.html",go=fo+"host-permission.html";function ho(){var a=new F;chrome.storage.sync.get("user-setting",function(b){a.u(b["user-setting"])});return a};function jo(){}jo.prototype.logger=R("ydn.crm.Client");function ko(a,b,c){this.client=a;this.g=b;this.h=c}ko.prototype.request=function(a){a=this.g.call(this.h,a);return this.client.request(a)};function lo(a,b,c){this.h=a;this.i=b;this.g=c}lo.prototype.request=function(a){return this.h(a)?this.i.request(a):this.g.request(a)};function mo(a,b){this.client=a;this.h=b;this.$c=NaN;this.i=[];this.g=!1}mo.prototype.request=function(a){return new no(a,this)};function no(a,b){a.path=b.h+a.path;this.req=b.client.request(a);this.parent=b;this.i=null;this.h=void 0}E(no,hj);
no.prototype.execute=function(a,b){if(this.parent.g)this.i=a,this.h=b,this.parent.i.push(this);else{this.parent.g=!0;var c=function(c,d){var g=dj(d,"retry-after");g?(this.parent.$c=/[^0-9|\.]/.test(g)?(new Date(g)).getTime():1E3*parseFloat(g)+D(),r.console.info("Next retry "+this.parent.$c+", now "+D())):this.parent.$c=NaN;a&&a.call(b,c,d);this.parent.g=!1;if(g=this.parent.i.pop())g.execute(g.i,g.h),g.i=null,g.h=null},d=this.parent.$c-D();0<d?(r.console.info("Proxy will call after "+d+" ms"),of(function(){this.parent.$c=
NaN;this.req.execute(c,this)},d,this)):this.req.execute(c,this)}};function oo(a,b,c,d,e){this.l=t(a)?a:$i();this.g=b;this.h=c;this.i=d||0;this.j=!!e}oo.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new hj(a,this.l,this.i,this.j)};function po(a,b,c){this.i=t(a)?a:$i();this.g=b;this.h=c}po.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new hj(a,this.i)};function qo(a){for(var b=dm(a),c=0;c<b.stores.length;c++);this.g=a;this.g.Xa(this.s,this);this.h=1E4;this.j=Ze.value;this.i=0;this.o=B(this.I,this);this.n=!1;this.l={}}function ro(a){if(a.h&&a.i>=a.h){var b=a.h/100;100<b&&(b=100);a.g.keys("db-logger",null,b).B(function(a){a=a.map(function(a){return new vk("db-logger",a)});this.g.remove("db-logger",a).B(function(){this.g.count("db-logger").B(function(a){this.i=a},this)},this)},a)}}
qo.prototype.s=function(){this.h&&this.g.count("db-logger").B(function(a){this.i=a;ro(this)},this)};qo.prototype.I=function(a){if(!this.l[a.h]){var b=a.j;!b||b.value<=this.j||(a={exception:a.g,level:b.value,logger:a.h,name:b.name,time:a.l,message:a.getMessage(),seq:a.n},this.g.put("db-logger",a),this.i++,ro(this))}};function so(a,b){var c=to,d=a||100,e=b||0,f=qj(["INFO"]);return c.g.values("db-logger","name, time",f,d,e,!0)}var to=null;var uo,vo,wo,xo,yo=R("ydn.crm");function zo(){uo||(uo=new bg(0));return uo}var Ao=null;function Bo(a,b){if(!b||"local"==b)if(t(a["logging-captureConsole"])&&oi(!!a["logging-captureConsole"]),t(a["logging-bugReport"])){var c=!!a["logging-bugReport"],d=to;if(c!=d.n){var e=hf();c?bf(e,d.o):(e=e.g)&&Xa(e,d.o);d.n=c}}}
function Co(){r.console.log("ydn.crm version 0.7.0 (dev)");r.console.log("API documentation: http://dev.yathit.com/\nSuggestion: http://yathit.uservoice.com/\nBug report: https://github.com/yathit/sugarcrm-gmail-chrome-extension");Qi("ydn.crm","finer");Qi("ydn.ds","finer");Ao=new Xn("ydn.crm",{stores:[{name:"log",keyPath:"key"},{name:"db-logger",autoIncrement:!0,indexes:[{name:"level"},{name:"time"},{name:"name"},{name:"name, time",keyPath:["name","time"]}]}]});var a=to=new qo(Ao);a.h=1E4;ro(a);to.j=
300;to.l["ydn.db.tr.DbOperator"]=!0;yo.info("Starting ydn.crm.App:0.7.0");chrome.storage.local.get(["logging-captureConsole","logging-bugReport"],Bo);chrome.storage.onChanged.addListener(Bo)}function Do(){vo||(vo=new po(zo()),Zi(vo,"default"));return vo}
function Eo(a){var b=Do();a=new jj(a,uo,!1);Zi(a,"gc");var c=new ko(a,function(a){a.path="https://yathit-app.appspot.com/proxy/"+a.path;return a});Zi(new mo(b,"https://yathit-app.appspot.com/proxy/"),"proxy");Zi(new lo(function(a){return"GET"==a.method},a,c),"gse")}function Fo(){xo||(xo=new oo(zo(),void 0,"https://yathit-app.appspot.com/a/cm",1,!0),Zi(xo,"auth"));return xo};function Go(a,b){this.j=b||D();this.type=a;this.i=this.g=this.h=void 0}function Ho(a,b){A(b)?a.h=Zl(b):a.h=b}Go.prototype.toJSON=function(){return{type:this.type,timestamp:this.j,newValue:this.g,oldValue:this.h,meta:this.i}};function Io(a){this.g=a}Io.prototype.add=function(a){this.g.add("history",a.toJSON())};function Jo(a,b){if(a.link){if(u(a.link)){for(var c=0;c<a.link.length;c++)if(a.link[c].rel==b)return a.link[c];return null}return a.link.rel==b?a.link:null}return null};function Ko(a,b){this.entry=a;this.data=b;this.g=!1}Ko.prototype.data=null;Ko.prototype.preventDefault=function(){this.g=!0};function Lo(a,b,c,d){K.call(this,a,b);this.status=c;this.entry=d}E(Lo,K);Lo.prototype.status=NaN;Lo.prototype.N=function(){return this.status};Lo.prototype.vb=function(){return this.entry.vb()};function Mo(a,b,c){Lo.call(this,"conflict",a,b,c.entry)}E(Mo,Lo);function No(a,b){this.g=a;if(b)throw new Qc("optional key paths");}var Oo={Mh:"key",Jh:"date",Nh:"modified",Lh:"expires",Kh:"etag",Oh:"updated",Ph:"uri",NEXT:"next"};No.prototype.T=function(a,b){return b&&this.g[a]?yj(b,this.g[a]):void 0};function Po(a,b,c,d){a.g[b]&&zj(c,a.g[b],d)};function Qo(a,b,c,d){this.key=a;this.h=(this.h=d?b[d]:b)||{};this.g=c}function Ro(a){return null!=a.key?a.key:a.g.T("key",a.h)}Qo.prototype.getDate=function(){return this.g.T("date",this.h)};function So(a){return a.g.T("updated",a.h)}function To(a){return a.g.T("etag",a.h)}function Uo(a){var b={},c=To(a);c&&1<c.length?b["if-none-match"]=c:(a=So(a))&&(b["if-modified-since"]=a);return b}
Qo.prototype.toJSON=function(){var a={};Po(this.g,"key",a,Ro(this));var b=this.getDate();b&&Po(this.g,"date",a,b);(b=this.g.T("expires",this.h))&&Po(this.g,"expires",a,b);(b=So(this))&&Po(this.g,"updated",a,b);(b=To(this))&&Po(this.g,"etag",a,b);return a};function Vo(a,b,c){b.expires&&Po(c,"expires",b,(new Date(b.expires)).getTime());b["last-updated"]&&Po(c,"updated",b,(new Date(b["last-updated"])).getTime());b.etag&&Po(c,"etag",b,(new Date(b.etag)).getTime());Po(c,"date",b,NaN);Qo.call(this,a,b,c)}E(Vo,Qo);function Wo(a,b,c){this.g=a;this.n=c||null;this.i=this.h=null;this.key=b}h=Wo.prototype;h.logger=R("ydn.db.sync.entry.Rest");h.vb=function(){if(this.i&&this.g.s&&this.j){var a=this.g.I;this.g.V||delete this.i[a]}return this.i||null};h.T=function(){return this.n};h.D=function(){return this.key};h.le=function(){return this.g.cf(this.D())};function Xo(a,b){var c=a.D();return new Vo(c,b.Oc(),a.g.o)}
h.He=function(a,b){if(a)return a;if(b.Aa())return ej(b);try{return ej(b)}catch(c){var d=cj(b);return A(d)?d:{body:d}}};h.save=function(a){var b=this.D();if(a&&!this.g.s)return D(),Yo(this.g,[this.j.toJSON()]);var c=this.i;if(a&&!c)return sb();a=void 0;null!=this.j&&(D(),a=[this.j.toJSON()]);return Zo(this.g,[c],a,[b])};
h.lc=function(a,b){if(this.g.K&&A(this.h))a.call(b,304),a=null;else{var c=this;$o(this,function(d){if(d){var e=d.g.T("expires",d.h);if(e&&e>D()){Q(this.logger,this+" not expired");a.call(b,304);a=null;return}}e=c.le();d=c.ic(e,"GET",d);this.g.ta().request(d).execute(function(d,e){c.j=Xo(c,e);c.i=c.He(d,e);a.call(b,e.N());a=null})},this)}};
h.ic=function(a,b,c,d){a=new ei(a,b);if(c){var e;"POST"==a.method||"PUT"==a.method||"DELETE"==a.method?(e={},(b=So(c))&&(e["if-unmodified-since"]=b),(c=To(c))&&1<c.length&&(e["if-match"]=c),c=e):c=Uo(c);e=c;a.headers?uc(a.headers,e):a.headers=e}a.body=A(d)?JSON.stringify(d):d;Q(this.logger,this+" "+a.method+" "+a.path+" "+Ah(e));return a};
function ap(a,b,c){$o(a,function(a){var e=this.T();a=this.ic(this.le(),"PUT",a,e);this.g.ta().request(a).execute(function(a,d){this.j=Xo(this,d);this.i=a;b&&(b.call(c,d.N()),b=null)},this)},a)}function $o(a,b,c){a.l?b.call(c,a.l):bp(a.g,a.D(),function(d){a.l=d;b.call(c,d)})}
h.load=function(a,b){if(this.h&&this.l)a&&(a.call(b,this.h,this.l),a=void 0);else{var c=this.D();this.g.load(c,function(c,e){this.h=c;var f=this.g.I;this.h&&f&&this.h[f]&&(this.l=new Qo(this.key,this.h,this.g.o,f),this.g.V||delete this.h[f]);this.h=c;this.l=e;a&&(a.call(b,c),a=void 0)},this)}};function cp(a,b){var c=a.le(),d=a.g.ta();$o(a,function(a){a=this.ic(c,"DELETE",a);d.request(a).execute(function(a,d){Q(this.logger,"deleted "+c+" "+d.N());b.call(this,d.N())},this)},a)}
h.toString=function(){return"sync.entry{"+this.g.F()+":"+this.key+"}"};function dp(a,b,c){this.storage=a;this.i=b;this.O=b.getName();a="format readRequestTimeout writeRequestTimeout transport Options fetchStrategies baseUri immutable keepMeta metaStoreName metaDataName prefetch prefetchRefractoryPeriod".split(" ");for(var d in c)if(-1==Na(a,d))throw new M('Unknown Sync attribute "'+d+'"  in Sync.');this.K=!!c.immutable;this.h=c.baseUri;this.Ab=c.metaStoreName||this.O;this.I=c.metaDataName;this.s=this.Ab==this.O;a=c.Options||{};if(!this.Ab)throw new M("metadata store name required.");
b=this.tb();for(d in a)if(-1==Na(b,d))throw new M('Unknown Sync.Options attribute "'+d+'" in Sync.Options');this.xa=a.delimiter||"";this.l=a.prefix||"";this.V=!!c.keepMeta;this.P=c.prefetch||y(c.prefetchRefractoryPeriod)?"full":null;this.na=y(c.prefetchRefractoryPeriod)?c.prefetchRefractoryPeriod:5E3;this.g=ep(c.transport);this.o=new No(this.sb(),c.metaData);this.n=null;this.H=NaN}h=dp.prototype;h.sb=function(){var a={},b;for(b in Oo)a[b]=b;return a};h.tb=function(){return[]};h.F=function(){return this.O};
h.logger=R("ydn.db.sync.Rest");h.Eb=function(){return this.h};h.ta=function(){this.g||(this.g=new po);return this.g};h.toString=function(){return"sync:"+this.O};function Yo(a,b){return ll(a.storage.g,a.Ab,b).Ic(function(a){throw a;})}function fp(a,b,c){a.i.keyPath&&null==cl(a.i,b)&&null!=c&&zj(b,a.i.keyPath,c)}
function Zo(a,b,c,d){d=a.i.keyPath?void 0:d;if(c){if(a.s){for(g=0;g<b.length;g++)null!=c[g]&&uc(b[g],c[g]);return ll(a.storage.g,a.O,b,d)}if(b){for(var e=[],f=b.concat(c),g=0;g<b.length;g++){var k=a.i.keyPath?NaN:d[g];e.push(new vk(a.O,k))}for(g=0;g<c.length;g++)e.push(new vk(a.Ab,NaN));return ll(a.storage.g,e,f)}return ll(a.storage.g,a.Ab,c)}for(g=0;g<b.length;g++)k=d?d[g]:void 0,fp(a,b[g],k);return ll(a.storage.g,a.O,b,d)}
function gp(a,b){var c=[new vk(a.O,b)];a.s||c.push(new vk(a.Ab,b));return ml(a.storage.g,c)}h.cf=function(a){return this.Eb()+a};h.add=function(a,b,c){null!=c?fp(this,b,c):this.i.keyPath&&(c=cl(this.i,b));var d=this.wa(c,b),e=this;ap(d,function(a){201==a||200==a?(Q(e.logger,d+" created"),d.save(!0)):O(e.logger,"Unexpected respond "+a+" for add "+d)})};
function bp(a,b,c){var d=new vk(a.Ab,b);hp(a,[d]).t(function(a){c.call(void 0,new Qo(b,a[0],this.o,this.I))},function(a){O(this.logger,this+" error loading meta data "+a);c.call(void 0,null)},a)}h.Rd=function(a,b){var c=a.map(function(a){return new vk(this.Ab,a)});hp(this,c).t(function(c){for(var e=[],f=0;f<a.length;f++)e[f]=new Qo(a[f],c[f],this.o,this.I);b(e)},function(a){O(this.logger,this+" error loading meta data "+a);b([])},this)};
h.load=function(a,b,c){var d=this.Ab,e=[new vk(this.F(),a)];this.s||e.push(new vk(d,a));hp(this,e).t(function(d){var e=d[0];b.call(c,e,new Qo(a,this.s?e:d[1],this.o,this.I))},function(a){O(this.logger,this+" error loading meta data "+a);b.call(c,null,null)},this)};function hp(a,b){return pl(a.storage.g,b)}
h.get=function(a,b){this.H||this.$b();ik(a,function(c,d,e){if(d)e(c,d);else{Vc(a,c);var f=t(c);if(f&&this.K)e(c);else{var g=this.wa(b,c);g.lc(function(a){if(304==a){if(e(c),!f)throw new Tc(g+" not modified, but not exist in server");}else if(200==a)g.save().da(function(){e(g.vb())});else if(404==a)gp(g.g,g.D()).da(function(){e(g.vb())});else throw e(g.vb()),new Sc("Invalid HTTP respond "+a+" for GET "+b);},this)}}},this)};
function ip(a,b,c,d,e,f){var g=[],k=a.logger;P(a.logger,d.length+", "+e.length+", "+f.length+", "+g.length+" records to fetch, update, delete, save");var l=d.length+e.length+f.length+g.length;if(0==l)b(c);else{for(var m=!1,n=function(){l--;0==l&&(b(c,m),b=null)},g=0;g<d.length;g++){var p=a.wa(d[g]);p.index=g;p.lc(function(a){200==a?(Q(k,"A new "+this+" received from server"),this.save().t(function(){c[this.index]=this.vb();n()},function(){m=!0;n()},this)):304==a?this.save(!0).t(function(){Q(k,this+
" expires date updated");n()},function(){m=!0;n()},this):(O(k,"Invalid status "+a+" for fetching "+this),n())},p)}for(g=0;g<e.length;g++)p=a.wa(e[g]),p.index=g,p.load(function(){this.lc(function(a){200==a?(Q(k,this+" updated from server"),this.save().t(function(){c[this.index]=this.vb();n()},function(){m=!0;n()},this)):(O(k,"Invalid status "+a+" for fetching "+this),n())})});for(g=0;g<f.length;g++)p=a.wa(f[g]),p.index=g,gp(p.g,p.D()).t(function(){c[this.index]=new Ko(p,null);n()},function(){m=!0;
n()},p)}}function jp(a,b,c){ik(b,function(a,e,f){if(e)f(a,e);else if(Sa(a,function(a){return t(a)})&&this.K)f(a);else{Vc(b,a);var g=a.length;for(e=0;e<c.length;e++)if(this.K&&t(a[e]))g--,0==g&&f(a);else{var k=this.wa(c[e],a[e]);k.index=e;k.lc(function(b){200==b?(a[this.index]=this.vb(),this.save()):404==b&&(a[this.index]=void 0);g--;0==g&&f(a)},k)}}},a)}h.wa=function(a,b){return new Wo(this,a,b)};h.count=function(a){return a};h.jf=function(){throw new Qc;};
h.values=function(a,b,c){kp(this)?(Q(this.logger,"prefetch queued"),ik(a,function(d,e,f){Vc(a,d);e?f(d,e):lp(this,function(a){a?ol(this.storage.g,this.O,null,null,!1,b,c).t(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(){O(this.logger,this+" prefetch fail");f(d)},this)},this)):this.jf(a,b,c)};
h.keys=function(a,b,c,d,e,f,g){ik(a,function(k,l,m){Vc(a,k);l?m(k,l):lp(this,function(a){a?ql(this.storage.g,this.O,b,c,d,e,f,g).t(function(a){m(a)},function(a){m(a,!0)},this):m(k)},function(){O(this.logger,this+" prefetch fail");m(k)},this)},this)};h.Fe=function(){};
h.put=function(a,b,c){c=t(c)?c:this.i.keyPath?cl(this.i,b):null;var d=this.wa(c,b);W(a,function(){d.load()},this);ik(a,function(c,f,g){Vc(a,c);ap(d,function(c){409==c?d.lc(function(){var c=new Ko(d,b);Vc(a,c);c.g?g(null,f):g(void 0,f)}):200==c||201==c?(d.save(!0),g(b,f)):(O(this.logger,"Unexpected response for PUT: "+c),g(null,f))},this)},this)};
h.remove=function(a,b){var c=this,d=this.wa(b);d.load(function(){ik(a,function(e,f,g){cp(d,function(f){if(409==f){f=new Ko(d,null);Vc(a,f);var l=new Mo(c.storage,409,f);c.storage.Ra(l)}else 200==f?Q(c.logger,"Successfully deleted object "+b):(O(c.logger,"Unexpected response for DELETE: "+f+" "+b),Vc(a,l));g(e)})})})};
h.$b=function(){Q(this.logger,this+" starting prefetch");var a=new F;ol(this.storage.g,this.O,"updated.$t",null,!0,1).t(function(b){var c={};if(b=b[0])b=oc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b;var d=this,c=new ei(this.Eb(),"GET",c);d.ta().request(c).execute(function(b,c){if(200==c.N()){if(!b){var g=cj(c);x(g)&&(b=JSON.parse(g))}g=(g=(b.feed||b).entry)?u(g)?g:[g]:[];0<g.length?Zo(d,g).da(function(){a.u(!0)}):a.u(!1)}else 302==c.N()?a.u():(g=d+": Invalid response status "+
c.N()+" on prefetching",O(d.logger,g),a.w(Error(g)))})},function(b){a.w(b)},this);return a};function kp(a){return a.P?a.H?D()-a.H>a.na:!0:!1}function lp(a,b,c,d){kp(a)?a.n?a.n.t(b,c,d):(a.n=a.$b(),a.H=D(),a.n.t(b,c,d),a.n.t(function(a){Q(this.logger,"prefetch "+(a?"updated":"no update"));this.n=null},function(a){this.n=null;throw a;},a)):b.call(d,!1)};function mp(a,b,c){dp.call(this,a,b,c)}E(mp,dp);mp.prototype.logger=R("ydn.db.sync.Atom");mp.prototype.tb=function(){return mp.m.tb.call(this)};mp.prototype.D=function(a){return a.key};function np(a){this.data=a}h=np.prototype;h.D=function(){return this.data.id.$t};h.hd=function(){return this.data.title?this.data.title.$t:void 0};h.ge=function(a){return Jo(this.data,a)};h.Dh=function(){var a=this.ge("self");return a?a.href:void 0};h.Ch=function(){var a=this.ge("http://schemas.google.com/g/2005#batch");return a?a.href:""};h.ra=function(){return this.data.content||null};function op(a,b,c){Wo.call(this,a,b,c)}E(op,Wo);op.prototype.logger=R("ydn.db.sync.entry.S3");op.prototype.getName=function(){return this.g.l+this.key};op.prototype.ic=function(a,b,c,d){b=op.m.ic.call(this,a,b,c,d);if("PUT"==b.method||"POST"==b.method){c=Id(new vd(a)).substr(1);if(1>c.length)throw new Sc("invalid url "+a);b.headers.Key=c;a=b.headers["Content-Type"]||"application/json";d instanceof File?a=d.type:x(d)&&(a=/<*DOCTYPE html/i.test(d)?"text/html":"text/plain");b.headers.ContentType=a}return b};function pp(a){this.data=a}E(pp,np);var qp={atom:"http://www.w3.org/2005/Atom",ydn:"http://www.yathit.com/2012/ydn",app:"http://www.w3.org/2007/app",openSearch:"http://a9.com/-/spec/opensearch/1.1/",gAcl:"http://schemas.google.com/acl/2007",sites:"http://schemas.google.com/sites/2008",gs:"http://schemas.google.com/spreadsheets/2006",dc:"http://purl.org/dc/terms",batch:"http://schemas.google.com/gdata/batch",gd:"http://schemas.google.com/g/2005",gContact:"http://schemas.google.com/contact/2008",thr:"http://purl.org/syndication/thread/1.0",
xhtml:"http://www.w3.org/1999/xhtml"};function rp(a,b){for(var c=a.indexOf(" "),d=0;d<b.length;d++){var e=b[d],e=(0==d?"xmlns":"xmlns:"+e)+'="'+qp[e]+'"';-1==a.indexOf(e)&&(a=a.substring(0,c+1)+e+" "+a.substr(c+1))}return a}R("ydn.xml");function sp(a){return qp[a]||qp.xhtml};function tp(a,b,c){c=!!c;if(a.getName()!=b.getName())return!1;var d=up(a),e=up(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;for(d=0;d<e.length;d++)if(a.getAttribute(e[d])!=b.getAttribute(e[d]))return!1;d=vp(a);e=vp(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;if(0==d.length||0==d.length)return a.data.$t===b.data.$t;for(d=0;d<e.length;d++){var f=wp(a,e[d]),g=wp(b,e[d]);if(!c&&f.length!=g.length||c&&g.length>f.length)return!1;for(var k=0;k<g.length;k++)if(-1==Ua(f,function(a){return tp(a,
g[k],c)}))return!1}return!0};function xp(a,b,c){if(t(b))yp(this,b),t(c)||(c=a[b]);else for(var d in a)if(a.hasOwnProperty(d)&&A(a[d])&&x(a[d].xmlns)){this.ld=[d].xmlns;yp(this,d);c=a[d];break}this.data=c;this.parent=a}h=xp.prototype;h.ld="http://www.w3.org/2005/Atom";function yp(a,b){var c=b.split(":");1<c.length&&(a.ld=sp(c[0])||xp.prototype.ld,b=c[1]);a.tagName=b}
h.p=function(a,b){var c;c=a;var d=b,e=c;if(t(d))"atom"!=d&&(e=d+"$"+c);else{var f=c.split(":"),e=c.replace(/:/,"$");2==f.length&&(d=f[0],c=f[1])}d=t(d)?sp(d):void 0;c=t(this.data[c])&&t(d)&&this.data[c].xmlns==d?c:e;return u(this.data[c])?new xp(this.data,c,this.data[c][0]):A(this.data[c])?new xp(this.data,c,this.data[c]):null};h.toString=function(){return"JsonElement:"+this.tagName};h.getName=function(){return this.tagName};
function zp(a,b){for(var c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&delete a.data[c];a.data.$t=b}h.getAttribute=function(a){a=a.replace(/:/,"$");return this.data[a]};h.setAttribute=function(a,b){a=a.replace(/:/,"$");this.data[a]=b};h.removeAttribute=function(a){a=a.replace(/:/,"$");delete this.data[a]};function up(a){var b=[],c;for(c in a.data)a.data.hasOwnProperty(c)&&x(a.data[c])&&"$t"!=c&&b.push(c);return b}
function wp(a,b){t(void 0)?b="undefined$"+b:t(b)&&(b=b.replace(/:/,"$"));var c=[];if(t(b)){var d=a.data[b];if(u(d))for(var e=0;e<d.length;e++)c.push(new xp(a.data,b,d[e]));else A(d)&&c.push(new xp(a.data,b,d))}else for(d in a.data)if(u(a.data[d]))for(e=0;e<a.data[d].length;e++)c.push(new xp(a.data,d,a.data[d][e]));else A(a.data[d])&&c.push(new xp(a.data,d,a.data[d]));return c}function vp(a){var b=[],c;for(c in a.data)A(a.data[c])&&b.push(c.replace("$",":"));return b}
h.appendChild=function(a){var b=a.getName();this.data[b]?(u(this.data[b])||(this.data[b]=[this.data[b]]),this.data[b].push(Zl(a.data))):this.data[b]=Zl(a.data)};
h.update=function(a,b,c,d,e){var f=!1;c=c||{};var g=t(b),k=!0===b||!g,l=!1===b,m=up(this),n=up(a);if(!g)for(var p=0;p<m.length;p++)t(e)&&!e[m[p].replace("$",":")]||Va(n,m[p])||(this.removeAttribute(m[p]),f=!0);for(p=0;p<n.length;p++){var q=a.getAttribute(n[p]);if(!t(e)||e[n[p].replace("$",":")])Va(m,n[p])?l||q==this.getAttribute(n[p])||(this.setAttribute(n[p],q),f=!0):(this.setAttribute(n[p],q),f=!0)}if(0==Ap(a)&&k&&(e=this.data.$t,l=a.data.$t,t(l)&&e!=l))return zp(this,l),!0;if(!g)for(var s in this.data)d&&
!d[s.replace("$",":")]||!A(this.data[s])||A(a.data[s])||(delete this.data[s],f=!0);s=vp(a);for(e=0;e<s.length;e++)if(l=s[e],!d||!0==d[l]){var v=wp(a,l),m=wp(this,l),z=l.replace(":","$");if(1==v.length)0==m.length?(this.data[z]=Zl(v[0].data),f=!0):1==m.length?c[l]?k&&!tp(m[0],v[0],!0)&&(u(this.data[z])||(this.data[z]=[this.data[z]]),this.data[z].push(Zl(v[0].data)),f=!0):f=m[0].update(v[0],b)||f:g?(l=Ua(m,function(a){return tp(a,v[0],!0)}),-1==l&&k&&(this.data[z].push(Zl(v[0].data)),f=!0)):(this.data[z]=
Zl(v[0].data),f=!0);else if(!u(this.data[z]))if(k)this.data[z]=Zl(a.data[z]),f=!0;else{if(g){var m=Zl(a.data[z]),C=this,l=Ua(m,function(a){return Gl(C.data[z],a)});-1==l&&(m.push(this.data[z]),this.data[z]=m,f=!0)}}else if(k)for(m.length>v.length&&(this.data[z].splice(v.length,m.length-v.length),f=!0),p=0;p<v.length;p++)t(m[p])?Gl(m[p].data,v[p].data)||(this.data[z][p]=Zl(v[p].data),f=!0):(this.data[z][p]=Zl(v[p].data),f=!0);else if(g)for(p=0;p<a.data[z].length;p++)l=Ua(this.data[z],function(b){return Gl(a.data[z][p],
b)}),-1==l&&(this.data[z].push(Zl(a.data[z][p])),f=!0)}return f};h.kf=function(a,b,c,d,e){t(b)||(b=!1);return this.update(a,b,c,d,e)};h.toJSON=function(){return{data:this.data,tagName:this.tagName}};
function Bp(a){function b(a,g){d(g,a);var k,l;for(l in a)if(a.hasOwnProperty(l)&&!x(a[l]))if(x(a[l].$t)&&"xhtml"==a[l].type){k=c(l);d(k,a[l]);var m=Dh(a[l].$t);e.importNode(m.documentElement,!0);k.appendChild(m.documentElement);g.appendChild(k)}else if(x(a[l].$t))k=c(l),k.textContent=a[l].$t,d(k,a[l]),g.appendChild(k);else if(u(a[l])&&a[l][0]&&x(a[l][0].$t))for(m=0;m<a[l].length;m++)k=c(l),k.textContent=a[l][m].$t,d(k,a[l][m]),g.appendChild(k);else if(u(a[l]))for(m=0;m<a[l].length;m++)k=c(l),g.appendChild(k),
b(a[l][m],k);else A(a[l])&&(k=c(l),g.appendChild(k),b(a[l],k))}function c(a){return e.createElement(a.replace("$",":"))}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&"$t"!=c&&x(b[c])&&a.setAttribute(c.replace("$",":"),b[c])}var e=Bh(a.getName(),a.ld);b(a.data,e.documentElement);return Eh(e.documentElement)}
function Ap(a){function b(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&(u(a[c])?b+=a[c].length:A(a[c])&&b++);return b}var c;t(void 0)?c="undefined$"+c:t(c)&&(c=c.replace(/:/,"$"));return t(c)?u(a.data[c])?a.data[c].length:A(a.data[c])?b(a.data[c]):0:b(a.data)}h.ea=function(a){var b={};if(t(a))for(var c in this.data){var d=c.replace("$",":");x(this.data[c])?b[c]=this.data[c]:!0==a[d]&&(b[c]=Zl(this.data[c]))}else b=Zl(this.data);return new xp(null,this.tagName,b)};
function Cp(a,b){var c=b.ownerDocument.createElementNS(a.ld,a.getName()),d;for(d in a.data)if(a.data.hasOwnProperty(d)){var e=d.replace("$",":");if(x(a.data[d]))"$t"==d?c.textContent=a.data[d]:(e=c.ownerDocument.createAttribute(e),e.nodeValue=a.data[d],c.setAttributeNode(e));else if(u(a.data[d]))for(var f=0;f<a.data[d].length;f++){var g=new xp(a.data[d],e,a.data[d][f]);Cp(g,c)}else A(a.data[d])&&(g=new xp(a.data,e,a.data[d]),Cp(g,c))}return b.appendChild(c)};function Dp(a){var b;if(t(a.id))b=a.id.$t;else if(t(a.batch$id))b=a.batch$id.$t;else if(t(a.g))b=a.g.$t;else throw new Fh("id or batch:id required.");this.id=b;this.h=void 0;this.data=a}E(Dp,pp);h=Dp.prototype;h.logger=R("ydn.gdata.Entry");h.xf=function(){return this.kind};h.hd=np.prototype.hd;h.D=function(){return this.id};h.qc=["link","category"];h.cg=["id","batch$id","link","category"];h.ra=np.prototype.ra;
function Ep(a,b){if(b)a.data.status=""==b?void 0:b;else{var c=a.data;c.status&&(c.status=b)}}function Fp(a){return t(a.gd$deleted)?"gd:deleted":(a=a.status)?a:""}function Gp(a){return"gd:deleted"==Fp(a.data)}h.setTitle=function(){throw new Hh;};
h.sc=function(){if(!Hp(this.data))throw Error("nothing to commit");var a=new F;Ip(this,function(b,c){if(c.Aa())a.u(b);else{var d=cj(c);if(x(d)&&/html/.test(dj(c,"content-type")))try{var e=(new DOMParser).parseFromString(d,"text/html");e.body&&(d=e.body.innerHTML)}catch(f){}a.w(c.N()+" "+c.Ga()+" "+d)}},this);return a};
function Ip(a,b,c){var d=ci("gse");if(Hp(a.data)){var e={"Content-Type":"application/atom+xml"};a.g&&(e["GData-Version"]=a.g);var f={},g="POST",k,l,m;m="full";t(l)||(l="base"!=m);var n=a.kind||"contact";k=k?"/"+k:"";k=(l?"https":"http")+"://www.google.com/m8/feeds/"+n+"s/"+a.user_id.replace("@","%40")+"/"+m+k;k=k.replace("%40","@");if(l=(l=a.ge("edit"))?l.href:void 0)g="delete"==Fp(a.data)?"DELETE":"PUT",k=l;try{var p=Jp(a)}catch(q){Si({"class":"ydn.gdata.Entry",method:"ydn.gdata.Entry.commit","entry.data":a.data,
context:"toXmlString",error:{name:q.name,message:q.message,stack:q.stack}})}l=a.type;m=["atom","app","gd","batch","ydn"];if("sites"==l||"site"==l||"content"==l||"webpage"==l)m=m.concat("xhtml","sites");else if("m8"==l||"contact"==l)m=m.concat("gContact");p=rp(p,m);Dp.g&&(a.h=[k,f,g,e,p]);d.request(new ei(k,g,f,e,p)).execute(b,c)}else P(a.logger,a+" commit ignore since not modified."),b&&b.call(c,null,null)}function Hp(a){if(null==a.id)return!0;a=Fp(a);return"modified"===a||"delete"===a}h.Ge=function(){return this.data};
function Jp(a){var b=new xp(null,"entry",a.Ge()),c=!1;b.xmlns||(b.xmlns="http://www.w3.org/2005/Atom",c=!0);var d=["atom"],e;for(e in a.data)if(a=e.match(/^(\w+)\$\w+/))a=a[1],a in qp&&(Va(d,a)||d.push(a));e=Bp(b);c&&delete b.xmlns;return rp(e,d)}h.update=function(a){var b=["batch$status","batch$operation","status"],c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Va(b,c)&&!Va(this.cg,c)&&(this.data[c]=a.data[c])};h.lf=function(a,b){if(Gl(this.data[a],b))return!1;this.data[a]=Zl(b);return!0};
h.kf=function(a){if(a.data.updated.$t>=this.data.updated.$t&&Gp(a)){if(Gp(this)||"delete"==Fp(this.data))return!1;Ep(this,"delete");return!0}var b=!1,c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Va(this.cg,c)&&this.lf(c,a.data[c])&&(b=!0);b&&(a=Fp(this.data),"delete"==a?O(this.logger,this+" marked for deletion. Cannot mark modify flag."):"committed"==a?this.logger.log(Te,this+" already committed. All changes must wait until updated from the server.",void 0):Ep(this,"modified"));return b};function Kp(a,b,c){Wo.call(this,a,b,c)}E(Kp,Wo);Kp.prototype.le=function(){return this.key};Kp.prototype.ic=function(a,b,c,d){a=Kp.m.ic.call(this,a,b,c,d);this.g.sg(a.method)&&r.gapi&&r.gapi.auth&&(b=gapi.auth.getToken())&&b.access_token&&(a.headers.Authorization=b.token_type+" "+b.access_token);if("GET"==a.method)a.params.alt="json";else if("PUT"==a.method||"POST"==a.method)d=new Dp(d),a.body=Jp(d),a.headers["Content-Type"]="application/atom+xml";return a};
Kp.prototype.He=function(a,b){a=Kp.m.He.call(this,a,b);a.feed&&(a=a.feed);a.entry&&(a=a.entry);return a};function Lp(a,b,c){dp.call(this,a,b,c);a=c.Options;this.kind=a.kind;this.version=a.version;this.projection=a.projection;this.j=a.maxResults}E(Lp,mp);h=Lp.prototype;h.projection=null;h.version=null;h.logger=R("ydn.db.sync.GData");h.wa=function(a,b){return new Kp(this,a,b)};h.sb=function(){var a=Lp.m.sb.call(this);a.key=["id","$t"];a.etag="gd$etag";a.updated=["updated","$t"];return a};h.tb=function(){var a=Lp.m.tb.call(this);return a=a.concat(["version","projection","kind","maxResults"])};
h.Eb=function(){return"https://www.googleapis.com/"+this.kind+"/"};h.sg=function(){return!1};h.D=function(a){return a?a.id?a.id.$t:"":""};
function Mp(a,b,c){var d=c||a.Eb();c&&Q(a.logger,"continuing "+c);b=new ei(d,"GET",b);var e=new F;a.ta().request(b).execute(function(b,d){if(200==d.N()){if(!b){var k=cj(d);x(k)&&(b=JSON.parse(k))}var k=b.feed||b,l=k.entry,l=l?u(l)?l:[l]:[];0<l.length&&Zo(a,l);for(var l=null,k=k.link,k=u(k)?k:[k],m=0;m<k.length;m++)"next"==k[m].rel&&(l=k[m].href);l?qb(Mp(a,{},l),e):(Q(a.logger,"prefetch "+a.O+" done"),e.u(!!c))}else 302==d.N()?e.u():(k=a+": Invalid response status "+d.N()+" on prefetching",O(a.logger,
k),e.w(Error(k)))});return e}h.$b=function(){Q(this.logger,"starting prefetch");var a=new F;ol(this.storage.g,this.O,"updated.$t",null,!0,1).B(function(b){var c={alt:"json",kind:this.kind};this.j&&(c["max-results"]=this.j);(b=b[0])?(b=oc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b,Q(this.logger,this.O+" fetching entries later then "+b)):Q(this.logger,this.O+" fetching entries from beginning");qb(Mp(this,c),a)},this);return a};
h.count=function(a){var b=Rj(this.i,"updated.$t");if(!b)return a;var c=gk(a);a.t(function(a){Vc(c,a);ol(this.storage.g,this.O,b.getName(),null,!1,1).t(function(b){var f={alt:"json"};if(b=u(b)?b[0]:b)b=oc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),f["updated-min"]=b;var g=this,f=new ei(this.Eb(),"GET",f);this.ta().request(f).execute(function(b,e){if(200==e.N()){if(!b){var f=cj(e);x(f)&&(b=JSON.parse(f))}f=oc(b.feed,"openSearch$totalResults");c.u(a+parseFloat(f||0))}else O(g.logger,
g+":Unexpected respond status "+e.N())})},function(a){c.w(a)},this)},function(a){c.w(a)},this);return c};function Np(a,b,c){Wo.call(this,a,b,c)}E(Np,Kp);function Op(a,b,c){Lp.call(this,a,b,c);this.h=this.h.substr(27);this.Ob=c.Options.prefix}E(Op,Lp);Op.prototype.ta=function(){this.g||(this.g=new Pp(gapi.client));return this.g};Op.prototype.wa=function(a,b){return new Np(this,a,b)};Op.prototype.Eb=function(){return this.h+this.Ob};
Op.prototype.$b=function(){Q(this.logger,"starting prefetch");var a=new F;ol(this.storage.g,this.O,"updated",null,!0,1).t(function(b){var c={alt:"json"};if(b=b[0])b=oc(b,"updated"),b=(new Date(1+ +new Date(b))).toISOString(),c.updatedMin=b;var d=this,c=new ei(this.Eb(),"GET",c);d.ta().request(c).execute(function(b,c){if(b){var g=b.items||[];0<g.length?Zo(d,g).da(function(){a.u(!0)}):a.u(!1)}else 302==c.N()?a.u():(g=d+": Invalid response status "+c.N()+" on prefetching",O(d.logger,g),a.w(Error(g)))})},
function(b){a.w(b)},this);return a};function Qp(a,b){if(!t(r.AWS))throw new Sc("AWS JS SDK not loaded");this.h=a;this.i=b;this.g=null}Qp.prototype.request=function(a){return new Rp(this,a)};function Sp(a){var b={params:{Bucket:a.h,region:a.i}};if(!a.h)throw new M("bucket name required");a.g||(a.g=new AWS.S3(b));return a.g}function Rp(a,b){this.parent=a;this.g=b}
function Tp(a,b,c,d,e){var f=NaN,g="",k={};a=Sp(a.parent)[b](c);a.on("complete",function(a){a.httpResponse&&(f=a.httpResponse.statusCode,x(f)&&(f=parseInt(f,10)),k=a.httpResponse.headers);a.error&&(g=a.error.message,f||(f=400))});a.send(function(a,b){var c=new aj(f,b,k,g);a?d.call(e,null,c):d.call(e,b,c)})}
Rp.prototype.execute=function(a,b){var c=Id(new vd(this.g.path)),c="/"==c.charAt(0)?c.substr(1):c,d=this.g.headers||{};c&&(d.Key=c);if(c)if("GET"==this.g.method)Tp(this,"getObject",d,a,b);else if("PUT"==this.g.method)Tp(this,"putObject",d,a,b);else throw new Qc("HTTP method "+this.g.method);};function Up(a,b){this.g=a;this.prefix=Vp(this,"Prefix")[0];this.h=b.type}Up.prototype.fa=function(){return this.g.documentElement.getElementsByTagName("Contents").length};Up.prototype.keys=function(){var a=Vp(this,"Key");if(this.prefix){var b=this.prefix.length,a=a.map(function(a){return a.substr(b)});"INTEGER"==this.h?a=a.map(function(a){return parseInt(a,10)}):"NUMERIC"==this.h&&(a=a.map(function(a){return parseFloat(a)}))}return a};
function Vp(a,b){for(var c=[],d=a.g.documentElement.getElementsByTagName(b),e=d.length,f=0;f<e;f++)c[f]=d[f].textContent;return c}function Wp(a){return Vp(a,"LastModified").map(function(a){return(new Date(Date.parse(a))).toGMTString()})}
function Xp(a){var b=a.g.documentElement.getElementsByTagName("NextMarker");return 1==b.length?b[0].textContent:"true"==a.g.documentElement.getElementsByTagName("IsTruncated")[0].textContent&&(a=a.g.documentElement.firstElementChild.lastElementChild)&&"Contents"==a.tagName?a.getElementsByTagName("Key")[0]:null};function Yp(a,b,c){dp.call(this,a,b,c);this.j=c.Options.bucket;if(!x(this.j)||ta(this.j))throw new M("bucket name required.");this.h||(this.h="https://"+this.j+".s3.amazonaws.com/");if(!0===b.h)throw new M('S3 object store "'+b.getName()+'" must not set autoIncrement to true.');}E(Yp,dp);h=Yp.prototype;h.logger=R("ydn.db.sync.S3");h.tb=function(){var a=Yp.m.tb.call(this);return a=a.concat(["bucket","maxKeys","prefix","delimiter"])};h.ta=function(){this.g||(this.g=new Qp(this.j));return this.g};
h.cf=function(a){return this.h+this.l+a};h.wa=function(a,b){return new op(this,a,b)};
h.jf=function(a,b){var c=this;ik(a,function(d,e,f){Vc(a,d);c.Rd(d,function(a){var e={},l=a[0]?Ro(a[0]):null;null!=l&&(e.marker=l);0<c.l.length&&(e.prefix=c.l);0<b&&(e["max-keys"]=b);Q(c.logger,c+" querying for newer entries starting from "+l);e=new ei(c.h,"GET",e);c.ta().request(e).execute(function(b,e){if(200==e.N()){for(var k=cj(e),k=k instanceof Document?k:Dh(k),l=new Up(k,c.i),k=l.keys(),l=Wp(l),s=[],v=[],z=[],C=0,G=0;C<=a.length&&G<k.length;){var J=a[C]?Ro(a[C]):null,N=k[G];if(C==a.length)v.push(N),
G++;else{var ha=J?wj(J,N):-1;0==ha?((N=So(a[C]))&&l[G]&&N!=l[G]&&(l[G]>N?z.push(J):O(c.logger,'record "'+J+'" in database is more recent than server '+N+" vs "+l[G])),C++,G++):1==ha?(s.push(J),C++):(v.push(N),G++)}}ip(c,f,d,v,z,s)}else O(c.logger,"Invalid response status "+e.N())})})},this)};
function Zp(a,b){function c(f){null!=f&&(d.marker=f);Q(a.logger,a+" querying for newer entries starting from "+f);e.request(new ei(a.h,"GET",d)).execute(function(d,e){if(200==e.N()){var f=cj(e),f=f instanceof Document?f:Dh(f),f=new Up(f,a.i),m=Xp(f),f=f.keys(),n=f.length;if(0==n)b([]),b=null;else for(var p=0,q=0;q<n;q++)a.wa(f[q]).lc(function(){p++;p==n&&(m?c(m):b&&(b([this.vb()]),b=null))})}else O(a.logger,"Invalid response status "+e.N())})}var d={};0<a.l.length&&(d.prefix=a.l);var e=a.ta();c();
a.$=!0}function $p(a,b){a.$||ik(b,function(a,b,e){t(a[0])?e(a):Zp(this,e)},a)};function aq(a,b,c){Wo.call(this,a,b,c)}E(aq,op);aq.prototype.logger=R("ydn.db.sync.entry.Gcs");function bq(a,b,c){Yp.call(this,a,b,c);this.h="https://"+this.j+".storage.googleapis.com/"}E(bq,Yp);bq.prototype.logger=R("ydn.db.sync.Gcs");bq.prototype.ta=function(){this.g||(this.g=new po);return this.g};bq.prototype.wa=function(a,b){return new aq(this,a,b)};function Pp(a,b){this.h=a;this.g=!!b}Pp.prototype.request=function(a){var b={path:a.path,method:a.method,headers:a.headers,params:a.params,body:a.body};this.g&&(b.callback=function(a,e){c.u(a,e);b.callback=null});a=this.h.request(b);var c=new cq(a);return c};function cq(a){this.h=a||null}cq.prototype.u=function(a,b){this.i&&(this.i(a,fj(b)),this.i=null);this.g={json:a,Bc:b}};
cq.prototype.execute=function(a){this.h?(this.h.execute(function(b,c){a(b,fj(c))}),this.h=null):this.g?(a(this.g.json,fj(this.g.Bc)),this.g=null):this.i=a};function ep(a){if(a){if(a instanceof po)return a;if(ga(a))return new Pp({request:function(b){a(b)}},!0);if("request"in a)return new Pp(a);throw new M(a+" is not a valid HTTP Client");}return null};function dq(a,b,c){Wo.call(this,a,b,c)}E(dq,aq);dq.prototype.logger=R("ydn.db.sync.entry.GcsJson");dq.prototype.lc=function(a){var b=this.g,c=this;$o(this,function(d){var e={method:"GET",path:"storage/v1beta2/b/"+b.j+"/o/"+encodeURIComponent(c.getName())};d&&(e.headers=Uo(d));gapi.client.request(e).execute(function(d,e){var k=fj(e);c.j=new Vo(c.D(),k.Oc(),b.o);d?(Q(c.logger,c+": readServer updated"),c.i=d):(Q(c.logger,c+": readServer request fail "+e),c.j=null,c.i=null);a.call(c,200)},e)})};function eq(a,b,c){bq.call(this,a,b,c)}E(eq,bq);h=eq.prototype;h.logger=R("ydn.db.sync.GcsJson");h.sb=function(){var a=eq.m.sb.call(this);a.key="name";return a};h.ta=function(){if(!this.g)if(t(r.gapi))this.g=new Pp(gapi.client);else throw new Sc("gapi not loaded");return eq.m.ta.call(this)};h.wa=function(a,b){return new dq(this,a,b)};
h.$b=function(){P(this.logger,"starting prefetch");var a=new F;ql(this.storage.g,this.O,null,null,1,0,!0,!1).t(function(b){var c={bucket:this.j};(b=b[0])&&(c.marker=b);var d=this;if(!r.Ng||r.Ng.client)throw Error("gapi lib not loaded");gapi.client.load("storage","v1beta2",function(){var b=gapi.client.storage.objects.list({bucket:d.j});this.Ob&&(c.prefix=this.Ob);b.execute(function(b,c){if(b&&!b.error){var e=b.items||[];0<e.length?Zo(d,null,e).da(function(){a.u(!0)}):a.u(!1)}else e=d+": "+c,O(d.logger,
e),a.w(Error(e))})})},function(b){a.w(b)},this);return a};function fq(a,b,c){bq.call(this,a,b,c);this.P="full"}E(fq,bq);h=fq.prototype;h.logger=R("ydn.db.sync.GcsMeta");h.sb=function(){var a=fq.m.sb.call(this);a.key="name";return a};h.ta=function(){!this.g&&gapi&&(this.g=new Pp(gapi.client));return fq.m.ta.call(this)};h.wa=function(a,b){return new dq(this,a,b)};
h.$b=function(){P(this.logger,"starting prefetch");var a=new F;if(!r.gapi||!r.gapi.client)throw Error("gapi lib not loaded");var b=this;gapi.client.load("storage","v1beta2",function(){function c(e){e&&(d.pageToken=e);gapi.client.storage.objects.list(d).execute(function(e,g){if(e&&!e.error){var k=e.items||[];if(e.nextPageToken)Q(b.logger,"receiving "+k.length+" meta records, continuing next"),Zo(b,k),c(e.nextPageToken);else if(0<k.length)Zo(b,k).da(function(){Q(b.logger,"receiving "+k.length+" meta records, prefetching dane.");
a.u(!0)});else{var l=!!d.pageToken;Q(b.logger,"prefetching done");a.u(l)}}else l=b+": "+g,O(b.logger,l),a.w(Error(l))})}var d={bucket:b.j};this.Ob&&(d.prefix=this.Ob);c()});return a};h.Rd=function(a,b){if(0==a.length)b([]);else{var c=this.F(),d=Qa(a,function(a){return new vk(c,a)});hp(this,d).t(function(d){for(var f=[],g=0;g<a.length;g++)f[g]=new Qo(a[g],d[g],this.o,c);b(f)},function(a){O(this.logger,this+" error loading meta data "+a);b([])},this)}};function gq(a,b,c){dp.call(this,a,b,c)}E(gq,dp);gq.prototype.cf=function(a){return this.h+this.l+this.O+this.xa+a};gq.prototype.logger=R("ydn.db.sync.Json");
gq.prototype.jf=function(a){function b(a,b){var c=new ei(e);d.ta().request(c).execute(function(c){if(200==c.status){var e=(c.response instanceof Object?c.response:zh(c.responseText)).items;c=Qa(e,function(a){return a.id});for(var e=Qa(e,function(a){return a.updated}),k=[],p=[],q=[],s=0,v=0;s<=a.length&&v<c.length;){var z=Ro(a[s]),C=c[v];if(s==a.length)p.push(C),v++;else{var G=wj(z,C);0==G?((C=So(a[s]))&&e[v]&&C!=e[v]&&(new Date(e[v])>C?q.push(z):O(d.logger,'record "'+z+'" in database is more recent than server '+
C+" vs "+e[v])),s++,v++):1==G?(k.push(z),s++):(p.push(C),v++)}}ip(d,function(){},b,p,q,k)}else O(d.logger,"Invalid response status "+c.status)})}var c=new Uc,d=this,e=this.h+this.l+this.O;a.B(function(a){Vc(c,a);this.Rd(a,function(c){b(c,a)})},this)};function hq(a,b,c){dp.call(this,a,b,c)}E(hq,mp);function iq(a,b,c){Wo.call(this,a,b,c)}E(iq,op);iq.prototype.logger=R("ydn.db.sync.entry.S3Meta");function jq(a,b,c){Yp.call(this,a,b,c);this.Ob=c.Options.prefix;if("Key"!=b.keyPath)throw new M('s3-meta store "'+b.getName()+'" must use inline key with keyPath "Key"');this.P="meta"}E(jq,Yp);h=jq.prototype;h.logger=R("ydn.db.sync.S3Meta");h.sb=function(){var a=jq.m.sb.call(this);a.key="Key";a.modified="LastModified";a.etag="ETag";return a};h.wa=function(a,b){return new iq(this,a,b)};
h.$b=function(){function a(f){f&&(e.marker=f);c.listObjects(e).send(function(c,f){if(c){var l=d+": "+Ah(c);O(d.logger,l);b.w(c instanceof Error?c:Error(l))}else{var m=f.Contents||[];f.IsTruncated?(Q(d.logger,"receiving "+m.length+" meta records, continuing next"),Zo(d,m),a(m[m.length-1].Key+"\uffff")):0<m.length?Zo(d,m).da(function(){Q(d.logger,"receiving "+m.length+" meta records, prefetching dane.");b.u(!0)}):(l=!!e.marker,Q(d.logger,"prefetching done"),b.u(l))}})}P(this.logger,"starting prefetch");
var b=new F,c=Sp(this.ta()),d=this,e={};this.Ob&&(e.prefix=this.Ob);a();return b};h.Rd=function(){throw new Sc("loading meta data should not be necessary");};function kq(a,b,c){Wo.call(this,a,b,c)}E(kq,Kp);function lq(a,b,c){Lp.call(this,a,b,c);a=c.Options;this.domain=a.domain;this.$=a.siteName;if(a=Sj(b,"sites$parent"))Il(a,function(a){for(var b=a.link||[],c=0;c<b.length;c++)if("http://schemas.google.com/sites/2008#parent"==b[c].rel)return b[c].href;return a.id.$t.replace(/\w+$/,"0")}),df(this.logger,"index sites$parent in "+b.getName()+" has set a generator.");if(a=Sj(b,"alternate"))Il(a,function(a){a=a.link||[];for(var b=0;b<a.length;b++)if("alternate"==a[b].rel)return a[b].href}),df(this.logger,
"index alternate in "+b.getName()+" has set a generator.")}E(lq,Lp);h=lq.prototype;h.wa=function(a,b){return new kq(this,a,b)};h.tb=function(){var a=lq.m.tb.call(this);return a=a.concat(["domain","siteName"])};h.Eb=function(){return"https://sites.google.com/feeds/content/"+this.domain+"/"+this.$+"/"};h.sg=function(a){return"GET"!=a};
function mq(a,b,c,d){var e={alt:"json",kind:a.kind};"sites$parent"==c?(c=d.match(/\w+$/)[0],e.parent=c):"alternate"==c&&(c=d.replace(/https:\/\/sites.google.com\/a\/[^\/]+\/[^\/]+/,""),e.path=c);var f={},g=a.Eb();ik(b,function(c,l,m){Vc(b,c);if(l=c[0])l=oc(l,"updated","$t"),l=(new Date(1+ +new Date(l))).toISOString(),e["updated-min"]=l;l=new ei(g,"GET",e,f);a.ta().request(l).execute(function(b,e){if(200==e.N()){if(!b){var f=cj(e);x(f)&&(b=JSON.parse(f))}var g=(f=(b.feed||b).entry)?u(f)?f:[f]:[];0<
g.length?Zo(a,g).da(function(){m(g)}):m(c)}else 302==e.N()?m(c):(f=a+": Invalid response status "+e.N()+" for querying pageName: "+d,O(a.logger,f),m(Error(f),!0))})},a)}h.Fe=function(a,b,c){if(kp(this))ik(a,function(d,e,f){Vc(a,d);lp(this,function(a){!0===a?ol(this.storage.g,this.O,b,U.only(c),!1,0).t(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(a){f(a,!0)},this)},this);else return"alternate"==b||"alternate"==b?mq(this,a,b,c):lq.m.Fe.call(this,a,b,c)};Pk.prototype.g=null;
om.prototype.Lf=function(a,b){var c=b.format;if("gdata-sites"==c)a.g=new lq(this,a,b);else if("gdata"==c)a.g=new Lp(this,a,b);else if("gdata-json"==c)a.g=new Op(this,a,b);else if("odata"==c)a.g=new hq(this,a,b);else if("s3"==c)a.g=new Yp(this,a,b);else if("s3-meta"==c)a.g=new jq(this,a,b);else if("gcs"==c)a.g=new bq(this,a,b);else if("gcs-json"==c)a.g=new eq(this,a,b);else if("gcs-meta"==c)a.g=new fq(this,a,b);else if("atom"==c)a.g=new mp(this,a,b);else if("json"==c)a.g=new gq(this,a,b);else if("rest"==
c)a.g=new dp(this,a,b);else throw new Qc("Sync format: "+c);Rl(a,function(b,c){var f=b.Dd();if(!(this instanceof Nk)||this.$a)if(!window.navigator||!t(window.navigator.onLine)||window.navigator.onLine)if("add"==f)f=c[1],a.g.add(b,f);else if("count"==f)c[1]||c[2]||a.g.count(b);else if("put"==f){var f=c[1],g=c[2];a.g.put(b,f,g)}else if("rm:iter"==f)g=c[1],a.g.remove(b,g);else if("values:iter:index"==f){var f=c[1],g=c[2],k=c[3],l=c[4],m=c[5];!k&&!m&&g&&null!=g.lower&&null!=g.upper&&0==wj(g.lower,g.upper)&&
a.g.Fe(b,f,g.lower)}else if("keys"==f)g=c[1],l=c[2],k=c[3],m=c[4],a.g.keys(b,null,g,l,k,m,!1);else if("keys:iter:index"==f)f=c[1],g=c[2],l=c[3],k=c[4],m=c[5],a.g.keys(b,f,g,l,k,m,c[6]);else if("values"==f)g=c[1],l=c[2],k=c[3],m=c[4],g||m?g&&g.lower&&x(g.lower)&&g.lower==g.upper||!g&&m&&1==l&&k&&$p(a.g,b):a.g.values(b,l,k);else if(""!=f)if("get"==f)g=c[1],a.g.get(b,g);else if("values:array"==f)jp(a.g,b,c[1]);else throw Error(f);})};var nq="Accounts Contacts Employees Leads Opportunities Tasks Teams TeamSets Users".split(" "),oq="Accounts Contacts Leads Opportunities Tasks Teams".split(" "),pq=["Accounts","Contacts","Leads"];function qq(a,b,c){return"https://"+a+"/index.php?module="+b+"&action=DetailView&record="+c};function rq(a){this.h=a||[]}rq.prototype.g=function(a){return-1==this.h.indexOf(a)?a:null};function sq(){}
sq.prototype.g=function(a){var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};a=a.toLowerCase();var d,e,f=a;if(3>a.length)return a;var g,k;a=a.substr(0,1);"y"==a&&(f=a.toUpperCase()+f.substr(1));g=/^(.+?)(ss|i)es$/;e=/^(.+?)([^s])s$/;
g.test(f)?f=f.replace(g,"$1$2"):e.test(f)&&(f=f.replace(e,"$1$2"));g=/^(.+?)eed$/;e=/^(.+?)(ed|ing)$/;g.test(f)?(e=g.exec(f),g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(e[1])&&(g=/.$/,f=f.replace(g,""))):e.test(f)&&(e=e.exec(f),d=e[1],e=/^([^aeiou][^aeiouy]*)?[aeiouy]/,e.test(d)&&(f=d,e=/(at|bl|iz)$/,k=/([^aeiouylsz])\1$/,d=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,e.test(f)?f+="e":k.test(f)?(g=/.$/,f=f.replace(g,"")):d.test(f)&&(f+="e")));g=/^(.+?)y$/;g.test(f)&&(e=g.exec(f),
d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy]/,g.test(d)&&(f=d+"i"));g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+b[e]));g=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+c[e]));g=
/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;e=/^(.+?)(s|t)(ion)$/;g.test(f)?(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d)):e.test(f)&&(e=e.exec(f),d=e[1]+e[2],e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,e.test(d)&&(f=d));g=/^(.+?)e$/;g.test(f)&&(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,g.test(d)||e.test(d)&&!k.test(d))&&(f=d);g=/ll$/;e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;g.test(f)&&e.test(f)&&(g=/.$/,f=f.replace(g,""));"y"==a&&(f=a.toLowerCase()+f.substr(1));return f};function tq(a){this.h=a}
tq.prototype.g=function(a){a=a.toLowerCase();a=a.replace(/([^c])\1/g,"$1");a=function(a){return a.match(/^(kn|gn|pn|ae|wr)/)?a.substr(1,a.length-1):a}(a);a=a.replace(/mb$/,"m");a=a.replace(/ck/g,"k");a=function(a){a=a.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim();a=a.replace(/cia/g,"xia");a=a.replace(/c(i|e|y)/g,"s$1");return a=a.replace(/c/g,"k")}(a);a=function(a){a=a.replace(/d(ge|gy|gi)/g,"j$1");return a=a.replace(/d/g,"t")}(a);a=function(a){a=a.replace(/gh(^$|[^aeiou])/g,"h$1");return a=a.replace(/g(n|ned)$/g,
"$1")}(a);a=function(a){a=a.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3");a=a.replace(/gg/g,"g");return a=a.replace(/g/g,"k")}(a);a=a.replace(/([aeiou])h([^aeiou])/g,"$1$2");a=a.replace(/ph/g,"f");a=a.replace(/q/g,"k");a=a.replace(/s(h|io|ia)/g,"x$1");a=function(a){a=a.replace(/^x/,"s");return a=a.replace(/x/g,"ks")}(a);a=function(a){a=a.replace(/t(ia|io)/g,"x$1");return a=a.replace(/th/,"0")}(a);a=a.replace(/tch/g,"ch");a=a.replace(/v/g,"f");a=a.replace(/^wh/,"w");a=a.replace(/w([^aeiou]|$)/g,"$1");a=a.replace(/y([^aeiou]|$)/g,
"$1");a=a.replace(/z/,"s");a=a.charAt(0)+a.substr(1,a.length).replace(/[aeiou]/g,"");a.length>=this.h&&(a=a.substring(0,this.h));return a=a.toUpperCase()};var uq=new tq(32),vq=new sq,wq=new rq("a a's able about above according accordingly across actually after afterwards again against ain't all allow allows almost alone along already also although always am among amongst an and another any anybody anyhow anyone anything anyway anyways anywhere apart appear appreciate appropriate are aren't around as aside ask asking associated at available away awfully b be became because become becomes becoming been before beforehand behind being believe below beside besides best better between beyond both brief but by c c'mon c's came can can't cannot cant cause causes certain certainly changes clearly co com come comes concerning consequently consider considering contain containing contains corresponding could couldn't course currently d definitely described despite did didn't different do does doesn't doing don't done down downwards during e each edu eg eight either else elsewhere enough entirely especially et etc even ever every everybody everyone everything everywhere ex exactly example except f far few fifth first five followed following follows for former formerly forth four from further furthermore g get gets getting given gives go goes going gone got gotten greetings h had hadn't happens hardly has hasn't have haven't having he he's hello help hence her here here's hereafter hereby herein hereupon hers herself hi him himself his hither hopefully how howbeit however i i'd i'll i'm i've ie if ignored immediate in inasmuch inc indeed indicate indicated indicates inner insofar instead into inward is isn't it it'd it'll it's its itself j just k keep keeps kept know knows known l last lately later latter latterly least less lest let let's like liked likely little look looking looks ltd m mainly many may maybe me mean meanwhile merely might more moreover most mostly much must my myself n name namely nd near nearly necessary need needs neither never nevertheless new next nine no nobody non none noone nor normally not nothing novel now nowhere o obviously of off often oh ok okay old on once one ones only onto or other others otherwise ought our ours ourselves out outside over overall own p particular particularly per perhaps placed please plus possible presumably probably provides q que quite qv r rather rd re really reasonably regarding regardless regards relatively respectively right s said same saw say saying says second secondly see seeing seem seemed seeming seems seen self selves sensible sent serious seriously seven several shall she should shouldn't since six so some somebody somehow someone something sometime sometimes somewhat somewhere soon sorry specified specify specifying still sub such sup sure t t's take taken tell tends th than thank thanks thanx that that's thats the their theirs them themselves then thence there there's thereafter thereby therefore therein theres thereupon these they they'd they'll they're they've think third this thorough thoroughly those though three through throughout thru thus to together too took toward towards tried tries truly try trying twice two u un under unfortunately unless unlikely until unto up upon us use used useful uses using usually uucp v value various very via viz vs w want wants was wasn't way we we'd we'll we're we've welcome well went were weren't what what's whatever when whence whenever where where's whereafter whereas whereby wherein whereupon wherever whether which while whither who who's whoever whole whom whose why will willing wish with within without won't wonder would wouldn't x y yes yet you you'd you'll you're you've your yours yourself yourselves z zero".split(" "));function xq(a){this.data=a;this.h=0}xq.prototype.g=function(a){for(var b=this.h,c=this.data[b],c=1,d=0;0<=b&&b<this.data.length;){c=this.data[b];if(c instanceof Array)if(a<c[0])c=-1;else if(a>c[1])c=1;else return this.h=b,!0;else{if(c==a)return this.h=b,!0;c=a<c?-1:1}if(0==d)d=c;else if(d!=c)break;b+=c;if(b>this.data.length||0>b)break}return!1};
function yq(a,b){for(var c=0,d=0,e=a.length,f=0;f<e;++f){a:{var d=a.charCodeAt(f),g=new xq(categ_letters_numbers_data);if(y(d))d=g.g(d);else{for(var k=0,l=d.length;k<l;++k)if(!1===g.g(d[k])){d=!1;break a}d=!0}}d||((d=f-c)&&b(c,d),c=f+1)}(d=e-c)&&b(c,d)};function zq(a,b){this.j=b;this.value=a}zq.prototype.T=function(){return this.value};zq.prototype.ub=function(){return 1};var Aq=!Lb&&(Uh||Rh);zq.prototype.D=function(){return this.value};zq.prototype.toString=function(){return"Entry:"+this.value};function Bq(a,b,c,d,e,f){zq.call(this,d,e);this.O=a;this.h=b;this.i=c;this.Sd=f||[]}E(Bq,zq);h=Bq.prototype;h.fd=function(){return{k:this.j,v:this.value.toLowerCase(),id:this.D(),loc:this.Sd}};h.D=function(){var a=[this.O,this.i,this.h,this.value];return Aq?a:Bj(a)};h.F=function(){return this.O};h.ga=function(){return this.i};h.toString=function(){return["IndexEntry",this.O,this.i,this.value].join(":")};function Cq(a,b,c,d,e){zq.call(this,b,c);this.l=d;this.g=e;this.type=a;this.Nf=1}E(Cq,zq);Cq.prototype.ub=function(){return this.g*this.type*this.Nf};Cq.prototype.D=function(){return this.value+"|"+this.l};function Dq(a,b){Bq.call(this,b.F(),b.h,b.ga(),b.T(),b.j,[]);this.n=a;this.g=[b]}E(Dq,Bq);h=Dq.prototype;h.count=function(){return this.g.length};h.entry=function(a){return this.g[a]};h.kf=function(a){a=a.g[0];for(var b=0;b<this.g.length;b++)if(this.g[b].h==a.h&&this.g[b].value==a.value)return;this.g.push(a)};h.ub=function(){for(var a=0,b=0;b<this.g.length;b++)var c=this.g[b],d=Ul(this.n,c.F(),c.h),c=c.ub(),a=a+c*d.h;return a};function ib(a,b){var c=a.ub(),d=b.ub();return c<=d?1:-1}
h.fd=function(){for(var a={value:this.value,primaryKey:this.i,storeName:this.O,score:this.ub(),tokens:[]},b=0;b<this.g.length;b++)a.tokens[b]=this.g[b].fd();return a};h.toString=function(){return["RankEntry",this.O,this.i,this.value].join(":")+"["+this.g.length+"]"};function Eq(a){var b=[],c;a=a.split(/\s+/);for(var d=0;d<a.length;d++){c=a[d];for(var e=c.length-1,f=Array(e),g=0;g<e;g++)f[g]=c.substring(g,g+2);c=f;b.push.apply(b,c)}return b};function hl(a,b,c,d,e,f,g){Bq.call(this,b,c,d,e,f,g);this.query=a}E(hl,Bq);hl.prototype.ub=function(){var a,b=this.value;a=Eq(this.query.value.toLowerCase().replace(/^\s+|\s+$/g,""));var b=Eq(b.toLowerCase().replace(/^\s+|\s+$/g,"")),c=0,d=a.length+b.length,e,f,g,k;for(e=0;e<a.length;e++)for(g=a[e],f=0;f<b.length;f++)if(k=b[f],g==k){c++;delete b[f];break}a=2*c/d;b=Math.log(this.Sd.length+1);c=this.query.ub();return b*a*c};hl.prototype.fd=function(){return{keyPath:this.h,value:this.value,loc:this.Sd.slice()}};
hl.prototype.toString=function(){return["ResultEntry",this.O,this.i,this.value].join(":")};function Fq(a,b){this.g=a;this.h=b;this.j=[];this.i=0}function gl(a,b){for(var c,d,e=a.g.getName(),f=0;f<a.h.length;f++){var g=a.h[f],k=g.type;0.4==k||0.6==k?(d="v",c=g.T().toLowerCase(),c=qj(c)):(d="v",c=g.T().toLowerCase(),c=U.only(c));b(e,d,c,g);a.i++;0.6==k&&(d="k",c=g.j,c=U.only(c),b(e,d,c,g),a.i++)}}function fl(a){for(var b=[a.g.getName()],c=0;c<a.g.count();c++){var d=a.g.index(c).F();-1==b.indexOf(d)&&b.push(d)}return b}
function il(a){for(var b=[],c=[],d=0;d<a.j.length;d++){var e=a.j[d];if(0==e.query.type)-1==Ua(c,function(a){return a.ga()==e.ga()&&a.F()==e.F()})&&c.push(e);else{var f=new Dq(a.g,e),g=Ua(b,function(a){return a.ga()==f.ga()&&a.F()==f.F()});if(0<=g){var k=b[g];Ya(b,g);k.kf(f);f=k}hb(b,f)}}for(a=0;a<c.length;a++)for(g=c[a],d=b.length-1;0<=d;--d)if(k=b[d],g.ga()==k.ga()&&g.F()==k.F()){b.splice(a,1);break}return b.map(function(a){return a.fd()})};function Gq(a){this.g=a;if("en"==a.lang){a=a.h||["stop","stemmer","metaphone"];for(var b=[],c=0;c<a.length;c++)if("metaphone"==a[c])b.push(uq);else if("stemmer"==a[c])b.push(vq);else if("stop"==a[c])b.push(wq);else throw Error('Invalid normalizer "'+a[c]+'" for English lang');a=b}else a=[];this.h=a}function Hq(a,b){for(var c=0;c<a.h.length;c++){var d=a.h[c].g(b);if(d)b=d;else return null}return b}Gq.prototype.parse=function(a){var b=[];yq(a,function(c,d){b.push(a.substr(c,d))});return b};
Gq.prototype.query=function(a,b){var c=Iq(this,b);return 0==c.length?null:new Fq(this.g,c)};
function Iq(a,b){var c=[],d=[];yq(b,function(a,e){c.push(b.substr(a,e));d.push(a)});for(var e=[],f=0;f<c.length;f++)e[f]=Hq(a,c[f]);for(var g=[],k=0,f=0;f<c.length;f++){var l=c[f],m=e[f],n="*"==b.charAt(d[f]+l.length),p=n?d[f]+l.length+1:d[f]+l.length,p='"'==b.charAt(d[f]-1)&&'"'==b.charAt(p),q="-"==b.charAt(p?d[f]-2:d[f]-1),s=0.8;n?s=0.4:p?s=1:q?s=0:null!=m&&(s=0.6);l=new Cq(s,l,m,d[f],1/(f+2));g.push(l);k+=l.ub()}for(f=0;f<g.length;++f)g[f].Nf=1/k;return g}
function Jq(a,b,c,d){var e=[],f=[];yq(b,function(a,c){e.push(b.substr(a,c));f.push(a)});for(var g=[],k=0;k<e.length;k++)g[k]=Hq(a,e[k]);a=c.F();c=c.g;for(var l=[],k=0;k<e.length;k++){var m=e[k],n=g[k];if(null!=n){var p=Ta(l,function(a){return a.T()==m});p||(p=new Bq(a,c,d,m,n),l.push(p));p.Sd.push(f[k])}}return l}function Kq(a,b,c,d){for(var e=[],f=0;f<a.g.count();f++){var g=a.g.index(f);if(g.F()==b){var k=yj(d,g.g);x(k)&&(e=e.concat(Jq(a,k,g,c)))}}return e};om.prototype.Kf=function(a,b){var c=this;b.g=new Gq(b);Rl(a,function(d,e){function f(b){var e=a.getName();ik(d,function(a,f,g){if(f)g(a,f);else{Vc(d,a);var k=new vk(e,b);ml(c.g,[k]).da(function(){g(a,f)})}})}function g(b){var e=a.getName();ik(d,function(a,f,g){f?g(a,f):(Vc(d,a),b&&(b=oj(U.bound([e,b.lower],[e,b.upper,"\uffff"]))),nl(c.g,e,b).da(function(){g(a,f)}))})}function k(e){var f=a.getName();ik(d,function(a,g,k){Vc(d,a);if(g)k(a,g);else{var l=b.getName();u(a)||(a=[a]);for(var z=0;z<a.length;z++){var C=
a[z];xk(C)&&(C=Kq(b.g,f,C,e[z]).map(function(a){return a.fd()}),C=ll(c.g,l,C),z==a.length-1&&C.da(function(){k(a,g)}))}}})}var l=d.Dd();"put"==l?k([e[1]]):"put:array"==l?k(e[1]):"add"==l?k([e[1]]):"add:array"==l?k(e[1]):"rm:iter"==l||"clear"==l?g(e[1]):"rm"==l&&f(e[1])})};
om.prototype.search=function(a,b,c,d){var e=Yl(this.h,a);if(!e)throw new M('full text index catalog "'+a+'" not found.');a=e.g.query(a,b,c,d);return a?this.g.search(a):(P(this.logger,'query "'+b+'" contains only noise and search is ignored'),jk("search",null))};function Lq(a){this.name=a;this.info=null;this.h={};this.g=null}
var Mq={Accounts:{GeneratorIndex:{ydn$emails:["email","email1","email_addresses_non_primary"],ydn$phones:["phone_office","phone_alternate","phone_fax"]}},Contacts:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Leads:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home",
"phone_mobile","phone_work","phone_other","phone_fax"]}}};function Nq(a,b,c){var d=((a.h[b]||Mq[b]||{}).GeneratorIndex||{})[c];return!d||u(d)&&0==d.length?null:"ydn$emails"==c?{name:c,multiEntry:!0,generator:function(a){var b=[],c;for(c in a)if(0<=d.indexOf(c)){var k=on(a[c]);k&&b.push(k)}return b}}:"ydn$phones"==c?{name:c,multiEntry:!0,generator:function(a){var b=[],c;for(c in a)if(0<=d.indexOf(c)){var k=nn(a[c]);k&&b.push(k)}return b}}:null}
function Oq(a,b){if(a.g)for(var c=0;c<a.g.stores.length;c++)if(a.g.stores[c].name==b)return a.g.stores[c];for(var d={name:b,keyPath:"id",indexes:[{name:"account_id"},{name:"name"},{name:"date_modified"}]},e=["ydn$emails","ydn$phones","ydn$names"],c=0;c<e.length;c++){var f=Nq(a,b,e[c]);f&&d.indexes.push(f)}return d}
function Pq(a){if(a.g)return a.g;for(var b={fullTextCatalogs:[],stores:[{name:"history",indexes:[{keyPath:"type"},{keyPath:"timestamp"}]},{name:"Meta"}]},c=0;c<oq.length;c++){var d=oq[c];b.stores.push(Oq(a,d));var e=a.h[d]||Mq[d]||{};if(e.FullTextIndex)for(var f in e.FullTextIndex){var g=e.FullTextIndex[f];if(0<g.length){for(var k={name:"ft-"+d+"-"+f,lang:"en",sources:[]},l=0;l<g.length;l++)k.sources.push({storeName:d,keyPath:g[l]});b.fullTextCatalogs.push(k)}}}a.g=b;Object.freeze(a.g);return a.g}
;function Qq(a,b,c){this.domain=a;this.X=b;this.g=c||null}Qq.prototype.M=function(){return this.domain};Qq.prototype.D=function(){return this.g.id};function Rq(a){if(!a.g)return"";var b=a.g.full_name||"";if(b)return b;b=(a.g.first_name||"").trim();a=(a.g.last_name||"").trim();return b+" "+a}Qq.prototype.value=function(a){return this.g?this.g[a]:null};Qq.prototype.toString=function(){return"Record:"+this.X+":"+(this.g?this.g.id:void 0)};function Sq(a,b,c){var d=0;if(!b)return d;b.gd$city&&a[c+"_address_city"]!=b.gd$city.$t&&(a[c+"_address_city"]=b.gd$city.$t,d++);b.gd$country&&a[c+"_address_country"]!=b.gd$country.$t&&(a[c+"_address_country"]=b.gd$country.$t,d++);b.gd$postcode&&a[c+"_address_postalcode"]!=b.gd$postcode.$t&&(a[c+"_address_postalcode"]=b.gd$postcode.$t,d++);b.gd$region&&a[c+"_address_state"]!=b.gd$region.$t&&(a[c+"_address_state"]=b.gd$region.$t,d++);b.gd$street&&a[c+"_address_street"]!=b.gd$street.$t&&(a[c+"_address_street"]=
b.gd$street.$t,d++);b.gd$housename&&a[c+"_address_street_2"]!=b.gd$neighborhood.$t&&(a[c+"_address_street_2"]=b.gd$neighborhood.$t,d++);b.gd$neighborhood&&a[c+"_address_street_3"]!=b.gd$city.$t&&(a[c+"_address_street_3"]=b.gd$city.$t,d++);return d}
function Tq(a,b,c){function d(d,g){!a[c+g]||b[d]&&b[d].$t==a[c+g]||(e++,b[d]={$t:a[c+g]})}var e=0;if(!a)return 0;b||(b={});d("gd$city","_address_city");d("gd$country","_address_country");d("gd$postcode","_address_postalcode");d("gd$region","_address_state");d("gd$street","_address_street");d("gd$neighborhood","_address_street_2");d("gd$city","_address_street_3");return e}
function Uq(a,b){var c=0;!a.title||b.name&&b.name==a.title.$t||(b.name=a.title.$t,c++);for(var d=0;a.gd$email&&d<a.gd$email.length;d++){var e=a.gd$email[d];"http://schemas.google.com/g/2005#work"==e.rel?b.email1!=e.address&&(c++,b.email1=e.address):"http://schemas.google.com/g/2005#home"==e.rel?b.email2!=e.address&&(c++,b.email2=e.address):"http://schemas.google.com/g/2005#other"==e.rel&&b.email!=e.address&&(c++,b.email=e.address)}a.gd$name?(a.gd$name.gd$namePrefix&&b.salutation!=a.gd$name.gd$namePrefix.$t&&
(c++,b.salutation=a.gd$name.gd$namePrefix.$t),a.gd$name.gd$givenName&&b.first_name!=a.gd$name.gd$givenName.$t&&(b.first_name=a.gd$name.gd$givenName.$t,c++),a.gd$name.gd$familyName&&b.last_name!=a.gd$name.gd$familyName.$t&&(b.last_name=a.gd$name.gd$familyName.$t,c++),a.gd$name.gd$fullName&&b.full_name!=a.gd$name.gd$fullName.$t&&(b.full_name=a.gd$name.gd$fullName.$t,c++)):b.full_name=a.title.$t;a.gd$organization&&a.gd$organization[0]&&(d=a.gd$organization[0],d.gd$orgTitle&&d.gd$orgTitle.$t!=b.title&&
(b.title=d.gd$orgTitle.$t,c++),d.gd$orgDepartment&&d.gd$orgDepartment.$t!=b.department&&(b.department=d.gd$orgDepartment.$t,c++),d.gd$orgJobDescription&&d.gd$orgJobDescription.$t!=b.description&&(b.description=d.gd$orgJobDescription.$t,c++));if(a.gd$im)for(d=0;d<a.gd$im.length;d++)"Twitter"==a.gd$im[d].label&&b.twitter!=a.gd$im[d].address?(b.twitter=a.gd$im[d].address,c++):"Facebook"==a.gd$im[d].label&&b.facebook!=a.gd$im[d].address?(b.facebook=a.gd$im[d].address,c++):"Google Plus"==a.gd$im[d].label&&
b.googleplus!=a.gd$im[d].address?(b.googleplus=a.gd$im[d].address,c++):"Linkedin"==a.gd$im[d].label&&b.linkedin!=a.gd$im[d].address&&(b.linkedin=a.gd$im[d].address,c++);a.gContact$birthday&&b.birthdate!=a.gContact$birthday.when&&(b.birthdate=a.gContact$birthday.when,c++);for(d=0;a.gd$phoneNumber&&d<a.gd$phoneNumber.length;d++)if(e=a.gd$phoneNumber[d],e.$t)if("http://schemas.google.com/g/2005#mobile"==e.rel)b.phone_mobile!=e.$t&&(b.phone_mobile=e.$t,c++);else if("http://schemas.google.com/g/2005#work"==
e.rel)b.phone_work!=e.$t&&(b.phone_work=e.$t,c++);else if("http://schemas.google.com/g/2005#home"==e.rel)b.phone_home!=e.$t&&(b.phone_home=e.$t,c++);else if("http://schemas.google.com/g/2005#fax"==e.rel||"http://schemas.google.com/g/2005#home_fax"==e.rel||"http://schemas.google.com/g/2005#work_fax"==e.rel)b.phone_fax!=e.$t&&(b.phone_fax=e.$t,c++);else if(b.phone_other=e.$t)b.phone_other=e.$t,c++;if(a.gd$structuredPostalAddress){for(var f=e=-1,d=0;d<a.gd$structuredPostalAddress.length;d++){var g=a.gd$structuredPostalAddress[d];
"http://schemas.google.com/g/2005#work"==g.rel||g.primary?e=d:f=d}-1==e&&(f=-1);c+=Sq(b,a.gd$structuredPostalAddress[e],"primary");c+=Sq(b,a.gd$structuredPostalAddress[f],"alt")}return c}
function Vq(a,b){function c(a,c){if(g[a]){b.gd$phoneNumber||(b.gd$phoneNumber=[]);var d;a:{for(d=0;b.gd$phoneNumber&&d<b.gd$phoneNumber.length;d++)if(b.gd$phoneNumber[d].rel==c){d=b.gd$phoneNumber[d];break a}d=null}d?d.$t!=g[a]&&(d.$t=g[a],k++):(b.gd$phoneNumber.push({rel:c,$t:g[a]}),k++)}}function d(a){b.gd$im||(b.gd$im=[]);for(var c=0;c<b.gd$im.length;c++)if(b.gd$im[c].label==a)return b.gd$im[c];return null}function e(){b.gd$name||(b.gd$name={},k++)}function f(a,c){if(g[a]){b.gd$email||(b.gd$email=
[]);var d;a:{for(d=0;b.gd$email&&d<b.gd$email.length;d++)if(!(0<=l.indexOf(d))&&b.gd$email[d].address==g[a])break a;d=-1}if(0<=d){var e=b.gd$email[d];e.rel!=c&&(k++,e.rel=c);l.push(d)}else b.gd$email.push({rel:c,address:g[a]}),l.push(b.gd$email.length-1),k++}}var g=a.g,k=0;!g.name||b.title&&b.title.$t==g.name||(b.title={$t:g.name},k++);var l=[];f("email1","http://schemas.google.com/g/2005#work");f("email2","http://schemas.google.com/g/2005#home");f("email","http://schemas.google.com/g/2005#other");
g.salutation&&(e(),b.gd$name.gd$namePrefix&&b.gd$name.gd$namePrefix.$t==g.salutation||(b.gd$name.gd$namePrefix={$t:g.salutation},k++));g.first_name&&(e(),b.gd$name.gd$givenName&&b.gd$name.gd$givenName.$t==g.first_name||(b.gd$name.gd$givenName={$t:g.first_name},k++));g.last_name&&(e(),b.gd$name.gd$familyName&&b.gd$name.gd$familyName.$t==g.last_name||(b.gd$name.gd$familyName={$t:g.last_name},k++));g.full_name&&(e(),b.gd$name.gd$fullName&&b.gd$name.gd$fullName.$t==g.full_name||(b.gd$name.gd$fullName=
{$t:g.full_name},k++));if(g.twitter){var m=d("Twitter");m?m.address!=g.twitter&&(m.address=g.twitter,k++):(b.gd$im.push({label:"Twitter",address:g.twitter}),k++)}g.facebook&&((m=d("Facebook"),m)?m.address!=g.facebook&&(m.address=g.facebook,k++):(b.gd$im.push({label:"Facebook",address:g.facebook}),k++));g.googleplus&&((m=d("Google Plus"),m)?m.address!=g.googleplus&&(m.address=g.googleplus,k++):(b.gd$im.push({label:"Google Plus",address:g.googleplus}),k++));g.linkedin&&((m=d("Linkedin"),m)?m.address!=
g.linkedin&&(m.address=g.linkedin,k++):(b.gd$im.push({label:"Linkedin",address:g.linkedin}),k++));!g.birthdate||b.gContact$birthday&&b.gContact$birthday.when==g.birthdate||(b.gContact$birthday={when:g.birthdate},k++);c("phone_mobile","http://schemas.google.com/g/2005#mobile");c("phone_work","http://schemas.google.com/g/2005#work");c("phone_home","http://schemas.google.com/g/2005#home");c("phone_fax","http://schemas.google.com/g/2005#work_fax");c("phone_other","http://schemas.google.com/g/2005#other");
for(var n=-1,m=-1,p=0;b.gd$structuredPostalAddress&&p<b.gd$structuredPostalAddress.length;p++)-1==n&&"true"==b.gd$structuredPostalAddress[p].primary||"http://schemas.google.com/g/2005#work"==b.gd$structuredPostalAddress[p].rel?n=p:-1==m&&(m=p);-1==n&&0<=m&&(n=m,b.gd$structuredPostalAddress[n].primary="true",m=-1);0<=n?k+=Tq(g,b.gd$structuredPostalAddress[n],"primary"):(n={primary:"true",rel:"http://schemas.google.com/g/2005#work"},p=Tq(g,n,"primary"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=
[]),b.gd$structuredPostalAddress.push(n),k+=p));0<=m?k+=Tq(g,b.gd$structuredPostalAddress[m],"alt"):(n={},p=Tq(g,n,"alt"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=[]),b.gd$structuredPostalAddress.push(n),k+=p));return k};function Wq(a){if(u(a))return a.map(function(a){return Wq(a)});if(A(a)){var b={},c;for(c in a.name_value_list)b[c]=a.name_value_list[c].value;return b}throw Error("Invalid name_value_entries");};function Xq(a,b,c,d,e){c=ra(c,"http")?new vd(c):wd(xd(new vd,c),"https");Bd(c,"");Ad(c,null);this.n=c.M();this.K=b;this.I=c.toString().replace(/\/$/,"");this.P=this.I+"/service/v4/rest.php";this.i=d;this.l=e;this.g=null;this.j=a;this.V=new Lq(this.n);this.db=new Xn(this.n,Pq(this.V));this.h=null;this.o=this.s=NaN;this.H=!1;this.history=new Io(this.db)}E(Xq,jo);h=Xq.prototype;h.M=function(){return this.n};
h.request=function(a,b,c,d,e,f){function g(){m.execute(function(g,k){this.s=D();if(!f&&g&&11==g.number)this.Yc().t(function(){this.request(a,b,c,d,e,!0)},function(){d.call(e,null,new aj(0,null,{},"Login fail"))},this);else{var l=g;if(x(l))try{g=JSON.parse(l)}catch(m){}d.call(e,g,k)}},this)}for(var k="{",l=0;l<b.length;l++)k+=(0==l?"":",")+'"'+b[l]+'":'+JSON.stringify(c[l]);k+="}";l=new Cd;l.add("method",a);l.add("input_type","json");l.add("response_type","json");l.add("rest_data",k);zo();var m=this.j.request(new ei(this.P,
"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},l.toString())),k=D()-this.s;0<k&&100>k?(this.s=100+this.s,Q(this.logger,"request will call after "+k+" ms."),of(g,k,this)):g.call(this)};
function Yq(a,b,c){var d=["session","module_name"];a=[a.g?a.g.id:null,c.module_name];var e=[!1,!1];if("get_entry_list"==b)b=c.query||"",d.push("query"),a.push(b),e.push(""==b),d.push("order_by"),b=c.order_by||"",a.push(b),e.push(""==b),b=c.offset||0,d.push("offset"),a.push(b),e.push(0==b),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length),b=c.max_results||25,d.push("max_results"),
a.push(b),e.push(null!=c.max_results),b=c.deleted||0,d.push("deleted"),a.push(b),e.push(0==b),c=!!c.favorites,d.push("favorites"),a.push(c),e.push(!1==c);else if("get_available_modules"==b)c=c.filter||"",d.push("filter"),a.push(c),e.push(0==c.length);else if("get_module_fields"==b)c=c.fields||[],d.push("fields"),a.push(c),e.push(0==c.length);else if("get_entries"==b)b=c.ids||[],d.push("ids"),a.push(b),e.push(!1),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||
[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length);else for(var f in c)"module_name"!=f&&(d.push(f),a.push(c[f]),e.push(!1));for(c=e.length-1;0<=c;c--)if(e[c])d.pop(),a.pop();else break;return{keys:d,values:a}}
function Zq(a,b){var c=b.module_name;a.o=D();return $q(a,"get_entry_list",b).B(function(a){var e=a.result_count,f=a.offset||0,g=a.entry_list,k=parseInt(a.next_offset,10);if(t(e)&&u(g)){if(0<g.length){a=Wq(g);var l=this.K,m=this.M(),n=a;if(l.Ea)for(var n=u(n)?n:[n],p=0;p<n.length;p++)n[p]&&ar(l,new Qq(m,c,n[p]));this.db.put(c,a)}return 0<g.length&&e>=g.length&&k>f?(b.offset=k,Zq(this,b)):k}throw Error("Invalid REST respond on entry list query on "+c+": "+JSON.stringify(a));},a)}
function br(a,b){if(-1==nq.indexOf(b))return tb("module name "+b+" invalid.");var c={module_name:b},d="module/"+b;return a.db.get("Meta",d).B(function(a){return a?a:$q(this,"get_module_fields",c).B(function(a){this.db.put("Meta",a,d);return a},this)},a)}
function cr(a,b){var c=new Zj(b,"date_modified",null,!0);return a.db.keys(c,1).B(function(a){var c={};a[0]&&(c.query=b.toLowerCase()+".date_modified>'"+a[0]+"'");c.module_name=b;c.order_by="date_modified";a=Zq(this,c);a.t(function(a){this.logger.info(this+" module "+b+" synced, "+a+" records updated.")},function(){O(this.logger,this+" module "+b+" failed.")},this);return a},a)}
function $q(a,b,c,d){var e=d||0,f=new F;if(!a.g||!a.g.id)return 2>e?(Q(a.logger,"Request require login, tried "+e),a.Yc().B(function(){e++;qb($q(a,b,c,e),f)})):(P(a.logger,"Cannot do request, not login. Give up after "+e+" retry"),f.w()),f;d=Yq(a,b,c);a.request(b,d.keys,d.values,function(d,k){k.Aa()?11==d.number&&/invalid/i.test(d.name)?(this.g=null,qb($q(a,b,c,e),f)):f.u(d):f.w(k.N()+" "+k.Ga())},a);return f}
h.list=function(a){if(!u(a)||0==a.length)return tb("invalid query");for(var b=[],c=0;c<a.length;c++){var d=a[c];if(!A(d))return tb("invalid query at "+c+"");var e=d.store;if(-1==oq.indexOf(e))return tb("invalid store name at "+c+": "+e);var f=d.index;if(!x(f)||0==f.length)return tb("index name missing in "+e);var g=null;null!=d.key?(g=d.key,"ydn$phones"==f?g=nn(g):"ydn$emails"==f&&(g=g.toLowerCase()),g=d.prefix?qj(g):U.only(g)):null!=d.keyRange&&(g=rj(d.keyRange));"id"==f?b.push(this.db.values(e,
g)):cm(this.db,e,f)?b.push(this.db.values(e,f,g)):b.push(sb([]))}return(new rm(b)).t(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].result=b[c][1]:(O(this.logger,"query "+c+" failed."),a[c].result=[]);return a},function(b){O(this.logger,"list failed "+b);return a},this)};
h.search=function(a){if(!u(a)||0==a.length)return tb("invalid query");for(var b=[],c=Pq(this.V),d=0;d<a.length;d++){var e=a[d];if(!A(e))return tb("invalid query at "+d+"");var f=e.q;if(!x(f)||0==f.length)return tb("query term missing "+d+"");var g="ft-"+e.store+"-"+(e.index||"name");0<=Ua(c.fullTextCatalogs,function(a){return a.name==g})?(f=this.db.search(g,e.q),e.fetchFull&&(f=f.B(function(a){if(0<a.length){for(var b=[],c=0;c<a.length;c++)b.push(new vk(a[c].storeName,a[c].primaryKey));return this.db.values(b)}},
this)),b.push(f)):b.push(sb([]))}return(new rm(b)).t(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].result=b[c][1]:(O(this.logger,"query "+c+" failed."),a[c].result=[]);return a},function(b){O(this.logger,"list failed "+b);return a},this)};function dr(a,b){var c=b.store;if(!x(c)||0==c.length)return tb("store name required.");var d=b.id;return x(d)&&0!=d.length?a.db.get(c,d):tb("id required.")}
function er(a){if(a.h&&a.h.isLogin)return sb(a.h);var b=new F;a.db.get("Meta","info/server").da(function(a){a&&a.version?(this.h=a,b.u(a)):this.request("get_server_info",[],[],function(a,c){if(0==c.N())this.h=null,b.w("service "+this.P+" not responding");else if(c.Aa()){var f=cj(c);if((!a||!a.version)&&x(f))try{a=JSON.parse(f)}catch(g){a=cj(c)}a&&a.version?(f=a,this.h=rc(f),b.u({info:f,about:fr(this)}),this.db.put("Meta",f,"info/server")):(this.h=null,b.w("invalid respond "+cj(c)))}else this.h=null,
b.w("request fail "+c.N()+" "+c.Ga())},this)},a);return b}function gr(a){var b=new F;a.request("get_available_modules",["filter"],["all"],function(a){b.u(a)},a);return b}function fr(a){var b=a.j,b=b instanceof mo&&/proxy/.test(b.h);return{baseUrl:a.I,domain:a.M(),userName:a.i,isLogin:a.isLogin(),hostPermission:!b}}function hr(a){return(new rm([er(a),gr(a)])).B(function(a){return{serverInfo:a[0][1],availableModules:a[1][1],about:fr(this)}},a)}
function ir(a,b,c){var d=[],e;for(e in c)d.push({name:e,value:c[e]});c={module_name:b,name_value_list:d};window.console.log("set_entry",c);return $q(a,"set_entry",c).B(function(a){if(a&&a.id){var c={id:a.id};a=a.entry_list||{};for(var d in a)c[d]=a[d].value;window.console.log("set_entry result",c);this.db.put(b,c);return c}throw Error("creating "+b+" entry fail");},a)}
function jr(a,b,c){window.console.log(b,c);if(c){var d=kr(b,a.M(),void 0,c.id),e=d.X,f=new Qq(a.M(),e,c);P(a.logger,"synchronizing "+b+" to "+f);if((f.g?+new Date(f.g.date_modified):NaN)==d.h){var g=new Go("update-gdata-record");Ho(g,c);b=b.data;A(b)&&Zl(b);Uq(b,c)&&ir(a,e,c).t(function(a){A(a)?g.g=Zl(a):g.g=a;this.history.add(g)},function(a){O(this.logger,"Fail to put record "+c.id+" to server "+a.message)},a)}}}
function lr(a,b){for(var c=mr(b),d=0;d<c.length;d++)0<=oq.indexOf(c[d].X)&&a.db.get(c[d].X,c[d].g).B(function(a){jr(this,b,a)},a)}function nr(a,b,c){var d={};Uq(c,d);return ir(a,b,d)}h.isLogin=function(){return!(!this.g||!this.g.id)};
h.update=function(){if(this.j&&this.j instanceof mo)this.logger.info(this+" updating skipped since no direct connection is not available.");else{var a;if(this.H)df(this.logger,"Modules are already updating now at "+a+" / "+oq.length);else{this.H=!0;this.o=D();a=0;var b=this,c=function(){var d=oq[a];d?(P(b.logger,"Syncing module "+d),a++,cr(b,d).da(function(){b.o=D();r.setTimeout(function(){c()},500)})):(df(b.logger,"Updating module done"),b.H=!1)};c();r.setTimeout(function(){2E3<b.o-D()&&c()},2E3)}}};
h.Yc=function(a,b){a&&(this.i=a);b&&(this.l=b);if(!this.i)return tb("username required.");if(!this.l)return tb("password required.");var c=new F;this.request("login",["user_auth","application_name","name_value_list"],[{user_name:this.i,password:this.l},"Yathit CRM",{language:"",notifyonsave:"false"}],function(a,b){if(a&&a.id)this.g=rc(a),c.u(a);else if(a&&a.description)c.w(a.description+" ("+a.name+")");else{var f=b.N()+" "+b.Ga()+" "+cj(b);c.w("Login fail: "+f.substr(0,200))}},this,!0);return c};
function or(a){var b=new F;a.request("logout",[],[],function(a,d){this.g=null;d.Aa()?(O(this.logger,"Logout request fail with "+d.N()+" "+d.Ga()),b.u(!0)):b.w(d.N()+" "+d.Ga())},a,!0);return b}
function pr(a){function b(){f.request(new ei(e.toString())).execute(function(a,b){/sugarcrm/i.test(cj(b))?d.w("Look like SugarCRM web site, but REST V4 API is not available."):200==b.N()?d.w("Not a SugarCRM web site"):d.w("Invalid respond, "+b.N())})}function c(a,b){var c=new Cd;c.add("method","get_server_info");c.add("input_type","json");c.add("response_type","json");c.add("rest_data","{}");f.request(new ei(a,"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},c.toString())).execute(b)}
var d=new F;a=a.trim();ra(a,"http")||(a="https://"+a);var e=new vd(a);Bd(e,"");Ad(e,null);var f=ci("proxy"),g=e.ea();a=e.Ac;/rest.php$/.test(a)||(/index.php$/.test(a)?zd(g,a.replace("/index.php","")):zd(g,""));var k=g.toString();(function(a,b){c(a+"/service/v4/rest.php",function(a,c){if(200==c.N()){if(!a||!a.version){var d=cj(c);if(x(d))try{a=JSON.parse(d)}catch(e){b(null,c);return}else a=d}a&&a.version&&b(a,c)}else b(0,c)})})(k,function(a,f){a?(a.isLogin=!1,a.userName=null,a.domain=g.M(),a.baseUrl=
k,d.u(a)):0==a?"https"==e.mc?(wd(g,"http"),setTimeout(function(){c(g.toString(),function(a,c){c.Aa()?d.u(a):b()})},100)):d.w(f.N()+" "+f.Ga()+" "+cj(f)):b()});return d}h.toString=function(){return"SugarClient:"+this.n};function qr(a){Error.captureStackTrace?Error.captureStackTrace(this,qr):this.stack=Error().stack||"";a&&(this.message=String(a))}E(qr,Error);qr.prototype.name="ydn.gdata.error.InvalidAtomFormatError";function rr(a){Error.captureStackTrace?Error.captureStackTrace(this,rr):this.stack=Error().stack||"";a&&(this.message=String(a))}E(rr,Error);rr.prototype.name="ydn.gdata.error.IncompatibleError";var sr="atom app gd xhtml batch openSearch".split(" ");function tr(a){if(!t(this.type))throw new Kh("Abstract class cannot be instantiated.");if(x(a))a={id:{$t:a}};else if(!t(a.id)||!x(a.id.$t))throw new Fh("Invalid GDataFeed");this.id=a.id.$t;this.data=a;t(this.data.entry)?u(this.data.entry)||(this.data.entry=[this.data.entry]):this.data.entry=[];this.j={};this.n={};a=u(this.data.entry)?this.data.entry.length:0;for(var b=0;b<a;b++){var c=this.data.entry[b],c=c.id?c.id.$t:c.Jg?c.Jg.$t:"";if(0==c.length)throw new qr("entry "+b);if(0==c.match(/\w+$/)[0].length)throw new qr("entry "+
b+" of "+c);var d=c.match(/\w+$/)[0];this.j[c]=this.data.entry[b];this.n[d]=this.data.entry[b]}this.i=!0;this.H=[];this.s=new nh(function(){this.dispatchEvent(ur)},300,this);this.rg=null;this.h=NaN;this.o=void 0}E(tr,vh);var ur="i";h=tr.prototype;h.Af=function(){return this.kind};h.logger=R("ydn.gdata.Feed");
h.Xa=function(a){var b=new F;Q(this.logger,this+" receiving a task, ready: "+this.i);var c=this;this.i?(this.i=!1,b.da(function(){Q(c.logger,c+" finish the task.");c.i=!0;var a=c.H.shift();a&&a.call(this)}),a.call(this,b)):this.H.push(na(B(a,this),b));return b};h.rg=null;function vr(a){var b;if(!(b=a.rg))if(a=a.ne(),t(a)){b=a;for(var c=0;c<Vi.length;c++){var d=(0,Vi[c])(a);if(d){b=d;break}}Q(Ti,"Resolving "+a+" to "+b);b=Ui[b]||null}else b=Ui["default"];return b}h.df=function(){this.dispatchEvent("e")};
h.Uf=function(){return sr};h.Lg=function(a){a.g()||O(this.logger,"Batch submission failed. "+a.responseText)};
h.sc=function(a,b){var c=this.Uf(),d=void 0;t(c)||(c=sr);for(var e="",f=0;f<c.length;f++)var g=c[f],e=0==f?e+(' xmlns="'+qp[g]+'" '):e+(" xmlns:"+g+'="'+qp[g]+'" ');d=t(d)?"<id>"+d+"</id>":"";d=Dh("<feed"+e+">"+d+"</feed>");for(f=c=0;e=this.uc(f);f++)if(Gp(e))Ep(e,"");else if(Hp(e.data)){var g="delete"==Fp(e.data),k=!(!e.data.id||!e.data.id.$t);Ep(e,null);var l=Cp(new xp(null,"entry",e.data),d.documentElement),m=l.getElementsByTagNameNS(sp("batch"),"operation");m[0]?m=m[0]:m=l.appendChild(d.createElementNS(sp("batch"),
"operation"));l=d.createAttribute("type");l.nodeValue=g?"delete":k?"update":"insert";m.setAttributeNode(l);Ep(e,"committed");c++;a&&a.message({id:this.zf(),code:"operation: "+l.nodeValue+" "+e})}if(0==c)return df(this.logger,this+" Nothing to commit."),0;df(this.logger,this+" committing "+c+" entries.");d=Eh(d);b?(this.logger.info("Commit ignored for dry run."),window.console.log(d)):(e=B(this.Lg,this),this.K&&this.K.stop(),f=vr(this),g=this.Ee(),f.send(g,e,{method:"POST",body:d,headers:{"Content-Type":"application/atom+xml"},
params:{}}));return c};h.me=function(a){return new Dp(a)};h.uc=function(a){return 0<=a&&a<this.data.entry.length?this.me(this.data.entry[a]):null};h.yf=function(a){return(a=this.j[a])?this.me(a):null};
h.save=function(a){if(this.P){var b=this;this.l||(this.l=new nh(function(){this.Xa(function(a){var d=b.toJSON(),e=b.data.entry,f,g,k;b.P.V(function(a){a.put("ydn.gdata.feed",d).Ic(function(a){throw a;}).B(function(){f=!0});a.put("ydn.gdata.entry",e).Ic(function(a){throw a;}).B(function(a){k=a.length;g=!0})},["ydn.gdata.feed","ydn.gdata.entry"],"readwrite").t(function(){f&&g?Q(this.logger,b+": saved "+k+" entries."):Q(this.logger,b+": saved failed"+e.length+" entries.");a.u(!0)},function(a){throw a;
},this)})},1E3,this));a?ph(this.l):oh(this.l)}};
function wr(a,b,c){c=c||new F;var d=vr(a);if(!d)return O(a.logger,a+": No transport available."),c.w(Error("No transport available.")),c;d.send(b,function(b){if(200==b.status){a.h=D();b=b.Q?pf(b.Q.responseText):void 0;if(!b.feed)throw new qr("feed missing.");var d=b.feed;if(!t(d))throw b=S(d),new qr(b.substr(0,50));if(d.id.$t!=a.D())throw new rr(d.id.$t+" is not "+a.D());var g=b=0,k=u(d.entry)?d.entry:d.entry?[d.entry]:[];b=k.length;0==b&&Q(a.logger,a+": fetch return no result.");for(var l=0;l<b;l++){for(var m=
a,n=k[l],p=n instanceof Dp?n:m.me(n),q=p,s=0;s<q.qc.length;s++)null!=q.data[q.qc[s]]&&!u(q.data[q.qc[s]])&&(q.data[q.qc[s]]=[q.data[q.qc[s]]]);Ep(q,null);q=q.data;q.batch$status&&(q.batch$status=void 0);q.batch$operation&&(q.batch$operation=void 0);var q=p.D(),v=m.yf(q);(s=!!v)?v.update(p):(v=p.id.match(/\w+$/)[0],m.data.entry.push(n),m.j[q]=p.data,m.n[v]=p.data);!s&&g++}df(a.logger,a+" "+b+" ("+g+" new) entries received");a.df();(d=Jo(d,"next"))?(a.save(),oh(a.s),a.o=d.$t,wr(a,d.href,c)):(0<b&&(a.save(),
oh(a.s)),c.u(!0))}else O(a.logger,"Fetching "+b.uri+" failed: "+b.status),c.w(!1)});return c}h.toString=function(){return this.type+":"+this.id};function xr(a,b){a.xg&&b.g.set("v",a.xg);b.g.set("alt","json");b.g.set("showdeleted",!0)}
function yr(a,b){var c="lu",d=!1;if("lf"==c){if(a.h){var d=!0,e=new Date(a.h),e=e.toISOString();b.g.set("updated-min",e)}}else if("lu"==c){for(var e=0,f=-1,g,k=0;g=a.uc(k);k++)g=g.data.updated.$t,e<g&&(e=g,f=k);if(e=a.uc(f))e=new Date(e.data.updated.$t),e=new Date(1+ +e),e=e.toISOString(),b.g.set("updated-min",e)}else"lo"==c?(b.g.set("orderby","lastmodified"),a.h&&b.g.set("max-results","1")):c="no";Q(a.logger,a+" updating "+(d?"continue":"begin")+" by "+c)}h.Gh=np.prototype.ge;h.D=np.prototype.D;
h.Ih=np.prototype.Dh;h.Hh=np.prototype.Ch;h.ne=function(){return this.Ih()||""};h.zf=function(){return this.id};h.Ee=function(){return this.Hh()};function zr(a){return a.Xa(function(a){var c=new vd(this.ne());xr(this,c);yr(this,c);this.R(th,!1);wr(this,c.toString()).da(function(c){wh(this);c?a.u(!0):a.w(void 0)},this)})}h.update=function(a){return a||!0!==("undefined"==typeof this.g?null:(this.g&th)==th)?zr(this):(Q(this.logger,this+" already loaded."),sb(!1))};
h.count=function(a){if(a){a=0;for(var b,c=0;b=this.uc(c);c++)Gp(b)||"deleted"==Fp(b.data)||a++;return a}return this.data.entry.length};h.toJSON=function(){return{id:this.id,key:this.zf(),last_fetch_next_uri:this.o,last_fetch:this.h}};function Ar(a){var b,c=a.match(/^\D*0*(\d{1,2}\D)?\D*0*(.+)/);c?(b=c[1].replace(/\D/g,""),a=c[2].replace(/\D/g,"")):a=a.replace(/\D/g,"");return{nb:b,eb:a}}function Br(a,b){var c=Ar(a),d=Ar(b);if(t(c.nb)&&t(d.nb)&&0!=c.nb.length&&0!=d.nb.length&&c.nb!==d.nb)return 0;if(t(c.cb)&&0!=c.cb.length){if(t(d.cb)&&0!=d.cb.length){if(c.cb.length>=d.cb.length){for(var e=0;e<d.cb.length;e++)if(c.cb[e]!=d.cb[e])return 0;return 1}for(e=0;e<c.cb.length;e++)if(c.cb[e]!=d.cb[e])return 0}return-1}return 1}
function Cr(a,b){if(!a||!b||0==a.length||0==b.length)return 0;a=a.trim();b=b.trim();var c=Ar(a),d=Ar(b);return c.nb&&c.eb&&c.nb==d.nb&&c.eb==d.eb?6<=c.eb.length?1:4<=c.eb.length?0.8:0.4:c.eb&&4<=c.eb.length&&c.eb==d.eb?8<=c.eb.length?0.8:4<=c.eb.length?0.6:0.4:0};function Dr(a){Dp.call(this,a);a=(a=this.id.match(/https?:\/\/www.google.com\/m8\/feeds\/(group|contact|batch)s?\/([^\/]+)\/?(\w+)\/?(\w*)?/))?{Rh:"m8",kind:a[1],user_id:a[2]?a[2].replace("%40","@"):"",projection:a[3],id:a[4]}:null;window.console.assert(!!a,"Invalid m8 entry: "+this.id);this.user_id=a.user_id;window.console.assert(a.kind==this.kind,"Invalid kind: "+a.kind+" vs "+this.kind)}E(Dr,Dp);Dr.prototype.logger=R("ydn.gdata.m8.Entry");Dr.prototype.g="3.0";Dr.prototype.type="m8";function Er(a){if(!t(this.kind))throw new Kh("Abstract class cannot be instantiated.");tr.call(this,a);this.user_id=this.D()}E(Er,tr);h=Er.prototype;h.Af=function(){return this.kind};h.xg="3.0";h.type="m8";h.toString=function(){return"Feed:"+this.kind+":"+this.user_id};h.ne=function(){return"https://www.google.com/m8/feeds/"+this.Af()+"s/"+this.user_id.replace("@","%40")+"/full?v=3.0"};
h.Ee=function(){var a=Er.m.Ee.call(this);return a?a:"https://www.google.com/m8/feeds/"+this.Af()+"s/"+this.user_id.replace("@","%40")+"/full/batch?v=3.0"};var Fr=sr.concat(["gContact"]);Er.prototype.Uf=function(){return Fr};function Gr(a,b,c,d,e,f){this.scheme=a;this.domain=b;this.X=c;this.g=d;this.i=y(e)?e:NaN;this.h=y(f)?f:NaN}function Hr(a){if(!A(a)||!x(a.value))return null;var b=Ir(a.value);if(!b)return null;var c=NaN,d=NaN;if(x(a.label)){a=a.label;var e=a.indexOf("#"),f=a.indexOf("-");0<e&&0<f&&f>e&&(c=parseInt(a.substring(e,f),10),d=parseInt(a.substring(f),10))}return new Gr(b[1],b[2],b[3],b[4],c,d)}function Ir(a){return a?a.match(/(\w+):\/\/([^\/]+)\/([^\/]+)\/(.*)/):null}
Gr.prototype.T=function(){return this.scheme+"://"+this.domain+"/"+this.X+"/"+this.g};function Jr(a){Dr.call(this,a)}E(Jr,Dr);h=Jr.prototype;h.kind="contact";h.logger=R("ydn.gdata.m8.ContactEntry");h.xf=function(){return"contact"};h.getName=function(a){var b=a?"":this.hd();if(a||0==b.length)a=this.data.gd$name,A(a)&&(b=a.gd$fullName.$t||"",0==b.length&&(b=(a.gd$givenName.$t||"")+" "+(a.gd$familyName.$t||"")));return va(b)};function Kr(a){var b=a.data.gd$email;a=[];for(var b=u(b)?b:b?[b]:[],c=0;c<b.length;c++)a.push(b[c].address);return a}
function Lr(a){a=a.data.gd$phoneNumber;a=u(a)?a:A(a)?[a]:[];for(var b=[],c=0;c<a.length;c++)a[c].$t&&!ta(a[c].$t)&&b.push(a[c].$t);return b}h.Ge=function(){var a=Jr.m.Ge.call(this);if(a.ydn$emails||a.ydn$xp||a.ydn$externalIds)a==this.data&&(a=Zl(this.data)),delete a.ydn$emails,delete a.ydn$xp,delete a.ydn$externalIds;return a};h.qc="link category gd$email gd$im gd$organization gd$phoneNumber gd$structuredPostalAddress gd$formattedAddress".split(" ");
function Mr(a,b){function c(a){var b=Ta(e,function(b){return b.address===a.address});b?b.rel=t(a.rel)?a.rel:b.rel:d(a)}function d(a){a=Zl(a);f&&delete a.primary;t(void 0)&&(a.rel=void 0);e.push(a)}for(var e=[Zl(a.data.gd$email[0])],f=!!a.data.gd$email[0].primary,g=1;g<a.data.gd$email.length;g++)c(a.data.gd$email[g]);for(g=0;g<b.length;g++)c(b[g]);g=Gl(e,a.data.gd$email);g||(a.data.gd$email=e);return!g}
function Nr(a,b){function c(a){var b=Qa(e,function(b){return Cr(b.$t,a.$t)}),c=Vh(b);if(0.4<c.value){var b=e[c.index],f=t(a.rel)?a.rel:b.rel;1==c.value?(b.rel=f,b.$t=a.$t):t(a.rel)&&t(b.rel)&&b.rel!==a.rel?d(a,f):(b.rel=f,c=Br(b,a),-1==c?b.$t=a.$t:0==c&&(b.$t=a.$t))}else d(a)}function d(a,b){a=Zl(a);f&&delete a.primary;t(b)&&(a.rel=b);e.push(a)}for(var e=[Zl(a.data.gd$phoneNumber[0])],f=!!a.data.gd$phoneNumber[0].primary,g=1;g<a.data.gd$phoneNumber.length;g++)c(a.data.gd$phoneNumber[g]);for(g=0;g<
b.length;g++)c(b[g]);g=Gl(e,a.data.gd$phoneNumber);g||(a.data.gd$phoneNumber=e);return!g}h.lf=function(a,b){if("gd$phoneNumber"==a){if(null!=this.data.gd$phoneNumber)return Nr(this,b);this.data.gd$phoneNumber=Zl(b);return!0}if("gd$email"==a){if(null!=this.data.gd$email)return Mr(this,b);this.data.gd$email=Zl(b);return!0}return Jr.m.lf.call(this,a,b)};
function kr(a,b,c,d){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var e=0;e<a.length;e++){var f=Hr(a[e]);if(f&&!("sugarcrm"!=f.scheme||b&&b!=f.domain||d&&d!=f.g||c&&c!=f.X))return f}return null}function mr(a){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var b=[],c=0;c<a.length;c++){var d=Hr(a[c]);d&&b.push(d)}return b};function Or(a){Er.call(this,a)}E(Or,Er);h=Or.prototype;h.logger=R("ydn.gdata.m8.ContactFeed");h.kind="contact";h.df=function(){Or.m.df.call(this)};h.yf=function(a){return Or.m.yf.call(this,a)};h.me=function(a){return new Jr(a)};h.uc=function(a){return Or.m.uc.call(this,a)};h.ne=function(){return"https://www.google.com/m8/feeds/contacts/"+this.D()+"/full"};h.zf=function(){return"http://www.google.com/m8/feeds/contacts/"+this.D().replace("@","%40")};function Pr(a){function b(a){ra(a,"atom:")&&(a=a.substring(5,a.length));return a.replace("#text","$t").replace(/:/g,"$")}x(a)&&(a=Dh(a));var c={};if(1==a.nodeType){if(0<a.attributes.length)for(var d=0;d<a.attributes.length;d++){var e=a.attributes.item(d);c[b(e.nodeName)]=e.nodeValue}}else 3==a.nodeType&&(c=a.nodeValue);if(a.hasChildNodes())for(d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d),f=b(e.nodeName);if("undefined"==typeof c[f])"content"==f?(c[f]={$t:Eh(e)},e.namespaceURI&&(c[f].xmlns=
e.namespaceURI)):c[f]=Pr(e);else{if("undefined"==typeof c[f].length){var g=c[f];c[f]=[];c[f].push(g)}c[f].push(Pr(e))}}return c};function Qr(a,b){this.id=b.replace("@","%40");this.client=this.g=null;this.i=new qh(function(){df(this.logger,"updating gdata "+this);Rr(this).t(function(a){this.logger.info(this+" synced, "+a+" new entries updated.")},function(){O(this.logger,this+" update failed.")},this)},6E4,this);this.j=a;this.h=null}h=Qr.prototype;h.logger=R("ydn.ds.gdata.GData");h.update=function(){rh(this.i)};h.J=function(){return this.j};function Sr(a){var b=new F;a.execute(function(a,d){a?b.u(a):b.w(d)});return b}
function Tr(a,b){var c=(a.client?a.client:ci("gse")).request(b);return Sr(c).t(function(a){a=a.feed;if(!a.entry)return 0;for(var b=(new Or(a)).Gh("next"),c=a.entry.length,g=!!this.h,k=0;g&&k<c;k++){var l=a.entry[k];l.gContact$externalId&&this.h(l)}return this.J().put(this.F(),a.entry).B(function(){return b?Tr(this,new ei(b.href)).B(function(a){return c+a},this):c},this)},function(a){O(this.logger,"fetching fail "+(a?a.N()+" "+a.Ga():""))},a)}h.getParams=function(){return{alt:"json"}};
h.get=function(a){return x(a)&&0!=a.length?this.J().get(this.F(),a):tb("invalid key")};h.put=function(a){return this.J().put(this.F(),a)};h.wg=function(a){return new Dp(a)};function Ur(a,b){return a.wg(b).sc().B(function(a){a=Pr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+Ah(a));this.J().put(this.F(),b);return b},a)}
function Rr(a){if(!a.J().getName())return tb(Error("database not ready"));if(!a.g){var b=new Zj(a.F(),"updated.$t",null,!0);a.g=a.J().keys(b,1).B(function(a){var b=this.getParams();b.orderby="lastmodified";a[0]?(b.sortorder="descending",a=(new Date(1+ +new Date(a[0]))).toISOString(),b["updated-min"]=a):b.sortorder="ascending";return Tr(this,new ei(Vr(this)+"/full","GET",b)).da(function(){this.g=null},this)},a)}return a.g}h.toString=function(){return"GData:contact:"+this.id.replace("%40","@")};function Wr(a,b){Qr.call(this,a,b)}E(Wr,Qr);Wr.prototype.F=function(){return"contact"};Wr.prototype.getParams=function(){var a=Wr.m.getParams.call(this);a.v="3.0";return a};function Vr(a){return"https://www.google.com/m8/feeds/contacts/"+a.id}Wr.prototype.wg=function(a){var b=!!a.id;b||(a.id={$t:Vr(this)+"/base/0"});var c=new Jr(a);b||delete a.id;return c};function Xr(a,b){return b&&0!=b.length?a.J().values(a.F(),"ydn$emails",U.only(b),100,0,!1,!0):sb([])}
function Yr(a,b){var c=U.only(b.T());return a.J().values(a.F(),"ydn$externalIds",c).B(function(){},a)}
function Zr(a,b,c){return a.J().get(a.F(),b).B(function(a){if(a){if(!c||!c.label||!c.value)return tb("invalid external_id_data");var e=c.label,f=c.value;a.gContact$externalId=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var g=new Jr(a),k=!1,l=0;l<a.gContact$externalId.length;l++)if(a.gContact$externalId[l].value==f){a.gContact$externalId[l].label=e;k=!0;break}k||a.gContact$externalId.push({label:e,value:f});Ep(g,"modified");return g.sc().B(function(a){a=
Pr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+Ah(a));this.J().put(this.F(),b);return b},this)}throw Error("gdata entry "+b+" not found");},a)};function $r(a){this.g=a;this.i=0;this.j=[];this.l=[0,0,0,0];this.h=new Kinetic.Layer;a=this.g/2;var b=a/3;this.n=[a,a,b,this.g-b];this.o=[a,b,this.g-b,this.g-b]}$r.prototype.clear=function(){this.h=new Kinetic.Layer};var as=Math.pow(2,2),bs=Math.pow(2,3),cs=Math.pow(2,4),ds=Math.pow(2,5);$r.prototype.R=function(a,b){this.i=b?this.i|a:this.i&~a};
function es(a){a.clear();for(var b=[["#C2C2C2","#6B6B6B","#525252","#3D3D3D"],["#FAFAFA","#D8D8D8","#D8D8D8","#C2C2C2"],["#FCCA03","#DD1812","#0140CA","#16A61E"]],c=["m252,324c0,-59.647 48.354,-108 108,-108c26.90799,0 51.51501,9.843 70.42401,26.121c1.03198,-8.564 1.57599,-17.27901 1.57599,-26.121c0,-119.126 -96.43701,-215.722 -215.49899,-215.994c40.89099,0.137 73.99899,33.321 73.99899,74.244c0,41.007 -33.24301,74.25 -74.25,74.25c-41.008,0 -74.25,-33.243 -74.25,-74.25c0,-40.979 33.19701,-74.203 74.16701,-74.248c-0.05602,0 -0.11201,-0.002 -0.16701,-0.002c-119.294,0 -216,96.707 -216,216c0,8.843 0.544,17.55701 1.577,26.121c18.908,-16.278 43.515,-26.121 70.423,-26.121c59.646,0 108,48.353 108,108c0,37.93399 -19.561,71.29401 -49.14301,90.56c26.127,11.21701 54.90701,17.44 85.14301,17.44s59.01599,-6.22299 85.14301,-17.44c-29.582,-19.26599 -49.14301,-52.62601 -49.14301,-90.56z",
"m142,74.25c0,41.007 33.242,74.25 74.25,74.25c41.00699,0 74.25,-33.243 74.25,-74.25c0,-40.923 -33.108,-74.107 -73.99899,-74.244c-0.112,0 -0.22301,-0.004 -0.334,-0.004c-40.97,0.045 -74.16701,33.269 -74.16701,74.248z","m180,324c0,-59.647 -48.354,-108 -108,-108c-26.908,0 -51.515,9.843 -70.424,26.121c9.366,77.69 59.967,142.67798 129.28099,172.43799c29.582,-19.26498 49.14301,-52.625 49.14301,-90.55899z","m430.42401,242.121c-18.909,-16.278 -43.51602,-26.121 -70.42401,-26.121c-59.646,0 -108,48.353 -108,108c0,37.93399 19.561,71.29401 49.142,90.56c69.315,-29.76199 119.91602,-94.74899 129.28201,-172.439z"],
d=b[0].slice(),e=[as,bs,cs,ds],f=0;f<e.length;f++){var g=e[f];(a.i&g)==g&&(d[f]=b[2][f])}b=new Kinetic.Group({scaleX:a.g/435,scaleY:a.g/435});e=new Kinetic.Group;for(f=0;f<c.length;f++)a.j[f]=new Kinetic.Path({data:c[f],fill:d[f]}),0<a.l[f]&&(g=a.g/19*8,g=new Kinetic.Text({x:a.n[f]-g/4,y:a.o[f]-g/2,text:String(a.l[f]),fontSize:g,fontFamily:"sans-serif",fill:"white"}),e.add(g)),b.add(a.j[f]);a.h.add(b);a.h.add(e);return a.h};function fs(a){this.g=document.createElement("div");this.h=a||19;this.i=new $r(this.h);this.j=new nh(function(){this.render()},100,this);chrome.runtime.onSuspend&&chrome.runtime.onSuspend.addListener(function(){chrome.browserAction.setTitle({title:"suspended"});this.R(bs,!1);this.R(cs,!1);this.R(ds,!1);this.R(as,!1);this.render()}.bind(this))}fs.prototype.p=function(){return this.g};fs.prototype.R=function(a,b){this.i.R(a,b);ph(this.j)};
fs.prototype.render=function(){this.g.parentElement||document.body.appendChild(this.g);(new Kinetic.Stage({container:this.g,width:this.h,height:this.h})).add(es(this.i));if(chrome.browserAction){var a=this.g.querySelector("canvas"),b=a.getContext("2d");chrome.browserAction.setIcon({imageData:b.getImageData(0,0,a.width,a.height)})}};function gs(a,b){this.g=a;this.filter=b||null;var c=this;setTimeout(function(){hs(c)},6E5*Math.random())}
function hs(a){var b=a.g.getName(),c={"Content-Type":"application/json"};a.g.values("log",null,20).B(function(a){if(0!=a.length){var e=a.map(function(a){return a.key});a=JSON.stringify(a);a=new ei("https://mhardartway.s3.amazonaws.com/"+(b+"/"+e[0]),"PUT",null,c,a);var f=ci(),e=e.map(function(a){return new vk("log",a)});f.request(a).execute(function(a,b){b.Aa()&&this.g.remove(e).B(function(a){a==e.length&&hs(this)},this)},this)}},a)}gs.prototype.log=function(){};function is(){this.g={};this.Ea=null;this.H=new ai;Xh(this.H);this.s=new Yn;this.h=this.n=this.j=this.o=null;this.I=new xg(new Bg,"XMLHttpRequest"+location.host);this.l=new fs;var a=this,b=D();gj=Ri=new gs(Ao,function(c){if(!c||c.HttpRequestData&&"https://mail.google.com/mail/feed/atom/bazinga"==c.HttpRequestData.path)return null;a.h&&a.h.Id&&(c.id=a.h.Id.$t);c.uptime=b;return c});chrome.permissions.onAdded.addListener(this.jh.bind(this))}h=is.prototype;h.logger=R("ydn.crm.app.App");
h.jh=function(a){for(var b=(a=a.origins)?a.length:0,c=0;c<b;c++){var d=a[c].match(/https:\/\/([^\/]+)/);if(d){var d=d[1],e=this.g[d];if(e&&(df(this.logger,"host permission granted to "+e),e.j instanceof mo)){var f=ci("default");this.g[d]=new Xq(f,e.K,e.I,e.i,e.l);this.g[d].update()}}}};h.init=function(){P(this.logger,"init "+this);this.l.R(as,!0);wo||(Do(),wo=new oo(zo(),void 0,"https://yathit-app.appspot.com",1,!0),Zi(wo,di))};
function js(a,b){function c(a){return a.Yc().B(function(){var b=a.isLogin()?a.i+"@":" (not login) ";this.logger.info("connected to sugarcrm client: "+b+e);a.isLogin()&&(this.g[e]=a,this.I.set(k,l),b=Object.keys(this.g),eo(this.s,b),a.update(),ks(this));return fr(a)},this)}var d=b.baseUrl,e=b.domain||d;if(!e)return tb("domain or url required.");e=e.trim();ra(e,"http")&&(e=(new vd(e)).M());/\//.test(e)&&(e=(new vd("https://"+e)).M());if(d&&(d=d.trim(),!ra(d,"http"))){var d=d.replace(/:?\/\//,""),f=
new vd("https://"+d);f.Ac||zd(f,"/");d=f.toString()}var g=a.g[e],k="sugar-client-"+e,l=a.I.get(k)||{};if(g)return g.isLogin()?sb(fr(g)):c.call(a,g);var m=b.userName||l.userName;d||(d=l.base_url);d||(d="https://"+e+"/");if(!m)return P(a.logger,"username not found in "+JSON.stringify(b)),tb("username required");var n=b.password;n?b.hashed||(n=CryptoJS.MD5(n).toString()):n=l.password;if(!n)return P(a.logger,"password not found in "+JSON.stringify(b)),tb("password required.");l.userName=m;l.password=
n;l.base_url=d;var p=new F;chrome.permissions.contains({origins:[d]},function(b){b=b?ci("default"):ci("proxy");g=new Xq(b,a,d,m,n);qb(c.call(a,g),p)});return p}function ls(a,b,c,d){return 0<=nq.indexOf(b)?a.Ea.get(c).B(function(a){if(a){var f=nq[nq.indexOf(b)];return nr(d,f,a).B(function(a){if(a&&a.id)return a;throw Error("Set Entry to "+f+" failed");},this)}throw Error("contact entry "+c+" not found");},a):tb(new Fh("invalid module name "+b))}
function ar(a,b){var c=new Gr("sugarcrm",b.M(),b.X,b.D());Yr(a.Ea,c).B(function(a){for(var c=0;c<a.length;c++){var f=a[c];0<Vq(b,f)&&this.Ea.put(f)}})}function ks(a){var b=!1,c;for(c in a.g)if(a.g[c].isLogin()){b=!0;break}a.l.R(as,!0);a.l.R(ds,a.isLogin());a.l.R(bs,b)}
function ms(a,b){if(!b)return tb("domain required");a.I.remove("sugar-client-"+b);return co(a.s).B(function(a){a=a||[];var d=a.indexOf(b);0<=d&&(a.splice(d,1),eo(this.s,a));return this.g[b]?or(this.g[b]).B(function(){delete this.g[b];this.logger.info("SugarCRM "+b+" removed.");ks(this);return!0},this):!1},a)}
h.qh=function(a){for(var b=u(a.gContact$externalId)?a.gContact$externalId:[a.gContact$externalId],c=0;c<b.length;c++)if(b[c]&&b[c].value&&b[c].label){var d=Ir(b[c].value);d&&"sugarcrm"==d[1]&&(d=d[2],this.g[d]&&lr(this.g[d],new Jr(a)))}};function ns(a){a.Ea=new Wr(a.s.g,a.h.email);var b=ci("gse");a.Ea.client=b;a.Ea.h=a.qh.bind(a);a.Ea.update()}
function os(a,b){var c=new F,d=b.email||"";if(a.h&&a.h.email==d)return P(a.logger,"already running for "+d),c.u(a.h),c;a.h=b;a.h.updated=D();d?(a.logger.info(d+" login to YDN server"),Eo(a),Zn(a.s,b.Id.$t),ns(a),co(a.s).B(function(a){a=a||[];for(var b=0;b<a.length;b++)a[b]&&js(this,{domain:a[b]})},a),c.u(a.h),a.isLogin()?(a.l.R(ds,!0),chrome.browserAction.setTitle({title:"Ready"})):(a.l.R(ds,!1),chrome.browserAction.setTitle({title:"Login required."}))):(a.logger.info("Not login to YDN server"),c.u(a.h),
a.l.R(ds,!1),chrome.browserAction.setTitle({title:"Login required."}));return c}function ps(a){var b=new F;Fo().request(new ei("/token","DELETE")).execute(function(a,d){d.Aa()?(this.j=this.o=null,b.u(null)):b.w("error "+d.Ga())},a);return b}
function qs(a,b){var c=A(b)?b:{last_login:"1"},d=Fo(),e=new F;d.request(new ei("/audit","GET",c)).execute(function(a,b){if(b.Aa()){if(a.LastLoginRecord){var c=a.LastLoginRecord;if(c.timestamp){var d;d=c.timestamp-D();d=Math.abs(d);if(6E4>d)d="0 minutes";else{var m=Math.floor(d/864E5);d%=864E5;var n=Math.floor(d/36E5),p=Math.floor(d%36E5/6E4),q=Vd(String(m)),s=Vd(String(n)),v=Vd(String(p));d=m*(n+p)?" ":"";var z=n*p?" ":"",m=He("{COUNT, plural, =0 {}=1 {{TEXT} day}other {{TEXT} days}}",m,q),n=He("{COUNT, plural, =0 {}=1 {{TEXT} hour}other {{TEXT} hours}}",
n,s),p=He("{COUNT, plural, =0 {}=1 {{TEXT} minute}other {{TEXT} minutes}}",p,v);d=m+(d+(n+(z+p)))}c.ago=d}}e.u(a)}else e.w(b)},a);return e}function mj(a,b){if(a.j)return a.j;if(a.o&&a.o.expires<D())return sb(a.o);a.j=new F;var c={url:b||chrome.extension.getURL(Yh)},c=new ei("/token","GET",c);Fo().request(c).execute(function(a,b){if(b.Aa()){var c=a.Tokens[0];c.has_token?(c.expires=1E3*c.expires_in+D(),this.o=c,this.j.u(c)):this.j.w(c)}else this.o=null,this.j.w(b);this.j=null},a);return a.j}
h.isLogin=function(){return!!this.h&&this.h.is_login};function rs(a,b){if(a.n)return a.n;a.n=bi(a.H,b).B(function(b){return os(this,b).B(function(){a.isLogin()?setTimeout(function(){a.n=null},9E5):a.n=null},function(a){this.logger.info("Attamping to login YDN server fail: "+Ah(a))})},a);return a.n}function ss(a){a.n=null;a.h=null;a.l.R(ds,!1)}h.toString=function(){return"SugarApp:0.7.0"};function ts(){is.call(this);this.i={};us(this)}E(ts,is);ts.prototype.logger=R("ydn.crm.app.EventPage");
function vs(a,b,c){var d=c.req;c.done=!0;var e=null!=c.data?c.data:{};P(a.logger,"service req: "+d+":"+c.id);if("app-setting"==d)c.data=r.localStorage.getItem("app-setting"),b.postMessage(c);else if("echo"==d)P(a.logger,"resp: "+d+":"+c.id),b.postMessage(c);else if("gdata-fetch"==d)e=c.data,"contact"==e?a.Ea?Rr(a.Ea).t(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):(c.error="gdata not ready",b.postMessage(c)):(c.error="invalid kind "+e,b.postMessage(c));
else if("gdata-list-contact-by-email"==d)Xr(a.Ea,c.data).B(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token"==d)mj(a,c.data).da(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("feed-log"==d){var f=e.offset||0,e=e.limit||100;to.g.values("db-logger",null,e||100,f||0,!0).da(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c)}else if("feed-log-info"==d)f=
e.offset||0,e=e.limit||100,so(e,f).da(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token-revoke"==d)ps(a).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("list-sugarcrm"==d){e=[];for(f in a.g)e.push(fr(a.g[f]));P(a.logger,"resp: "+c.req+":"+c.id);c.data=e;b.postMessage(c)}else"log-bug"==d?(Si(c.data),
b.postMessage(c)):"login-info"==d?rs(a,c.data).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="invalid login";b.postMessage(this)},c):"logged-in"==d?(rs(a,null).B(function(b){ws(a,{req:d,info:b})}),b.postMessage(c)):"logout"==d?(ss(a),ws(a,{req:d}),b.postMessage(c)):"new-entry"==d?A(c.data)?Ur(a.Ea,c.data).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error=
"failed to create a new entry";b.postMessage(this)},c):(c.error="Invalid gdata entry data",b.postMessage(c)):"new-sugarcrm"==d?js(a,c.data).t(function(){P(a.logger,"resp: "+this.req+":"+this.id);this.data=!0;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"remove-sugar"==d?ms(a,c.data).da(function(a){this.data=a;b.postMessage(this)},c):"server-audit-log"==d?qs(a,e).t(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"sugar-server-info"==
d?(e=c.data,e=/https?:/.test(e)?new vd(e):xd(new vd,e),(e=a.g[e.M()])?er(e).B(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c):pr(c.data).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},c)):"user-setting"==d?ho().B(function(a){this.data=a;b.postMessage(this)},c):O(a.logger,"Main channel unknown req: "+d)}
function xs(a,b,c,d){var e=d.req;d.done=!0;df(a.logger,"sugar service req: "+c+":"+e+":"+d.id);if(a.isLogin())if("about"==e)d.data=fr(c),b.postMessage(d);else if("details"==e)hr(c).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d);else if("echo"==e)b.postMessage(d);else if("get"==e)dr(c,d.data).t(function(a){this.data=a;b.postMessage(this)},function(a){this.error=
a;b.postMessage(this)},d);else if("fetch-module"==e)cr(c,d.data).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id+" "+c);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d);else if("info-module"==e)br(c,d.data).t(function(c){this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d);else if("import-gdata"==e){var f=d.data,g=f?f["gdata-id"]:"";g?
(c=ls(a,f.module,g,c),c.t(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d)):(O(a.logger,"resp error: "+e+":"+d.id),d.error="gdata id required",b.postMessage(d))}else"link"==e?(c=a.Ea,(e=d.data["gdata-id"])?Zr(c,e,d.data["external-id"]).t(function(a){this.data=a;b.postMessage(this)},function(c){O(a.logger,"error linking gdata "+this.req+":"+this.id);this.error=c.name+": "+c.message;b.postMessage(this)},d):(d.error="gdata-id not required",b.postMessage(d))):
"list"==e?c.list(d.data).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d):"list-module"==e?gr(c).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):"login"==e?js(a,d.data).t(function(c){this.data=c;b.postMessage(this);ks(a)},function(a){this.error=
a;b.postMessage(this)},d):"put-record"==e?(e=d.data.module)?(f=d.data.record,A(f)?ir(c,e,f).t(function(c){this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(d.error="record object required",b.postMessage(d))):(d.error="module required",b.postMessage(d)):"search"==e?(c=c.search(d.data),c.t(function(c){this.done=!0;P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+
this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d)):"server-info"==e?er(c).t(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d):"sync-entry"==e?(e=d.data,a.Ea.get(e).t(function(c){c?new Jr(c):(c="GData entry "+this.data+" not found.",P(a.logger,c),this.error=c,b.postMessage(this))},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);
this.error=c;b.postMessage(this)},d)):"rest"==e?(g=d.data,A(g)?(f=g.method,g=g.params,x(f)&&0!=f.length?A(g)?$q(c,f,g).t(function(c){this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(d.error="REST parameter must be an object",P(a.logger,"resp: error "+e+":"+d.id),b.postMessage(d)):(d.error="method must be valid string",P(a.logger,"resp: error "+e+":"+d.id),b.postMessage(d))):(d.error="REST parameter must be an object",P(a.logger,
"resp: error "+e+":"+d.id),b.postMessage(d))):O(a.logger,c+" unknown req: "+e);else d.error="Not login",b.postMessage(d)}function ys(a){var b=!1,c;for(c in a.i)"gmail"==a.i[c].group&&(b=!0);a.l.R(cs,b)}function ws(a,b){for(var c in a.i){var d=a.i[c];"gmail"==d.group&&d.port.postMessage(b)}}ts.prototype.K=function(){return{sugars:this.g,gdata:this.Ea,ports:this.i,user_info:this.h}};
function us(a){chrome.runtime.onConnect.addListener(function(b){var c=b.sender.url,d=b.name.substr(0,b.name.lastIndexOf("-"));Va(gd,d)?(df(a.logger,"Channel "+b.name+" connected for "+c),a.i[b.name]={name:b.name,group:d,port:b},ys(a),b.onMessage.addListener(function(c){if(c&&A(c)){if("close"==c.req)a.logger.info("closing "+b.name),delete a.i[b.name],b.disconnect(),ys(a);else if(!c.id){O(a.logger,"Unknown group in pipe info "+b.name);return}if("sugarcrm"==c.group){var d=c.name,g=a.g[d];g?xs(a,b,g,
c):O(a.logger,"SugarCRM instance "+d+" not found.")}else if("gmail"==c.group)for(d in a.i)g=a.i[d],g.group!=d||c.name&&c.name!=g.name||g.port.postMessage(c);else vs(a,b,c)}else O(a.logger,"invalid message package: "+c)}),b.onDisconnect.addListener(function(){df(a.logger,"disconnected "+b.name);delete a.i[b.name];ys(a)})):O(a.logger,"channel "+b.name+" ignored from "+c)});df(a.logger,"event page start listening incoming connection")};oa("ydn.debug.log",Qi);function zs(a){K.call(this,"navigate");this.g=a}E(zs,K);function As(a){L.call(this);this.g=a||window;Dc(this.g,"popstate",this.Td,!1,this);Dc(this.g,"hashchange",this.Td,!1,this)}E(As,L);h=As.prototype;h.Je=!1;h.xh="/";h.setEnabled=function(a){a!=this.Je&&(this.Je=a)&&this.dispatchEvent(new zs(this.getToken()))};h.getToken=function(){var a=this.g.location.href,b=a.indexOf("#");return 0>b?"":a.substring(b+1)};h.G=function(){Kc(this.g,"popstate",this.Td,!1,this);Kc(this.g,"hashchange",this.Td,!1,this)};h.Td=function(){this.Je&&this.dispatchEvent(new zs(this.getToken()))};function Bs(){}da(Bs);Bs.prototype.g=0;function Cs(a){L.call(this);this.g=a||Mg();this.$d=Ds}E(Cs,L);Cs.prototype.$=Bs.Y();var Ds=null;function Es(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?"highlight":"unhighlight";case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close"}throw Error("Invalid component state");}h=Cs.prototype;h.wc=null;h.Z=!1;h.W=null;h.$d=null;h.L=null;h.Ja=null;h.Ma=null;h.jb=null;
h.tg=!1;h.D=function(){return this.wc||(this.wc="ydn:"+(this.$.g++).toString(36))};function Fs(a,b){if(a.Ja&&a.Ja.jb){var c=a.Ja.jb,d=a.wc;d in c&&delete c[d];pc(a.Ja.jb,b,a)}a.wc=b}h.p=function(){return this.W};function Gs(a){return a.l||(a.l=new jf(a))}function Hs(a,b){if(a==b)throw Error("Unable to set parent component");var c;if(c=b)if(c=a.Ja)if(c=a.wc){c=a.Ja;var d=a.wc;c=(c.jb&&d?qc(c.jb,d)||null:null)&&a.Ja!=b}if(c)throw Error("Unable to set parent component");a.Ja=b;Cs.m.rf.call(a,b)}
h.getParent=function(){return this.Ja};h.rf=function(a){if(this.Ja&&this.Ja!=a)throw Error("Method not supported");Cs.m.rf.call(this,a)};h.Ia=function(){this.W=this.g.createElement("div")};h.render=function(a){Is(this,a)};function Is(a,b,c){if(a.Z)throw Error("Component already rendered");a.W||a.Ia();b?b.insertBefore(a.W,c||null):a.g.g.body.appendChild(a.W);a.Ja&&!a.Ja.Z||a.S()}
function Js(a,b){if(a.Z)throw Error("Component already rendered");if(b&&a.Oe(b)){a.tg=!0;var c=Og(b);a.g&&a.g.g==c||(a.g=Mg(b));a.Yb(b);a.S()}else throw Error("Invalid element to decorate");}h.Oe=function(){return!0};h.Yb=function(a){this.W=a};h.S=function(){this.Z=!0;Ks(this,function(a){!a.Z&&a.p()&&a.S()})};h.qb=function(){Ks(this,function(a){a.Z&&a.qb()});this.l&&this.l.removeAll();this.Z=!1};
h.G=function(){this.Z&&this.qb();this.l&&(this.l.qa(),delete this.l);Ks(this,function(a){a.qa()});!this.tg&&this.W&&Zg(this.W);this.Ja=this.L=this.W=this.jb=this.Ma=null;Cs.m.G.call(this)};h.la=function(a){this.L=a};h.ba=function(a,b){this.qe(a,Ls(this),b)};
h.qe=function(a,b,c){if(a.Z&&(c||!this.Z))throw Error("Component already rendered");if(0>b||b>Ls(this))throw Error("Child component index out of bounds");this.jb&&this.Ma||(this.jb={},this.Ma=[]);if(a.getParent()==this){var d=a.D();this.jb[d]=a;Xa(this.Ma,a)}else pc(this.jb,a.D(),a);Hs(a,this);bb(this.Ma,b,0,a);a.Z&&this.Z&&a.getParent()==this?(c=this.Sa(),c.insertBefore(a.p(),c.childNodes[b]||null)):c?(this.W||this.Ia(),b=Ms(this,b+1),Is(a,this.Sa(),b?b.W:null)):this.Z&&!a.Z&&a.W&&a.W.parentNode&&
1==a.W.parentNode.nodeType&&a.S()};h.Sa=function(){return this.W};function Ns(a){null==a.$d&&(a.$d=Bi(a.Z?a.W:a.g.g.body));return a.$d}function Ls(a){return a.Ma?a.Ma.length:0}function Ms(a,b){return a.Ma?a.Ma[b]||null:null}function Ks(a,b,c){a.Ma&&Oa(a.Ma,b,c)}function Os(a,b){return a.Ma&&b?Na(a.Ma,b):-1};function Ps(a,b,c,d,e){if(!(H||Kb&&Wb("525")))return!0;if(Db&&e)return Qs(a);if(e&&!d)return!1;y(b)&&(b=Rs(b));if(!c&&(17==b||18==b||Db&&91==b))return!1;if(Kb&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(H&&d&&b==a)return!1;switch(a){case 13:return!(H&&H&&9<=Yb);case 27:return!Kb}return Qs(a)}
function Qs(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||Kb&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function Rs(a){if(Jb)a=Ss(a);else if(Db&&Kb)a:switch(a){case 93:a=91;break a}return a}
function Ss(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function Ts(a,b){L.call(this);a&&Us(this,a,b)}E(Ts,L);h=Ts.prototype;h.vc=null;h.Od=null;h.ef=null;h.Pd=null;h.Wa=-1;h.Mb=-1;h.te=!1;
var Vs={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},Ws={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Xs=H||Kb&&Wb("525"),Ys=Db&&Jb;h=Ts.prototype;
h.fh=function(a){Kb&&(17==this.Wa&&!a.ctrlKey||18==this.Wa&&!a.altKey||Db&&91==this.Wa&&!a.metaKey)&&(this.Mb=this.Wa=-1);-1==this.Wa&&(a.ctrlKey&&17!=a.g?this.Wa=17:a.altKey&&18!=a.g?this.Wa=18:a.metaKey&&91!=a.g&&(this.Wa=91));Xs&&!Ps(a.g,this.Wa,a.shiftKey,a.ctrlKey,a.altKey)?this.handleEvent(a):(this.Mb=Rs(a.g),Ys&&(this.te=a.altKey))};h.gh=function(a){this.Mb=this.Wa=-1;this.te=a.altKey};
h.handleEvent=function(a){var b=a.h,c,d,e=b.altKey;H&&"keypress"==a.type?c=this.Mb:Kb&&"keypress"==a.type?c=this.Mb:Ib?c=this.Mb:(c=b.keyCode||this.Mb,d=b.charCode||0,Ys&&(e=this.te),Db&&63==d&&224==c&&(c=191));d=c=Rs(c);var f=b.keyIdentifier;c?63232<=c&&c in Vs?d=Vs[c]:25==c&&a.shiftKey&&(d=9):f&&f in Ws&&(d=Ws[f]);this.Wa=d;a=new Zs(d,0,0,b);a.altKey=e;this.dispatchEvent(a)};h.p=function(){return this.vc};
function Us(a,b,c){a.Pd&&$s(a);a.vc=b;a.Od=Dc(a.vc,"keypress",a,c);a.ef=Dc(a.vc,"keydown",a.fh,c,a);a.Pd=Dc(a.vc,"keyup",a.gh,c,a)}function $s(a){a.Od&&(Lc(a.Od),Lc(a.ef),Lc(a.Pd),a.Od=null,a.ef=null,a.Pd=null);a.vc=null;a.Wa=-1;a.Mb=-1}h.G=function(){Ts.m.G.call(this);$s(this)};function Zs(a,b,c,d){cc.call(this,d);this.type="key";this.g=a}E(Zs,cc);var at;function bt(a,b){b?a.setAttribute("role",b):a.removeAttribute("role")}function ct(a,b,c){w(c)&&(c=c.join(" "));var d="aria-"+b;""===c||void 0==c?(at||(at={atomic:!1,autocomplete:"none",dropeffect:"none",haspopup:!1,live:"off",multiline:!1,multiselectable:!1,orientation:"vertical",readonly:!1,relevant:"additions text",required:!1,sort:"none",busy:!1,disabled:!1,hidden:!1,invalid:"false"}),c=at,b in c?a.setAttribute(d,c[b]):a.removeAttribute(d)):a.setAttribute(d,c)};function dt(){}var et;da(dt);h=dt.prototype;h.Hb=function(){};h.U=function(a){var b=a.g.A("div",ft(this,a).join(" "),a.ra());gt(this,a,b);return b};h.za=function(a){return a};function ht(a,b,c){if(a=a.p?a.p():a)if(H&&!Wb("7")){var d=it(Fg(a),b);d.push(b);na(c?Gg:Hg,a).apply(null,d)}else c?Gg(a,b):Hg(a,b)}h.Hd=function(){return!0};
h.ua=function(a,b){b.id&&Fs(a,b.id);var c=this.za(b);c&&c.firstChild?jt(a,c.firstChild.nextSibling?$a(c.childNodes):c.firstChild):a.Ib=null;var d=0,e=this.C(),f=this.C(),g=!1,k=!1,c=!1,l=Fg(b);Oa(l,function(a){g||a!=e?k||a!=f?d|=this.Ie(a):k=!0:(g=!0,f==e&&(k=!0))},this);a.Jb=d;g||(l.push(e),f==e&&(k=!0));k||l.push(f);var m=a.Be;m&&l.push.apply(l,m);if(H&&!Wb("7")){var n=it(l);0<n.length&&(l.push.apply(l,n),c=!0)}if(!g||!k||m||c)b.className=l.join(" ");gt(this,a,b);return b};
h.ag=function(a){Ns(a)&&this.Ve(a.p(),!0);a.isEnabled()&&this.Uc(a,a.Ta)};function gt(a,b,c){b.Ta||ct(c,"hidden",!b.Ta);b.isEnabled()||a.Oa(c,1,!b.isEnabled());b.ma&8&&a.Oa(c,8,kt(b,8));b.ma&16&&a.Oa(c,16,kt(b,16));b.ma&64&&a.Oa(c,64,kt(b,64))}h.Jd=function(a,b){Hi(a,!b,!H&&!Ib)};h.Ve=function(a,b){ht(a,this.C()+"-rtl",b)};h.Ue=function(a){var b;return a.ma&32&&(b=a.i.fc(a))?eh(b)&&fh(b):!1};
h.Uc=function(a,b){var c;if(a.ma&32&&(c=a.i.fc(a))){if(!b&&kt(a,32)){try{c.blur()}catch(d){}kt(a,32)&&a.Kd(null)}(eh(c)&&fh(c))!=b&&(b?c.tabIndex=0:(c.tabIndex=-1,c.removeAttribute("tabIndex")))}};h.R=function(a,b,c){var d=a.p();if(d){var e=this.Mc(b);e&&ht(a,e,c);this.Oa(d,b,c)}};h.Oa=function(a,b,c){et||(et={1:"disabled",8:"selected",16:"checked",64:"expanded"});(b=et[b])&&ct(a,b,c)};
h.xc=function(a,b){var c=this.za(a);if(c&&(Xg(c),b))if(x(b))bh(c,b);else{var d=function(a){if(a){var b=Og(c);c.appendChild(x(a)?b.createTextNode(a):a)}};u(b)?Oa(b,d):!w(b)||"nodeType"in b?d(b):Oa($a(b),d)}};h.fc=function(a){return a.p()};h.C=function(){return"goog-control"};function ft(a,b){var c=a.C(),d=[c],e=a.C();e!=c&&d.push(e);c=b.Jb;for(e=[];c;){var f=c&-c;e.push(a.Mc(f));c&=~f}d.push.apply(d,e);(c=b.Be)&&d.push.apply(d,c);H&&!Wb("7")&&d.push.apply(d,it(d));return d}
function it(a,b){var c=[];b&&(a=a.concat([b]));Oa([],function(d){!Sa(d,na(Va,a))||b&&!Va(d,b)||c.push(d.join("_"))});return c}h.Mc=function(a){this.g||lt(this);return this.g[a]};h.Ie=function(a){this.i||(this.g||lt(this),this.i=sc(this.g));a=parseInt(this.i[a],10);return isNaN(a)?0:a};function lt(a){var b=a.C();a.g={1:b+"-disabled",2:b+"-hover",4:b+"-active",8:b+"-selected",16:b+"-checked",32:b+"-focused",64:b+"-open"}};var mt=!!r.DOMTokenList,nt=mt?function(a){return a.classList}:function(a){a=a.className;return x(a)&&a.match(/\S+/g)||[]},ot=mt?function(a,b){return a.classList.contains(b)}:function(a,b){return Va(nt(a),b)},pt=mt?function(a,b){a.classList.add(b)}:function(a,b){ot(a,b)||(a.className+=0<a.className.length?" "+b:b)},qt=mt?function(a,b){Oa(b,function(b){pt(a,b)})}:function(a,b){var c={};Oa(nt(a),function(a){c[a]=!0});Oa(b,function(a){c[a]=!0});a.className="";for(var d in c)a.className+=0<a.className.length?
" "+d:d},rt=mt?function(a,b){a.classList.remove(b)}:function(a,b){ot(a,b)&&(a.className=Pa(nt(a),function(a){return a!=b}).join(" "))};function st(a,b){if(!ga(a))throw Error("Invalid component class "+a);if(!ga(b))throw Error("Invalid renderer class "+b);var c=ia(a);tt[c]=b}function ut(a,b){if(!a)throw Error("Invalid class name "+a);if(!ga(b))throw Error("Invalid decorator function "+b);vt[a]=b}var tt={},vt={};function $(a,b,c){Cs.call(this,c);if(!b){b=this.constructor;for(var d;b;){d=ia(b);if(d=tt[d])break;b=b.m?b.m.constructor:null}b=d?ga(d.Y)?d.Y():new d:null}this.i=b;this.Ib=t(a)?a:null}E($,Cs);h=$.prototype;h.Ib=null;h.Jb=0;h.ma=39;h.Wb=255;h.nc=0;h.Ta=!0;h.Be=null;h.Ze=!0;h.od=!1;h.nf=null;function wt(a){a.Z&&!1!=a.Ze&&xt(a,!1);a.Ze=!1}h.Ia=function(){var a=this.i.U(this);this.W=a;var b=this.nf||this.i.Hb();b&&bt(a,b);this.od||this.i.Jd(a,!1);this.Ta||(T(a,!1),a&&ct(a,"hidden",!0))};h.Sa=function(){return this.i.za(this.p())};
h.Oe=function(a){return this.i.Hd(a)};h.Yb=function(a){this.W=a=this.i.ua(this,a);var b=this.nf||this.i.Hb();b&&bt(a,b);this.od||this.i.Jd(a,!1);this.Ta="none"!=a.style.display};h.S=function(){$.m.S.call(this);this.i.ag(this);if(this.ma&-2&&(this.Ze&&xt(this,!0),this.ma&32)){var a=this.i.fc(this);if(a){var b=this.j||(this.j=new Ts);Us(b,a);Gs(this).listen(b,"key",this.bb).listen(a,"focus",this.Tg).listen(a,"blur",this.Kd)}}};
function xt(a,b){var c=Gs(a),d=a.p();b?(c.listen(d,"mouseover",a.af).listen(d,"mousedown",a.Vc).listen(d,"mouseup",a.gc).listen(d,"mouseout",a.$e),a.Wc!=ca&&c.listen(d,"contextmenu",a.Wc),H&&c.listen(d,"dblclick",a.bg)):(c.Ca(d,"mouseover",a.af).Ca(d,"mousedown",a.Vc).Ca(d,"mouseup",a.gc).Ca(d,"mouseout",a.$e),a.Wc!=ca&&c.Ca(d,"contextmenu",a.Wc),H&&c.Ca(d,"dblclick",a.bg))}h.qb=function(){$.m.qb.call(this);this.j&&$s(this.j);this.Ta&&this.isEnabled()&&this.i.Uc(this,!1)};
h.G=function(){$.m.G.call(this);this.j&&(this.j.qa(),delete this.j);delete this.i;this.Be=this.Ib=null};h.ra=function(){return this.Ib};function jt(a,b){a.Ib=b}h.Gb=function(){var a=this.ra();if(!a)return"";if(!x(a))if(u(a))a=Qa(a,gh).join("");else{if(Eg&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];hh(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");Eg||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""))}return ua(a)};
h.isEnabled=function(){return!kt(this,1)};h.setEnabled=function(a){var b=this.getParent();b&&"function"==typeof b.isEnabled&&!b.isEnabled()||!yt(this,1,!a)||(a||(zt(this,!1),this.gb(!1)),this.Ta&&this.i.Uc(this,a),this.R(1,!a))};h.gb=function(a){yt(this,2,a)&&this.R(2,a)};function zt(a,b){yt(a,4,b)&&a.R(4,b)}h.Cc=function(a){yt(this,8,a)&&this.R(8,a)};h.oa=function(a){yt(this,64,a)&&this.R(64,a)};function kt(a,b){return!!(a.Jb&b)}
h.R=function(a,b){this.ma&a&&b!=kt(this,a)&&(this.i.R(this,a,b),this.Jb=b?this.Jb|a:this.Jb&~a)};function At(a,b,c){if(a.Z&&kt(a,b)&&!c)throw Error("Component already rendered");!c&&kt(a,b)&&a.R(b,!1);a.ma=c?a.ma|b:a.ma&~b}function Bt(a,b){return!!(a.Wb&b)&&!!(a.ma&b)}function yt(a,b,c){return!!(a.ma&b)&&kt(a,b)!=c&&(!(a.nc&b)||a.dispatchEvent(Es(b,c)))&&!a.I}h.af=function(a){!Ct(a,this.p())&&this.dispatchEvent("enter")&&this.isEnabled()&&Bt(this,2)&&this.gb(!0)};
h.$e=function(a){!Ct(a,this.p())&&this.dispatchEvent("leave")&&(Bt(this,4)&&zt(this,!1),Bt(this,2)&&this.gb(!1))};h.Wc=ca;function Ct(a,b){return!!a.j&&ah(b,a.j)}h.Vc=function(a){this.isEnabled()&&(Bt(this,2)&&this.gb(!0),!ec(a)||Kb&&Db&&a.ctrlKey||(Bt(this,4)&&zt(this,!0),this.i.Ue(this)&&this.i.fc(this).focus()));this.od||!ec(a)||Kb&&Db&&a.ctrlKey||a.preventDefault()};h.gc=function(a){this.isEnabled()&&(Bt(this,2)&&this.gb(!0),kt(this,4)&&this.Pb(a)&&Bt(this,4)&&zt(this,!1))};
h.bg=function(a){this.isEnabled()&&this.Pb(a)};h.Pb=function(a){if(Bt(this,16)){var b=!kt(this,16);yt(this,16,b)&&this.R(16,b)}Bt(this,8)&&this.Cc(!0);Bt(this,64)&&this.oa(!kt(this,64));b=new K("action",this);a&&(b.altKey=a.altKey,b.ctrlKey=a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.l=a.l);return this.dispatchEvent(b)};h.Tg=function(){Bt(this,32)&&yt(this,32,!0)&&this.R(32,!0)};h.Kd=function(){Bt(this,4)&&zt(this,!1);Bt(this,32)&&yt(this,32,!1)&&this.R(32,!1)};
h.bb=function(a){return this.Ta&&this.isEnabled()&&this.yc(a)?(a.preventDefault(),a.Rc(),!0):!1};h.yc=function(a){return 13==a.g&&this.Pb(a)};st($,dt);ut("goog-control",function(){return new $(null)});function Dt(){}E(Dt,dt);da(Dt);h=Dt.prototype;h.C=function(){return"goog-tab"};h.Hb=function(){return"tab"};h.U=function(a){var b=Dt.m.U.call(this,a);(a=a.wb())&&this.Ub(b,a);return b};h.ua=function(a,b){b=Dt.m.ua.call(this,a,b);var c=this.wb(b);c&&a.ae(c);kt(a,8)&&(c=a.getParent())&&ga(c.Dc)&&(a.R(8,!1),c.Dc(a));return b};h.wb=function(a){return a.title||""};h.Ub=function(a,b){a&&(a.title=b||"")};function Et(a,b,c){$.call(this,a,b||Dt.Y(),c);At(this,8,!0);this.nc|=9}E(Et,$);Et.prototype.wb=function(){return this.h};Et.prototype.Ub=function(a){this.i.Ub(this.p(),a);this.ae(a)};Et.prototype.ae=function(a){this.h=a};ut("goog-tab",function(){return new Et(null)});function Ft(){}da(Ft);h=Ft.prototype;h.Gd=function(){};function Gt(a,b){a&&(a.tabIndex=b?0:-1)}h.Sc=function(a){return a.g.A("div",this.Qe(a).join(" "))};h.Pe=function(a){return"DIV"==a.tagName};function Ht(a,b,c){c.id&&Fs(b,c.id);var d=a.C(),e=!1,f=nt(c);f&&Oa(f,function(a){a==d?e=!0:a&&this.sf(b,a,d)},a);e||pt(c,d);It(a,b,c);return c}h.sf=function(a,b,c){b==c+"-disabled"?a.setEnabled(!1):b==c+"-horizontal"?Jt(a,Kt):b==c+"-vertical"&&Jt(a,Lt)};
function It(a,b,c){if(c)for(var d=c.firstChild,e;d&&d.parentNode==c;){e=d.nextSibling;if(1==d.nodeType){var f=a.Nc(d);f&&(f.W=d,b.isEnabled()||f.setEnabled(!1),b.ba(f),Js(f,d))}else d.nodeValue&&""!=va(d.nodeValue)||c.removeChild(d);d=e}}h.Nc=function(a){a:{var b;a=nt(a);for(var c=0,d=a.length;c<d;c++)if(b=a[c],b=b in vt?vt[b]():null){a=b;break a}a=null}return a};h.Re=function(a){a=a.p();Hi(a,!0,Jb);H&&(a.hideFocus=!0);var b=this.Gd();b&&bt(a,b)};h.C=function(){return"goog-container"};
h.Qe=function(a){var b=this.C(),c=[b,a.Nb==Kt?b+"-horizontal":b+"-vertical"];a.isEnabled()||c.push(b+"-disabled");return c};h.Vf=function(){return Lt};function Mt(a,b,c){Cs.call(this,c);this.kb=b||Ft.Y();this.Nb=a||this.kb.Vf()}E(Mt,Cs);var Kt="horizontal",Lt="vertical";h=Mt.prototype;h.ff=null;h.ec=null;h.kb=null;h.Nb=null;h.Na=!0;h.cc=!0;h.tc=!0;h.xb=-1;h.sa=null;h.Cb=!1;h.Xb=null;function Nt(a){return a.ff||a.p()}h.Ia=function(){this.W=this.kb.Sc(this)};h.Sa=function(){return this.p()};h.Oe=function(a){return this.kb.Pe(a)};h.Yb=function(a){this.W=Ht(this.kb,this,a);"none"==a.style.display&&(this.Na=!1)};
h.S=function(){Mt.m.S.call(this);Ks(this,function(a){a.Z&&Ot(this,a)},this);var a=this.p();this.kb.Re(this);this.Tc(this.Na,!0);Gs(this).listen(this,"enter",this.Xe).listen(this,"highlight",this.Qg).listen(this,"unhighlight",this.Sg).listen(this,"open",this.kh).listen(this,"close",this.Yg).listen(a,"mousedown",this.Rg).listen(Og(a),"mouseup",this.ah).listen(a,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.Xg);this.tc&&Pt(this,!0)};
function Pt(a,b){var c=Gs(a),d=Nt(a);b?c.listen(d,"focus",a.Se).listen(d,"blur",a.$f).listen(a.ec||(a.ec=new Ts(Nt(a))),"key",a.bb):c.Ca(d,"focus",a.Se).Ca(d,"blur",a.$f).Ca(a.ec||(a.ec=new Ts(Nt(a))),"key",a.bb)}h.qb=function(){this.Sb(-1);this.sa&&this.sa.oa(!1);this.Cb=!1;Mt.m.qb.call(this)};h.G=function(){Mt.m.G.call(this);this.ec&&(this.ec.qa(),this.ec=null);this.kb=this.sa=this.Xb=this.ff=null};h.Xe=function(){return!0};
h.Qg=function(a){var b=Os(this,a.target);if(-1<b&&b!=this.xb){var c=Qt(this);c&&c.gb(!1);this.xb=b;c=Qt(this);this.Cb&&zt(c,!0);this.sa&&c!=this.sa&&(c.ma&64?c.oa(!0):this.sa.oa(!1))}b=this.p();null!=a.target.p()&&ct(b,"activedescendant",a.target.p().id)};h.Sg=function(a){a.target==Qt(this)&&(this.xb=-1);this.p().removeAttribute("aria-activedescendant")};h.kh=function(a){(a=a.target)&&a!=this.sa&&a.getParent()==this&&(this.sa&&this.sa.oa(!1),this.sa=a)};
h.Yg=function(a){a.target==this.sa&&(this.sa=null)};h.Rg=function(a){this.cc&&(this.Cb=!0);var b=Nt(this);b&&eh(b)&&fh(b)?b.focus():a.preventDefault()};h.ah=function(){this.Cb=!1};h.Xg=function(a){var b;a:{b=a.target;if(this.Xb)for(var c=this.p();b&&b!==c;){var d=b.id;if(d in this.Xb){b=this.Xb[d];break a}b=b.parentNode}b=null}if(b)switch(a.type){case "mousedown":b.Vc(a);break;case "mouseup":b.gc(a);break;case "mouseover":b.af(a);break;case "mouseout":b.$e(a);break;case "contextmenu":b.Wc(a)}};
h.Se=function(){};h.$f=function(){this.Sb(-1);this.Cb=!1;this.sa&&this.sa.oa(!1)};h.bb=function(a){return this.isEnabled()&&this.Na&&(0!=Ls(this)||this.ff)&&this.Te(a)?(a.preventDefault(),a.Rc(),!0):!1};
h.Te=function(a){var b=Qt(this);if(b&&"function"==typeof b.bb&&b.bb(a)||this.sa&&this.sa!=b&&"function"==typeof this.sa.bb&&this.sa.bb(a))return!0;if(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)return!1;switch(a.g){case 27:if(this.tc)Nt(this).blur();else return!1;break;case 36:Rt(this);break;case 35:St(this);break;case 38:if(this.Nb==Lt)Tt(this);else return!1;break;case 37:if(this.Nb==Kt)Ns(this)?Ut(this):Tt(this);else return!1;break;case 40:if(this.Nb==Lt)Ut(this);else return!1;break;case 39:if(this.Nb==
Kt)Ns(this)?Tt(this):Ut(this);else return!1;break;default:return!1}return!0};function Ot(a,b){var c=b.p(),c=c.id||(c.id=b.D());a.Xb||(a.Xb={});a.Xb[c]=b}h.ba=function(a,b){Mt.m.ba.call(this,a,b)};h.qe=function(a,b,c){a.nc|=2;a.nc|=64;At(a,32,!1);wt(a);Mt.m.qe.call(this,a,b,c);a.Z&&this.Z&&Ot(this,a);b<=this.xb&&this.xb++};function Jt(a,b){if(a.p())throw Error("Component already rendered");a.Nb=b}
h.Tc=function(a,b){if(b||this.Na!=a&&this.dispatchEvent(a?"show":"hide")){this.Na=a;var c=this.p();c&&(T(c,a),this.tc&&Gt(Nt(this),this.cc&&this.Na),b||this.dispatchEvent(this.Na?"aftershow":"afterhide"));return!0}return!1};h.isEnabled=function(){return this.cc};
h.setEnabled=function(a){this.cc!=a&&this.dispatchEvent(a?"enable":"disable")&&(a?(this.cc=!0,Ks(this,function(a){a.ug?delete a.ug:a.setEnabled(!0)})):(Ks(this,function(a){a.isEnabled()?a.setEnabled(!1):a.ug=!0}),this.Cb=this.cc=!1),this.tc&&Gt(Nt(this),a&&this.Na))};function Vt(a,b){b!=a.tc&&a.Z&&Pt(a,b);a.tc=b;a.cc&&a.Na&&Gt(Nt(a),b)}h.Sb=function(a){(a=Ms(this,a))?a.gb(!0):-1<this.xb&&Qt(this).gb(!1)};h.gb=function(a){this.Sb(Os(this,a))};function Qt(a){return Ms(a,a.xb)}
function Rt(a){Wt(a,function(a,c){return(a+1)%c},Ls(a)-1)}function St(a){Wt(a,function(a,c){a--;return 0>a?c-1:a},0)}function Ut(a){Wt(a,function(a,c){return(a+1)%c},a.xb)}function Tt(a){Wt(a,function(a,c){a--;return 0>a?c-1:a},a.xb)}function Wt(a,b,c){c=0>c?Os(a,a.sa):c;var d=Ls(a);c=b.call(a,c,d);for(var e=0;e<=d;){var f=Ms(a,c);if(f&&a.Pf(f)){a.qf(c);break}e++;c=b.call(a,c,d)}}h.Pf=function(a){return a.Ta&&a.isEnabled()&&!!(a.ma&2)};h.qf=function(a){this.Sb(a)};function Xt(){}E(Xt,Ft);da(Xt);Xt.prototype.C=function(){return"goog-tab-bar"};Xt.prototype.Gd=function(){return"tablist"};Xt.prototype.sf=function(a,b,c){this.h||(this.g||Yt(this),this.h=sc(this.g));var d=this.h[b];d?(Jt(a,d==Zt||d==$t?Lt:Kt),a.i=d):Xt.m.sf.call(this,a,b,c)};Xt.prototype.Qe=function(a){var b=Xt.m.Qe.call(this,a);this.g||Yt(this);b.push(this.g[a.i]);return b};function Yt(a){var b=a.C();a.g=vc(au,b+"-top",bu,b+"-bottom",Zt,b+"-start",$t,b+"-end")};function cu(a,b,c){a=a||au;Jt(this,a==Zt||a==$t?Lt:Kt);this.i=a;Mt.call(this,this.Nb,b||Xt.Y(),c);du(this)}E(cu,Mt);var au="top",bu="bottom",Zt="start",$t="end";h=cu.prototype;h.fb=null;h.S=function(){cu.m.S.call(this);du(this)};h.G=function(){cu.m.G.call(this);this.fb=null};h.qf=function(a){cu.m.qf.call(this,a);this.Dc(Ms(this,a))};h.Dc=function(a){a?a.Cc(!0):this.fb&&this.fb.Cc(!1)};
function eu(a,b){if(b&&b==a.fb){for(var c=Os(a,b),d=c-1;b=Ms(a,d);d--)if(b.Ta&&b.isEnabled()){a.Dc(b);return}for(c+=1;b=Ms(a,c);c++)if(b.Ta&&b.isEnabled()){a.Dc(b);return}a.Dc(null)}}h.oh=function(a){this.fb&&this.fb!=a.target&&this.fb.Cc(!1);this.fb=a.target};h.ph=function(a){a.target==this.fb&&(this.fb=null)};h.mh=function(a){eu(this,a.target)};h.nh=function(a){eu(this,a.target)};h.Se=function(){Qt(this)||this.gb(this.fb||Ms(this,0))};
function du(a){Gs(a).listen(a,"select",a.oh).listen(a,"unselect",a.ph).listen(a,"disable",a.mh).listen(a,"hide",a.nh)}ut("goog-tab-bar",function(){return new cu});function fu(a,b,c){this.g=a;this.i=b;this.h=c||null}
function gu(a,b){var c=[];a.h&&c.push({$t:a.h,primary:"true"});for(var d=new Jr({id:{$t:"http://www.google.com/m8/feeds/contacts/kts%40gmail.com/base/0"},gd$email:[{address:a.g,primary:"true"}],gd$name:{gd$fullName:{$t:a.i}},gd$phoneNumber:c}),c=[],e=0;e<b.length;e++){for(var f=c,g=e,k=d,l=b[e],m=0,n=Kr(k),p=Kr(l),q=0;q<n.length;q++)for(var s=n[q],v=0;v<p.length;v++){var z=p[v];s&&s==z&&(m+=1)}n=0;s=k.data.gd$name;v=l.data.gd$name;if(s&&v)for(z=["gd$familyName","gd$givenName","gd$additionalName",
"gd$fullName"],p=[0.06,0.06,0.06,0.12],q=0;4>q;q++){var C=s[z[q]],G=v[z[q]];C&&G==C&&(n+=p[q])}q=0;p=k.hd();s=l.hd();p&&p==s&&(q+=0.2);v=0;k=Lr(k);l=Lr(l);s=k.length;for(p=[];s--;){v=k[s];z=l.length;for(p[s]=0;z--;)C=l[z],v.$t&&C.$t&&(C=0.7*Cr(v,C),p[s]=Math.max(p[s],C));v=Vh(p).value}f[g]=m+n+q+v}d=[];for(e=0;e<b.length;e++)f=db(d,gb,c[e]),0>f?(bb(d,-(f+1),0,c[e]),g=b.splice(e,1),bb(b,-(f+1),0,g[0])):bb(d,f,0,c[e])}fu.prototype.Xa=function(){return sb(null)};
fu.prototype.toString=function(){return"ContactModel:"+this.g};function hu(){}E(hu,dt);hu.prototype.logger=R("ydn.crm.inj.sugar.FeedPanelRenderer");hu.prototype.C=function(){return"feed-panel"};hu.prototype.U=function(a){var b=hu.m.U.call(this,a);a=a.g.A("div","feed","Feed panel");b.appendChild(a);return b};hu.prototype.refresh=function(){};function iu(a,b){$.call(this,null,null,a);this.la(b)}E(iu,$);iu.prototype.refresh=function(){var a=this.L,b=this.p();this.i.refresh(b,a)};st(iu,hu);function ju(){}E(ju,dt);da(ju);ju.prototype.C=function(){return"field"};
ju.prototype.U=function(a){var b=a.g.A("span",ft(this,a).join(" "),a.ra());gt(this,a,b);a.W=b;var c=a.L;a=a.g;var d,e=ku(c);d=lu(c.parent.X).module_fields[c.g].type||"varchar";if("bool"==d)d=a.A("input",{"class":"value",type:"checkbox",disabled:"1"});else if("enum"==d){d=a.A("select",{"class":"value",disabled:"1"});var f=lu(c.parent.X).module_fields[c.g].options||{},g;for(g in f){var k=a.A("option",{name:f[g].name},f[g].value);d.appendChild(k)}}else d=a.A("label","value");d.setAttribute("title",e);
b.classList.add("field");b.setAttribute("name",c.g);b.appendChild(d);return b};ju.prototype.refresh=function(a,b){T(a,!!b);if(b){var c=mu(b),d=x(c)?!ta(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":nu(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function ou(){}E(ou,dt);da(ou);ou.prototype.C=function(){return"field"};
ou.prototype.U=function(a){var b=ou.m.U.call(this,a);a.W=b;var c=a.L,d=a.g,e=ku(c);"bool"==(lu(c.parent.X).module_fields[c.g].type||"varchar")?(a=d.A("input",{"class":"value",type:"checkbox",disabled:"1"}),d=d.A("span","name")):(a=d.A("label","value"),d=d.A("sup","name"));d.textContent=e;b.classList.add("field");b.setAttribute("name",c.g);b.appendChild(a);b.appendChild(d);a=c.parent;e=a.X;d=e.parent.l||null;e=A(d)?oc(d,["modules",e.pa()]):null;a=A(e)?oc(e,["groups",a.Kb]):null;((a=A(a)?oc(a,["fields",
c.g]):null)?a.normallyHide:-1==pu.indexOf(c.g))&&b.classList.add("normally-hide");return b};ou.prototype.refresh=function(a,b){T(a,!!b);if(b){var c=mu(b),d=x(c)?!ta(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":nu(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function qu(a,b,c){$.call(this,null,b,c);this.la(a)}E(qu,$);st(qu,ou);qu.prototype.refresh=function(){this.i.refresh(this.p(),this.L)};st(qu,ou);function nu(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b?"checked":null;break;case "select-one":a.selectedIndex=-1;if(x(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":c=b;x(c)&&(c=[c]);for(var e=0;d=a.options[e];e++)if(d.selected=!1,c)for(var f,g=0;f=c[g];g++)d.value==f&&(d.selected=!0);break;default:a.value=null!=b?b:""}};function ru(a,b){this.parent=a;this.g=b}function mu(a){var b=a.parent.ha();return b?b.value(a.g):null}function ku(a){a=lu(a.parent.X).module_fields[a.g];return x(a.label)?a.label.replace(/:$/,""):a.label}var pu=["name","email"];ru.prototype.toString=function(){return this.parent+";Field:"+this.g};function su(a,b){this.X=a;this.Kb=b||"";this.g={}}su.prototype.M=function(){return this.X.M()};su.prototype.ha=function(){return this.X.ha()};function tu(a){var b=lu(a.X),c=[],d;for(d in b.module_fields){var e=b.module_fields[d];a.Kb&&e.group==a.Kb?c.push(d):a.Kb||e.group||c.push(d)}return c}function uu(a,b){a.g[b]||(a.g[b]=new ru(a,b));return a.g[b]}function vu(a){a=a.Kb.replace("_"," ");return a=a.charAt(0).toUpperCase()+a.substr(1)};function wu(a,b){L.call(this);this.parent=a;this.g=b;this.h={}}E(wu,L);h=wu.prototype;h.logger=R("ydn.crm.sugar.model.Record");h.M=function(){return this.parent.M()};h.pa=function(){return this.g.X};function lu(a){return a.parent.o[a.pa()]}h.G=function(){wu.m.G.call(this);this.h=null};h.ha=function(){return this.g};h.Tb=function(a){((a=a?a.g?a:null:null)||this.g)&&a!==this.g&&(this.g=a,this.dispatchEvent(new xu(this.g?this.g.X:null,0,this)))};
h.toString=function(){return"ydn.crm.sugar.model.Record:"+this.g};function yu(a,b){wu.call(this,a,new Qq(a.M(),b));this.module_name=b}E(yu,wu);yu.prototype.pa=function(){return this.module_name};yu.prototype.Tb=function(a){if(a&&a.X!=this.module_name)throw Error("Module name must be "+this.module_name+" but found "+a.X);yu.m.Tb.call(this,a)};yu.prototype.toString=function(){return"ydn.crm.sugar.model.Module:"+this.module_name+(this.g?":"+this.g:"")};function zu(a,b){yu.call(this,a,b);this.Ua=new jf(this);var c=a.h;c&&Au(this,c);this.Ua.listen(this.getParent(),Bu,this.Zg)}E(zu,yu);h=zu.prototype;h.logger=R("ydn.crm.sugar.model.GDataRecord");h.getParent=function(){return this.parent};function Cu(a){return Du(a.getParent(),a.pa()).ob}h.Zg=function(a){Au(this,a.ob)};
function Au(a,b){a.Tb(null);if(b){var c=b.g;if(c){var d=[{store:a.pa(),index:"ydn$emails",key:c}];Eu(a.parent).send("list",d).B(function(a){var b=a[0],g=b.result?b.result.length:0;P(this.logger,"query "+JSON.stringify(d)+" returns "+g+" results ");window.console.log(this+" receiving sugarcrm "+g+" query result for "+c,a);b.result[0]&&this.Tb(new Qq(this.M(),this.pa(),b.result[0]))},a)}}}
function Fu(a){a.ha();var b=Du(a.getParent(),null).ob,b={module:a.pa(),kind:b.xf(),"gdata-id":b.D()};P(a.logger,"sending import-gdata "+JSON.stringify(b));return Eu(a.parent).send("import-gdata",b).B(function(a){window.console.log(a);a=new Qq(this.M(),this.pa(),a);P(this.logger,a+" created.");this.Tb(a)},a)}
function Gu(a){a.ha();var b=Hu(a.getParent()),c=b.i,d={email1:b.g,full_name:c};c&&0<c.length&&(c=c.split(/\s/),c[0]&&(d.first_name=c[0]),c[1]&&(d.last_name=c[c.length-1]));(b=b.h)&&(d.phone_work=b);d={module:a.pa(),record:d};P(a.logger,"sending put-record "+JSON.stringify(d));return Eu(a.parent).send("put-record",d).B(function(a){window.console.log(a);a=new Qq(this.M(),this.pa(),a);P(this.logger,a+" created.");this.Tb(a)},a)}
function Iu(a){var b=a.ha();if(!b)return tb("no Record to link.");b.D();window.console.log(b);var c=Cu(a),c=Du(a.getParent(),null).ob;if(!c)return tb("Not contact data to link.");b=new Gr("sugarcrm",a.M(),a.pa(),b.D(),+new Date(c.data.updated.$t));c={kind:c.xf(),"gdata-id":c.D(),"external-id":{label:b.X+"#"+b.i+"-"+b.h,value:b.T()}};return Eu(a.parent).send("link",c).B(function(a){window.console.log("link",a);a=new Jr(a);a:{for(var b=this.getParent(),c=this.pa(),g=0;g<b.g.length;g++)if(b.g[g].D()==
a.D()){b.g[g]=a;b.dispatchEvent(new Ju(c,0,0,b));break a}b.g.push(a);b.dispatchEvent(new Ju(c,0,0,b))}},a)}h.save=function(){var a=this.ha();window.console.log(a);var b=Eu(this.parent).send("put-record",a);b.B(function(b){window.console.log(b);a.g=b},this);return b};h.G=function(){zu.m.G.call(this);this.Ua.qa();this.g=this.Ua=null};h.toString=function(){var a="";this.g&&(a+=":"+this.g);var b=Cu(this);b&&(a+=":"+b);return"RecordModel:"+this.pa()+a};var Bu="context-data-change";function Ku(a,b){K.call(this,a,b)}E(Ku,K);function Lu(a,b){K.call(this,Bu,b);this.ob=a}E(Lu,Ku);function xu(a,b,c){K.call(this,"record-change",c);this.X=a}E(xu,Ku);function Ju(a,b,c,d){K.call(this,"gdata-change",d);this.module_name=a}E(Ju,Ku);function Mu(a,b){L.call(this);this.ab=a;this.o=b;this.info={};this.l=this.j=null;this.Ua=new jf(this)}E(Mu,L);h=Mu.prototype;h.isLogin=function(){return!!this.ab.isLogin};function Eu(a){return hd("sugarcrm",a.M())}h.M=function(){return this.ab.domain};function Ou(a,b,c){var d={};d.domain=a.M();d.baseUrl=a.ab.baseUrl||null;d.Uh=b;d.password=c;return a.send("login",d).B(function(a){this.ab=a},a)}h.send=function(a,b){return hd("sugarcrm",this.M()).send(a,b)};
h.Xa=function(){this.j||(this.j=this.send("server-info"),this.j.B(function(a){if(a){var b=a.info;b&&(this.info=b);if(a=a.about)this.ab=a}else this.j=null},this));return this.j};function Pu(a,b,c,d){b={store:b};c&&(b.index=c);d&&(d instanceof U?b.range=d.toJSON():b.key=d);b.prefix=!0;return Eu(a).send("list",[b])}function Qu(a,b,c){b={store:b,index:"name",q:c,fetchFull:!1};return Eu(a).send("search",[b])}h.G=function(){Mu.m.G.call(this);this.l=this.info=null;this.Ua.qa();this.Ua=null};
h.toString=function(){return"ydn.crm.sugar.model.Sugar:"+this.M()};function Ru(a,b){Mu.call(this,a,b);this.i={};this.g=this.h=null}E(Ru,Mu);function Du(a,b){for(var c=a.g?a.g.length:0,d=0;d<c;d++){var e=a.g[d],f=kr(e,a.M(),b);if(b&&f)return{module_name:b,ob:e};if(!b&&!f)return{module_name:null,ob:e}}return{module_name:b,ob:null}}
function Su(a,b){a.h=b;a.g=null;a.dispatchEvent(new Lu(b,a));a.h&&a.h.g&&hd().send("gdata-list-contact-by-email",a.h.g).B(function(a){this.g=a.map(function(a){return new Jr(a)});gu(this.h,this.g);0<this.g.length&&this.dispatchEvent(new Ju(null,0,0,this))},a)}function Hu(a){return a.h}Ru.prototype.n=function(a){this.dispatchEvent(a)};Ru.prototype.G=function(){Ru.m.G.call(this);for(var a in this.i)this.i[a].qa();this.g=this.h=this.i=null};
Ru.prototype.toString=function(){return"ydn.crm.sugar.model.GDataSugar:"+this.M()};function Tu(){}E(Tu,Ft);da(Tu);Tu.prototype.C=function(){return"record-group"};Tu.prototype.Sc=function(a){var b=Tu.m.Sc.call(this,a);a.W=b;Gg(b,this.C());for(var c=a.L,d=a.g,e=tu(c),f=0;f<e.length;f++){var g=uu(c,e[f]),k=ou.Y(),g=new qu(g,k,d);a.ba(g,!0)}return b};function Uu(a,b,c){Mt.call(this,Lt,b,c);this.la(a)}E(Uu,Mt);Uu.prototype.refresh=function(){for(var a=0;a<Ls(this);a++)Ms(this,a).refresh()};st(Uu,Tu);function Vu(){}E(Vu,dt);da(Vu);Vu.prototype.C=function(){return"record-group"};Vu.prototype.U=function(a){var b=Vu.m.U.call(this,a);a.W=b;b.setAttribute("name",a.L.Kb);var c=Tu.Y(),c=new Uu(a.L,c,a.g);a.ba(c,!0);return b};function Wu(a,b,c){$.call(this,null,b,c);this.la(a)}E(Wu,$);Wu.prototype.refresh=function(){for(var a=0;a<Ls(this);a++)Ms(this,a).refresh()};st(Wu,Vu);function Xu(){}E(Xu,dt);da(Xu);Xu.prototype.C=function(){return"address"};Xu.prototype.U=function(a){var b=Xu.m.U.call(this,a),c=a.L,d=a.g;b.setAttribute("name",c.Kb);b.classList.add("record-group");var e=d.A("details"),f=d.A("summary");f.textContent=vu(c);b.appendChild(f);var g=d.A("div","content");e.appendChild(f);e.appendChild(g);b.appendChild(e);a.W=b;e=tu(c);f=ju.Y();for(g=0;g<e.length;g++){var k=uu(c,e[g]),k=new qu(k,f,d);a.ba(k,!0)}return b};function Yu(a,b){var c=Xu.Y();Wu.call(this,a,c,b)}E(Yu,Wu);Yu.prototype.Sa=function(){return this.p().querySelector("summary").nextElementSibling};Yu.prototype.refresh=function(){for(var a=0;a<Ls(this);a++)Ms(this,a).refresh()};st(Yu,Xu);function Zu(){}E(Zu,dt);da(Zu);Zu.prototype.C=function(){return"name"};
Zu.prototype.U=function(a){var b=Zu.m.U.call(this,a),c=a.L,d=a.g;b.setAttribute("name",c.Kb);b.classList.add("record-group");var e=d.A("div");e.setAttribute("title",vu(c));b.appendChild(e);var f=d.A("div","content");b.appendChild(e);b.appendChild(f);a.W=b;tu(c);var e=ju.Y(),g;a:{f=lu(c.X);for(g in f.module_fields)if("salutation"==g){g=!0;break a}g=!1}g&&(g=uu(c,"salutation"),g=new qu(g,e,d),a.ba(g,!0));a.ba(new qu(uu(c,"first_name"),e,d),!0);a.ba(new qu(uu(c,"last_name"),e,d),!0);return b};function $u(a,b){var c=Zu.Y();Wu.call(this,a,c,b)}E($u,Wu);$u.prototype.Sa=function(){return Pg("content",this.p())};$u.prototype.refresh=function(){for(var a=0;a<Ls(this);a++)Ms(this,a).refresh()};st($u,Zu);function av(){}E(av,dt);da(av);av.prototype.C=function(){return"record-body"};
av.prototype.U=function(a){var b=av.m.U.call(this,a),c=a.g,d=c.A("div","record-body-header"),e=c.A("div","record-body-content");b.appendChild(d);b.appendChild(e);a.W=b;e=c.A("a",{name:"view"},"view");e.href="#";d.appendChild(e);var d=a.L,e=[],f=lu(d),g;for(g in f.module_fields){var k=f.module_fields[g].group;-1==e.indexOf(k)&&e.push(k)}g=Vu.Y();for(f=0;f<e.length;f++){var k=e[f],l,m;m=d;var n=k;m.h[n]||(m.h[n]=new su(m,n));m=m.h[n];/address/i.test(k)?l=new Yu(m,c):"name"==k?l=new $u(m,c):l=new Wu(m,
g,c);a.ba(l,!0)}return b};function bv(a){return a.querySelector("a[name=view]")};function cv(a,b,c){b=b||av.Y();$.call(this,null,b,c);this.la(a)}E(cv,$);h=cv.prototype;h.logger=R("ydn.crm.inj.sugar.module.Record");h.Sa=function(){return Pg("record-body-content",this.p())};h.S=function(){cv.m.S.call(this);var a=Gs(this),b=this.L;b&&a.listen(b,"record-change",this.refresh);a.listen(bv(this.p()),"click",this.Fh,!1)};
h.Fh=function(a){a.preventDefault();var b=this.p();a=Pg("record-body-header",b);b=Pg("record-body-content",b);a=bv(a);b.classList.contains("view")?(a.textContent="view",b.classList.remove("view")):(a.textContent="hide",b.classList.add("view"))};
h.refresh=function(a){var b=this.L,c=this.p();if(b.ha())for(T(c,!0),a&&"record-change"==a.type&&(b=this.p(),a=Pg("record-body-header",b),b=Pg("record-body-content",b),bv(a).textContent="view",b.classList.remove("view")),a=0;a<Ls(this);a++)b=Ms(this,a),b instanceof Wu?b.refresh():b instanceof Yu&&b.refresh();else T(c,!1)};st(cv,av);function dv(){}E(dv,dt);dv.prototype.logger=R("ydn.crm.inj.sugar.module.GDataPanelRenderer");dv.prototype.C=function(){return"record-panel"};
dv.prototype.U=function(a){var b=dv.m.U.call(this,a),c=a.L,d=c.pa(),e=a.g,f=e.A("div","record-root");b.appendChild(f);var g=e.A("div","record-header"),k=e.A("div","record-content");f.appendChild(g);f.appendChild(k);a.W=f;f.classList.add(d);var f=e.A("span",{"class":"icon"},d.substr(0,2)),k=e.A("a",{href:"#","class":"title"}),l=e.A("a",{href:"#link","class":"link"},"link"),m=e.A("span","synced");T(l,!1);T(m,!1);f=e.A("div","header",[f,k,l,m]);d=e.A("a",{"class":"import",href:"#import"},"Add to "+d);
d.style.zIndex=1E3;d=e.A("div",{"class":"import"},d);g.appendChild(d);g.appendChild(f);c=new cv(c,null,e);a.ba(c,!0);return b};
dv.prototype.refresh=function(a,b){var c=a.querySelector(".import"),d=a.querySelector(".header"),e=a.querySelector(".title"),f=c.nextElementSibling,c=c.querySelector("a"),g=a.querySelector("a.link"),f=f.querySelector(".synced");b.uf||b.dg?T(a,!0):T(a,!1);T(d,!!b.title);e.textContent=b.title;b.uf?e.href=b.uf:e.removeAttribute("href");c.textContent=b.dg;c.setAttribute("title",b.eg);(g.textContent=b.gf)?(g.setAttribute("title",b.eg),g.href="#"+b.gf):g.removeAttribute("href");T(f,b.sh)};function ev(){L.call(this);this.h=this.g=null}E(ev,L);ev.prototype.G=function(){this.g&&(this.g.qa(),this.h=this.g=null)};function fv(a,b){a.h=b;a.g=new jf(a);a.g.listen(b,"click",a.i,!0)}ev.prototype.p=function(){return this.h};ev.prototype.i=function(a){a.preventDefault();var b=this.p(),c=this.p();(c.classList.contains("error")?gv:c.href?"n":"v")==gv?(b.textContent="Error reported, thanks.",b.removeAttribute("href"),b.removeAttribute("title"),b.classList.remove("error")):this.dispatchEvent(a)};
var gv="e";function hv(a,b){var c=a.p();c.classList.remove("error");c.removeAttribute("href");b?(c.textContent=b,T(c,!0)):T(c,!1);c.removeAttribute("title")}function iv(a,b,c){a=a.p();a.classList.add("error");a.href="#error";a.textContent="error";a.setAttribute("title","Click to report error"+(c?" for "+c:""));b&&hd().send("log-bug",b)};function jv(a,b){$.call(this,null,null,a);this.la(b);this.h=new ev;this.n=new ev}E(jv,$);h=jv.prototype;h.logger=R("ydn.crm.inj.sugar.module.GDataPanel");h.Sa=function(){return Pg("record-content",this.p())};
h.S=function(){jv.m.S.call(this);var a=this.p();fv(this.h,Qg(document,"A","import",a)[0]);fv(this.n,Qg(document,"A","link",a)[0]);Gs(this).listen(this.h,"click",this.eh,!1);Gs(this).listen(this.n,"click",this.hh,!1);a=this.L;Gs(this).listen(a,["record-change"],this.refresh);Gs(this).listen(a.parent,["gdata-change"],this.refresh)};h.refresh=function(){var a=this.L,b=Pg("record-header",this.p());this.i.refresh(b,kv(this));b=this.Sa();T(b,!!a.ha())};
function kv(a){var b=a.L,c=(a=Cu(b))?null:Du(b.getParent(),null).ob,d=Hu(b.getParent()),e=b.ha(),f=b.pa(),g="",k=null,l=!1,m="",n="",p="",q="";d&&(m="Add to "+f,n="Add current contact "+d.g+" to SugarCRM "+f,e?(g=Rq(e),k=qq(e.domain,e.X,e.D()),n=m="",p="export",q="Export this SugarCRM "+f+" to Gmail My Contacts address book",a&&(c=Cu(b),b.g&&c?(kr(c,b.M(),b.pa()),b=!0):b=!1,b?(l=!0,q=p=""):(p="link",q="Link Gmail contact "+a.id.match(/\w+$/)[0]+" with this SugarCRM "+f+" "+e.D()))):c&&(m+=" and sync",
n+=" and then synchronize between the two records.",q=p=""));return{title:g,uf:k,dg:m,eg:n,sh:l,gf:p,Th:q}}h.hh=function(){var a=this.L;hv(this.n,"Linking...");Iu(a).t(function(){hv(this.n,"Done.");this.dispatchEvent(new K("record-change"))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?Ah(a):a;var c;c=this.p();c=ih(c);iv(this.n,{"class":"RecordHeader",method:"handleLinkClick",context:"link",html:c?c.outerHTML:"",error:a},a)},this)};
h.eh=function(){var a=this.L;hv(this.h,"Adding... to "+a.pa());var b;Du(a.getParent(),null).ob?b=Fu(a).B(function(){hv(this.h,"Linking GData and SugarCRM...");return Iu(a)},this):(b=Gu(a),b=b.B(function(){return Iu(a)},this));b.t(function(){hv(this.h,null);this.dispatchEvent(new K("change",this))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?Ah(a):a;var b;b=this.p();b=ih(b);iv(this.h,{"class":"RecordHeader",method:"handleImportClick",context:"link",html:b?b.outerHTML:"",error:a},a)},
this)};st(jv,dv);function lv(){}E(lv,Ft);da(lv);lv.prototype.logger=R("ydn.crm.inj.sugar.FeedBodyRenderer");lv.prototype.C=function(){return"feed-panel"};
lv.prototype.Sc=function(a){var b=lv.m.Sc.call(this,a),c=a.g,d=c.A("div","feed-header"),e=c.A("div","feed-body");b.appendChild(d);b.appendChild(e);a.W=b;c=c.A("div","feed-title");d.appendChild(c);for(d=0;d<pq.length;d++){a:{for(var c=a,e=pq[d],f=0;f<c.h.length;f++){var g=c.h[f];if(g.L.pa()==e){Ya(c.h,f);c=g;break a}}f=c.L;f.i[e]||(f.i[e]=new zu(f,e),f.Ua.listen(f.i[e],"record-change",f.n));c=new jv(c.g,f.i[e])}a.ba(c,!0)}return b};lv.prototype.refresh=function(a,b){T(a,!!b.h)};function mv(a,b){var c=lv.Y();Mt.call(this,Lt,c,a);this.la(b);this.h=[]}E(mv,Mt);mv.prototype.Sa=function(){return Pg("feed-body",this.p())};mv.prototype.S=function(){mv.m.S.call(this);Gs(this).listen(this.L,Bu,this.refresh)};mv.prototype.refresh=function(a){var b=this.L,c=this.p();this.kb.refresh(c,b);if(a.type==Bu)for(b=Ls(this)-1;0<=b;b--)Ms(this,b).refresh(a)};st(mv,lv);function nv(){}E(nv,dt);nv.prototype.logger=R("ydn.crm.inj.sugar.HeaderRenderer");nv.prototype.C=function(){return"sugar-header"};
nv.prototype.U=function(a){var b=nv.m.U.call(this,a),c=a.L;a=a.g;Gg(b,this.C());var d=a.A("a");d.textContent=c.M();d.href=c.ab.baseUrl?c.ab.baseUrl:"https://"+c.ab.domain;c=a.A("div",{"class":"main-title",title:"SugarCRM"},[d]);b.appendChild(c);c=[];d=chrome.extension.getURL(Yh)+"#credentials";d=a.A("a",{href:d,target:"option-page"},"Setup host permission");d.setAttribute("title","Your permission is required to connect your server from this extension. Without permission request to server will be slow.");
c.push(d);c=a.A("div",{"class":"host-permission"},c);b.appendChild(c);var d=a.A("input",{name:"username",type:"text"}),d=a.A("div",null,[d]),e=a.A("input",{name:"password",type:"password"}),e=a.A("div",null,[e]),f=a.A("div","message");a=a.A("div","login-form",[d,e,f]);T(c,!1);T(a,!1);b.appendChild(a);return b};function ov(a,b){$.call(this,null,null,a);this.la(b)}E(ov,$);h=ov.prototype;h.logger=R("ydn.crm.inj.sugar.Header");
h.S=function(){ov.m.S.call(this);var a=this.p(),b=Gs(this);this.p().querySelector(".host-permission");a=a.querySelector(".login-form");a=new Ts(a);b.listen(a,"key",this.Eh);b.listen(ed(),"post",function(a){a=a.getMessage();if("update-host-permission"==a.req&&(a=a.data)&&a.origins){a=a.origins;for(var b=this.info.M(),e=0;e<a.length;e++)if((new vd(a[e])).M()==b){P(this.logger,"has host permission on "+b);var f=this.L;f.ab.hostPermission=!0;this.la(f)}}},!1)};
h.Eh=function(a){if(13==a.g){var b=this.p().querySelector(".login-form"),c=this.L;a=b.querySelector("input[name=username]").value;var d=b.querySelector("input[name=password]").value,e=b.querySelector(".message");e.textContent="logging in...";Ou(c,a,d).t(function(){c.isLogin()?(e.textContent="",T(b,!1)):e.textContent="login failed"},function(a){e.textContent="Error: "+a},this)}};h.M=function(){return this.L.M()};
h.refresh=function(){var a=this.L,b=a.M(),c=this.p(),d=c.querySelector(".main-title a"),e=c.querySelector(".login-form"),f=c.querySelector(".host-permission");d.textContent=b;d.href=a.ab.baseUrl||null||"https://"+b;e.querySelector("input[name=username]").textContent=a.ab.userName||null||"";T(e,!1);T(f,!1);T(c,!0);a.isLogin()||hd("sugarcrm",b).send("about").B(function(a){T(e,!a.isLogin)});a.isLogin()&&!a.ab.hostPermission&&(a=chrome.extension.getURL(go),f.querySelector("a").href=a+"?"+b,T(f,!0))};
st(ov,nv);function pv(a,b,c){Cs.call(this,a);a=new Ru(b,c);this.la(a)}E(pv,Cs);pv.prototype.C=function(){return"sugar-panel"};pv.prototype.Ia=function(){pv.m.Ia.call(this);var a=this.g,b=this.p();Gg(b,this.C());b=new ov(a,this.L);this.ba(b,!0);a=new mv(a,this.L);this.ba(a,!0)};pv.prototype.S=function(){pv.m.S.call(this)};pv.prototype.logger=R("ydn.crm.inj.SugarPanel");function qv(){this.g=null}var rv;function sv(){rv||(rv=new qv);return rv}qv.prototype.Xa=function(a,b){this.g?a.call(b):hd().send("user-setting").B(function(c){this.g=c||tv;a.call(b)},this)};
qv.prototype.h=function(a){a=hd("sugarcrm",a);for(var b=[],c=0;c<oq.length;c++){var d=a.send("info-module",oq[c]).B(function(a){var b="",c="",d;for(d in a.module_fields){var l=a.module_fields[d];if(0<=["salutation","name","last_name","first_name","full_name"].indexOf(d))l.group="name";else if(/^email\d?$/.test(d))l.group="email";else if(/^phone?/.test(d))l.group="phone";else if(!l.group&&ra(d,b)){l.group=c;continue}b=d;c=l.group}},this);b.push(d)}return(new rm(b)).B(function(a){for(var b={},c=0;c<
oq.length;c++)b[oq[c]]=a[c][1];return b},this)};var tv={};function uv(a){Cs.call(this,a)}E(uv,Cs);uv.prototype.Ia=function(){uv.m.Ia.call(this);var a=this.p(),b=this.g;Gg(a,"sugarcrm-link-panel");b=b.createElement("a");b.textContent="Setup SugarCRM";b.href=chrome.extension.getURL(Yh)+"#credentials";b.className="sugarcrm-setup-link";a.appendChild(b);T(a,!1)};uv.prototype.la=function(a){uv.m.la.call(this,a);a=u(a)&&0<a.length;T(this.p(),!a)};function vv(a){Cs.call(this,a);this.i=new lf(400);Dc(this.i,nf,this.yh,!1,this);this.j=0;this.n="";this.o=sv();this.o.Xa(jb);this.h=document.createElement("div");a=new uv;this.ba(a,!0)}E(vv,Cs);h=vv.prototype;h.C=function(){return"inj"};h.Ia=function(){vv.m.Ia.call(this);var a=this.p();Gg(a,this.C())};h.S=function(){vv.m.S.call(this)};h.logger=R("ydn.crm.inj.SidebarPanel");
function wv(a,b){var c=b.domain,d=a.o.h(c);d.B(function(a){a=new pv(this.g,b,a);for(var d=0;d<Ls(this);d++){var g=Ms(this,d);if(g instanceof pv&&g.L.M()==c)return}P(this.logger,"sugar panel "+c+" created");this.ba(a,!0)},a);return d}
h.init=function(){return 1<Ls(this)?sb():hd().send("list-sugarcrm").B(function(a){Ms(this,0).la(a);for(var b=[],c=0;c<a.length;c++){var d;a:{for(d=1;d<Ls(this);d++){var e=Ms(this,d);if(e instanceof pv&&e.L.M()==a[c]){d=!0;break a}}d=!1}d||b.push(wv(this,a[c]))}return new rm(b)},this)};h.update=function(){Q(this.logger,"updating sidebar");this.init();this.j=0;this.n=location.href;mf(this.i)};
h.la=function(a){vv.m.la.call(this,a);var b=Ls(this);1<b?P(this.logger,"setting module to "+b+" children"):O(this.logger,"no sugar instance");for(var c=1;c<b;c++){var d=Ms(this,c);if(d instanceof pv){var e=a,f=d.L,d=d.p();e.g?(T(d,!0),Su(f,e)):T(d,!1)}else O(this.logger,"unknown panel at "+c)}};
function xv(a,b){var c=a.querySelector("img[jid]");if(!c){if(b){var d=a.querySelector("span[title]");if(d&&(c=d.getAttribute("title").trim(),0<c.length&&(d=document.querySelector('span[name="'+c+'"][email]'))))return d=d.getAttribute("email"),new fu(d,c)}return null}for(d=c.getAttribute("jid");c&&"TD"!=c.tagName;)c=c.parentElement;c=c.nextElementSibling.querySelector("span[title]").getAttribute("title");return new fu(d,c)}
h.yh=function(){this.j++;this.n!=location.href&&this.i.stop();if(40<this.j)this.i.stop();else{var a=document.querySelector('table[role="presentation"]');if(a){var b=a.querySelector("tr");if(a=b.children[2].querySelector("table")){var c=xv(a,5<this.j);if(c){this.i.stop();for(var d,b=a,e=0;4>e;e++)if(b.parentElement&&(b=b.parentElement,b.nextElementSibling&&"DIV"==b.nextElementSibling.tagName)){var b=b.parentElement,e=b.lastElementChild,f=!!e.querySelector("a[href]");d=document.createElement("div");
f?b.parentElement.insertBefore(d,e):b.appendChild(d);break}d||(b=a.ownerDocument,d=b.createElement("td"),d.setAttribute("colspan","2"),b=b.createElement("tr"),b.className="widget-topraw",b.appendChild(d),(a.querySelector("tbody")||a).appendChild(b));this.h.parentElement?(this.h.parentElement.removeChild(this.h),d.appendChild(this.h)):(d.appendChild(this.h),this.render(this.h));T(this.h,!0);c.Xa().B(function(){this.la(c)},this)}else O(this.logger,"Could not sniff contact identifier."),T(this.h,!1)}else O(this.logger,
"No Contact panel found."),T(this.h,!1)}}};function yv(){this.g=this.h=null}yv.prototype.init=function(a){this.h=a;a=document.getElementById("user-login");Dc(a,"click",function(a){a.preventDefault();window.open(a.target.href,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=400, top="+(screen.height/2-200)+", left="+(screen.width/2-300));return!0},!0,this)};
function zv(a,b){if(!b||b instanceof Error)a.g=null;else if(a.g=b,a.h){var c=document.getElementById("user-login"),d=document.getElementById("user-name"),e=Pg("login-message",a.h);b instanceof Error?(e.textContent=b.message,T(e,!0),T(c,!1)):a.g.is_login?(c.href=a.g.logout_url,c.textContent="logout",d.textContent=a.g.email,T(e,!1),T(c,!1)):(c.href=a.g.login_url,c.textContent="login",c.style.display="",d.textContent="",T(e,!0),T(c,!0))}};function Av(){fd("gmail");this.j=new vv;var a=this.history=new As,b=Id(new vd(document.location.href))+"/";a.xh=b;Dc(this.history,"navigate",this.dh,!1,this);this.i=null;this.g=!1;new cu;this.h=new yv}h=Av.prototype;h.logger=R("ydn.crm.inj.App");h.isLogin=function(){return this.g};h.dh=function(a){a.g!=this.i&&(this.i=a.g,/^contact/.test(a.g)||/\w+\/[\w\d]{10,18}$/.test(a.g)&&this.j.update())};
h.init=function(){P(this.logger,"init "+this);Bv(this);var a=window.setInterval(function(){document.querySelector('a[href="http://mail.google.com/mail/help/terms.html"]')&&window.clearTimeout(a)},500);window.setTimeout(function(){window.clearTimeout(a)},15E3)};h.toString=function(){return"inj.Main:0.7.0"};
function Bv(a){hd().send("login-info").t(function(a){a:{if(a&&a.email){Q(this.logger,"user "+a.email+" login");this.g=!0;var c=this.h.g;if(c&&c.email==a.email)break a;this.j.init();this.history.setEnabled(!0)}else this.g&&(this.g=!1,this.history.setEnabled(!1));zv(this.h,a)}},function(a){O(this.logger,a.name+" "+a.message);zv(this.h,a)},a)};oa("ydn.crm.version","0.7.0");oa("runInjApp",function(){Co();var a=new Av;a.init();return a}.g);oa("runEventApp",function(){Co();var a=new ts;a.init();rs(a);return a});ts.prototype.xp=ts.prototype.K;oa("goog.async.Deferred",F);F.prototype.addCallback=F.prototype.B;F.prototype.addErrback=F.prototype.Ic;F.prototype.addBoth=F.prototype.da;F.prototype.addCallbacks=F.prototype.t;function Cv(){}E(Cv,dt);da(Cv);Cv.prototype.C=function(){return"goog-menuheader"};function Dv(a,b,c){$.call(this,a,c||Cv.Y(),b);At(this,1,!1);At(this,2,!1);At(this,4,!1);At(this,32,!1);this.Jb=1}E(Dv,$);ut("goog-menuheader",function(){return new Dv(null)});function Ev(){this.h=[]}E(Ev,dt);da(Ev);function Fv(a,b){var c=a.h[b];if(!c){switch(b){case 0:c=a.C()+"-highlight";break;case 1:c=a.C()+"-checkbox";break;case 2:c=a.C()+"-content"}a.h[b]=c}return c}h=Ev.prototype;h.Hb=function(){return"menuitem"};h.U=function(a){var b=a.g.A("div",ft(this,a).join(" "),Gv(this,a.ra(),a.g));Hv(this,a,b,!!(a.ma&8)||!!(a.ma&16));gt(this,a,b);return b};h.za=function(a){return a&&a.firstChild};
h.ua=function(a,b){var c=$g(b),d=Fv(this,2);c&&ot(c,d)||b.appendChild(Gv(this,b.childNodes,a.g));ot(b,"goog-option")&&(At(a,16,!0),(c=a.p())&&Iv(a.i,a,c),Iv(this,a,b));return Ev.m.ua.call(this,a,b)};h.xc=function(a,b){var c=this.za(a),d=Jv(this,a)?c.firstChild:null;Ev.m.xc.call(this,a,b);d&&!Jv(this,a)&&c.insertBefore(d,c.firstChild||null)};function Gv(a,b,c){a=Fv(a,2);return c.A("div",a,b)}function Iv(a,b,c){c&&(bt(c,"menuitemcheckbox"),Hv(a,b,c,!0))}
function Jv(a,b){var c=a.za(b);if(c){var c=c.firstChild,d=Fv(a,1);return!!c&&A(c)&&1==c.nodeType&&ot(c,d)}return!1}function Hv(a,b,c,d){d!=Jv(a,c)&&(d?pt(c,"goog-option"):rt(c,"goog-option"),c=a.za(c),d?(a=Fv(a,1),c.insertBefore(b.g.A("div",a),c.firstChild||null)):c.removeChild(c.firstChild))}h.Mc=function(a){switch(a){case 2:return Fv(this,0);case 16:case 8:return"goog-option-selected";default:return Ev.m.Mc.call(this,a)}};
h.Ie=function(a){var b=Fv(this,0);switch(a){case "goog-option-selected":return 16;case b:return 2;default:return Ev.m.Ie.call(this,a)}};h.C=function(){return"goog-menuitem"};function Kv(a,b,c,d){$.call(this,a,d||Ev.Y(),c);this.la(b)}E(Kv,$);h=Kv.prototype;h.T=function(){var a=this.L;return null!=a?a:this.Gb()};h.Gb=function(){var a=this.ra();return u(a)?(a=Qa(a,function(a){return A(a)&&1==a.nodeType&&(ot(a,"goog-menuitem-accel")||ot(a,"goog-menuitem-mnemonic-separator"))?"":gh(a)}).join(""),ua(a)):Kv.m.Gb.call(this)};
h.gc=function(a){var b=this.getParent();if(b){var c=b.h;b.h=null;if(b=c&&y(a.clientX))b=new Jg(a.clientX,a.clientY),b=c==b?!0:c&&b?c.x==b.x&&c.y==b.y:!1;if(b)return}Kv.m.gc.call(this,a)};h.yc=function(a){return a.g==this.jg&&this.Pb(a)?!0:Kv.m.yc.call(this,a)};h.Pg=function(){return this.jg};ut("goog-menuitem",function(){return new Kv(null)});function Lv(){}E(Lv,dt);da(Lv);Lv.prototype.U=function(a){return a.g.A("div",this.C())};Lv.prototype.ua=function(a,b){b.id&&Fs(a,b.id);if("HR"==b.tagName){var c=b;b=this.U(a);Yg(b,c);Zg(c)}else pt(b,this.C());return b};Lv.prototype.xc=function(){};Lv.prototype.C=function(){return"goog-menuseparator"};function Mv(a,b){$.call(this,null,a||Lv.Y(),b);At(this,1,!1);At(this,2,!1);At(this,4,!1);At(this,32,!1);this.Jb=1}E(Mv,$);Mv.prototype.S=function(){Mv.m.S.call(this);var a=this.p();bt(a,"separator")};ut("goog-menuseparator",function(){return new Mv});function Nv(){}E(Nv,Ft);da(Nv);h=Nv.prototype;h.Gd=function(){return"menu"};h.Pe=function(a){return"UL"==a.tagName||Nv.m.Pe.call(this,a)};h.Nc=function(a){return"HR"==a.tagName?new Mv:Nv.m.Nc.call(this,a)};h.C=function(){return"goog-menu"};h.Re=function(a){Nv.m.Re.call(this,a);a=a.p();ct(a,"haspopup","true")};ut("goog-menuseparator",function(){return new Mv});function Ov(a,b){Mt.call(this,Lt,b||Nv.Y(),a);Vt(this,!1)}E(Ov,Mt);h=Ov.prototype;h.se=!0;h.C=function(){return this.kb.C()};h.Cd=function(){var a=[];Ks(this,function(b){a.push(b)});return a};h.Tc=function(a,b,c){(b=Ov.m.Tc.call(this,a,b))&&a&&this.Z&&this.se&&Nt(this).focus();a&&c&&y(c.clientX)?this.h=new Jg(c.clientX,c.clientY):this.h=null;return b};h.Xe=function(a){this.se&&Nt(this).focus();return Ov.m.Xe.call(this,a)};h.Pf=function(a){return a.isEnabled()&&a.Ta&&!!(a.ma&2)};
h.Yb=function(a){for(var b=this.kb,c=Qg(this.g.g,"div",b.C()+"-content",a),d=c.length,e=0;e<d;e++)It(b,this,c[e]);Ov.m.Yb.call(this,a)};h.Te=function(a){var b=Ov.m.Te.call(this,a);b||Ks(this,function(c){!b&&c.Pg&&c.jg==a.g&&(this.isEnabled()&&this.gb(c),b=c.bb(a))},this);return b};
h.Sb=function(a){Ov.m.Sb.call(this,a);if(a=Ms(this,a)){var b=a.p();a=this.p();var c=Ai(b),d=Ai(a),e=Mi(a),f=c.x-d.x-e.left,c=c.y-d.y-e.top,d=a.clientHeight-b.offsetHeight,e=a.scrollLeft,g=a.scrollTop,e=e+Math.min(f,Math.max(f-(a.clientWidth-b.offsetWidth),0)),g=g+Math.min(c,Math.max(c-d,0)),b=new Jg(e,g);a.scrollLeft=b.x;a.scrollTop=b.y}};function Pv(){}E(Pv,Lv);da(Pv);Pv.prototype.U=function(a){return a.g.A("div",this.C()+" goog-inline-block","\u00a0")};Pv.prototype.ua=function(a,b){b=Pv.m.ua.call(this,a,b);pt(b,"goog-inline-block");return b};Pv.prototype.C=function(){return"goog-toolbar-separator"};function Qv(){}E(Qv,Ft);da(Qv);Qv.prototype.Gd=function(){return"toolbar"};Qv.prototype.Nc=function(a){return"HR"==a.tagName?new Mv(Pv.Y()):Qv.m.Nc.call(this,a)};Qv.prototype.C=function(){return"goog-toolbar"};Qv.prototype.Vf=function(){return Kt};function Rv(a,b,c){Mt.call(this,b,a||Qv.Y(),c)}E(Rv,Mt);function Sv(a,b,c,d,e,f,g,k,l){var m,n;if(m=c.offsetParent){var p="HTML"==m.tagName||"BODY"==m.tagName;p&&"static"==wi(m,"position")||(n=Ai(m),p||(p=(p=Bi(m))&&Jb?-m.scrollLeft:!p||H&&Wb("8")||"visible"==wi(m,"overflowX")?m.scrollLeft:m.scrollWidth-m.clientWidth-m.scrollLeft,n=Kg(n,new Jg(p,m.scrollTop))))}m=n||new Jg;n=Fi(a);if(p=zi(a)){var q=new ui(p.left,p.top,p.right-p.left,p.bottom-p.top),p=Math.max(n.left,q.left),s=Math.min(n.left+n.width,q.left+q.width);if(p<=s){var v=Math.max(n.top,q.top),
q=Math.min(n.top+n.height,q.top+q.height);v<=q&&(n.left=p,n.top=v,n.width=s-p,n.height=q-v)}}p=Mg(a);v=Mg(c);if(p.g!=v.g){var s=p.g.body,v=Ug(v.g),q=new Jg(0,0),z;z=(z=Og(s))?Ug(z):window;var C=s;do{var G;if(z==v)G=Ai(C);else{var J=C;G=void 0;if(J.getBoundingClientRect)G=xi(J),G=new Jg(G.left,G.top);else{G=lh(Mg(J));var N=Ai(J);G=new Jg(N.x-G.x,N.y-G.y)}if(Jb&&!Wb(12)){N=void 0;H?N="-ms-transform":Kb?N="-webkit-transform":Ib?N="-o-transform":Jb&&(N="-moz-transform");var ha=void 0;N&&(ha=wi(J,N));
ha||(ha=wi(J,"transform"));J=ha?(J=ha.match(Ni))?new Jg(parseFloat(J[1]),parseFloat(J[2])):new Jg(0,0):new Jg(0,0);G=new Jg(G.x+J.x,G.y+J.y)}}q.x+=G.x;q.y+=G.y}while(z&&z!=v&&(C=z.frameElement)&&(z=z.parent));s=Kg(q,Ai(s));H&&!kh(p)&&(s=Kg(s,lh(p)));n.left+=s.x;n.top+=s.y}a=Tv(a,b);b=new Jg(a&2?n.left+n.width:n.left,a&1?n.top+n.height:n.top);b=Kg(b,m);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var I;if(g)if(l)I=l;else if(I=zi(c))I.top-=m.y,I.right-=m.x,I.bottom-=m.y,I.left-=m.x;a:{l=b.ea();e=0;
a=Tv(c,d);d=Di(c);k=k?k.ea():d.ea();if(f||0!=a)a&2?l.x-=k.width+(f?f.right:0):f&&(l.x+=f.left),a&1?l.y-=k.height+(f?f.bottom:0):f&&(l.y+=f.top);if(g&&(I?(f=l,e=0,65==(g&65)&&(f.x<I.left||f.x>=I.right)&&(g&=-2),132==(g&132)&&(f.y<I.top||f.y>=I.bottom)&&(g&=-5),f.x<I.left&&g&1&&(f.x=I.left,e|=1),f.x<I.left&&f.x+k.width>I.right&&g&16&&(k.width=Math.max(k.width-(f.x+k.width-I.right),0),e|=4),f.x+k.width>I.right&&g&1&&(f.x=Math.max(I.right-k.width,I.left),e|=1),g&2&&(e=e|(f.x<I.left?16:0)|(f.x+k.width>
I.right?32:0)),f.y<I.top&&g&4&&(f.y=I.top,e|=2),f.y<=I.top&&f.y+k.height<I.bottom&&g&32&&(k.height=Math.max(k.height-(I.top-f.y),0),f.y=I.top,e|=8),f.y>=I.top&&f.y+k.height>I.bottom&&g&32&&(k.height=Math.max(k.height-(f.y+k.height-I.bottom),0),e|=8),f.y+k.height>I.bottom&&g&4&&(f.y=Math.max(I.bottom-k.height,I.top),e|=2),g&8&&(e=e|(f.y<I.top?64:0)|(f.y+k.height>I.bottom?128:0)),g=e):g=256,e=g,e&496)){c=e;break a}f=Jb&&(Db||Nb)&&Wb("1.9");l instanceof Jg?(g=l.x,l=l.y):(g=l,l=void 0);c.style.left=Ci(g,
f);c.style.top=Ci(l,f);d==k||d&&k&&d.width==k.width&&d.height==k.height||(f=kh(Mg(Og(c))),!H||f&&Wb("8")?(c=c.style,Jb?c.MozBoxSizing="border-box":Kb?c.WebkitBoxSizing="border-box":c.boxSizing="border-box",c.width=Math.max(k.width,0)+"px",c.height=Math.max(k.height,0)+"px"):(g=c.style,f?(H?(f=Ji(c,"paddingLeft"),d=Ji(c,"paddingRight"),l=Ji(c,"paddingTop"),I=Ji(c,"paddingBottom"),f=new ti(l,d,I,f)):(f=vi(c,"paddingLeft"),d=vi(c,"paddingRight"),l=vi(c,"paddingTop"),I=vi(c,"paddingBottom"),f=new ti(parseFloat(l),
parseFloat(d),parseFloat(I),parseFloat(f))),c=Mi(c),g.pixelWidth=k.width-c.left-f.left-f.right-c.right,g.pixelHeight=k.height-c.top-f.top-f.bottom-c.bottom):(g.pixelWidth=k.width,g.pixelHeight=k.height)));c=e}return c}function Tv(a,b){return(b&4&&Bi(a)?b^2:b)&-5};function Uv(){}Uv.prototype.l=function(){};function Vv(a,b,c){this.g=a;this.h=b;this.o=c}E(Vv,Uv);Vv.prototype.l=function(a,b,c){Sv(this.g,this.h,a,b,void 0,c,this.o)};function Wv(a,b,c,d){Vv.call(this,a,b);this.i=c?5:0;this.j=d||void 0}E(Wv,Vv);Wv.prototype.n=function(){return this.i};Wv.prototype.l=function(a,b,c,d){var e=Sv(this.g,this.h,a,b,null,c,10,d,this.j);if(e&496){var f=Xv(e,this.h);b=Xv(e,b);e=Sv(this.g,f,a,b,null,c,10,d,this.j);e&496&&(f=Xv(e,f),b=Xv(e,b),Sv(this.g,f,a,b,null,c,this.i,d,this.j))}};function Xv(a,b){a&48&&(b^=2);a&192&&(b^=1);return b};function Yv(a,b,c,d){Wv.call(this,a,b,c||d);if(c||d)this.i=65|(d?32:132)}E(Yv,Wv);function Zv(){}E(Zv,dt);da(Zv);h=Zv.prototype;h.Hb=function(){return"button"};h.Oa=function(a,b,c){switch(b){case 8:case 16:ct(a,"pressed",c);break;default:case 64:case 1:Zv.m.Oa.call(this,a,b,c)}};h.U=function(a){var b=Zv.m.U.call(this,a);this.Ub(b,a.wb());var c=a.T();c&&this.Ne(b,c);a.ma&16&&this.Oa(b,16,kt(a,16));return b};h.ua=function(a,b){b=Zv.m.ua.call(this,a,b);var c=this.T(b);a.K=c;a.ae(this.wb(b));a.ma&16&&this.Oa(b,16,kt(a,16));return b};h.T=ca;h.Ne=ca;h.wb=function(a){return a.title};
h.Ub=function(a,b){a&&b&&(a.title=b)};h.C=function(){return"goog-button"};function $v(){}E($v,Zv);da($v);h=$v.prototype;h.Hb=function(){};h.U=function(a){wt(a);a.Wb&=-256;At(a,32,!1);return a.g.A("button",{"class":ft(this,a).join(" "),disabled:!a.isEnabled(),title:a.wb()||"",value:a.T()||""},a.Gb()||"")};h.Hd=function(a){return"BUTTON"==a.tagName||"INPUT"==a.tagName&&("button"==a.type||"submit"==a.type||"reset"==a.type)};h.ua=function(a,b){wt(a);a.Wb&=-256;At(a,32,!1);if(b.disabled){var c=this.Mc(1);pt(b,c)}return $v.m.ua.call(this,a,b)};
h.ag=function(a){Gs(a).listen(a.p(),"click",a.Pb)};h.Jd=ca;h.Ve=ca;h.Ue=function(a){return a.isEnabled()};h.Uc=ca;h.R=function(a,b,c){$v.m.R.call(this,a,b,c);(a=a.p())&&1==b&&(a.disabled=c)};h.T=function(a){return a.value};h.Ne=function(a,b){a&&(a.value=b)};h.Oa=ca;function aw(a,b,c){$.call(this,a,b||$v.Y(),c)}E(aw,$);h=aw.prototype;h.T=function(){return this.K};h.Zf=function(a){this.K=a;this.i.Ne(this.p(),a)};h.wb=function(){return this.H};h.Ub=function(a){this.H=a;this.i.Ub(this.p(),a)};h.ae=function(a){this.H=a};h.G=function(){aw.m.G.call(this);delete this.K;delete this.H};h.S=function(){aw.m.S.call(this);if(this.ma&32){var a=this.i.fc(this);a&&Gs(this).listen(a,"keyup",this.yc)}};
h.yc=function(a){return 13==a.g&&"key"==a.type||32==a.g&&"keyup"==a.type?this.Pb(a):32==a.g};ut("goog-button",function(){return new aw(null)});function bw(){}E(bw,Zv);da(bw);h=bw.prototype;h.U=function(a){var b=ft(this,a),b=a.g.A("div",{"class":"goog-inline-block "+b.join(" ")},this.yd(a.ra(),a.g));this.Ub(b,a.wb());gt(this,a,b);return b};h.Hb=function(){return"button"};h.za=function(a){return a&&a.firstChild.firstChild};h.yd=function(a,b){return b.A("div","goog-inline-block "+(this.C()+"-outer-box"),b.A("div","goog-inline-block "+(this.C()+"-inner-box"),a))};h.Hd=function(a){return"DIV"==a.tagName};
h.ua=function(a,b){cw(b,!0);cw(b,!1);var c;a:{c=a.g.Wf(b);var d=this.C()+"-outer-box";if(c&&ot(c,d)&&(c=a.g.Wf(c),d=this.C()+"-inner-box",c&&ot(c,d))){c=!0;break a}c=!1}c||b.appendChild(this.yd(b.childNodes,a.g));qt(b,["goog-inline-block",this.C()]);return bw.m.ua.call(this,a,b)};h.C=function(){return"goog-custom-button"};
function cw(a,b){if(a)for(var c=b?a.firstChild:a.lastChild,d;c&&c.parentNode==a;){d=b?c.nextSibling:c.previousSibling;if(3==c.nodeType){var e=c.nodeValue;if(""==va(e))a.removeChild(c);else{c.nodeValue=b?e.replace(/^[\s\xa0]+/,""):e.replace(/[\s\xa0]+$/,"");break}}else break;c=d}};function dw(){}E(dw,bw);da(dw);Jb&&(dw.prototype.xc=function(a,b){var c=dw.m.za.call(this,a&&a.firstChild);if(c){var d;d=Mg(a).A("div","goog-inline-block "+(this.C()+"-caption"),b);var e=c.parentNode;e&&e.replaceChild(d,c)}});h=dw.prototype;h.za=function(a){a=dw.m.za.call(this,a&&a.firstChild);Jb&&a&&a.__goog_wrapper_div&&(a=a.firstChild);return a};h.Oa=function(a,b,c){64!=b&&dw.m.Oa.call(this,a,b,c)};
h.ua=function(a,b){var c=Qg(document,"*","goog-menu",b)[0];if(c){T(c,!1);Og(c).body.appendChild(c);var d=new Ov;Js(d,c);a.dd(d)}return dw.m.ua.call(this,a,b)};h.yd=function(a,b){return dw.m.yd.call(this,[b.A("div","goog-inline-block "+(this.C()+"-caption"),a),b.A("div","goog-inline-block "+(this.C()+"-dropdown"),"\u00a0")],b)};h.C=function(){return"goog-menu-button"};function ew(a,b,c,d){aw.call(this,a,c||dw.Y(),d);At(this,64,!0);this.n=new Yv(null,5);b&&this.dd(b);this.ca=new lf(500);!Sh&&!Th||Wb("533.17.9")||(this.Nd=!0)}E(ew,aw);h=ew.prototype;h.Nd=!1;h.S=function(){ew.m.S.call(this);this.h&&fw(this,this.h,!0);ct(this.W,"haspopup",!!this.h)};h.qb=function(){ew.m.qb.call(this);if(this.h){this.oa(!1);this.h.qb();fw(this,this.h,!1);var a=this.h.p();a&&Zg(a)}};h.G=function(){ew.m.G.call(this);this.h&&(this.h.qa(),delete this.h);delete this.na;this.ca.qa()};
h.Vc=function(a){ew.m.Vc.call(this,a);kt(this,4)&&(this.oa(!kt(this,64),a),this.h&&(this.h.Cb=kt(this,64)))};h.gc=function(a){ew.m.gc.call(this,a);this.h&&!kt(this,4)&&(this.h.Cb=!1)};h.Pb=function(){zt(this,!1);return!0};h.$g=function(a){this.h&&this.h.Na&&!this.We(a.target)&&this.oa(!1)};h.We=function(a){var b;if(!(b=a&&ah(this.p(),a))){if(b=this.h)a:if(b=this.h,ah(b.p(),a))b=!0;else{for(var c=0,d=Ls(b);c<d;c++){var e=Ms(b,c);if("function"==typeof e.We&&e.We(a)){b=!0;break a}}b=!1}b=b||!1}return b};
h.yc=function(a){if(32==a.g){if(a.preventDefault(),"keyup"!=a.type)return!0}else if("key"!=a.type)return!1;if(this.h&&this.h.Na){var b=this.h.bb(a);return 27==a.g?(this.oa(!1),!0):b}return 40==a.g||38==a.g||32==a.g||13==a.g?(this.oa(!0),!0):!1};h.Ye=function(){this.oa(!1)};h.ih=function(){kt(this,4)||this.oa(!1)};h.Kd=function(a){this.Nd||this.oa(!1);ew.m.Kd.call(this,a)};
h.dd=function(a){var b=this.h;if(a!=b&&(b&&(this.oa(!1),this.Z&&fw(this,b,!1),delete this.h),this.Z&&ct(this.W,"haspopup",!!a),a)){this.h=a;Hs(a,this);a.Tc(!1);var c=this.Nd;(a.se=c)&&Vt(a,!0);this.Z&&fw(this,a,!0)}return b};h.setEnabled=function(a){ew.m.setEnabled.call(this,a);this.isEnabled()||this.oa(!1)};
h.oa=function(a,b){ew.m.oa.call(this,a);if(this.h&&kt(this,64)==a){if(a)this.h.Z||this.h.render(),this.V=zi(this.p()),this.P=Fi(this.p()),gw(this),this.h.Sb(-1);else{zt(this,!1);this.h.Cb=!1;var c=this.p();c&&ct(c,"activedescendant","");if(null!=this.o&&(this.o=void 0,c=this.h.p())){var d="",e;d instanceof Lg?(e=d.height,d=d.width):e="";c.style.width=Ci(d,!0);c.style.height=Ci(e,!0)}}this.h.Tc(a,!1,b);this.I||(c=Gs(this),d=a?c.listen:c.Ca,d.call(c,this.g.g,"mousedown",this.$g,!0),this.Nd&&d.call(c,
this.h,"blur",this.ih),d.call(c,this.ca,nf,this.vh),a?mf(this.ca):this.ca.stop())}};function gw(a){if(a.h.Z){var b=a.na||a.p(),c=a.n;a.n.g=b;b=a.h.p();a.h.Na||(b.style.visibility="hidden",T(b,!0));!a.o&&a.n.n&&a.n.i&32&&(a.o=Di(b));c.l(b,c.h^1,null,a.o);a.h.Na||(T(b,!1),b.style.visibility="visible")}}
h.vh=function(){var a=Fi(this.p()),b=zi(this.p()),c=this.P;(c=!(c==a||c&&a&&c.left==a.left&&c.width==a.width&&c.top==a.top&&c.height==a.height))||(c=this.V,c=!(c==b||c&&b&&c.top==b.top&&c.right==b.right&&c.bottom==b.bottom&&c.left==b.left));c&&(this.P=a,this.V=b,gw(this))};function fw(a,b,c){var d=Gs(a);c=c?d.listen:d.Ca;c.call(d,b,"action",a.Ye);c.call(d,b,"highlight",a.Ug);c.call(d,b,"unhighlight",a.Vg)}h.Ug=function(a){var b=this.p();null!=a.target.p()&&ct(b,"activedescendant",a.target.p().id)};
h.Vg=function(){if(!Qt(this.h)){var a=this.p();ct(a,"activedescendant","")}};ut("goog-menu-button",function(){return new ew(null)});function hw(a){L.call(this);this.g=[];iw(this,a)}E(hw,L);hw.prototype.h=null;function iw(a,b){b&&(Oa(b,function(a){jw(a,!1)},a),ab(a.g,b))}hw.prototype.Cd=function(){return $a(this.g)};function kw(a){var b=a.h;return b?Na(a.g,b):-1}hw.prototype.clear=function(){Wa(this.g);this.h=null};hw.prototype.G=function(){hw.m.G.call(this);delete this.g;this.h=null};function jw(a,b){a&&"function"==typeof a.Cc&&a.Cc(b)};function lw(a,b,c,d){ew.call(this,a,b,c,d);this.s=this.ra()}E(lw,ew);h=lw.prototype;h.ka=null;h.S=function(){lw.m.S.call(this);mw(this);nw(this)};h.Yb=function(a){lw.m.Yb.call(this,a);(a=this.Gb())?(this.s=a,mw(this)):this.ka&&ow(this,this.ka.g[0]||null)};h.G=function(){lw.m.G.call(this);this.ka&&(this.ka.qa(),this.ka=null);this.s=null};h.Ye=function(a){ow(this,a.target);lw.m.Ye.call(this,a);a.Rc();this.dispatchEvent("action")};h.lh=function(){var a=pw(this);lw.m.Zf.call(this,a&&a.T());mw(this)};
h.dd=function(a){var b=lw.m.dd.call(this,a);a!=b&&(this.ka&&this.ka.clear(),a&&(this.ka?Ks(a,function(a){qw(a);var b=this.ka,e=b.g.length;a&&(jw(a,!1),bb(b.g,e,0,a))},this):rw(this,a)));return b};function ow(a,b){if(a.ka){var c=pw(a),d=a.ka;b!=d.h&&(jw(d.h,!1),d.h=b,jw(b,!0));d.dispatchEvent("select");b!=c&&a.dispatchEvent("change")}}h.Zf=function(a){if(null!=a&&this.ka)for(var b=0,c;c=this.ka.g[b]||null;b++)if(c&&"function"==typeof c.T&&c.T()==a){ow(this,c);return}ow(this,null)};
function pw(a){return a.ka?a.ka.h:null}function rw(a,b){a.ka=new hw;b&&Ks(b,function(a){qw(a);var b=this.ka,e=b.g.length;a&&(jw(a,!1),bb(b.g,e,0,a))},a);nw(a)}function nw(a){a.ka&&Gs(a).listen(a.ka,"select",a.lh)}function mw(a){var b=pw(a),b=b?b.Gb():a.s;a.i.xc(a.p(),b);a.Ib=b}function qw(a){a.nf=a instanceof Kv?"option":"separator"}h.oa=function(a,b){lw.m.oa.call(this,a,b);kt(this,64)&&(this.h||this.dd(new Ov(this.g)),(this.h||null).Sb(this.ka?kw(this.ka):-1))};ut("goog-select",function(){return new lw(null)});function sw(){}E(sw,dw);da(sw);sw.prototype.C=function(){return"goog-toolbar-menu-button"};function tw(a,b,c,d){lw.call(this,a,b,c||sw.Y(),d)}E(tw,lw);ut("goog-toolbar-select",function(){return new tw(null)});function uw(){}E(uw,dt);da(uw);h=uw.prototype;h.Hb=function(){};function vw(a,b,c,d){var e=d.A("div",a.C()+"-inner-box");a=d.A("div",a.C()+"-outer-box",e);d.appendChild(b,a);d.appendChild(e,c)}h.ua=function(a,b){var c=a.g,d=b;b=c.A("div","goog-inline-block");c.rh(b,d);vw(this,b,d,c);uw.m.ua.call(this,a,b);a.Ib=d.value;return b};h.U=function(a){var b=a.g,c=b.A("div","goog-inline-block "+ft(this,a).join(" "));a=b.A("input",{type:"text",value:a.ra()||"",disabled:!a.isEnabled()});vw(this,c,a,b);return c};
h.Hd=function(a){return"INPUT"==a.tagName&&(!a.type||"TEXT"==a.type.toUpperCase())};h.za=function(a){if(a)a:{a=a.getElementsByTagName("input");for(var b=0;b<a.length;++b){var c=a[b];if(!c.type||"TEXT"==c.type.toUpperCase()){a=c;break a}}a=null}else a=null;return a};h.fc=function(a){return this.za(a.p())};h.Ve=ca;h.Ue=function(a){return a.isEnabled()};h.Uc=ca;h.R=function(a,b,c){uw.m.R.call(this,a,b,c);1==b&&(a=this.za(a.p()))&&(a.disabled=c)};h.Oa=ca;
h.xc=function(a,b){var c=this.za(a);c&&(c.value=b)};h.ra=function(a){return(a=this.za(a))?a.value:null};h.C=function(){return"wgui-textinput"};function ww(a,b,c){$.call(this,a,b||uw.Y(),c);wt(this);this.od=!0;(b=this.p())&&this.i.Jd(b,!0);this.Wb&=-256;At(this,32,!1);a||(this.Ib="")}E(ww,$);ww.prototype.S=function(){ww.m.S.call(this);var a=this.i.fc(this);if(a){var b=this.j||(this.j=new Ts);Us(b,a);Gs(this).listen(b,"key",this.bb)}};ww.prototype.ra=function(){return this.p()?this.i.ra(this.p()):null};ww.prototype.T=function(){return this.ra()};ww.prototype.Gb=function(){return this.ra()||""};function xw(a){L.call(this);this.parent=a;this.result=this.g=null}E(xw,L);h=xw.prototype;h.getParent=function(){return this.parent};h.ha=function(){return this.g};function yw(a){if(a.g)return a.g.pa();if(a.result)return a.result.storeName;throw Error("No module name");}h.M=function(){return this.parent.M()};
function zw(a,b){b.record?a.g=b.record:a.g=null;a.result=b;a.dispatchEvent(new K("change",a));a.g||a.parent.send("list",[{store:a.result.storeName,index:"id",key:a.result.primaryKey}]).B(function(a){a=a[0].result;a[0]&&(this.g=new wu(this.parent,new Qq(this.parent.M(),nq[nq.indexOf(this.result.storeName)],a[0])),this.dispatchEvent(new K("change",this)))},a)}h.clear=function(){if(this.g||this.result)this.result=this.g=null,this.dispatchEvent(new K("change",this))};
h.toString=function(){return"ydn.crm.sugar.model.Result:"+this.g};h.Va=function(){return!this.g&&!this.result};function Aw(){}E(Aw,dt);da(Aw);Aw.prototype.C=function(){return"search-result sugar-panel"};Aw.prototype.U=function(a){var b=Aw.m.U.call(this,a),c=a.g,d=c.A("div","record-header"),e=c.A("div","record-body");b.appendChild(d);b.appendChild(e);a=yw(a.L);e=c.A("a","title");c=c.A("span",{"class":"icon"},a.substr(0,2));d.appendChild(c);d.appendChild(e);d.classList.add(a);return b};
Aw.prototype.refresh=function(a){var b=a.L,c=a.p();if((b=b.ha())&&b.g&&b.g.g){var d=Pg("record-header",a.p()),e=b.pa();d.className="record-header "+e;a=Pg("title",d);d=Pg("icon",d);a.textContent=Rq(b.ha());d.textContent=e.substring(0,2);b=b.ha();b=qq(b.domain,b.X,b.D());a.href=b;T(c,!0)}else T(c,!1)};function Bw(a,b){$.call(this,null,null,a);this.la(b);var c=new Qq(b.M(),yw(b)),c=new wu(b.getParent(),c);this.h=new cv(c,null,a);this.ba(this.h,!0);Gs(this).listen(b,"change",this.n,!0)}E(Bw,$);Bw.prototype.n=function(a){var b=this.h.L,c=this.L.ha();b.Tb(c?c.ha():null);this.i.refresh(this);this.h.refresh(a)};st(Bw,Aw);function Cw(a,b){Cs.call(this,a);this.la(b);this.i=new Cs(a);this.h=null;this.j=[];this.n=0}E(Cw,Cs);Cw.prototype.Ia=function(){Cw.m.Ia.call(this);var a=this.g,b=this.p(),c=a.A("div","header");b.appendChild(c);this.h=new Rv(null,null,a);for(var d=new Ov(a),e=0;e<oq.length;e++)d.ba(new Kv(oq[e]),!0);d=new tw("Module",d,null,a);this.h.ba(d,!0);this.h.ba(new ww(""),!0);this.h.render(c);a=a.A("div","content");b.appendChild(a);this.ba(this.i,!0)};
Cw.prototype.S=function(){Cw.m.S.call(this);var a=Ms(this.h,1);Gs(this).listen(a,"action",this.o,!0)};function Dw(a,b){if(b){for(var c=Ls(a.i),d=0;d<c;d++){var e=Ms(a.i,d).L;if(e.Va()){zw(e,b);return}}30<c?zw(Ms(a.i,0).L,b):(c=new xw(a.L),zw(c,b),c=new Bw(a.g,c),a.i.ba(c,!0))}}
function Ew(a,b,c,d){Pu(a.L,b,c,d).t(function(a){var b=a[0];if(b.result[0]){a=nq[nq.indexOf(b.store)];var g=new yu(this.L,a),b=new Qq(this.L.M(),a,b.result[0]);g.Tb(b);b=b.D();Dw(this,{storeName:a,primaryKey:b,record:g,value:d,tokens:[{keyPath:c}]})}Fw(this)},function(a){Fw(this);throw a;},a)}
function Gw(a,b){0==a.n&&(a.n=b);var c=100*(a.n-b)/a.n,d=Ms(a.h,1).p(),d=Qg(document,"input",null,d)[0].style,e=["rgb(255, 255, 255) 0%"];e[1]="rgb(255, 255, 255) "+c.toFixed(1)+"%";e[2]="rgb(135,224,253) "+(c+0.1).toFixed(1)+"%";e[3]="rgb(135,224,253) 100%";d.background="linear-gradient(to right, "+e.join(", ")+")"}
function Fw(a){var b=a.j[0];if(b){b.Ec++;Gw(a,3*(a.j.length-1)+(3-b.Ec));var c=a.L;0==b.Ec?Ew(a,b.X,"ydn$emails",b.bd):1==b.Ec?(c=b.bd.match(/\d/g),3>(c?c.length:0)?Fw(a):Ew(a,b.X,"ydn$phones",b.bd)):2==b.Ec?Qu(c,b.X,b.bd).t(function(a){a=a[0].result;for(var b=a.length||0,c=0;c<b;c++)Dw(this,a[c]);Fw(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&Fw(a))}}
Cw.prototype.o=function(){var a=Ms(this.h,1).ra();if(a&&(a=a.trim(),2<=a.length)){var b;b=(b=pw(Ms(this.h,0)))?b.Gb():null;this.j.length=0;if(b)this.j[0]={X:b,bd:a,Ec:-1};else for(b=0;b<oq.length;b++)this.j[b]={X:oq[b],bd:a,Ec:-1};for(a=Ls(this.i)-1;0<=a;a--)Ms(this.i,a).L.clear();this.n=0;Fw(this)}};Cw.prototype.Sa=function(){return Pg("content",this.p())};function Hw(a,b,c){Kv.call(this,a,b,c);At(this,8,!0);if(a=this.p())b=this.i,a&&(bt(a,"menuitemradio"),Hv(b,this,a,!0))}E(Hw,Kv);Hw.prototype.Pb=function(){return this.dispatchEvent("action")};ut("goog-option",function(){return new Hw(null)});function Iw(){}E(Iw,bw);da(Iw);Iw.prototype.C=function(){return"goog-toolbar-button"};function Jw(a,b,c){aw.call(this,a,b||Iw.Y(),c)}E(Jw,aw);ut("goog-toolbar-button",function(){return new Jw(null)});function Kw(a,b,c,d){ew.call(this,a,b,c||sw.Y(),d)}E(Kw,ew);ut("goog-toolbar-menu-button",function(){return new Kw(null)});function Lw(a,b){Mv.call(this,a||Pv.Y(),b)}E(Lw,Mv);ut("goog-toolbar-separator",function(){return new Lw});function Mw(a,b,c){aw.call(this,a,b||bw.Y(),c);At(this,16,!0)}E(Mw,aw);ut("goog-toggle-button",function(){return new Mw(null)});function Nw(a,b,c){Mw.call(this,a,b||Iw.Y(),c)}E(Nw,Mw);ut("goog-toolbar-toggle-button",function(){return new Nw(null)});function Ow(){}E(Ow,dt);da(Ow);Ow.prototype.C=function(){return"record"};Ow.prototype.U=function(a){return Ow.m.U.call(this,a)};function Pw(a,b){$.call(this,null,null,a);this.la(b)}E(Pw,$);st(Pw,Ow);function Qw(a,b){Cs.call(this,a);this.la(b);this.i=new Cs(a);this.h=new Cs(a)}E(Qw,Cs);Qw.prototype.Sa=function(){return Pg("content",this.p())};
Qw.prototype.Ia=function(){Qw.m.Ia.call(this);var a=this.p(),b;b=new mh;b.Yf('<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>');b=
b.toString();A(b)?(La("Soy template output is unsafe for use as HTML: "+b),b="zSoyz"):b=String(b);a.innerHTML=b;Js(new Rv,Pg("goog-toolbar",a));this.ba(this.i,!0);this.ba(this.h,!0);T(this.h.p(),!1)};Qw.prototype.S=function(){Qw.m.S.call(this);this.p()};Qw.prototype.refresh=function(){};oa("ydn.crm.sugar.model.Sugar",Mu);oa("ydn.crm.ui.sugar.SyncPanel",Qw);oa("ydn.crm.ui.sugar.SearchPanel",Cw);oa("ydn.crm.inj.UserSetting",qv);qv.getInstance=sv;qv.prototype.getModuleInfo=qv.prototype.h;oa("ydn.msg.Pipe",Zc);oa("ydn.msg.initPipe",fd);oa("ydn.msg.getChannel",hd);Zc.prototype.listen=Zc.prototype.listen;Zc.prototype.getChannel=Zc.prototype.j;bd.prototype.send=bd.prototype.send;})();

            //# sourceMappingURL=ydn.crm.js.map
        