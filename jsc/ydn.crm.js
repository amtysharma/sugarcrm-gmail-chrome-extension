(function(){var h,aa=aa||{},r=this;function ba(a){a=a.split(".");for(var b=r,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}function ca(){}function da(a){a.U=function(){return a.Of?a.Of:a.Of=new a}}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function s(a){return void 0!==a}function u(a){return"array"==ea(a)}function v(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function w(a){return"string"==typeof a}function ga(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function ha(a){return"function"==ea(a)}function A(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ia(a){return a[ja]||(a[ja]=++ka)}
var ja="closure_uid_"+(1E9*Math.random()>>>0),ka=0;function la(a,b,c){return a.call.apply(a.bind,arguments)}function ma(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function B(a,b,c){B=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?la:ma;return B.apply(null,arguments)}function na(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var C=Date.now||function(){return+new Date};
function oa(a,b){var c=a.split("."),d=r;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function E(a,b){function c(){}c.prototype=b.prototype;a.m=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.mh=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function pa(a){Error.captureStackTrace?Error.captureStackTrace(this,pa):this.stack=Error().stack||"";a&&(this.message=String(a))}E(pa,Error);pa.prototype.name="CustomError";var qa;function ra(a,b){return 0==a.lastIndexOf(b,0)}function sa(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function ta(a){return/^[\s\xa0]*$/.test(a)}function ua(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}function va(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}function wa(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}
function xa(a){if(!ya.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(za,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Aa,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Ba,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ca,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Da,"&#39;"));return a}var za=/&/g,Aa=/</g,Ba=/>/g,Ca=/"/g,Da=/'/g,ya=/[&<>"']/;function Ea(a){return wa(a.replace(/  /g," &#160;"),void 0)}
function Fa(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ga={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ha={"'":"\\'"};
function Ia(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,k;if(!(k=Ga[d])){if(!(31<e&&127>e))if(d in Ha)d=Ha[d];else if(d in Ga)d=Ha[d]=Ga[d];else{e=d;k=d.charCodeAt(0);if(31<k&&127>k)e=d;else{if(256>k){if(e="\\x",16>k||256<k)e+="0"}else e="\\u",4096>k&&(e+="0");e+=k.toString(16).toUpperCase()}d=Ha[d]=e}k=d}f[g]=k}b.push('"');return b.join("")}function Ja(a,b){return a<b?-1:a>b?1:0};function Ka(a,b){b.unshift(a);pa.call(this,sa.apply(null,b));b.shift()}E(Ka,pa);Ka.prototype.name="AssertionError";function La(a,b){throw new Ka("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Ma=Array.prototype,Na=Ma.indexOf?function(a,b,c){return Ma.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(w(a))return w(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Oa=Ma.forEach?function(a,b,c){Ma.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Pa=Ma.filter?function(a,b,c){return Ma.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,g=w(a)?a.split(""):a,k=0;k<d;k++)if(k in g){var l=g[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},Qa=Ma.map?function(a,b,c){return Ma.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=w(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ra=Ma.some?function(a,b,c){return Ma.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},Sa=Ma.every?function(a,b,c){return Ma.every.call(a,b,c)}:function(a,
b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Ta(a,b){var c=Ua(a,b,void 0);return 0>c?null:w(a)?a.charAt(c):a[c]}function Ua(a,b,c){for(var d=a.length,e=w(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Va(a,b){return 0<=Na(a,b)}function Wa(a){if(!u(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Xa(a,b){var c=Na(a,b),d;(d=0<=c)&&Ma.splice.call(a,c,1);return d}
function Ya(a){return Ma.concat.apply(Ma,arguments)}function Za(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function $a(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(u(d)||(e=v(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,k=0;k<g;k++)a[f+k]=d[k];else a.push(d)}}function ab(a,b,c,d){Ma.splice.apply(a,bb(arguments,1))}
function bb(a,b,c){return 2>=arguments.length?Ma.slice.call(a,b):Ma.slice.call(a,b,c)}function cb(a,b){if(!v(a)||!v(b)||a.length!=b.length)return!1;for(var c=a.length,d=db,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function eb(a,b){return a>b?1:a<b?-1:0}function db(a,b){return a===b}function fb(a,b){var c;c=gb||eb;for(var d=0,e=a.length,f;d<e;){var g=d+e>>1,k;k=c(b,a[g]);0<k?d=g+1:(e=g,f=!k)}c=f?d:~d;0>c&&ab(a,-(c+1),0,b)};function hb(a){return function(){throw a;}};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function G(a,b){this.l=[];this.I=a;this.C=b||null}h=G.prototype;h.gb=!1;h.Cb=!1;h.xc=!1;h.xf=!1;h.bf=!1;h.cd=0;function ib(a,b){if(a.gb)a.i instanceof G&&ib(a.i);else{if(a.h){var c=a.h;delete a.h;b?ib(c,b):(c.cd--,0>=c.cd&&ib(c))}a.I?a.I.call(a.C,a):a.bf=!0;a.gb||a.u(new jb)}}h.jd=function(a,b){this.xc=!1;kb(this,a,b)};function kb(a,b,c){a.gb=!0;a.i=c;a.Cb=!b;a.oe()}function lb(a){if(a.gb){if(!a.bf)throw new mb;a.bf=!1}}h.t=function(a){lb(this);kb(this,!0,a)};h.u=function(a){lb(this);kb(this,!1,a)};
h.D=function(a,b){return this.w(a,null,b)};h.wc=function(a,b){return this.w(null,a,b)};h.aa=function(a,b){return this.w(a,a,b)};h.w=function(a,b,c){this.l.push([a,b,c]);this.gb&&this.oe();return this};function nb(a,b){a.w(b.t,b.u,b)}function ob(a){return Ra(a.l,function(a){return ha(a[1])})}
h.oe=function(){this.n&&this.gb&&ob(this)&&(r.clearTimeout(this.n),delete this.n);this.h&&(this.h.cd--,delete this.h);for(var a=this.i,b=!1,c=!1;this.l.length&&!this.xc;){var d=this.l.shift(),e=d[0],f=d[1],d=d[2];if(e=this.Cb?f:e)try{var g=e.call(d||this.C,a);s(g)&&(this.Cb=this.Cb&&(g==a||g instanceof Error),this.i=a=g);a instanceof G&&(this.xc=c=!0)}catch(k){a=k,this.Cb=!0,ob(this)||(b=!0)}}this.i=a;c&&(a.w(B(this.jd,this,!0),B(this.jd,this,!1)),a.xf=!0);b&&(this.n=r.setTimeout(hb(a),0))};
function pb(a){var b=new G;b.t(a);return b}function qb(a){var b=new G;b.u(a);return b}function rb(a){Error.captureStackTrace?Error.captureStackTrace(this,rb):this.stack=Error().stack||"";a&&(this.message=String(a))}E(rb,Error);function mb(){rb.call(this)}E(mb,rb);mb.prototype.message="Deferred has already fired";mb.prototype.name="AlreadyCalledError";function jb(){rb.call(this)}E(jb,rb);jb.prototype.message="Deferred was canceled";jb.prototype.name="CanceledError";function sb(){0!=tb&&(ub[ia(this)]=this)}var tb=0,ub={};sb.prototype.C=!1;sb.prototype.Aa=function(){if(!this.C&&(this.C=!0,this.J(),0!=tb)){var a=ia(this);delete ub[a]}};sb.prototype.J=function(){if(this.Kb)for(;this.Kb.length;)this.Kb.shift()()};var vb,wb,xb,yb,zb,Ab;function Bb(){return r.navigator?r.navigator.userAgent:null}function Cb(){return r.navigator}zb=yb=xb=wb=vb=!1;var Db;if(Db=Bb()){var Eb=Cb();vb=ra(Db,"Opera");wb=!vb&&(-1!=Db.indexOf("MSIE")||-1!=Db.indexOf("Trident"));yb=(xb=!vb&&-1!=Db.indexOf("WebKit"))&&-1!=Db.indexOf("Mobile");zb=!vb&&!xb&&!wb&&"Gecko"==Eb.product}var Fb=vb,H=wb,Gb=zb,Hb=xb,Ib=yb,Jb=Cb();Ab=-1!=(Jb&&Jb.platform||"").indexOf("Mac");var Kb=!!Cb()&&-1!=(Cb().appVersion||"").indexOf("X11");
function Lb(){var a=r.document;return a?a.documentMode:void 0}var Mb;a:{var Nb="",Ob;if(Fb&&r.opera)var Pb=r.opera.version,Nb="function"==typeof Pb?Pb():Pb;else if(Gb?Ob=/rv\:([^\);]+)(\)|;)/:H?Ob=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Hb&&(Ob=/WebKit\/(\S+)/),Ob)var Qb=Ob.exec(Bb()),Nb=Qb?Qb[1]:"";if(H){var Rb=Lb();if(Rb>parseFloat(Nb)){Mb=String(Rb);break a}}Mb=Nb}var Sb={};
function Tb(a){var b;if(!(b=Sb[a])){b=0;for(var c=va(String(Mb)).split("."),d=va(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",l=/(\d*)(\D*)/g,m=/(\d*)(\D*)/g;do{var n=l.exec(g)||["","",""],p=m.exec(k)||["","",""];if(0==n[0].length&&0==p[0].length)break;b=Ja(0==n[1].length?0:parseInt(n[1],10),0==p[1].length?0:parseInt(p[1],10))||Ja(0==n[2].length,0==p[2].length)||Ja(n[2],p[2])}while(0==b)}b=Sb[a]=0<=b}return b}
var Ub=r.document,Vb=Ub&&H?Lb()||("CSS1Compat"==Ub.compatMode?parseInt(Mb,10):5):void 0;var Wb=!H||H&&9<=Vb,Xb=!H||H&&9<=Vb,Yb=H&&!Tb("9");!Hb||Tb("528");Gb&&Tb("1.9b")||H&&Tb("8")||Fb&&Tb("9.5")||Hb&&Tb("528");Gb&&!Tb("8")||H&&Tb("9");function K(a,b){this.type=a;this.i=this.target=b}h=K.prototype;h.Aa=function(){};h.Ib=!1;h.Wf=!0;h.Ec=function(){this.Ib=!0};h.preventDefault=function(){this.Wf=!1};function Zb(a){Zb[" "](a);return a}Zb[" "]=ca;function $b(a,b){K.call(this,a?a.type:"");this.j=this.i=this.target=null;this.g=this.clientY=this.clientX=0;this.l=this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.h=null;a&&this.init(a,b)}E($b,K);var ac=[1,4,2];
$b.prototype.init=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.i=b;var d=a.relatedTarget;if(d){if(Gb){var e;a:{try{Zb(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.j=d;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.g=a.keyCode||0;this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.l=Ab?a.metaKey:
a.ctrlKey;this.h=a;a.defaultPrevented&&this.preventDefault();delete this.Ib};function bc(a){return Wb?0==a.h.button:"click"==a.type?!0:!!(a.h.button&ac[0])}$b.prototype.Ec=function(){$b.m.Ec.call(this);this.h.stopPropagation?this.h.stopPropagation():this.h.cancelBubble=!0};$b.prototype.preventDefault=function(){$b.m.preventDefault.call(this);var a=this.h;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Yb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var dc="closure_listenable_"+(1E6*Math.random()|0);function ec(a){try{return!(!a||!a[dc])}catch(b){return!1}}var fc=0;function gc(a,b,c,d,e){this.Xb=a;this.proxy=null;this.src=b;this.type=c;this.ed=!!d;this.xd=e;this.key=++fc;this.removed=this.dd=!1}function hc(a){a.removed=!0;a.Xb=null;a.proxy=null;a.src=null;a.xd=null};function ic(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function jc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function kc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function lc(a,b){for(var c=v(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],s(a));c++);return a}function mc(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');a[b]=c}function nc(a,b){return b in a?a[b]:void 0}function oc(a){var b={},c;for(c in a)b[c]=a[c];return b}var pc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function qc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<pc.length;f++)c=pc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};function rc(a){this.src=a;this.g={};this.h=0}rc.prototype.add=function(a,b,c,d,e){var f=this.g[a];f||(f=this.g[a]=[],this.h++);var g=sc(f,b,d,e);-1<g?(a=f[g],c||(a.dd=!1)):(a=new gc(b,this.src,a,!!d,e),a.dd=c,f.push(a));return a};rc.prototype.remove=function(a,b,c,d){if(!(a in this.g))return!1;var e=this.g[a];b=sc(e,b,c,d);return-1<b?(hc(e[b]),Ma.splice.call(e,b,1),0==e.length&&(delete this.g[a],this.h--),!0):!1};
function tc(a,b){var c=b.type;if(!(c in a.g))return!1;var d=Xa(a.g[c],b);d&&(hc(b),0==a.g[c].length&&(delete a.g[c],a.h--));return d}rc.prototype.removeAll=function(a){var b=0,c;for(c in this.g)if(!a||c==a){for(var d=this.g[c],e=0;e<d.length;e++)++b,hc(d[e]);delete this.g[c];this.h--}return b};function uc(a,b,c,d,e){a=a.g[b];b=-1;a&&(b=sc(a,c,d,e));return-1<b?a[b]:null}function sc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.Xb==b&&f.ed==!!c&&f.xd==d)return e}return-1};var vc="closure_lm_"+(1E6*Math.random()|0),wc={},xc=0;function yc(a,b,c,d,e){if(u(b)){for(var f=0;f<b.length;f++)yc(a,b[f],c,d,e);return null}c=zc(c);return ec(a)?a.listen(b,c,d,e):Ac(a,b,c,!1,d,e)}function Ac(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,k=Bc(a);k||(a[vc]=k=new rc(a));c=k.add(b,c,d,e,f);if(c.proxy)return c;d=Cc();c.proxy=d;d.src=a;d.Xb=c;a.addEventListener?a.addEventListener(b,d,g):a.attachEvent(b in wc?wc[b]:wc[b]="on"+b,d);xc++;return c}
function Cc(){var a=Dc,b=Xb?function(c){return a.call(b.src,b.Xb,c)}:function(c){c=a.call(b.src,b.Xb,c);if(!c)return c};return b}function Ec(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Ec(a,b[f],c,d,e);else c=zc(c),ec(a)?a.eb.add(String(b),c,!0,d,e):Ac(a,b,c,!0,d,e)}function Fc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Fc(a,b[f],c,d,e);else c=zc(c),ec(a)?a.ya(b,c,d,e):a&&(a=Bc(a))&&(b=uc(a,b,c,!!d,e))&&Gc(b)}
function Gc(a){if(y(a)||!a||a.removed)return!1;var b=a.src;if(ec(b))return tc(b.eb,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.ed):b.detachEvent&&b.detachEvent(c in wc?wc[c]:wc[c]="on"+c,d);xc--;(c=Bc(b))?(tc(c,a),0==c.h&&(c.src=null,b[vc]=null)):hc(a);return!0}function Hc(a,b,c,d){var e=1;if(a=Bc(a))if(b=a.g[b])for(b=Za(b),a=0;a<b.length;a++){var f=b[a];f&&f.ed==c&&!f.removed&&(e&=!1!==Ic(f,d))}return Boolean(e)}
function Ic(a,b){var c=a.Xb,d=a.xd||a.src;a.dd&&Gc(a);return c.call(d,b)}
function Dc(a,b){if(a.removed)return!0;if(!Xb){var c=b||ba("window.event"),d=new $b(c,this),e=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==c.returnValue)c.returnValue=!0}c=[];for(f=d.i;f;f=f.parentNode)c.push(f);for(var f=a.type,k=c.length-1;!d.Ib&&0<=k;k--)d.i=c[k],e&=Hc(c[k],f,!0,d);for(k=0;!d.Ib&&k<c.length;k++)d.i=c[k],e&=Hc(c[k],f,!1,d)}return e}return Ic(a,new $b(b,this))}
function Bc(a){a=a[vc];return a instanceof rc?a:null}var Jc="__closure_events_fn_"+(1E9*Math.random()>>>0);function zc(a){return ha(a)?a:a[Jc]||(a[Jc]=function(b){return a.handleEvent(b)})};function Kc(){sb.call(this);this.eb=new rc(this);this.vc=this}E(Kc,sb);Kc.prototype[dc]=!0;h=Kc.prototype;h.Hd=null;h.$e=function(a){this.Hd=a};h.removeEventListener=function(a,b,c,d){Fc(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.Hd;if(c)for(b=[];c;c=c.Hd)b.push(c);var c=this.vc,d=a.type||a;if(w(a))a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);qc(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.Ib&&0<=g;g--)f=a.i=b[g],e=Lc(f,d,!0,a)&&e;a.Ib||(f=a.i=c,e=Lc(f,d,!0,a)&&e,a.Ib||(e=Lc(f,d,!1,a)&&e));if(b)for(g=0;!a.Ib&&g<b.length;g++)f=a.i=b[g],e=Lc(f,d,!1,a)&&e;return e};h.J=function(){Kc.m.J.call(this);this.eb&&this.eb.removeAll(void 0);this.Hd=null};
h.listen=function(a,b,c,d){return this.eb.add(String(a),b,!1,c,d)};h.ya=function(a,b,c,d){return this.eb.remove(String(a),b,c,d)};function Lc(a,b,c,d){b=a.eb.g[String(b)];if(!b)return!0;b=Za(b);for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.ed==c){var k=g.Xb,l=g.xd||g.src;g.dd&&tc(a.eb,g);e=!1!==k.call(l,d)&&e}}return e&&!1!=d.Wf};function L(a){pa.call(this,a);this.name="ydn.error.ArgumentException"}E(L,pa);function Nc(a){pa.call(this,a);this.name="ydn.error.NotSupportedException"}E(Nc,pa);function Oc(a){pa.call(this,a);this.name="ydn.error.NotImplementedException"}E(Oc,pa);function Pc(a){pa.call(this,a);this.name="ydn.error.InvalidOperationException"}E(Pc,pa);
function Qc(a){Error.captureStackTrace?Error.captureStackTrace(this,Qc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}E(Qc,Error);Qc.prototype.name="ydn.error.InternalError";function Rc(a,b){G.call(this,a,b);this.j=[]}E(Rc,G);function Sc(a,b){for(var c=0;c<a.j.length;c++)a.j[c][0].call(a.j[c][1],b)}Rc.prototype.t=function(a){this.j.length=0;Rc.m.t.call(this,a)};Rc.prototype.u=function(a){this.j.length=0;Rc.m.u.call(this,a)};function Tc(a){this.id="i"+this.count();this.req=a;this.i=!0;this.g=this.h=null;this.j=new Rc;this.l=NaN}Tc.prototype.F=function(){return this.id};var Uc=0;Tc.prototype.count=function(){Uc++;return Uc};
Tc.prototype.listen=function(a){if(a&&a.id==this.id){this.h=a.data;var b=a.error;b&&(b instanceof Error?this.g=b:A(b)?(this.g=Error(b.message),this.g.name=b.name,this.g.source=b,this.g.result=this.h):(this.g=Error(b),this.g.name="UnknownError"));a.done?(this.i=!1,this.g?this.j.u(this.g):this.j.t(this.h),window.clearTimeout(this.l)):Sc(this.j,a.data);return!0}return!1};Tc.prototype.toString=function(){return"Message:"+this.id+(this.i?"*":"")};
Tc.prototype.toJSON=function(){var a=this;this.l=window.setTimeout(function(){if(a.i){var b=Error("message timeout");b.name="TimeOutError";a.listen({id:a.id,req:a.req,error:b})}},5E3);return{id:this.id,req:this.req,group:this.n,name:this.o,data:this.h}};function Vc(a){Kc.call(this);var b=w(a)?null:a;this.name=w(a)?a:a.name;this.g=[];this.l=b;this.h=null;this.i={}}E(Vc,Kc);Vc.prototype.J=function(){if(this.h){var a=this;this.h.disconnect(function(){a.h=null;a.g.length=0})}else this.g.length=0};function Wc(a){K.call(this,"post");this.message=a}E(Wc,K);Wc.prototype.getMessage=function(){return this.message};
Vc.prototype.j=function(a){if(a)if(a.id)for(var b=this.g.length-1;0<=b;b--){if(this.g[b].F()==a.id&&this.g[b].listen(a)){this.g[b].i?25<b&&(a=this.g.splice(b,1),this.g.unshift(a[0])):this.g.splice(b,1);break}}else"info"==a.req?(a.data=this.l,this.h.postMessage(a)):this.dispatchEvent(new Wc(a))};Vc.prototype.toString=function(){return"Pipe:"+this.name};
function Xc(a){if(!a.h){a.h=chrome.runtime.connect({name:a.name});var b=B(a.j,a);a.h.onMessage.addListener(b);a.h.onDisconnect.addListener(function(){a.h.onMessage.removeListener(b);a.h=null;a.g.length=0})}return a.h}var Yc=null,Zc=["gmail","host-permission","popup","options"];function $c(a,b){if(!Yc){var c="default-"+C();Yc=new Vc(c)}var c=Yc,d=a||"default",e=d+(b?"-"+b:"");c.i[e]||(c.i[e]=new ad(c,d,b||""));return c.i[e]}function ad(a,b,c){this.g=a;this.h=b;this.i=c}
ad.prototype.send=function(a,b){var c=new Tc(a),d=this.i;c.n=this.h;c.o=d;b&&(c.h=b);var d=c.j,e=this.g,f=c.toJSON();Xc(e).postMessage(f);e.g.push(c);50<e.g.length&&(e.g.length-=1);return d};function bd(a){if("function"==typeof a.ta)return a.ta();if(w(a))return a.split("");if(v(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return jc(a)}function cd(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(v(a)||w(a))Oa(a,b,c);else{var d;if("function"==typeof a.Ha)d=a.Ha();else if("function"!=typeof a.ta)if(v(a)||w(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=kc(a);else d=void 0;for(var e=bd(a),f=e.length,g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)}};var dd="StopIteration"in r?r.StopIteration:Error("StopIteration");function ed(){}ed.prototype.g=function(){throw dd;};ed.prototype.vb=function(){return this};function fd(a){if(a instanceof ed)return a;if("function"==typeof a.vb)return a.vb(!1);if(v(a)){var b=0,c=new ed;c.g=function(){for(;;){if(b>=a.length)throw dd;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function gd(a,b){if(v(a))try{Oa(a,b,void 0)}catch(c){if(c!==dd)throw c;}else{a=fd(a);try{for(;;)b.call(void 0,a.g(),void 0,a)}catch(d){if(d!==dd)throw d;}}}function hd(a){if(v(a))return Za(a);a=fd(a);var b=[];gd(a,function(a){b.push(a)});return b};function id(a,b){this.h={};this.g=[];this.j=this.i=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof id?(c=a.Ha(),d=a.ta()):(c=kc(a),d=jc(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=id.prototype;h.ca=function(){return this.i};h.ta=function(){jd(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a};h.Ha=function(){jd(this);return this.g.concat()};
h.Oa=function(){return 0==this.i};h.clear=function(){this.h={};this.j=this.i=this.g.length=0};h.remove=function(a){return kd(this.h,a)?(delete this.h[a],this.i--,this.j++,this.g.length>2*this.i&&jd(this),!0):!1};function jd(a){if(a.i!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];kd(a.h,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.i!=a.g.length){for(var e={},c=b=0;b<a.g.length;)d=a.g[b],kd(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}h.get=function(a,b){return kd(this.h,a)?this.h[a]:b};
h.set=function(a,b){kd(this.h,a)||(this.i++,this.g.push(a),this.j++);this.h[a]=b};h.ba=function(){return new id(this)};h.vb=function(a){jd(this);var b=0,c=this.g,d=this.h,e=this.j,f=this,g=new ed;g.g=function(){for(;;){if(e!=f.j)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw dd;var g=c[b++];return a?g:d[g]}};return g};function kd(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var ld=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function md(a){if(nd){nd=!1;var b=r.location;if(b){var c=b.href;if(c&&(c=(c=md(c)[3]||null)&&decodeURIComponent(c))&&c!=b.hostname)throw nd=!0,Error();}}return a.match(ld)}var nd=Hb;function od(a,b){var c;if(a instanceof od)this.Sb=s(b)?b:a.Sb,pd(this,a.ec),this.Rd=a.Rd,qd(this,a.wb),rd(this,a.sd),sd(this,a.bc),td(this,a.g.ba()),ud(this,a.pe);else if(a&&(c=md(String(a)))){this.Sb=!!b;pd(this,c[1]||"",!0);var d=c[2]||"";this.Rd=d?decodeURIComponent(d):"";qd(this,c[3]||"",!0);rd(this,c[4]);sd(this,c[5]||"",!0);td(this,c[6]||"",!0);ud(this,c[7]||"",!0)}else this.Sb=!!b,this.g=new vd(null,0,this.Sb)}h=od.prototype;h.ec="";h.Rd="";h.wb="";h.sd=null;h.bc="";h.pe="";h.Sb=!1;
h.toString=function(){var a=[],b=this.ec;b&&a.push(wd(b,yd),":");if(b=this.wb){a.push("//");var c=this.Rd;c&&a.push(wd(c,yd),"@");a.push(encodeURIComponent(String(b)));b=this.sd;null!=b&&a.push(":",String(b))}if(b=this.bc)this.wb&&"/"!=b.charAt(0)&&a.push("/"),a.push(wd(b,"/"==b.charAt(0)?zd:Ad));(b=this.g.toString())&&a.push("?",b);(b=this.pe)&&a.push("#",wd(b,Bd));return a.join("")};h.ba=function(){return new od(this)};
function pd(a,b,c){a.ec=c?b?decodeURIComponent(b):"":b;a.ec&&(a.ec=a.ec.replace(/:$/,""));return a}function Cd(a){return a.wb}function qd(a,b,c){a.wb=c?b?decodeURIComponent(b):"":b;return a}function rd(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.sd=b}else a.sd=null}function sd(a,b,c){a.bc=c?b?decodeURIComponent(b):"":b}function td(a,b,c){b instanceof vd?(a.g=b,Dd(a.g,a.Sb)):(c||(b=wd(b,Ed)),a.g=new vd(b,0,a.Sb))}
function ud(a,b,c){a.pe=c?b?decodeURIComponent(b):"":b}function wd(a,b){return w(a)?encodeURI(a).replace(b,Fd):null}function Fd(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var yd=/[#\/\?@]/g,Ad=/[\#\?:]/g,zd=/[\#\?]/g,Ed=/[\#\?@]/g,Bd=/#/g;function vd(a,b,c){this.g=a||null;this.h=!!c}
function Gd(a){if(!a.fa&&(a.fa=new id,a.Ea=0,a.g))for(var b=a.g.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=null,f=null;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=Hd(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}h=vd.prototype;h.fa=null;h.Ea=null;h.ca=function(){Gd(this);return this.Ea};h.add=function(a,b){Gd(this);this.g=null;a=Hd(this,a);var c=this.fa.get(a);c||this.fa.set(a,c=[]);c.push(b);this.Ea++;return this};
h.remove=function(a){Gd(this);a=Hd(this,a);return kd(this.fa.h,a)?(this.g=null,this.Ea-=this.fa.get(a).length,this.fa.remove(a)):!1};h.clear=function(){this.fa=this.g=null;this.Ea=0};h.Oa=function(){Gd(this);return 0==this.Ea};function Id(a,b){Gd(a);b=Hd(a,b);return kd(a.fa.h,b)}h.Ha=function(){Gd(this);for(var a=this.fa.ta(),b=this.fa.Ha(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
h.ta=function(a){Gd(this);var b=[];if(w(a))Id(this,a)&&(b=Ya(b,this.fa.get(Hd(this,a))));else{a=this.fa.ta();for(var c=0;c<a.length;c++)b=Ya(b,a[c])}return b};h.set=function(a,b){Gd(this);this.g=null;a=Hd(this,a);Id(this,a)&&(this.Ea-=this.fa.get(a).length);this.fa.set(a,[b]);this.Ea++;return this};h.get=function(a,b){var c=a?this.ta(a):[];return 0<c.length?String(c[0]):b};
h.toString=function(){if(this.g)return this.g;if(!this.fa)return"";for(var a=[],b=this.fa.Ha(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.ta(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.g=a.join("&")};h.ba=function(){var a=new vd;a.g=this.g;this.fa&&(a.fa=this.fa.ba(),a.Ea=this.Ea);return a};function Hd(a,b){var c=String(b);a.h&&(c=c.toLowerCase());return c}
function Dd(a,b){b&&!a.h&&(Gd(a),a.g=null,cd(a.fa,function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.g=null,this.fa.set(Hd(this,e),Za(a)),this.Ea+=a.length))},a));a.h=b};var Jd;
Jd={i:["BC","AD"],h:["Before Christ","Anno Domini"],o:"JFMAMJJASOND".split(""),X:"JFMAMJJASOND".split(""),n:"January February March April May June July August September October November December".split(" "),S:"January February March April May June July August September October November December".split(" "),B:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),ra:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),vc:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Kb:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
N:"Sun Mon Tue Wed Thu Fri Sat".split(" "),La:"Sun Mon Tue Wed Thu Fri Sat".split(" "),p:"SMTWTFS".split(""),ja:"SMTWTFS".split(""),I:["Q1","Q2","Q3","Q4"],C:["1st quarter","2nd quarter","3rd quarter","4th quarter"],g:["AM","PM"],kf:["EEEE, MMMM d, y","MMMM d, y","MMM d, y","M/d/yy"],rf:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],jg:["{1} 'at' {0}","{1} 'at' {0}","{1}, {0}","{1}, {0}"],j:6,Yc:[5,6],l:5};function Kd(a){this.h=[];this.g=Jd;"number"==typeof a?Ld(this,a):Md(this,a)}var Nd=[/^\'(?:[^\']|\'\')*\'/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|w+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvwzZ]+/];function Md(a,b){for(;b;)for(var c=0;c<Nd.length;++c){var d=b.match(Nd[c]);if(d){d=d[0];b=b.substring(d.length);0==c&&("''"==d?d="'":(d=d.substring(1,d.length-1),d=d.replace(/\'\'/,"'")));a.h.push({text:d,type:c});break}}}
function Ld(a,b){var c;if(4>b)c=a.g.kf[b];else if(8>b)c=a.g.rf[b-4];else if(12>b)c=a.g.jg[b-8],c=c.replace("{1}",a.g.kf[b-8]),c=c.replace("{0}",a.g.rf[b-8]);else{Ld(a,10);return}Md(a,c)}function Od(a){var b=Kd.prototype;if(void 0===b.g||void 0===b.g.qg)return a;for(var c=[],d=0;d<a.length;d++){var e=a.charCodeAt(d);c.push(48<=e&&57>=e?String.fromCharCode(b.g.qg+e-48):a.charAt(d))}return c.join("")};var Pd={hg:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},gg:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Qd=Pd,Qd=Pd;var Rd={mf:".",of:",",pf:"%",ce:"0",og:"+",lg:"-",nf:"E",qf:"\u2030",be:"\u221e",mg:"NaN",lf:"#,##0.###",pg:"#E0",ng:"#,##0%",ig:"\u00a4#,##0.00;(\u00a4#,##0.00)",kg:"USD"},Sd=Rd,Sd=Rd;var Td={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[0,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[18,"kr","kr"],DOP:[2,"$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[0,"Ft",
"Ft"],IDR:[0,"Rp","Rp"],ILS:[2,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],LVL:[2,"Ls","Ls"],MNT:[0,"\u20ae","MN\u20ae"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u0440\u0443\u0431.",
"\u0440\u0443\u0431."],SAR:[2,"Rial","Rial"],SEK:[2,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u20b4","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[0,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};function Ud(a,b,c){this.p=b||Sd.kg;this.Kb=c||Vd;this.I=40;this.g=1;this.ja=0;this.j=3;this.N=this.h=0;this.La=!1;this.B=this.l="";this.i="-";this.n="";this.C=1;this.X=3;this.S=this.ra=!1;this.o=Wd;if("number"==typeof a)switch(a){case 1:Xd(this,Sd.lf);break;case 2:Xd(this,Sd.pg);break;case 3:Xd(this,Sd.ng);break;case 4:a=Sd.ig;b=["0"];c=Td[this.p][0]&7;if(0<c){b.push(".");for(var d=0;d<c;d++)b.push("0")}a=a.replace(/0.00/g,b.join(""));Xd(this,a);break;case 5:Yd(this,1);break;case 6:Yd(this,2);break;
default:throw Error("Unsupported pattern type.");}else Xd(this,a)}var Vd=0,Wd=0;
function Xd(a,b){b.replace(/ /g,"\u00a0");var c=[0];a.l=Zd(a,b,c);for(var d=c[0],e=-1,f=0,g=0,k=0,l=-1,m=b.length,n=!0;c[0]<m&&n;c[0]++)switch(b.charAt(c[0])){case "#":0<g?k++:f++;0<=l&&0>e&&l++;break;case "0":if(0<k)throw Error('Unexpected "0" in pattern "'+b+'"');g++;0<=l&&0>e&&l++;break;case ",":l=0;break;case ".":if(0<=e)throw Error('Multiple decimal separators in pattern "'+b+'"');e=f+g+k;break;case "E":if(a.S)throw Error('Multiple exponential symbols in pattern "'+b+'"');a.S=!0;a.N=0;c[0]+1<
m&&"+"==b.charAt(c[0]+1)&&(c[0]++,a.La=!0);for(;c[0]+1<m&&"0"==b.charAt(c[0]+1);)c[0]++,a.N++;if(1>f+g||1>a.N)throw Error('Malformed exponential pattern "'+b+'"');n=!1;break;default:c[0]--,n=!1}0==g&&0<f&&0<=e&&(g=e,0==g&&g++,k=f-g,f=g-1,g=1);if(0>e&&0<k||0<=e&&(e<f||e>f+g)||0==l)throw Error('Malformed pattern "'+b+'"');k=f+g+k;a.j=0<=e?k-e:0;0<=e&&(a.h=f+g-e,0>a.h&&(a.h=0));a.g=(0<=e?e:k)-f;a.S&&(a.I=f+a.g,0==a.j&&0==a.g&&(a.g=1));a.X=Math.max(0,l);a.ra=0==e||e==k;d=c[0]-d;a.B=Zd(a,b,c);c[0]<b.length&&
b.charAt(c[0])==$d?(c[0]++,a.i=Zd(a,b,c),c[0]+=d,a.n=Zd(a,b,c)):(a.i=a.l+a.i,a.n+=a.B)}function Yd(a,b){a.o=b;Xd(a,Sd.lf);a.h=0;a.j=2;if(0<a.h)throw Error("Can't combine significant digits and minimum fraction digits");a.ja=2}
Ud.prototype.parse=function(a,b){var c=b||[0];if(this.o!=Wd)throw Error("Parsing of compact numbers is unimplemented");var d=NaN;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.l,c[0])==c[0],f=a.indexOf(this.i,c[0])==c[0];e&&f&&(this.l.length>this.i.length?f=!1:this.l.length<this.i.length&&(e=!1));e?c[0]+=this.l.length:f&&(c[0]+=this.i.length);if(a.indexOf(Sd.be,c[0])==c[0])c[0]+=Sd.be.length,d=Infinity;else{var d=a,g=!1,k=!1,l=!1,m=1,n=Sd.mf,p=Sd.of,q=Sd.nf;if(this.o!=Wd)throw Error("Parsing of compact style numbers is not implemented");
for(var t="";c[0]<d.length;c[0]++){var x=d.charAt(c[0]),z=ae(x);if(0<=z&&9>=z)t+=z,l=!0;else if(x==n.charAt(0)){if(g||k)break;t+=".";g=!0}else if(x==p.charAt(0)&&("\u00a0"!=p.charAt(0)||c[0]+1<d.length&&0<=ae(d.charAt(c[0]+1)))){if(g||k)break}else if(x==q.charAt(0)){if(k)break;t+="E";k=!0}else if("+"==x||"-"==x)t+=x;else if(x==Sd.pf.charAt(0)){if(1!=m)break;m=100;if(l){c[0]++;break}}else if(x==Sd.qf.charAt(0)){if(1!=m)break;m=1E3;if(l){c[0]++;break}}else break}d=parseFloat(t)/m}if(e){if(a.indexOf(this.B,
c[0])!=c[0])return NaN;c[0]+=this.B.length}else if(f){if(a.indexOf(this.n,c[0])!=c[0])return NaN;c[0]+=this.n.length}return f?-d:d};function be(a,b){var c=Math.pow(10,a.j),d=0>=a.ja?Math.round(b*c):Math.floor(ce(b*c,a.ja,a.j)),e;isFinite(d)?(e=Math.floor(d/c),c=Math.floor(d-e*c)):(e=b,c=0);return{Pf:e,ug:c}}
function de(a,b,c,d){if(a.h>a.j)throw Error("Min value must be less than max value");b=be(a,b);var e=Math.pow(10,a.j),f=b.Pf,g=b.ug,k=0<a.h||0<g||!1;b=a.h;k&&(b=a.h);for(var l="",m=f;1E20<m;)l="0"+l,m=Math.round(m/10);var l=m+l,n=Sd.mf,p=Sd.of,m=Sd.ce.charCodeAt(0),q=l.length;if(0<f||0<c){for(f=q;f<c;f++)d.push(String.fromCharCode(m));for(f=0;f<q;f++)d.push(String.fromCharCode(m+1*l.charAt(f))),1<q-f&&0<a.X&&1==(q-f)%a.X&&d.push(p)}else k||d.push(String.fromCharCode(m));(a.ra||k)&&d.push(n);a=""+
(g+e);for(c=a.length;"0"==a.charAt(c-1)&&c>b+1;)c--;for(f=1;f<c;f++)d.push(String.fromCharCode(m+1*a.charAt(f)))}function ee(a,b,c){c.push(Sd.nf);0>b?(b=-b,c.push(Sd.lg)):a.La&&c.push(Sd.og);b=""+b;for(var d=Sd.ce,e=b.length;e<a.N;e++)c.push(d);c.push(b)}function ae(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Sd.ce.charCodeAt(0);return b<=a&&a<b+10?a-b:-1}var $d=";";
function Zd(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var g=b.charAt(c[0]);if("'"==g)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case $d:return d;case "\u00a4":if(c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1))c[0]++,d+=a.p;else switch(a.Kb){case Vd:d+=Td[a.p][1];break;case 2:var g=a.p,k=Td[g],d=d+(g==k[1]?g:g+" "+k[1]);break;case 1:d+=Td[a.p][2]}break;case "%":if(1!=a.C)throw Error("Too many percent/permill");a.C=100;d+=Sd.pf;
break;case "\u2030":if(1!=a.C)throw Error("Too many percent/permill");a.C=1E3;d+=Sd.qf;break;default:d+=g}}return d}var fe={prefix:"",Yf:"",me:0};function ge(a,b){var c=1==a.o?Qd.hg:Qd.gg;if(3>b)return fe;b=Math.min(14,b);c=c[Math.pow(10,b)];if(!c)return fe;c=c.other;return c&&"0"!=c?(c=/([^0]*)(0+)(.*)/.exec(c))?{prefix:c[1],Yf:c[3],me:b-(c[2].length-1)}:fe:fe}function he(a){for(var b=0;1<=(a/=10);)b++;return b}
function ce(a,b,c){if(!a)return a;b=b-he(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};function ie(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"}var je=ie,je=ie;function ke(a){return 1==a?"one":"other"}var le=ke,le=ke;function me(a){this.g=[];this.i=[];this.j=new Ud(1);a&&(a=ne(this,a),this.i=oe(this,a))}var pe=/'([{}#].*?)'/g,qe=/''/g;
function re(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var g=b[f].value,k=a,l=e,m=c[g];s(m)?(k.g.push(m),l.push(k.h(k.g))):l.push("Undefined parameter - "+g);break;case 2:g=b[f].value;k=e;l=g.ad;s(c[l])?(l=g[c[l]],s(l)||(l=g.other),re(a,l,c,d,k)):k.push("Undefined parameter - "+l);break;case 0:g=b[f].value;se(a,g,c,le,d,e);break;case 1:g=b[f].value;se(a,g,c,je,d,e);break;default:La("Unrecognized block type.")}}
function se(a,b,c,d,e,f){var g=b.ad,k=b.vf,l=+c[g];if(isNaN(l))f.push("Undefined or invalid parameter - "+g);else if(k=l-k,g=b[c[g]],s(g)||(d=d(k),g=b[d],s(g)||(g=b.other)),b=[],re(a,g,c,e,b),c=b.join(""),e)f.push(c);else{a=a.j;if(isNaN(k))a=Sd.mg;else{e=[];g=d=k;a.o==Wd?b=fe:(d=Math.abs(d),g=Math.abs(g),b=ge(a,1>=d?0:he(d)).me,be(a,g/Math.pow(10,b)),d=be(a,d/Math.pow(10,b)),b=ge(a,b+he(d.Pf)));k/=Math.pow(10,b.me);e.push(b.prefix);d=0>k||0==k&&0>1/k;e.push(d?a.i:a.l);if(isFinite(k))if(k=k*(d?-1:
1)*a.C,a.S)if(0==k)de(a,k,a.g,e),ee(a,0,e);else{g=Math.log(k)/Math.log(10);g=Math.floor(g+2E-15);k/=Math.pow(10,g);l=a.g;if(1<a.I&&a.I>a.g){for(;0!=g%a.I;)k*=10,g--;l=1}else 1>a.g?(g++,k/=10):(g-=a.g-1,k*=Math.pow(10,a.g-1));de(a,k,l,e);ee(a,g,e)}else de(a,k,a.g,e);else e.push(Sd.be);e.push(d?a.n:a.B);e.push(b.Yf);a=e.join("")}f.push(c.replace(/#/g,a))}}
function ne(a,b){var c=a.g,d=B(a.h,a);b=b.replace(qe,function(){c.push("'");return d(c)});return b=b.replace(pe,function(a,b){c.push(b);return d(c)})}function te(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,g),d.push(f),b=g+1)):(0==c.length&&(b=a.substring(b,g),""!=b&&d.push({type:0,value:b}),b=g+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d}
var ue=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,ve=/^\s*(\w+)\s*,\s*selectordinal\s*,/,we=/^\s*(\w+)\s*,\s*select\s*,/;
function oe(a,b){for(var c=[],d=te(b),e=0;e<d.length;e++){var f={};if(0==d[e].type)f.type=4,f.value=d[e].value;else if(1==d[e].type){var g=d[e].value;switch(ue.test(g)?0:ve.test(g)?1:we.test(g)?2:/^\s*\w+\s*/.test(g)?3:5){case 2:f.type=2;f.value=xe(a,d[e].value);break;case 0:f.type=0;f.value=ye(a,d[e].value);break;case 1:f.type=1;f.value=ze(a,d[e].value);break;case 3:f.type=3;f.value=d[e].value;break;default:La("Unknown block type.")}}else La("Unknown part of the pattern.");c.push(f)}return c}
function xe(a,b){var c="";b=b.replace(we,function(a,b){c=b;return""});var d={};d.ad=c;for(var e=te(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=oe(a,e[f].value);else La("Expected block type.");d[g.replace(/\s/g,"")]=k;f++}return d}
function ye(a,b){var c="",d=0;b=b.replace(ue,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.ad=c;e.vf=d;for(var f=te(b),g=0;g<f.length;){var k=f[g].value;g++;if(1==f[g].type)var l=oe(a,f[g].value);else La("Expected block type.");e[k.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=l;g++}return e}
function ze(a,b){var c="";b=b.replace(ve,function(a,b){c=b;return""});var d={};d.ad=c;d.vf=0;for(var e=te(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=oe(a,e[f].value);else La("Expected block type.");d[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return d}me.prototype.h=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};function Ae(a,b,c){a=new me(a);b={COUNT:b,TEXT:c};if(0==a.i.length)a="";else{c=[];re(a,a.i,b,!1,c);for(b=c.join("");0<a.g.length;)b=b.replace(a.h(a.g),a.g.pop());a=b}return a};function Be(a){this.g=new id;if(a){a=bd(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])}}function Ce(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+ia(a):b.substr(0,1)+a}h=Be.prototype;h.ca=function(){return this.g.ca()};h.add=function(a){this.g.set(Ce(a),a)};h.removeAll=function(a){a=bd(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};h.remove=function(a){return this.g.remove(Ce(a))};h.clear=function(){this.g.clear()};h.Oa=function(){return this.g.Oa()};
h.contains=function(a){a=Ce(a);return kd(this.g.h,a)};h.ta=function(){return this.g.ta()};h.ba=function(){return new Be(this)};h.vb=function(){return this.g.vb(!1)};function De(a){return Ee(a||arguments.callee.caller,[])}
function Ee(a,b){var c=[];if(Va(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Fe(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Fe(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Ee(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Fe(a){if(Ge[a])return Ge[a];a=String(a);if(!Ge[a]){var b=/function ([^\(]+)/.exec(a);Ge[a]=b?b[1]:"[Anonymous]"}return Ge[a]}var Ge={};function He(a,b,c,d,e){this.n="number"==typeof e?e:Ie++;this.l=d||C();this.j=a;this.o=b;this.h=c;delete this.i;delete this.g}He.prototype.n=0;He.prototype.i=null;He.prototype.g=null;var Ie=0;He.prototype.getMessage=function(){return this.o};function Je(a){this.l=a}Je.prototype.i=null;Je.prototype.h=null;Je.prototype.j=null;Je.prototype.g=null;function Ke(a,b){this.name=a;this.value=b}Ke.prototype.toString=function(){return this.name};var Le=new Ke("SHOUT",1200),Me=new Ke("SEVERE",1E3),Ne=new Ke("WARNING",900),Oe=new Ke("INFO",800),Pe=new Ke("CONFIG",700),Qe=new Ke("FINE",500),Re=new Ke("FINER",400),Se=new Ke("FINEST",300),Te=[new Ke("OFF",Infinity),Le,Me,Ne,Oe,Pe,Qe,Re,Se,new Ke("ALL",0)],Ue=null;h=Je.prototype;h.getName=function(){return this.l};
function Ve(a,b){a.g||(a.g=[]);a.g.push(b)}h.getParent=function(){return this.i};h.getChildren=function(){this.j||(this.j={});return this.j};function We(a){if(a.h)return a.h;if(a.i)return We(a.i);La("Root logger has no level set.");return null}
h.log=function(a,b,c){if(a.value>=We(this).value)for(ha(b)&&(b=b()),a=this.wg(a,b,c),b="log:"+a.getMessage(),r.console&&(r.console.timeStamp?r.console.timeStamp(b):r.console.markTimeline&&r.console.markTimeline(b)),r.msWriteProfilerMark&&r.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.g)for(var e=0,f=void 0;f=c.g[e];e++)f(d);b=b.getParent()}};
h.wg=function(a,b,c){var d=new He(a,String(b),this.l);if(c){d.i=c;var e;var f=arguments.callee.caller;try{var g;var k=ba("window.location.href");if(w(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var l,m,n=!1;try{l=c.lineNumber||c.oh||"Not available"}catch(p){l="Not available",n=!0}try{m=c.fileName||c.filename||c.sourceURL||r.$googDebugFname||k}catch(q){m="Not available",n=!0}g=!n&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||
"Not available",name:c.name||"UnknownError",lineNumber:l,fileName:m,stack:c.stack||"Not available"}}e="Message: "+xa(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+xa(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+xa(De(f)+"-> ")}catch(t){e="Exception trying to expose exception! You win, we lose. "+t}d.g=e}return d};function M(a,b,c){a.log(Ne,b,c)}h.info=function(a,b){this.log(Oe,a,b)};
function O(a,b,c){a.log(Qe,b,c)}function P(a,b){a.log(Re,b,void 0)}function Q(a,b){a.log(Se,b,void 0)}var Xe={},Ye=null;function Ze(){Ye||(Ye=new Je(""),Xe[""]=Ye,Ye.h=Pe)}function $e(){Ze();return Ye}function R(a){Ze();var b;if(!(b=Xe[a])){b=new Je(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=R(a.substr(0,c));c.getChildren()[d]=b;b.i=c;Xe[a]=b}return b};function af(a){sb.call(this);this.h=a;this.g={}}E(af,sb);var bf=[];h=af.prototype;h.listen=function(a,b,c,d){u(b)||(bf[0]=b,b=bf);for(var e=0;e<b.length;e++){var f=yc(a,b[e],c||this.handleEvent,d||!1,this.h||this);if(!f)break;this.g[f.key]=f}return this};h.ya=function(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)this.ya(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.h||this,c=zc(c),d=!!d,b=ec(a)?uc(a.eb,String(b),c,d,e):a?(a=Bc(a))?uc(a,b,c,d,e):null:null,b&&(Gc(b),delete this.g[b.key]);return this};
h.removeAll=function(){ic(this.g,Gc);this.g={}};h.J=function(){af.m.J.call(this);this.removeAll()};h.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function cf(a,b){Kc.call(this);this.h=a||1;this.g=b||r;this.i=B(this.Wg,this);this.j=C()}E(cf,Kc);h=cf.prototype;h.rd=!1;h.ga=null;h.Wg=function(){if(this.rd){var a=C()-this.j;0<a&&a<0.8*this.h?this.ga=this.g.setTimeout(this.i,this.h-a):(this.ga&&(this.g.clearTimeout(this.ga),this.ga=null),this.dispatchEvent(df),this.rd&&(this.ga=this.g.setTimeout(this.i,this.h),this.j=C()))}};h.stop=function(){this.rd=!1;this.ga&&(this.g.clearTimeout(this.ga),this.ga=null)};
h.J=function(){cf.m.J.call(this);this.stop();delete this.g};var df="tick";function ef(a,b,c){if(ha(a))c&&(a=B(a,c));else if(a&&"function"==typeof a.handleEvent)a=B(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:r.setTimeout(a,b||0)};function ff(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return JSON.parse(a)}catch(b){}throw Error("Invalid JSON string: "+a);}function gf(){}function hf(a,b){var c=[];jf(a,b,c);return c.join("")}
function jf(a,b,c){switch(typeof b){case "string":kf(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(u(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),jf(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),kf(e,c),c.push(":"),jf(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var lf={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},mf=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function kf(a,b){b.push('"',a.replace(mf,function(a){if(a in lf)return lf[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return lf[a]=e+b.toString(16)}),'"')};function nf(a,b){a&&O(a,b,void 0)};function of(){}of.prototype.g=null;function pf(a){var b;(b=a.g)||(b={},qf(a)&&(b[0]=!0,b[1]=!0),b=a.g=b);return b};var rf;function sf(){}E(sf,of);function tf(a){return(a=qf(a))?new ActiveXObject(a):new XMLHttpRequest}function qf(a){if(!a.h&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.h=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.h}rf=new sf;function uf(a){Kc.call(this);this.headers=new id;this.X=a||null;this.h=!1;this.S=this.O=null;this.La=this.p="";this.n=0;this.o="";this.i=this.ra=this.B=this.ja=!1;this.l=0;this.I=null;this.j=vf;this.N=this.Yc=!1}E(uf,Kc);var vf="";uf.prototype.g=R("goog.net.XhrIo");var wf=/^https?$/i,xf=["POST","PUT"];h=uf.prototype;h.Gf=function(){return this.j};
h.send=function(a,b,c,d){if(this.O)throw Error("[goog.net.XhrIo] Object is active with another request="+this.p+"; newUri="+a);b=b?b.toUpperCase():"GET";this.p=a;this.o="";this.n=0;this.La=b;this.ja=!1;this.h=!0;this.O=this.X?tf(this.X):tf(rf);this.S=this.X?pf(this.X):pf(rf);this.O.onreadystatechange=B(this.Uf,this);try{nf(this.g,yf(this,"Opening Xhr")),this.ra=!0,this.O.open(b,a,!0),this.ra=!1}catch(e){nf(this.g,yf(this,"Error opening Xhr: "+e.message));zf(this,e);return}a=c||"";var f=this.headers.ba();
d&&cd(d,function(a,b){f.set(b,a)});d=Ta(f.Ha(),Af);c=r.FormData&&a instanceof r.FormData;!Va(xf,b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");cd(f,function(a,b){this.O.setRequestHeader(b,a)},this);this.j&&(this.O.responseType=this.j);"withCredentials"in this.O&&(this.O.withCredentials=this.Yc);try{Bf(this),0<this.l&&(this.N=Cf(this.O),nf(this.g,yf(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.N)),this.N?(this.O.timeout=this.l,this.O.ontimeout=B(this.Zf,
this)):this.I=ef(this.Zf,this.l,this)),nf(this.g,yf(this,"Sending request")),this.B=!0,this.O.send(a),this.B=!1}catch(g){nf(this.g,yf(this,"Send error: "+g.message)),zf(this,g)}};function Cf(a){return H&&Tb(9)&&y(a.timeout)&&s(a.ontimeout)}function Af(a){return"content-type"==a.toLowerCase()}h.Zf=function(){"undefined"!=typeof aa&&this.O&&(this.o="Timed out after "+this.l+"ms, aborting",this.n=8,nf(this.g,yf(this,this.o)),this.dispatchEvent("timeout"),this.abort(8))};
function zf(a,b){a.h=!1;a.O&&(a.i=!0,a.O.abort(),a.i=!1);a.o=b;a.n=5;Df(a);Ef(a)}function Df(a){a.ja||(a.ja=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}h.abort=function(a){this.O&&this.h&&(nf(this.g,yf(this,"Aborting")),this.h=!1,this.i=!0,this.O.abort(),this.i=!1,this.n=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ef(this))};h.J=function(){this.O&&(this.h&&(this.h=!1,this.i=!0,this.O.abort(),this.i=!1),Ef(this,!0));uf.m.J.call(this)};
h.Uf=function(){this.C||(this.ra||this.B||this.i?Ff(this):this.Tg())};h.Tg=function(){Ff(this)};function Ff(a){if(a.h&&"undefined"!=typeof aa)if(a.S[1]&&4==Gf(a)&&2==a.L())nf(a.g,yf(a,"Local request error detected and ignored"));else if(a.B&&4==Gf(a))ef(a.Uf,0,a);else if(a.dispatchEvent("readystatechange"),4==Gf(a)){nf(a.g,yf(a,"Request complete"));a.h=!1;try{a.wa()?(a.dispatchEvent("complete"),a.dispatchEvent("success")):(a.n=6,a.o=a.Da()+" ["+a.L()+"]",Df(a))}finally{Ef(a)}}}
function Ef(a,b){if(a.O){Bf(a);var c=a.O,d=a.S[0]?ca:null;a.O=null;a.S=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){(c=a.g)&&c.log(Me,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Bf(a){a.O&&a.N&&(a.O.ontimeout=null);y(a.I)&&(r.clearTimeout(a.I),a.I=null)}
h.wa=function(){var a=this.L(),b;a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}if(!b){if(a=0===a)a=md(String(this.p))[1]||null,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),a=!wf.test(a?a.toLowerCase():"");b=a}return b};function Gf(a){return a.O?a.O.readyState:0}h.L=function(){try{return 2<Gf(this)?this.O.status:-1}catch(a){var b=this.g;b&&M(b,"Can not get status: "+a.message,void 0);return-1}};
h.Da=function(){try{return 2<Gf(this)?this.O.statusText:""}catch(a){return nf(this.g,"Can not get status: "+a.message),""}};
function Hf(a){try{if(!a.O)return null;if("response"in a.O)return a.O.response;switch(a.j){case vf:case "text":return a.O.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.O)return a.O.mozResponseArrayBuffer}var b=a.g;b&&b.log(Me,"Response type "+a.j+" is not supported on this browser",void 0);return null}catch(c){return nf(a.g,"Can not get response: "+c.message),null}}function yf(a,b){return b+" ["+a.La+" "+a.p+" "+a.L()+"]"};function If(){this.i=this.h=0;this.g=[]}function Jf(a){if(a.h!=a.i){var b=a.g[a.h];delete a.g[a.h];a.h++;return b}}h=If.prototype;h.ca=function(){return this.i-this.h};h.Oa=function(){return 0==this.i-this.h};h.clear=function(){this.i=this.h=this.g.length=0};h.contains=function(a){return Va(this.g,a)};h.remove=function(a){a=Na(this.g,a);if(0>a)return!1;a==this.h?Jf(this):(Ma.splice.call(this.g,a,1),this.i--);return!0};h.ta=function(){return this.g.slice(this.h,this.i)};function Kf(a,b){sb.call(this);this.n=a||0;this.i=b||10;if(this.n>this.i)throw Error(Lf);this.g=new If;this.h=new Be;this.l=null;this.Zc()}E(Kf,sb);var Lf="[goog.structs.Pool] Min can not be greater than max";h=Kf.prototype;h.td=function(){var a=C();if(!(null!=this.l&&0>a-this.l)){for(var b;0<this.g.ca()&&(b=Jf(this.g),!this.We(b));)this.Zc();!b&&this.ca()<this.i&&(b=this.xe());b&&(this.l=a,this.h.add(b));return b}};h.Kd=function(a){return this.h.remove(a)?(this.ee(a),!0):!1};
h.ee=function(a){this.h.remove(a);if(this.We(a)&&this.ca()<this.i){var b=this.g;b.g[b.i++]=a}else Mf(a)};h.Zc=function(){for(var a=this.g;this.ca()<this.n;){var b=this.xe();a.g[a.i++]=b}for(;this.ca()>this.i&&0<this.g.ca();)Mf(Jf(a))};h.xe=function(){return{}};function Mf(a){if("function"==typeof a.Aa)a.Aa();else for(var b in a)a[b]=null}h.We=function(a){return"function"==typeof a.sg?a.sg():!0};h.contains=function(a){return this.g.contains(a)||this.h.contains(a)};
h.ca=function(){return this.g.ca()+this.h.ca()};h.Oa=function(){return this.g.Oa()&&this.h.Oa()};h.J=function(){Kf.m.J.call(this);if(0<this.h.ca())throw Error("[goog.structs.Pool] Objects not released");delete this.h;for(var a=this.g;!a.Oa();)Mf(Jf(a));delete this.g};function Nf(a,b){this.g=a;this.h=b}Nf.prototype.Q=function(){return this.h};Nf.prototype.ba=function(){return new Nf(this.g,this.h)};function Of(a){this.g=[];if(a)a:{var b,c;if(a instanceof Of){if(b=a.Ha(),c=a.ta(),0>=a.ca()){a=this.g;for(var d=0;d<b.length;d++)a.push(new Nf(b[d],c[d]));break a}}else b=kc(a),c=jc(a);for(d=0;d<b.length;d++)Pf(this,b[d],c[d])}}function Pf(a,b,c){var d=a.g;d.push(new Nf(b,c));b=d.length-1;a=a.g;for(c=a[b];0<b;)if(d=b-1>>1,a[d].g>c.g)a[b]=a[d],b=d;else break;a[b]=c}h=Of.prototype;
h.remove=function(){var a=this.g,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Wa(a);else{a[0]=a.pop();for(var a=0,b=this.g,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,g=2*a+2,f=g<d&&b[g].g<b[f].g?g:f;if(b[f].g>e.g)break;b[a]=b[f];a=f}b[a]=e}return c.Q()}};h.ta=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].Q());return b};h.Ha=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].g);return b};h.ba=function(){return new Of(this)};h.ca=function(){return this.g.length};
h.Oa=function(){return 0==this.g.length};h.clear=function(){Wa(this.g)};function Qf(){Of.call(this)}E(Qf,Of);function Rf(a,b){this.j=new Qf;Kf.call(this,a,b)}E(Rf,Kf);h=Rf.prototype;h.td=function(a,b){if(!a)return Rf.m.td.call(this);Pf(this.j,s(b)?b:100,a);this.Ne()};h.Ne=function(){for(var a=this.j;0<a.ca();){var b=this.td();if(b)a.remove().apply(this,[b]);else break}};h.ee=function(a){Rf.m.ee.call(this,a);this.Ne()};h.Zc=function(){Rf.m.Zc.call(this);this.Ne()};h.J=function(){Rf.m.J.call(this);r.clearTimeout(void 0);this.j.clear();this.j=null};function Sf(a,b,c){Rf.call(this,b,c);this.o=a}E(Sf,Rf);Sf.prototype.xe=function(){var a=new uf,b=this.o;b&&cd(b,function(b,d){a.headers.set(d,b)});return a};Sf.prototype.We=function(a){return!a.C&&!a.O};function Tf(a,b,c,d,e){Kc.call(this);this.i=s(a)?a:1;this.j=s(e)?Math.max(0,e):0;this.tc=new Sf(b,c,d);this.g=new id;this.h=new af(this)}E(Tf,Kc);var Uf="ready complete success error abort timeout".split(" ");h=Tf.prototype;h.send=function(a,b,c,d,e,f,g,k,l){if(this.g.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new Vf(b,B(this.Jg,this,a),c,d,e,g,s(k)?k:this.i,l);this.g.set(a,b);a=B(this.Eg,this,a);this.tc.td(a,f);return b};
h.abort=function(a,b){var c=this.g.get(a);if(c){var d=c.Td;c.sf=!0;b&&(d&&(this.h.ya(d,Uf,c.Sd),Ec(d,"ready",function(){this.tc.Kd(d)},!1,this)),this.g.remove(a));d&&d.abort()}};h.Eg=function(a,b){var c=this.g.get(a);c&&!c.Td?(this.h.listen(b,Uf,c.Sd),b.l=Math.max(0,this.j),b.j=c.Gf(),c.Td=b,this.dispatchEvent(new Wf("ready",this,a,b)),Xf(this,a,b),c.sf&&b.abort()):this.tc.Kd(b)};
h.Jg=function(a,b){var c=b.target;switch(b.type){case "ready":Xf(this,a,c);break;case "complete":a:{var d=this.g.get(a);if(7==c.n||c.wa()||d.bd>d.ve)if(this.dispatchEvent(new Wf("complete",this,a,c)),d&&(d.Bf=!0,d.je)){c=d.je.call(c,b);break a}c=null}return c;case "success":this.dispatchEvent(new Wf("success",this,a,c));break;case "timeout":case "error":d=this.g.get(a);d.bd>d.ve&&this.dispatchEvent(new Wf("error",this,a,c));break;case "abort":this.dispatchEvent(new Wf("abort",this,a,c))}return null};
function Xf(a,b,c){var d=a.g.get(b);!d||d.Bf||d.bd>d.ve?(d&&(a.h.ya(c,Uf,d.Sd),a.g.remove(b)),a.tc.Kd(c)):(d.bd++,c.send(d.Xg,d.qd(),d.la(),d.Cc()))}h.J=function(){Tf.m.J.call(this);this.tc.Aa();this.tc=null;this.h.Aa();this.h=null;var a=this.g;cd(a,function(a){a.Aa()});a.clear();this.g=null};function Wf(a,b,c,d){K.call(this,a,b);this.id=c;this.Td=d}E(Wf,K);
function Vf(a,b,c,d,e,f,g,k){sb.call(this);this.Xg=a;this.i=c||"GET";this.g=d;this.h=e||null;this.ve=s(g)?g:1;this.bd=0;this.sf=this.Bf=!1;this.Sd=b;this.je=f;this.j=k||vf;this.Td=null}E(Vf,sb);h=Vf.prototype;h.qd=function(){return this.i};h.la=function(){return this.g};h.Cc=function(){return this.h};h.Gf=function(){return this.j};h.J=function(){Vf.m.J.call(this);delete this.Sd;delete this.je};function Yf(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b};function Zf(){this.i=[];this.h=this.g=0};function $f(){};function ag(){this.g=[];this.j=[];this.n=[];this.i=[];this.i[0]=128;for(var a=1;64>a;++a)this.i[a]=0;this.g[0]=1732584193;this.g[1]=4023233417;this.g[2]=2562383102;this.g[3]=271733878;this.g[4]=3285377520;this.l=this.h=0}E(ag,$f);
function bg(a,b,c){c||(c=0);var d=a.n;if(w(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.g[0];c=a.g[1];for(var g=a.g[2],k=a.g[3],l=a.g[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.g[0]=a.g[0]+b&4294967295;a.g[1]=a.g[1]+c&4294967295;a.g[2]=a.g[2]+g&4294967295;a.g[3]=a.g[3]+k&4294967295;a.g[4]=a.g[4]+l&4294967295}
ag.prototype.update=function(a,b){s(b)||(b=a.length);for(var c=b-64,d=0,e=this.j,f=this.h;d<b;){if(0==f)for(;d<=c;)bg(this,a,d),d+=64;if(w(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){bg(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){bg(this,e);f=0;break}}this.h=f;this.l+=b};
function cg(a){var b=[],c=8*a.l;56>a.h?a.update(a.i,56-a.h):a.update(a.i,64-(a.h-56));for(var d=63;56<=d;d--)a.j[d]=c&255,c/=256;bg(a,a.j);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.g[d]>>e&255,++c;return b};var dg=null,eg=null;function fg(a){this.g=a;this.h=new gf}fg.prototype.set=function(a,b){s(b)?this.g.set(a,hf(this.h,b)):this.g.remove(a)};fg.prototype.get=function(a){var b;try{b=this.g.get(a)}catch(c){return}if(null!==b)try{return ff(b)}catch(d){throw"Storage: Invalid value was encountered";}};fg.prototype.remove=function(a){this.g.remove(a)};function gg(){};function hg(a){fg.call(this,a)}E(hg,fg);function ig(a){this.data=a}function jg(a){return!s(a)||a instanceof ig?a:new ig(a)}function kg(a){a=a.data;if(!s(a))throw"Storage: Invalid value was encountered";return a}hg.prototype.set=function(a,b){hg.m.set.call(this,a,jg(b))};hg.prototype.Dc=function(a){a=hg.m.get.call(this,a);if(!s(a)||a instanceof Object)return a;throw"Storage: Invalid value was encountered";};hg.prototype.get=function(a){return(a=this.Dc(a))?kg(a):void 0};function lg(a){fg.call(this,a)}E(lg,hg);lg.prototype.set=function(a,b,c){if(b=jg(b)){if(c){if(c<C()){lg.prototype.remove.call(this,a);return}b.expiration=c}b.creation=C()}lg.m.set.call(this,a,b)};lg.prototype.Dc=function(a,b){var c=lg.m.Dc.call(this,a);if(c){var d;if(d=!b){d=c.creation;var e=c.expiration;d=!!e&&e<C()||!!d&&d>C()}if(d)lg.prototype.remove.call(this,a);else return c}};function mg(a){fg.call(this,a)}E(mg,lg);function ng(){}E(ng,gg);ng.prototype.ca=function(){var a=0;gd(this.vb(!0),function(){a++});return a};ng.prototype.clear=function(){var a=hd(this.vb(!0)),b=this;Oa(a,function(a){b.remove(a)})};function og(a,b){fg.call(this,a);this.we=Yf(b);this.zf=new gf}E(og,mg);h=og.prototype;h.we=null;h.zf=null;
function pg(a,b){var c=new ag;c.update(Yf(b));c.update(a.we);c=cg(c);if(!v(c))throw Error("encodeByteArray takes an array as a parameter");if(!dg){dg={};eg={};for(var d=0;65>d;d++)dg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d),eg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(d)}for(var d=eg,e=[],f=0;f<c.length;f+=3){var g=c[f],k=f+1<c.length,l=k?c[f+1]:0,m=f+2<c.length,n=m?c[f+2]:0,p=g>>2,g=(g&3)<<4|l>>4,l=(l&15)<<2|n>>6,n=n&63;
m||(n=64,k||(l=64));e.push(d[p],d[g],d[l],d[n])}return e.join("")}
function qg(a,b,c,d){if(!(0<b.length))throw Error("Non-empty salt must be provided");var e=new ag;e.update(Yf(c));e.update(b);e.update(a.we);a=new Zf;var e=cg(e),f;f||(f=e.length);b=a.i;for(c=0;256>c;++c)b[c]=c;var g=0;for(c=0;256>c;++c){var g=g+b[c]+e[c%f]&255,k=b[c];b[c]=b[g];b[g]=k}a.g=0;a.h=0;f=a.g;e=a.h;b=a.i;for(c=0;1536>c;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=g;a.g=f;a.h=e;d=Yf(d);var l;l||(l=d.length);f=a.g;e=a.h;b=a.i;for(c=0;c<l;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=
g,d[c]^=b[b[f]+b[e]&255];a.g=f;a.h=e;return String.fromCharCode.apply(null,d)}h.set=function(a,b,c){if(s(b)){for(var d=[],e=0;8>e;++e)d[e]=Math.floor(256*Math.random());b=new ig(qg(this,d,a,hf(this.zf,b)));b.salt=d;og.m.set.call(this,pg(this,a),b,c)}else og.prototype.remove.call(this,a)};
h.Dc=function(a,b){var c=og.m.Dc.call(this,pg(this,a),b);if(c){var d=kg(c),e=c.salt;if(!w(d)||!u(e)||!e.length)throw"Storage: Invalid value was encountered";d=qg(this,e,a,d);try{c.data=ff(d)}catch(f){throw"Storage: The value could not be decrypted";}return c}};h.remove=function(a){og.m.remove.call(this,pg(this,a))};function rg(a){this.g=a}E(rg,ng);h=rg.prototype;h.set=function(a,b){try{this.g.setItem(a,b)}catch(c){if(0==this.g.length)throw"Storage mechanism: Storage disabled";throw"Storage mechanism: Quota exceeded";}};h.get=function(a){a=this.g.getItem(a);if(!w(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return a};h.remove=function(a){this.g.removeItem(a)};h.ca=function(){return this.g.length};
h.vb=function(a){var b=0,c=this.g,d=new ed;d.g=function(){if(b>=c.length)throw dd;var d=c.key(b++);if(a)return d;d=c.getItem(d);if(!w(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};h.clear=function(){this.g.clear()};h.key=function(a){return this.g.key(a)};function sg(){var a=null;try{a=window.localStorage||null}catch(b){}this.g=a}E(sg,rg);var tg=!H||H&&9<=Vb,ug=!Gb&&!H||H&&H&&9<=Vb||Gb&&Tb("1.9.1"),vg=H&&!Tb("9");function wg(a){a=a.className;return w(a)&&a.match(/\S+/g)||[]}function xg(a,b){for(var c=wg(a),d=bb(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)Va(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function yg(a,b){var c=wg(a),d=bb(arguments,1),e=zg(c,d);a.className=e.join(" ");return e.length==c.length-d.length}function zg(a,b){return Pa(a,function(a){return!Va(b,a)})};function Ag(a,b){this.x=s(a)?a:0;this.y=s(b)?b:0}Ag.prototype.ba=function(){return new Ag(this.x,this.y)};Ag.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Bg(a,b){return new Ag(a.x-b.x,a.y-b.y)}Ag.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};Ag.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function Cg(a,b){this.width=a;this.height=b}h=Cg.prototype;h.ba=function(){return new Cg(this.width,this.height)};h.toString=function(){return"("+this.width+" x "+this.height+")"};h.Oa=function(){return!(this.width*this.height)};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Dg(a){return a?new Eg(Fg(a)):qa||(qa=new Eg)}function Gg(a,b){var c=b||document,d=null;c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):(c=b||document,d=(c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):Hg(document,"*",a,b))[0]);return d||null}
function Hg(a,b,c,d){a=d||a;b=b&&"*"!=b?b.toUpperCase():"";if(a.querySelectorAll&&a.querySelector&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){d={};for(var e=0,f=0,g;g=a[f];f++)b==g.nodeName&&(d[e++]=g);d.length=e;return d}return a}a=a.getElementsByTagName(b||"*");if(c){d={};for(f=e=0;g=a[f];f++)b=g.className,"function"==typeof b.split&&Va(b.split(/\s+/),c)&&(d[e++]=g);d.length=e;return d}return a}
function Ig(a,b){ic(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Jg?a.setAttribute(Jg[d],b):ra(d,"aria-")||ra(d,"data-")?a.setAttribute(d,b):a[d]=b})}var Jg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Kg(a){return Hb||"CSS1Compat"!=a.compatMode?a.body||a.documentElement:a.documentElement}function Lg(a){return a.parentWindow||a.defaultView}function Mg(a,b,c){function d(c){c&&b.appendChild(w(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!v(f)||A(f)&&0<f.nodeType?d(f):Oa(Ng(f)?Za(f):f,d)}}function Og(a){for(var b;b=a.firstChild;)a.removeChild(b)}function Pg(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)}function Qg(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function Rg(a){if(void 0!=a.firstElementChild)a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Sg(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Fg(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function Tg(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else Og(a),a.appendChild(Fg(a).createTextNode(String(b)))}var Ug={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},Vg={IMG:" ",BR:"\n"};function Wg(a){a=a.getAttributeNode("tabindex");return null!=a&&a.specified}function Xg(a){a=a.tabIndex;return y(a)&&0<=a&&32768>a}
function Yg(a){var b=[];Zg(a,b,!1);return b.join("")}function Zg(a,b,c){if(!(a.nodeName in Ug))if(3==a.nodeType)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in Vg)b.push(Vg[a.nodeName]);else for(a=a.firstChild;a;)Zg(a,b,c),a=a.nextSibling}function Ng(a){if(a&&"number"==typeof a.length){if(A(a))return"function"==typeof a.item||"string"==typeof a.item;if(ha(a))return"function"==typeof a.item}return!1}function Eg(a){this.g=a||r.document||document}
h=Eg.prototype;h.s=function(a){return w(a)?this.g.getElementById(a):a};h.K=function(a,b,c){var d=this.g,e=arguments,f=e[0],g=e[1];if(!tg&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',xa(g.name),'"');if(g.type){f.push(' type="',xa(g.type),'"');var k={};qc(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=d.createElement(f);g&&(w(g)?f.className=g:u(g)?xg.apply(null,[f].concat(g)):Ig(f,g));2<e.length&&Mg(d,f,e);return f};h.createElement=function(a){return this.g.createElement(a)};
function $g(a){return"CSS1Compat"==a.g.compatMode}function ah(a){var b=a.g;a=Kg(b);b=Lg(b);return H&&Tb("10")&&b.pageYOffset!=a.scrollTop?new Ag(a.scrollLeft,a.scrollTop):new Ag(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}h.appendChild=function(a,b){a.appendChild(b)};h.Rg=Pg;h.getChildren=function(a){return ug&&void 0!=a.children?a.children:Pa(a.childNodes,function(a){return 1==a.nodeType})};h.Ff=Rg;h.contains=Sg;H&&Tb(8);function bh(a,b){null!=a&&this.Hf.apply(this,arguments)}h=bh.prototype;h.za="";h.set=function(a){this.za=""+a};h.Hf=function(a,b,c){this.za+=a;if(null!=b)for(var d=1;d<arguments.length;d++)this.za+=arguments[d];return this};h.clear=function(){this.za=""};h.toString=function(){return this.za};function ch(a,b,c){sb.call(this);this.h=a;this.n=b||0;this.i=c;this.l=B(this.j,this)}E(ch,sb);ch.prototype.g=0;ch.prototype.J=function(){ch.m.J.call(this);this.stop();delete this.h;delete this.i};function dh(a){a.stop();a.g=ef(a.l,s(void 0)?void 0:a.n)}ch.prototype.stop=function(){0!=this.g&&r.clearTimeout(this.g);this.g=0};function eh(a){a.stop();a.j()}ch.prototype.j=function(){this.g=0;this.h&&this.h.call(this.i)};function fh(a,b,c){sb.call(this);this.j=a;this.i=b;this.h=c;this.g=B(this.Vg,this)}E(fh,sb);h=fh.prototype;h.Pd=!1;h.ga=null;function gh(a){a.ga?a.Pd=!0:hh(a)}h.stop=function(){this.ga&&(r.clearTimeout(this.ga),this.ga=null,this.Pd=!1)};h.J=function(){fh.m.J.call(this);this.stop()};h.Vg=function(){this.ga=null;this.Pd&&(this.Pd=!1,hh(this))};function hh(a){a.ga=ef(a.g,a.i);a.j.call(a.h)};R("ydn");var ih=Math.pow(2,3),jh=Math.pow(2,6);function kh(){Kc.call(this);this.key=this.g=void 0}E(kh,Kc);kh.prototype.P=function(a,b){if("boolean"!=typeof b)throw Error("Invalid value");if("number"!=typeof a||0>a)throw Error("Invalid state");"undefined"==typeof this.g&&(this.g=0);this.g=b?this.g|a:this.g&~a};function lh(a){a.P(ih,!0);ef(function(){this.dispatchEvent(mh)},0,a)}var mh="a";function nh(a,b,c){K.call(this,a,b);this.url=c}E(nh,K);R("ydn");function oh(a){return!w(a)||ta(a)?{}:JSON.parse(a)}function ph(a){var b;try{b=S(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function S(a){return JSON.stringify(a,void 0,void 0)};R("ydn.Store");function qh(a,b){if(b&&!a)throw Error("Can't create document with namespace and no root tag");if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument(b||"",a||"",null);if("undefined"!=typeof ActiveXObject){var c=rh();if(c)return a&&c.appendChild(c.createNode(1,a,b||"")),c}throw Error("Your browser does not support creating new documents");}
function sh(a){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(a,"application/xml");if("undefined"!=typeof ActiveXObject){var b=rh();b.loadXML(a);return b}throw Error("Your browser does not support loading xml documents");}function th(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if(a=a.xml)return a;throw Error("Your browser does not support serializing XML documents");}
function rh(){var a=new ActiveXObject("MSXML2.DOMDocument");if(a){a.resolveExternals=!1;a.validateOnParse=!1;try{a.setProperty("ProhibitDTD",!0),a.setProperty("MaxXMLSize",2048),a.setProperty("MaxElementDepth",256)}catch(b){}}return a};function uh(a){Error.captureStackTrace?Error.captureStackTrace(this,uh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}E(uh,Error);function vh(a){Error.captureStackTrace?Error.captureStackTrace(this,vh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}E(uh,Error);vh.prototype.name="ydn.error.NotSupportedException";
function wh(a){Error.captureStackTrace?Error.captureStackTrace(this,wh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}E(wh,Error);function xh(a){Error.captureStackTrace?Error.captureStackTrace(this,xh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}E(xh,Error);xh.prototype.name="ydn.InternalError";
function yh(a){Error.captureStackTrace?Error.captureStackTrace(this,yh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}E(yh,Error);yh.prototype.name="ydn.error.ConstraintError";function zh(a){Error.captureStackTrace?Error.captureStackTrace(this,zh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}E(uh,Error);
function Ah(a){Error.captureStackTrace?Error.captureStackTrace(this,Ah):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}E(Ah,Error);var Bh,Ch,Dh,Eh;Eh=Dh=Ch=Bh=!1;var Fh=Bb();Fh&&(-1!=Fh.indexOf("Firefox")?Bh=!0:-1!=Fh.indexOf("Camino")||(-1!=Fh.indexOf("iPhone")||-1!=Fh.indexOf("iPod")?Ch=!0:-1!=Fh.indexOf("iPad")?Dh=!0:-1!=Fh.indexOf("Chrome")&&(Eh=!0)));var Gh=Bh,Hh=Ch,Ih=Dh,Jh=Eh;function Kh(a){if(!u(a))throw new uh("Array required.");if(s(void 0))return a=Qa(a,function(a){return a[void 0]}),Kh(a);for(var b=Number.NaN,c=-1,d=0;d<a.length;d++)!isNaN(a[d])&&(isNaN(b)||a[d]>b)&&(b=a[d],c=d);return{value:b,index:c}};function Lh(){kh.call(this);this.h=null;yc(this,"user-login",this.Vf,!1,this);yc(this,"user-logout",this.Vf,!1,this);this.o=window.top.location.href.replace(/[?#]\S+/,"")}E(Lh,kh);function Mh(a){var b=chrome.extension.getURL(Nh);a.o=b}h=Lh.prototype;h.logger=R("ydn.api.AbstractUser");h.Vf=function(){this.display?(this.display.i(this.l||""),this.isLogin()?this.j&&this.display.h(this.j):this.i&&this.display.g(this.i),Q(this.logger,"Refreshed.")):Q(this.logger,"No UI refreshed.")};
h.toJSON=function(){return{nickname:this.n,email:this.l,is_login:this.h,login_url:this.i,logout_url:this.j,user_id:this.user_id}};h.isLogin=function(){return!0===this.h};h.toString=function(){return"User:"+(!0===this.h?this.l:!1===this.h?"logout":"?")};h.Nc=0;
function Oh(a,b){!b&&a.isLogin()?Q(a.logger,"Already login"):(a.pc||(a.pc=new fh(function(){this.isLogin()?this.pc.stop():1<this.Nc?(M(this.logger,"Cannot login to the API server, tried "+this.Nc+" times."),this.pc.stop(),this.Nc=0):(this.Nc++,this.Kc())},5E3,a)),a.Nc=0,gh(a.pc))}h.refresh=function(a){Oh(this,a)};function Ph(a,b,c){nh.call(this,a,b,c)}E(Ph,nh);function Qh(){Lh.call(this)}E(Qh,Lh);Qh.prototype.logger=R("ydn.api.User");
Qh.prototype.load=function(a){O(this.logger,"getting user info");if(a.logout_url)return this.n=a.nickname,this.l=a.email,this.user_id=a.user_id,this.h=a.is_login,this.j=a.logout_url,this.i=a.login_url,O(this.logger,a.email+" login"),this.j=a.logout_url,this.user_id=a.Id?a.Id.$t:void 0,this.h=!0,this.i=void 0,this.P(jh,!0),lh(this),!0;a.login_url&&(O(this.logger,"NO user"),this.i=a.login_url,this.h=!1,this.l=this.user_id=this.j=this.n=void 0,this.P(jh,!0),lh(this));return!1};
Qh.prototype.p=function(a,b){Q(this.logger,"Receiving "+(b.wa()?"":"fail")+" login info from server.");if(b.wa()){var c=a.User;if(c){var d;d=this.load(c)?new Ph("user-login",this,this.j):new Ph("user-logout",this,this.i);ef(function(){this.dispatchEvent(d)},0,this)}}else M(this.logger,"Server return error with: "+b.Da());this.pc&&this.pc.stop()};
function Rh(a,b){var c=new G,d=Th(Uh);if(!d)return qb("login server not available.");var e={pm:a.o,state:Math.random().toString().substr(2,6)};if(b)for(var f in b)e[f]=b[f];d.request(new Vh("/rpc_login","GET",e)).execute(function(a,b){a?c.t(a.User):c.u(b)},a);return c}Qh.prototype.Kc=function(){O(this.logger,"Sending login request.");var a=Th(Uh),b=window.top.location.href.replace(/[?#]\S+/,"");a.request(new Vh("/rpc_login","GET",{url:b})).execute(B(this.p,this));return!1};function Wh(){this.g=C()}var Xh=new Wh;Wh.prototype.set=function(a){this.g=a};Wh.prototype.get=function(){return this.g};function Yh(a){this.j=a||"";this.l=Xh}Yh.prototype.g=!0;Yh.prototype.h=!1;function Zh(a){a=new Date(a.l);return $h(a.getFullYear()-2E3)+$h(a.getMonth()+1)+$h(a.getDate())+" "+$h(a.getHours())+":"+$h(a.getMinutes())+":"+$h(a.getSeconds())+"."+$h(Math.floor(a.getMilliseconds()/10))}function $h(a){return 10>a?"0"+a:String(a)}function ai(a,b){var c=(a.l-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function bi(a){Yh.call(this,a)}E(bi,Yh);bi.prototype.h=!0;
bi.prototype.i=function(a){var b;switch(a.j.value){case Le.value:b="dbg-sh";break;case Me.value:b="dbg-sev";break;case Ne.value:b="dbg-w";break;case Oe.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.j," ");this.g&&c.push("[",Zh(a),"] ");c.push("[",Ea(ai(a,this.l.get())),"s] ");c.push("[",xa(a.h),"] ");c.push('<span class="',b,'">',wa(Ea(xa(a.getMessage()))));this.h&&a.i&&c.push("<br>",wa(Ea(a.g||"")));c.push("</span>");c.push("<br>");return c.join("")};
function ci(a){Yh.call(this,a)}E(ci,Yh);ci.prototype.i=function(a){var b=[];b.push(this.j," ");this.g&&b.push("[",Zh(a),"] ");b.push("[",ai(a,this.l.get()),"s] ");b.push("[",a.h,"] ");b.push(a.getMessage());this.h&&a.i&&b.push("\n",a.g);b.push("\n");return b.join("")};function di(){this.j=B(this.n,this);this.g=new ci;this.g.g=!1;this.h=this.g.h=!1;this.i="";this.l={}}function ei(a){var b=fi;if(a!=b.h){var c=$e();a?Ve(c,b.j):(c=c.g)&&Xa(c,b.j);b.h=a}}di.prototype.n=function(a){if(!this.l[a.h]){var b=this.g.i(a),c=gi;if(c)switch(a.j){case Le:hi(c,"info",b);break;case Me:hi(c,"error",b);break;case Ne:hi(c,"warn",b);break;default:hi(c,"debug",b)}else window.opera?window.opera.postError(b):this.i+=b}};var gi=window.console;
function hi(a,b,c){if(a[b])a[b](c);else a.log(c)};function ii(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}h=ii.prototype;h.ba=function(){return new ii(this.top,this.right,this.bottom,this.left)};h.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};h.contains=function(a){return this&&a?a instanceof ii?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1};
h.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};h.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};function ji(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}h=ji.prototype;h.ba=function(){return new ji(this.left,this.top,this.width,this.height)};h.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};h.contains=function(a){return a instanceof ji?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
h.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function ki(a,b){var c=Fg(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""}function li(a,b){return ki(a,b)||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}
function mi(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}H&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ni(a){if(H&&!(H&&8<=Vb))return a.offsetParent;var b=Fg(a),c=li(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=li(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}
function oi(a){for(var b=new ii(0,Infinity,Infinity,0),c=Dg(a),d=c.g.body,e=c.g.documentElement,f=Kg(c.g);a=ni(a);)if(!(H&&0==a.clientWidth||Hb&&0==a.clientHeight&&a==d||a==d||a==e||"visible"==li(a,"overflow"))){var g=pi(a),k;k=a;if(Gb&&!Tb("1.9")){var l=parseFloat(ki(k,"borderLeftWidth"));if(qi(k))var m=k.offsetWidth-k.clientWidth-l-parseFloat(ki(k,"borderRightWidth")),l=l+m;k=new Ag(l,parseFloat(ki(k,"borderTopWidth")))}else k=new Ag(k.clientLeft,k.clientTop);g.x+=k.x;g.y+=k.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(Lg(c.g)||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new Cg(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}
function pi(a){var b,c=Fg(a),d=li(a,"position"),e=Gb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Ag(0,0),g;b=c?Fg(c):document;g=!H||H&&9<=Vb||$g(Dg(b))?b.documentElement:b.body;if(a==g)return f;if(a.getBoundingClientRect)b=mi(a),a=ah(Dg(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=
b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(Hb&&"fixed"==li(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Fb||Hb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=ni(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,Fb&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}function ri(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function si(a){var b=ti;if("none"!=li(a,"display"))return b(a);var c=a.style,d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}function ti(a){var b=a.offsetWidth,c=a.offsetHeight,d=Hb&&!b&&!c;return s(b)&&!d||!a.getBoundingClientRect?new Cg(b,c):(a=mi(a),new Cg(a.right-a.left,a.bottom-a.top))}function ui(a){var b=pi(a);a=si(a);return new ji(b.x,b.y,a.width,a.height)}
function vi(a,b){a.style.display=b?"":"none"}function qi(a){return"rtl"==li(a,"direction")}var wi=Gb?"MozUserSelect":Hb?"WebkitUserSelect":null;function xi(a,b,c){c=c?null:a.getElementsByTagName("*");if(wi){if(b=b?"none":"",a.style[wi]=b,c){a=0;for(var d;d=c[a];a++)d.style[wi]=b}}else if(H||Fb)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;d=c[a];a++)d.setAttribute("unselectable",b)}
function yi(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}function zi(a,b){var c=a.currentStyle?a.currentStyle[b]:null;return c?yi(a,c):0}var Ai={thin:2,medium:4,thick:6};
function Bi(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:null))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:null;return c in Ai?Ai[c]:yi(a,c)}function Ci(a){if(H&&!(H&&9<=Vb)){var b=Bi(a,"borderLeft"),c=Bi(a,"borderRight"),d=Bi(a,"borderTop");a=Bi(a,"borderBottom");return new ii(d,c,a,b)}b=ki(a,"borderLeftWidth");c=ki(a,"borderRightWidth");d=ki(a,"borderTopWidth");a=ki(a,"borderBottomWidth");return new ii(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))}var Di=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Ei(a){this.l=B(this.n,this);this.h=new bi;this.i=this.h.g=!1;this.g=a;this.j=this.g.ownerDocument||this.g.document;a=Dg(this.g);var b=null,c=a.g;if(H&&c.createStyleSheet)a=b=c.createStyleSheet(),H&&s(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";else{c=Hg(a.g,"head",void 0,void 0)[0];c||(b=Hg(a.g,"body",void 0,void 0)[0],c=a.K("head"),b.parentNode.insertBefore(c,b));var d=b=a.K("style");H&&s(d.cssText)?d.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
d.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";a.appendChild(c,b)}this.g.className+=" logdiv"}
Ei.prototype.n=function(a){var b=100>=this.g.scrollHeight-this.g.scrollTop-this.g.clientHeight,c=this.j.createElement("div");c.className="logmsg";c.innerHTML=this.h.i(a);this.g.appendChild(c);b&&(this.g.scrollTop=this.g.scrollHeight)};Ei.prototype.clear=function(){this.g.innerHTML=""};var fi=null,Fi=null;R("ydn.debug");function Gi(a,b,c){if(y(b))b=new Ke("log",b);else if(w(b)){b=b.toUpperCase();if(!Ue){Ue={};for(var d=0,e;e=Te[d];d++)Ue[e.value]=e,Ue[e.name]=e}b=Ue[b]||null}else b=Qe;R(a||"ydn").h=b;s(c)?Fi||(a=Fi=new Ei(c),!0!=a.i&&(c=$e(),Ve(c,a.l),a.i=!0),$e().h=Ne):fi||Fi||(fi=new di,ei(!0),$e().h=Ne)}var Hi=null;function Ii(a){Hi&&setTimeout(function(){Hi.log(a)},10)};var Uh="login",Ji=R("ydn.http"),Ki={},Li=[];var Mi,Ni={},Oi=[];function Pi(a,b){Ni[b||"default"]=a}function Th(a){if(!s(a))return Ni["default"];for(var b=a,c=0;c<Oi.length;c++){var d=(0,Oi[c])(a);if(d){b=d;break}}return Ni[b]||null}function Qi(){Mi||(Mi=new Tf);return Mi}function Ri(a,b,c,d){w(a)?this.qc=a:(this.qc=null,this.status=a,this.body=b,this.headers=c||{},this.g=d)}function Si(a){if(a.qc){var b=oh(a.qc);b.gapiRequest&&(b=b.gapiRequest.data);a.status=b.status;a.g=b.statusText;a.headers=b.headers;a.body=b.body;a.qc=null}}
Ri.prototype.L=function(){Si(this);return this.status};Ri.prototype.wa=function(){Si(this);return 200<=this.status&&400>this.status};Ri.prototype.Da=function(){Si(this);return this.g||""};function Ti(a){Si(a);return a.body}function Ui(a,b){Si(a);return a.headers[b]}Ri.prototype.Cc=function(){Si(this);return this.headers};
function Vi(a){var b;Si(a);"application/json"==Ui(a,"content-type")?b=!0:(b=a.body,b=w(b)&&!ta(b)?/^[\],:{}\s]*$/.test(b.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")):!1);return b&&w(a.body)?JSON.parse(a.body):a.body}function Wi(a){return a instanceof Ri?a:w(a)?new Ri(a):new Ri(a.status,a.body,a.headers,a.statusText)}
function Vh(a,b,c,d,e){this.path=a;this.method=b?b.toUpperCase():"GET";this.params=c||{};this.headers=d||{};this.body=e}var Xi=null;function Yi(a,b,c,d){this.l=s(b)?b:Qi();this.j="sr"+Zi++;this.n=c||0;this.o=!!d;this.g=a}var Zi=0;Yi.prototype.F=function(){return this.j};
Yi.prototype.execute=function(a,b){var c=this.g,d=new od(c.path),e;for(e in c.params)d.g.set(e,c.params[e]);this.l.send(this.j,d.toString(),c.method,c.body,c.headers,void 0,function(d){d=d.target;for(var e=(d.O&&4==Gf(d)?d.O.getAllResponseHeaders():"").split("\n"),k={},l=0;l<e.length;l++){var m=e[l].indexOf(":");0<m&&(k[e[l].substr(0,m).toLowerCase()]=e[l].substr(m+1).trim())}e=l=Hf(d);if(k["content-type"]&&/json/.test(k["content-type"]))if(A(l))e=l;else if(w(l))try{e=oh(l)}catch(n){e=l}k=new Ri(d.L(),
l,k,d.Da());Xi&&!k.wa()&&Xi.log({"class":"ydn.gdata.Entry",method:"commit",context:"HTTP request",HttpRequestData:{path:c.path,uri:String(d.p),method:c.method,params:c.params,headers:c.headers,body:c.body},HttpRespondData:{status:k.L(),statusText:k.Da(),body:Ti(k),headers:k.Cc()}});a&&(a.call(b,e,k),a=null)},this.n,void 0,this.o);this.l=null};Yi.prototype.toString=function(){return"HTTPRequest:"+this.j};function $i(a,b,c){this.h=a;this.i=b;this.g=null;this.Yg=s(c)?c:!0}$i.prototype.request=function(a){return new aj(a,this)};function aj(a,b){Yi.call(this,a,b.i);this.parent=b}E(aj,Yi);var bj=new Ri(0,null,null,"No access token");
aj.prototype.execute=function(a,b){function c(){this.Yg?d.g.headers.Authorization="Bearer "+d.parent.g.access_token:d.g.params.access_token=d.parent.g.access_token}var d=this;d.parent.g&&d.parent.g.expires>C()?(c(),aj.m.execute.call(this,function(e,f){401==f.L()?cj(d.parent.h).w(function(e){d.parent.g=e;c();aj.m.execute.call(d,a,b)},function(){d.parent.g=null;a.call(b,null,bj)},d):a.call(b,e,f)},this)):cj(this.parent.h).w(function(e){d.parent.g=e;c();aj.m.execute.call(this,a,b)},function(){d.parent.g=
null;a.call(b,null,bj)},this)};function T(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ha(Object.freeze)&&Object.freeze(this)}T.prototype.lower=void 0;T.prototype.upper=void 0;T.prototype.toJSON=function(){return dj(this)};function ej(a){return fj(a)}T.only=function(a){return new T(a,a,!1,!1)};T.bound=function(a,b,c,d){return new T(a,b,c,d)};T.upperBound=function(a,b){return new T(void 0,a,void 0,!!b)};T.lowerBound=function(a,b){return new T(a,void 0,!!b,void 0)};
function gj(a){var b;if(u(a))b=Za(a),b.push("\uffff");else if(w(a))b=a+"\uffff";else if(y(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return T.only(a);return T.bound(a,b,!1,!0)}function dj(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function hj(a){if(null==a)return null;if(a instanceof T)return a;if(A(a))return new T(a.lower,a.upper,a.lowerOpen,a.upperOpen);throw new L("Invalid key range: "+a+" of type "+typeof a);}
function fj(a){return null!=a?null!=a.upper&&null!=a.lower?ij.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?ij.upperBound(a.upper,a.upperOpen):null!=a.lower?ij.lowerBound(a.lower,a.lowerOpen):null:null}function jj(a){if(a instanceof T)return"";if(null!=a){if(A(a)){for(var b in a)if(a.hasOwnProperty(b)&&!Va(["lower","upper","lowerOpen","upperOpen"],b))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
T.prototype.he=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return T.bound(b,c,d,e)};function kj(a){if(!a)return"";var b=a.lowerOpen?"(":"[";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function lj(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==mj(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(nj(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(nj(c.upper,b)))}else d.push(a+" = ?"),e.push(nj(c.lower,b))}var ij=r.IDBKeyRange||r.webkitIDBKeyRange||T;function oj(a,b){var c,d;2==arguments.length&&w(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=v(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],s(a));c++);return a}function pj(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)A(a[e])||(a[e]={}),a=a[e];a[d]=c}}var qj={};
function rj(a){a=[a];for(var b=new sj,c=0,d,e;void 0!==(e=a.pop());){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(qj);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),tj(b,e);else if(e instanceof Date)c+=2,b.write(c),tj(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>
2|255,(f|3)<<6)}c.write(0)}else if(e===qj)b.write(0);else return"";c=0}return b.trim().toString()}function uj(a){for(var b=[],c=b,d=[],e,f,g=new vj(a);null!=g.read();)if(0===g.current)c=d.pop();else{if(null===g.current)break;do{e=g.current/4|0;a=g.current%4;for(var k=0;k<e;k++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.current+4)g.read();else break}while(1);1===a?c.push(wj(g)):2===a?c.push(new Date(wj(g))):3===a?c.push(xj(g)):0===a&&(c=d.pop())}return b[0]}
function tj(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function wj(a){var b=a.read()|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=a.read()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.read()|0):a.read()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function xj(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.read();if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function vj(a){this.current=null;this.g=a;this.h=this.g.length-1;this.index=-1}
vj.prototype.read=function(){return this.current=this.index<this.h?parseInt(this.g[++this.index]+this.g[++this.index],16):null};function sj(){this.g=[];this.h=void 0}sj.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.h=arguments[b].toString(16),this.g.push(2===this.h.length?this.h:this.h="0"+this.h)};sj.prototype.trim=function(){for(var a=this.g.length;"00"===this.g[--a];);this.g.length=++a;return this};sj.prototype.toString=function(){return this.g.length?this.g.join(""):""};
function yj(a,b){var c=rj(a),d=rj(b);return c>d?1:c==d?0:-1};function zj(a,b,c,d,e){if(!(b instanceof T))if(w(b)&&s(c)){var f,g,k,l;if("starts"==b||"^"==b)b=gj(c);else{if("<"==b||"<="==b)f=c,k="<"==b;else if(">"==b||">="==b)g=c,l=">"==b;else if("="==b||"=="==b)f=g=c;else throw new L("invalid op: "+b);if("<"==d||"<="==d)f=e,k="<"==d;else if(">"==d||">="==d)g=e,l=">"==d;else if(s(d))throw new L("invalid op2: "+d);b=T.bound(g,f,l,k)}}else b=hj(b);this.g=b;this.Rb=a}zj.prototype.Rb="";
zj.prototype.he=function(a){if(this.Rb!=a.Rb)return null;a=null!=this.g&&null!=a.g?this.g.he(a.g):this.g||a.g;return new zj(this.Rb,a)};var Aj={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Bj=r.IDBRequest&&"LOADING"in r.IDBRequest?r.IDBTransaction:r.webkitIDBRequest&&"LOADING"in r.webkitIDBRequest&&1===r.webkitIDBTransaction.READ_WRITE?r.webkitIDBTransaction:Aj,Cj=Bj.READ_ONLY,U=Bj.READ_WRITE,Dj=Bj.VERSION_CHANGE,Ej=r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.moz_indexedDB||r.msIndexedDB;function Fj(a,b,c,d){sb.call(this);this.i=c;this.M=c.getName();this.ob=void 0;this.j=!1;this.Z=null;this.n=a;this.Yc=b;this.La=0;this.ra=this.B=!1;this.ja=d||4;this.o=this.h=this.g=void 0;this.N=function(){throw new Qc;};this.S=function(){throw new Qc;};this.vc=function(){}}E(Fj,sb);h=Fj.prototype;
h.init=function(a,b,c,d,e){if(s(b)){a=this.i;var f,g=b;u(b)?(f=Gj(a,b),g=b.join(", ")):f=Hj(a,b);if(!f)throw new L('require index "'+g+'" not found in store "'+a.getName()+'"');this.ob=f.getName()}this.j=w(this.ob);this.Z=c||null;this.La=0;this.ra=this.B=!1;this.reverse="prev"==d||"prevunique"==d;this.unique="nextunique"==d||"prevunique"==d;this.tb=d;this.Jc=e;this.o=this.h=this.g=void 0};h.tb="";h.Z=null;h.unique=!1;h.reverse=!1;h.Jc=!0;h.logger=R("ydn.db.core.req.AbstractCursor");
h.Zb=function(a,b,c){null==a&&(P(this.logger,this+" finished."),this.B=!0);this.g=a;this.h=b;this.o=c;this.La++;this.B?(Q(this.logger,this+" DONE."),this.N(),Ij(this)):(Q(this.logger,this+" new cursor position {"+(this.j?this.g+", "+this.h:this.g)+"}"),this.N(this.g))};h.J=function(){this.n=null};h.toString=function(){return"Cursor:"+this.M+(s(this.ob)?":"+this.ob:"")+"["+(this.n?"":"~")+this.Yc+"]"};
function Ij(a){null!=a.h?a.h=Jj(a.h):a.h=void 0;null!=a.g?a.g=Jj(a.g):a.g=void 0;a.vc(a.ra,a.g,a.h)}function Kj(a){a.ra=!0;Q(a.logger,a+": exit");Ij(a)}h.ca=function(){return this.La};h.da=function(){return this.j?this.h:this.g};h.Q=function(){return this.Jc?this.da():this.o};h.hd=function(){};function Lj(){};function Mj(a,b,c,d,e,f,g){if(!w(a))throw new TypeError("store name must be a string, but "+a+" found.");this.i=a;this.h=b;this.n=g;this.o=!!this.h;if(s(d)&&!ga(d))throw new L("reverse value must be a boolean, but "+typeof d+" found");if(s(e)&&!ga(e))throw new L("unique value must be a boolean, but "+typeof e+" found");if(s(f)&&!ga(f))throw new L("key_only value must be a boolean, but "+typeof f+" found");this.g=s(f)?f:!!w(this.h);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.l=
a;if(d=jj(c))throw new L("Invalid key range: "+d);this.j=fj(c);this.p=Nj;this.I=NaN}E(Mj,Lj);Mj.prototype.g=!0;function Oj(a,b,c,d,e){if(!w(b))throw new L("index name must be string");Mj.call(this,a,b,c,d,e,!0)}E(Oj,Mj);function Pj(a,b,c){if(3<arguments.length)throw new L("too many argument");Mj.call(this,a,void 0,b,c,void 0,!1)}E(Pj,Mj);function Qj(a,b,c,d,e){if(!w(b))throw new L("index name must be string");Mj.call(this,a,b,c,d,e,!1)}E(Qj,Mj);var Nj="init";h=Mj.prototype;h.logger=R("ydn.db.Iterator");
h.A=function(){return this.i};h.ba=function(){var a=new Mj(this.i,this.h,this.j,Rj(this),Sj(this),this.g,this.n);a.I=this.I;return a};h.unique=function(a){return new Mj(this.i,this.h,this.j,Rj(this),a,this.g,this.n)};h.toJSON=function(){return{store:this.i,index:this.h,keyRange:this.j?dj(this.j):null,direction:this.l}};
h.toString=function(){var a=s(this.n)?":"+this.n.join(","):s(this.h)?":"+this.h:"",a=a+kj(this.j);this.p!=Nj&&(a+=this.p+"{"+this.B,this.o&&(a+=", "+this.C),a+="}");var b=this.o?"Index":"",b=b+(this.g?"Key":"Value");return b+"Iterator:"+this.i+a};h.reverse=function(){return new Mj(this.i,this.h,this.j,!Rj(this),Sj(this),this.g,this.n)};function Rj(a){return"prev"===a.l||"prevunique"===a.l}function Sj(a){return"nextunique"===a.l||"prevunique"===a.l}
h.load=function(a){a=a[0];a.init(this.i,this.n||this.h,this.j,this.l,this.g);this.p="busy";var b=this;a.vc=function(a,d,e){b.B=d;b.C=e;b.p=a?"rest":"done"};a.openCursor(this.B,this.C);return a};h.da=function(){return this.C};h.stores=function(){return[this.i]};function Tj(a,b,c){Rc.call(this,b,c);this.p=a;this.j=[];this.o=[];this.N=[];this.g=null;this.bb="";this.B=0}E(Tj,Rc);h=Tj.prototype;h.bb="";h.logger=R("ydn.db.Request");function Uj(a,b,c){a.g=b;a.bb=c;P(a.logger,a+" BEGIN");if(b){for(c=0;c<a.o.length;c++)a.o[c][0].call(a.o[c][1],b);a.o.length=0}P(a.logger,a+" END")}function Vj(a){var b=new Tj(a.p);a.B++;Uj(b,a.g,a.bb+"C"+a.B);return b}h.qd=function(){return this.p};
h.abort=function(){if(this.g)if(P(this.logger,this+" aborting"),ha(this.g.abort))this.g.abort();else if(ha(this.g.executeSql))this.g.executeSql("ABORT",[],function(){},function(){return!0});else throw new Nc;else throw new Wj("No active transaction");};function V(a,b,c){var d=a.N.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){V(a,b,c)}):c?a.u(b):a.t(b)}function Xj(a,b,c){a.N.push([b,c])}function W(a,b,c){a.g?b.call(c,a.g):a.o.push([b,c])}
h.t=function(a){P(this.logger,this+" SUCCESS");Tj.m.t.call(this,a);this.g=null;this.bb=this.bb};h.u=function(a){P(this.logger,this+" ERROR");Tj.m.u.call(this,a);this.g=null;this.bb=this.bb};function X(a){var b="";a.bb&&(b=a.g?"*":"",b="["+a.bb+b+"]");return a.p+b}function Yj(a,b){var c=new Tj(a);V(c,b);return c}h.toString=function(){return"Request:"+X(this)};
h.oe=function(){this.n&&this.gb&&ob(this)&&(r.clearTimeout(this.n),delete this.n);this.h&&(this.h.cd--,delete this.h);for(var a=this.i,b=!1;this.l.length&&!this.xc;){var c=this.l.shift(),d=c[0],e=c[1],c=c[2];if(d=this.Cb?e:d)d=d.call(c||this.C,a),s(d)&&(this.Cb=this.Cb&&(d==a||d instanceof Error),this.i=a=d),a instanceof G&&(this.xc=b=!0)}this.i=a;b&&(a.w(B(this.jd,this,!0),B(this.jd,this,!1)),a.xf=!0)};
h.toJSON=function(){var a=(this.bb||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.p?this.p.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var mj=Ej&&Ej.cmp?B(Ej.cmp,Ej):yj,Zj=[];(function(a){if(null!=a&&!("push"in a))throw new uh('output receiver object must have "push" method.');}).prototype.logger=R("ydn.db.algo.AbstractSolver");function ak(a){Error.captureStackTrace?Error.captureStackTrace(this,ak):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}E(ak,Error);ak.prototype.name="ConstraintError";ak.prototype.toString=function(){return this.name+": "+this.message};function bk(a){Error.captureStackTrace?Error.captureStackTrace(this,bk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}E(bk,Error);
bk.prototype.toString=function(){return this.name+": "+this.message};function ck(a){Error.captureStackTrace?Error.captureStackTrace(this,ck):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}E(ck,Error);ck.prototype.name="ydn.db.VersionError";ck.prototype.toString=function(){return this.name+": "+this.message};function dk(a){Error.captureStackTrace?Error.captureStackTrace(this,dk):this.stack=Error().stack||"";a&&(this.message=String(a))}E(dk,Error);
dk.prototype.name="ydn.db.InternalError";function Wj(a){Error.captureStackTrace?Error.captureStackTrace(this,Wj):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}E(Wj,Error);function ek(a){Error.captureStackTrace?Error.captureStackTrace(this,ek):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}E(ek,Error);
function fk(a){Error.captureStackTrace?Error.captureStackTrace(this,fk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}E(fk,Error);fk.prototype.name="NotFoundError";fk.prototype.toString=function(){return this.name+": "+this.message};function gk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,gk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}E(gk,Error);
gk.prototype.toString=function(){return this.name+": "+this.message};function hk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,hk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}E(hk,Error);hk.prototype.toString=function(){return this.name+": "+this.message};function ik(a){Error.captureStackTrace?Error.captureStackTrace(this,ik):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}
E(ik,Error);function jk(a){Error.captureStackTrace?Error.captureStackTrace(this,jk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}E(jk,Error);function kk(a,b,c){var d;if(A(a))d=a.store,b=a.id,null!=a.parent&&(c=new kk(a.parent));else if(s(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new kk(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!s(b))throw Error("Invalid key value: "+a);this.M=d;this.id=b;this.parent=c||null}h=kk.prototype;h.toJSON=function(){var a={store:this.M,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
h.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.M+"^:"+this.id};h.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};h.A=function(){return this.M};h.F=function(){return this.id};function lk(a){return u(a.id)?a.id.join("^|"):a.id instanceof Date?+a.id:a.id}h.getParent=function(){return this.parent};function mk(a){return y(a)||w(a)||u(a)&&Sa(a,mk)||a instanceof Date}
function Jj(a){if(v(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function nk(a,b){this.g=b}nk.prototype.logger=R("ydn.db.crud.req.RequestExecuto");nk.prototype.toString=function(){return"RequestExecutor"};function ok(a,b,c,d,e,f){this.ra=a;this.La=b;this.g=this.i=0;this.X=d;this.S=e;this.l=c||pk;this.I=f||0;this.p=!1;this.C=0}h=ok.prototype;h.logger=R("ydn.db.tr.Thread");h.Sg=function(a){if("complete"==a||"abort"==a)this.p?(Q(this.logger,"tx "+this.i+" committed"),this.p=!1):(Q(this.logger,"Generator done "+this.p),V(null,this.i,"complete"!=a))};
h.ic=function(){if(s(this.B))if(this.B)Q(this.logger,"Receive to commit tx "+this.i+" on yield "+this.C),this.p=!0;else throw new Pc("Coroutine transaction thread has been ended");else throw new Pc("Transaction thread not running in a generator");};
function qk(a,b){a.p?(Q(a.logger,"waiting tx to be committed for yielding "+a.C),setTimeout(function(){a.Hb(function(){Q(a.logger,"sending result to yield "+a.C);a.B.next(b)},a.X,a.S,B(a.Sg,a))},4)):(Q(a.logger,"sending result to yield "+a.C),a.B.next(b));a.C++}h.request=function(a){a=new Tj(a);this.B&&a.w(function(a){qk(this,a)},function(a){var c=a;a instanceof Error||(c=Error(),c.error=a);qk(this,c)},this);return a};h.type=function(){return rk(this.ra)};h.H=function(){return this.ra};
h.Ga=function(){return"B"+this.La+"T"+this.i};var pk="single";function sk(a){if(a)if(ha(a.abort))a.abort();else if(ha(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new Nc;else throw new Wj("No active transaction");};function tk(a){this.i=a;this.g=null;this.h=0}tk.prototype.logger=R("ydn.db.tr.Mutex");tk.prototype.Wa=null;function uk(a){return!!a.g&&!a.j}tk.prototype.Qa=null;tk.prototype.toString=function(){return"Mutex:"+("B"+this.i+"T"+this.h)+(this.g?"*":"")};function vk(a,b,c,d,e,f){ok.call(this,a,b,c,d,e,f);this.j=[];this.n=[];this.o=null;this.h=new tk(b);this.N=f||0;this.ja=!1}E(vk,ok);h=vk.prototype;h.logger=R("ydn.db.tr.Serial");
function wk(a,b,c){if("multi"==a.l)a:if(a=a.h,!a.Wa||!a.mode||c!=a.mode&&(a.mode!=U||c!=Cj)||b.length>a.Wa.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.Wa.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.l)a:if(a=a.h,a.Wa&&a.mode&&c==a.mode&&a.Wa.length==b.length){for(c=0;c<b.length;c++)if(-1==a.Wa.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.l?!0:!1;return b}
function xk(a){var b=0<a.j.length?a.j[0].Wa:null,c=0<a.j.length?a.j[0].mode:null;return null!=b&&null!=c?wk(a,b,c):!1}function yk(a,b,c,d,e){Q(a.logger,"push tx queue["+a.j.length+"]");a.j.push({nd:b,Wa:c,mode:d,Qa:e})}h.abort=function(){P(this.logger,this+": aborting");sk(this.o)};
h.Hb=function(a,b,c,d){var e=w(b)?[b]:b;if(v(e)){if(0==e.length)throw new L("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!w(e[f]))throw new L("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.Kb&&!Va(this.Kb,e[f]))throw new L('store name "'+f+e[f]+'" in scope of '+this);}}else throw new L("store names must be an array");var g=s(c)?c:Cj,k=this;if(this.h.g||!zk(this.H())&&this.ja)yk(this,a,b,g,d);else{var l=this.Ga();d&&this.n.push(d);
if(this.N&&this.i>=this.N)throw new Pc("Exceed maximum number of transactions of "+this.N);this.ja=!0;Ak(this.H(),function(c){var d=k.h;d.g=c;d.j=!1;d.Wa=b;d.mode=g;d.h++;d.Qa=null;l=k.Ga();O(k.logger,l+" BEGIN "+S(b)+" "+g);a(k);for(a=null;xk(k);)c=k.j.shift(),c.Qa&&k.n.push(c.Qa),Q(k.logger,"pop tx queue"+(k.j.length+1)+" reusing T"+k.i),c.nd()},e,g,function(a,b){O(k.logger,l+" "+a);var c=k.h;c.g?(c.g=null,c.Wa=null,c.mode=null,ha(c.Qa)&&c.Qa(a,b),c.Qa=null):M(c.logger,c+" has no TX to be unlocked for "+
a);for(c=0;c<k.n.length;c++)(0,k.n[c])(a,b);k.n.length=0;(c=k.j.shift())&&k.Hb(c.nd,c.Wa,c.mode,c.Qa);k.g=0})}};h.Ga=function(){var a=this.h;return"B"+a.i+"T"+a.h};h.request=function(a,b,c,d){var e=vk.m.request.call(this,a,b,c,d);a=c||Cj;var f=this;uk(this.h)&&wk(this,b,a)?(b=this.h.g,this.g++,Uj(e,b,this.Ga()+"R"+this.g),d&&this.n.push(d)):f.Hb(function(){var a=f.h.g;f.g++;Uj(e,a,f.Ga()+"R"+f.g)},b,a,d);return e};
h.gc=function(a,b,c,d,e){d=d||Cj;var f=this,g;if(uk(f.h)&&wk(this,c,d)){var k=f.h.g;f.g++;g=f.Ga()+"R"+f.g;P(f.logger,g+" BEGIN");b(k,g,function(b,c){f.o=k;c?(P(f.logger,g+" ERROR"),a.u(b)):(P(f.logger,g+" SUCCESS"),a.t(b));f.o=null});P(f.logger,g+" END");b=null}else f.Hb(function(){var c=f.h.g;f.g++;g=f.Ga()+"R"+f.g;P(f.logger,g+" BEGIN");b(c,g,function(b,d){f.o=c;d?(P(f.logger,g+" ERROR"),a.u(b)):(P(f.logger,g+" SUCCESS"),a.t(b));f.o=null});P(f.logger,g+" END");b=null},c,d,e)};h.getName=function(){return this.H().getName()};
h.toString=function(){return"Serial:"+this.Ga()+(this.o?"*":"")};function Bk(a,b){vk.call(this,a,b)}E(Bk,vk);Bk.prototype.logger=R("ydn.db.tr.AtomicSerial");Bk.prototype.request=function(a,b,c){var d,e,f,g=Bk.m.request.call(this,a,b,c,function(a,b){g.g=null;if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new jk;V(g,c,!0)}});Xj(g,function(a,b,c){f=b;e=a;d=c});return g};
Bk.prototype.gc=function(a,b,c,d,e){var f,g,k=new G;k.w(function(a){g=!1;f=a},function(a){g=!0;f=a});Bk.m.gc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.u(c);else if(!0===g)a.u(f);else if(!1===g)a.t(f);else{var d=new jk;a.u(d)}e&&(e(b,c),e=void 0)})};Bk.prototype.toString=function(){return"Atomic"+Bk.m.toString.call(this)};function Ck(a,b,c,d){this.j=a;this.h=b;this.g=c;this.Sa=d;this.i=null}h=Ck.prototype;h.logger=R("ydn.db.tr.DbOperator");h.abort=function(){this.g.abort()};function Y(a){a.i||(a.i=a.j.C());return a.i}h.H=function(){return this.j};h.ic=function(){this.g.ic()};
function Dk(a,b){var c=a.H(),d=b instanceof Ek?b:Fk(b),e=b.name,f=Z(c.h,e);if(0==Gk(d,f).length)pb(!1);else if(f=f?"update":"add",c.h instanceof Hk)Ik(c.h,d),c.i?(c.i.Vd(),c.i=null,Jk(c)):pb(!1);else throw new yh("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}h.toString=function(){return"TxStorage:"+this.H().getName()};function Kk(a,b,c,d){Ck.call(this,a,b,c,d)}E(Kk,Ck);h=Kk.prototype;h.logger=R("ydn.db.crud.DbOperator");
h.count=function(a,b,c,d){var e,f,g,k;if(null!=a)if(u(a)){if(s(c)||s(b))throw new L("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!Lk(this.h,f[l]))throw new L('store name "'+f[l]+'" at '+l+" not found.");P(this.logger,"countStores: "+S(f));e=this.g.request("count",f);W(e,function(){Y(this).kd(e,f)},this)}else if(w(a)){l=Z(this.h,a);if(!l)throw new L('store name "'+a+'" not found.');if(s(d)&&!ga(d))throw new L('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(w(b))if(g=
b,A(c)){var m=jj(c);if(m)throw new L("invalid key range: "+ph(c)+" "+m);k=fj(c)}else{if(null!=c)throw new L("invalid key range: "+ph(c)+" of type "+typeof c);k=null}else if(A(b)||null==b)if(A(b)){if(m=jj(b))throw new L("invalid key range: "+ph(b)+" "+m);k=fj(b)}else{if(null!=b)throw new L("key range must be  an object but found "+ph(b)+" of type "+typeof b);k=null}else throw new L('invalid second argument for count "'+ph(c)+'" of type '+typeof b);P(this.logger,"countKeyRange: "+a+" "+(g?g:"")+S(k));
e=this.g.request("count",f);Mk(l,e,arguments);W(e,function(){Y(this).yc(e,f[0],k,g,!!d)},this)}else throw new L("Invalid store name or store names.");else M(this.logger,"count method requires store name(s)"),l=Nk(this.h),e=this.g.request("count",l),Xj(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),W(e,function(){Y(this).kd(e,f)},this);return e};
h.get=function(a,b){var c=this,d;if(a instanceof kk){var e=a,f=e.A(),g=Z(this.h,f);if(!g){if(this.h.g()){if(zk(this.H()))return Yj("get",void 0);d=new Tj("get");this.H().Eb(function(){c.get(a,b).w(function(a){d.t(a)},function(a){d.u(a)})});return d}throw new L("Store: "+f+" not found.");}var k=e.F();P(this.logger,"getByKey: "+f+":"+k);d=this.g.request("get:key",[f]);Mk(g,d,arguments,void 0,this);W(d,function(){Y(this).od(d,f,k)},this)}else if(w(a)&&s(b)){var l=a,g=Z(this.h,l);if(!g){if(this.h.g()){if(zk(this.H()))return Yj("get",
void 0);d=new Tj("get");this.H().Eb(function(){c.get(a,b).w(function(a){d.t(a)},function(a){d.u(a)})});return d}throw new L('Store name "'+l+'" not found.');}var m=b;P(this.logger,"getById: "+l+":"+m);d=this.g.request("get",[l]);Mk(g,d,arguments,void 0,this);W(d,function(){Y(this).od(d,l,m)},this)}else throw new L("get require valid input arguments.");return d};
h.keys=function(a,b,c,d,e,f,g){var k,l,m=null,n=!1,p=!1,q=a,t=Z(this.h,q);if(!w(q))throw new L("store name must be a string, but "+q+" of type "+typeof q+" is not.");if(!this.h.g()){if(!t)throw new L('store name "'+q+'" not found.');if(w(b)&&!Hj(t,b))throw new L('index "'+b+'" not found in store "'+q+'".');}if(this.h.g()&&!t)return Yj("keys",[]);var x;if(w(b)){var z=b,D=jj(c);if(D)throw new L("invalid key range: "+c+" "+D);m=fj(c);if(y(d))k=d;else{if(s(d))throw new L("limit must be a number");k=100}if(y(e))l=
e;else{if(s(e))throw new L("offset must be a number");l=0}if(s(f))if(ga(f))n=f;else throw new L("reverse must be a boolean");if(s(g))if(ga(g))p=g;else throw new L("unique must be a boolean");P(this.logger,"keysByIndexKeyRange: "+q);x=this.g.request("keys:iter:index",[q]);Mk(t,x,arguments);W(x,function(){Y(this).list(x,2,q,z,m,k,l,n,p)},this)}else{if(A(b)){if(D=jj(b))throw new L("invalid key range: "+ph(b)+" "+D);m=fj(b)}else{if(null!=b)throw new L("invalid key range: "+ph(b)+" of type "+typeof b);
m=null}if(y(c))k=c;else{if(s(c))throw new L("limit must be a number");k=100}if(y(d))l=d;else{if(s(d))throw new L("offset must be a number");l=0}if(s(e))if(ga(e))n=e;else throw new L("reverse must be a boolean");P(this.logger,"keysByKeyRange: "+q);x=this.g.request("keys",[q]);Mk(t,x,arguments);W(x,function(){Y(this).list(x,2,q,null,m,k,l,n,!1)},this)}return x};
h.values=function(a,b,c,d,e,f,g){var k=this,l,m,n,p=!1,q=!1;if(w(a)){var t=a,x=Z(this.h,t);if(!x){if(this.h.g()){if(zk(this.H()))return Yj("values",[]);l=new Tj("values");this.H().Eb(function(){k.values(a,b,c,d,e,f).w(function(a){l.t(a)},function(a){l.u(a)})});return l}throw new fk(t);}if(u(b)){if(s(c)||s(d))throw new L("too many input arguments");var z=b;P(this.logger,"listByIds: "+t+" "+z.length+" ids");l=this.g.request("values:array",[t]);Mk(x,l,arguments,void 0,this);W(l,function(){Y(this).Se(l,
t,z)},this)}else if(w(b)){var D=b;if(!Ok(x,D))throw new L('index "'+D+'" not found in store "'+t+'"');var F=jj(c);if(F)throw new L("invalid key range: "+c+" "+F);var J=fj(c);if(s(d))if(y(d))m=d;else throw new L("limit must be a number.");else m=100;if(s(e))if(y(e))n=e;else throw new L("offset must be a number.");else n=0;if(ga(f))p=f;else if(s(f))throw new L("reverse must be a boolean, but "+f);if(s(g))if(ga(g))q=g;else throw new L("unique must be a boolean");P(this.logger,"listByIndexKeyRange: "+
t+":"+D);l=this.g.request("values:iter:index",[t]);Mk(x,l,arguments);W(l,function(){Y(this).list(l,4,t,D,J,m,n,p,q)},this)}else{J=null;if(A(b)){if(F=jj(b))throw new L("invalid key range: "+b+" "+F);J=fj(b)}else if(null!=b)throw new L('expect key range object, but found "'+ph(b)+'" of type '+typeof b);if(s(c))if(y(c))m=c;else throw new L("limit must be a number, but "+c+" is "+typeof c);else m=100;if(s(d))if(y(d))n=d;else throw new L("offset must be a number, but "+d+" is "+typeof d);else n=0;if(s(e))if(ga(e))p=
e;else throw new L("reverse must be a boolean, but "+e+" is "+typeof e);P(this.logger,(J?"listByKeyRange: ":"listByStore: ")+t);l=this.g.request("values",[t]);Mk(x,l,arguments);W(l,function(){Y(this).list(l,4,t,null,J,m,n,p,!1)},this)}}else if(u(a))if(a[0]instanceof kk){for(var x=[],N=a,F=0;F<N.length;F++){var fa=N[F].A();if(!Lk(this.h,fa)){if(this.h.g())return x=[],x[N.length-1]=void 0,Yj("get",x);throw new L("Store: "+fa+" not found.");}Va(x,fa)||x.push(fa)}P(this.logger,"listByKeys: "+S(x)+" "+
N.length+" keys");l=this.g.request("values:keys",x);W(l,function(){Y(this).Dd(l,N)},this)}else throw new L("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found.");else throw new L("first argument "+a+" is invalid.");return l};
h.list=function(a,b,c,d,e,f,g,k,l){var m=Z(this.h,b);if(!m){if(this.h.g())return Yj("get",[]);throw new fk(b);}var n;if(c&&!Ok(m,c))throw new L('index "'+c+'" not found in store "'+b+'"');if(m=jj(d))throw new L("invalid key range: "+d+" "+m);var p=fj(d),q=100;if(y(e))q=e;else if(null!=e)throw new L('limit must be a number but "'+e+'" of type '+typeof e+" found.");var t=0;if(y(f))t=f;else if(null!=f)throw new L('offset must be a number but "'+f+'" of type '+typeof f+" found.");var x=!1;if(ga(g))x=
g;else if(null!=g)throw new L('reverse must be a boolean but "'+g+'" of type '+typeof g+" found.");var z=!1;if(ga(k))z=k;else if(null!=k)throw new L('unique must be a boolean but "'+k+'" of type '+typeof k+" found.");if(t&&l&&s(l[0]))throw new L("offset must not given when initial cursor position is defined");P(this.logger,a+": "+b+":"+c);n=this.g.request("values:iter:index",[b]);W(n,function(){Y(this).list(n,a,b,c||null,p,q,t,x,z,l)},this);return n};
h.add=function(a,b,c){var d=w(a)?a:A(a)?a.name:void 0;if(!w(d))throw new L("store name "+d+" must be a string, but "+typeof d);var e=Z(this.h,d);if(!e){if(!this.h.g())throw new L('store name "'+d+'" not found.');e=Fk(A(a)?a:{name:d});P(this.logger,"Adding object store: "+d);Dk(this,e)}else if(this.h.g()&&A(a)&&(a=Fk(a),a=Gk(e,a)))throw new Nc(a);var f;if(!e)throw new L('store name "'+d+'" not found.');if(w(e.keyPath)&&s(c))throw new L("key must not be provided while the store uses in-line key.");
if(!e.keyPath&&!e.h&&!s(c))throw new L("out-of-line key must be provided.");if(u(b)){P(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)Pk(e,b[a]);f=this.g.request("add:array",[d],U);W(f,function(){Y(this).$a(f,!1,!1,d,b,c)},this);e.Ob&&f.D(function(a){a=new Qk(Rk,this.H(),e.getName(),a,b);this.H().Na(a)},this)}else if(A(b))a="store: "+d+" key: "+Sk(e,b,c),P(this.logger,"addObject: "+a),Pk(e,b),f=this.g.request("add",[d],U),W(f,function(){Y(this).$a(f,!1,!0,d,[b],[c])},
this),e.Ob&&f.D(function(a){a=new Tk(Rk,this.H(),e.getName(),a,b);this.H().Na(a)},this);else throw new L("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};
function Uk(a,b){var c=w(b)?b:A(b)?b.name:void 0;if(!w(c))throw new L("store name must be a string");var d=Z(a.h,c);if(!d){if(!a.h.g())throw new fk(c);d=Fk(A(b)?b:{name:c});P(a.logger,"Adding object store: "+c);Dk(a,d)}else if(a.h.g()&&A(b)){var e=Fk(b);if(e=Gk(d,e))throw new Nc(e);}if(!d)throw new fk(c);return d}h.load=function(a,b,c){var d=c||",",e=Uk(this,a).getName();a=this.g.request("load",[e]);var f=this;this.g.gc(a,function(a,c,l){Y(f).Ye(a,c,l,e,b,d)},[e],U);return a};
h.search=function(a){var b=Vk(a);Q(this.logger,"query "+a);var c=this.g.request("search",b,Cj);W(c,function(){var b=Y(this);Wk(a,function(e,f,g,k){var l=Vj(c);b.list(l,4,e,f,fj(g),100,0,!1,!1);l.aa(function(b){var d=null;b instanceof Array||(d=b,b=[]);for(var e=0;e<b.length;e++){var f;f=b[e];var g=f.id,g=w(g)?uj(g):g,k=g[3];(f=1==this.type&&k!=this.value?null:new Yk(this,g[0],g[2],g[1],k,f.k,f.loc))&&a.j.push(f)}a.i--;b=0==a.i?!1:a.h[a.h.length-1].l===this.l?!0:null;!0===b?Sc(c,a):!1===b&&c.t(Zk(a));
if(d)throw d;},k)})},this);return c};
h.put=function(a,b,c){var d,e=this;if(a instanceof kk){var f=a,g=f.A(),k=Z(this.h,g);if(!k)throw new L('store "'+g+'" not found.');if(k.keyPath){var l=Sk(k,b);if(null!=l){if(0!=mj(l,f.F()))throw new L("Inline key must be "+f+" but "+l+" found.");}else $k(k,b,f.F());return this.put(g,b)}return this.put(g,b,f.F())}if(u(a)){if(s(c))throw new L("too many arguments");var m=a;if(!s(b))throw new L("record values required");for(var n=b,f=[],g=0,k=m.length;g<k;g++){l=m[g].A();-1==Na(f,l)&&f.push(l);var p=
Z(this.h,l);if(!p)throw new L('store "'+l+'" not found.');p.keyPath&&$k(p,n[g],m[g].F())}P(this.logger,"putByKeys: to "+S(f)+" "+n.length+" objects");for(g=0;g<n.length;g++)Pk(p,n[g]);d=this.g.request("put:keys",f,U);Mk(p,d,arguments);W(d,function(){Y(e).Jd(d,n,m)},this)}else if(w(a)||A(a)){var p=Uk(this,a),q=p.getName();if(p.keyPath&&s(c))throw new L("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.h&&!s(c))throw new L("out-of-line key must be provided.");if(u(b)){var t=
b,x=c;P(this.logger,"putObjects: "+q+" "+t.length+" objects");for(g=0;g<t.length;g++)Pk(p,t[g]);d=this.g.request("put:array",[q],U);Mk(p,d,arguments);W(d,function(){Y(this).$a(d,!0,!1,q,t,x)},this);p.Ob&&d.D(function(a){a=new Qk(al,this.H(),q,a,t);this.H().Na(a)},this)}else if(A(b)){var z=b,D=c;P(this.logger,"putObject: "+q+" "+D);if(s(r.Blob)&&z instanceof Blob&&p.fc&&!p.keyPath&&0==p.indexes.length&&Hb)d=new Tj("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,c=e.g.request("put",
[q],U);Mk(p,c,[q,z,D]);W(c,function(){Y(e).$a(c,!0,!0,q,[b],[D])},this);c.w(function(a){d.t(a)},function(a){d.u(a)})},f.onerror=function(a){d.u(a)},f.onabort=function(a){d.u(a)},f.readAsDataURL(z);else{Pk(p,z);d=this.g.request("put",[q],U);var F=[q,z,D];Mk(p,d,F);W(d,function(){var a=s(D)?[F[2]]:void 0;Y(e).$a(d,!0,!0,q,[F[1]],a)},this)}p.Ob&&d.D(function(a){a=new Tk(al,this.H(),q,a,z);this.H().Na(a)},this)}else throw new L("put record value must be Object or array of Objects");}else throw new L("the first argument of put must be store name, store schema or array of keys.");
return d};
function bl(a,b,c,d){var e=a.Sa,f,g;if(w(b)){var k=Z(a.h,b);if(k){if(!k.keyPath&&!k.h&&null==d)throw new L('key required for store "'+b+'"');}else throw new fk(b);for(var l=0;l<c.length;l++)Pk(k,c[l]);f=[b]}else{g=b;f=[];for(var l=0,m=g.length;l<m;l++){var n=g[l].A(),k=Z(a.h,n);-1==Na(f,n)&&f.push(n);if(!k)throw new fk(n);Pk(k,c[l])}}var p;w(b)?(k=Z(a.h,b),p=e.request("put:array",f,U),W(p,function(){Y(this).$a(p,!0,!1,b,c,d)},a)):(p=e.request("put:keys",f,U),W(p,function(){Y(this).Jd(p,c,g)},a));
return p}function cl(a,b){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d].A();-1==Na(c,f)&&c.push(f);if(!Lk(a.h,f))throw new fk(f);}var g=a.Sa.request("rm:keys",c,U);W(g,function(){Y(this).Md(g,b)},a);return g}function dl(a,b,c){var d=a.Sa.request("rm:iter",[b],U);W(d,function(){Y(this).Pc(d,b,c||null)},a);return d}
function el(a,b,c,d,e,f,g){f=f||100;var k,l=g||0;if(g=Z(a.h,b)){if(c&&!Ok(g,c))throw new fk('index "'+c+'" in store "'+b+'"');}else throw new fk(b);var m=fj(d);w(c)?(k=a.Sa.request("values:iter:index",[b]),W(k,function(){Y(this).list(k,4,b,c,m,f,l,e,!1)},a)):(k=a.Sa.request("values",[b]),W(k,function(){Y(this).list(k,4,b,null,m,f,l,e,!1)},a));return k}
function fl(a,b){var c=[],d=b.length;if(0==d)return Yj("keys",[]);for(var e=0;e<d;e++){var f=b[e].A();-1==Na(c,f)&&c.push(f);if(!Lk(a.h,f))throw new fk(f);}var g=a.Sa.request("keys",c);W(g,function(){Y(a).Dd(g,b)},a);return g}
function gl(a,b,c,d,e,f,g,k){var l;e=e||100;var m=Z(a.h,b);if(m){if(c&&!Ok(m,c))throw new fk('index "'+c+'" in store "'+b+'"');}else throw new fk(b);w(c)?(l=a.Sa.request("keys:iter:index",[b]),W(l,function(){Y(this).list(l,2,b,c,d,e,f,g,k)},a)):(l=a.Sa.request("keys",[b]),W(l,function(){Y(this).list(l,2,b,null,d,e,f,g,k)},a));return l}
h.clear=function(a,b,c){if(s(c))throw new L("too many input arguments");var d;if(w(a)){c=Z(this.h,a);if(!c)throw new L('store name "'+a+'" not found.');if(A(b)){var e=fj(b);if(null===e)throw new L("clear method requires a valid non-null KeyRange object.");P(this.logger,"clearByKeyRange: "+a+":"+S(e));d=this.g.request("clear",[a],U);Mk(c,d,[a,e]);W(d,function(){Y(this).ie(d,a,e)},this)}else{if(s(b))throw new L("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+
typeof b);P(this.logger,"clearByStore: "+a);d=this.g.request("clear",[a],U);W(d,function(){Y(this).fd(d,[a])},this)}}else if(!s(a)||u(a)&&w(a[0])){var f=a||Nk(this.h);P(this.logger,"clearByStores: "+S(f));d=this.g.request("clear",f,U);W(d,function(){Y(this).fd(d,f)},this)}else throw new L('first argument "'+a+'" is invalid.');return d};
h.remove=function(a,b,c){var d;if(w(a)){var e=Z(this.h,a);if(!e)throw new L('store name "'+a+'" not found.');if(s(c))if(w(b)){var f=Hj(e,b);if(!f)throw new L("index: "+b+" not found in "+a);if(A(c)||null===c){var g=fj(c);P(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.g.request("rm:iter:index",[a],U);W(d,function(){Y(this).Ze(d,a,f.getName(),g)},this)}else throw new L("key range "+c+' is invalid type "'+typeof c+'".');}else throw new L('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(w(b)||y(b)||v(b)||b instanceof Date){P(this.logger,"removeById: "+a+":"+b);d=this.g.request("rm",[a],U);var k=[a,b];Mk(e,d,k);W(d,function(){Y(this).Ld(d,a,k[1])},this);e.Ob&&d.D(function(b){b=new Tk(hl,this.H(),a,b,void 0);this.H().Na(b)},this)}else if(A(b))g=fj(b),P(this.logger,"removeByKeyRange: "+a+":"+S(g)),d=this.g.request("rm:iter",[a],U),Mk(e,d,[a,g]),W(d,function(){Y(this).Pc(d,a,g)},this),e.Ob&&d.D(function(b){b=new Qk(hl,this.H(),a,b,void 0);this.H().Na(b)},
this);else throw new L('Invalid key or key range "'+b+'" of type '+typeof b);}else if(a instanceof kk){var l=a.A(),e=Z(this.h,l);d=this.g.request("rm",[l],U);var m=[l,a.F()];Mk(e,d,m);W(d,function(){Y(this).Ld(d,l,m[1])},this)}else if(u(a)){b=[];c=0;for(e=a.length;c<e;c++){if(!(a[c]instanceof kk))throw new L("key list element at "+c+" of "+e+' must be yn.db.Key, but "'+ph(a[c])+'" ('+ea(a[c])+") is not ydn.db.Key.");var n=a[c].A();-1==Na(b,n)&&b.push(n)}if(1>b.length)throw new L('at least one valid key required in key list "'+
ph(a)+'"');d=this.g.request("rm:keys",b,U);W(d,function(){Y(this).Md(d,a)},this)}else throw new L('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+ph(a)+'" ('+ea(a)+") found.");return d};h.toString=function(){return"DbOperator:"+this.H().getName()};function il(a,b,c,d){Ck.call(this,a,b,c,d)}E(il,Kk);h=il.prototype;h.logger=R("ydn.db.core.DbOperator");h.get=function(a,b){if(a instanceof Mj){var c=a.A(),d=Z(this.h,c);if(!d)throw new L('store "'+c+'" not found.');var e=a.h;if(s(e)&&!Ok(d,e))throw new L('index "'+e+'" not found in store "'+c+'".');P(this.logger,"getByIterator:"+a);var f=this.g.request("get:iter",[c]);W(f,function(){jl(this,5,f,a,1)},this);return f}return il.m.get.call(this,a,b)};
h.keys=function(a,b,c,d,e,f,g){if(a instanceof Mj){var k=100;if(y(b)){if(k=b,1>k)throw new L("limit must be a positive value, but "+b);}else if(s(b))throw new L("limit must be a number,  but "+b);if(s(c))throw new L("offset must not be specified");P(this.logger,"keysByIterator:"+a);var l=this.g.request("keys:iter",[a.A()]);W(l,function(){a.o?jl(this,1,l,a,k):jl(this,2,l,a,k)},this);return l}return il.m.keys.call(this,a,b,c,d,e,f,g)};
h.count=function(a,b,c,d){if(a instanceof Mj){if(s(b)||s(c))throw new L("too many arguments.");P(this.logger,"countIterator:"+a);var e=this.g.request("count",[a.A()]);W(e,function(){jl(this,6,e,a)},this);return e}return il.m.count.call(this,a,b,c,d)};
h.values=function(a,b,c,d,e,f){if(a instanceof Mj){var g;if(y(b)){if(g=b,1>g)throw new L("limit must be a positive value, but "+g);}else if(s(b))throw new L("limit must be a number, but "+b);if(s(c))throw new L("offset must not be specified");P(this.logger,"listByIterator:"+a);var k=this.g.request("values:iter",[a.A()]);W(k,function(){a.g?jl(this,2,k,a,g):jl(this,4,k,a,g)},this);return k}return il.m.values.call(this,a,b,c,d,e,f)};
h.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new L('Store "'+e+'" not found.');e=this.g.request("map",d);Q(this.logger,"map:"+a);this.g.gc(e,function(d,e,f){Q(c.logger,e+" iterating "+a);for(var m=a.stores(),n=[],p=0;p<m.length;p++)n[p]=Y(c).h(d,e,m[p]);var q=a.load(n);q.S=function(a){f(a,!1)};q.N=function(c){if(null!=c){var d;a.o?a.g?d=c:d=q.da():a.g?d=c:d=q.Q();b(d);q.advance(1)}else f(void 0),b=null}},d,Cj);return e};
function jl(a,b,c,d,e){var f=[],g=c.g,k=X(c),l=k+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);P(a.logger,l);for(var m=Y(a),n=[],p=d.stores(),q=0;q<p.length;q++)n[q]=m.h(g,k,p[q]);var t=d.load(n);t.S=function(a){Kj(t);V(c,a,!0)};var x=0,z=!1;t.N=function(d){z||(Q(a.logger,l+" starting"),z=!0);null!=d?(t.da(),x++,1==b?f.push(d):2==b?f.push(t.da()):3==b?f.push([d,t.da()]):6!=b&&f.push(t.Q()),5==b?(Kj(t),V(c,f[0])):6==b||!s(e)||x<e?t.hd():(P(a.logger,"success:"+l+" yields "+f.length+" records"),Kj(t),
V(c,f))):(P(a.logger,"success:"+l+" yields "+f.length+" records"),Kj(t),V(c,5==b?f[0]:6==b?x:f))}};var Rk="created",hl="deleted",al="updated";function kl(a,b){K.call(this,a,b)}E(kl,K);kl.prototype.A=function(){return this.M};function ll(a,b,c){K.call(this,a,b);this.version=c}E(ll,kl);ll.prototype.name="ReadyEvent";ll.prototype.version=NaN;function ml(a,b,c){K.call(this,c||"error",a);this.error=b}E(ml,kl);ml.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};ml.prototype.name="ErrorEvent";ml.prototype.error=null;function nl(a,b){ml.call(this,a,b,"fail")}E(nl,ml);
nl.prototype.name="FailEvent";function Tk(a,b,c,d,e){K.call(this,a,b);this.M=c;this.key=d;this.value=e}E(Tk,kl);Tk.prototype.name="RecordEvent";Tk.prototype.Q=function(){return this.value};function Qk(a,b,c,d,e){K.call(this,a,b);this.M=c;this.keys=d;this.values=e}E(Qk,kl);Qk.prototype.name="StoreEvent";Qk.prototype.Ha=function(){return this.keys};Qk.prototype.ta=function(){return this.values};function ol(a,b,c,d,e,f){s(e)||(e=u(a)?a.join(", "):a);if(null!=a&&!w(a)&&!v(a))throw new L("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);u(a)&&Object.freeze&&Object.freeze(a);!s(a)&&s(e)&&(a=e);this.keyPath=a;this.n=v(this.keyPath);this.h=e;this.type=pl(b);if(s(b)){if(!s(this.type))throw new L("type invalid in index: "+this.h);if(u(this.keyPath))throw new L('composite key for store "'+this.h+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;this.o=w(this.type)?
this.type:ql;this.j=w(e)?e:u(a)?this.keyPath.join(","):a;this.i=Ia(this.j);this.g=this.n?null:this.keyPath.split(".");this.l=f||null}function rl(a,b){if(null!=b){if(v(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=oj(b,a.keyPath[d]);c[d]=f}return c}return oj(b,a.keyPath)}}function sl(a,b,c){for(var d=0;d<a.g.length;d++)d==a.g.length-1?b[a.g[d]]=c:A(b[a.g[d]])||(b[a.g[d]]={})}var ql="TEXT";function nj(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return null!=b?a:rj(a)}
function tl(a,b){return"DATE"==b?new Date(a):s(b)?a:uj(a)}var ul=["BLOB","DATE","INTEGER","NUMERIC",ql];function pl(a){if(w(a))return a=Na(ul,a),ul[a]}h=ol.prototype;h.getName=function(){return this.h};h.toJSON=function(){return{name:this.h,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};h.ba=function(){var a=u(this.keyPath)?Za(this.keyPath):this.keyPath;return new ol(a,this.type,this.unique,this.multiEntry,this.h,this.l)};
function vl(a,b){return null!=a||null!=b?null!=a?null!=b?v(a)&&v(b)?cb(a,b)?null:"expect: "+a+", but: "+b:wl(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}h.hint=function(a){if(!a)return this;var b=u(this.keyPath)?Za(this.keyPath):this.keyPath,c=this.type;s(a.type)||"TEXT"!=c||(c=void 0);return new ol(b,c,this.unique,this.multiEntry,a.h)};function xl(a,b){a.l=b}
h.toString=function(){var a=this.multiEntry?"MultiEntry":"";this.g&&1<this.g.length&&(a+="Compound");return a+"Index:"+this.h};function Ek(a,b,c,d,e,f,g,k){this.i=a;if(!w(this.i))throw new L("store name must be a string");this.keyPath=s(b)?b:null;this.p=v(this.keyPath);if(null!==this.keyPath&&!w(this.keyPath)&&!this.p)throw new L("keyPath must be a string or array");this.h=c;var l;if(null!=d){l=pl(d);if(!s(l))throw new L('type "'+d+'" for primary key in store "'+this.i+'" is invalid.');if(this.p)throw new L('composite key for store "'+this.i+'" must not specified type');}this.type=null!=l?l:this.h?"INTEGER":void 0;this.n=
w(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.Ob=!!f;this.fc=!!g;this.B=w(this.type)?this.type:ql;this.l=u(this.keyPath)?this.keyPath.join(","):w(this.keyPath)?this.keyPath:"_ROWID_";this.j=Ia(this.l);if(this.C=!!k){if(this.keyPath)throw new L('encrypted store "'+this.i+'" must not use inline key');if(this.h)throw new L('encrypted store "'+this.i+'" must not use key generator');}this.o=[]}h=Ek.prototype;h.Ob=!1;h.fc=!1;
h.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.i,keyPath:this.keyPath,autoIncrement:this.h,type:this.type,indexes:a}};
function Fk(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==Na(b,c))throw new L('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(u(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==Na(f,g))throw new L("Unknown field: "+g+" in "+S(e));e=new ol(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
s(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new Ek(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}function yl(a,b,c,d,e,f,g){a=zl(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.zc;a.pa&&(b+=" WHERE "+a.pa);a.group&&(b+=" GROUP BY "+a.group);a.$b&&(b+=" ORDER BY "+a.$b);return b}
function zl(a,b,c,d,e,f,g){var k={select:"",zc:"",pa:"",group:"",$b:""},l=a.l,m=a.j,n=null;d!==l&&w(d)&&(n=Hj(a,d));var p=!!n,q=d||l,t=Ia(q),x=p?n.type:a.type,z=p&&n.multiEntry;k.zc=Al(a);6===c?k.select="COUNT("+m+")":3===c||1===c||2===c?(k.select=m,null!=d&&d!=l&&(k.select+=", "+t)):k.select="*";d=g?"DISTINCT ":"";l=[];z?(z=Ia("ydn.db.me:"+a.getName()+":"+n.getName()),k.select=6===c?"COUNT("+d+z+"."+t+")":3===c||1===c||2===c?"DISTINCT "+Al(a)+"."+m+", "+z+"."+t+" AS "+q:"DISTINCT "+Al(a)+".*, "+
z+"."+t+" AS "+q,k.zc=z+" INNER JOIN "+Al(a)+" USING ("+m+")",null!=e&&(lj(z+"."+t,x,e,l,b),0<l.length&&(k.pa=k.pa?k.pa+(" AND "+l.join(" AND ")):l.join(" AND ")))):null!=e&&(lj(t,x,e,l,b),0<l.length&&(k.pa=k.pa?k.pa+(" AND "+l.join(" AND ")):l.join(" AND ")));p&&!n.unique&&g&&(k.group=t);a=f?"DESC":"ASC";k.$b=t+" "+a;p&&(k.$b+=", "+m+" "+a);return k}
function Bl(a,b,c,d,e,f,g,k,l){var m,n,p,q;null!=e?(m=e.lower,n=e.upper,p=e.lowerOpen,q=e.upperOpen,f?null!=n?(e=mj(k,n),-1==e?(n=k,q=l):0==e&&(q=l||q)):(n=k,q=l):null!=m?(e=mj(k,m),1==e?(m=k,p=l):0==e&&(p=l||p)):(m=k,p=l)):f?(n=k,q=l):(m=k,p=l);e=new T(m,n,!!p,!!q);d=d?Hj(a,d):null;b=zl(a,c,b,d?d.j:a.l,e,f,g);b="SELECT "+b.select+" FROM "+b.zc+(b.pa?" WHERE "+b.pa:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.$b;d&&(b+=", "+a.j+(f?"DESC":"ASC"));return b}
function Cl(a,b,c,d,e,f,g,k,l,m){var n=Hj(a,d),p=n.j;d=n.i;var q=a.j,t=l?" <":" >",t=g?t+" ":t+"= ";g=nj(f,n.type);k=nj(k,a.type);n="";e?(a=zl(a,c,b,p,e,l,m),a.pa+=" AND ",n=d+t+"?",c.push(g)):(e=l?T.upperBound(f,!0):T.lowerBound(f,!0),a=zl(a,c,b,p,e,l,m),n=a.pa,a.pa="");a.pa+="("+n+" OR ("+d+" = ? AND "+q+t+"?))";c.push(g);c.push(k);return"SELECT "+a.select+" FROM "+a.zc+" WHERE "+a.pa+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.$b}h.ba=function(){return Fk(this.toJSON())};
h.index=function(a){return this.indexes[a]||null};function Hj(a,b){return Ta(a.indexes,function(a){return a.getName()==b})}function Gj(a,b){for(var c=0;c<a.indexes.length;c++)if(!vl(a.indexes[c].keyPath,b))return a.indexes[c];return null}function Ok(a,b){return b===a.keyPath?!0:Ra(a.indexes,function(a){return a.getName()==b})}function Al(a){return Ia(a.i)}
function Dl(a,b){if(!b)return a;var c=a.h,d=u(a.keyPath)?Za(a.keyPath):a.keyPath,e=a.type,f=Qa(a.indexes,function(a){return a.ba()});s(b.type)||"TEXT"!=e||(e=void 0);u(b.keyPath)&&w(d)&&d==b.keyPath.join(",")&&(d=Za(b.keyPath));for(var g=0,k=b.indexes.length;g<k;g++)if(b.indexes[g].n)for(var l=b.indexes[g].getName(),m=f.length-1;0<=m;m--)if(0<=l.indexOf(f[m].getName())){f[m]=b.indexes[g].ba();break}for(g=0;g<f.length;g++)(k=Hj(b,f[g].getName()))&&(f[g]=f[g].hint(k));return new Ek(b.i,d,c,e,f)}
h.getName=function(){return this.i};function El(a){return!!a.keyPath}function Sk(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.p){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(oj(b,a.keyPath[d]));return c}if(a.keyPath)return lc(b,a.n)}}function $k(a,b,c){for(var d=0;d<a.n.length;d++){var e=a.n[d];if(d==a.n.length-1){b[e]=c;break}s(b[e])||(b[e]={});b=b[e]}}
function Fl(a,b,c){var d=[],e=[];c=s(c)?c:Sk(a,b);s(c)&&(e.push(a.j),d.push(nj(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&g.getName()!==a.keyPath&&"_default_"!=g.getName()){var k=rl(g,b);null!=k&&(d.push(nj(k,g.type)),e.push(g.i))}}a.fc?a.fc&&!a.keyPath&&0==a.indexes.length&&(w(b)&&-1==b.indexOf(";base64,")?d.push(b):d.push(S(b)),e.push("_default_")):(d.push(S(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Af:e,Xf:a,values:d,key:c}}
function Gk(a,b){if(!b)return"missing store: "+a.i;if(a.i!=b.i)return"store name, expect: "+a.i+", but: "+b.i;var c=vl(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(s(a.h)&&s(b.h)&&a.h!=b.h)return"autoIncrement, expect:  "+a.h+", but: "+b.h;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(s(a.type)&&s(b.type)&&(v(a.type)?!cb(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=
Hj(b,a.indexes[c].getName()),e;e=a.indexes[c];if(d)if(e.h!=d.h)e="name, expect: "+e.h+", but: "+d.h;else{var f=vl(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:s(e.type)&&s(d.type)&&(v(e.type)?!cb(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e=
"no index for "+e.h;if(0<e.length)return'index "'+a.indexes[c].getName()+'" '+e}return""}function Pk(a,b){if(b)for(var c=0;c<a.indexes.length;c++){var d=a.indexes[c],e=b;if(d.l){var f=d.l(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||u(f)){for(g=0;g<d.g.length-1;g++)A(e[d.g[g]])||(e[d.g[g]]={});e[d.g[d.g.length-1]]=f}}}}function Gl(a,b){a.o.push(b)}function Mk(a,b,c,d,e){for(var f=0;f<a.o.length;f++)d!==f&&a.o[f].call(e,b,c)}
h.toString=function(){return"Store:"+this.i+"["+this.indexes.length+"index]"};function Hl(a,b,c){if(!a||ta(a))throw new L("store_name must be provided for primary full text index");if(!b||ta(b))throw new L("index_name must be provided for primary full text index");this.M=a;this.g=b;this.h=c||1}Hl.prototype.A=function(){return this.M};function Il(a,b,c,d){this.name=a;this.indexes=b;this.lang=c||"";if(-1==["","en","fr"].indexOf(this.lang))throw new L('Unsupported lang "'+c+" for full text search index "+a);this.h=d||null;this.g=null}Il.prototype.getName=function(){return this.name};Il.prototype.count=function(){return this.indexes.length};Il.prototype.index=function(a){return this.indexes[a]};function Jl(a,b,c){return Ta(a.indexes,function(a){return a.A()==b&&a.g==c})}
function Kl(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Na(b,c))throw new L("Unknown field: "+c+" in "+S(a));if(!u(a.sources))throw new L("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Na(b,c))throw new L("Unknown field: "+c+" in "+ph(a));return new Hl(a.storeName,a.keyPath,a.weight)});return new Il(a.name,
b,a.lang)};function Ll(a,b){var c,d,e=b;if(A(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==Na(c,f))throw new L("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!u(g))throw new L("stores must be array");for(f=0;f<g.length;f++){var k=Fk(g[f]);if(-1!=Ua(e,function(a){return a.name==k.getName()}))throw new L('duplicate store name "'+k.getName()+'".');e.push(k)}}else w(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(s(c)){if(!y(c)||0>c)throw new L("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(s(b)&&(!u(b)||0<b.length&&!(b[0]instanceof Ek)))throw new L("stores");this.version=c;this.h=!s(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=Kl(d.fullTextCatalogs[f]),c[f]=e,Z(this,e.getName())||(g=[new ol("k",ql),new ol("v",ql)],e=new Ek(e.getName(),"id",!1,void 0,g),this.stores.push(e));this.i=c}
Ll.prototype.toJSON=function(){var a=Qa(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;s(this.version)&&(b.version=this.version);return b};Ll.prototype.h=!1;Ll.prototype.g=function(){return!1};function Nk(a){return Qa(a.stores,function(a){return a.getName()})}Ll.prototype.count=function(){return this.stores.length};function Z(a,b){return Ta(a.stores,function(a){return a.getName()==b})}function Lk(a,b){return Ra(a.stores,function(a){return a.getName()==b})}
function Ml(a,b,c,d){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var e=0;e<a.stores.length;e++){var f=Z(b,a.stores[e].getName());if(f){c&&(f=Dl(f,a.stores[e]));if(d)for(var g=f,k=a.stores[e],l=0;l<k.indexes.length;l++){var m=k.indexes[l];Ok(g,m.getName())||"BLOB"!=m.type||(m=new ol(m.keyPath,m.type,m.unique,m.multiEntry,m.getName()),g.indexes.push(m))}f=Gk(a.stores[e],f);if(0<f.length)return'store: "'+a.stores[e].getName()+'" '+f}else return'missing object store "'+
a.stores[e].getName()+'"'}return""}function Nl(a,b){return Ta(a.i,function(a){return a.getName()==b})};function Hk(a,b){Ll.call(this,a,b)}E(Hk,Ll);Hk.prototype.g=function(){return!0};function Ik(a,b){a.stores.push(b)};function Ol(a){return oh(S(a))}function wl(a,b){var c;c=c||{};if(null!=a&&null!=b){if(v(a)&&v(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Ta(b,function(b){return wl(b,a[d])}))return!1;return!0}if(v(a))return 1==a.length&&wl(a[0],b);if(v(b))return 1==b.length&&wl(b[0],a);if(A(a)&&A(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=wl(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=wl(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function Pl(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Ql(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==Na(d,e))throw new L('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!u(c.mechanisms))throw new L("mechanisms attribute must be an array but "+ea(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!Va(Rl,c.mechanisms[e]))throw new L('Invalid mechanism "'+c.mechanisms[e]+'"');}this.I=c.mechanisms||Rl;this.B=c.size;this.N=
s(c.connectionTimeout)?c.connectionTimeout:3E4;this.i=null;this.j=[];this.zd=!1;var f;if(b instanceof Ll)f=b;else if(A(b))for(c.autoSchema||!s(b.stores)?f=new Hk(b):f=new Ll(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=Z(f,b.stores[e].name),b.stores[e].Sync&&this.uf(d,b.stores[e].Sync);else f=new Hk;this.h=f;for(e=0;e<this.h.count();e++)if((this.h.stores[e]||null).C)throw Error("encryption option must be defined");if(s(a)){if(this.i)throw new Pc("Already connected with "+this.p);this.p=a;Jk(this)}this.o=
null;this.n=new G}Ql.prototype.logger=R("ydn.db.con.Storage");function Sl(a,b,c){return(a=Z(a.h,b))?Ok(a,c):!1}function Tl(a){var b;if(s(b)){var c=function(a){b(a.toJSON());b=void 0};a.i?a.i.Xa(c):Ak(a,function(b){a.i.Xa(c,b)},null,Cj)}return a.h?a.h.toJSON():null}Ql.prototype.getName=function(){return this.p};var Rl="indexeddb websql localstorage sessionstorage userdata memory".split(" ");h=Ql.prototype;h.le=function(){return null};
function Jk(a){function b(b,e){b?(Q(a.logger,a+": ready."),a.Qf=NaN,d.Wc=function(b){a.Na(new ml(a,b))},d.Yd=function(b){a.Na(new nl(a,b));a.i=null},d.Gd=function(b){a.Na(b)},setTimeout(function(){Ul(a,e);Vl(a)},10),c.t(e)):(M(a.logger,a+": database connection fail "+e.name),setTimeout(function(){Ul(a,new nl(a,e));if(a.j){a.logger.info("Purging "+a.j.length+" transactions request.");for(var b;b=a.j.shift();)b.Qa&&b.Qa("error",e)}},10),c.u(e))}for(var c=new G,d=null,e=a.I,f=0;f<e.length;f++){var g=
e[f].toLowerCase();if(d=a.le(g)){d=a.le(g);break}}null===d?(e=new yh("No storage mechanism found."),b(!1,new nl(a,e))):(a.init(),d.connect(a.p,a.h).w(function(){this.i=d;b(!0,new ll("ready",this,parseFloat(d.Wd())))},function(a){M(this.logger,this+": opening fail");b(!1,a)},a))}function rk(a){if(a.i)return a.i.uc()}h.Eb=function(a,b){this.n.aa(a,b)};function Ul(a,b){setTimeout(function(){b instanceof ml?a.n.u(b.error):a.n.t();a.Na(b)},4)}function zk(a){return!!a.i&&a.i.Xd()}h.init=function(){};
function Wl(a){a.i&&(a.i.Vd(),a.i=null,Q(a.logger,a+" closed"))}h.Qf=NaN;function Vl(a){var b=a.j.shift();b&&(Q(a.logger,"pop tx queue["+(a.j.length+1)+"]"),Ak(a,b.nd,b.scopes,b.mode,b.Qa));a.Qf=C()}function Xl(a,b,c,d,e){Q(a.logger,"push tx queue["+a.j.length+"]");a.j.push({nd:b,scopes:c,mode:d,Qa:e});100<a.j.length&&0==a.j.length%100&&M(a.logger,"Transaction queue stack size is "+a.j.length+". It is too large, possibility due to incorrect usage.")}h.zd=!1;
function Ak(a,b,c,d,e){var f=c;if(w(c))f=[c];else if(null!=c)if(v(c)){if(0==c.length)throw new L("number of store names must more than 0");for(var g=0;g<c.length;g++)if(!w(c[g]))throw new L("store name at "+g+" must be string but found "+typeof c[g]);}else throw new L("store names must be an array");else f=null;if(a.i&&a.i.Xd()&&!a.zd){var k=s(d)?d:Cj;k==Dj&&(a.zd=!0);a.i.md(function(a){b(a);b=null},f,k,function(b,c){ha(e)&&(e(b,c),e=void 0);k==Dj&&(a.zd=!1);Vl(a)})}else Xl(a,b,f,d,e)}
h.uf=function(a){M(this.logger,"Synchronization option for "+a.getName()+" ignored.")};h.tf=function(a){M(this.logger,"Full text indexer option for "+a.getName()+" ignored.")};h.Na=function(){};h.toString=function(){return"Storage:"+this.i};function Yl(a,b,c,d){this.j=a;this.l=b;this.g=Za(c);this.h=d;this.i=[]}Yl.prototype.j=null;Yl.prototype.onCompleted=function(a,b){for(var c=0;c<this.i.length;c++)this.i[c](a,b);this.i.length=0;this.i=this.g=this.j=null};function Zl(a,b,c){if(a.j)c&&a.i.push(c),b(a.j);else throw new Qc("tx committed on ParallelTxExecutor");}Yl.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.l+" mode:"+this.h+" scopes:"+S(this.g)};function $l(a,b,c,d,e,f){ok.call(this,a,b,c,d,e,f);this.j=this.h=null}E($l,ok);h=$l.prototype;h.logger=R("ydn.db.tr.Parallel");h.abort=function(){P(this.logger,this+": aborting");sk(this.j)};
h.dg=function(a,b){var c;if("multi"==this.l)a:if(c=this.h,!c.g||!c.h||b!=c.h&&(c.h!=U||b!=Cj)||a.length>c.g.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.l)a:if(c=this.h,c.g&&c.h&&b==c.h&&c.g.length==a.length){for(d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.l?!0:!1;return c};
h.Hb=function(a,b,c,d){function e(c){l.i++;m=new Yl(c,l.i,b,k);g=l.Ga();O(l.logger,g+" BEGIN "+S(b)+" "+k);l.h=m;Zl(l.h,a,d)}function f(a,b){O(l.logger,g+" "+a);if(m)m.onCompleted(a,b);l.g=0}var g;this.X&&(b=this.X);this.S&&(c=this.S);var k=s(c)?c:Cj,l=this,m;if(this.h&&this.h.j&&this.dg(b,k))Zl(this.h,a,d);else{if(this.I&&this.i>=this.I)throw new Pc("Exceed maximum number of transactions of "+this.I);Ak(this.H(),e,b,k,f)}};
h.request=function(a,b,c,d){var e=$l.m.request.call(this,a,b,c,d),f=this;this.Hb(function(a){f.g++;Uj(e,a,f.Ga()+"R"+f.g)},b,c||Cj,d);return e};h.gc=function(a,b,c,d,e){var f=this,g;this.Hb(function(c){f.g++;g=f.Ga()+"R"+f.g;P(f.logger,g+" BEGIN");b(c,g,function(b,d){f.j=c;g=f.Ga()+"R"+f.g;d?(P(f.logger,g+" ERROR"),a.u(b)):(P(f.logger,g+" SUCCESS"),a.t(b));f.j=null});b=null;P(f.logger,g+" END")},c,d,e)};h.toString=function(){return"Parallel:"+this.l+":"+this.Ga()+(this.j?"*":"")};function am(a,b){$l.call(this,a,b,pk)}E(am,$l);h=am.prototype;h.logger=R("ydn.db.tr.AtomicParallel");h.dg=function(){return!1};h.request=function(a,b,c){var d,e,f,g=this,k=am.m.request.call(this,a,b,c,function(a,b){k.g=null;P(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new jk;V(k,c,!0)}});Xj(k,function(a,b,c){f=b;e=a;d=c});return k};
h.gc=function(a,b,c,d,e){var f,g,k=new G;k.w(function(a){g=!1;f=a},function(a){g=!0;f=a});am.m.gc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.u(c);else if(!0===g)a.u(f);else if(!1===g)a.t(f);else{var d=new jk;a.u(d)}e&&(e(b,c),e=void 0)})};h.toString=function(){return"Atomic"+am.m.toString.call(this)};function bm(a,b,c){Ql.call(this,a,b,c);this.l=0;a=!0;b=pk;c&&(s(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=cm(this,b,a);this.Sa=cm(this,"atomic",!1);this.g=this.Lc(c,this.Sa)}E(bm,Ql);bm.prototype.l=0;bm.prototype.Lc=function(a,b){return new Ck(this,this.h,a,b)};
function cm(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==pk)return new vk(a,a.l++,b,d,e,f);if("atomic"==b)return new Bk(a,a.l++);throw new L('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==pk)return new $l(a,a.l++,b,d,e,f);if("atomic"==b)return new am(a,a.l++);throw new L('Invalid requestType "'+b+'"');}
bm.prototype.S=function(a,b,c){if(3<arguments.length)throw new L("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.l++;var d=b||Nk(this.h),e=Cj;if(c)if("readwrite"==c)e=U;else if("readonly"!=c)throw new L('Invalid transaction mode "'+c+'"');var f=cm(this,"all",!1,d,e,1),g=this.Lc(f,this.Sa),k=new Tj("run"),l=this;f.Hb(function(b){Q(l.logger,"executing run in transaction on "+f);Uj(k,b,f.Ga()+"R0");a(g)},d,e,function(a){k.g=null;V(k,f.i,"complete"!==
a)});return k};function dm(a,b,c){bm.call(this,a,b,c);a=this.h;for(b=0;b<a.i.length;b++){c=a.i[b];var d=Z(a,c.getName());if(d){if(!Ok(d,"k"))throw new L('full text index store "'+d.getName()+'" must have "keyword" index');if(!Ok(d,"v"))throw new L('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new L('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new L('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=Z(a,e.A());if(f)this.tf(f,c);else throw new L('full text source store "'+e.A()+'" does not exist for full text index "'+c.getName()+'"');}}}E(dm,bm);h=dm.prototype;h.init=function(){dm.m.init.call(this)};h.Lc=function(a,b){return new Kk(this,this.h,a,b)};h.add=function(a,b,c){return this.g.add(a,b,c)};h.count=function(a,b,c,d){return this.g.count(a,b,c,d)};h.get=function(a,b){return this.g.get(a,b)};h.keys=function(a,b,c,d,e,f,g){return this.g.keys(a,b,c,d,e,f,g)};
h.values=function(a,b,c,d,e,f){return this.g.values(a,b,c,d,e,f)};h.list=function(a,b,c,d,e,f,g,k,l){return this.g.list(a,b,c,d,e,f,g,k,l)};h.load=function(a,b,c){return this.g.load(a,b,c)};h.put=function(a,b,c){return this.g.put(a,b,c)};h.clear=function(a,b,c){return this.g.clear(a,b,c)};h.remove=function(a,b,c){return this.g.remove(a,b,c)};h.toString=function(){var a="Storage:"+this.getName();zk(this)&&(a+=" ["+rk(this)+"]");return a};function em(a,b,c){dm.call(this,a,b,c)}E(em,dm);em.prototype.Lc=function(a,b){return new il(this,this.h,a,b)};em.prototype.map=function(a,b){return this.g.map(a,b)};function fm(a,b,c,d){Fj.call(this,a,b,c,d);this.l=null}E(fm,Fj);h=fm.prototype;h.logger=R("ydn.db.core.req.IDBCursor");h.Cf=function(a){(a=a.target.result)?this.Zb(a.key,a.primaryKey,a.value):this.Zb()};
h.openCursor=function(a,b){function c(a,b,c){p.l=n;p.l.onsuccess=B(p.Cf,p);p.Zb(a,p.j?b:void 0,c);n=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");Q(this.logger,d);var e=this.Z,d=this.n.objectStore(this.M),f=w(this.ob)?d.index(this.ob):null;if(s(a))var g=f?!s(b):!0,k=e?e.lower:void 0,l=e?e.upper:void 0,m=e?!!e.lowerOpen:!1,e=e?!!e.upperOpen:!1,e=ej(this.reverse?new T(k,a,m,g):new T(a,l,g,e));var n;this.Jc?f?n=null!=this.tb?f.openKeyCursor(e,this.tb):null!=e?f.openKeyCursor(e):
f.openKeyCursor():n=null!=this.tb?d.openCursor(e,this.tb):null!=e?d.openCursor(e):d.openCursor():f?n=null!=this.tb?f.openCursor(e,this.tb):null!=e?f.openCursor(e):f.openCursor():n=null!=this.tb?d.openCursor(e,this.tb):null!=e?d.openCursor(e):d.openCursor();var p=this;n.onerror=function(a){var b=n.error;a.preventDefault();p.S(b);Ij(p);p.B=!0};null!=a?n.onsuccess=function(d){if(d=d.target.result){var e=Ej.cmp(d.key,a),f=p.reverse?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);
else if(null!=b)if(Ej.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(p.l=n,p.l.onsuccess=B(p.Cf,p))};h.yd=function(){return!!this.l};h.update=function(a){var b=this.l.result;if(b){var c=new G;a=b.update(a);a.onsuccess=function(a){c.t(a.target.result)};a.onerror=function(a){a.preventDefault();c.u(a)};return c}throw new ek("cursor gone");};
h.clear=function(){var a=this.l.result;if(a){var b=new G,a=a["delete"]();a.onsuccess=function(){b.t(1)};a.onerror=function(a){a.preventDefault();b.u(a)};return b}throw new ek("cursor gone");};h.advance=function(a){var b=this.l.result;if(1==a)b["continue"]();else b.advance(a)};h.hd=function(a){var b=this.l.result;if(null!=a)b["continue"](a);else b["continue"]()};h.J=function(){fm.m.J.call(this);this.l=null};h.toString=function(){return"IDB"+fm.m.toString.call(this)};function gm(a,b,c,d,e,f){G.call(this,e,f);this.j=a;this.g=[];this.o=!!b;this.S=!!c;this.N=!!d;for(b=this.B=0;b<a.length;b++)a[b].w(B(this.p,this,b,!0),B(this.p,this,b,!1));0!=a.length||this.o||this.t(this.g)}E(gm,G);gm.prototype.p=function(a,b,c){this.B++;this.g[a]=[b,c];this.gb||(this.o&&b?this.t([a,c]):this.S&&!b?this.u(c):this.B==this.j.length&&this.t(this.g));this.N&&!b&&(c=null);return c};gm.prototype.u=function(a){gm.m.u.call(this,a);for(a=0;a<this.j.length;a++)ib(this.j[a])};function hm(a,b){this.g=b}E(hm,nk);h=hm.prototype;h.logger=R("ydn.db.crud.req.IndexedDb");h.kd=function(a,b){function c(e){var f=a.g.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?V(a,d):c(e)};f.onerror=function(b){b.preventDefault();V(a,f.error,!0)}}var d=[];0==b.length?V(a,[]):c(0)};
h.$a=function(a,b,c,d,e,f){function g(t){if(null==e[t])if(Q(n.logger,"empty object at "+t+" of "+e.length),l++,l==e.length)V(a,k,m);else{var z=t+10;z<e.length&&g(z)}var D,z=e[t];D=null!=f?b?q.put(z,f[t]):q.add(z,f[t]):b?q.put(z):q.add(z);D.onsuccess=function(b){l++;k[t]=b.target.result;l==e.length?V(a,c?k[0]:k,m):(b=t+10,b<e.length&&g(b))};D.onerror=function(b){l++;var f=D.error;Q(n.logger,X(a)+p+' request to "'+d+'" cause '+f.name+' for object "'+ph(e[t])+'" at index '+t+" of "+e.length+" objects.");
k[t]=f;m=!0;b.preventDefault();l==e.length?V(a,c?k[0]:k,m):(b=t+10,b<e.length&&g(b))}}var k=[],l=0,m=!1,n=this,p=b?"put":"add",q=a.g.objectStore(d);Q(this.logger,X(a)+" "+p+" "+e.length+' objects to store "'+d+'"');if(0<e.length)for(var t=0;10>t&&t<e.length;t++)g(t);else V(a,[])};
h.Jd=function(a,b,c){function d(l){var n=c[l],p=n.A(),q=a.g.objectStore(p),t;t=null===q.keyPath?q.put(b[l],n.F()):q.put(b[l]);t.onsuccess=function(c){f++;e[l]=c.target.result;f==b.length?V(a,e,g):(c=l+10,c<b.length&&d(c))};t.onerror=function(c){f++;M(k.logger,"request result "+c.name+' error when put keys to "'+p+'" for object "'+ph(b[l])+'" at index '+l+" of "+b.length+" objects.");e[l]=t.error;g=!0;c.preventDefault();f==b.length?V(a,e,g):(c=l+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,k=this;Q(this.logger,
X(a)+" putByKeys: of "+b.length+" objects");if(0<b.length)for(var l=0;10>l&&l<b.length;l++)d(l);else V(a,e,g)};
h.Ye=function(a,b,c,d,e,f){function g(){var a={},b=e.indexOf("\n",n),d=!1,t;-1==b?(d=!0,t=e.substring(n)):(t=e.substring(n,b),n=b+1);for(var b=t.split(f),J=0;J<p.length;J++){var N=b[J];q[J]&&(q[J]==ql?N=Fa(N,'"'):"INTEGER"==q[J]?N=parseInt(N,10):"NUMERIC"==q[J]&&(N=parseFloat(N)));a[p[J]]=N}var fa=l.put(a);fa.onsuccess=function(a){m.push(a.target.result);d?c(m):g()};fa.onerror=function(a){"DataError"==a.name&&(a=new bk(k+": "+t.substring(0,70)));a.preventDefault();c(fa.error,!0)}}var k=Z(this.g,d),
l=a.objectStore(d),m=[],n=e.indexOf("\n"),p=e.substr(0,n).split(f),q=[];for(a=0;a<p.length;a++){var t=Hj(k,p[a]);t?q[a]=t.type:p[a]==k.keyPath&&(q[a]=k.type)}n++;Q(this.logger,b+" Loading data  of "+p.length+"-fields record to "+d);g()};
h.Ld=function(a,b,c){var d=a.g.objectStore(b);Q(this.logger,X(a)+" clearById: "+b+" "+c);var e=d.openCursor(ij.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){V(a,1)};c.onerror=function(){V(a,c.error,!0)}}else V(a,0)};e.onerror=function(b){b.preventDefault();V(a,e.error,!0)}};
h.Md=function(a,b){function c(k){k++;if(k>=b.length)0<g.length?V(a,g,!0):V(a,d);else{b[k].A()!=e&&(e=b[k].A(),f=a.g.objectStore(e));var l=f["delete"](b[k].F());l.onsuccess=function(){d++;c(k)};l.onerror=function(a){a.preventDefault();g[k]=l.error;c(k)}}}var d=0,e,f;Q(this.logger,X(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
h.Pc=function(a,b,c){var d=a.g.objectStore(b),e=d.count(c);Q(this.logger,X(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,k=d["delete"](c);k.onsuccess=function(){V(a,e)};k.onerror=function(){V(a,k.error,!0)}};e.onerror=function(b){b.preventDefault();V(a,e.error,!0)}};h.ie=function(a,b,c){var d=a.g.objectStore(b);Q(this.logger,X(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){V(a,void 0)};e.onerror=function(b){b.preventDefault();V(a,e.error,!0)}};
h.Ze=function(a,b,c,d){var e=a.g.objectStore(b).index(c);Q(this.logger,X(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),k=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){k++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?V(a,f,!0):V(a,k)};g.onerror=function(b){b.preventDefault();V(a,g.error,!0)}};
h.fd=function(a,b){var c=b.length,d=0;Q(this.logger,X(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.g.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&V(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&V(a,f.error,!0)}}};
h.od=function(a,b,c){var d=this;Q(this.logger,X(a)+b+":"+c);var e=a.g.objectStore(b),f=e.get(c);f.onsuccess=function(b){Q(d.logger,X(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");var f=b.target.result;if(!e.keyPath&&0==e.indexNames.length&&Hb&&w(f)&&0<=f.indexOf(";base64,")){'"'==f.charAt(0)&&'"'==f.charAt(f.length-1)&&(f=f.substr(1,f.length-2));f=f.split(";base64,");b=f[0].split(":")[1];for(var f=window.atob(f[1]),l=f.length,m=new Uint8Array(l),n=0;n<l;++n)m[n]=f.charCodeAt(n);
V(a,new Blob([m.buffer],{type:b}))}else V(a,b.target.result)};f.onerror=function(b){b.preventDefault();V(a,f.error,!0)}};
h.Se=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==k)V(a,e);else{var m=b+10;m<k&&d(m)}var n;n=g.get(c[b]);n.onsuccess=function(c){f++;e[b]=c.target.result;f==k?V(a,e):(c=b+10,c<k&&d(c))};n.onerror=function(b){f++;b.preventDefault();V(a,n.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.g.objectStore(b),k=c.length;Q(this.logger,X(a)+" "+b+":"+k+" ids");if(0<k)for(b=0;10>b&&b<k;b++)d(b);else V(a,[])};
h.Dd=function(a,b){function c(f){var k=b[f],l=a.g.objectStore(k.A()).get(k.F());l.onsuccess=function(k){e++;d[f]=k.target.result;e==b.length?V(a,d):(k=f+10,k<b.length&&c(k))};l.onerror=function(b){e++;b.preventDefault();V(a,l.error,!0)}}var d=[];d.length=b.length;var e=0;Q(this.logger,X(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else V(a,[])};
h.yc=function(a,b,c,d,e){if(d&&e)throw new Pc("unique count not available in IndexedDB");e=a.g.objectStore(b);b=X(a)+" "+b+(d?":"+d:"")+(c?":"+S(c):"");Q(this.logger,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){V(a,b.target.result)};f.onerror=function(b){b.preventDefault();V(a,f.error,!0)}};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=[],p=a.g.objectStore(c),q=k?l?"prevunique":"prev":l?"nextunique":"next";c=X(a)+" "+b+" "+c+(d?":"+d:"")+(e?S(e):"");k&&(c+=" reverse");l&&(c+=" unique");if(m&&s(m[0])){l=d?!s(m[1]):!0;var t=m[0],x=e?e.lower:void 0,z=e?e.upper:void 0,D=e?!!e.lowerOpen:!1;e=e?!!e.upperOpen:!1;e=ej(k?new T(x,t,D,l):new T(t,z,l,e));c+=" starting from "+S(m[0]);s(m[1])&&(c+=", "+S(m[1]))}Q(this.logger,c);var F;F=1==b||2==b||3==b?d?p.index(d).openKeyCursor(e,q):p.openCursor(e,
q):d?p.index(d).openCursor(e,q):p.openCursor(e,q);var J=!1;F.onsuccess=function(c){if(c=c.target.result){if(!J){if(0<g){J=!0;c.advance(g);return}if(m&&d&&s(m[0]))if(s(m[1])){var e=Ej.cmp(c.key,m[0]),l=k?-1:1;if(0==e){e=Ej.cmp(c.primaryKey,m[1]);if(0==e){J=!0;c["continue"]();return}if(e==l)J=!0;else{c["continue"]();return}}else J=!0}else J=!0;else J=!0}1==b?n.push(c.key):2==b?n.push(c.primaryKey):3==b?(l={},d&&(l[d]=c.key),p.keyPath?l[p.keyPath]=c.primaryKey:l._ROWID_=c.primaryKey,n.push(l)):4==b?
n.push(c.value):n.push([c.key,c.primaryKey,c.value]);if(n.length<f)c["continue"]();else m&&(m[0]=Jj(c.key),m[1]=Jj(c.primaryKey)),V(a,n)}else m&&(m[0]=void 0,m[1]=void 0),V(a,n)};F.onerror=function(b){b.preventDefault();V(a,F.error,!0)}};function im(a,b){this.g=b}E(im,hm);im.prototype.logger=R("ydn.db.core.req.IndexedDb");im.prototype.h=function(a,b,c,d){c=Z(this.g,c);return new fm(a,b,c,d)};function jm(){this.g=!1}jm.prototype.g=!1;function km(a,b,c,d){Fj.call(this,a,b,c,d);this.o=this.h=this.g=void 0;this.p=this.l=null;this.I=new jm;this.Qd=this.za=null}E(km,Fj);h=km.prototype;h.logger=R("ydn.db.core.req.SimpleCursor");h.yd=function(){return!!this.n};h.update=function(a){lm(this.Qd,this.da(),a);return pb()};h.advance=function(a){function b(b){d++;if(!b||d>=a)return mm(c,b)}var c=this,d=this.l?-1:0;this.reverse?nm(this.za,b,this.l):om(this.za,b,this.l)};
h.hd=function(a){if(null!=a){var b=this,c=new pm(a),d=function(c){b.l=c;if(!c)return mm(b,c);var d=mj(c.value.key,a);if(b.reverse){if(1!=d)return mm(b,c)}else if(-1!=d)return mm(b,c)};this.reverse?nm(this.za,d,c):om(this.za,d,c)}else this.advance(1)};function qm(a){setTimeout(function(){a.I.g?(a.I.g=!1,a.Zb(a.g,a.h,a.o),qm(a)):(a.p(),a.p=null)},4)}
function mm(a,b){if(a.l=b){var c=b.value;if(a.Z)if(a.reverse||null==a.Z.upper)a.reverse&&null!=a.Z.lower&&(d=mj(c.key,a.Z.lower),-1==d||0==d&&a.Z.lowerOpen)&&(a.l=null);else{var d=mj(c.key,a.Z.upper);if(1==d||0==d&&a.Z.upperOpen)a.l=null}if(a.l){if(a.unique&&null!=a.g&&null!=c.key&&0==mj(a.g,c.key))return;a.g=c.key;a.h=a.j?c.da():a.g;4==a.ja&&(a.Jc?a.o=a.h:a.o=a.Qd.sa(null,a.h))}}a.l||(a.g=void 0,a.h=void 0,a.o=void 0);return a.I.g=!0}
h.openCursor=function(a,b){var c=null;if(this.Z)if(this.reverse){var d=this.j?"\uffff":void 0;null!=this.Z.upper&&(c=new pm(this.Z.upper,d))}else null!=this.Z.lower&&(c=new pm(this.Z.lower));null!=a&&(c=this.j?new pm(a,b):new pm(a));this.p=this.n.H(function(b){function d(b){var e=b.value,f=e.key;if(b&&null!=f)if(null!=a){if(0==rm(c,e))return}else if(this.Z&&(!this.reverse&&this.Z.lowerOpen&&null!=this.Z.lower&&(e=mj(f,this.Z.lower),0==e)||this.reverse&&this.Z.upperOpen&&null!=this.Z.upper&&(e=mj(f,
this.Z.upper),0==e)))return;return mm(this,b)}this.Qd=sm(b,this.M);this.za=tm(this.Qd,this.ob);this.reverse?nm(this.za,B(d,this),c):om(this.za,B(d,this),c);qm(this)},this)};h.clear=function(){throw new Oc;};h.toString=function(){return"Simple"+km.m.toString.call(this)};function um(a,b,c){a=["ydn.db",a];s(b)&&(a.push(b),s(c)&&(a.push(c),s(void 0)&&a.push(rj(void 0))));return a.join("^|")};function pm(a,b){this.key=a;this.g=b}pm.prototype.da=function(){return this.g};pm.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.g?", "+this.g+")":")")};function rm(a,b){var c=mj(a.key,b.key);return 0===c?null!=a.g?null!=b.g?mj(a.g,b.g):1:null!=b.g?-1:0:c};function vm(a){this.Ma=a||wm}function wm(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}h=vm.prototype;h.xa=null;h.Ma=null;h.rb=null;h.pb=null;
h.add=function(a){if(null==this.xa)return this.pb=this.rb=this.xa=new xm(a),!0;var b=null;ym(this,function(c){var d=null;0<this.Ma(c.value,a)?(d=c.left,null==c.left&&(b=new xm(a,c),c.left=b,c==this.rb&&(this.rb=b))):0>this.Ma(c.value,a)&&(d=c.right,null==c.right&&(b=new xm(a,c),c.right=b,c==this.pb&&(this.pb=b)));return d});b&&(ym(this,function(a){a.count++;return a.parent},b.parent),zm(this,b.parent));return!!b};
h.remove=function(a){var b=null;ym(this,function(c){var d=null;0<this.Ma(c.value,a)?d=c.left:0>this.Ma(c.value,a)?d=c.right:(b=c.value,Am(this,c));return d});return b};h.clear=function(){this.pb=this.rb=this.xa=null};h.contains=function(a){var b=!1;ym(this,function(c){var d=null;0<this.Ma(c.value,a)?d=c.left:0>this.Ma(c.value,a)?d=c.right:b=!0;return d});return b};h.ca=function(){return this.xa?this.xa.count:0};h.ta=function(){var a=[];Bm(this,function(b){a.push(b)});return a};
function Bm(a,b){if(a.xa){var c,d=c=Cm(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function ym(a,b,c){for(c=c?c:a.xa;c&&null!=c;)c=b.call(a,c)}
function zm(a,b){ym(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Dm(this,a.left),Em(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Em(this,a.right),Dm(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Dm(a,b){Fm(b)?(b.parent.left=b.right,b.right.parent=b.parent):Gm(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.xa=b.right,a.xa.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Em(a,b){Fm(b)?(b.parent.left=b.left,b.left.parent=b.parent):Gm(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.xa=b.left,a.xa.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Am(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Hm(a,b.left);ym(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.pb&&(a.pb=d)}else{d=Cm(a,b.right);ym(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.rb&&(a.rb=d)}d.count=b.count;Fm(b)?b.parent.left=d:Gm(b)?b.parent.right=d:a.xa=d;zm(a,c?c:d)}else ym(a,function(a){a.count--;return a.parent},b.parent),Fm(b)?(b.parent.left=null,b==a.rb&&(a.rb=b.parent),zm(a,b.parent)):Gm(b)?(b.parent.right=null,b==a.pb&&(a.pb=b.parent),zm(a,b.parent)):a.clear()}function Cm(a,b){if(!b)return a.rb;var c=b;ym(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Hm(a,b){if(!b)return a.pb;var c=b;ym(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function xm(a,b){this.value=a;this.parent=b?b:null;this.count=1}xm.prototype.left=null;xm.prototype.right=null;xm.prototype.height=1;function Gm(a){return!!a.parent&&a.parent.right==a}function Fm(a){return!!a.parent&&a.parent.left==a};function Im(a){this.Ma=a||wm}E(Im,vm);function om(a,b,c){if(a.xa){var d;if(c instanceof xm)d=c;else if(c){if(ym(a,function(a){var b=null;0<this.Ma(a.value,c)?(b=a.left,d=a):0>this.Ma(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Cm(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function nm(a,b,c){if(a.xa){var d;if(c instanceof xm)d=c;else if(c){if(ym(a,B(function(a){var b=null;0<this.Ma(a.value,c)?b=a.left:(0>this.Ma(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Hm(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Jm(a,b,c){this.l=a;this.storage=b;this.h=c;this.g={};a=this.h.keyPath;this.i=u(a)?a.join(","):a||"_ROWID_";this.g[this.i]=null;this.j=um(this.l,this.h.getName(),this.i)+"^|"}
function tm(a,b){var c=b||a.i;if(!a.g[c]){a.g[c]=new Im(rm);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&ra(f,a.j)){var g=uj(f.substr(a.j.length));if(c==a.i)a.g[c].add(new pm(g));else{var k=a.storage.getItem(f);if(null!==k)if(f=Hj(a.h,c),k=oh(k),k=rl(f,k),f.multiEntry){if(u(k))for(f=0;f<k.length;f++)a.g[c].add(new pm(k[f],g))}else a.g[c].add(new pm(k,g))}}}}return a.g[c]}
function Km(a,b,c){for(var d in a.g){var e=a.g[d];if(e)if(d==a.i)e.remove(new pm(b));else{var f=Hj(a.h,d),f=oj(c,f.keyPath);e.remove(new pm(b,f))}}}function Lm(a){for(var b in a.g){var c=a.g[b];c&&c.clear()}a.g={}}
function lm(a,b,c,d){if(null==b&&(a.h.keyPath&&(b=Sk(a.h,c)),a.h.h&&null==b)){b=a.j+rj(void 0);var e=oh(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,S(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.j+rj(b)));if(d)return null;a.storage.setItem(a.j+rj(b),S(c));d=b;for(var f in a.g)if(e=a.g[f])if(f==a.i)e.add(new pm(d));else{var g=Hj(a.h,f),g=oj(c,g.keyPath);null!=g&&e.add(new pm(d,g))}return b}
function Mm(a,b){var c=a.j+rj(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=oh(d);Km(a,b,c);return 1}h=Jm.prototype;h.clear=function(){Lm(this);Nm(this)};h.sa=function(a,b){if(a&&a!=this.i)throw"impl";var c=this.storage.getItem(this.j+rj(b)),d=void 0;if(null!==c)for(var d=oh(c),c=0,e=this.h.indexes.length;c<e;c++){var f=this.h.index(c);if("DATE"==f.type){var g=rl(f,d);g&&sl(f,d,new Date(g))}}return d};h.getName=function(){return this.h.getName()};
function Om(a,b,c){b=b||a.i;a=tm(a,b);var d=null,e=null,f=0,g=!1,k=!1;null!=c&&(null!=c.lower&&(d=new pm(c.lower)),null!=c.upper&&(e=new pm(c.upper)),g=c.lowerOpen,k=c.upperOpen);om(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=mj(a.key,d.key))){if(null!=e&&(a=mj(a.key,e.key),1===a||0===a&&k))return!0;f++}},d);return f}
function Nm(a,b){var c=tm(a,a.i),d=null,e=null,f=0,g=[],k=[],l=!1,m=!1;null!=b&&(null!=b.lower&&(d=new pm(b.lower)),null!=b.upper&&(e=new pm(b.upper)),l=b.lowerOpen,m=b.upperOpen);om(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=rm(b,d))){if(null!=e){var c=rm(b,e);if(1===c||0===c&&m)return!0}var c=a.j+rj(b.key),q=a.storage.getItem(c);null!==q&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),k.push(oh(q))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Km(a,g[c],k[c]);else Lm(a);return f}
h.pd=function(a,b,c,d,e,f,g,k){function l(b){if(b&&(z++,!(z<f))){var c=b.value;if(d){if(F&&null!=x&&(b=p?rm(c,x):mj(c.key,x.key),0==b))return;if(null!=t&&(b=p?rm(c,t):mj(c.key,t.key),-1==b||0==b&&D))return k&&(k[0]=void 0,k[1]=void 0),!0}else{if(D&&null!=t&&(b=p?rm(c,t):mj(c.key,t.key),0==b))return;if(null!=x&&(b=p?rm(c,x):mj(c.key,x.key),1==b||0==b&&F))return k&&(k[0]=void 0,k[1]=void 0),!0}b=c.key;if(!g||!q||null==n||0!=mj(n,b)){c=q?c.da():b;if(2==a)m.push(c);else if(1==a)m.push(b);else if(3==a)m.push([b,
c]);else if(4==a){var l=N.sa(null,c);m.push(l)}else m.push([b,c,N.sa(null,c)]);k&&(k[0]=b,k[1]=c)}n=b;if(s(e)&&m.length>=e)return!0}}var m=[],n,p=!!k&&null!=k[0];b=b||this.i;var q=b!=this.i;b=tm(this,b);var t=null,x=null;s(f)||(f=0);var z=-1,D=!1,F=!1;null!=c&&(null!=c.lower&&(t=q&&d?new pm(c.lower,"\uffff"):new pm(c.lower)),null!=c.upper&&(x=q&&!d?new pm(c.upper,"\uffff"):new pm(c.upper)),D=!!c.lowerOpen,F=!!c.upperOpen);if(p){d?F=!0:D=!0;c=k[0];var J=s(k[1])?k[1]:"\uffff";d?x=q?new pm(c,J):new pm(c):
t=q?new pm(c,J):new pm(c)}var N=this;d?nm(b,l,x):om(b,l,t);return m};h.Ha=function(a,b,c,d,e){return this.pd(2,a,b,c,d,e)};h.toString=function(){return"ydn.db.con.simple.Store:"+this.l+":"+this.h.getName()};function Pm(){this.clear()}h=Pm.prototype;h.ke=function(){return this};h.setItem=function(a,b){s(this.g[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.g[a]=b};h.getItem=function(a){return s(this.g[a])?this.g[a]:null};h.removeItem=function(a){delete this.g[a];Xa(this.keys,a.toString());this.length=this.keys.length};h.length=0;h.key=function(a){a=this.keys[a];return s(a)?this.g[a]:null};h.clear=function(){this.g={};this.keys=[];this.length=0};function Qm(a){this.n=a||new Pm;this.l={}}function sm(a,b){var c=Z(a.g,b);if(c)a.l[b]||(a.l[b]=new Jm(a.i,a.j,c));else throw new Qc('store name "'+b+'" not found.');return a.l[b]}Qm.prototype.Xa=function(a){var b=this;setTimeout(function(){var c=um(b.i),c=b.j.getItem(c),c=new Ll(c);a(c)},10)};function Rm(a,b){this.h=a;this.g=b}Rm.prototype.H=function(a,b){var c=this.h;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.g("complete",null);d.g=null;d.h=null}};function Sm(a,b){this.g=b}E(Sm,nk);h=Sm.prototype;h.logger=R("ydn.db.crud.req.SimpleStore");h.Jd=function(a,b,c){this.$a(a,!0,!1,null,b,c)};
h.$a=function(a,b,c,d,e,f){Q(this.logger,X(a)+" "+(b?"put":"add")+"Object"+(c?"":"s "+e.length+" objects"));var g=a.g.H(function(k){var l;if(c)l=sm(k,d),k=f?f[0]:void 0,k=lm(l,k,e[0],!b),null!=k?V(a,k):(l=ph(k),l=new ak(l),V(a,l,!0));else{for(var m=d,n=[],p=!1,q=f||{},t=0;t<e.length;t++){var x;d?x=q[t]:(m=f[t],x=m.F(),m=m.A());l&&l.getName()==m||(l=sm(k,m));x=lm(l,x,e[t],!b);null!=x?n.push(x):(p=!0,n.push(new ak))}V(a,n,p)}g();g=null},this)};h.Ye=function(){throw new Oc("putData");};
h.od=function(a,b,c){var d=a.g.H(function(e){e=sm(e,b).sa(null,c);V(a,e);d();d=null},this)};function Tm(a,b,c,d){var e=b.g.H(function(a){for(var g=[],k=c,l,m=0;m<d.length;m++){var n=d[m];n instanceof kk&&(k=n,n=k.F(),k=k.A());l&&l.getName()==k||(l=sm(a,k));n=l.sa(null,n);g[m]=n}V(b,g,!1);e();e=null},a)}h.Se=function(a,b,c){Tm(this,a,b,c)};h.Dd=function(a,b){Tm(this,a,null,b)};
h.Ld=function(a,b,c){var d=X(a)+" removeById "+b+" "+c;Q(this.logger,d);var e=this,f=a.g.H(function(g){g=Mm(sm(g,b),c);P(e.logger,"success "+d+(0==g?" [not found]":""));V(a,g);f();f=null},this)};h.Md=function(a,b){Q(this.logger,X(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=a.g.H(function(f){for(var g=0;g<b.length;g++){var k=b[g].A(),l=b[g].F();c&&c.getName()==k||(c=sm(f,k));d+=Mm(c,l)}V(a,d);e();e=null},this)};h.ie=function(a,b,c){this.Pc(a,b,c)};
h.Pc=function(a,b,c){var d=X(a)+" removeByKeyRange "+(c?S(c):"");Q(this.logger,d);var e=this,f=a.g.H(function(g){g=Nm(sm(g,b),c);P(e.logger,d+" deleted "+g+" records.");V(a,g);f();f=null},this)};h.Ze=function(a,b,c,d){var e=X(a)+" removeByIndexKeyRange "+(d?S(d):"");Q(this.logger,e);var f=a.g.H(function(e){e=sm(e,b);for(var k=e.Ha(c,d),l=k.length,m=0;m<l;m++)Mm(e,k[m]);V(a,l);f();f=null},this)};
h.fd=function(a,b){var c=X(a)+" clearByStores";Q(this.logger,c);var d=a.g.H(function(e){for(var f=0;f<b.length;f++)sm(e,b[f]).clear();P(this.logger,"success "+c);V(a,b.length);d();d=null},this)};h.kd=function(a,b){var c=a.g.H(function(d){for(var e=[],f=0;f<b.length;f++){var g=sm(d,b[f]);e.push(Om(g))}V(a,e);c();c=null},this)};
h.yc=function(a,b,c,d){var e=X(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");Q(this.logger,e);var f=a.g.H(function(g){g=Om(sm(g,b),d,c);P(this.logger,"success "+e);V(a,g);f();f=null},this)};h.list=function(a,b,c,d,e,f,g,k,l,m){var n=X(a)+" "+c+" "+(e?ph(e):"");Q(this.logger,n);var p=a.g.H(function(q){q=sm(q,c).pd(b,d,e,k,f,g,l,m);P(this.logger,n+" "+q.length+" records found.");V(a,q);p();p=null},this)};function Um(a,b){this.g=b}E(Um,Sm);Um.prototype.h=function(a,b,c,d){c=Z(this.g,c);return new km(a,b,c,d)};function Vm(a,b,c,d){Fj.call(this,a,b,c,d);this.I=null;this.p=this.l=void 0}E(Vm,Fj);h=Vm.prototype;h.logger=R("ydn.db.core.req.WebsqlCursor");h.da=function(){return this.p};h.init=function(a,b,c,d,e){Vm.m.init.call(this,a,b,c,d,e);this.I=w(b)?Hj(this.i,b):null};h.Q=function(){return this.X};function Wm(a,b){a.l=void 0;a.p=void 0;a.X=void 0;if(s(b))if(A(b)){var c=tl(b[a.i.l],a.i.type);a.p=c;if(a.j){var d=Hj(a.i,a.ob);a.l=tl(b[a.ob],d.type)}else a.l=c;a.X=a.Jc?c:Xm(b,a.i)}else a.X=b}
function Ym(a,b,c,d,e,f){var g=!d;d=[];a.j&&null!=f&&null!=c?c=Cl(a.i,a.ja,d,a.I.getName(),a.Z,c,g,f,a.reverse,a.unique):null!=c?(f=a.I?a.I.getName():null,c=Bl(a.i,a.ja,d,f,a.Z,a.reverse,a.unique,c,g)):(c=yl(a.i,d,a.ja,a.j?a.I.j:a.i.l,a.Z,a.reverse,a.unique),a.j&&(c+=", "+a.i.j+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);Q(a.logger,a+": continue:  SQL: "+c+" : "+S(d));a.n.executeSql(c,d,function(c,d){0<d.rows.length?Wm(a,d.rows.item(0)):Wm(a);b.call(a,a.l,a.p,a.X);b=null},function(c,d){M(a.logger,
"get error: "+d.message);a.S(d);Ij(a);a.B=!0;Wm(a);b.call(a,a.p,a.l,a.X);b=null;return!1})}h.yd=function(){return!!this.n};h.update=function(a){if(!this.yd())throw new ek;var b=new G,c=this.da();a=Fl(this.i,a,c);var d="REPLACE INTO "+Al(this.i)+" ("+a.Af.join(", ")+") VALUES ("+a.Xf.join(", ")+")";Q(this.logger,this+': update "'+d+'" : '+S(a.values));this.n.executeSql(d,a.values,function(){b.t(c)},function(a,c){b.u(c);return!1});return b};
h.advance=function(a){var b=this.l,c=this.p,d=!0;null==this.l||this.j&&null==this.p||(a-=1,d=!1);Ym(this,function(a,d,g){var k=null!=b&&null!=a&&0==mj(b,a);if(this.j){var l=null!=d&&null!=c&&0==mj(d,c);if(k&&l)throw new Qc("current: "+b+";"+c+" next: "+a+";"+d);}else if(k)throw new Qc("current: "+b+" next: "+a);this.Zb(a,d,g)},this.l,d,a,this.p)};h.hd=function(a){null!=a?Ym(this,this.Zb,a,!0):this.advance(1)};h.openCursor=function(a,b){Ym(this,this.Zb,a,!1,0,b)};
h.clear=function(){if(!this.yd())throw new ek;var a=new G,b=this.i.l,b="DELETE FROM "+Al(this.i)+" WHERE "+b+" = ?",c=[this.da()];Q(this.logger,this+': clear "'+b+'" : '+S(c));this.n.executeSql(b,c,function(b,c){a.t(c.rowsAffected)},function(b,c){a.u(c);return!1});return a};h.toString=function(){return"WebSql"+Vm.m.toString.call(this)};function Zm(a,b){this.g=b}E(Zm,nk);h=Zm.prototype;h.logger=R("ydn.db.crud.req.WebSql");
function Xm(a,b){if(b.fc&&!b.keyPath&&0==b.indexes.length&&a._default_){var c=a._default_;if(-1==c.indexOf(";base64,"))return oh(c);'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substr(1,c.length-2));for(var d=c.split(";base64,"),c=d[0].split(":")[1],d=window.atob(d[1]),e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f.buffer],{type:c})}c=a._default_?oh(a._default_):{};null!=b.keyPath&&(d=tl(a[b.keyPath],b.type),null!=d&&$k(b,c,d));for(d=0;d<b.indexes.length;d++)e=
b.index(d),f=e.j,"_default_"==f||e.n||e.multiEntry||"DATE"!=e.type&&!b.fc||(f=tl(a[f],e.type),s(f)&&sl(e,c,f));return c}h.Ye=function(){throw new Oc("putData");};
h.$a=function(a,b,c,d,e,f){function g(b,d){if(null==e[b])if(Q(m.logger,"empty object at "+b+" of "+e.length),p++,p==e.length)P(m.logger,q+" success "+q),V(a,n,t);else{var D=b+2;D<e.length&&g(D,d)}var F;F=s(f)?Fl(k,e[b],f[b]):Fl(k,e[b]);D=l+Al(k)+" ("+F.Af.join(", ")+") VALUES ("+F.Xf.join(", ")+");";Q(m.logger,X(a)+" SQL: "+D+" PARAMS: "+F.values+" REQ: "+b+" of "+e.length);d.executeSql(D,F.values,function(f,q){function D(b,c){var e="ydn.db.me:"+k.getName()+":"+b.getName(),e=l+Ia(e)+" ("+k.j+", "+
b.i+") VALUES (?, ?)",f=[nj(I,k.type),nj(c,b.type)];Q(m.logger,X(a)+" multiEntry "+e+" "+f);d.executeSql(e,f,function(){},function(a,b){M(m.logger,"multiEntry index insert error: "+b.message);return!1})}p++;var I=s(F.key)?F.key:q.insertId;1>q.rowsAffected&&(t=!0,I=new ak(I+" no-op"));for(var cc=0,Sh=k.indexes.length;cc<Sh;cc++){var Mc=k.index(cc);if(Mc.multiEntry)for(var xd=oj(e[b],Mc.keyPath),Bt=(xd?xd.length:0)||0,Xk=0;Xk<Bt;Xk++)D(Mc,xd[Xk])}c?V(a,I):(n[b]=I,p==e.length?V(a,n,t):(cc=b+2,cc<e.length&&
g(cc,f)))},function(d,f){p++;t=!0;6==f.code?f.name="ConstraintError":M(m.logger,"error: "+f.message+" "+q);if(c)V(a,f,!0);else if(n[b]=f,p==e.length)Q(m.logger,"success "+q),V(a,n,t);else{var k=b+2;k<e.length&&g(k,d)}return!1})}b=!b;var k=Z(this.g,d),l=b?"INSERT INTO ":"INSERT OR REPLACE INTO ";d=a.g;var m=this,n=[],p=0,q=X(a)+" inserting "+e.length+" objects.",t=!1;if(0<e.length)for(b=0;2>b&&b<e.length;b++)g(b,d);else P(this.logger,"success"),V(a,[])};
h.Jd=function(a,b,c){if(0==c.length)V(a,[]);else{for(var d=[],e=0,f=0,g=this,k=function(k,l){var m=[];Q(g.logger,"put "+l.length+" objects to "+k);for(var n=El(Z(g.g,k)),p=n?void 0:[],q=0;q<l.length;q++)m.push(b[l[q]]),n||p.push(c[l[q]].F());n=Vj(a);n.w(function(b){for(var c=0;c<l.length;c++)d[l[c]]=b[c];e++;e==f&&V(a,d)},function(){e++;e==f&&V(a,d,!0)});g.$a(n,!1,!1,k,m,p)},l="",m=[],n=[],p=0;p<c.length;p++){var q=c[p].A(),t=c[p].F();q!=l?(f++,0<m.length&&k(l,m),m=[p],n=[t],l=q):(m.push(p),n.push(t))}0<
m.length&&k(l,m)}};h.od=function(a,b,c){var d=a.g,e=Z(this.g,b),f=this;b=e.j;c=[nj(c,e.type)];b="SELECT * FROM "+Al(e)+" WHERE "+b+" = ?";var g=X(a)+" SQL: "+b+" PARAMS: "+c;Q(this.logger,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=Xm(d,e),V(a,d)):(P(f.logger,"success no result: "+g),V(a,void 0))}else P(f.logger,"success no result: "+g),V(a,void 0)},function(b,c){M(f.logger,"error: "+g+" "+c.message);V(a,c,!0);return!1})};
h.Se=function(a,b,c){function d(b,e){var p=l.j,q=[nj(c[b],l.type)],t="SELECT * FROM "+Al(l)+" WHERE "+p+" = ?";Q(f.logger,"SQL: "+t+" PARAMS: "+q);e.executeSql(t,q,function(e,f){k++;if(0<f.rows.length){var n=f.rows.item(0);null!=n&&(g[b]=Xm(n,l))}else g[b]=void 0;k==c.length?V(a,g):(n=b+10,n<c.length&&d(n,e))},function(e,l){k++;M(f.logger,"error: "+t+" "+l.message);if(k==c.length)V(a,g);else{var n=b+10;n<c.length&&d(n,e)}return!1})}var e=a.g,f=this,g=[],k=0,l=Z(this.g,b);if(0<c.length)for(b=0;10>
b&&b<c.length;b++)d(b,e);else P(f.logger,"success"),V(a,[])};
h.Dd=function(a,b){function c(d,k){var n=b[d],p=Z(e.g,n.A()),q=lk(n),n=p.j,q=[nj(q,p.type)],t="SELECT * FROM "+Al(p)+" WHERE "+n+" = ?";Q(e.logger,"SQL: "+t+" PARAMS: "+q);k.executeSql(t,q,function(k,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=Xm(n,p))}else f[d]=void 0;g==b.length?(Q(e.logger,"success "+t),V(a,f)):(n=d+10,n<b.length&&c(n,k))},function(b,c){V(a,c,!0);return!1})}var d=a.g,e=this,f=[],g=0;if(0<b.length)for(var k=0;10>k&&k<b.length;k++)c(k,d);else Q(this.logger,"success"),
V(a,[])};
h.fd=function(a,b){function c(d,g){function k(a){a="ydn.db.me:"+l.getName()+":"+a.getName();a="DELETE FROM  "+Ia(a);Q(e.logger,"SQL: "+a);g.executeSql(a,[])}var l=Z(e.g,b[d]),m="DELETE FROM  "+Al(l);Q(e.logger,"SQL: "+m+" PARAMS: []");g.executeSql(m,[],function(g){d==b.length-1?(Q(e.logger,"success "+m),V(a,b.length)):c(d+1,g)},function(b,c){V(a,c,!0);return!1});for(var n=0,p=l.indexes.length;n<p;n++){var q=l.index(n);q.multiEntry&&k(q)}}var d=a.g,e=this;0<b.length?c(0,d):(Q(this.logger,"success"),
V(a,0))};
h.Md=function(a,b){function c(k){if(k>=b.length)V(a,f,g);else{var l=Z(e.g,b[k].A()),m=nj(b[k].F(),l.type),n=" WHERE "+l.j+" = ?",p="DELETE FROM "+Al(l)+n,q=X(a)+" SQL: "+p+" PARAMS: "+[m];d.executeSql(p,[m],function(){f++;c(k)},function(a,b){M(e.logger,"error: "+q+b.message);g=!0;c(k);return!1});k++;for(var p=function(b){b="ydn.db.me:"+l.getName()+":"+b.getName();b="DELETE FROM  "+Ia(b)+n;Q(e.logger,X(a)+NaN+b);d.executeSql(b,[m])},t=0,x=l.indexes.length;t<x;t++){var z=l.index(t);z.multiEntry&&p(z)}}}
var d=a.g,e=this,f=0,g=!1;Q(this.logger,X(a)+" removeByKeys: "+b.length+" keys");c(0)};
h.Ld=function(a,b,c){function d(b){b="ydn.db.me:"+f.getName()+":"+b.getName();b="DELETE FROM  "+Ia(b)+l;Q(k.logger,X(a)+NaN+b);e.executeSql(b,[g])}var e=a.g,f=Z(this.g,b),g=nj(c,f.type),k=this,l=" WHERE "+f.j+" = ?";b="DELETE FROM "+Al(f)+l;Q(this.logger,X(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){V(a,c.rowsAffected)},function(b,c){V(a,c,!0);return!1});b=0;for(c=f.indexes.length;b<c;b++){var m=f.index(b);m.multiEntry&&d(m)}};h.ie=function(a,b,c){$m(this,a,b,void 0,c)};
h.Pc=function(a,b,c){$m(this,a,b,void 0,c)};h.Ze=function(a,b,c,d){$m(this,a,b,c,d)};
function $m(a,b,c,d,e){function f(c){c="ydn.db.me:"+k.getName()+":"+c.getName();c="DELETE FROM  "+Ia(c)+n;Q(a.logger,X(b)+NaN+c);g.executeSql(c,m)}var g=b.g,k=Z(a.g,c);c="DELETE FROM "+Al(k);var l=[],m=[],n="";null!=e&&(s(d)?(d=Hj(k,d),lj(d.i,d.type,e,m,l)):lj(k.j,k.type,e,m,l),n=" WHERE "+m.join(" AND "));c+=n;var p=X(b)+" SQL: "+c+" PARAMS: "+l;Q(a.logger,p);g.executeSql(c,l,function(c,d){Q(a.logger,"success "+p);V(b,d.rowsAffected)},function(c,d){M(a.logger,"error: "+p+d.message);V(b,d,!0);return!1});
e=0;for(d=k.indexes.length;e<d;e++)c=k.index(e),c.multiEntry&&f(c)}h.kd=function(a,b){function c(g){var k="SELECT COUNT(*) FROM "+Ia(b[g]);Q(e.logger,"SQL: "+k+" PARAMS: []");d.executeSql(k,[],function(d,e){var k=e.rows.item(0);f[g]=parseInt(k["COUNT(*)"],10);g++;g==b.length?V(a,f):c(g)},function(b,c){V(a,c,!0);return!1})}var d=a.g,e=this,f=[];0==b.length?(Q(this.logger,"success"),V(a,0)):c(0)};
h.yc=function(a,b,c,d,e){var f=[];b=yl(Z(this.g,b),f,6,d,c,!1,e);Q(this.logger,X(a)+" SQL: "+b+" PARAMS: "+f);a.g.executeSql(b,f,function(b,c){var d=c.rows.item(0);V(a,Pl(d))},function(b,c){V(a,c,!0);return!1})};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=this,p=[],q=Z(this.g,c),t=q.l,x=q.type,z=x,D=null!=d&&d!==t?Hj(q,d):null,F=d||t;D&&(z=D.type);c=[];if(m&&s(m[0])){var J=m[0];D&&s(m[1])?(d=m[1],e=Cl(q,b,c,D.getName(),e,J,!0,d,k,l)):e=Bl(q,b,c,d,e,k,l,J,!0)}else e=yl(q,c,b,F,e,k,l);y(f)&&(e+=" LIMIT "+f);y(g)&&(e+=" OFFSET "+g);var N=a+" SQL: "+e+" ;params= "+S(c);Q(this.logger,N);a.g.executeSql(e,c,function(c,d){for(var e=d.rows.length,f,g=0;g<e;g++)f=d.rows.item(g),2==b?p[g]=tl(f[t],x):1==b?p[g]=tl(f[F],
z):3==b?p[g]=[tl(f[F],z),tl(f[t],x)]:null!=f&&(p[g]=Xm(f,q));P(n.logger,"success "+a);m&&f&&(m[0]=tl(f[F],z),m[1]=tl(f[t],x));V(a,p)},function(b,c){M(n.logger,"error: "+N+c.message);V(a,c,!0);return!1})};function an(a,b){this.g=b}E(an,Zm);an.prototype.logger=R("ydn.db.core.req.WebSql");an.prototype.h=function(a,b,c,d){c=Z(this.g,c);return new Vm(a,b,c,d)};em.prototype.C=function(){var a=rk(this);if("indexeddb"==a)return new im(0,this.h);if("websql"==a)return new an(0,this.h);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new Um(0,this.h);throw new Qc("No executor for "+a);};function bn(a){return w(a)?a.replace(/\D/g,"").replace(/^0+/,""):null}function cn(a){if(!w(a)||!/[\w\+]+@\w+\.\w+/.test(a))return null;a=a.toLowerCase();return a=a.replace(/\+\w*?@/,"@")};function dn(a){if(!w(a))throw new uh;this.Ra=a;this.j=U;this.g=[];en(this,a);this.Vc=""}h=dn.prototype;h.Ra="";h.Rf=NaN;h.Tf=NaN;h.ef=!1;h.Vc="";
function en(a,b){var c=b.split(/\sFROM\s/i);if(2==c.length){var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==c.length){a.l=c[1].toUpperCase();if("SELECT"==a.l)a.j=Cj;else if("INSERT"==a.l)a.j=U;else if("UPDATE"==a.l)a.j=U;else if("DELETE"==a.l)a.j=U;else return;var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.i=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.i=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-
1):new ik("missing closing parentheses"));a.C=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.h=d.substring(c),d=d.substring(0,c)):a.h="";c=d.search(/WHERE/i);0<c?(a.n=d.substring(c+6).trim(),d=d.substring(0,c)):a.n="";a.g=d.trim().split(",").map(function(a){a=Fa(a,'"');a=Fa(a,"'");return a.trim()})}}}
h.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.Ra=this.Ra.replace("?",a[b]);en(this,this.Ra)}this.o=fn(this);if(!this.o)return this.Vc;a=this.h.length;if(b=/OFFSET\s+(\d+)/i.exec(this.h))this.Tf=parseInt(b[1],10),a=this.h.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.h))this.Rf=parseInt(b[1],10),b=this.h.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.h.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.ef="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.ef=!1,this.p=Fa(Fa(a,'"'),"'")):this.p=void 0;return""};function gn(a){if("*"==a.C)return null;a=a.C.split(",");return a=a.map(function(a){return Fa(a.trim(),'"')})}h.toJSON=function(){return{sql:this.Ra}};
function fn(a){function b(a){return Ua(c,function(b){return b.Rb==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.n.length)for(var e=a.n.split("AND"),f=0;f<e.length;f++){var g=e[f],k=d.exec(g);if(k){var l=k[1].trim(),l=Fa(l,'"'),l=Fa(l,"'");if(0<l.length){var m=k[3].trim();ra(m,'"')?m=Fa(m,'"'):ra(m,"'")?m=Fa(m,"'"):m=parseFloat(m);k=new zj(l,k[2],m);l=b(l);if(0<=l){if(c[l]=c[l].he(k),!c[l])return a.Vc='where clause "'+g+'" conflict',null}else c.push(k)}else return a.Vc='Invalid clause "'+g+'"',null}else return a.Vc=
'Invalid clause "'+g+'"',null}return c}h.toString=function(){return"query:"+this.Ra};function hn(a,b){this.g=b;this.h=a}hn.prototype.logger=R("ydn.db.sql.req.nosql.Node");hn.prototype.toJSON=function(){return{sql:this.g}};hn.prototype.toString=function(){return"idb.Node:"};
hn.prototype.execute=function(a,b){var c=Za(this.g.g)[0],d=this.g.o,e=this.g.Rf,e=isNaN(e)?100:e,f=this.g.Tf,f=isNaN(f)?0:f,g=this.g.p,k=gn(this.g),l=null,m=this.g.ef;if(0==d.length)l=null;else if(1==d.length)l=fj(d[0].g);else throw new Nc("too many conditions.");null===k||Xj(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=k.length;if(1==b)return oj(a,k[0]);for(var c={},d=0;d<b;d++)c[k[d]]=oj(a,k[d]);return c}));c(d,b)});var d=0<d.length?d[0].Rb:void 0,n=X(a)+" executing on"+c;d&&(n+=":"+
d);n+=" "+kj(l);P(this.logger,n);g&&g!=this.h.keyPath?b.list(a,4,c,g,l,e,f,m,!1):s(d)&&d!=this.h.keyPath?b.list(a,4,c,d,l,e,f,m,!1):b.list(a,4,c,null,l,e,f,m,!1)};function jn(a,b){hn.call(this,a,b)}E(jn,hn);
jn.prototype.execute=function(a,b){var c,d=Za(this.g.g)[0],e=this.g.o,f=null;if(0==e.length)f=null;else if(1==e.length)f=fj(e[0].g);else throw new Nc("too many conditions.");var g=this.g.i,e=0<e.length?e[0].Rb:void 0,k=X(a)+" executing "+g+" on "+d;e&&(k+=":"+e);k+=" "+kj(f);P(this.logger,k);if("COUNT"==g)f?b.yc(a,d,f,e,!1):b.yc(a,d,null,void 0,!1);else{var l,k=gn(this.g);if(!k||0==k.length)throw new Ah("field name require for reduce operation: "+g);k=k[0];if("MIN"==g)l=kn(k);else if("MAX"==g)l=ln(k);
else if("AVG"==g)c=0,l=mn(k);else if("SUM"==g)c=0,l=nn(k);else throw new vh(g);var m;s(e)?m=new Qj(d,e,f):m=new Pj(d,f);var d=b.h(a.g,X(a),d,4),n=m.load([d]);n.S=function(b){V(a,b,!0)};var p=0;n.N=function(b){null!=b?(b=m.g?n.da():n.Q(),c=l(b,c,p),n.advance(1),p++):V(a,c)}}};function mn(a){return function(b,c,d){s(c)||(c=0);return(c*d+b[a])/(d+1)}}function nn(a){return function(b,c){return c+b[a]}}function kn(a){return function(b,c){var d=b[a];return s(c)?c<d?c:d:d}}
function ln(a){return function(b,c){var d=b[a];return s(c)?c>d?c:d:d}};function on(a,b){this.g=b}E(on,im);on.prototype.logger=R("ydn.db.sql.req.IndexedDb");on.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new ik(c);c=Za(b.g);if(1==c.length){var d=Z(this.g,c[0]);if(!d)throw new fk(c[0]);var e=gn(b);if(e)for(var f=0;f<e.length;f++)if(!Ok(d,e[f]))throw new fk('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new jn(d,b):g=new hn(d,b);g.execute(a,this)}else throw new vh(b.Ra);};function pn(a,b){this.h=b;this.i=a;this.g=gn(b)}pn.prototype.logger=R("ydn.db.sql.req.websql.Node");pn.prototype.toJSON=function(){return{sql:this.h.Ra}};pn.prototype.toString=function(){return"websql.Node:"};function qn(a,b){if(a.g){if(1==a.g.length){if(A(b))return lc(b,a.g[0]);return}for(var c={},d=0;d<a.g.length;d++)c[a.g[d]]=lc(b,a.g[d]);return c}return Xm(b,a.i)}
pn.prototype.execute=function(a,b,c){var d=this,e=[];b.executeSql(this.h.Ra,c,function(b,c){for(var k=c.rows.length,l=0;l<k;l++){var m=c.rows.item(l);if(A(m))var n=qn(d,m);e.push(n)}a(e)},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function rn(a,b){pn.call(this,a,b)}E(rn,pn);rn.prototype.execute=function(a,b,c){var d=this;b.executeSql(this.h.Ra,c,function(b,c){var d=c.rows.length;if(1==d)d=Pl(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new dk;},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function sn(a,b){this.g=b}E(sn,an);sn.prototype.logger=R("ydn.db.sql.req.WebSql");sn.prototype.executeSql=function(a,b,c){var d=Za(b.g);if(1==d.length){var e=Z(this.g,d[0]);if(!e)throw new fk(d[0]);var f=gn(b);if(f)for(var g=0;g<f.length;g++)if(!Ok(e,f[g]))throw new fk('Index "'+f[g]+'" not found in '+d[0]);var k;b.i?k=new rn(e,b):k=new pn(e,b);k.execute(function(b,c){V(a,b,c)},a.g,c)}else throw new vh(b.Ra);};function tn(a,b){this.g=b}E(tn,Um);tn.prototype.logger=R("ydn.db.sql.req.SimpleStore");tn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new ik(c);c=Za(b.g);if(1==c.length){var d=Z(this.g,c[0]);if(!d)throw new fk(c[0]);var e=gn(b);if(e)for(var f=0;f<e.length;f++)if(!Ok(d,e[f]))throw new L('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new jn(d,b):g=new hn(d,b);g.execute(a,this)}else throw new Nc(b.Ra);};function un(a,b,c,d){Ck.call(this,a,b,c,d)}E(un,il);un.prototype.executeSql=function(a,b){for(var c=new dn(a),d=Za(c.g),e=0;e<d.length;e++){var f=Z(this.h,d[e]);if(!f)throw new L("store: "+f+" not exists.");}P(this.logger,"executeSql: "+a+" params: "+b);var g=this.g.request("sql",Za(c.g),c.j);W(g,function(){Y(this).executeSql(g,c,b||[])},this);return g};function vn(a,b,c){dm.call(this,a,b,c)}E(vn,em);vn.prototype.Lc=function(a,b){return new un(this,this.h,a,b)};vn.prototype.executeSql=function(a,b){return this.g.executeSql(a,b)};vn.prototype.C=function(){var a=rk(this);if("indexeddb"==a)return new on(0,this.h);if("websql"==a)return new sn(0,this.h);if("memory"==a||"localstorage"==a||"sessionstorage"==a)return new tn(0,this.h);throw new Qc("No executor for "+a);};function wn(a,b){s(a)&&5242880<a&&M(this.logger,"storage size request ignored, use Quota Management API instead");this.ea=null;this.Sc=b||NaN}h=wn.prototype;
h.connect=function(a,b){function c(a,c,d){P(e.logger,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)xn(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Lk(b,c[d])||(a.deleteObjectStore(c[d]),P(e.logger,"store: "+c[d]+" deleted."))}function d(a,b){f.gb?M(e.logger,"database already set."):s(b)?(M(e.logger,b?b.message:"Error received."),e.ea=null,f.u(b)):(e.ea=a,e.ea.onabort=function(a){Q(e.logger,e+": abort");e.Wc(a.target.error)},
e.ea.onerror=function(a){Q(e.logger,e+": error");e.Wc(a.target.error)},e.ea.onversionchange=function(a){Q(e.logger,e+" closing connection for onversionchange to: "+a.version);if(e.ea&&(e.ea.onabort=null,e.ea.onblocked=null,e.ea.onerror=null,e.ea.onversionchange=null,e.Gd(a),!a.defaultPrevented)){e.ea.close();e.ea=null;var b=Error();b.name=a.type;e.Yd(b)}},f.t(parseFloat(g)))}var e=this,f=new G,g=void 0,k=b.version;P(e.logger,"Opening database: "+a+" ver: "+(b.h?"auto":k));var l;l=s(k)?Ej.open(a,k):
Ej.open(a);l.onsuccess=function(f){var k=f.target.result;s(g)||(g=k.version);P(e.logger,"Database: "+k.name+", ver: "+k.version+" opened.");if(b.h)e.Xa(function(f){if(b instanceof Hk)for(var g=0;g<f.stores.length;g++)Lk(b,f.stores[g].getName())||Ik(b,f.stores[g].ba());f=Ml(b,f,!1,!0);if(0<f.length){P(e.logger,"Schema change require for difference in "+f);var l=y(k.version)?k.version+1:1;if("IDBOpenDBRequest"in r){k.close();var m=Ej.open(a,l);m.onupgradeneeded=function(a){a=a.target.result;P(e.logger,
"re-open for version "+a.version);c(a,m.transaction,!1)};m.onsuccess=function(a){d(a.target.result)};m.onerror=function(){P(e.logger,e+": fail.");d(null)}}else{var p=k.setVersion(l+"");p.g=function(a){M(e.logger,"migrating from "+k.version+" to "+l+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=F;c(k,p.transaction,!0)};var F=function(){var b=Ej.open(a);b.onsuccess=function(a){a=a.target.result;P(e.logger,e+": OK.");d(a)};b.onerror=function(){P(e.logger,e+": fail.");d(null)}};
null!=p.transaction&&(p.transaction.oncomplete=F)}}else d(k)},void 0,k);else if(b.version>k.version){var l=k.setVersion(b.version);l.g=function(a){M(e.logger,"migrating from "+k.version+" to "+b.version+" failed.");d(null,a)};l.onsuccess=function(){c(k,l.transaction,!0)}}else b.version==k.version?P(e.logger,"database version "+k.version+" ready to go"):M(e.logger,"connected database version "+k.version+" is higher than requested version."),e.Xa(function(a){a=Ml(b,a,!1,!0);0<a.length?(P(e.logger,a),
d(null,new yh("different schema: "+a))):d(k)},void 0,k)};l.onupgradeneeded=function(a){a=a.target.result;g=NaN;P(e.logger,"upgrade needed for version "+a.version);c(a,l.transaction,!1)};l.onerror=function(c){e.logger.log(Me,'open request to database "'+a+'" '+(s(b.version)?" with version "+b.version:"")+" cause error of "+l.error.name,void 0);d(null,c)};l.onblocked=function(c){e.logger.log(Me,"database "+a+" "+b.version+" block, close other connections.",void 0);d(null,c)};y(this.Sc)&&!isNaN(this.Sc)&&
setTimeout(function(){"done"!=l.readyState&&(e.logger.log(Me,e+": database state is still "+l.readyState,void 0),d(null,new jk("connection timeout after "+e.Sc)))},this.Sc);return f};h.Sc=18E4;h.Yd=function(){};h.Wc=function(){};h.Gd=function(){};h.uc=function(){return"indexeddb"};h.Xd=function(){return!!this.ea};h.logger=R("ydn.db.con.IndexedDb");h.ea=null;h.Wd=function(){return this.ea?parseFloat(this.ea.version):void 0};
h.Xa=function(a,b,c){c=c||this.ea;if(s(b)){if(null===b){if(0==c.objectStoreNames.length){a(new Ll(c.version));return}throw new xh;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new Ll(c.version));return}b=c.transaction(b,Cj)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var k=b.objectStore(e[d]),l=[],m=0,n=k.indexNames.length;m<n;m++){var p=k.index(k.indexNames[m]);l[m]=new ol(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new Ek(k.name,k.keyPath,k.autoIncrement,void 0,l)}b=new Ll(c.version,f);a(b)};
function xn(a,b,c,d){function e(){var a={autoIncrement:!!d.h};null!=d.keyPath&&(a.keyPath=d.keyPath);return b.createObjectStore(d.getName(),a)}Q(a.logger,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName()))if(c=c.objectStore(d.getName()),vl(d.keyPath||"",c.keyPath||""))b.deleteObjectStore(d.getName()),M(a.logger,"store: "+d.getName()+" deleted due to keyPath change."),c=e();else if(ga(c.autoIncrement)&&ga(d.h)&&c.autoIncrement!=d.h)b.deleteObjectStore(d.getName()),
M(a.logger,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e();else{for(var f=c.indexNames,g=0,k=0,l=0,m=0;m<d.indexes.length;m++){var n=d.index(m),p=!1;if(f.contains(n.getName())){var q=c.index(n.getName()),t=null!=q.unique&&null!=n.unique&&q.unique!=n.unique,x=null!=q.multiEntry&&null!=n.multiEntry&&q.multiEntry!=n.multiEntry,q=null!=q.keyPath&&null!=n.keyPath&&!!vl(q.keyPath,n.keyPath);if(t||x||q)c.deleteIndex(n.getName()),p=!0,g--,l++}else"BLOB"!=n.type&&(p=!0);p&&(n.unique||
n.multiEntry?(p={unique:n.unique,multiEntry:n.multiEntry},c.createIndex(n.getName(),n.keyPath,p)):c.createIndex(n.getName(),n.keyPath),g++)}for(m=0;m<f.length;m++)Ok(d,f[m])||(c.deleteIndex(f[m]),k++);Q(a.logger,"Updated store: "+c.name+", "+g+" index created, "+k+" index deleted, "+l+" modified.")}else{c=e();for(m=0;m<d.indexes.length;m++)n=d.index(m),"BLOB"==n.type?a.logger.info("Index "+n+" of blob data type ignored."):(Q(a.logger,"Creating index: "+n),n.unique||n.multiEntry?(p={unique:n.unique,
multiEntry:n.multiEntry},c.createIndex(n.getName(),n.keyPath,p)):c.createIndex(n.getName(),n.keyPath));Q(a.logger,"Created store: "+c)}}h.md=function(a,b,c,d){var e=this.ea;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};h.Vd=function(){Q(this.logger,this+" closing connection");this.ea.close()};
h.toString=function(){return"IndexedDB:"+(this.ea?this.ea.name+":"+this.ea.version:"")};Zj.push(function(a,b){if(!Ej||b&&"indexeddb"!=b)return null;var c=Ej.deleteDatabase(a),d=new Tj("IDBVersionChangeEvent ");c.onblocked=function(a){Sc(d,a)};c.onerror=function(a){d.u(a)};c.onsuccess=function(a){d.t(a)};return d});function yn(a){Qm.call(this,a);this.h=NaN}E(yn,Qm);h=yn.prototype;h.logger=R("ydn.db.con.SimpleStorage");h.Wd=function(){return this.h};
h.connect=function(a,b){function c(a,b){setTimeout(function(){b?(P(d.logger,d+" opening fail"),e.u(b)):(P(d.logger,d+" version "+d.Wd()+" open"),e.t(a))},10)}var d=this,e=new G;this.j=this.n.ke(a);this.i=a;this.g=b;var f=um(this.i);this.h=NaN;var g=oh(this.j.getItem(f));s(g.version)&&!y(g.version)&&(g.version=NaN);if(g)if(g=new Ll(g),Ml(this.g,g,!1,!1))if(!this.g.h&&!isNaN(g.version)&&this.g.version>g.version)c(NaN,new ck("existing version "+g.version+" is larger than "+this.g.version));else{var k=
this.g.version;this.h=s(k)?k:g.version+1;for(k=0;k<this.g.count();k++)var l=this.g.stores[k]||null;if(this.g instanceof Hk)for(k=0;k<g.count();k++)l=g.stores[k]||null,Ik(this.g,l);k=this.g.toJSON();k.version=this.h||NaN;this.j.setItem(f,S(k));c(g.version||NaN)}else{for(k=0;k<this.g.count();k++)l=this.g.stores[k]||null;this.h=g.version||NaN;c(this.h)}else g=b.toJSON(),this.h=1,g.version=this.h,this.j.setItem(f,S(g)),c(NaN);return e};h.Xd=function(){return!!this.i};h.Yd=function(){};h.Wc=function(){};
h.Gd=function(){};h.uc=function(){return"memory"};h.Vd=function(){};h.md=function(a,b,c,d){a(new Rm(this,function(a,b){d(a,b)}))};h.toString=function(){return"SimpleStorage:"+this.uc()+":"+(this.i+":"+this.h)};function zn(){yn.call(this,this)}E(zn,yn);zn.prototype.ke=function(){return window.localStorage};zn.prototype.uc=function(){return"localstorage"};Zj.push(function(a,b){if(!b||"localstorage"==b){var c=new zn,d=new Hk;c.connect(a,d);c.Xa(function(a){for(var b=0;b<a.stores.length;b++)sm(c,a.stores[b].getName()).clear()})}});function An(){yn.call(this,this)}E(An,yn);An.prototype.ke=function(){return window.sessionStorage};An.prototype.uc=function(){return"sessionstorage"};
Zj.push(function(a,b){if(!b||"sessionstorage"==b){var c=new An,d=new Hk;c.connect(a,d);c.Xa(function(a){for(var b=0;b<a.stores.length;b++)sm(c,a.stores[b].getName()).clear()})}});function Bn(a){this.g=s(a)?a:4194304}h=Bn.prototype;
h.connect=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,g=c.h?isNaN(f)?1:f+1:c.version;O(e.logger,a+": changing version from "+b.version+" to "+g);var k=!1,l=0;b.changeVersion(b.version,g+"",function(a){e.Xa(function(b){k=!0;for(var d=0;d<c.count();d++){var f=Z(b,(c.stores[d]||null).getName()),f=f?Dl(f,c.stores[d]||null):null;Cn(e,a,c.stores[d]||null,function(a){a&&l++},f)}for(d=0;d<b.count();d++)f=b.stores[d]||null,Lk(c,f.getName())||(c instanceof Hk?Ik(c,f):(f="DROP TABLE "+
Al(f),P(e.logger,f),a.executeSql(f,[],function(){},function(a,b){throw b;})))},a,b)},function(c){e.logger.log(Me,"SQLError "+c+" "+c.code+"("+c.message+") while changing version from "+b.version+" to "+g+" on "+a,void 0);throw c;},function(){if(k){var f=".";l!=c.stores.length&&(f=" but unexpected stores exists.");Q(e.logger,a+":"+b.version+" ready"+f);d(b)}else M(e.logger,a+": changing version voided.")})}function d(a,b){s(b)?(e.Ca=null,g.u(b)):(e.Ca=a,g.t(parseFloat(f)))}var e=this,f=NaN,g=new G,
k=null;try{k=r.openDatabase(a,"",a,this.g)}catch(l){if("SECURITY_ERR"==l.name)M(this.logger,"SECURITY_ERR for opening "+a),k=null,this.ff=new hk(l);else throw l;}if(k){var f=k.version,m="database "+a+(0==k.version.length?"":" version "+k.version);null!=b.version&&b.version==k.version?(O(e.logger,"Existing "+m+" opened as requested."),d(k)):this.Xa(function(a){(a=Ml(b,a,!0,!1))?(0==k.version.length?O(e.logger,"New "+m+" created."):b.h?O(e.logger,"Existing "+m+" opened and schema change for "+a):O(e.logger,
"Existing "+m+" opened and  schema change to version "+b.version+" for "+a),c(k,b)):(O(e.logger,"Existing "+m+" with same schema opened."),d(k))},null,k)}else d(null,this.ff);return g};h.uc=function(){return"websql"};h.ff=null;h.Ca=null;h.logger=R("ydn.db.con.WebSql");h.Yd=function(){};h.Wc=function(){};
function Dn(a){var b=a.B,c="CREATE TABLE IF NOT EXISTS "+Al(a)+" (",d=a.j,c=c+(d+" "+b+" PRIMARY KEY ");a.h&&(c+=" AUTOINCREMENT ");if(!a.fc||!a.keyPath&&0==a.indexes.length)c+=" ,_default_ BLOB";for(var e=[],f=[d],g=0,k=a.indexes.length;g<k;g++){var l=a.index(g),m="";if(l.multiEntry){var m="ydn.db.me:"+a.getName()+":"+l.getName(),n=l.unique?" UNIQUE ":"",l="CREATE TABLE IF NOT EXISTS "+Ia(m)+" ("+d+" "+b+", "+l.i+" "+l.o+n+")";e.push(l)}else l.unique&&(m=" UNIQUE "),n=l.keyPath,"BLOB"!=l.type&&w(n)&&
(n="CREATE "+m+" INDEX IF NOT EXISTS "+Ia(a.getName()+"-"+l.getName())+" ON "+Al(a)+" ("+l.i+")",e.push(n)),n=l.i,-1==f.indexOf(n)&&(c+=", "+n+" "+l.o+m,f.push(n))}e.unshift(c+")");return e}h.Wd=function(){return this.Ca?parseFloat(this.Ca.version):void 0};
h.Xa=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var q=nc(e,"sql");Q(f.logger,"Parsing table schema from SQL: "+q);for(var t=q.substr(q.indexOf("("),q.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),x=void 0,z,q=[],D=!1,F=!1,J=0;J<t.length;J++){var N=t[J].match(/\w+|"[^"]+"/g),fa=Qa(N,function(a){return a.toUpperCase()}),I=Fa(N[0],'"'),
N=pl(fa[1]);if(-1!=fa.indexOf("PRIMARY")&&-1!=fa.indexOf("KEY")){z=N;if(w(I)&&!ta(I)&&"_ROWID_"!=I){var cc=I.split(","),x=I;1<cc.length&&(x=cc,z=void 0)}-1!=fa.indexOf("AUTOINCREMENT")&&(D=!0)}else if("_ROWID_"!=I)if("_default_"==I)F=!0;else{var Sh="UNIQUE"==fa[2];ra(I,e.tbl_name+"-")&&(I=I.substr(e.tbl_name.length+1));fa=new ol(I,N,Sh);q.push(fa)}}if(ra(e.name,"ydn.db.me:")){var Mc=e.name.split(":");if(3<=Mc.length){var xd=Mc[1],x=new ol(Mc[2],N,Sh,!0),t=Ua(q,function(a){return a.getName()==Mc[2]});
0<=t?q[t]=x:q.push(x);t=Ua(k,function(a){return a.getName()===xd});0<=t?(J=k[t],k[t]=new Ek(J.getName(),J.keyPath,D,z,q,void 0,!F)):k.push(new Ek(xd,void 0,!1,void 0,[x]));Q(f.logger,'multi entry index "'+x.getName()+'" found in '+xd+(-1==t?"*":""))}else M(f.logger,'Invalid multiEntry store name "'+e.name+'"')}else J=Ua(k,function(a){return a.getName()===e.name}),0<=J?(t=k[J].index(0),q.push(t),k[J]=new Ek(e.name,x,D,z,q,void 0,!F)):(q=new Ek(e.name,x,D,z,q,void 0,!F),k.push(q))}}d=new Ll(g,k);a(d)}}
var f=this,g=(c=c||this.Ca)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,k=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.Xa(a,b,c)},function(a){f.logger.log(Me,"opening tx: "+a.message,void 0);throw a;},e)};
function Cn(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==k.length&&(d(!0),d=null)},function(b,e){g++;g==k.length&&(d(!1),d=null);var f="SQLError creating table: "+c.getName()+" "+e.message+' for executing "'+a;throw new gk(e,f);})}var g=0,k=Dn(c),l="Create";if(e){e=Gk(c,e);if(0==e.length){Q(a.logger,"same table "+c.getName()+" exists.");d(!0);d=null;return}l="Modify";M(a.logger,"table: "+c.getName()+" has changed by "+e+" ALTER TABLE cannot run in WebSql, dropping old table.");k.unshift("DROP TABLE IF EXISTS "+
Ia(c.getName()))}Q(a.logger,l+" table: "+c.getName()+": "+k.join(";"));for(a=0;a<k.length;a++)f(k[a])}h.Xd=function(){return!!this.Ca};h.Vd=function(){this.Ca=null};
h.md=function(a,b,c,d){function e(a){Q(k.logger,k+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var k=this;null===this.Ca&&(a(null),d("abort",this.ff));c==Cj?this.Ca.readTransaction(g,e,f):c==Dj?this.Ca.changeVersion(this.Ca.version,this.Ca.version+1+"",g,e,f):this.Ca.transaction(g,e,f)};
Zj.push(function(a,b){if(!b||"websql"==b){var c=new Bn,d=new Hk;P(c.logger,"deleting websql database: "+a);var d=c.connect(a,d),e=function(){c.logger.info("all tables in "+a+" deleted.")};d.D(function(){c.md(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var l=e.rows.length,m=0,n=0;n<l;n++){var p=e.rows.item(n);"__WebKitDatabaseInfoTable__"!=p.name&&"sqlite_sequence"!=p.name&&(m++,Q(c.logger,"deleting table: "+p.name),b.executeSql("DROP TABLE "+
p.name))}P(c.logger,m+' tables deleted from "'+a+'"')}},function(a,b){throw b;})},[],U,e)});d.wc(function(){M(c.logger,"Connecting "+a+" failed.")})}});Bn.prototype.Gd=function(){};Bn.prototype.toString=function(){return"WebSql:"+(this.Ca?":"+this.Ca.version:"")};bm.prototype.le=function(a){return"indexeddb"==a&&Ej?new wn(this.B,this.N):"websql"==a&&ha(r.openDatabase)?new Bn(this.B):"localstorage"==a&&window.localStorage?new zn:"sessionstorage"==a&&window.sessionStorage?new An:"memory"==a?new yn:null};function En(a,b){sb.call(this);this.j=b;this.g=[];if(a>this.j)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.g.push(this.h())}E(En,sb);En.prototype.Kd=function(a){this.g.length<this.j?this.g.push(a):this.i(a)};En.prototype.h=function(){return{}};En.prototype.i=function(a){if(A(a))if(ha(a.Aa))a.Aa();else for(var b in a)delete a[b]};En.prototype.J=function(){En.m.J.call(this);for(var a=this.g;a.length;)this.i(a.pop());delete this.g};function Fn(){this.g=[];this.i=new id;this.j=new id;this.n=1;this.l=new En(0,4E3);this.l.h=function(){return new Gn};this.o=new En(0,50);this.o.h=function(){return new Hn};var a=this;this.h=new En(0,2E3);this.h.h=function(){return String(a.n++)};this.h.i=function(){}}R("goog.debug.Trace");function Hn(){this.time=this.count=0}Hn.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function Gn(){}
function In(a,b,c){var d=[];-1==b?d.push("    "):d.push(Jn(a.h-b));d.push(" ",Kn(a.h-0));0==a.g?d.push(" Start        "):1==a.g?(d.push(" Done "),d.push(Jn(a.l-a.startTime)," ms ")):d.push(" Comment      ");d.push(c,a);0<a.j&&d.push("[VarAlloc ",a.j,"] ");return d.join("")}Gn.prototype.toString=function(){return null==this.type?this.i:"["+this.type+"] "+this.i};
Fn.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.g.length;d++){var e=this.g[d];1==e.g&&c.pop();a.push(" ",In(e,b,c.join("")));b=e.h;a.push("\n");0==e.g&&c.push("|  ")}if(0!=this.i.ca()){var f=C();a.push(" Unstopped timers:\n");gd(this.i,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Kn(b.startTime),")\n")})}b=this.j.Ha();for(d=0;d<b.length;d++)c=this.j.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",0,"\n","Total comments created ",
0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function Jn(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Kn(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new Fn;/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Ln(a){a.o||(a.o=new Kc);return a.o}bm.prototype.removeEventListener=function(a,b,c,d){Fc(Ln(this),a,b,c,d)};bm.prototype.Na=function(a){Ln(this).dispatchEvent(a)};function Mn(a,b,c){dm.call(this,a,b,c)}E(Mn,vn);R("ydn.gdata.base");function Nn(a){this.i=a||null;this.g=this.h=null;a&&On(this,a)}Nn.prototype.logger=R("ydn.crm.UserSetting");
var Pn={stores:[{name:"general"},{name:"sugar"}]},Qn={stores:[{name:"contact",keyPath:"id.$t",type:"TEXT",indexes:[{name:"updated.$t",type:"TEXT"},{name:"ydn$emails",multiEntry:!0,generator:function(a){var b=[];a=u(a.gd$email)?a.gd$email:A(a.gd$email)?[a.gd$email]:[];for(var c=0;c<a.length;c++){var d=cn(a[c].address);d&&b.push(d)}return b}},{name:"ydn$externalIds",multiEntry:!0,generator:function(a){return(u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:
[]).map(function(a){return a.value})}}]}]};function On(a,b){if(!a.i||a.i!=b){r.sessionStorage.setItem("last-user-id",b);var c=b+"-setting",d=b+"-gdata";a.h&&a.h.getName()!=c&&(Wl(a.h),a.h=null);a.g&&a.g.getName()!=d&&(Wl(a.g),a.g=null);a.h||(a.h=new Mn(c,Pn));a.g||(a.g=new Mn(d,Qn))}}function Rn(a){return a.i?a.i+"-sd":r.sessionStorage.getItem("last-user-id")+"-sd"}function Sn(a){var b=Rn(a),c=new G;chrome.storage.local.get(b,function(a){c.t(a[b])});return c}
function Tn(a,b){var c=Rn(a),d=new G,e={};e[c]=b;chrome.storage.local.set(e,function(){d.t(!0)})};var Nh=("chrome-extension://fmhdpfhfppingdiiefgnanjceieflpkj/"==chrome.extension.getURL("")?"crm-ex/":"")+"option-page.html";function Un(){var a=new G;chrome.storage.sync.get("user-setting",function(b){a.t(b["user-setting"])});return a};function Vn(){}Vn.prototype.logger=R("ydn.crm.Client");function Wn(a,b,c){this.client=a;this.g=b;this.h=c}Wn.prototype.request=function(a){a=this.g.call(this.h,a);return this.client.request(a)};function Xn(a,b,c){this.h=a;this.i=b;this.g=c}Xn.prototype.request=function(a){return this.h(a)?this.i.request(a):this.g.request(a)};function Yn(a,b){this.client=a;this.h=b;this.Mc=NaN;this.i=[];this.g=!1}Yn.prototype.request=function(a){return new Zn(a,this)};function Zn(a,b){a.path=b.h+a.path;this.req=b.client.request(a);this.parent=b;this.i=null;this.h=void 0}E(Zn,Yi);
Zn.prototype.execute=function(a,b){if(this.parent.g)this.i=a,this.h=b,this.parent.i.push(this);else{this.parent.g=!0;var c=function(c,d){var g=Ui(d,"retry-after");g?(this.parent.Mc=/[^0-9|\.]/.test(g)?(new Date(g)).getTime():1E3*parseFloat(g)+C(),r.console.info("Next retry "+this.parent.Mc+", now "+C())):this.parent.Mc=NaN;a&&a.call(b,c,d);this.parent.g=!1;if(g=this.parent.i.pop())g.execute(g.i,g.h),g.i=null,g.h=null},d=this.parent.Mc-C();0<d?(r.console.info("Proxy will call after "+d+" ms"),ef(function(){this.parent.Mc=
NaN;this.req.execute(c,this)},d,this)):this.req.execute(c,this)}};function $n(a,b,c,d,e){this.l=s(a)?a:Qi();this.g=b;this.h=c;this.i=d||0;this.j=!!e}$n.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new Yi(a,this.l,this.i,this.j)};function ao(a,b,c){this.i=s(a)?a:Qi();this.g=b;this.h=c}ao.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new Yi(a,this.i)};function bo(a){for(var b=Tl(a),c=0;c<b.stores.length;c++);this.g=a;this.g.Eb(this.p,this);this.h=1E4;this.j=Se.value;this.i=0;this.o=B(this.C,this);this.n=!1;this.l={}}function co(a){if(a.h&&a.i>=a.h){var b=a.h/100;100<b&&(b=100);a.g.keys("db-logger",null,b).D(function(a){a=a.map(function(a){return new kk("db-logger",a)});this.g.remove("db-logger",a).D(function(){this.g.count("db-logger").D(function(a){this.i=a},this)},this)},a)}}
bo.prototype.p=function(){this.h&&this.g.count("db-logger").D(function(a){this.i=a;co(this)},this)};bo.prototype.C=function(a){if(!this.l[a.h]){var b=a.j;!b||b.value<=this.j||(a={exception:a.g,level:b.value,logger:a.h,name:b.name,time:a.l,message:a.getMessage(),seq:a.n},this.g.put("db-logger",a),this.i++,co(this))}};function eo(a,b){var c=fo,d=a||100,e=b||0,f=gj(["INFO"]);return c.g.values("db-logger","name, time",f,d,e,!0)}var fo=null;var go,ho,jo,ko,lo=R("ydn.crm");function mo(){go||(go=new Tf(0));return go}var no=null;function oo(a,b){if(!b||"local"==b)if(s(a["logging-captureConsole"])&&ei(!!a["logging-captureConsole"]),s(a["logging-bugReport"])){var c=!!a["logging-bugReport"],d=fo;if(c!=d.n){var e=$e();c?Ve(e,d.o):(e=e.g)&&Xa(e,d.o);d.n=c}}}function po(){ho||(ho=new ao(mo()),Pi(ho,"default"));return ho}
function qo(a){var b=po();a=new $i(a,go,!1);Pi(a,"gc");var c=new Wn(a,function(a){a.path="https://yathit-app.appspot.com/proxy/"+a.path;return a});Pi(new Yn(b,"https://yathit-app.appspot.com/proxy/"),"proxy");Pi(new Xn(function(a){return"GET"==a.method},a,c),"gse")}function ro(){ko||(ko=new $n(mo(),void 0,"https://yathit-app.appspot.com/a/cm",1,!0),Pi(ko,"auth"));return ko};function so(a,b){this.j=b||C();this.type=a;this.i=this.g=this.h=void 0}function to(a,b){A(b)?a.h=Ol(b):a.h=b}so.prototype.toJSON=function(){return{type:this.type,timestamp:this.j,newValue:this.g,oldValue:this.h,meta:this.i}};function uo(a){this.g=a}uo.prototype.add=function(a){this.g.add("history",a.toJSON())};function vo(a,b){if(a.link){if(u(a.link)){for(var c=0;c<a.link.length;c++)if(a.link[c].rel==b)return a.link[c];return null}return a.link.rel==b?a.link:null}return null};function wo(a,b){this.entry=a;this.data=b;this.g=!1}wo.prototype.data=null;wo.prototype.preventDefault=function(){this.g=!0};function xo(a,b,c,d){K.call(this,a,b);this.status=c;this.entry=d}E(xo,K);xo.prototype.status=NaN;xo.prototype.L=function(){return this.status};xo.prototype.kb=function(){return this.entry.kb()};function yo(a,b,c){xo.call(this,"conflict",a,b,c.entry)}E(yo,xo);function zo(a,b){this.g=a;if(b)throw new Nc("optional key paths");}var Ao={ih:"key",fh:"date",jh:"modified",hh:"expires",gh:"etag",kh:"updated",lh:"uri",NEXT:"next"};zo.prototype.Q=function(a,b){return b&&this.g[a]?oj(b,this.g[a]):void 0};function Bo(a,b,c,d){a.g[b]&&pj(c,a.g[b],d)};function Co(a,b,c,d){this.key=a;this.h=(this.h=d?b[d]:b)||{};this.g=c}function Do(a){return null!=a.key?a.key:a.g.Q("key",a.h)}Co.prototype.getDate=function(){return this.g.Q("date",this.h)};function Eo(a){return a.g.Q("updated",a.h)}function Fo(a){return a.g.Q("etag",a.h)}function Go(a){var b={},c=Fo(a);c&&1<c.length?b["if-none-match"]=c:(a=Eo(a))&&(b["if-modified-since"]=a);return b}
Co.prototype.toJSON=function(){var a={};Bo(this.g,"key",a,Do(this));var b=this.getDate();b&&Bo(this.g,"date",a,b);(b=this.g.Q("expires",this.h))&&Bo(this.g,"expires",a,b);(b=Eo(this))&&Bo(this.g,"updated",a,b);(b=Fo(this))&&Bo(this.g,"etag",a,b);return a};function Ho(a,b,c){b.expires&&Bo(c,"expires",b,(new Date(b.expires)).getTime());b["last-updated"]&&Bo(c,"updated",b,(new Date(b["last-updated"])).getTime());b.etag&&Bo(c,"etag",b,(new Date(b.etag)).getTime());Bo(c,"date",b,NaN);Co.call(this,a,b,c)}E(Ho,Co);function Io(a,b,c){this.g=a;this.n=c||null;this.i=this.h=null;this.key=b}h=Io.prototype;h.logger=R("ydn.db.sync.entry.Rest");h.kb=function(){if(this.i&&this.g.p&&this.j){var a=this.g.C;this.g.S||delete this.i[a]}return this.i||null};h.Q=function(){return this.n};h.F=function(){return this.key};h.Zd=function(){return this.g.Oe(this.F())};function Jo(a,b){var c=a.F();return new Ho(c,b.Cc(),a.g.o)}
h.te=function(a,b){if(a)return a;if(b.wa())return Vi(b);try{return Vi(b)}catch(c){var d=Ti(b);return A(d)?d:{body:d}}};h.save=function(a){var b=this.F();if(a&&!this.g.p)return C(),Ko(this.g,[this.j.toJSON()]);var c=this.i;if(a&&!c)return pb();a=void 0;null!=this.j&&(C(),a=[this.j.toJSON()]);return Lo(this.g,[c],a,[b])};
h.cc=function(a,b){if(this.g.I&&A(this.h))a.call(b,304),a=null;else{var c=this;Mo(this,function(d){if(d){var e=d.g.Q("expires",d.h);if(e&&e>C()){Q(this.logger,this+" not expired");a.call(b,304);a=null;return}}e=c.Zd();d=c.Yb(e,"GET",d);this.g.na().request(d).execute(function(d,e){c.j=Jo(c,e);c.i=c.te(d,e);a.call(b,e.L());a=null})},this)}};
h.Yb=function(a,b,c,d){a=new Vh(a,b);if(c){var e;"POST"==a.method||"PUT"==a.method||"DELETE"==a.method?(e={},(b=Eo(c))&&(e["if-unmodified-since"]=b),(c=Fo(c))&&1<c.length&&(e["if-match"]=c),c=e):c=Go(c);e=c;a.headers?qc(a.headers,e):a.headers=e}a.body=A(d)?JSON.stringify(d):d;Q(this.logger,this+" "+a.method+" "+a.path+" "+ph(e));return a};
function No(a,b,c){Mo(a,function(a){var e=this.Q();a=this.Yb(this.Zd(),"PUT",a,e);this.g.na().request(a).execute(function(a,d){this.j=Jo(this,d);this.i=a;b&&(b.call(c,d.L()),b=null)},this)},a)}function Mo(a,b,c){a.l?b.call(c,a.l):Oo(a.g,a.F(),function(d){a.l=d;b.call(c,d)})}
h.load=function(a,b){if(this.h&&this.l)a&&(a.call(b,this.h,this.l),a=void 0);else{var c=this.F();this.g.load(c,function(c,e){this.h=c;var f=this.g.C;this.h&&f&&this.h[f]&&(this.l=new Co(this.key,this.h,this.g.o,f),this.g.S||delete this.h[f]);this.h=c;this.l=e;a&&(a.call(b,c),a=void 0)},this)}};function Po(a,b){var c=a.Zd(),d=a.g.na();Mo(a,function(a){a=this.Yb(c,"DELETE",a);d.request(a).execute(function(a,d){Q(this.logger,"deleted "+c+" "+d.L());b.call(this,d.L())},this)},a)}
h.toString=function(){return"sync.entry{"+this.g.A()+":"+this.key+"}"};function Qo(a,b,c){this.storage=a;this.i=b;this.M=b.getName();a="format readRequestTimeout writeRequestTimeout transport Options fetchStrategies baseUri immutable keepMeta metaStoreName metaDataName prefetch prefetchRefractoryPeriod".split(" ");for(var d in c)if(-1==Na(a,d))throw new L('Unknown Sync attribute "'+d+'"  in Sync.');this.I=!!c.immutable;this.h=c.baseUri;this.qb=c.metaStoreName||this.M;this.C=c.metaDataName;this.p=this.qb==this.M;a=c.Options||{};if(!this.qb)throw new L("metadata store name required.");
b=this.ib();for(d in a)if(-1==Na(b,d))throw new L('Unknown Sync.Options attribute "'+d+'" in Sync.Options');this.ra=a.delimiter||"";this.l=a.prefix||"";this.S=!!c.keepMeta;this.N=c.prefetch||y(c.prefetchRefractoryPeriod)?"full":null;this.ja=y(c.prefetchRefractoryPeriod)?c.prefetchRefractoryPeriod:5E3;this.g=Ro(c.transport);this.o=new zo(this.hb(),c.metaData);this.n=null;this.B=NaN}h=Qo.prototype;h.hb=function(){var a={},b;for(b in Ao)a[b]=b;return a};h.ib=function(){return[]};h.A=function(){return this.M};
h.logger=R("ydn.db.sync.Rest");h.ub=function(){return this.h};h.na=function(){this.g||(this.g=new ao);return this.g};h.toString=function(){return"sync:"+this.M};function Ko(a,b){return bl(a.storage.g,a.qb,b).wc(function(a){throw a;})}function So(a,b,c){a.i.keyPath&&null==Sk(a.i,b)&&null!=c&&pj(b,a.i.keyPath,c)}
function Lo(a,b,c,d){d=a.i.keyPath?void 0:d;if(c){if(a.p){for(g=0;g<b.length;g++)null!=c[g]&&qc(b[g],c[g]);return bl(a.storage.g,a.M,b,d)}if(b){for(var e=[],f=b.concat(c),g=0;g<b.length;g++){var k=a.i.keyPath?NaN:d[g];e.push(new kk(a.M,k))}for(g=0;g<c.length;g++)e.push(new kk(a.qb,NaN));return bl(a.storage.g,e,f)}return bl(a.storage.g,a.qb,c)}for(g=0;g<b.length;g++)k=d?d[g]:void 0,So(a,b[g],k);return bl(a.storage.g,a.M,b,d)}
function To(a,b){var c=[new kk(a.M,b)];a.p||c.push(new kk(a.qb,b));return cl(a.storage.g,c)}h.Oe=function(a){return this.ub()+a};h.add=function(a,b,c){null!=c?So(this,b,c):this.i.keyPath&&(c=Sk(this.i,b));var d=this.qa(c,b),e=this;No(d,function(a){201==a||200==a?(Q(e.logger,d+" created"),d.save(!0)):M(e.logger,"Unexpected respond "+a+" for add "+d)})};
function Oo(a,b,c){var d=new kk(a.qb,b);Uo(a,[d]).w(function(a){c.call(void 0,new Co(b,a[0],this.o,this.C))},function(a){M(this.logger,this+" error loading meta data "+a);c.call(void 0,null)},a)}h.Ed=function(a,b){var c=a.map(function(a){return new kk(this.qb,a)});Uo(this,c).w(function(c){for(var e=[],f=0;f<a.length;f++)e[f]=new Co(a[f],c[f],this.o,this.C);b(e)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)};
h.load=function(a,b,c){var d=this.qb,e=[new kk(this.A(),a)];this.p||e.push(new kk(d,a));Uo(this,e).w(function(d){var e=d[0];b.call(c,e,new Co(a,this.p?e:d[1],this.o,this.C))},function(a){M(this.logger,this+" error loading meta data "+a);b.call(c,null,null)},this)};function Uo(a,b){return fl(a.storage.g,b)}
h.get=function(a,b){this.B||this.Pb();Xj(a,function(c,d,e){if(d)e(c,d);else{Sc(a,c);var f=s(c);if(f&&this.I)e(c);else{var g=this.qa(b,c);g.cc(function(a){if(304==a){if(e(c),!f)throw new Qc(g+" not modified, but not exist in server");}else if(200==a)g.save().aa(function(){e(g.kb())});else if(404==a)To(g.g,g.F()).aa(function(){e(g.kb())});else throw e(g.kb()),new Pc("Invalid HTTP respond "+a+" for GET "+b);},this)}}},this)};
function Vo(a,b,c,d,e,f){var g=[],k=a.logger;P(a.logger,d.length+", "+e.length+", "+f.length+", "+g.length+" records to fetch, update, delete, save");var l=d.length+e.length+f.length+g.length;if(0==l)b(c);else{for(var m=!1,n=function(){l--;0==l&&(b(c,m),b=null)},g=0;g<d.length;g++){var p=a.qa(d[g]);p.index=g;p.cc(function(a){200==a?(Q(k,"A new "+this+" received from server"),this.save().w(function(){c[this.index]=this.kb();n()},function(){m=!0;n()},this)):304==a?this.save(!0).w(function(){Q(k,this+
" expires date updated");n()},function(){m=!0;n()},this):(M(k,"Invalid status "+a+" for fetching "+this),n())},p)}for(g=0;g<e.length;g++)p=a.qa(e[g]),p.index=g,p.load(function(){this.cc(function(a){200==a?(Q(k,this+" updated from server"),this.save().w(function(){c[this.index]=this.kb();n()},function(){m=!0;n()},this)):(M(k,"Invalid status "+a+" for fetching "+this),n())})});for(g=0;g<f.length;g++)p=a.qa(f[g]),p.index=g,To(p.g,p.F()).w(function(){c[this.index]=new wo(p,null);n()},function(){m=!0;
n()},p)}}function Wo(a,b,c){Xj(b,function(a,e,f){if(e)f(a,e);else if(Sa(a,function(a){return s(a)})&&this.I)f(a);else{Sc(b,a);var g=a.length;for(e=0;e<c.length;e++)if(this.I&&s(a[e]))g--,0==g&&f(a);else{var k=this.qa(c[e],a[e]);k.index=e;k.cc(function(b){200==b?(a[this.index]=this.kb(),this.save()):404==b&&(a[this.index]=void 0);g--;0==g&&f(a)},k)}}},a)}h.qa=function(a,b){return new Io(this,a,b)};h.count=function(a){return a};h.Te=function(){throw new Nc;};
h.values=function(a,b,c){Xo(this)?(Q(this.logger,"prefetch queued"),Xj(a,function(d,e,f){Sc(a,d);e?f(d,e):Yo(this,function(a){a?el(this.storage.g,this.M,null,null,!1,b,c).w(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(){M(this.logger,this+" prefetch fail");f(d)},this)},this)):this.Te(a,b,c)};
h.keys=function(a,b,c,d,e,f,g){Xj(a,function(k,l,m){Sc(a,k);l?m(k,l):Yo(this,function(a){a?gl(this.storage.g,this.M,b,c,d,e,f,g).w(function(a){m(a)},function(a){m(a,!0)},this):m(k)},function(){M(this.logger,this+" prefetch fail");m(k)},this)},this)};h.re=function(){};
h.put=function(a,b,c){c=s(c)?c:this.i.keyPath?Sk(this.i,b):null;var d=this.qa(c,b);W(a,function(){d.load()},this);Xj(a,function(c,f,g){Sc(a,c);No(d,function(c){409==c?d.cc(function(){var c=new wo(d,b);Sc(a,c);c.g?g(null,f):g(void 0,f)}):200==c||201==c?(d.save(!0),g(b,f)):(M(this.logger,"Unexpected response for PUT: "+c),g(null,f))},this)},this)};
h.remove=function(a,b){var c=this,d=this.qa(b);d.load(function(){Xj(a,function(e,f,g){Po(d,function(f){if(409==f){f=new wo(d,null);Sc(a,f);var l=new yo(c.storage,409,f);c.storage.Na(l)}else 200==f?Q(c.logger,"Successfully deleted object "+b):(M(c.logger,"Unexpected response for DELETE: "+f+" "+b),Sc(a,l));g(e)})})})};
h.Pb=function(){Q(this.logger,this+" starting prefetch");var a=new G;el(this.storage.g,this.M,"updated.$t",null,!0,1).w(function(b){var c={};if(b=b[0])b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b;var d=this,c=new Vh(this.ub(),"GET",c);d.na().request(c).execute(function(b,c){if(200==c.L()){if(!b){var g=Ti(c);w(g)&&(b=JSON.parse(g))}g=(g=(b.feed||b).entry)?u(g)?g:[g]:[];0<g.length?Lo(d,g).aa(function(){a.t(!0)}):a.t(!1)}else 302==c.L()?a.t():(g=d+": Invalid response status "+
c.L()+" on prefetching",M(d.logger,g),a.u(Error(g)))})},function(b){a.u(b)},this);return a};function Xo(a){return a.N?a.B?C()-a.B>a.ja:!0:!1}function Yo(a,b,c,d){Xo(a)?a.n?a.n.w(b,c,d):(a.n=a.Pb(),a.B=C(),a.n.w(b,c,d),a.n.w(function(a){Q(this.logger,"prefetch "+(a?"updated":"no update"));this.n=null},function(a){this.n=null;throw a;},a)):b.call(d,!1)};function Zo(a,b,c){Qo.call(this,a,b,c)}E(Zo,Qo);Zo.prototype.logger=R("ydn.db.sync.Atom");Zo.prototype.ib=function(){return Zo.m.ib.call(this)};Zo.prototype.F=function(a){return a.key};function $o(a){this.data=a}h=$o.prototype;h.F=function(){return this.data.id.$t};h.cf=function(){return this.data.title?this.data.title.$t:void 0};h.Ud=function(a){return vo(this.data,a)};h.$g=function(){var a=this.Ud("self");return a?a.href:void 0};h.Zg=function(){var a=this.Ud("http://schemas.google.com/g/2005#batch");return a?a.href:""};h.la=function(){return this.data.content||null};function ap(a,b,c){Io.call(this,a,b,c)}E(ap,Io);ap.prototype.logger=R("ydn.db.sync.entry.S3");ap.prototype.getName=function(){return this.g.l+this.key};ap.prototype.Yb=function(a,b,c,d){b=ap.m.Yb.call(this,a,b,c,d);if("PUT"==b.method||"POST"==b.method){c=(new od(a)).bc.substr(1);if(1>c.length)throw new Pc("invalid url "+a);b.headers.Key=c;a=b.headers["Content-Type"]||"application/json";d instanceof File?a=d.type:w(d)&&(a=/<*DOCTYPE html/i.test(d)?"text/html":"text/plain");b.headers.ContentType=a}return b};function bp(a){this.data=a}E(bp,$o);var cp={atom:"http://www.w3.org/2005/Atom",ydn:"http://www.yathit.com/2012/ydn",app:"http://www.w3.org/2007/app",openSearch:"http://a9.com/-/spec/opensearch/1.1/",gAcl:"http://schemas.google.com/acl/2007",sites:"http://schemas.google.com/sites/2008",gs:"http://schemas.google.com/spreadsheets/2006",dc:"http://purl.org/dc/terms",batch:"http://schemas.google.com/gdata/batch",gd:"http://schemas.google.com/g/2005",gContact:"http://schemas.google.com/contact/2008",thr:"http://purl.org/syndication/thread/1.0",
xhtml:"http://www.w3.org/1999/xhtml"};function dp(a,b){for(var c=a.indexOf(" "),d=0;d<b.length;d++){var e=b[d],e=(0==d?"xmlns":"xmlns:"+e)+'="'+cp[e]+'"';-1==a.indexOf(e)&&(a=a.substring(0,c+1)+e+" "+a.substr(c+1))}return a}R("ydn.xml");function ep(a){return cp[a]||cp.xhtml};function fp(a,b,c){c=!!c;if(a.getName()!=b.getName())return!1;var d=gp(a),e=gp(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;for(d=0;d<e.length;d++)if(a.getAttribute(e[d])!=b.getAttribute(e[d]))return!1;d=hp(a);e=hp(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;if(0==d.length||0==d.length)return a.data.$t===b.data.$t;for(d=0;d<e.length;d++){var f=ip(a,e[d]),g=ip(b,e[d]);if(!c&&f.length!=g.length||c&&g.length>f.length)return!1;for(var k=0;k<g.length;k++)if(-1==Ua(f,function(a){return fp(a,
g[k],c)}))return!1}return!0};function jp(a,b,c){if(s(b))kp(this,b),s(c)||(c=a[b]);else for(var d in a)if(a.hasOwnProperty(d)&&A(a[d])&&w(a[d].xmlns)){this.Xc=[d].xmlns;kp(this,d);c=a[d];break}this.data=c;this.parent=a}h=jp.prototype;h.Xc="http://www.w3.org/2005/Atom";function kp(a,b){var c=b.split(":");1<c.length&&(a.Xc=ep(c[0])||jp.prototype.Xc,b=c[1]);a.tagName=b}
h.s=function(a,b){var c;c=a;var d=b,e=c;if(s(d))"atom"!=d&&(e=d+"$"+c);else{var f=c.split(":"),e=c.replace(/:/,"$");2==f.length&&(d=f[0],c=f[1])}d=s(d)?ep(d):void 0;c=s(this.data[c])&&s(d)&&this.data[c].xmlns==d?c:e;return u(this.data[c])?new jp(this.data,c,this.data[c][0]):A(this.data[c])?new jp(this.data,c,this.data[c]):null};h.toString=function(){return"JsonElement:"+this.tagName};h.getName=function(){return this.tagName};
function lp(a,b){for(var c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&delete a.data[c];a.data.$t=b}h.getAttribute=function(a){a=a.replace(/:/,"$");return this.data[a]};h.setAttribute=function(a,b){a=a.replace(/:/,"$");this.data[a]=b};h.removeAttribute=function(a){a=a.replace(/:/,"$");delete this.data[a]};function gp(a){var b=[],c;for(c in a.data)a.data.hasOwnProperty(c)&&w(a.data[c])&&"$t"!=c&&b.push(c);return b}
function ip(a,b){s(void 0)?b="undefined$"+b:s(b)&&(b=b.replace(/:/,"$"));var c=[];if(s(b)){var d=a.data[b];if(u(d))for(var e=0;e<d.length;e++)c.push(new jp(a.data,b,d[e]));else A(d)&&c.push(new jp(a.data,b,d))}else for(d in a.data)if(u(a.data[d]))for(e=0;e<a.data[d].length;e++)c.push(new jp(a.data,d,a.data[d][e]));else A(a.data[d])&&c.push(new jp(a.data,d,a.data[d]));return c}function hp(a){var b=[],c;for(c in a.data)A(a.data[c])&&b.push(c.replace("$",":"));return b}
h.appendChild=function(a){var b=a.getName();this.data[b]?(u(this.data[b])||(this.data[b]=[this.data[b]]),this.data[b].push(Ol(a.data))):this.data[b]=Ol(a.data)};
h.update=function(a,b,c,d,e){var f=!1;c=c||{};var g=s(b),k=!0===b||!g,l=!1===b,m=gp(this),n=gp(a);if(!g)for(var p=0;p<m.length;p++)s(e)&&!e[m[p].replace("$",":")]||Va(n,m[p])||(this.removeAttribute(m[p]),f=!0);for(p=0;p<n.length;p++){var q=a.getAttribute(n[p]);if(!s(e)||e[n[p].replace("$",":")])Va(m,n[p])?l||q==this.getAttribute(n[p])||(this.setAttribute(n[p],q),f=!0):(this.setAttribute(n[p],q),f=!0)}if(0==mp(a)&&k&&(e=this.data.$t,l=a.data.$t,s(l)&&e!=l))return lp(this,l),!0;if(!g)for(var t in this.data)d&&
!d[t.replace("$",":")]||!A(this.data[t])||A(a.data[t])||(delete this.data[t],f=!0);t=hp(a);for(e=0;e<t.length;e++)if(l=t[e],!d||!0==d[l]){var x=ip(a,l),m=ip(this,l),z=l.replace(":","$");if(1==x.length)0==m.length?(this.data[z]=Ol(x[0].data),f=!0):1==m.length?c[l]?k&&!fp(m[0],x[0],!0)&&(u(this.data[z])||(this.data[z]=[this.data[z]]),this.data[z].push(Ol(x[0].data)),f=!0):f=m[0].update(x[0],b)||f:g?(l=Ua(m,function(a){return fp(a,x[0],!0)}),-1==l&&k&&(this.data[z].push(Ol(x[0].data)),f=!0)):(this.data[z]=
Ol(x[0].data),f=!0);else if(!u(this.data[z]))if(k)this.data[z]=Ol(a.data[z]),f=!0;else{if(g){var m=Ol(a.data[z]),D=this,l=Ua(m,function(a){return wl(D.data[z],a)});-1==l&&(m.push(this.data[z]),this.data[z]=m,f=!0)}}else if(k)for(m.length>x.length&&(this.data[z].splice(x.length,m.length-x.length),f=!0),p=0;p<x.length;p++)s(m[p])?wl(m[p].data,x[p].data)||(this.data[z][p]=Ol(x[p].data),f=!0):(this.data[z][p]=Ol(x[p].data),f=!0);else if(g)for(p=0;p<a.data[z].length;p++)l=Ua(this.data[z],function(b){return wl(a.data[z][p],
b)}),-1==l&&(this.data[z].push(Ol(a.data[z][p])),f=!0)}return f};h.Ue=function(a,b,c,d,e){s(b)||(b=!1);return this.update(a,b,c,d,e)};h.toJSON=function(){return{data:this.data,tagName:this.tagName}};
function np(a){function b(a,g){d(g,a);var k,l;for(l in a)if(a.hasOwnProperty(l)&&!w(a[l]))if(w(a[l].$t)&&"xhtml"==a[l].type){k=c(l);d(k,a[l]);var m=sh(a[l].$t);e.importNode(m.documentElement,!0);k.appendChild(m.documentElement);g.appendChild(k)}else if(w(a[l].$t))k=c(l),k.textContent=a[l].$t,d(k,a[l]),g.appendChild(k);else if(u(a[l])&&a[l][0]&&w(a[l][0].$t))for(m=0;m<a[l].length;m++)k=c(l),k.textContent=a[l][m].$t,d(k,a[l][m]),g.appendChild(k);else if(u(a[l]))for(m=0;m<a[l].length;m++)k=c(l),g.appendChild(k),
b(a[l][m],k);else A(a[l])&&(k=c(l),g.appendChild(k),b(a[l],k))}function c(a){return e.createElement(a.replace("$",":"))}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&"$t"!=c&&w(b[c])&&a.setAttribute(c.replace("$",":"),b[c])}var e=qh(a.getName(),a.Xc);b(a.data,e.documentElement);return th(e.documentElement)}
function mp(a){function b(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&(u(a[c])?b+=a[c].length:A(a[c])&&b++);return b}var c;s(void 0)?c="undefined$"+c:s(c)&&(c=c.replace(/:/,"$"));return s(c)?u(a.data[c])?a.data[c].length:A(a.data[c])?b(a.data[c]):0:b(a.data)}h.ba=function(a){var b={};if(s(a))for(var c in this.data){var d=c.replace("$",":");w(this.data[c])?b[c]=this.data[c]:!0==a[d]&&(b[c]=Ol(this.data[c]))}else b=Ol(this.data);return new jp(null,this.tagName,b)};
function op(a,b){var c=b.ownerDocument.createElementNS(a.Xc,a.getName()),d;for(d in a.data)if(a.data.hasOwnProperty(d)){var e=d.replace("$",":");if(w(a.data[d]))"$t"==d?c.textContent=a.data[d]:(e=c.ownerDocument.createAttribute(e),e.nodeValue=a.data[d],c.setAttributeNode(e));else if(u(a.data[d]))for(var f=0;f<a.data[d].length;f++){var g=new jp(a.data[d],e,a.data[d][f]);op(g,c)}else A(a.data[d])&&(g=new jp(a.data,e,a.data[d]),op(g,c))}return b.appendChild(c)};function pp(a){var b;if(s(a.id))b=a.id.$t;else if(s(a.batch$id))b=a.batch$id.$t;else if(s(a.g))b=a.g.$t;else throw new uh("id or batch:id required.");this.id=b;this.h=void 0;this.data=a}E(pp,bp);h=pp.prototype;h.logger=R("ydn.gdata.Entry");h.cf=$o.prototype.cf;h.F=function(){return this.id};h.hc=["link","category"];h.Nf=["id","batch$id","link","category"];h.la=$o.prototype.la;function qp(a,b){if(b)a.data.status=""==b?void 0:b;else{var c=a.data;c.status&&(c.status=b)}}
function rp(a){return s(a.gd$deleted)?"gd:deleted":(a=a.status)?a:""}function sp(a){return"gd:deleted"==rp(a.data)}h.setTitle=function(){throw new wh;};h.ic=function(){if(!tp(this.data))throw Error("nothing to commit");var a=new G;up(this,function(b,c){if(c.wa())a.t(b);else{var d=Ti(c);if(w(d)&&/html/.test(Ui(c,"content-type")))try{var e=(new DOMParser).parseFromString(d,"text/html");e.body&&(d=e.body.innerHTML)}catch(f){}a.u(c.L()+" "+c.Da()+" "+d)}},this);return a};
function up(a,b,c){var d=Th("gse");if(tp(a.data)){var e={"Content-Type":"application/atom+xml"};a.g&&(e["GData-Version"]=a.g);var f={},g="POST",k,l,m;m="full";s(l)||(l="base"!=m);var n=a.kind||"contact";k=k?"/"+k:"";k=(l?"https":"http")+"://www.google.com/m8/feeds/"+n+"s/"+a.user_id.replace("@","%40")+"/"+m+k;k=k.replace("%40","@");if(l=(l=a.Ud("edit"))?l.href:void 0)g="delete"==rp(a.data)?"DELETE":"PUT",k=l;try{var p=vp(a)}catch(q){Ii({"class":"ydn.gdata.Entry",method:"ydn.gdata.Entry.commit","entry.data":a.data,
context:"toXmlString",error:{name:q.name,message:q.message,stack:q.stack}})}l=a.type;m=["atom","app","gd","batch","ydn"];if("sites"==l||"site"==l||"content"==l||"webpage"==l)m=m.concat("xhtml","sites");else if("m8"==l||"contact"==l)m=m.concat("gContact");p=dp(p,m);pp.g&&(a.h=[k,f,g,e,p]);d.request(new Vh(k,g,f,e,p)).execute(b,c)}else P(a.logger,a+" commit ignore since not modified."),b&&b.call(c,null,null)}function tp(a){if(null==a.id)return!0;a=rp(a);return"modified"===a||"delete"===a}h.se=function(){return this.data};
function vp(a){var b=new jp(null,"entry",a.se()),c=!1;b.xmlns||(b.xmlns="http://www.w3.org/2005/Atom",c=!0);var d=["atom"],e;for(e in a.data)if(a=e.match(/^(\w+)\$\w+/))a=a[1],a in cp&&(Va(d,a)||d.push(a));e=np(b);c&&delete b.xmlns;return dp(e,d)}h.update=function(a){var b=["batch$status","batch$operation","status"],c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Va(b,c)&&!Va(this.Nf,c)&&(this.data[c]=a.data[c])};h.Ve=function(a,b){if(wl(this.data[a],b))return!1;this.data[a]=Ol(b);return!0};
h.Ue=function(a){if(a.data.updated.$t>=this.data.updated.$t&&sp(a)){if(sp(this)||"delete"==rp(this.data))return!1;qp(this,"delete");return!0}var b=!1,c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Va(this.Nf,c)&&this.Ve(c,a.data[c])&&(b=!0);b&&(a=rp(this.data),"delete"==a?M(this.logger,this+" marked for deletion. Cannot mark modify flag."):"committed"==a?this.logger.log(Me,this+" already committed. All changes must wait until updated from the server.",void 0):qp(this,"modified"));return b};function wp(a,b,c){Io.call(this,a,b,c)}E(wp,Io);wp.prototype.Zd=function(){return this.key};wp.prototype.Yb=function(a,b,c,d){a=wp.m.Yb.call(this,a,b,c,d);this.g.ag(a.method)&&r.gapi&&r.gapi.auth&&(b=gapi.auth.getToken())&&b.access_token&&(a.headers.Authorization=b.token_type+" "+b.access_token);if("GET"==a.method)a.params.alt="json";else if("PUT"==a.method||"POST"==a.method)d=new pp(d),a.body=vp(d),a.headers["Content-Type"]="application/atom+xml";return a};
wp.prototype.te=function(a,b){a=wp.m.te.call(this,a,b);a.feed&&(a=a.feed);a.entry&&(a=a.entry);return a};function xp(a,b,c){Qo.call(this,a,b,c);a=c.Options;this.kind=a.kind;this.version=a.version;this.projection=a.projection;this.j=a.maxResults}E(xp,Zo);h=xp.prototype;h.projection=null;h.version=null;h.logger=R("ydn.db.sync.GData");h.qa=function(a,b){return new wp(this,a,b)};h.hb=function(){var a=xp.m.hb.call(this);a.key=["id","$t"];a.etag="gd$etag";a.updated=["updated","$t"];return a};h.ib=function(){var a=xp.m.ib.call(this);return a=a.concat(["version","projection","kind","maxResults"])};
h.ub=function(){return"https://www.googleapis.com/"+this.kind+"/"};h.ag=function(){return!1};h.F=function(a){return a?a.id?a.id.$t:"":""};
function yp(a,b,c){var d=c||a.ub();c&&Q(a.logger,"continuing "+c);b=new Vh(d,"GET",b);var e=new G;a.na().request(b).execute(function(b,d){if(200==d.L()){if(!b){var k=Ti(d);w(k)&&(b=JSON.parse(k))}var k=b.feed||b,l=k.entry,l=l?u(l)?l:[l]:[];0<l.length&&Lo(a,l);for(var l=null,k=k.link,k=u(k)?k:[k],m=0;m<k.length;m++)"next"==k[m].rel&&(l=k[m].href);l?nb(yp(a,{},l),e):(Q(a.logger,"prefetch "+a.M+" done"),e.t(!!c))}else 302==d.L()?e.t():(k=a+": Invalid response status "+d.L()+" on prefetching",M(a.logger,
k),e.u(Error(k)))});return e}h.Pb=function(){Q(this.logger,"starting prefetch");var a=new G;el(this.storage.g,this.M,"updated.$t",null,!0,1).D(function(b){var c={alt:"json",kind:this.kind};this.j&&(c["max-results"]=this.j);(b=b[0])?(b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b,Q(this.logger,this.M+" fetching entries later then "+b)):Q(this.logger,this.M+" fetching entries from beginning");nb(yp(this,c),a)},this);return a};
h.count=function(a){var b=Gj(this.i,"updated.$t");if(!b)return a;var c=Vj(a);a.w(function(a){Sc(c,a);el(this.storage.g,this.M,b.getName(),null,!1,1).w(function(b){var f={alt:"json"};if(b=u(b)?b[0]:b)b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),f["updated-min"]=b;var g=this,f=new Vh(this.ub(),"GET",f);this.na().request(f).execute(function(b,e){if(200==e.L()){if(!b){var f=Ti(e);w(f)&&(b=JSON.parse(f))}f=lc(b.feed,"openSearch$totalResults");c.t(a+parseFloat(f||0))}else M(g.logger,
g+":Unexpected respond status "+e.L())})},function(a){c.u(a)},this)},function(a){c.u(a)},this);return c};function zp(a,b,c){Io.call(this,a,b,c)}E(zp,wp);function Ap(a,b,c){xp.call(this,a,b,c);this.h=this.h.substr(27);this.Fb=c.Options.prefix}E(Ap,xp);Ap.prototype.na=function(){this.g||(this.g=new Bp(gapi.client));return this.g};Ap.prototype.qa=function(a,b){return new zp(this,a,b)};Ap.prototype.ub=function(){return this.h+this.Fb};
Ap.prototype.Pb=function(){Q(this.logger,"starting prefetch");var a=new G;el(this.storage.g,this.M,"updated",null,!0,1).w(function(b){var c={alt:"json"};if(b=b[0])b=lc(b,"updated"),b=(new Date(1+ +new Date(b))).toISOString(),c.updatedMin=b;var d=this,c=new Vh(this.ub(),"GET",c);d.na().request(c).execute(function(b,c){if(b){var g=b.items||[];0<g.length?Lo(d,g).aa(function(){a.t(!0)}):a.t(!1)}else 302==c.L()?a.t():(g=d+": Invalid response status "+c.L()+" on prefetching",M(d.logger,g),a.u(Error(g)))})},
function(b){a.u(b)},this);return a};function Cp(a,b){if(!s(r.AWS))throw new Pc("AWS JS SDK not loaded");this.h=a;this.i=b;this.g=null}Cp.prototype.request=function(a){return new Dp(this,a)};function Ep(a){var b={params:{Bucket:a.h,region:a.i}};if(!a.h)throw new L("bucket name required");a.g||(a.g=new AWS.S3(b));return a.g}function Dp(a,b){this.parent=a;this.g=b}
function Fp(a,b,c,d,e){var f=NaN,g="",k={};a=Ep(a.parent)[b](c);a.on("complete",function(a){a.httpResponse&&(f=a.httpResponse.statusCode,w(f)&&(f=parseInt(f,10)),k=a.httpResponse.headers);a.error&&(g=a.error.message,f||(f=400))});a.send(function(a,b){var c=new Ri(f,b,k,g);a?d.call(e,null,c):d.call(e,b,c)})}
Dp.prototype.execute=function(a,b){var c;c=(new od(this.g.path)).bc;c="/"==c.charAt(0)?c.substr(1):c;var d=this.g.headers||{};c&&(d.Key=c);if(c)if("GET"==this.g.method)Fp(this,"getObject",d,a,b);else if("PUT"==this.g.method)Fp(this,"putObject",d,a,b);else throw new Nc("HTTP method "+this.g.method);};function Gp(a,b){this.g=a;this.prefix=Hp(this,"Prefix")[0];this.h=b.type}Gp.prototype.ca=function(){return this.g.documentElement.getElementsByTagName("Contents").length};Gp.prototype.keys=function(){var a=Hp(this,"Key");if(this.prefix){var b=this.prefix.length,a=a.map(function(a){return a.substr(b)});"INTEGER"==this.h?a=a.map(function(a){return parseInt(a,10)}):"NUMERIC"==this.h&&(a=a.map(function(a){return parseFloat(a)}))}return a};
function Hp(a,b){for(var c=[],d=a.g.documentElement.getElementsByTagName(b),e=d.length,f=0;f<e;f++)c[f]=d[f].textContent;return c}function Ip(a){return Hp(a,"LastModified").map(function(a){return(new Date(Date.parse(a))).toGMTString()})}
function Jp(a){var b=a.g.documentElement.getElementsByTagName("NextMarker");return 1==b.length?b[0].textContent:"true"==a.g.documentElement.getElementsByTagName("IsTruncated")[0].textContent&&(a=a.g.documentElement.firstElementChild.lastElementChild)&&"Contents"==a.tagName?a.getElementsByTagName("Key")[0]:null};function Kp(a,b,c){Qo.call(this,a,b,c);this.j=c.Options.bucket;if(!w(this.j)||ta(this.j))throw new L("bucket name required.");this.h||(this.h="https://"+this.j+".s3.amazonaws.com/");if(!0===b.h)throw new L('S3 object store "'+b.getName()+'" must not set autoIncrement to true.');}E(Kp,Qo);h=Kp.prototype;h.logger=R("ydn.db.sync.S3");h.ib=function(){var a=Kp.m.ib.call(this);return a=a.concat(["bucket","maxKeys","prefix","delimiter"])};h.na=function(){this.g||(this.g=new Cp(this.j));return this.g};
h.Oe=function(a){return this.h+this.l+a};h.qa=function(a,b){return new ap(this,a,b)};
h.Te=function(a,b){var c=this;Xj(a,function(d,e,f){Sc(a,d);c.Ed(d,function(a){var e={},l=a[0]?Do(a[0]):null;null!=l&&(e.marker=l);0<c.l.length&&(e.prefix=c.l);0<b&&(e["max-keys"]=b);Q(c.logger,c+" querying for newer entries starting from "+l);e=new Vh(c.h,"GET",e);c.na().request(e).execute(function(b,e){if(200==e.L()){for(var k=Ti(e),k=k instanceof Document?k:sh(k),l=new Gp(k,c.i),k=l.keys(),l=Ip(l),t=[],x=[],z=[],D=0,F=0;D<=a.length&&F<k.length;){var J=a[D]?Do(a[D]):null,N=k[F];if(D==a.length)x.push(N),
F++;else{var fa=J?mj(J,N):-1;0==fa?((N=Eo(a[D]))&&l[F]&&N!=l[F]&&(l[F]>N?z.push(J):M(c.logger,'record "'+J+'" in database is more recent than server '+N+" vs "+l[F])),D++,F++):1==fa?(t.push(J),D++):(x.push(N),F++)}}Vo(c,f,d,x,z,t)}else M(c.logger,"Invalid response status "+e.L())})})},this)};
function Lp(a,b){function c(f){null!=f&&(d.marker=f);Q(a.logger,a+" querying for newer entries starting from "+f);e.request(new Vh(a.h,"GET",d)).execute(function(d,e){if(200==e.L()){var f=Ti(e),f=f instanceof Document?f:sh(f),f=new Gp(f,a.i),m=Jp(f),f=f.keys(),n=f.length;if(0==n)b([]),b=null;else for(var p=0,q=0;q<n;q++)a.qa(f[q]).cc(function(){p++;p==n&&(m?c(m):b&&(b([this.kb()]),b=null))})}else M(a.logger,"Invalid response status "+e.L())})}var d={};0<a.l.length&&(d.prefix=a.l);var e=a.na();c();
a.X=!0}function Mp(a,b){a.X||Xj(b,function(a,b,e){s(a[0])?e(a):Lp(this,e)},a)};function Np(a,b,c){Io.call(this,a,b,c)}E(Np,ap);Np.prototype.logger=R("ydn.db.sync.entry.Gcs");function Op(a,b,c){Kp.call(this,a,b,c);this.h="https://"+this.j+".storage.googleapis.com/"}E(Op,Kp);Op.prototype.logger=R("ydn.db.sync.Gcs");Op.prototype.na=function(){this.g||(this.g=new ao);return this.g};Op.prototype.qa=function(a,b){return new Np(this,a,b)};function Bp(a,b){this.h=a;this.g=!!b}Bp.prototype.request=function(a){var b={path:a.path,method:a.method,headers:a.headers,params:a.params,body:a.body};this.g&&(b.callback=function(a,e){c.t(a,e);b.callback=null});a=this.h.request(b);var c=new Pp(a);return c};function Pp(a){this.h=a||null}Pp.prototype.t=function(a,b){this.i&&(this.i(a,Wi(b)),this.i=null);this.g={json:a,qc:b}};
Pp.prototype.execute=function(a){this.h?(this.h.execute(function(b,c){a(b,Wi(c))}),this.h=null):this.g?(a(this.g.json,Wi(this.g.qc)),this.g=null):this.i=a};function Ro(a){if(a){if(a instanceof ao)return a;if(ha(a))return new Bp({request:function(b){a(b)}},!0);if("request"in a)return new Bp(a);throw new L(a+" is not a valid HTTP Client");}return null};function Qp(a,b,c){Io.call(this,a,b,c)}E(Qp,Np);Qp.prototype.logger=R("ydn.db.sync.entry.GcsJson");Qp.prototype.cc=function(a){var b=this.g,c=this;Mo(this,function(d){var e={method:"GET",path:"storage/v1beta2/b/"+b.j+"/o/"+encodeURIComponent(c.getName())};d&&(e.headers=Go(d));gapi.client.request(e).execute(function(d,e){var k=Wi(e);c.j=new Ho(c.F(),k.Cc(),b.o);d?(Q(c.logger,c+": readServer updated"),c.i=d):(Q(c.logger,c+": readServer request fail "+e),c.j=null,c.i=null);a.call(c,200)},e)})};function Rp(a,b,c){Op.call(this,a,b,c)}E(Rp,Op);h=Rp.prototype;h.logger=R("ydn.db.sync.GcsJson");h.hb=function(){var a=Rp.m.hb.call(this);a.key="name";return a};h.na=function(){if(!this.g)if(s(r.gapi))this.g=new Bp(gapi.client);else throw new Pc("gapi not loaded");return Rp.m.na.call(this)};h.qa=function(a,b){return new Qp(this,a,b)};
h.Pb=function(){P(this.logger,"starting prefetch");var a=new G;gl(this.storage.g,this.M,null,null,1,0,!0,!1).w(function(b){var c={bucket:this.j};(b=b[0])&&(c.marker=b);var d=this;if(!r.vg||r.vg.client)throw Error("gapi lib not loaded");gapi.client.load("storage","v1beta2",function(){var b=gapi.client.storage.objects.list({bucket:d.j});this.Fb&&(c.prefix=this.Fb);b.execute(function(b,c){if(b&&!b.error){var e=b.items||[];0<e.length?Lo(d,null,e).aa(function(){a.t(!0)}):a.t(!1)}else e=d+": "+c,M(d.logger,
e),a.u(Error(e))})})},function(b){a.u(b)},this);return a};function Sp(a,b,c){Op.call(this,a,b,c);this.N="full"}E(Sp,Op);h=Sp.prototype;h.logger=R("ydn.db.sync.GcsMeta");h.hb=function(){var a=Sp.m.hb.call(this);a.key="name";return a};h.na=function(){!this.g&&gapi&&(this.g=new Bp(gapi.client));return Sp.m.na.call(this)};h.qa=function(a,b){return new Qp(this,a,b)};
h.Pb=function(){P(this.logger,"starting prefetch");var a=new G;if(!r.gapi||!r.gapi.client)throw Error("gapi lib not loaded");var b=this;gapi.client.load("storage","v1beta2",function(){function c(e){e&&(d.pageToken=e);gapi.client.storage.objects.list(d).execute(function(e,g){if(e&&!e.error){var k=e.items||[];if(e.nextPageToken)Q(b.logger,"receiving "+k.length+" meta records, continuing next"),Lo(b,k),c(e.nextPageToken);else if(0<k.length)Lo(b,k).aa(function(){Q(b.logger,"receiving "+k.length+" meta records, prefetching dane.");
a.t(!0)});else{var l=!!d.pageToken;Q(b.logger,"prefetching done");a.t(l)}}else l=b+": "+g,M(b.logger,l),a.u(Error(l))})}var d={bucket:b.j};this.Fb&&(d.prefix=this.Fb);c()});return a};h.Ed=function(a,b){if(0==a.length)b([]);else{var c=this.A(),d=Qa(a,function(a){return new kk(c,a)});Uo(this,d).w(function(d){for(var f=[],g=0;g<a.length;g++)f[g]=new Co(a[g],d[g],this.o,c);b(f)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)}};function Tp(a,b,c){Qo.call(this,a,b,c)}E(Tp,Qo);Tp.prototype.Oe=function(a){return this.h+this.l+this.M+this.ra+a};Tp.prototype.logger=R("ydn.db.sync.Json");
Tp.prototype.Te=function(a){function b(a,b){var c=new Vh(e);d.na().request(c).execute(function(c){if(200==c.status){var e=(c.response instanceof Object?c.response:oh(c.responseText)).items;c=Qa(e,function(a){return a.id});for(var e=Qa(e,function(a){return a.updated}),k=[],p=[],q=[],t=0,x=0;t<=a.length&&x<c.length;){var z=Do(a[t]),D=c[x];if(t==a.length)p.push(D),x++;else{var F=mj(z,D);0==F?((D=Eo(a[t]))&&e[x]&&D!=e[x]&&(new Date(e[x])>D?q.push(z):M(d.logger,'record "'+z+'" in database is more recent than server '+
D+" vs "+e[x])),t++,x++):1==F?(k.push(z),t++):(p.push(D),x++)}}Vo(d,function(){},b,p,q,k)}else M(d.logger,"Invalid response status "+c.status)})}var c=new Rc,d=this,e=this.h+this.l+this.M;a.D(function(a){Sc(c,a);this.Ed(a,function(c){b(c,a)})},this)};function Up(a,b,c){Qo.call(this,a,b,c)}E(Up,Zo);function Vp(a,b,c){Io.call(this,a,b,c)}E(Vp,ap);Vp.prototype.logger=R("ydn.db.sync.entry.S3Meta");function Wp(a,b,c){Kp.call(this,a,b,c);this.Fb=c.Options.prefix;if("Key"!=b.keyPath)throw new L('s3-meta store "'+b.getName()+'" must use inline key with keyPath "Key"');this.N="meta"}E(Wp,Kp);h=Wp.prototype;h.logger=R("ydn.db.sync.S3Meta");h.hb=function(){var a=Wp.m.hb.call(this);a.key="Key";a.modified="LastModified";a.etag="ETag";return a};h.qa=function(a,b){return new Vp(this,a,b)};
h.Pb=function(){function a(f){f&&(e.marker=f);c.listObjects(e).send(function(c,f){if(c){var l=d+": "+ph(c);M(d.logger,l);b.u(c instanceof Error?c:Error(l))}else{var m=f.Contents||[];f.IsTruncated?(Q(d.logger,"receiving "+m.length+" meta records, continuing next"),Lo(d,m),a(m[m.length-1].Key+"\uffff")):0<m.length?Lo(d,m).aa(function(){Q(d.logger,"receiving "+m.length+" meta records, prefetching dane.");b.t(!0)}):(l=!!e.marker,Q(d.logger,"prefetching done"),b.t(l))}})}P(this.logger,"starting prefetch");
var b=new G,c=Ep(this.na()),d=this,e={};this.Fb&&(e.prefix=this.Fb);a();return b};h.Ed=function(){throw new Pc("loading meta data should not be necessary");};function Xp(a,b,c){Io.call(this,a,b,c)}E(Xp,wp);function Yp(a,b,c){xp.call(this,a,b,c);a=c.Options;this.domain=a.domain;this.X=a.siteName;if(a=Hj(b,"sites$parent"))xl(a,function(a){for(var b=a.link||[],c=0;c<b.length;c++)if("http://schemas.google.com/sites/2008#parent"==b[c].rel)return b[c].href;return a.id.$t.replace(/\w+$/,"0")}),O(this.logger,"index sites$parent in "+b.getName()+" has set a generator.");if(a=Hj(b,"alternate"))xl(a,function(a){a=a.link||[];for(var b=0;b<a.length;b++)if("alternate"==a[b].rel)return a[b].href}),O(this.logger,"index alternate in "+
b.getName()+" has set a generator.")}E(Yp,xp);h=Yp.prototype;h.qa=function(a,b){return new Xp(this,a,b)};h.ib=function(){var a=Yp.m.ib.call(this);return a=a.concat(["domain","siteName"])};h.ub=function(){return"https://sites.google.com/feeds/content/"+this.domain+"/"+this.X+"/"};h.ag=function(a){return"GET"!=a};
function Zp(a,b,c,d){var e={alt:"json",kind:a.kind};"sites$parent"==c?(c=d.match(/\w+$/)[0],e.parent=c):"alternate"==c&&(c=d.replace(/https:\/\/sites.google.com\/a\/[^\/]+\/[^\/]+/,""),e.path=c);var f={},g=a.ub();Xj(b,function(c,l,m){Sc(b,c);if(l=c[0])l=lc(l,"updated","$t"),l=(new Date(1+ +new Date(l))).toISOString(),e["updated-min"]=l;l=new Vh(g,"GET",e,f);a.na().request(l).execute(function(b,e){if(200==e.L()){if(!b){var f=Ti(e);w(f)&&(b=JSON.parse(f))}var g=(f=(b.feed||b).entry)?u(f)?f:[f]:[];0<
g.length?Lo(a,g).aa(function(){m(g)}):m(c)}else 302==e.L()?m(c):(f=a+": Invalid response status "+e.L()+" for querying pageName: "+d,M(a.logger,f),m(Error(f),!0))})},a)}h.re=function(a,b,c){if(Xo(this))Xj(a,function(d,e,f){Sc(a,d);Yo(this,function(a){!0===a?el(this.storage.g,this.M,b,T.only(c),!1,0).w(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(a){f(a,!0)},this)},this);else return"alternate"==b||"alternate"==b?Zp(this,a,b,c):Yp.m.re.call(this,a,b,c)};Ek.prototype.g=null;
dm.prototype.uf=function(a,b){var c=b.format;if("gdata-sites"==c)a.g=new Yp(this,a,b);else if("gdata"==c)a.g=new xp(this,a,b);else if("gdata-json"==c)a.g=new Ap(this,a,b);else if("odata"==c)a.g=new Up(this,a,b);else if("s3"==c)a.g=new Kp(this,a,b);else if("s3-meta"==c)a.g=new Wp(this,a,b);else if("gcs"==c)a.g=new Op(this,a,b);else if("gcs-json"==c)a.g=new Rp(this,a,b);else if("gcs-meta"==c)a.g=new Sp(this,a,b);else if("atom"==c)a.g=new Zo(this,a,b);else if("json"==c)a.g=new Tp(this,a,b);else if("rest"==
c)a.g=new Qo(this,a,b);else throw new Nc("Sync format: "+c);Gl(a,function(b,c){var f=b.qd();if(!(this instanceof Ck)||this.Sa)if(!window.navigator||!s(window.navigator.onLine)||window.navigator.onLine)if("add"==f)f=c[1],a.g.add(b,f);else if("count"==f)c[1]||c[2]||a.g.count(b);else if("put"==f){var f=c[1],g=c[2];a.g.put(b,f,g)}else if("rm:iter"==f)g=c[1],a.g.remove(b,g);else if("values:iter:index"==f){var f=c[1],g=c[2],k=c[3],l=c[4],m=c[5];!k&&!m&&g&&null!=g.lower&&null!=g.upper&&0==mj(g.lower,g.upper)&&
a.g.re(b,f,g.lower)}else if("keys"==f)g=c[1],l=c[2],k=c[3],m=c[4],a.g.keys(b,null,g,l,k,m,!1);else if("keys:iter:index"==f)f=c[1],g=c[2],l=c[3],k=c[4],m=c[5],a.g.keys(b,f,g,l,k,m,c[6]);else if("values"==f)g=c[1],l=c[2],k=c[3],m=c[4],g||m?g&&g.lower&&w(g.lower)&&g.lower==g.upper||!g&&m&&1==l&&k&&Mp(a.g,b):a.g.values(b,l,k);else if(""!=f)if("get"==f)g=c[1],a.g.get(b,g);else if("values:array"==f)Wo(a.g,b,c[1]);else throw Error(f);})};var $p="Accounts Contacts Employees Leads Opportunities Tasks Teams TeamSets Users".split(" "),aq="Accounts Contacts Leads Opportunities Tasks Teams".split(" ");function bq(a){this.h=a||[]}bq.prototype.g=function(a){return-1==this.h.indexOf(a)?a:null};function cq(){}
cq.prototype.g=function(a){var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};a=a.toLowerCase();var d,e,f=a;if(3>a.length)return a;var g,k;a=a.substr(0,1);"y"==a&&(f=a.toUpperCase()+f.substr(1));g=/^(.+?)(ss|i)es$/;e=/^(.+?)([^s])s$/;
g.test(f)?f=f.replace(g,"$1$2"):e.test(f)&&(f=f.replace(e,"$1$2"));g=/^(.+?)eed$/;e=/^(.+?)(ed|ing)$/;g.test(f)?(e=g.exec(f),g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(e[1])&&(g=/.$/,f=f.replace(g,""))):e.test(f)&&(e=e.exec(f),d=e[1],e=/^([^aeiou][^aeiouy]*)?[aeiouy]/,e.test(d)&&(f=d,e=/(at|bl|iz)$/,k=/([^aeiouylsz])\1$/,d=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,e.test(f)?f+="e":k.test(f)?(g=/.$/,f=f.replace(g,"")):d.test(f)&&(f+="e")));g=/^(.+?)y$/;g.test(f)&&(e=g.exec(f),
d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy]/,g.test(d)&&(f=d+"i"));g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+b[e]));g=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+c[e]));g=
/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;e=/^(.+?)(s|t)(ion)$/;g.test(f)?(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d)):e.test(f)&&(e=e.exec(f),d=e[1]+e[2],e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,e.test(d)&&(f=d));g=/^(.+?)e$/;g.test(f)&&(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,g.test(d)||e.test(d)&&!k.test(d))&&(f=d);g=/ll$/;e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;g.test(f)&&e.test(f)&&(g=/.$/,f=f.replace(g,""));"y"==a&&(f=a.toLowerCase()+f.substr(1));return f};function dq(a){this.h=a}
dq.prototype.g=function(a){a=a.toLowerCase();a=a.replace(/([^c])\1/g,"$1");a=function(a){return a.match(/^(kn|gn|pn|ae|wr)/)?a.substr(1,a.length-1):a}(a);a=a.replace(/mb$/,"m");a=a.replace(/ck/g,"k");a=function(a){a=a.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim();a=a.replace(/cia/g,"xia");a=a.replace(/c(i|e|y)/g,"s$1");return a=a.replace(/c/g,"k")}(a);a=function(a){a=a.replace(/d(ge|gy|gi)/g,"j$1");return a=a.replace(/d/g,"t")}(a);a=function(a){a=a.replace(/gh(^$|[^aeiou])/g,"h$1");return a=a.replace(/g(n|ned)$/g,
"$1")}(a);a=function(a){a=a.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3");a=a.replace(/gg/g,"g");return a=a.replace(/g/g,"k")}(a);a=a.replace(/([aeiou])h([^aeiou])/g,"$1$2");a=a.replace(/ph/g,"f");a=a.replace(/q/g,"k");a=a.replace(/s(h|io|ia)/g,"x$1");a=function(a){a=a.replace(/^x/,"s");return a=a.replace(/x/g,"ks")}(a);a=function(a){a=a.replace(/t(ia|io)/g,"x$1");return a=a.replace(/th/,"0")}(a);a=a.replace(/tch/g,"ch");a=a.replace(/v/g,"f");a=a.replace(/^wh/,"w");a=a.replace(/w([^aeiou]|$)/g,"$1");a=a.replace(/y([^aeiou]|$)/g,
"$1");a=a.replace(/z/,"s");a=a.charAt(0)+a.substr(1,a.length).replace(/[aeiou]/g,"");a.length>=this.h&&(a=a.substring(0,this.h));return a=a.toUpperCase()};var eq=new dq(32),fq=new cq,gq=new bq("a a's able about above according accordingly across actually after afterwards again against ain't all allow allows almost alone along already also although always am among amongst an and another any anybody anyhow anyone anything anyway anyways anywhere apart appear appreciate appropriate are aren't around as aside ask asking associated at available away awfully b be became because become becomes becoming been before beforehand behind being believe below beside besides best better between beyond both brief but by c c'mon c's came can can't cannot cant cause causes certain certainly changes clearly co com come comes concerning consequently consider considering contain containing contains corresponding could couldn't course currently d definitely described despite did didn't different do does doesn't doing don't done down downwards during e each edu eg eight either else elsewhere enough entirely especially et etc even ever every everybody everyone everything everywhere ex exactly example except f far few fifth first five followed following follows for former formerly forth four from further furthermore g get gets getting given gives go goes going gone got gotten greetings h had hadn't happens hardly has hasn't have haven't having he he's hello help hence her here here's hereafter hereby herein hereupon hers herself hi him himself his hither hopefully how howbeit however i i'd i'll i'm i've ie if ignored immediate in inasmuch inc indeed indicate indicated indicates inner insofar instead into inward is isn't it it'd it'll it's its itself j just k keep keeps kept know knows known l last lately later latter latterly least less lest let let's like liked likely little look looking looks ltd m mainly many may maybe me mean meanwhile merely might more moreover most mostly much must my myself n name namely nd near nearly necessary need needs neither never nevertheless new next nine no nobody non none noone nor normally not nothing novel now nowhere o obviously of off often oh ok okay old on once one ones only onto or other others otherwise ought our ours ourselves out outside over overall own p particular particularly per perhaps placed please plus possible presumably probably provides q que quite qv r rather rd re really reasonably regarding regardless regards relatively respectively right s said same saw say saying says second secondly see seeing seem seemed seeming seems seen self selves sensible sent serious seriously seven several shall she should shouldn't since six so some somebody somehow someone something sometime sometimes somewhat somewhere soon sorry specified specify specifying still sub such sup sure t t's take taken tell tends th than thank thanks thanx that that's thats the their theirs them themselves then thence there there's thereafter thereby therefore therein theres thereupon these they they'd they'll they're they've think third this thorough thoroughly those though three through throughout thru thus to together too took toward towards tried tries truly try trying twice two u un under unfortunately unless unlikely until unto up upon us use used useful uses using usually uucp v value various very via viz vs w want wants was wasn't way we we'd we'll we're we've welcome well went were weren't what what's whatever when whence whenever where where's whereafter whereas whereby wherein whereupon wherever whether which while whither who who's whoever whole whom whose why will willing wish with within without won't wonder would wouldn't x y yes yet you you'd you'll you're you've your yours yourself yourselves z zero".split(" "));function hq(a){this.data=a;this.h=0}hq.prototype.g=function(a){for(var b=this.h,c=this.data[b],c=1,d=0;0<=b&&b<this.data.length;){c=this.data[b];if(c instanceof Array)if(a<c[0])c=-1;else if(a>c[1])c=1;else return this.h=b,!0;else{if(c==a)return this.h=b,!0;c=a<c?-1:1}if(0==d)d=c;else if(d!=c)break;b+=c;if(b>this.data.length||0>b)break}return!1};
function iq(a,b){for(var c=0,d=0,e=a.length,f=0;f<e;++f){a:{var d=a.charCodeAt(f),g=new hq(categ_letters_numbers_data);if(y(d))d=g.g(d);else{for(var k=0,l=d.length;k<l;++k)if(!1===g.g(d[k])){d=!1;break a}d=!0}}d||((d=f-c)&&b(c,d),c=f+1)}(d=e-c)&&b(c,d)};function jq(a,b){this.j=b;this.value=a}jq.prototype.Q=function(){return this.value};jq.prototype.jb=function(){return 1};var kq=!Ib&&(Jh||Gh);jq.prototype.F=function(){return this.value};jq.prototype.toString=function(){return"Entry:"+this.value};function lq(a,b,c,d,e,f){jq.call(this,d,e);this.M=a;this.h=b;this.i=c;this.Fd=f||[]}E(lq,jq);h=lq.prototype;h.Tc=function(){return{k:this.j,v:this.value.toLowerCase(),id:this.F(),loc:this.Fd}};h.F=function(){var a=[this.M,this.i,this.h,this.value];return kq?a:rj(a)};h.A=function(){return this.M};h.da=function(){return this.i};h.toString=function(){return["IndexEntry",this.M,this.i,this.value].join(":")};function mq(a,b,c,d,e){jq.call(this,b,c);this.l=d;this.g=e;this.type=a;this.wf=1}E(mq,jq);mq.prototype.jb=function(){return this.g*this.type*this.wf};mq.prototype.F=function(){return this.value+"|"+this.l};function nq(a,b){lq.call(this,b.A(),b.h,b.da(),b.Q(),b.j,[]);this.n=a;this.g=[b]}E(nq,lq);h=nq.prototype;h.count=function(){return this.g.length};h.entry=function(a){return this.g[a]};h.Ue=function(a){a=a.g[0];for(var b=0;b<this.g.length;b++)if(this.g[b].h==a.h&&this.g[b].value==a.value)return;this.g.push(a)};h.jb=function(){for(var a=0,b=0;b<this.g.length;b++)var c=this.g[b],d=Jl(this.n,c.A(),c.h),c=c.jb(),a=a+c*d.h;return a};function gb(a,b){var c=a.jb(),d=b.jb();return c<=d?1:-1}
h.Tc=function(){for(var a={value:this.value,primaryKey:this.i,storeName:this.M,score:this.jb(),tokens:[]},b=0;b<this.g.length;b++)a.tokens[b]=this.g[b].Tc();return a};h.toString=function(){return["RankEntry",this.M,this.i,this.value].join(":")+"["+this.g.length+"]"};function oq(a){var b=[],c;a=a.split(/\s+/);for(var d=0;d<a.length;d++){c=a[d];for(var e=c.length-1,f=Array(e),g=0;g<e;g++)f[g]=c.substring(g,g+2);c=f;b.push.apply(b,c)}return b};function Yk(a,b,c,d,e,f,g){lq.call(this,b,c,d,e,f,g);this.query=a}E(Yk,lq);Yk.prototype.jb=function(){var a,b=this.value;a=oq(this.query.value.toLowerCase().replace(/^\s+|\s+$/g,""));var b=oq(b.toLowerCase().replace(/^\s+|\s+$/g,"")),c=0,d=a.length+b.length,e,f,g,k;for(e=0;e<a.length;e++)for(g=a[e],f=0;f<b.length;f++)if(k=b[f],g==k){c++;delete b[f];break}a=2*c/d;b=Math.log(this.Fd.length+1);c=this.query.jb();return b*a*c};Yk.prototype.Tc=function(){return{keyPath:this.h,value:this.value,loc:this.Fd.slice()}};
Yk.prototype.toString=function(){return["ResultEntry",this.M,this.i,this.value].join(":")};function pq(a,b){this.g=a;this.h=b;this.j=[];this.i=0}function Wk(a,b){for(var c,d,e=a.g.getName(),f=0;f<a.h.length;f++){var g=a.h[f],k=g.type;0.4==k||0.6==k?(d="v",c=g.Q().toLowerCase(),c=gj(c)):(d="v",c=g.Q().toLowerCase(),c=T.only(c));b(e,d,c,g);a.i++;0.6==k&&(d="k",c=g.j,c=T.only(c),b(e,d,c,g),a.i++)}}function Vk(a){for(var b=[a.g.getName()],c=0;c<a.g.count();c++){var d=a.g.index(c).A();-1==b.indexOf(d)&&b.push(d)}return b}
function Zk(a){for(var b=[],c=[],d=0;d<a.j.length;d++){var e=a.j[d];if(0==e.query.type)-1==Ua(c,function(a){return a.da()==e.da()&&a.A()==e.A()})&&c.push(e);else{var f=new nq(a.g,e),g=Ua(b,function(a){return a.da()==f.da()&&a.A()==f.A()});if(0<=g){var k=b[g];Ma.splice.call(b,g,1);k.Ue(f);f=k}fb(b,f)}}for(a=0;a<c.length;a++)for(g=c[a],d=b.length-1;0<=d;--d)if(k=b[d],g.da()==k.da()&&g.A()==k.A()){b.splice(a,1);break}return b.map(function(a){return a.Tc()})};function qq(a){this.g=a;if("en"==a.lang){a=a.h||["stop","stemmer","metaphone"];for(var b=[],c=0;c<a.length;c++)if("metaphone"==a[c])b.push(eq);else if("stemmer"==a[c])b.push(fq);else if("stop"==a[c])b.push(gq);else throw Error('Invalid normalizer "'+a[c]+'" for English lang');a=b}else a=[];this.h=a}function rq(a,b){for(var c=0;c<a.h.length;c++){var d=a.h[c].g(b);if(d)b=d;else return null}return b}qq.prototype.parse=function(a){var b=[];iq(a,function(c,d){b.push(a.substr(c,d))});return b};
qq.prototype.query=function(a,b){var c=sq(this,b);return 0==c.length?null:new pq(this.g,c)};
function sq(a,b){var c=[],d=[];iq(b,function(a,e){c.push(b.substr(a,e));d.push(a)});for(var e=[],f=0;f<c.length;f++)e[f]=rq(a,c[f]);for(var g=[],k=0,f=0;f<c.length;f++){var l=c[f],m=e[f],n="*"==b.charAt(d[f]+l.length),p=n?d[f]+l.length+1:d[f]+l.length,p='"'==b.charAt(d[f]-1)&&'"'==b.charAt(p),q="-"==b.charAt(p?d[f]-2:d[f]-1),t=0.8;n?t=0.4:p?t=1:q?t=0:null!=m&&(t=0.6);l=new mq(t,l,m,d[f],1/(f+2));g.push(l);k+=l.jb()}for(f=0;f<g.length;++f)g[f].wf=1/k;return g}
function tq(a,b,c,d){var e=[],f=[];iq(b,function(a,c){e.push(b.substr(a,c));f.push(a)});for(var g=[],k=0;k<e.length;k++)g[k]=rq(a,e[k]);a=c.A();c=c.g;for(var l=[],k=0;k<e.length;k++){var m=e[k],n=g[k];if(null!=n){var p=Ta(l,function(a){return a.Q()==m});p||(p=new lq(a,c,d,m,n),l.push(p));p.Fd.push(f[k])}}return l}function uq(a,b,c,d){for(var e=[],f=0;f<a.g.count();f++){var g=a.g.index(f);if(g.A()==b){var k=oj(d,g.g);w(k)&&(e=e.concat(tq(a,k,g,c)))}}return e};dm.prototype.tf=function(a,b){var c=this;b.g=new qq(b);Gl(a,function(d,e){function f(b){var e=a.getName();Xj(d,function(a,f,g){if(f)g(a,f);else{Sc(d,a);var k=new kk(e,b);cl(c.g,[k]).aa(function(){g(a,f)})}})}function g(b){var e=a.getName();Xj(d,function(a,f,g){f?g(a,f):(Sc(d,a),b&&(b=ej(T.bound([e,b.lower],[e,b.upper,"\uffff"]))),dl(c.g,e,b).aa(function(){g(a,f)}))})}function k(e){var f=a.getName();Xj(d,function(a,g,k){Sc(d,a);if(g)k(a,g);else{var l=b.getName();u(a)||(a=[a]);for(var z=0;z<a.length;z++){var D=
a[z];mk(D)&&(D=uq(b.g,f,D,e[z]).map(function(a){return a.Tc()}),D=bl(c.g,l,D),z==a.length-1&&D.aa(function(){k(a,g)}))}}})}var l=d.qd();"put"==l?k([e[1]]):"put:array"==l?k(e[1]):"add"==l?k([e[1]]):"add:array"==l?k(e[1]):"rm:iter"==l||"clear"==l?g(e[1]):"rm"==l&&f(e[1])})};
dm.prototype.search=function(a,b,c,d){var e=Nl(this.h,a);if(!e)throw new L('full text index catalog "'+a+'" not found.');a=e.g.query(a,b,c,d);return a?this.g.search(a):(P(this.logger,'query "'+b+'" contains only noise and search is ignored'),Yj("search",null))};function vq(a){this.name=a;this.info=null;this.h={};this.g=null}
var wq={Accounts:{GeneratorIndex:{ydn$emails:["email","email1","email_addresses_non_primary"],ydn$phones:["phone_office","phone_alternate","phone_fax"]}},Contacts:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Leads:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home",
"phone_mobile","phone_work","phone_other","phone_fax"]}}};function xq(a,b,c){var d=((a.h[b]||wq[b]||{}).GeneratorIndex||{})[c];return!d||u(d)&&0==d.length?null:"ydn$emails"==c?{name:c,multiEntry:!0,generator:function(a){var b=[],c;for(c in a)if(0<=d.indexOf(c)){var k=cn(a[c]);k&&b.push(k)}return b}}:"ydn$phones"==c?{name:c,multiEntry:!0,generator:function(a){var b=[],c;for(c in a)if(0<=d.indexOf(c)){var k=bn(a[c]);k&&b.push(k)}return b}}:null}
function yq(a,b){if(a.g)for(var c=0;c<a.g.stores.length;c++)if(a.g.stores[c].name==b)return a.g.stores[c];for(var d={name:b,keyPath:"id",indexes:[{name:"account_id"},{name:"name"},{name:"date_modified"}]},e=["ydn$emails","ydn$phones","ydn$names"],c=0;c<e.length;c++){var f=xq(a,b,e[c]);f&&d.indexes.push(f)}return d}
function zq(a){if(a.g)return a.g;for(var b={fullTextCatalogs:[],stores:[{name:"history",indexes:[{keyPath:"type"},{keyPath:"timestamp"}]},{name:"Meta"}]},c=0;c<aq.length;c++){var d=aq[c];b.stores.push(yq(a,d));var e=a.h[d]||wq[d]||{};if(e.FullTextIndex)for(var f in e.FullTextIndex){var g=e.FullTextIndex[f];if(0<g.length){for(var k={name:"ft-"+d+"-"+f,lang:"en",sources:[]},l=0;l<g.length;l++)k.sources.push({storeName:d,keyPath:g[l]});b.fullTextCatalogs.push(k)}}}a.g=b;Object.freeze(a.g);return a.g}
;function Aq(a,b,c){this.domain=a;this.W=b;this.g=c||null}Aq.prototype.F=function(){return this.g.id};Aq.prototype.value=function(a){return this.g?this.g[a]:null};Aq.prototype.toString=function(){return"Record:"+this.W+":"+(this.g?this.g.id:void 0)};function Bq(a,b,c){var d=0;if(!b)return d;b.gd$city&&a[c+"_address_city"]!=b.gd$city.$t&&(a[c+"_address_city"]=b.gd$city.$t,d++);b.gd$country&&a[c+"_address_country"]!=b.gd$country.$t&&(a[c+"_address_country"]=b.gd$country.$t,d++);b.gd$postcode&&a[c+"_address_postalcode"]!=b.gd$postcode.$t&&(a[c+"_address_postalcode"]=b.gd$postcode.$t,d++);b.gd$region&&a[c+"_address_state"]!=b.gd$region.$t&&(a[c+"_address_state"]=b.gd$region.$t,d++);b.gd$street&&a[c+"_address_street"]!=b.gd$street.$t&&(a[c+"_address_street"]=
b.gd$street.$t,d++);b.gd$housename&&a[c+"_address_street_2"]!=b.gd$neighborhood.$t&&(a[c+"_address_street_2"]=b.gd$neighborhood.$t,d++);b.gd$neighborhood&&a[c+"_address_street_3"]!=b.gd$city.$t&&(a[c+"_address_street_3"]=b.gd$city.$t,d++);return d}
function Cq(a,b,c){function d(d,g){!a[c+g]||b[d]&&b[d].$t==a[c+g]||(e++,b[d]={$t:a[c+g]})}var e=0;if(!a)return 0;b||(b={});d("gd$city","_address_city");d("gd$country","_address_country");d("gd$postcode","_address_postalcode");d("gd$region","_address_state");d("gd$street","_address_street");d("gd$neighborhood","_address_street_2");d("gd$city","_address_street_3");return e}
function Dq(a,b){var c=0;!a.title||b.name&&b.name==a.title.$t||(b.name=a.title.$t,c++);for(var d=0;a.gd$email&&d<a.gd$email.length;d++){var e=a.gd$email[d];"http://schemas.google.com/g/2005#work"==e.rel?b.email1!=e.address&&(c++,b.email1=e.address):"http://schemas.google.com/g/2005#home"==e.rel?b.email2!=e.address&&(c++,b.email2=e.address):"http://schemas.google.com/g/2005#other"==e.rel&&b.email!=e.address&&(c++,b.email=e.address)}a.gd$name?(a.gd$name.gd$namePrefix&&b.salutation!=a.gd$name.gd$namePrefix.$t&&
(c++,b.salutation=a.gd$name.gd$namePrefix.$t),a.gd$name.gd$givenName&&b.first_name!=a.gd$name.gd$givenName.$t&&(b.first_name=a.gd$name.gd$givenName.$t,c++),a.gd$name.gd$familyName&&b.last_name!=a.gd$name.gd$familyName.$t&&(b.last_name=a.gd$name.gd$familyName.$t,c++),a.gd$name.gd$fullName&&b.full_name!=a.gd$name.gd$fullName.$t&&(b.full_name=a.gd$name.gd$fullName.$t,c++)):b.full_name=a.title.$t;a.gd$organization&&a.gd$organization[0]&&(d=a.gd$organization[0],d.gd$orgTitle&&d.gd$orgTitle.$t!=b.title&&
(b.title=d.gd$orgTitle.$t,c++),d.gd$orgDepartment&&d.gd$orgDepartment.$t!=b.department&&(b.department=d.gd$orgDepartment.$t,c++),d.gd$orgJobDescription&&d.gd$orgJobDescription.$t!=b.description&&(b.description=d.gd$orgJobDescription.$t,c++));if(a.gd$im)for(d=0;d<a.gd$im.length;d++)"Twitter"==a.gd$im[d].label&&b.twitter!=a.gd$im[d].address?(b.twitter=a.gd$im[d].address,c++):"Facebook"==a.gd$im[d].label&&b.facebook!=a.gd$im[d].address?(b.facebook=a.gd$im[d].address,c++):"Google Plus"==a.gd$im[d].label&&
b.googleplus!=a.gd$im[d].address?(b.googleplus=a.gd$im[d].address,c++):"Linkedin"==a.gd$im[d].label&&b.linkedin!=a.gd$im[d].address&&(b.linkedin=a.gd$im[d].address,c++);a.gContact$birthday&&b.birthdate!=a.gContact$birthday.when&&(b.birthdate=a.gContact$birthday.when,c++);for(d=0;a.gd$phoneNumber&&d<a.gd$phoneNumber.length;d++)if(e=a.gd$phoneNumber[d],e.$t)if("http://schemas.google.com/g/2005#mobile"==e.rel)b.phone_mobile!=e.$t&&(b.phone_mobile=e.$t,c++);else if("http://schemas.google.com/g/2005#work"==
e.rel)b.phone_work!=e.$t&&(b.phone_work=e.$t,c++);else if("http://schemas.google.com/g/2005#home"==e.rel)b.phone_home!=e.$t&&(b.phone_home=e.$t,c++);else if("http://schemas.google.com/g/2005#fax"==e.rel||"http://schemas.google.com/g/2005#home_fax"==e.rel||"http://schemas.google.com/g/2005#work_fax"==e.rel)b.phone_fax!=e.$t&&(b.phone_fax=e.$t,c++);else if(b.phone_other=e.$t)b.phone_other=e.$t,c++;if(a.gd$structuredPostalAddress){for(var f=e=-1,d=0;d<a.gd$structuredPostalAddress.length;d++){var g=a.gd$structuredPostalAddress[d];
"http://schemas.google.com/g/2005#work"==g.rel||g.primary?e=d:f=d}-1==e&&(f=-1);c+=Bq(b,a.gd$structuredPostalAddress[e],"primary");c+=Bq(b,a.gd$structuredPostalAddress[f],"alt")}return c}
function Eq(a,b){function c(a,c){if(g[a]){b.gd$phoneNumber||(b.gd$phoneNumber=[]);var d;a:{for(d=0;b.gd$phoneNumber&&d<b.gd$phoneNumber.length;d++)if(b.gd$phoneNumber[d].rel==c){d=b.gd$phoneNumber[d];break a}d=null}d?d.$t!=g[a]&&(d.$t=g[a],k++):(b.gd$phoneNumber.push({rel:c,$t:g[a]}),k++)}}function d(a){b.gd$im||(b.gd$im=[]);for(var c=0;c<b.gd$im.length;c++)if(b.gd$im[c].label==a)return b.gd$im[c];return null}function e(){b.gd$name||(b.gd$name={},k++)}function f(a,c){if(g[a]){b.gd$email||(b.gd$email=
[]);var d;a:{for(d=0;b.gd$email&&d<b.gd$email.length;d++)if(!(0<=l.indexOf(d))&&b.gd$email[d].address==g[a])break a;d=-1}if(0<=d){var e=b.gd$email[d];e.rel!=c&&(k++,e.rel=c);l.push(d)}else b.gd$email.push({rel:c,address:g[a]}),l.push(b.gd$email.length-1),k++}}var g=a.g,k=0;!g.name||b.title&&b.title.$t==g.name||(b.title={$t:g.name},k++);var l=[];f("email1","http://schemas.google.com/g/2005#work");f("email2","http://schemas.google.com/g/2005#home");f("email","http://schemas.google.com/g/2005#other");
g.salutation&&(e(),b.gd$name.gd$namePrefix&&b.gd$name.gd$namePrefix.$t==g.salutation||(b.gd$name.gd$namePrefix={$t:g.salutation},k++));g.first_name&&(e(),b.gd$name.gd$givenName&&b.gd$name.gd$givenName.$t==g.first_name||(b.gd$name.gd$givenName={$t:g.first_name},k++));g.last_name&&(e(),b.gd$name.gd$familyName&&b.gd$name.gd$familyName.$t==g.last_name||(b.gd$name.gd$familyName={$t:g.last_name},k++));g.full_name&&(e(),b.gd$name.gd$fullName&&b.gd$name.gd$fullName.$t==g.full_name||(b.gd$name.gd$fullName=
{$t:g.full_name},k++));if(g.twitter){var m=d("Twitter");m?m.address!=g.twitter&&(m.address=g.twitter,k++):(b.gd$im.push({label:"Twitter",address:g.twitter}),k++)}g.facebook&&((m=d("Facebook"),m)?m.address!=g.facebook&&(m.address=g.facebook,k++):(b.gd$im.push({label:"Facebook",address:g.facebook}),k++));g.googleplus&&((m=d("Google Plus"),m)?m.address!=g.googleplus&&(m.address=g.googleplus,k++):(b.gd$im.push({label:"Google Plus",address:g.googleplus}),k++));g.linkedin&&((m=d("Linkedin"),m)?m.address!=
g.linkedin&&(m.address=g.linkedin,k++):(b.gd$im.push({label:"Linkedin",address:g.linkedin}),k++));!g.birthdate||b.gContact$birthday&&b.gContact$birthday.when==g.birthdate||(b.gContact$birthday={when:g.birthdate},k++);c("phone_mobile","http://schemas.google.com/g/2005#mobile");c("phone_work","http://schemas.google.com/g/2005#work");c("phone_home","http://schemas.google.com/g/2005#home");c("phone_fax","http://schemas.google.com/g/2005#work_fax");c("phone_other","http://schemas.google.com/g/2005#other");
for(var n=-1,m=-1,p=0;b.gd$structuredPostalAddress&&p<b.gd$structuredPostalAddress.length;p++)-1==n&&"true"==b.gd$structuredPostalAddress[p].primary||"http://schemas.google.com/g/2005#work"==b.gd$structuredPostalAddress[p].rel?n=p:-1==m&&(m=p);-1==n&&0<=m&&(n=m,b.gd$structuredPostalAddress[n].primary="true",m=-1);0<=n?k+=Cq(g,b.gd$structuredPostalAddress[n],"primary"):(n={primary:"true",rel:"http://schemas.google.com/g/2005#work"},p=Cq(g,n,"primary"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=
[]),b.gd$structuredPostalAddress.push(n),k+=p));0<=m?k+=Cq(g,b.gd$structuredPostalAddress[m],"alt"):(n={},p=Cq(g,n,"alt"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=[]),b.gd$structuredPostalAddress.push(n),k+=p));return k};function Fq(a){if(u(a))return a.map(function(a){return Fq(a)});if(A(a)){var b={},c;for(c in a.name_value_list)b[c]=a.name_value_list[c].value;return b}throw Error("Invalid name_value_entries");};function Gq(a,b,c,d,e){c=ra(c,"http")?new od(c):pd(qd(new od,c),"https");ud(c,"");td(c,null);this.i=c.wb;this.I=b;this.C=c.toString().replace(/\/$/,"");this.N=this.C+"/service/v4/rest.php";this.j=d;this.n=e;this.g=null;this.l=a;this.S=new vq(this.i);this.db=new Mn(this.i,zq(this.S));this.h=null;this.o=this.p=NaN;this.B=!1;this.history=new uo(this.db)}E(Gq,Vn);h=Gq.prototype;
h.request=function(a,b,c,d,e,f){function g(){m.execute(function(g,k){this.p=C();if(!f&&g&&11==g.number)this.Kc().w(function(){this.request(a,b,c,d,e,!0)},function(){d.call(e,null,new Ri(0,null,{},"Login fail"))},this);else{var l=g;if(w(l))try{g=JSON.parse(l)}catch(m){}d.call(e,g,k)}},this)}for(var k="{",l=0;l<b.length;l++)k+=(0==l?"":",")+'"'+b[l]+'":'+JSON.stringify(c[l]);k+="}";l=new vd;l.add("method",a);l.add("input_type","json");l.add("response_type","json");l.add("rest_data",k);mo();var m=this.l.request(new Vh(this.N,
"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},l.toString())),k=C()-this.p;0<k&&100>k?(this.p=100+this.p,Q(this.logger,"request will call after "+k+" ms."),ef(g,k,this)):g.call(this)};
function Hq(a,b,c){var d=["session","module_name"];a=[a.g?a.g.id:null,c.module_name];var e=[!1,!1];if("get_entry_list"==b)b=c.query||"",d.push("query"),a.push(b),e.push(""==b),d.push("order_by"),b=c.order_by||"",a.push(b),e.push(""==b),b=c.offset||0,d.push("offset"),a.push(b),e.push(0==b),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length),b=c.max_results||25,d.push("max_results"),
a.push(b),e.push(null!=c.max_results),b=c.deleted||0,d.push("deleted"),a.push(b),e.push(0==b),c=!!c.favorites,d.push("favorites"),a.push(c),e.push(!1==c);else if("get_available_modules"==b)c=c.filter||"",d.push("filter"),a.push(c),e.push(0==c.length);else if("get_module_fields"==b)c=c.fields||[],d.push("fields"),a.push(c),e.push(0==c.length);else if("get_entries"==b)b=c.ids||[],d.push("ids"),a.push(b),e.push(!1),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||
[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length);else for(var f in c)"module_name"!=f&&(d.push(f),a.push(c[f]),e.push(!1));for(c=e.length-1;0<=c;c--)if(e[c])d.pop(),a.pop();else break;return{keys:d,values:a}}
function Iq(a,b){var c=b.module_name;a.o=C();return Jq(a,"get_entry_list",b).D(function(a){var e=a.result_count,f=a.offset||0,g=a.entry_list,k=parseInt(a.next_offset,10);if(s(e)&&u(g)){if(0<g.length){a=Fq(g);var l=this.I,m=this.i,n=a;if(l.Ba)for(var n=u(n)?n:[n],p=0;p<n.length;p++)n[p]&&Kq(l,new Aq(m,c,n[p]));this.db.put(c,a)}return 0<g.length&&e>=g.length&&k>f?(b.offset=k,Iq(this,b)):k}throw Error("Invalid REST respond on entry list query on "+c+": "+JSON.stringify(a));},a)}
function Lq(a,b){if(-1==$p.indexOf(b))return qb("module name "+b+" invalid.");var c={module_name:b},d="module/"+b;return a.db.get("Meta",d).D(function(a){return a?a:Jq(this,"get_module_fields",c).D(function(a){this.db.put("Meta",a,d);return a},this)},a)}
function Mq(a,b){var c=new Oj(b,"date_modified",null,!0);return a.db.keys(c,1).D(function(a){var c={};a[0]&&(c.query=b.toLowerCase()+".date_modified>'"+a[0]+"'");c.module_name=b;c.order_by="date_modified";a=Iq(this,c);a.w(function(a){this.logger.info(this+" module "+b+" synced, "+a+" records updated.")},function(){M(this.logger,this+" module "+b+" failed.")},this);return a},a)}
function Jq(a,b,c,d){var e=d||0,f=new G;if(!a.g||!a.g.id)return 2>e?(Q(a.logger,"Request require login, tried "+e),a.Kc().D(function(){e++;nb(Jq(a,b,c,e),f)})):(P(a.logger,"Cannot do request, not login. Give up after "+e+" retry"),f.u()),f;d=Hq(a,b,c);a.request(b,d.keys,d.values,function(d,k){k.wa()?11==d.number&&/invalid/i.test(d.name)?(this.g=null,nb(Jq(a,b,c,e),f)):f.t(d):f.u(k.L()+" "+k.Da())},a);return f}
h.list=function(a){if(!u(a)||0==a.length)return qb("invalid query");for(var b=[],c=0;c<a.length;c++){var d=a[c];if(!A(d))return qb("invalid query at "+c+"");var e=d.store;if(-1==aq.indexOf(e))return qb("invalid store name at "+c+": "+e);var f=d.index;if(!w(f)||0==f.length)return qb("index name missing in "+e);var g=null;null!=d.key?(g=d.key,"ydn$phones"==f?g=bn(g):"ydn$emails"==f&&(g=g.toLowerCase()),g=d.prefix?gj(g):T.only(g)):null!=d.keyRange&&(g=hj(d.keyRange));"id"==f?b.push(this.db.values(e,
g)):Sl(this.db,e,f)?b.push(this.db.values(e,f,g)):b.push(pb([]))}return(new gm(b)).w(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].result=b[c][1]:(M(this.logger,"query "+c+" failed."),a[c].result=[]);return a},function(b){M(this.logger,"list failed "+b);return a},this)};
h.search=function(a){if(!u(a)||0==a.length)return qb("invalid query");for(var b=[],c=zq(this.S),d=0;d<a.length;d++){var e=a[d];if(!A(e))return qb("invalid query at "+d+"");var f=e.q;if(!w(f)||0==f.length)return qb("query term missing "+d+"");var g="ft-"+e.store+"-"+(e.index||"name");0<=Ua(c.fullTextCatalogs,function(a){return a.name==g})?(f=this.db.search(g,e.q),e.fetchFull&&(f=f.D(function(a){if(0<a.length){for(var b=[],c=0;c<a.length;c++)b.push(new kk(a[c].storeName,a[c].primaryKey));return this.db.values(b)}},
this)),b.push(f)):b.push(pb([]))}return(new gm(b)).w(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].result=b[c][1]:(M(this.logger,"query "+c+" failed."),a[c].result=[]);return a},function(b){M(this.logger,"list failed "+b);return a},this)};function Nq(a,b){var c=b.store;if(!w(c)||0==c.length)return qb("store name required.");var d=b.id;return w(d)&&0!=d.length?a.db.get(c,d):qb("id required.")}
function Oq(a){if(a.h&&a.h.isLogin)return pb(a.h);var b=new G;a.db.get("Meta","info/server").aa(function(a){a&&a.version?(this.h=a,b.t(a)):this.request("get_server_info",[],[],function(a,c){if(0==c.L())this.h=null,b.u("service "+this.N+" not responding");else if(c.wa()){var f=Ti(c);if((!a||!a.version)&&w(f))try{a=JSON.parse(f)}catch(g){a=Ti(c)}a&&a.version?(f=a,this.h=oc(f),b.t({info:f,about:Pq(this)}),this.db.put("Meta",f,"info/server")):(this.h=null,b.u("invalid respond "+Ti(c)))}else this.h=null,
b.u("request fail "+c.L()+" "+c.Da())},this)},a);return b}function Qq(a){var b=new G;a.request("get_available_modules",["filter"],["all"],function(a){b.t(a)},a);return b}function Pq(a){var b=a.l,b=b instanceof Yn&&/proxy/.test(b.h);return{baseUrl:a.C,domain:a.i,userName:a.j,isLogin:a.isLogin(),hostPermission:!b}}function Rq(a){return(new gm([Oq(a),Qq(a)])).D(function(a){return{serverInfo:a[0][1],availableModules:a[1][1],about:Pq(this)}},a)}
function Sq(a,b,c){var d=[],e;for(e in c)d.push({name:e,value:c[e]});c={module_name:b,name_value_list:d};window.console.log("set_entry",c);return Jq(a,"set_entry",c).D(function(a){if(a&&a.id){var c={id:a.id};a=a.entry_list||{};for(var d in a)c[d]=a[d].value;window.console.log("set_entry result",c);this.db.put(b,c);return c}throw Error("creating "+b+" entry fail");},a)}
function Tq(a,b,c){window.console.log(b,c);if(c){var d=Uq(b,a.i,c.id),e=d.W,f=new Aq(a.i,e,c);P(a.logger,"synchronizing "+b+" to "+f);if((f.g?+new Date(f.g.date_modified):NaN)==d.h){var g=new so("update-gdata-record");to(g,c);b=b.data;A(b)&&Ol(b);Dq(b,c)&&Sq(a,e,c).w(function(a){A(a)?g.g=Ol(a):g.g=a;this.history.add(g)},function(a){M(this.logger,"Fail to put record "+c.id+" to server "+a.message)},a)}}}
function Vq(a,b){for(var c=Wq(b),d=0;d<c.length;d++)0<=aq.indexOf(c[d].W)&&a.db.get(c[d].W,c[d].g).D(function(a){Tq(this,b,a)},a)}function Xq(a,b,c){var d={};Dq(c,d);return Sq(a,b,d)}h.isLogin=function(){return!(!this.g||!this.g.id)};
h.update=function(){if(this.l&&this.l instanceof Yn)this.logger.info(this+" updating skipped since no direct connection is not available.");else{var a;if(this.B)O(this.logger,"Modules are already updating now at "+a+" / "+aq.length);else{this.B=!0;this.o=C();a=0;var b=this,c=function(){var d=aq[a];d?(P(b.logger,"Syncing module "+d),a++,Mq(b,d).aa(function(){b.o=C();r.setTimeout(function(){c()},500)})):(O(b.logger,"Updating module done"),b.B=!1)};c();r.setTimeout(function(){2E3<b.o-C()&&c()},2E3)}}};
h.Kc=function(a,b){a&&(this.j=a);b&&(this.n=b);if(!this.j)return qb("username required.");if(!this.n)return qb("password required.");var c=new G;this.request("login",["user_auth","application_name","name_value_list"],[{user_name:this.j,password:this.n},"Yathit CRM",{language:"",notifyonsave:"false"}],function(a,b){if(a&&a.id)this.g=oc(a),c.t(a);else if(a&&a.description)c.u(a.description+" ("+a.name+")");else{var f=b.L()+" "+b.Da()+" "+Ti(b);c.u("Login fail: "+f.substr(0,200))}},this,!0);return c};
function Yq(a){var b=new G;a.request("logout",[],[],function(a,d){this.g=null;d.wa()?(M(this.logger,"Logout request fail with "+d.L()+" "+d.Da()),b.t(!0)):b.u(d.L()+" "+d.Da())},a,!0);return b}
function Zq(a){function b(){f.request(new Vh(e.toString())).execute(function(a,b){/sugarcrm/i.test(Ti(b))?d.u("Look like SugarCRM web site, but REST V4 API is not available."):200==b.L()?d.u("Not a SugarCRM web site"):d.u("Invalid respond, "+b.L())})}function c(a,b){var c=new vd;c.add("method","get_server_info");c.add("input_type","json");c.add("response_type","json");c.add("rest_data","{}");f.request(new Vh(a,"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},c.toString())).execute(b)}
var d=new G;a=a.trim();ra(a,"http")||(a="https://"+a);var e=new od(a);ud(e,"");td(e,null);var f=Th("proxy"),g=e.ba();a=e.bc;/rest.php$/.test(a)||(/index.php$/.test(a)?sd(g,a.replace("/index.php","")):sd(g,""));var k=g.toString();(function(a,b){c(a+"/service/v4/rest.php",function(a,c){if(200==c.L()){if(!a||!a.version){var d=Ti(c);if(w(d))try{a=JSON.parse(d)}catch(e){b(null,c);return}else a=d}a&&a.version&&b(a,c)}else b(0,c)})})(k,function(a,f){a?(a.isLogin=!1,a.userName=null,a.domain=g.wb,a.baseUrl=
k,d.t(a)):0==a?"https"==e.ec?(pd(g,"http"),setTimeout(function(){c(g.toString(),function(a,c){c.wa()?d.t(a):b()})},100)):d.u(f.L()+" "+f.Da()+" "+Ti(f)):b()});return d}h.toString=function(){return"SugarClient:"+this.i};function $q(a){Error.captureStackTrace?Error.captureStackTrace(this,$q):this.stack=Error().stack||"";a&&(this.message=String(a))}E($q,Error);$q.prototype.name="ydn.gdata.error.InvalidAtomFormatError";function ar(a){Error.captureStackTrace?Error.captureStackTrace(this,ar):this.stack=Error().stack||"";a&&(this.message=String(a))}E(ar,Error);ar.prototype.name="ydn.gdata.error.IncompatibleError";var br="atom app gd xhtml batch openSearch".split(" ");function cr(a){if(!s(this.type))throw new zh("Abstract class cannot be instantiated.");if(w(a))a={id:{$t:a}};else if(!s(a.id)||!w(a.id.$t))throw new uh("Invalid GDataFeed");this.id=a.id.$t;this.data=a;s(this.data.entry)?u(this.data.entry)||(this.data.entry=[this.data.entry]):this.data.entry=[];this.j={};this.n={};a=u(this.data.entry)?this.data.entry.length:0;for(var b=0;b<a;b++){var c=this.data.entry[b],c=c.id?c.id.$t:c.rg?c.rg.$t:"";if(0==c.length)throw new $q("entry "+b);if(0==c.match(/\w+$/)[0].length)throw new $q("entry "+
b+" of "+c);var d=c.match(/\w+$/)[0];this.j[c]=this.data.entry[b];this.n[d]=this.data.entry[b]}this.i=!0;this.B=[];this.p=new ch(function(){this.dispatchEvent(dr)},300,this);this.$f=null;this.h=NaN;this.o=void 0}E(cr,kh);var dr="i";h=cr.prototype;h.jf=function(){return this.kind};h.logger=R("ydn.gdata.Feed");
h.Eb=function(a){var b=new G;Q(this.logger,this+" receiving a task, ready: "+this.i);var c=this;this.i?(this.i=!1,b.aa(function(){Q(c.logger,c+" finish the task.");c.i=!0;var a=c.B.shift();a&&a.call(this)}),a.call(this,b)):this.B.push(na(B(a,this),b));return b};h.$f=null;function er(a){var b;if(!(b=a.$f))if(a=a.ae(),s(a)){b=a;for(var c=0;c<Li.length;c++){var d=(0,Li[c])(a);if(d){b=d;break}}Q(Ji,"Resolving "+a+" to "+b);b=Ki[b]||null}else b=Ki["default"];return b}h.Pe=function(){this.dispatchEvent("e")};
h.Df=function(){return br};h.tg=function(a){a.g()||M(this.logger,"Batch submission failed. "+a.responseText)};
h.ic=function(a,b){var c=this.Df(),d=void 0;s(c)||(c=br);for(var e="",f=0;f<c.length;f++)var g=c[f],e=0==f?e+(' xmlns="'+cp[g]+'" '):e+(" xmlns:"+g+'="'+cp[g]+'" ');d=s(d)?"<id>"+d+"</id>":"";d=sh("<feed"+e+">"+d+"</feed>");for(f=c=0;e=this.kc(f);f++)if(sp(e))qp(e,"");else if(tp(e.data)){var g="delete"==rp(e.data),k=!(!e.data.id||!e.data.id.$t);qp(e,null);var l=op(new jp(null,"entry",e.data),d.documentElement),m=l.getElementsByTagNameNS(ep("batch"),"operation");m[0]?m=m[0]:m=l.appendChild(d.createElementNS(ep("batch"),
"operation"));l=d.createAttribute("type");l.nodeValue=g?"delete":k?"update":"insert";m.setAttributeNode(l);qp(e,"committed");c++;a&&a.message({id:this.hf(),code:"operation: "+l.nodeValue+" "+e})}if(0==c)return O(this.logger,this+" Nothing to commit."),0;O(this.logger,this+" committing "+c+" entries.");d=th(d);b?(this.logger.info("Commit ignored for dry run."),window.console.log(d)):(e=B(this.tg,this),this.I&&this.I.stop(),f=er(this),g=this.qe(),f.send(g,e,{method:"POST",body:d,headers:{"Content-Type":"application/atom+xml"},
params:{}}));return c};h.$d=function(a){return new pp(a)};h.kc=function(a){return 0<=a&&a<this.data.entry.length?this.$d(this.data.entry[a]):null};h.gf=function(a){return(a=this.j[a])?this.$d(a):null};
h.save=function(a){if(this.N){var b=this;this.l||(this.l=new ch(function(){this.Eb(function(a){var d=b.toJSON(),e=b.data.entry,f,g,k;b.N.S(function(a){a.put("ydn.gdata.feed",d).wc(function(a){throw a;}).D(function(){f=!0});a.put("ydn.gdata.entry",e).wc(function(a){throw a;}).D(function(a){k=a.length;g=!0})},["ydn.gdata.feed","ydn.gdata.entry"],"readwrite").w(function(){f&&g?Q(this.logger,b+": saved "+k+" entries."):Q(this.logger,b+": saved failed"+e.length+" entries.");a.t(!0)},function(a){throw a;
},this)})},1E3,this));a?eh(this.l):dh(this.l)}};
function fr(a,b,c){c=c||new G;var d=er(a);if(!d)return M(a.logger,a+": No transport available."),c.u(Error("No transport available.")),c;d.send(b,function(b){if(200==b.status){a.h=C();b=b.O?ff(b.O.responseText):void 0;if(!b.feed)throw new $q("feed missing.");var d=b.feed;if(!s(d))throw b=S(d),new $q(b.substr(0,50));if(d.id.$t!=a.F())throw new ar(d.id.$t+" is not "+a.F());var g=b=0,k=u(d.entry)?d.entry:d.entry?[d.entry]:[];b=k.length;0==b&&Q(a.logger,a+": fetch return no result.");for(var l=0;l<b;l++){for(var m=
a,n=k[l],p=n instanceof pp?n:m.$d(n),q=p,t=0;t<q.hc.length;t++)null!=q.data[q.hc[t]]&&!u(q.data[q.hc[t]])&&(q.data[q.hc[t]]=[q.data[q.hc[t]]]);qp(q,null);q=q.data;q.batch$status&&(q.batch$status=void 0);q.batch$operation&&(q.batch$operation=void 0);var q=p.F(),x=m.gf(q);(t=!!x)?x.update(p):(x=p.id.match(/\w+$/)[0],m.data.entry.push(n),m.j[q]=p.data,m.n[x]=p.data);!t&&g++}O(a.logger,a+" "+b+" ("+g+" new) entries received");a.Pe();(d=vo(d,"next"))?(a.save(),dh(a.p),a.o=d.$t,fr(a,d.href,c)):(0<b&&(a.save(),
dh(a.p)),c.t(!0))}else M(a.logger,"Fetching "+b.uri+" failed: "+b.status),c.u(!1)});return c}h.toString=function(){return this.type+":"+this.id};function gr(a,b){a.fg&&b.g.set("v",a.fg);b.g.set("alt","json");b.g.set("showdeleted",!0)}
function hr(a,b){var c="lu",d=!1;if("lf"==c){if(a.h){var d=!0,e=new Date(a.h),e=e.toISOString();b.g.set("updated-min",e)}}else if("lu"==c){for(var e=0,f=-1,g,k=0;g=a.kc(k);k++)g=g.data.updated.$t,e<g&&(e=g,f=k);if(e=a.kc(f))e=new Date(e.data.updated.$t),e=new Date(1+ +e),e=e.toISOString(),b.g.set("updated-min",e)}else"lo"==c?(b.g.set("orderby","lastmodified"),a.h&&b.g.set("max-results","1")):c="no";Q(a.logger,a+" updating "+(d?"continue":"begin")+" by "+c)}h.bh=$o.prototype.Ud;h.F=$o.prototype.F;
h.eh=$o.prototype.$g;h.dh=$o.prototype.Zg;h.ae=function(){return this.eh()||""};h.hf=function(){return this.id};h.qe=function(){return this.dh()};function ir(a){return a.Eb(function(a){var c=new od(this.ae());gr(this,c);hr(this,c);this.P(ih,!1);fr(this,c.toString()).aa(function(c){lh(this);c?a.t(!0):a.u(void 0)},this)})}h.update=function(a){return a||!0!==("undefined"==typeof this.g?null:(this.g&ih)==ih)?ir(this):(Q(this.logger,this+" already loaded."),pb(!1))};
h.count=function(a){if(a){a=0;for(var b,c=0;b=this.kc(c);c++)sp(b)||"deleted"==rp(b.data)||a++;return a}return this.data.entry.length};h.toJSON=function(){return{id:this.id,key:this.hf(),last_fetch_next_uri:this.o,last_fetch:this.h}};function jr(a){var b,c=a.match(/^\D*0*(\d{1,2}\D)?\D*0*(.+)/);c?(b=c[1].replace(/\D/g,""),a=c[2].replace(/\D/g,"")):a=a.replace(/\D/g,"");return{cb:b,Va:a}}function kr(a,b){var c=jr(a),d=jr(b);if(s(c.cb)&&s(d.cb)&&0!=c.cb.length&&0!=d.cb.length&&c.cb!==d.cb)return 0;if(s(c.Ua)&&0!=c.Ua.length){if(s(d.Ua)&&0!=d.Ua.length){if(c.Ua.length>=d.Ua.length){for(var e=0;e<d.Ua.length;e++)if(c.Ua[e]!=d.Ua[e])return 0;return 1}for(e=0;e<c.Ua.length;e++)if(c.Ua[e]!=d.Ua[e])return 0}return-1}return 1};function lr(a){pp.call(this,a);a=(a=this.id.match(/https?:\/\/www.google.com\/m8\/feeds\/(group|contact|batch)s?\/([^\/]+)\/?(\w+)\/?(\w*)?/))?{nh:"m8",kind:a[1],user_id:a[2]?a[2].replace("%40","@"):"",projection:a[3],id:a[4]}:null;window.console.assert(!!a,"Invalid m8 entry: "+this.id);this.user_id=a.user_id;window.console.assert(a.kind==this.kind,"Invalid kind: "+a.kind+" vs "+this.kind)}E(lr,pp);lr.prototype.logger=R("ydn.gdata.m8.Entry");lr.prototype.g="3.0";lr.prototype.type="m8";function mr(a){if(!s(this.kind))throw new zh("Abstract class cannot be instantiated.");cr.call(this,a);this.user_id=this.F()}E(mr,cr);h=mr.prototype;h.jf=function(){return this.kind};h.fg="3.0";h.type="m8";h.toString=function(){return"Feed:"+this.kind+":"+this.user_id};h.ae=function(){return"https://www.google.com/m8/feeds/"+this.jf()+"s/"+this.user_id.replace("@","%40")+"/full?v=3.0"};
h.qe=function(){var a=mr.m.qe.call(this);return a?a:"https://www.google.com/m8/feeds/"+this.jf()+"s/"+this.user_id.replace("@","%40")+"/full/batch?v=3.0"};var nr=br.concat(["gContact"]);mr.prototype.Df=function(){return nr};function or(a,b,c,d,e,f){this.scheme=a;this.domain=b;this.W=c;this.g=d;this.h=y(f)?f:NaN}function pr(a){if(!A(a)||!w(a.value))return null;var b=qr(a.value);if(!b)return null;var c=NaN;if(w(a.label)){a=a.label;var d=a.indexOf("#"),e=a.indexOf("-");0<d&&0<e&&e>d&&(c=parseInt(a.substring(e),10))}return new or(b[1],b[2],b[3],b[4],0,c)}function qr(a){return a?a.match(/(\w+):\/\/([^\/]+)\/([^\/]+)\/(.*)/):null}or.prototype.Q=function(){return this.scheme+"://"+this.domain+"/"+this.W+"/"+this.g};function rr(a){lr.call(this,a)}E(rr,lr);h=rr.prototype;h.kind="contact";h.logger=R("ydn.gdata.m8.ContactEntry");h.getName=function(a){var b=a?"":this.cf();if(a||0==b.length)a=this.data.gd$name,A(a)&&(b=a.gd$fullName.$t||"",0==b.length&&(b=(a.gd$givenName.$t||"")+" "+(a.gd$familyName.$t||"")));return va(b)};h.se=function(){var a=rr.m.se.call(this);if(a.ydn$emails||a.ydn$xp||a.ydn$externalIds)a==this.data&&(a=Ol(this.data)),delete a.ydn$emails,delete a.ydn$xp,delete a.ydn$externalIds;return a};
h.hc="link category gd$email gd$im gd$organization gd$phoneNumber gd$structuredPostalAddress gd$formattedAddress".split(" ");
function sr(a,b){function c(a){var b=Ta(e,function(b){return b.address===a.address});b?b.rel=s(a.rel)?a.rel:b.rel:d(a)}function d(a){a=Ol(a);f&&delete a.primary;s(void 0)&&(a.rel=void 0);e.push(a)}for(var e=[Ol(a.data.gd$email[0])],f=!!a.data.gd$email[0].primary,g=1;g<a.data.gd$email.length;g++)c(a.data.gd$email[g]);for(g=0;g<b.length;g++)c(b[g]);g=wl(e,a.data.gd$email);g||(a.data.gd$email=e);return!g}
function tr(a,b){function c(a){var b=Qa(e,function(b){var c=b.$t;b=a.$t;c&&b&&0!=c.length&&0!=b.length?(c=c.trim(),b=b.trim(),c=jr(c),b=jr(b),b=c.cb&&c.Va&&c.cb==b.cb&&c.Va==b.Va?6<=c.Va.length?1:4<=c.Va.length?0.8:0.4:c.Va&&4<=c.Va.length&&c.Va==b.Va?8<=c.Va.length?0.8:4<=c.Va.length?0.6:0.4:0):b=0;return b}),c=Kh(b);if(0.4<c.value){var b=e[c.index],f=s(a.rel)?a.rel:b.rel;1==c.value?(b.rel=f,b.$t=a.$t):s(a.rel)&&s(b.rel)&&b.rel!==a.rel?d(a,f):(b.rel=f,c=kr(b,a),-1==c?b.$t=a.$t:0==c&&(b.$t=a.$t))}else d(a)}
function d(a,b){a=Ol(a);f&&delete a.primary;s(b)&&(a.rel=b);e.push(a)}for(var e=[Ol(a.data.gd$phoneNumber[0])],f=!!a.data.gd$phoneNumber[0].primary,g=1;g<a.data.gd$phoneNumber.length;g++)c(a.data.gd$phoneNumber[g]);for(g=0;g<b.length;g++)c(b[g]);g=wl(e,a.data.gd$phoneNumber);g||(a.data.gd$phoneNumber=e);return!g}
h.Ve=function(a,b){if("gd$phoneNumber"==a){if(null!=this.data.gd$phoneNumber)return tr(this,b);this.data.gd$phoneNumber=Ol(b);return!0}if("gd$email"==a){if(null!=this.data.gd$email)return sr(this,b);this.data.gd$email=Ol(b);return!0}return rr.m.Ve.call(this,a,b)};
function Uq(a,b,c){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var d=0;d<a.length;d++){var e=pr(a[d]);if(e&&!("sugarcrm"!=e.scheme||b&&b!=e.domain||c&&c!=e.g))return e}return null}function Wq(a){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var b=[],c=0;c<a.length;c++){var d=pr(a[c]);d&&b.push(d)}return b};function ur(a){mr.call(this,a)}E(ur,mr);h=ur.prototype;h.logger=R("ydn.gdata.m8.ContactFeed");h.kind="contact";h.Pe=function(){ur.m.Pe.call(this)};h.gf=function(a){return ur.m.gf.call(this,a)};h.$d=function(a){return new rr(a)};h.kc=function(a){return ur.m.kc.call(this,a)};h.ae=function(){return"https://www.google.com/m8/feeds/contacts/"+this.F()+"/full"};h.hf=function(){return"http://www.google.com/m8/feeds/contacts/"+this.F().replace("@","%40")};function vr(a){function b(a){ra(a,"atom:")&&(a=a.substring(5,a.length));return a.replace("#text","$t").replace(/:/g,"$")}w(a)&&(a=sh(a));var c={};if(1==a.nodeType){if(0<a.attributes.length)for(var d=0;d<a.attributes.length;d++){var e=a.attributes.item(d);c[b(e.nodeName)]=e.nodeValue}}else 3==a.nodeType&&(c=a.nodeValue);if(a.hasChildNodes())for(d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d),f=b(e.nodeName);if("undefined"==typeof c[f])"content"==f?(c[f]={$t:th(e)},e.namespaceURI&&(c[f].xmlns=
e.namespaceURI)):c[f]=vr(e);else{if("undefined"==typeof c[f].length){var g=c[f];c[f]=[];c[f].push(g)}c[f].push(vr(e))}}return c};function wr(a,b){this.id=b.replace("@","%40");this.client=this.g=null;this.i=new fh(function(){O(this.logger,"updating gdata "+this);xr(this).w(function(a){this.logger.info(this+" synced, "+a+" new entries updated.")},function(){M(this.logger,this+" update failed.")},this)},6E4,this);this.j=a;this.h=null}h=wr.prototype;h.logger=R("ydn.ds.gdata.GData");h.update=function(){gh(this.i)};h.H=function(){return this.j};function yr(a){var b=new G;a.execute(function(a,d){a?b.t(a):b.u(d)});return b}
function zr(a,b){var c=(a.client?a.client:Th("gse")).request(b);return yr(c).w(function(a){a=a.feed;if(!a.entry)return 0;for(var b=(new ur(a)).bh("next"),c=a.entry.length,g=!!this.h,k=0;g&&k<c;k++){var l=a.entry[k];l.gContact$externalId&&this.h(l)}return this.H().put(this.A(),a.entry).D(function(){return b?zr(this,new Vh(b.href)).D(function(a){return c+a},this):c},this)},function(a){M(this.logger,"fetching fail "+(a?a.L()+" "+a.Da():""))},a)}h.getParams=function(){return{alt:"json"}};
h.get=function(a){return w(a)&&0!=a.length?this.H().get(this.A(),a):qb("invalid key")};h.put=function(a){return this.H().put(this.A(),a)};h.eg=function(a){return new pp(a)};function Ar(a,b){return a.eg(b).ic().D(function(a){a=vr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+ph(a));this.H().put(this.A(),b);return b},a)}
function xr(a){if(!a.H().getName())return qb(Error("database not ready"));if(!a.g){var b=new Oj(a.A(),"updated.$t",null,!0);a.g=a.H().keys(b,1).D(function(a){var b=this.getParams();b.orderby="lastmodified";a[0]?(b.sortorder="descending",a=(new Date(1+ +new Date(a[0]))).toISOString(),b["updated-min"]=a):b.sortorder="ascending";return zr(this,new Vh(Br(this)+"/full","GET",b)).aa(function(){this.g=null},this)},a)}return a.g}h.toString=function(){return"GData:contact:"+this.id.replace("%40","@")};function Cr(a,b){wr.call(this,a,b)}E(Cr,wr);Cr.prototype.A=function(){return"contact"};Cr.prototype.getParams=function(){var a=Cr.m.getParams.call(this);a.v="3.0";return a};function Br(a){return"https://www.google.com/m8/feeds/contacts/"+a.id}Cr.prototype.eg=function(a){var b=!!a.id;b||(a.id={$t:Br(this)+"/base/0"});var c=new rr(a);b||delete a.id;return c};function Dr(a,b){return b&&0!=b.length?a.H().values(a.A(),"ydn$emails",T.only(b),100,0,!1,!0):pb([])}
function Er(a,b){var c=T.only(b.Q());return a.H().values(a.A(),"ydn$externalIds",c).D(function(){},a)}
function Fr(a,b,c){return a.H().get(a.A(),b).D(function(a){if(a){if(!c||!c.label||!c.value)return qb("invalid external_id_data");var e=c.label,f=c.value;a.gContact$externalId=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var g=new rr(a),k=!1,l=0;l<a.gContact$externalId.length;l++)if(a.gContact$externalId[l].value==f){a.gContact$externalId[l].label=e;k=!0;break}k||a.gContact$externalId.push({label:e,value:f});qp(g,"modified");return g.ic().D(function(a){a=
vr(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+ph(a));this.H().put(this.A(),b);return b},this)}throw Error("gdata entry "+b+" not found");},a)};function Gr(a){this.g=a;this.i=0;this.j=[];this.l=[0,0,0,0];this.h=new Kinetic.Layer;a=this.g/2;var b=a/3;this.n=[a,a,b,this.g-b];this.o=[a,b,this.g-b,this.g-b]}Gr.prototype.clear=function(){this.h=new Kinetic.Layer};var Hr=Math.pow(2,2),Ir=Math.pow(2,3),Jr=Math.pow(2,4),Kr=Math.pow(2,5);Gr.prototype.P=function(a,b){this.i=b?this.i|a:this.i&~a};
function Lr(a){a.clear();for(var b=[["#C2C2C2","#6B6B6B","#525252","#3D3D3D"],["#FAFAFA","#D8D8D8","#D8D8D8","#C2C2C2"],["#FCCA03","#DD1812","#0140CA","#16A61E"]],c=["m252,324c0,-59.647 48.354,-108 108,-108c26.90799,0 51.51501,9.843 70.42401,26.121c1.03198,-8.564 1.57599,-17.27901 1.57599,-26.121c0,-119.126 -96.43701,-215.722 -215.49899,-215.994c40.89099,0.137 73.99899,33.321 73.99899,74.244c0,41.007 -33.24301,74.25 -74.25,74.25c-41.008,0 -74.25,-33.243 -74.25,-74.25c0,-40.979 33.19701,-74.203 74.16701,-74.248c-0.05602,0 -0.11201,-0.002 -0.16701,-0.002c-119.294,0 -216,96.707 -216,216c0,8.843 0.544,17.55701 1.577,26.121c18.908,-16.278 43.515,-26.121 70.423,-26.121c59.646,0 108,48.353 108,108c0,37.93399 -19.561,71.29401 -49.14301,90.56c26.127,11.21701 54.90701,17.44 85.14301,17.44s59.01599,-6.22299 85.14301,-17.44c-29.582,-19.26599 -49.14301,-52.62601 -49.14301,-90.56z",
"m142,74.25c0,41.007 33.242,74.25 74.25,74.25c41.00699,0 74.25,-33.243 74.25,-74.25c0,-40.923 -33.108,-74.107 -73.99899,-74.244c-0.112,0 -0.22301,-0.004 -0.334,-0.004c-40.97,0.045 -74.16701,33.269 -74.16701,74.248z","m180,324c0,-59.647 -48.354,-108 -108,-108c-26.908,0 -51.515,9.843 -70.424,26.121c9.366,77.69 59.967,142.67798 129.28099,172.43799c29.582,-19.26498 49.14301,-52.625 49.14301,-90.55899z","m430.42401,242.121c-18.909,-16.278 -43.51602,-26.121 -70.42401,-26.121c-59.646,0 -108,48.353 -108,108c0,37.93399 19.561,71.29401 49.142,90.56c69.315,-29.76199 119.91602,-94.74899 129.28201,-172.439z"],
d=b[0].slice(),e=[Hr,Ir,Jr,Kr],f=0;f<e.length;f++){var g=e[f];(a.i&g)==g&&(d[f]=b[2][f])}b=new Kinetic.Group({scaleX:a.g/435,scaleY:a.g/435});e=new Kinetic.Group;for(f=0;f<c.length;f++)a.j[f]=new Kinetic.Path({data:c[f],fill:d[f]}),0<a.l[f]&&(g=a.g/19*8,g=new Kinetic.Text({x:a.n[f]-g/4,y:a.o[f]-g/2,text:String(a.l[f]),fontSize:g,fontFamily:"sans-serif",fill:"white"}),e.add(g)),b.add(a.j[f]);a.h.add(b);a.h.add(e);return a.h};function Mr(a){this.g=document.createElement("div");this.h=a||19;this.i=new Gr(this.h);this.j=new ch(function(){this.render()},100,this);chrome.runtime.onSuspend&&chrome.runtime.onSuspend.addListener(function(){chrome.browserAction.setTitle({title:"suspended"});this.P(Ir,!1);this.P(Jr,!1);this.P(Kr,!1);this.P(Hr,!1);this.render()}.bind(this))}Mr.prototype.s=function(){return this.g};Mr.prototype.P=function(a,b){this.i.P(a,b);eh(this.j)};
Mr.prototype.render=function(){this.g.parentElement||document.body.appendChild(this.g);(new Kinetic.Stage({container:this.g,width:this.h,height:this.h})).add(Lr(this.i));if(chrome.browserAction){var a=this.g.querySelector("canvas"),b=a.getContext("2d");chrome.browserAction.setIcon({imageData:b.getImageData(0,0,a.width,a.height)})}};function Nr(a,b){this.g=a;this.filter=b||null;var c=this;setTimeout(function(){Or(c)},6E5*Math.random())}
function Or(a){var b=a.g.getName(),c={"Content-Type":"application/json"};a.g.values("log",null,20).D(function(a){if(0!=a.length){var e=a.map(function(a){return a.key});a=JSON.stringify(a);a=new Vh("https://mhardartway.s3.amazonaws.com/"+(b+"/"+e[0]),"PUT",null,c,a);var f=Th(),e=e.map(function(a){return new kk("log",a)});f.request(a).execute(function(a,b){b.wa()&&this.g.remove(e).D(function(a){a==e.length&&Or(this)},this)},this)}},a)}Nr.prototype.log=function(){};function Pr(){this.g={};this.Ba=null;this.B=new Qh;Mh(this.B);this.p=new Nn;this.h=this.n=this.j=this.o=null;this.C=new og(new sg,"XMLHttpRequest"+location.host);this.l=new Mr;var a=this,b=C();Xi=Hi=new Nr(no,function(c){if(!c||c.HttpRequestData&&"https://mail.google.com/mail/feed/atom/bazinga"==c.HttpRequestData.path)return null;a.h&&a.h.Id&&(c.id=a.h.Id.$t);c.uptime=b;return c});chrome.permissions.onAdded.addListener(this.Ng.bind(this))}h=Pr.prototype;h.logger=R("ydn.crm.app.App");
h.Ng=function(a){for(var b=(a=a.origins)?a.length:0,c=0;c<b;c++){var d=a[c].match(/https:\/\/([^\/]+)/);if(d){var d=d[1],e=this.g[d];if(e&&(O(this.logger,"host permission granted to "+e),e.l instanceof Yn)){var f=Th("default");this.g[d]=new Gq(f,e.I,e.C,e.j,e.n);this.g[d].update()}}}};h.init=function(){P(this.logger,"init "+this);this.l.P(Hr,!0);jo||(po(),jo=new $n(mo(),void 0,"https://yathit-app.appspot.com",1,!0),Pi(jo,Uh))};
function Qr(a,b){function c(a){return a.Kc().D(function(){var b=a.isLogin()?a.j+"@":" (not login) ";this.logger.info("connected to sugarcrm client: "+b+e);a.isLogin()&&(this.g[e]=a,this.C.set(k,l),b=Object.keys(this.g),Tn(this.p,b),a.update(),Rr(this));return Pq(a)},this)}var d=b.baseUrl,e=b.domain||d;if(!e)return qb("domain or url required.");e=e.trim();ra(e,"http")&&(e=Cd(new od(e)));/\//.test(e)&&(e=Cd(new od("https://"+e)));if(d&&(d=d.trim(),!ra(d,"http"))){var d=d.replace(/:?\/\//,""),f=new od("https://"+
d);f.bc||sd(f,"/");d=f.toString()}var g=a.g[e],k="sugar-client-"+e,l=a.C.get(k)||{};if(g)return g.isLogin()?pb(Pq(g)):c.call(a,g);var m=b.userName||l.userName;d||(d=l.base_url);d||(d="https://"+e+"/");if(!m)return P(a.logger,"username not found in "+JSON.stringify(b)),qb("username required");var n=b.password;n?b.hashed||(n=CryptoJS.MD5(n).toString()):n=l.password;if(!n)return P(a.logger,"password not found in "+JSON.stringify(b)),qb("password required.");l.userName=m;l.password=n;l.base_url=d;var p=
new G;chrome.permissions.contains({origins:[d]},function(b){b=b?Th("default"):Th("proxy");g=new Gq(b,a,d,m,n);nb(c.call(a,g),p)});return p}function Sr(a,b,c,d){return 0<=$p.indexOf(b)?a.Ba.get(c).D(function(a){if(a){var f=$p[$p.indexOf(b)];return Xq(d,f,a).D(function(a){if(a&&a.id)return a;throw Error("Set Entry to "+f+" failed");},this)}throw Error("contact entry "+c+" not found");},a):qb(new uh("invalid module name "+b))}
function Kq(a,b){var c=new or("sugarcrm",b.domain,b.W,b.F());Er(a.Ba,c).D(function(a){for(var c=0;c<a.length;c++){var f=a[c];0<Eq(b,f)&&this.Ba.put(f)}})}function Rr(a){var b=!1,c;for(c in a.g)if(a.g[c].isLogin()){b=!0;break}a.l.P(Hr,!0);a.l.P(Kr,a.isLogin());a.l.P(Ir,b)}
function Tr(a,b){if(!b)return qb("domain required");a.C.remove("sugar-client-"+b);return Sn(a.p).D(function(a){a=a||[];var d=a.indexOf(b);0<=d&&(a.splice(d,1),Tn(this.p,a));return this.g[b]?Yq(this.g[b]).D(function(){delete this.g[b];this.logger.info("SugarCRM "+b+" removed.");Rr(this);return!0},this):!1},a)}
h.Qg=function(a){for(var b=u(a.gContact$externalId)?a.gContact$externalId:[a.gContact$externalId],c=0;c<b.length;c++)if(b[c]&&b[c].value&&b[c].label){var d=qr(b[c].value);d&&"sugarcrm"==d[1]&&(d=d[2],this.g[d]&&Vq(this.g[d],new rr(a)))}};function Ur(a){a.Ba=new Cr(a.p.g,a.h.email);var b=Th("gse");a.Ba.client=b;a.Ba.h=a.Qg.bind(a);a.Ba.update()}
function Vr(a,b){var c=new G,d=b.email||"";if(a.h&&a.h.email==d)return P(a.logger,"already running for "+d),c.t(a.h),c;a.h=b;a.h.updated=C();d?(a.logger.info(d+" login to YDN server"),qo(a),On(a.p,b.Id.$t),Ur(a),Sn(a.p).D(function(a){a=a||[];for(var b=0;b<a.length;b++)a[b]&&Qr(this,{domain:a[b]})},a),c.t(a.h),a.isLogin()?(a.l.P(Kr,!0),chrome.browserAction.setTitle({title:"Ready"})):(a.l.P(Kr,!1),chrome.browserAction.setTitle({title:"Login required."}))):(a.logger.info("Not login to YDN server"),c.t(a.h),
a.l.P(Kr,!1),chrome.browserAction.setTitle({title:"Login required."}));return c}function Wr(a){var b=new G;ro().request(new Vh("/token","DELETE")).execute(function(a,d){d.wa()?(this.j=this.o=null,b.t(null)):b.u("error "+d.Da())},a);return b}
function Xr(a,b){var c=A(b)?b:{last_login:"1"},d=ro(),e=new G;d.request(new Vh("/audit","GET",c)).execute(function(a,b){if(b.wa()){if(a.LastLoginRecord){var c=a.LastLoginRecord;if(c.timestamp){var d;d=c.timestamp-C();d=Math.abs(d);if(6E4>d)d="0 minutes";else{var m=Math.floor(d/864E5);d%=864E5;var n=Math.floor(d/36E5),p=Math.floor(d%36E5/6E4),q=Od(String(m)),t=Od(String(n)),x=Od(String(p));d=m*(n+p)?" ":"";var z=n*p?" ":"",m=Ae("{COUNT, plural, =0 {}=1 {{TEXT} day}other {{TEXT} days}}",m,q),n=Ae("{COUNT, plural, =0 {}=1 {{TEXT} hour}other {{TEXT} hours}}",
n,t),p=Ae("{COUNT, plural, =0 {}=1 {{TEXT} minute}other {{TEXT} minutes}}",p,x);d=m+(d+(n+(z+p)))}c.ago=d}}e.t(a)}else e.u(b)},a);return e}function cj(a,b){if(a.j)return a.j;if(a.o&&a.o.expires<C())return pb(a.o);a.j=new G;var c={url:b||chrome.extension.getURL(Nh)},c=new Vh("/token","GET",c);ro().request(c).execute(function(a,b){if(b.wa()){var c=a.Tokens[0];c.has_token?(c.expires=1E3*c.expires_in+C(),this.o=c,this.j.t(c)):this.j.u(c)}else this.o=null,this.j.u(b);this.j=null},a);return a.j}
h.isLogin=function(){return!!this.h&&this.h.is_login};function Yr(a,b){if(a.n)return a.n;a.n=Rh(a.B,b).D(function(b){return Vr(this,b).D(function(){a.isLogin()?setTimeout(function(){a.n=null},9E5):a.n=null},function(a){this.logger.info("Attamping to login YDN server fail: "+ph(a))})},a);return a.n}function Zr(a){a.n=null;a.h=null;a.l.P(Kr,!1)}h.toString=function(){return"SugarApp:0.6.9"};function $r(){Pr.call(this);this.i={};as(this)}E($r,Pr);$r.prototype.logger=R("ydn.crm.app.EventPage");
function bs(a,b,c){var d=c.req;c.done=!0;var e=null!=c.data?c.data:{};P(a.logger,"service req: "+d+":"+c.id);if("app-setting"==d)c.data=r.localStorage.getItem("app-setting"),b.postMessage(c);else if("echo"==d)P(a.logger,"resp: "+d+":"+c.id),b.postMessage(c);else if("gdata-fetch"==d)e=c.data,"contact"==e?a.Ba?xr(a.Ba).w(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):(c.error="gdata not ready",b.postMessage(c)):(c.error="invalid kind "+e,b.postMessage(c));
else if("gdata-list-contact-by-email"==d)Dr(a.Ba,c.data).D(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token"==d)cj(a,c.data).aa(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("feed-log"==d){var f=e.offset||0,e=e.limit||100;fo.g.values("db-logger",null,e||100,f||0,!0).aa(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c)}else if("feed-log-info"==d)f=
e.offset||0,e=e.limit||100,eo(e,f).aa(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token-revoke"==d)Wr(a).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("list-sugarcrm"==d){e=[];for(f in a.g)e.push(Pq(a.g[f]));P(a.logger,"resp: "+c.req+":"+c.id);c.data=e;b.postMessage(c)}else"log-bug"==d?(Ii(c.data),
b.postMessage(c)):"login-info"==d?Yr(a,c.data).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="invalid login";b.postMessage(this)},c):"logged-in"==d?(Yr(a,null).D(function(b){cs(a,{req:d,info:b})}),b.postMessage(c)):"logout"==d?(Zr(a),cs(a,{req:d}),b.postMessage(c)):"new-entry"==d?A(c.data)?Ar(a.Ba,c.data).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error=
"failed to create a new entry";b.postMessage(this)},c):(c.error="Invalid gdata entry data",b.postMessage(c)):"new-sugarcrm"==d?Qr(a,c.data).w(function(){P(a.logger,"resp: "+this.req+":"+this.id);this.data=!0;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"remove-sugar"==d?Tr(a,c.data).aa(function(a){this.data=a;b.postMessage(this)},c):"server-audit-log"==d?Xr(a,e).w(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"sugar-server-info"==
d?(e=c.data,e=/https?:/.test(e)?new od(e):qd(new od,e),(e=a.g[e.wb])?Oq(e).D(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c):Zq(c.data).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},c)):"user-setting"==d?Un().D(function(a){this.data=a;b.postMessage(this)},c):M(a.logger,"Main channel unknown req: "+d)}
function ds(a,b,c,d){var e=d.req;d.done=!0;O(a.logger,"sugar service req: "+c+":"+e+":"+d.id);if(a.isLogin())if("about"==e)d.data=Pq(c),b.postMessage(d);else if("details"==e)Rq(c).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d);else if("echo"==e)b.postMessage(d);else if("get"==e)Nq(c,d.data).w(function(a){this.data=a;b.postMessage(this)},function(a){this.error=
a;b.postMessage(this)},d);else if("fetch-module"==e)Mq(c,d.data).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id+" "+c);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d);else if("info-module"==e)Lq(c,d.data).w(function(c){this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d);else if("import-gdata"==e){var f=d.data,g=f?f["gdata-id"]:"";g?
(c=Sr(a,f.module,g,c),c.w(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d)):(M(a.logger,"resp error: "+e+":"+d.id),d.error="gdata id required",b.postMessage(d))}else"link"==e?(c=a.Ba,(e=d.data["gdata-id"])?Fr(c,e,d.data["external-id"]).w(function(a){this.data=a;b.postMessage(this)},function(c){M(a.logger,"error linking gdata "+this.req+":"+this.id);this.error=c.name+": "+c.message;b.postMessage(this)},d):(d.error="gdata-id not required",b.postMessage(d))):
"list"==e?c.list(d.data).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d):"list-module"==e?Qq(c).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):"login"==e?Qr(a,d.data).w(function(c){this.data=c;b.postMessage(this);Rr(a)},function(a){this.error=
a;b.postMessage(this)},d):"put-record"==e?(e=d.data.module)?(f=d.data.record,A(f)?Sq(c,e,f).w(function(c){this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(d.error="record object required",b.postMessage(d))):(d.error="module required",b.postMessage(d)):"search"==e?(c=c.search(d.data),c.w(function(c){this.done=!0;P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+
this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d)):"server-info"==e?Oq(c).w(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d):"sync-entry"==e?(e=d.data,a.Ba.get(e).w(function(c){c?new rr(c):(c="GData entry "+this.data+" not found.",P(a.logger,c),this.error=c,b.postMessage(this))},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+c);
this.error=c;b.postMessage(this)},d)):"rest"==e?(g=d.data,A(g)?(f=g.method,g=g.params,w(f)&&0!=f.length?A(g)?Jq(c,f,g).w(function(c){this.data=c;P(a.logger,"resp: "+this.req+":"+this.id);b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(d.error="REST parameter must be an object",P(a.logger,"resp: error "+e+":"+d.id),b.postMessage(d)):(d.error="method must be valid string",P(a.logger,"resp: error "+e+":"+d.id),b.postMessage(d))):(d.error="REST parameter must be an object",P(a.logger,
"resp: error "+e+":"+d.id),b.postMessage(d))):M(a.logger,c+" unknown req: "+e);else d.error="Not login",b.postMessage(d)}function es(a){var b=!1,c;for(c in a.i)"gmail"==a.i[c].group&&(b=!0);a.l.P(Jr,b)}function cs(a,b){for(var c in a.i){var d=a.i[c];"gmail"==d.group&&d.port.postMessage(b)}}$r.prototype.I=function(){return{sugars:this.g,gdata:this.Ba,ports:this.i,user_info:this.h}};
function as(a){chrome.runtime.onConnect.addListener(function(b){var c=b.sender.url,d=b.name.substr(0,b.name.lastIndexOf("-"));Va(Zc,d)?(O(a.logger,"Channel "+b.name+" connected for "+c),a.i[b.name]={name:b.name,group:d,port:b},es(a),b.onMessage.addListener(function(c){if(c&&A(c)){if("close"==c.req)a.logger.info("closing "+b.name),delete a.i[b.name],b.disconnect(),es(a);else if(!c.id){M(a.logger,"Unknown group in pipe info "+b.name);return}if("sugarcrm"==c.group){var d=c.name,g=a.g[d];g?ds(a,b,g,c):
M(a.logger,"SugarCRM instance "+d+" not found.")}else if("gmail"==c.group)for(d in a.i)g=a.i[d],g.group!=d||c.name&&c.name!=g.name||g.port.postMessage(c);else bs(a,b,c)}else M(a.logger,"invalid message package: "+c)}),b.onDisconnect.addListener(function(){O(a.logger,"disconnected "+b.name);delete a.i[b.name];es(a)})):M(a.logger,"channel "+b.name+" ignored from "+c)});O(a.logger,"event page start listening incoming connection")}
oa("runApp",function(){Gi("ydn.crm","finer");Gi("ydn.ds","finer");no=new Mn("ydn.crm",{stores:[{name:"log",keyPath:"key"},{name:"db-logger",autoIncrement:!0,indexes:[{name:"level"},{name:"time"},{name:"name"},{name:"name, time",keyPath:["name","time"]}]}]});var a=fo=new bo(no);a.h=1E4;co(a);fo.j=300;fo.l["ydn.db.tr.DbOperator"]=!0;lo.info("Starting ydn.crm.App:0.6.9");chrome.storage.local.get(["logging-captureConsole","logging-bugReport"],oo);chrome.storage.onChanged.addListener(oo);a=new $r;a.init();
Yr(a);return a});$r.prototype.xp=$r.prototype.I;function fs(){this.g=null}var gs;fs.prototype.Eb=function(a,b){this.g?a.call(b):$c().send("user-setting").D(function(c){this.g=c||hs;a.call(b)},this)};
fs.prototype.h=function(a){a=$c("sugarcrm",a);for(var b=[],c=0;c<aq.length;c++){var d=a.send("info-module",aq[c]).D(function(a){var b="",c="",d;for(d in a.module_fields){var l=a.module_fields[d];if(0<=["salutation","name","last_name","first_name","full_name"].indexOf(d))l.group="name";else if(/^email\d?$/.test(d))l.group="email";else if(/^phone?/.test(d))l.group="phone";else if(!l.group&&ra(d,b)){l.group=c;continue}b=d;c=l.group}},this);b.push(d)}return(new gm(b)).D(function(a){for(var b={},c=0;c<
aq.length;c++)b[aq[c]]=a[c][1];return b},this)};var hs={};function is(){}da(is);is.prototype.g=0;function js(a){Kc.call(this);this.h=a||Dg();this.Nd=ks}E(js,Kc);js.prototype.X=is.U();var ks=null;function ls(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?"highlight":"unhighlight";case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close"}throw Error("Invalid component state");}h=js.prototype;h.mc=null;h.V=!1;h.T=null;h.Nd=null;h.R=null;h.Fa=null;h.Ia=null;
h.Ya=null;h.bg=!1;h.F=function(){return this.mc||(this.mc="ydn:"+(this.X.g++).toString(36))};function ms(a,b){if(a.Fa&&a.Fa.Ya){var c=a.Fa.Ya,d=a.mc;d in c&&delete c[d];mc(a.Fa.Ya,b,a)}a.mc=b}h.s=function(){return this.T};function ns(a){return a.l||(a.l=new af(a))}
function os(a,b){if(a==b)throw Error("Unable to set parent component");var c;if(c=b)if(c=a.Fa)if(c=a.mc){c=a.Fa;var d=a.mc;c=(c.Ya&&d?nc(c.Ya,d)||null:null)&&a.Fa!=b}if(c)throw Error("Unable to set parent component");a.Fa=b;js.m.$e.call(a,b)}h.getParent=function(){return this.Fa};h.$e=function(a){if(this.Fa&&this.Fa!=a)throw Error("Method not supported");js.m.$e.call(this,a)};h.yb=function(){this.T=this.h.createElement("div")};h.render=function(a){ps(this,a)};
function ps(a,b,c){if(a.V)throw Error("Component already rendered");a.T||a.yb();b?b.insertBefore(a.T,c||null):a.h.g.body.appendChild(a.T);a.Fa&&!a.Fa.V||a.$()}function qs(a,b){if(a.V)throw Error("Component already rendered");if(b&&a.ze(b)){a.bg=!0;var c=Fg(b);a.h&&a.h.g==c||(a.h=Dg(b));a.Nb(b);a.$()}else throw Error("Invalid element to decorate");}h.ze=function(){return!0};h.Nb=function(a){this.T=a};h.$=function(){this.V=!0;rs(this,function(a){!a.V&&a.s()&&a.$()})};
h.fb=function(){rs(this,function(a){a.V&&a.fb()});this.l&&this.l.removeAll();this.V=!1};h.J=function(){this.V&&this.fb();this.l&&(this.l.Aa(),delete this.l);rs(this,function(a){a.Aa()});!this.bg&&this.T&&Qg(this.T);this.Fa=this.R=this.T=this.Ya=this.Ia=null;js.m.J.call(this)};h.oa=function(a,b){this.de(a,ss(this),b)};
h.de=function(a,b,c){if(a.V&&(c||!this.V))throw Error("Component already rendered");if(0>b||b>ss(this))throw Error("Child component index out of bounds");this.Ya&&this.Ia||(this.Ya={},this.Ia=[]);if(a.getParent()==this){var d=a.F();this.Ya[d]=a;Xa(this.Ia,a)}else mc(this.Ya,a.F(),a);os(a,this);ab(this.Ia,b,0,a);a.V&&this.V&&a.getParent()==this?(c=this.lb(),c.insertBefore(a.s(),c.childNodes[b]||null)):c?(this.T||this.yb(),b=ts(this,b+1),ps(a,this.lb(),b?b.T:null)):this.V&&!a.V&&a.T&&a.T.parentNode&&
1==a.T.parentNode.nodeType&&a.$()};h.lb=function(){return this.T};function us(a){null==a.Nd&&(a.Nd=qi(a.V?a.T:a.h.g.body));return a.Nd}function ss(a){return a.Ia?a.Ia.length:0}function ts(a,b){return a.Ia?a.Ia[b]||null:null}function rs(a,b,c){a.Ia&&Oa(a.Ia,b,c)}function vs(a,b){return a.Ia&&b?Na(a.Ia,b):-1};var ws;function xs(a,b){b?a.setAttribute("role",b):a.removeAttribute("role")}function ys(a,b,c){v(c)&&(c=c.join(" "));var d="aria-"+b;""===c||void 0==c?(ws||(ws={atomic:!1,autocomplete:"none",dropeffect:"none",haspopup:!1,live:"off",multiline:!1,multiselectable:!1,orientation:"vertical",readonly:!1,relevant:"additions text",required:!1,sort:"none",busy:!1,disabled:!1,hidden:!1,invalid:"false"}),c=ws,b in c?a.setAttribute(d,c[b]):a.removeAttribute(d)):a.setAttribute(d,c)};function zs(a,b,c,d,e){if(!(H||Hb&&Tb("525")))return!0;if(Ab&&e)return As(a);if(e&&!d)return!1;y(b)&&(b=Bs(b));if(!c&&(17==b||18==b||Ab&&91==b))return!1;if(Hb&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(H&&d&&b==a)return!1;switch(a){case 13:return!(H&&H&&9<=Vb);case 27:return!Hb}return As(a)}
function As(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||Hb&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function Bs(a){if(Gb)a=Cs(a);else if(Ab&&Hb)a:switch(a){case 93:a=91;break a}return a}
function Cs(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function Ds(a,b){Kc.call(this);a&&Es(this,a,b)}E(Ds,Kc);h=Ds.prototype;h.lc=null;h.Bd=null;h.Qe=null;h.Cd=null;h.Pa=-1;h.Db=-1;h.ge=!1;
var Fs={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},Gs={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},Hs=H||Hb&&Tb("525"),Is=Ab&&Gb;h=Ds.prototype;
h.Kg=function(a){Hb&&(17==this.Pa&&!a.ctrlKey||18==this.Pa&&!a.altKey||Ab&&91==this.Pa&&!a.metaKey)&&(this.Db=this.Pa=-1);-1==this.Pa&&(a.ctrlKey&&17!=a.g?this.Pa=17:a.altKey&&18!=a.g?this.Pa=18:a.metaKey&&91!=a.g&&(this.Pa=91));Hs&&!zs(a.g,this.Pa,a.shiftKey,a.ctrlKey,a.altKey)?this.handleEvent(a):(this.Db=Bs(a.g),Is&&(this.ge=a.altKey))};h.Lg=function(a){this.Db=this.Pa=-1;this.ge=a.altKey};
h.handleEvent=function(a){var b=a.h,c,d,e=b.altKey;H&&"keypress"==a.type?c=this.Db:Hb&&"keypress"==a.type?c=this.Db:Fb?c=this.Db:(c=b.keyCode||this.Db,d=b.charCode||0,Is&&(e=this.ge),Ab&&63==d&&224==c&&(c=191));d=c=Bs(c);var f=b.keyIdentifier;c?63232<=c&&c in Fs?d=Fs[c]:25==c&&a.shiftKey&&(d=9):f&&f in Gs&&(d=Gs[f]);this.Pa=d;a=new Js(d,0,0,b);a.altKey=e;this.dispatchEvent(a)};h.s=function(){return this.lc};
function Es(a,b,c){a.Cd&&Ks(a);a.lc=b;a.Bd=yc(a.lc,"keypress",a,c);a.Qe=yc(a.lc,"keydown",a.Kg,c,a);a.Cd=yc(a.lc,"keyup",a.Lg,c,a)}function Ks(a){a.Bd&&(Gc(a.Bd),Gc(a.Qe),Gc(a.Cd),a.Bd=null,a.Qe=null,a.Cd=null);a.lc=null;a.Pa=-1;a.Db=-1}h.J=function(){Ds.m.J.call(this);Ks(this)};function Js(a,b,c,d){$b.call(this,d);this.type="key";this.g=a}E(Js,$b);var Ls=!!r.DOMTokenList,Ms=Ls?function(a){return a.classList}:function(a){a=a.className;return w(a)&&a.match(/\S+/g)||[]},Ns=Ls?function(a,b){return a.classList.contains(b)}:function(a,b){return Va(Ms(a),b)},Os=Ls?function(a,b){a.classList.add(b)}:function(a,b){Ns(a,b)||(a.className+=0<a.className.length?" "+b:b)},Ps=Ls?function(a,b){Oa(b,function(b){Os(a,b)})}:function(a,b){var c={};Oa(Ms(a),function(a){c[a]=!0});Oa(b,function(a){c[a]=!0});a.className="";for(var d in c)a.className+=0<a.className.length?
" "+d:d},Qs=Ls?function(a,b){a.classList.remove(b)}:function(a,b){Ns(a,b)&&(a.className=Pa(Ms(a),function(a){return a!=b}).join(" "))};function Rs(a,b){if(!ha(a))throw Error("Invalid component class "+a);if(!ha(b))throw Error("Invalid renderer class "+b);var c=ia(a);Ss[c]=b}function Ts(a,b){if(!a)throw Error("Invalid class name "+a);if(!ha(b))throw Error("Invalid decorator function "+b);Us[a]=b}var Ss={},Us={};function Vs(){}da(Vs);h=Vs.prototype;h.Ce=function(){};function Ws(a,b){a&&(a.tabIndex=b?0:-1)}h.Be=function(a){return a.h.K("div",Xs(this,a).join(" "))};h.Ae=function(a){return"DIV"==a.tagName};function Ys(a,b,c){c.id&&ms(b,c.id);var d=a.G(),e=!1,f=Ms(c);f&&Oa(f,function(a){a==d?e=!0:a&&(a==d+"-disabled"?b.setEnabled(!1):a==d+"-horizontal"?Zs(b,$s):a==d+"-vertical"&&Zs(b,at))},a);e||Os(c,d);bt(a,b,c);return c}
function bt(a,b,c){if(c)for(var d=c.firstChild,e;d&&d.parentNode==c;){e=d.nextSibling;if(1==d.nodeType){var f=a.Bc(d);f&&(f.T=d,b.isEnabled()||f.setEnabled(!1),b.oa(f),qs(f,d))}else d.nodeValue&&""!=va(d.nodeValue)||c.removeChild(d);d=e}}h.Bc=function(a){a:{var b;a=Ms(a);for(var c=0,d=a.length;c<d;c++)if(b=a[c],b=b in Us?Us[b]():null){a=b;break a}a=null}return a};h.De=function(a){a=a.s();xi(a,!0,Gb);H&&(a.hideFocus=!0);var b=this.Ce();b&&xs(a,b)};h.G=function(){return"goog-container"};
function Xs(a,b){var c=a.G(),d=[c,b.ac==$s?c+"-horizontal":c+"-vertical"];b.isEnabled()||d.push(c+"-disabled");return d}h.Ef=function(){return at};function ct(){}var dt;da(ct);h=ct.prototype;h.Ub=function(){};h.Y=function(a){var b=a.h.K("div",et(this,a).join(" "),a.la());ft(this,a,b);return b};h.va=function(a){return a};function gt(a,b,c){if(a=a.s?a.s():a)if(H&&!Tb("7")){var d=ht(wg(a),b);d.push(b);na(c?xg:yg,a).apply(null,d)}else c?xg(a,b):yg(a,b)}h.ud=function(){return!0};
h.ua=function(a,b){b.id&&ms(a,b.id);var c=this.va(b);c&&c.firstChild?it(a,c.firstChild.nextSibling?Za(c.childNodes):c.firstChild):a.zb=null;var d=0,e=this.G(),f=this.G(),g=!1,k=!1,c=!1,l=wg(b);Oa(l,function(a){g||a!=e?k||a!=f?d|=this.ue(a):k=!0:(g=!0,f==e&&(k=!0))},this);a.Ab=d;g||(l.push(e),f==e&&(k=!0));k||l.push(f);var m=a.ne;m&&l.push.apply(l,m);if(H&&!Tb("7")){var n=ht(l);0<n.length&&(l.push.apply(l,n),c=!0)}if(!g||!k||m||c)b.className=l.join(" ");ft(this,a,b);return b};
h.Lf=function(a){us(a)&&this.Ge(a.s(),!0);a.isEnabled()&&this.Gc(a,a.Za)};function ft(a,b,c){b.Za||ys(c,"hidden",!b.Za);b.isEnabled()||a.Ka(c,1,!b.isEnabled());b.ia&8&&a.Ka(c,8,jt(b,8));b.ia&16&&a.Ka(c,16,jt(b,16));b.ia&64&&a.Ka(c,64,jt(b,64))}h.vd=function(a,b){xi(a,!b,!H&&!Fb)};h.Ge=function(a,b){gt(a,this.G()+"-rtl",b)};h.Fe=function(a){var b;return a.ia&32&&(b=a.i.Vb(a))?Wg(b)&&Xg(b):!1};
h.Gc=function(a,b){var c;if(a.ia&32&&(c=a.i.Vb(a))){if(!b&&jt(a,32)){try{c.blur()}catch(d){}jt(a,32)&&a.wd(null)}(Wg(c)&&Xg(c))!=b&&(b?c.tabIndex=0:(c.tabIndex=-1,c.removeAttribute("tabIndex")))}};h.P=function(a,b,c){var d=a.s();if(d){var e=this.Ac(b);e&&gt(a,e,c);this.Ka(d,b,c)}};h.Ka=function(a,b,c){dt||(dt={1:"disabled",8:"selected",16:"checked",64:"expanded"});(b=dt[b])&&ys(a,b,c)};
h.nc=function(a,b){var c=this.va(a);if(c&&(Og(c),b))if(w(b))Tg(c,b);else{var d=function(a){if(a){var b=Fg(c);c.appendChild(w(a)?b.createTextNode(a):a)}};u(b)?Oa(b,d):!v(b)||"nodeType"in b?d(b):Oa(Za(b),d)}};h.Vb=function(a){return a.s()};h.G=function(){return"goog-control"};function et(a,b){var c=a.G(),d=[c],e=a.G();e!=c&&d.push(e);c=b.Ab;for(e=[];c;){var f=c&-c;e.push(a.Ac(f));c&=~f}d.push.apply(d,e);(c=b.ne)&&d.push.apply(d,c);H&&!Tb("7")&&d.push.apply(d,ht(d));return d}
function ht(a,b){var c=[];b&&(a=a.concat([b]));Oa([],function(d){!Sa(d,na(Va,a))||b&&!Va(d,b)||c.push(d.join("_"))});return c}h.Ac=function(a){this.g||kt(this);return this.g[a]};h.ue=function(a){if(!this.i){this.g||kt(this);var b=this.g,c={},d;for(d in b)c[b[d]]=d;this.i=c}a=parseInt(this.i[a],10);return isNaN(a)?0:a};function kt(a){var b=a.G();a.g={1:b+"-disabled",2:b+"-hover",4:b+"-active",8:b+"-selected",16:b+"-checked",32:b+"-focused",64:b+"-open"}};function $(a,b,c){js.call(this,c);if(!b){b=this.constructor;for(var d;b;){d=ia(b);if(d=Ss[d])break;b=b.m?b.m.constructor:null}b=d?ha(d.U)?d.U():new d:null}this.i=b;this.zb=s(a)?a:null}E($,js);h=$.prototype;h.zb=null;h.Ab=0;h.ia=39;h.Lb=255;h.Rc=0;h.Za=!0;h.ne=null;h.Ke=!0;h.$c=!1;h.Xe=null;function lt(a){a.V&&!1!=a.Ke&&mt(a,!1);a.Ke=!1}h.yb=function(){var a=this.i.Y(this);this.T=a;var b=this.Xe||this.i.Ub();b&&xs(a,b);this.$c||this.i.vd(a,!1);this.Za||(vi(a,!1),a&&ys(a,"hidden",!0))};h.lb=function(){return this.i.va(this.s())};
h.ze=function(a){return this.i.ud(a)};h.Nb=function(a){this.T=a=this.i.ua(this,a);var b=this.Xe||this.i.Ub();b&&xs(a,b);this.$c||this.i.vd(a,!1);this.Za="none"!=a.style.display};h.$=function(){$.m.$.call(this);this.i.Lf(this);if(this.ia&-2&&(this.Ke&&mt(this,!0),this.ia&32)){var a=this.i.Vb(this);if(a){var b=this.j||(this.j=new Ds);Es(b,a);ns(this).listen(b,"key",this.Ta).listen(a,"focus",this.Bg).listen(a,"blur",this.wd)}}};
function mt(a,b){var c=ns(a),d=a.s();b?(c.listen(d,"mouseover",a.Me).listen(d,"mousedown",a.Hc).listen(d,"mouseup",a.Wb).listen(d,"mouseout",a.Le),a.Ic!=ca&&c.listen(d,"contextmenu",a.Ic),H&&c.listen(d,"dblclick",a.Mf)):(c.ya(d,"mouseover",a.Me).ya(d,"mousedown",a.Hc).ya(d,"mouseup",a.Wb).ya(d,"mouseout",a.Le),a.Ic!=ca&&c.ya(d,"contextmenu",a.Ic),H&&c.ya(d,"dblclick",a.Mf))}h.fb=function(){$.m.fb.call(this);this.j&&Ks(this.j);this.Za&&this.isEnabled()&&this.i.Gc(this,!1)};
h.J=function(){$.m.J.call(this);this.j&&(this.j.Aa(),delete this.j);delete this.i;this.ne=this.zb=null};h.la=function(){return this.zb};function it(a,b){a.zb=b}h.xb=function(){var a=this.la();if(!a)return"";if(!w(a))if(u(a))a=Qa(a,Yg).join("");else{if(vg&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];Zg(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");vg||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""))}return ua(a)};
h.isEnabled=function(){return!jt(this,1)};h.setEnabled=function(a){var b=this.getParent();b&&"function"==typeof b.isEnabled&&!b.isEnabled()||!nt(this,1,!a)||(a||(ot(this,!1),this.ab(!1)),this.Za&&this.i.Gc(this,a),this.P(1,!a))};h.ab=function(a){nt(this,2,a)&&this.P(2,a)};function ot(a,b){nt(a,4,b)&&a.P(4,b)}h.af=function(a){nt(this,8,a)&&this.P(8,a)};h.ka=function(a){nt(this,64,a)&&this.P(64,a)};function jt(a,b){return!!(a.Ab&b)}
h.P=function(a,b){this.ia&a&&b!=jt(this,a)&&(this.i.P(this,a,b),this.Ab=b?this.Ab|a:this.Ab&~a)};function pt(a,b,c){if(a.V&&jt(a,b)&&!c)throw Error("Component already rendered");!c&&jt(a,b)&&a.P(b,!1);a.ia=c?a.ia|b:a.ia&~b}function qt(a,b){return!!(a.Lb&b)&&!!(a.ia&b)}function nt(a,b,c){return!!(a.ia&b)&&jt(a,b)!=c&&(!(a.Rc&b)||a.dispatchEvent(ls(b,c)))&&!a.C}h.Me=function(a){!rt(a,this.s())&&this.dispatchEvent("enter")&&this.isEnabled()&&qt(this,2)&&this.ab(!0)};
h.Le=function(a){!rt(a,this.s())&&this.dispatchEvent("leave")&&(qt(this,4)&&ot(this,!1),qt(this,2)&&this.ab(!1))};h.Ic=ca;function rt(a,b){return!!a.j&&Sg(b,a.j)}h.Hc=function(a){this.isEnabled()&&(qt(this,2)&&this.ab(!0),!bc(a)||Hb&&Ab&&a.ctrlKey||(qt(this,4)&&ot(this,!0),this.i.Fe(this)&&this.i.Vb(this).focus()));this.$c||!bc(a)||Hb&&Ab&&a.ctrlKey||a.preventDefault()};h.Wb=function(a){this.isEnabled()&&(qt(this,2)&&this.ab(!0),jt(this,4)&&this.Gb(a)&&qt(this,4)&&ot(this,!1))};
h.Mf=function(a){this.isEnabled()&&this.Gb(a)};h.Gb=function(a){if(qt(this,16)){var b=!jt(this,16);nt(this,16,b)&&this.P(16,b)}qt(this,8)&&this.af(!0);qt(this,64)&&this.ka(!jt(this,64));b=new K("action",this);a&&(b.altKey=a.altKey,b.ctrlKey=a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.l=a.l);return this.dispatchEvent(b)};h.Bg=function(){qt(this,32)&&nt(this,32,!0)&&this.P(32,!0)};h.wd=function(){qt(this,4)&&ot(this,!1);qt(this,32)&&nt(this,32,!1)&&this.P(32,!1)};
h.Ta=function(a){return this.Za&&this.isEnabled()&&this.oc(a)?(a.preventDefault(),a.Ec(),!0):!1};h.oc=function(a){return 13==a.g&&this.Gb(a)};Rs($,ct);Ts("goog-control",function(){return new $(null)});function st(a,b,c){js.call(this,c);this.mb=b||Vs.U();this.ac=a||this.mb.Ef()}E(st,js);var $s="horizontal",at="vertical";h=st.prototype;h.Re=null;h.Tb=null;h.mb=null;h.ac=null;h.Ja=!0;h.Qb=!0;h.jc=!0;h.nb=-1;h.ma=null;h.sb=!1;h.Mb=null;function tt(a){return a.Re||a.s()}h.yb=function(){this.T=this.mb.Be(this)};h.lb=function(){return this.s()};h.ze=function(a){return this.mb.Ae(a)};h.Nb=function(a){this.T=Ys(this.mb,this,a);"none"==a.style.display&&(this.Ja=!1)};
h.$=function(){st.m.$.call(this);rs(this,function(a){a.V&&ut(this,a)},this);var a=this.s();this.mb.De(this);this.Fc(this.Ja,!0);ns(this).listen(this,"enter",this.Ie).listen(this,"highlight",this.yg).listen(this,"unhighlight",this.Ag).listen(this,"open",this.Og).listen(this,"close",this.Gg).listen(a,"mousedown",this.zg).listen(Fg(a),"mouseup",this.Ig).listen(a,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.Fg);this.jc&&vt(this,!0)};
function vt(a,b){var c=ns(a),d=tt(a);b?c.listen(d,"focus",a.Kf).listen(d,"blur",a.Jf).listen(a.Tb||(a.Tb=new Ds(tt(a))),"key",a.Ta):c.ya(d,"focus",a.Kf).ya(d,"blur",a.Jf).ya(a.Tb||(a.Tb=new Ds(tt(a))),"key",a.Ta)}h.fb=function(){this.Jb(-1);this.ma&&this.ma.ka(!1);this.sb=!1;st.m.fb.call(this)};h.J=function(){st.m.J.call(this);this.Tb&&(this.Tb.Aa(),this.Tb=null);this.mb=this.ma=this.Mb=this.Re=null};h.Ie=function(){return!0};
h.yg=function(a){var b=vs(this,a.target);if(-1<b&&b!=this.nb){var c=wt(this);c&&c.ab(!1);this.nb=b;c=wt(this);this.sb&&ot(c,!0);this.ma&&c!=this.ma&&(c.ia&64?c.ka(!0):this.ma.ka(!1))}b=this.s();null!=a.target.s()&&ys(b,"activedescendant",a.target.s().id)};h.Ag=function(a){a.target==wt(this)&&(this.nb=-1);this.s().removeAttribute("aria-activedescendant")};h.Og=function(a){(a=a.target)&&a!=this.ma&&a.getParent()==this&&(this.ma&&this.ma.ka(!1),this.ma=a)};
h.Gg=function(a){a.target==this.ma&&(this.ma=null)};h.zg=function(a){this.Qb&&(this.sb=!0);var b=tt(this);b&&Wg(b)&&Xg(b)?b.focus():a.preventDefault()};h.Ig=function(){this.sb=!1};h.Fg=function(a){var b;a:{b=a.target;if(this.Mb)for(var c=this.s();b&&b!==c;){var d=b.id;if(d in this.Mb){b=this.Mb[d];break a}b=b.parentNode}b=null}if(b)switch(a.type){case "mousedown":b.Hc(a);break;case "mouseup":b.Wb(a);break;case "mouseover":b.Me(a);break;case "mouseout":b.Le(a);break;case "contextmenu":b.Ic(a)}};
h.Kf=function(){};h.Jf=function(){this.Jb(-1);this.sb=!1;this.ma&&this.ma.ka(!1)};h.Ta=function(a){return this.isEnabled()&&this.Ja&&(0!=ss(this)||this.Re)&&this.Ee(a)?(a.preventDefault(),a.Ec(),!0):!1};
h.Ee=function(a){var b=wt(this);if(b&&"function"==typeof b.Ta&&b.Ta(a)||this.ma&&this.ma!=b&&"function"==typeof this.ma.Ta&&this.ma.Ta(a))return!0;if(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)return!1;switch(a.g){case 27:if(this.jc)tt(this).blur();else return!1;break;case 36:xt(this);break;case 35:yt(this);break;case 38:if(this.ac==at)zt(this);else return!1;break;case 37:if(this.ac==$s)us(this)?At(this):zt(this);else return!1;break;case 40:if(this.ac==at)At(this);else return!1;break;case 39:if(this.ac==
$s)us(this)?zt(this):At(this);else return!1;break;default:return!1}return!0};function ut(a,b){var c=b.s(),c=c.id||(c.id=b.F());a.Mb||(a.Mb={});a.Mb[c]=b}h.oa=function(a,b){st.m.oa.call(this,a,b)};h.de=function(a,b,c){a.Rc|=2;a.Rc|=64;pt(a,32,!1);lt(a);st.m.de.call(this,a,b,c);a.V&&this.V&&ut(this,a);b<=this.nb&&this.nb++};function Zs(a,b){if(a.s())throw Error("Component already rendered");a.ac=b}
h.Fc=function(a,b){if(b||this.Ja!=a&&this.dispatchEvent(a?"show":"hide")){this.Ja=a;var c=this.s();c&&(vi(c,a),this.jc&&Ws(tt(this),this.Qb&&this.Ja),b||this.dispatchEvent(this.Ja?"aftershow":"afterhide"));return!0}return!1};h.isEnabled=function(){return this.Qb};
h.setEnabled=function(a){this.Qb!=a&&this.dispatchEvent(a?"enable":"disable")&&(a?(this.Qb=!0,rs(this,function(a){a.cg?delete a.cg:a.setEnabled(!0)})):(rs(this,function(a){a.isEnabled()?a.setEnabled(!1):a.cg=!0}),this.sb=this.Qb=!1),this.jc&&Ws(tt(this),a&&this.Ja))};function Ct(a,b){b!=a.jc&&a.V&&vt(a,b);a.jc=b;a.Qb&&a.Ja&&Ws(tt(a),b)}h.Jb=function(a){(a=ts(this,a))?a.ab(!0):-1<this.nb&&wt(this).ab(!1)};h.ab=function(a){this.Jb(vs(this,a))};function wt(a){return ts(a,a.nb)}
function xt(a){Dt(a,function(a,c){return(a+1)%c},ss(a)-1)}function yt(a){Dt(a,function(a,c){a--;return 0>a?c-1:a},0)}function At(a){Dt(a,function(a,c){return(a+1)%c},a.nb)}function zt(a){Dt(a,function(a,c){a--;return 0>a?c-1:a},a.nb)}function Dt(a,b,c){c=0>c?vs(a,a.ma):c;var d=ss(a);c=b.call(a,c,d);for(var e=0;e<=d;){var f=ts(a,c);if(f&&a.yf(f)){a.Jb(c);break}e++;c=b.call(a,c,d)}}h.yf=function(a){return a.Za&&a.isEnabled()&&!!(a.ia&2)};function Et(){}E(Et,ct);da(Et);Et.prototype.G=function(){return"goog-menuheader"};function Ft(a,b,c){$.call(this,a,c||Et.U(),b);pt(this,1,!1);pt(this,2,!1);pt(this,4,!1);pt(this,32,!1);this.Ab=1}E(Ft,$);Ts("goog-menuheader",function(){return new Ft(null)});function Gt(){this.h=[]}E(Gt,ct);da(Gt);function Ht(a,b){var c=a.h[b];if(!c){switch(b){case 0:c=a.G()+"-highlight";break;case 1:c=a.G()+"-checkbox";break;case 2:c=a.G()+"-content"}a.h[b]=c}return c}h=Gt.prototype;h.Ub=function(){return"menuitem"};h.Y=function(a){var b=a.h.K("div",et(this,a).join(" "),It(this,a.la(),a.h));Jt(this,a,b,!!(a.ia&8)||!!(a.ia&16));ft(this,a,b);return b};h.va=function(a){return a&&a.firstChild};
h.ua=function(a,b){var c=Rg(b),d=Ht(this,2);c&&Ns(c,d)||b.appendChild(It(this,b.childNodes,a.h));Ns(b,"goog-option")&&(pt(a,16,!0),(c=a.s())&&Kt(a.i,a,c),Kt(this,a,b));return Gt.m.ua.call(this,a,b)};h.nc=function(a,b){var c=this.va(a),d=Lt(this,a)?c.firstChild:null;Gt.m.nc.call(this,a,b);d&&!Lt(this,a)&&c.insertBefore(d,c.firstChild||null)};function It(a,b,c){a=Ht(a,2);return c.K("div",a,b)}function Kt(a,b,c){c&&(xs(c,"menuitemcheckbox"),Jt(a,b,c,!0))}
function Lt(a,b){var c=a.va(b);if(c){var c=c.firstChild,d=Ht(a,1);return!!c&&A(c)&&1==c.nodeType&&Ns(c,d)}return!1}function Jt(a,b,c,d){d!=Lt(a,c)&&(d?Os(c,"goog-option"):Qs(c,"goog-option"),c=a.va(c),d?(a=Ht(a,1),c.insertBefore(b.h.K("div",a),c.firstChild||null)):c.removeChild(c.firstChild))}h.Ac=function(a){switch(a){case 2:return Ht(this,0);case 16:case 8:return"goog-option-selected";default:return Gt.m.Ac.call(this,a)}};
h.ue=function(a){var b=Ht(this,0);switch(a){case "goog-option-selected":return 16;case b:return 2;default:return Gt.m.ue.call(this,a)}};h.G=function(){return"goog-menuitem"};function Mt(a,b,c,d){$.call(this,a,d||Gt.U(),c);this.R=b}E(Mt,$);h=Mt.prototype;h.Q=function(){var a=this.R;return null!=a?a:this.xb()};h.xb=function(){var a=this.la();return u(a)?(a=Qa(a,function(a){return A(a)&&1==a.nodeType&&(Ns(a,"goog-menuitem-accel")||Ns(a,"goog-menuitem-mnemonic-separator"))?"":Yg(a)}).join(""),ua(a)):Mt.m.xb.call(this)};
h.Wb=function(a){var b=this.getParent();if(b){var c=b.g;b.g=null;if(b=c&&y(a.clientX))b=new Ag(a.clientX,a.clientY),b=c==b?!0:c&&b?c.x==b.x&&c.y==b.y:!1;if(b)return}Mt.m.Wb.call(this,a)};h.oc=function(a){return a.g==this.Sf&&this.Gb(a)?!0:Mt.m.oc.call(this,a)};h.xg=function(){return this.Sf};Ts("goog-menuitem",function(){return new Mt(null)});function Nt(){}E(Nt,ct);da(Nt);Nt.prototype.Y=function(a){return a.h.K("div",this.G())};Nt.prototype.ua=function(a,b){b.id&&ms(a,b.id);if("HR"==b.tagName){var c=b;b=this.Y(a);Pg(b,c);Qg(c)}else Os(b,this.G());return b};Nt.prototype.nc=function(){};Nt.prototype.G=function(){return"goog-menuseparator"};function Ot(a,b){$.call(this,null,a||Nt.U(),b);pt(this,1,!1);pt(this,2,!1);pt(this,4,!1);pt(this,32,!1);this.Ab=1}E(Ot,$);Ot.prototype.$=function(){Ot.m.$.call(this);var a=this.s();xs(a,"separator")};Ts("goog-menuseparator",function(){return new Ot});function Pt(){}E(Pt,Vs);da(Pt);h=Pt.prototype;h.Ce=function(){return"menu"};h.Ae=function(a){return"UL"==a.tagName||Pt.m.Ae.call(this,a)};h.Bc=function(a){return"HR"==a.tagName?new Ot:Pt.m.Bc.call(this,a)};h.G=function(){return"goog-menu"};h.De=function(a){Pt.m.De.call(this,a);a=a.s();ys(a,"haspopup","true")};Ts("goog-menuseparator",function(){return new Ot});function Qt(a,b){st.call(this,at,b||Pt.U(),a);Ct(this,!1)}E(Qt,st);h=Qt.prototype;h.fe=!0;h.G=function(){return this.mb.G()};h.pd=function(){var a=[];rs(this,function(b){a.push(b)});return a};h.Fc=function(a,b,c){(b=Qt.m.Fc.call(this,a,b))&&a&&this.V&&this.fe&&tt(this).focus();a&&c&&y(c.clientX)?this.g=new Ag(c.clientX,c.clientY):this.g=null;return b};h.Ie=function(a){this.fe&&tt(this).focus();return Qt.m.Ie.call(this,a)};h.yf=function(a){return a.isEnabled()&&a.Za&&!!(a.ia&2)};
h.Nb=function(a){for(var b=this.mb,c=Hg(this.h.g,"div",b.G()+"-content",a),d=c.length,e=0;e<d;e++)bt(b,this,c[e]);Qt.m.Nb.call(this,a)};h.Ee=function(a){var b=Qt.m.Ee.call(this,a);b||rs(this,function(c){!b&&c.xg&&c.Sf==a.g&&(this.isEnabled()&&this.ab(c),b=c.Ta(a))},this);return b};
h.Jb=function(a){Qt.m.Jb.call(this,a);if(a=ts(this,a)){var b=a.s();a=this.s();var c=pi(b),d=pi(a),e=Ci(a),f=c.x-d.x-e.left,c=c.y-d.y-e.top,d=a.clientHeight-b.offsetHeight,e=a.scrollLeft,g=a.scrollTop,e=e+Math.min(f,Math.max(f-(a.clientWidth-b.offsetWidth),0)),g=g+Math.min(c,Math.max(c-d,0)),b=new Ag(e,g);a.scrollLeft=b.x;a.scrollTop=b.y}};function Rt(){}E(Rt,Nt);da(Rt);Rt.prototype.Y=function(a){return a.h.K("div",this.G()+" goog-inline-block","\u00a0")};Rt.prototype.ua=function(a,b){b=Rt.m.ua.call(this,a,b);Os(b,"goog-inline-block");return b};Rt.prototype.G=function(){return"goog-toolbar-separator"};function St(){}E(St,Vs);da(St);St.prototype.Ce=function(){return"toolbar"};St.prototype.Bc=function(a){return"HR"==a.tagName?new Ot(Rt.U()):St.m.Bc.call(this,a)};St.prototype.G=function(){return"goog-toolbar"};St.prototype.Ef=function(){return $s};function Tt(a,b,c){st.call(this,b,a||St.U(),c)}E(Tt,st);function Ut(a,b,c,d,e,f,g,k,l){var m,n;if(m=c.offsetParent){var p="HTML"==m.tagName||"BODY"==m.tagName;p&&"static"==li(m,"position")||(n=pi(m),p||(p=(p=qi(m))&&Gb?-m.scrollLeft:!p||H&&Tb("8")||"visible"==li(m,"overflowX")?m.scrollLeft:m.scrollWidth-m.clientWidth-m.scrollLeft,n=Bg(n,new Ag(p,m.scrollTop))))}m=n||new Ag;n=ui(a);if(p=oi(a)){var q=new ji(p.left,p.top,p.right-p.left,p.bottom-p.top),p=Math.max(n.left,q.left),t=Math.min(n.left+n.width,q.left+q.width);if(p<=t){var x=Math.max(n.top,q.top),
q=Math.min(n.top+n.height,q.top+q.height);x<=q&&(n.left=p,n.top=x,n.width=t-p,n.height=q-x)}}p=Dg(a);x=Dg(c);if(p.g!=x.g){var t=p.g.body,x=Lg(x.g),q=new Ag(0,0),z;z=(z=Fg(t))?Lg(z):window;var D=t;do{var F;if(z==x)F=pi(D);else{var J=D;F=void 0;if(J.getBoundingClientRect)F=mi(J),F=new Ag(F.left,F.top);else{F=ah(Dg(J));var N=pi(J);F=new Ag(N.x-F.x,N.y-F.y)}if(Gb&&!Tb(12)){N=void 0;H?N="-ms-transform":Hb?N="-webkit-transform":Fb?N="-o-transform":Gb&&(N="-moz-transform");var fa=void 0;N&&(fa=li(J,N));
fa||(fa=li(J,"transform"));J=fa?(J=fa.match(Di))?new Ag(parseFloat(J[1]),parseFloat(J[2])):new Ag(0,0):new Ag(0,0);F=new Ag(F.x+J.x,F.y+J.y)}}q.x+=F.x;q.y+=F.y}while(z&&z!=x&&(D=z.frameElement)&&(z=z.parent));t=Bg(q,pi(t));H&&!$g(p)&&(t=Bg(t,ah(p)));n.left+=t.x;n.top+=t.y}a=Vt(a,b);b=new Ag(a&2?n.left+n.width:n.left,a&1?n.top+n.height:n.top);b=Bg(b,m);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var I;if(g)if(l)I=l;else if(I=oi(c))I.top-=m.y,I.right-=m.x,I.bottom-=m.y,I.left-=m.x;a:{l=b.ba();e=0;
a=Vt(c,d);d=si(c);k=k?k.ba():d.ba();if(f||0!=a)a&2?l.x-=k.width+(f?f.right:0):f&&(l.x+=f.left),a&1?l.y-=k.height+(f?f.bottom:0):f&&(l.y+=f.top);if(g&&(I?(f=l,e=0,65==(g&65)&&(f.x<I.left||f.x>=I.right)&&(g&=-2),132==(g&132)&&(f.y<I.top||f.y>=I.bottom)&&(g&=-5),f.x<I.left&&g&1&&(f.x=I.left,e|=1),f.x<I.left&&f.x+k.width>I.right&&g&16&&(k.width=Math.max(k.width-(f.x+k.width-I.right),0),e|=4),f.x+k.width>I.right&&g&1&&(f.x=Math.max(I.right-k.width,I.left),e|=1),g&2&&(e=e|(f.x<I.left?16:0)|(f.x+k.width>
I.right?32:0)),f.y<I.top&&g&4&&(f.y=I.top,e|=2),f.y<=I.top&&f.y+k.height<I.bottom&&g&32&&(k.height=Math.max(k.height-(I.top-f.y),0),f.y=I.top,e|=8),f.y>=I.top&&f.y+k.height>I.bottom&&g&32&&(k.height=Math.max(k.height-(f.y+k.height-I.bottom),0),e|=8),f.y+k.height>I.bottom&&g&4&&(f.y=Math.max(I.bottom-k.height,I.top),e|=2),g&8&&(e=e|(f.y<I.top?64:0)|(f.y+k.height>I.bottom?128:0)),g=e):g=256,e=g,e&496)){c=e;break a}f=Gb&&(Ab||Kb)&&Tb("1.9");l instanceof Ag?(g=l.x,l=l.y):(g=l,l=void 0);c.style.left=ri(g,
f);c.style.top=ri(l,f);d==k||d&&k&&d.width==k.width&&d.height==k.height||(f=$g(Dg(Fg(c))),!H||f&&Tb("8")?(c=c.style,Gb?c.MozBoxSizing="border-box":Hb?c.WebkitBoxSizing="border-box":c.boxSizing="border-box",c.width=Math.max(k.width,0)+"px",c.height=Math.max(k.height,0)+"px"):(g=c.style,f?(H?(f=zi(c,"paddingLeft"),d=zi(c,"paddingRight"),l=zi(c,"paddingTop"),I=zi(c,"paddingBottom"),f=new ii(l,d,I,f)):(f=ki(c,"paddingLeft"),d=ki(c,"paddingRight"),l=ki(c,"paddingTop"),I=ki(c,"paddingBottom"),f=new ii(parseFloat(l),
parseFloat(d),parseFloat(I),parseFloat(f))),c=Ci(c),g.pixelWidth=k.width-c.left-f.left-f.right-c.right,g.pixelHeight=k.height-c.top-f.top-f.bottom-c.bottom):(g.pixelWidth=k.width,g.pixelHeight=k.height)));c=e}return c}function Vt(a,b){return(b&4&&qi(a)?b^2:b)&-5};function Wt(){}Wt.prototype.l=function(){};function Xt(a,b,c){this.g=a;this.h=b;this.o=c}E(Xt,Wt);Xt.prototype.l=function(a,b,c){Ut(this.g,this.h,a,b,void 0,c,this.o)};function Yt(a,b,c,d){Xt.call(this,a,b);this.i=c?5:0;this.j=d||void 0}E(Yt,Xt);Yt.prototype.n=function(){return this.i};Yt.prototype.l=function(a,b,c,d){var e=Ut(this.g,this.h,a,b,null,c,10,d,this.j);if(e&496){var f=Zt(e,this.h);b=Zt(e,b);e=Ut(this.g,f,a,b,null,c,10,d,this.j);e&496&&(f=Zt(e,f),b=Zt(e,b),Ut(this.g,f,a,b,null,c,this.i,d,this.j))}};function Zt(a,b){a&48&&(b^=2);a&192&&(b^=1);return b};function $t(a,b,c,d){Yt.call(this,a,b,c||d);if(c||d)this.i=65|(d?32:132)}E($t,Yt);function au(){}E(au,ct);da(au);h=au.prototype;h.Ub=function(){return"button"};h.Ka=function(a,b,c){switch(b){case 8:case 16:ys(a,"pressed",c);break;default:case 64:case 1:au.m.Ka.call(this,a,b,c)}};h.Y=function(a){var b=au.m.Y.call(this,a),c=a.p;b&&c&&(b.title=c);(c=a.Q())&&this.ye(b,c);a.ia&16&&this.Ka(b,16,jt(a,16));return b};h.ua=function(a,b){b=au.m.ua.call(this,a,b);var c=this.Q(b);a.I=c;a.p=b.title;a.ia&16&&this.Ka(b,16,jt(a,16));return b};h.Q=ca;h.ye=ca;h.G=function(){return"goog-button"};function bu(){}E(bu,au);da(bu);h=bu.prototype;h.Ub=function(){};h.Y=function(a){lt(a);a.Lb&=-256;pt(a,32,!1);return a.h.K("button",{"class":et(this,a).join(" "),disabled:!a.isEnabled(),title:a.p||"",value:a.Q()||""},a.xb()||"")};h.ud=function(a){return"BUTTON"==a.tagName||"INPUT"==a.tagName&&("button"==a.type||"submit"==a.type||"reset"==a.type)};h.ua=function(a,b){lt(a);a.Lb&=-256;pt(a,32,!1);if(b.disabled){var c=this.Ac(1);Os(b,c)}return bu.m.ua.call(this,a,b)};
h.Lf=function(a){ns(a).listen(a.s(),"click",a.Gb)};h.vd=ca;h.Ge=ca;h.Fe=function(a){return a.isEnabled()};h.Gc=ca;h.P=function(a,b,c){bu.m.P.call(this,a,b,c);(a=a.s())&&1==b&&(a.disabled=c)};h.Q=function(a){return a.value};h.ye=function(a,b){a&&(a.value=b)};h.Ka=ca;function cu(a,b,c){$.call(this,a,b||bu.U(),c)}E(cu,$);h=cu.prototype;h.Q=function(){return this.I};h.If=function(a){this.I=a;this.i.ye(this.s(),a)};h.J=function(){cu.m.J.call(this);delete this.I;delete this.p};h.$=function(){cu.m.$.call(this);if(this.ia&32){var a=this.i.Vb(this);a&&ns(this).listen(a,"keyup",this.oc)}};h.oc=function(a){return 13==a.g&&"key"==a.type||32==a.g&&"keyup"==a.type?this.Gb(a):32==a.g};Ts("goog-button",function(){return new cu(null)});function du(){}E(du,au);da(du);h=du.prototype;h.Y=function(a){var b=et(this,a),b=a.h.K("div",{"class":"goog-inline-block "+b.join(" ")},this.ld(a.la(),a.h)),c=a.p;b&&c&&(b.title=c);ft(this,a,b);return b};h.Ub=function(){return"button"};h.va=function(a){return a&&a.firstChild.firstChild};h.ld=function(a,b){return b.K("div","goog-inline-block "+(this.G()+"-outer-box"),b.K("div","goog-inline-block "+(this.G()+"-inner-box"),a))};h.ud=function(a){return"DIV"==a.tagName};
h.ua=function(a,b){eu(b,!0);eu(b,!1);var c;a:{c=a.h.Ff(b);var d=this.G()+"-outer-box";if(c&&Ns(c,d)&&(c=a.h.Ff(c),d=this.G()+"-inner-box",c&&Ns(c,d))){c=!0;break a}c=!1}c||b.appendChild(this.ld(b.childNodes,a.h));Ps(b,["goog-inline-block",this.G()]);return du.m.ua.call(this,a,b)};h.G=function(){return"goog-custom-button"};
function eu(a,b){if(a)for(var c=b?a.firstChild:a.lastChild,d;c&&c.parentNode==a;){d=b?c.nextSibling:c.previousSibling;if(3==c.nodeType){var e=c.nodeValue;if(""==va(e))a.removeChild(c);else{c.nodeValue=b?e.replace(/^[\s\xa0]+/,""):e.replace(/[\s\xa0]+$/,"");break}}else break;c=d}};function fu(){}E(fu,du);da(fu);Gb&&(fu.prototype.nc=function(a,b){var c=fu.m.va.call(this,a&&a.firstChild);if(c){var d;d=Dg(a).K("div","goog-inline-block "+(this.G()+"-caption"),b);var e=c.parentNode;e&&e.replaceChild(d,c)}});h=fu.prototype;h.va=function(a){a=fu.m.va.call(this,a&&a.firstChild);Gb&&a&&a.__goog_wrapper_div&&(a=a.firstChild);return a};h.Ka=function(a,b,c){64!=b&&fu.m.Ka.call(this,a,b,c)};
h.ua=function(a,b){var c=Hg(document,"*","goog-menu",b)[0];if(c){vi(c,!1);Fg(c).body.appendChild(c);var d=new Qt;qs(d,c);a.Qc(d)}return fu.m.ua.call(this,a,b)};h.ld=function(a,b){return fu.m.ld.call(this,[b.K("div","goog-inline-block "+(this.G()+"-caption"),a),b.K("div","goog-inline-block "+(this.G()+"-dropdown"),"\u00a0")],b)};h.G=function(){return"goog-menu-button"};function gu(a,b,c,d){cu.call(this,a,c||fu.U(),d);pt(this,64,!0);this.n=new $t(null,5);b&&this.Qc(b);this.ga=new cf(500);!Hh&&!Ih||Tb("533.17.9")||(this.Ad=!0)}E(gu,cu);h=gu.prototype;h.Ad=!1;h.$=function(){gu.m.$.call(this);this.g&&hu(this,this.g,!0);ys(this.T,"haspopup",!!this.g)};h.fb=function(){gu.m.fb.call(this);if(this.g){this.ka(!1);this.g.fb();hu(this,this.g,!1);var a=this.g.s();a&&Qg(a)}};h.J=function(){gu.m.J.call(this);this.g&&(this.g.Aa(),delete this.g);delete this.ja;this.ga.Aa()};
h.Hc=function(a){gu.m.Hc.call(this,a);jt(this,4)&&(this.ka(!jt(this,64),a),this.g&&(this.g.sb=jt(this,64)))};h.Wb=function(a){gu.m.Wb.call(this,a);this.g&&!jt(this,4)&&(this.g.sb=!1)};h.Gb=function(){ot(this,!1);return!0};h.Hg=function(a){this.g&&this.g.Ja&&!this.He(a.target)&&this.ka(!1)};h.He=function(a){var b;if(!(b=a&&Sg(this.s(),a))){if(b=this.g)a:if(b=this.g,Sg(b.s(),a))b=!0;else{for(var c=0,d=ss(b);c<d;c++){var e=ts(b,c);if("function"==typeof e.He&&e.He(a)){b=!0;break a}}b=!1}b=b||!1}return b};
h.oc=function(a){if(32==a.g){if(a.preventDefault(),"keyup"!=a.type)return!0}else if("key"!=a.type)return!1;if(this.g&&this.g.Ja){var b=this.g.Ta(a);return 27==a.g?(this.ka(!1),!0):b}return 40==a.g||38==a.g||32==a.g||13==a.g?(this.ka(!0),!0):!1};h.Je=function(){this.ka(!1)};h.Mg=function(){jt(this,4)||this.ka(!1)};h.wd=function(a){this.Ad||this.ka(!1);gu.m.wd.call(this,a)};
h.Qc=function(a){var b=this.g;if(a!=b&&(b&&(this.ka(!1),this.V&&hu(this,b,!1),delete this.g),this.V&&ys(this.T,"haspopup",!!a),a)){this.g=a;os(a,this);a.Fc(!1);var c=this.Ad;(a.fe=c)&&Ct(a,!0);this.V&&hu(this,a,!0)}return b};h.setEnabled=function(a){gu.m.setEnabled.call(this,a);this.isEnabled()||this.ka(!1)};
h.ka=function(a,b){gu.m.ka.call(this,a);if(this.g&&jt(this,64)==a){if(a)this.g.V||this.g.render(),this.S=oi(this.s()),this.N=ui(this.s()),iu(this),this.g.Jb(-1);else{ot(this,!1);this.g.sb=!1;var c=this.s();c&&ys(c,"activedescendant","");if(null!=this.o&&(this.o=void 0,c=this.g.s())){var d="",e;d instanceof Cg?(e=d.height,d=d.width):e="";c.style.width=ri(d,!0);c.style.height=ri(e,!0)}}this.g.Fc(a,!1,b);this.C||(c=ns(this),d=a?c.listen:c.ya,d.call(c,this.h.g,"mousedown",this.Hg,!0),this.Ad&&d.call(c,
this.g,"blur",this.Mg),d.call(c,this.ga,df,this.Ug),a?(c=this.ga,c.rd=!0,c.ga||(c.ga=c.g.setTimeout(c.i,c.h),c.j=C())):this.ga.stop())}};function iu(a){if(a.g.V){var b=a.ja||a.s(),c=a.n;a.n.g=b;b=a.g.s();a.g.Ja||(b.style.visibility="hidden",vi(b,!0));!a.o&&a.n.n&&a.n.i&32&&(a.o=si(b));c.l(b,c.h^1,null,a.o);a.g.Ja||(vi(b,!1),b.style.visibility="visible")}}
h.Ug=function(){var a=ui(this.s()),b=oi(this.s()),c=this.N;(c=!(c==a||c&&a&&c.left==a.left&&c.width==a.width&&c.top==a.top&&c.height==a.height))||(c=this.S,c=!(c==b||c&&b&&c.top==b.top&&c.right==b.right&&c.bottom==b.bottom&&c.left==b.left));c&&(this.N=a,this.S=b,iu(this))};function hu(a,b,c){var d=ns(a);c=c?d.listen:d.ya;c.call(d,b,"action",a.Je);c.call(d,b,"highlight",a.Cg);c.call(d,b,"unhighlight",a.Dg)}h.Cg=function(a){var b=this.s();null!=a.target.s()&&ys(b,"activedescendant",a.target.s().id)};
h.Dg=function(){if(!wt(this.g)){var a=this.s();ys(a,"activedescendant","")}};Ts("goog-menu-button",function(){return new gu(null)});function ju(a){Kc.call(this);this.g=[];ku(this,a)}E(ju,Kc);ju.prototype.h=null;function ku(a,b){b&&(Oa(b,function(a){lu(a,!1)},a),$a(a.g,b))}ju.prototype.pd=function(){return Za(this.g)};function mu(a){var b=a.h;return b?Na(a.g,b):-1}ju.prototype.clear=function(){Wa(this.g);this.h=null};ju.prototype.J=function(){ju.m.J.call(this);delete this.g;this.h=null};function lu(a,b){a&&"function"==typeof a.af&&a.af(b)};function nu(a,b,c,d){gu.call(this,a,b,c,d);this.B=this.la()}E(nu,gu);h=nu.prototype;h.ha=null;h.$=function(){nu.m.$.call(this);ou(this);pu(this)};h.Nb=function(a){nu.m.Nb.call(this,a);(a=this.xb())?(this.B=a,ou(this)):this.ha&&qu(this,this.ha.g[0]||null)};h.J=function(){nu.m.J.call(this);this.ha&&(this.ha.Aa(),this.ha=null);this.B=null};h.Je=function(a){qu(this,a.target);nu.m.Je.call(this,a);a.Ec();this.dispatchEvent("action")};h.Pg=function(){var a=ru(this);nu.m.If.call(this,a&&a.Q());ou(this)};
h.Qc=function(a){var b=nu.m.Qc.call(this,a);a!=b&&(this.ha&&this.ha.clear(),a&&(this.ha?rs(a,function(a){su(a);var b=this.ha,e=b.g.length;a&&(lu(a,!1),ab(b.g,e,0,a))},this):tu(this,a)));return b};function qu(a,b){if(a.ha){var c=ru(a),d=a.ha;b!=d.h&&(lu(d.h,!1),d.h=b,lu(b,!0));d.dispatchEvent("select");b!=c&&a.dispatchEvent("change")}}h.If=function(a){if(null!=a&&this.ha)for(var b=0,c;c=this.ha.g[b]||null;b++)if(c&&"function"==typeof c.Q&&c.Q()==a){qu(this,c);return}qu(this,null)};
function ru(a){return a.ha?a.ha.h:null}function tu(a,b){a.ha=new ju;b&&rs(b,function(a){su(a);var b=this.ha,e=b.g.length;a&&(lu(a,!1),ab(b.g,e,0,a))},a);pu(a)}function pu(a){a.ha&&ns(a).listen(a.ha,"select",a.Pg)}function ou(a){var b=ru(a),b=b?b.xb():a.B;a.i.nc(a.s(),b);a.zb=b}function su(a){a.Xe=a instanceof Mt?"option":"separator"}h.ka=function(a,b){nu.m.ka.call(this,a,b);jt(this,64)&&(this.g||this.Qc(new Qt(this.h)),(this.g||null).Jb(this.ha?mu(this.ha):-1))};Ts("goog-select",function(){return new nu(null)});function uu(){}E(uu,fu);da(uu);uu.prototype.G=function(){return"goog-toolbar-menu-button"};function vu(a,b,c,d){nu.call(this,a,b,c||uu.U(),d)}E(vu,nu);Ts("goog-toolbar-select",function(){return new vu(null)});function wu(){}E(wu,ct);da(wu);h=wu.prototype;h.Ub=function(){};function xu(a,b,c,d){var e=d.K("div",a.G()+"-inner-box");a=d.K("div",a.G()+"-outer-box",e);d.appendChild(b,a);d.appendChild(e,c)}h.ua=function(a,b){var c=a.h,d=b;b=c.K("div","goog-inline-block");c.Rg(b,d);xu(this,b,d,c);wu.m.ua.call(this,a,b);a.zb=d.value;return b};h.Y=function(a){var b=a.h,c=b.K("div","goog-inline-block "+et(this,a).join(" "));a=b.K("input",{type:"text",value:a.la()||"",disabled:!a.isEnabled()});xu(this,c,a,b);return c};
h.ud=function(a){return"INPUT"==a.tagName&&(!a.type||"TEXT"==a.type.toUpperCase())};h.va=function(a){if(a)a:{a=a.getElementsByTagName("input");for(var b=0;b<a.length;++b){var c=a[b];if(!c.type||"TEXT"==c.type.toUpperCase()){a=c;break a}}a=null}else a=null;return a};h.Vb=function(a){return this.va(a.s())};h.Ge=ca;h.Fe=function(a){return a.isEnabled()};h.Gc=ca;h.P=function(a,b,c){wu.m.P.call(this,a,b,c);1==b&&(a=this.va(a.s()))&&(a.disabled=c)};h.Ka=ca;
h.nc=function(a,b){var c=this.va(a);c&&(c.value=b)};h.la=function(a){return(a=this.va(a))?a.value:null};h.G=function(){return"wgui-textinput"};function yu(a,b,c){$.call(this,a,b||wu.U(),c);lt(this);this.$c=!0;(b=this.s())&&this.i.vd(b,!0);this.Lb&=-256;pt(this,32,!1);a||(this.zb="")}E(yu,$);yu.prototype.$=function(){yu.m.$.call(this);var a=this.i.Vb(this);if(a){var b=this.j||(this.j=new Ds);Es(b,a);ns(this).listen(b,"key",this.Ta)}};yu.prototype.la=function(){return this.s()?this.i.la(this.s()):null};yu.prototype.Q=function(){return this.la()};yu.prototype.xb=function(){return this.la()||""};function zu(a,b){this.parent=a;this.g=b}function Au(a){var b=a.parent.sa();return b?b.value(a.g):null}function Bu(a){a=Cu(a.parent.W).module_fields[a.g];return w(a.label)?a.label.replace(/:$/,""):a.label}var Du=["name","email"];zu.prototype.toString=function(){return this.parent+";Field:"+this.g};function Eu(a,b){this.W=a;this.Bb=b||"";this.g={}}Eu.prototype.sa=function(){return this.W.sa()};function Fu(a){var b=Cu(a.W),c=[],d;for(d in b.module_fields){var e=b.module_fields[d];a.Bb&&e.group==a.Bb?c.push(d):a.Bb||e.group||c.push(d)}return c}function Gu(a,b){a.g[b]||(a.g[b]=new zu(a,b));return a.g[b]}function Hu(a){a=a.Bb.replace("_"," ");return a=a.charAt(0).toUpperCase()+a.substr(1)};function Iu(a,b){Kc.call(this);this.parent=a;this.g=b;this.h={}}E(Iu,Kc);h=Iu.prototype;h.logger=R("ydn.crm.sugar.model.Record");h.Uc=function(){return this.g.W};function Cu(a){return a.parent.h(a.Uc())}h.J=function(){Iu.m.J.call(this);this.h=null};h.sa=function(){return this.g};h.Od=function(a){((a=a?a.g?a:null:null)||this.g)&&a!==this.g&&(this.g=a,this.dispatchEvent(new Ju(this.g?this.g.W:null,0,this)))};h.toString=function(){return"ydn.crm.sugar.model.Record:"+this.g};function Ku(a,b){Iu.call(this,a,new Aq(a.df(),b));this.module_name=b}E(Ku,Iu);Ku.prototype.Uc=function(){return this.module_name};Ku.prototype.Od=function(a){if(a&&a.W!=this.module_name)throw Error("Module name must be "+this.module_name+" but found "+a.W);Ku.m.Od.call(this,a)};Ku.prototype.toString=function(){return"ydn.crm.sugar.model.Module:"+this.module_name+(this.g?":"+this.g:"")};function Lu(a,b){K.call(this,a,b)}E(Lu,K);function Ju(a,b,c){K.call(this,"record-change",c);this.W=a}E(Ju,Lu);function Mu(){}E(Mu,ct);da(Mu);Mu.prototype.G=function(){return"field"};
Mu.prototype.Y=function(a){var b=a.h.K("span",et(this,a).join(" "),a.la());ft(this,a,b);a.T=b;var c=a.R;a=a.h;var d,e=Bu(c);d=Cu(c.parent.W).module_fields[c.g].type||"varchar";if("bool"==d)d=a.K("input",{"class":"value",type:"checkbox",disabled:"1"});else if("enum"==d){d=a.K("select",{"class":"value",disabled:"1"});var f=Cu(c.parent.W).module_fields[c.g].options||{},g;for(g in f){var k=a.K("option",{name:f[g].name},f[g].value);d.appendChild(k)}}else d=a.K("label","value");d.setAttribute("title",e);
b.classList.add("field");b.setAttribute("name",c.g);b.appendChild(d);return b};Mu.prototype.refresh=function(a,b){vi(a,!!b);if(b){var c=Au(b),d=w(c)?!ta(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":Nu(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function Ou(){}E(Ou,ct);da(Ou);Ou.prototype.G=function(){return"field"};
Ou.prototype.Y=function(a){var b=Ou.m.Y.call(this,a);a.T=b;var c=a.R,d=a.h,e=Bu(c);"bool"==(Cu(c.parent.W).module_fields[c.g].type||"varchar")?(a=d.K("input",{"class":"value",type:"checkbox",disabled:"1"}),d=d.K("span","name")):(a=d.K("label","value"),d=d.K("sup","name"));d.textContent=e;b.classList.add("field");b.setAttribute("name",c.g);b.appendChild(a);b.appendChild(d);a=c.parent;e=a.W;d=e.parent.i();e=A(d)?lc(d,["modules",e.Uc()]):null;a=A(e)?lc(e,["groups",a.Bb]):null;((a=A(a)?lc(a,["fields",
c.g]):null)?a.normallyHide:-1==Du.indexOf(c.g))&&b.classList.add("normally-hide");return b};Ou.prototype.refresh=function(a,b){vi(a,!!b);if(b){var c=Au(b),d=w(c)?!ta(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":Nu(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function Pu(a,b,c){$.call(this,null,b,c);this.R=a}E(Pu,$);Rs(Pu,Ou);Pu.prototype.refresh=function(){this.i.refresh(this.s(),this.R)};Rs(Pu,Ou);function Nu(a,b){var c=a.type;if(s(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b?"checked":null;break;case "select-one":a.selectedIndex=-1;if(w(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":c=b;w(c)&&(c=[c]);for(var e=0;d=a.options[e];e++)if(d.selected=!1,c)for(var f,g=0;f=c[g];g++)d.value==f&&(d.selected=!0);break;default:a.value=null!=b?b:""}};function Qu(){}E(Qu,Vs);da(Qu);Qu.prototype.G=function(){return"record-group"};Qu.prototype.Be=function(a){var b=Qu.m.Be.call(this,a);a.T=b;xg(b,this.G());for(var c=a.R,d=a.h,e=Fu(c),f=0;f<e.length;f++){var g=Gu(c,e[f]),k=Ou.U(),g=new Pu(g,k,d);a.oa(g,!0)}return b};function Ru(a,b,c){st.call(this,at,b,c);this.R=a}E(Ru,st);Ru.prototype.refresh=function(){for(var a=0;a<ss(this);a++)ts(this,a).refresh()};Rs(Ru,Qu);function Su(){}E(Su,ct);da(Su);Su.prototype.G=function(){return"record-group"};Su.prototype.Y=function(a){var b=Su.m.Y.call(this,a);a.T=b;b.setAttribute("name",a.R.Bb);var c=Qu.U(),c=new Ru(a.R,c,a.h);a.oa(c,!0);return b};function Tu(a,b,c){$.call(this,null,b,c);this.R=a}E(Tu,$);Tu.prototype.refresh=function(){for(var a=0;a<ss(this);a++)ts(this,a).refresh()};Rs(Tu,Su);function Uu(){}E(Uu,ct);da(Uu);Uu.prototype.G=function(){return"address"};Uu.prototype.Y=function(a){var b=Uu.m.Y.call(this,a),c=a.R,d=a.h;b.setAttribute("name",c.Bb);b.classList.add("record-group");var e=d.K("details"),f=d.K("summary");f.textContent=Hu(c);b.appendChild(f);var g=d.K("div","content");e.appendChild(f);e.appendChild(g);b.appendChild(e);a.T=b;e=Fu(c);f=Mu.U();for(g=0;g<e.length;g++){var k=Gu(c,e[g]),k=new Pu(k,f,d);a.oa(k,!0)}return b};function Vu(a,b){var c=Uu.U();Tu.call(this,a,c,b)}E(Vu,Tu);Vu.prototype.lb=function(){return this.s().querySelector("summary").nextElementSibling};Vu.prototype.refresh=function(){for(var a=0;a<ss(this);a++)ts(this,a).refresh()};Rs(Vu,Uu);function Wu(){}E(Wu,ct);da(Wu);Wu.prototype.G=function(){return"name"};
Wu.prototype.Y=function(a){var b=Wu.m.Y.call(this,a),c=a.R,d=a.h;b.setAttribute("name",c.Bb);b.classList.add("record-group");var e=d.K("div");e.setAttribute("title",Hu(c));b.appendChild(e);var f=d.K("div","content");b.appendChild(e);b.appendChild(f);a.T=b;Fu(c);var e=Mu.U(),g;a:{f=Cu(c.W);for(g in f.module_fields)if("salutation"==g){g=!0;break a}g=!1}g&&(g=Gu(c,"salutation"),g=new Pu(g,e,d),a.oa(g,!0));a.oa(new Pu(Gu(c,"first_name"),e,d),!0);a.oa(new Pu(Gu(c,"last_name"),e,d),!0);return b};function Xu(a,b){var c=Wu.U();Tu.call(this,a,c,b)}E(Xu,Tu);Xu.prototype.lb=function(){return Gg("content",this.s())};Xu.prototype.refresh=function(){for(var a=0;a<ss(this);a++)ts(this,a).refresh()};Rs(Xu,Wu);function Yu(){}E(Yu,ct);da(Yu);Yu.prototype.G=function(){return"record-body"};
Yu.prototype.Y=function(a){var b=Yu.m.Y.call(this,a),c=a.h,d=c.K("div","record-body-header"),e=c.K("div","record-body-content");b.appendChild(d);b.appendChild(e);a.T=b;e=c.K("a",{name:"view"},"view");e.href="#";d.appendChild(e);var d=a.R,e=[],f=Cu(d),g;for(g in f.module_fields){var k=f.module_fields[g].group;-1==e.indexOf(k)&&e.push(k)}g=Su.U();for(f=0;f<e.length;f++){var k=e[f],l,m;m=d;var n=k;m.h[n]||(m.h[n]=new Eu(m,n));m=m.h[n];/address/i.test(k)?l=new Vu(m,c):"name"==k?l=new Xu(m,c):l=new Tu(m,
g,c);a.oa(l,!0)}return b};function Zu(a){return a.querySelector("a[name=view]")};function $u(a,b,c){b=b||Yu.U();$.call(this,null,b,c);this.R=a}E($u,$);h=$u.prototype;h.logger=R("ydn.crm.inj.sugar.module.Record");h.lb=function(){return Gg("record-body-content",this.s())};h.$=function(){$u.m.$.call(this);var a=ns(this),b=this.R;b&&a.listen(b,"record-change",this.refresh);a.listen(Zu(this.s()),"click",this.ah,!1)};
h.ah=function(a){a.preventDefault();var b=this.s();a=Gg("record-body-header",b);b=Gg("record-body-content",b);a=Zu(a);b.classList.contains("view")?(a.textContent="view",b.classList.remove("view")):(a.textContent="hide",b.classList.add("view"))};
h.refresh=function(a){var b=this.R,c=this.s();if(b.sa())for(vi(c,!0),a&&"record-change"==a.type&&(b=this.s(),a=Gg("record-body-header",b),b=Gg("record-body-content",b),Zu(a).textContent="view",b.classList.remove("view")),a=0;a<ss(this);a++)b=ts(this,a),b instanceof Tu?b.refresh():b instanceof Vu&&b.refresh();else vi(c,!1)};Rs($u,Yu);function av(a){Kc.call(this);this.parent=a;this.result=this.g=null}E(av,Kc);h=av.prototype;h.getParent=function(){return this.parent};h.sa=function(){return this.g};function bv(a){if(a.g)return a.g.Uc();if(a.result)return a.result.storeName}
function cv(a,b){b.record?a.g=b.record:a.g=null;a.result=b;a.dispatchEvent(new K("change",a));a.g||a.parent.send("list",[{store:a.result.storeName,index:"id",key:a.result.primaryKey}]).D(function(a){a=a[0].result;a[0]&&(this.g=new Iu(this.parent,new Aq(this.parent.df(),$p[$p.indexOf(this.result.storeName)],a[0])),this.dispatchEvent(new K("change",this)))},a)}h.clear=function(){if(this.g||this.result)this.result=this.g=null,this.dispatchEvent(new K("change",this))};
h.toString=function(){return"ydn.crm.sugar.model.Result:"+this.g};h.Oa=function(){return!this.g&&!this.result};function dv(){}E(dv,ct);da(dv);dv.prototype.G=function(){return"search-result sugar-panel"};dv.prototype.Y=function(a){var b=dv.m.Y.call(this,a),c=a.h,d=c.K("div","record-header"),e=c.K("div","record-body");b.appendChild(d);b.appendChild(e);a=bv(a.R);e=c.K("a","title");c=c.K("span",{"class":"icon"},a.substr(0,2));d.appendChild(c);d.appendChild(e);d.classList.add(a);return b};
dv.prototype.refresh=function(a){var b=a.R,c=a.s();if((b=b.sa())&&b.g&&b.g.g){var d=Gg("record-header",a.s()),e=b.Uc();d.className="record-header "+e;a=Gg("title",d);var d=Gg("icon",d),f;f=b.sa();if(f.g){var g=f.g.full_name||"";g?f=g:(g=(f.g.first_name||"").trim(),f=(f.g.last_name||"").trim(),f=g+" "+f)}else f="";a.textContent=f;d.textContent=e.substring(0,2);b=b.sa();e=b.F();a.href="https://"+b.domain+"/index.php?module="+b.W+"&action=DetailView&record="+e;vi(c,!0)}else vi(c,!1)};function ev(a,b){$.call(this,null,null,a);this.R=b;var c=new Aq(b.parent.df(),bv(b)),c=new Iu(b.getParent(),c);this.g=new $u(c,null,a);this.oa(this.g,!0);ns(this).listen(b,"change",this.n,!0)}E(ev,$);ev.prototype.n=function(a){var b=this.g.R,c=this.R.sa();b.Od(c?c.sa():null);this.i.refresh(this);this.g.refresh(a)};Rs(ev,dv);function fv(a,b){js.call(this,a);this.R=b;this.i=new js(a);this.g=null;this.j=[];this.n=0}E(fv,js);fv.prototype.yb=function(){fv.m.yb.call(this);var a=this.h,b=this.s(),c=a.K("div","header");b.appendChild(c);this.g=new Tt(null,null,a);for(var d=new Qt(a),e=0;e<aq.length;e++)d.oa(new Mt(aq[e]),!0);d=new vu("Module",d,null,a);this.g.oa(d,!0);this.g.oa(new yu(""),!0);this.g.render(c);a=a.K("div","content");b.appendChild(a);this.oa(this.i,!0)};
fv.prototype.$=function(){fv.m.$.call(this);var a=ts(this.g,1);ns(this).listen(a,"action",this.o,!0)};function gv(a,b){if(b){for(var c=ss(a.i),d=0;d<c;d++){var e=ts(a.i,d).R;if(e.Oa()){cv(e,b);return}}30<c?cv(ts(a.i,0).R,b):(c=new av(a.R),cv(c,b),c=new ev(a.h,c),a.i.oa(c,!0))}}
function hv(a,b,c,d){a.R.ph(b,c,d,!0).w(function(a){var b=a[0];if(b.result[0]){a=$p[$p.indexOf(b.store)];var g=new Ku(this.R,a),b=new Aq(this.R.df(),a,b.result[0]);g.Od(b);b=b.F();gv(this,{storeName:a,primaryKey:b,record:g,value:d,tokens:[{keyPath:c}]})}iv(this)},function(a){iv(this);throw a;},a)}
function jv(a,b){0==a.n&&(a.n=b);var c=100*(a.n-b)/a.n,d=ts(a.g,1).s(),d=Hg(document,"input",null,d)[0].style,e=["rgb(255, 255, 255) 0%"];e[1]="rgb(255, 255, 255) "+c.toFixed(1)+"%";e[2]="rgb(135,224,253) "+(c+0.1).toFixed(1)+"%";e[3]="rgb(135,224,253) 100%";d.background="linear-gradient(to right, "+e.join(", ")+")"}
function iv(a){var b=a.j[0];if(b){b.sc++;jv(a,3*(a.j.length-1)+(3-b.sc));var c=a.R;0==b.sc?hv(a,b.W,"ydn$emails",b.Oc):1==b.sc?(c=b.Oc.match(/\d/g),3>(c?c.length:0)?iv(a):hv(a,b.W,"ydn$phones",b.Oc)):2==b.sc?c.g(b.W,b.Oc).w(function(a){a=a[0].result;for(var b=a.length||0,c=0;c<b;c++)gv(this,a[c]);iv(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&iv(a))}}
fv.prototype.o=function(){var a=ts(this.g,1).la();if(a&&(a=a.trim(),2<=a.length)){var b;b=(b=ru(ts(this.g,0)))?b.xb():null;this.j.length=0;if(b)this.j[0]={W:b,Oc:a,sc:-1};else for(b=0;b<aq.length;b++)this.j[b]={W:aq[b],Oc:a,sc:-1};for(a=ss(this.i)-1;0<=a;a--)ts(this.i,a).R.clear();this.n=0;iv(this)}};fv.prototype.lb=function(){return Gg("content",this.s())};function kv(a,b,c){Mt.call(this,a,b,c);pt(this,8,!0);if(a=this.s())b=this.i,a&&(xs(a,"menuitemradio"),Jt(b,this,a,!0))}E(kv,Mt);kv.prototype.Gb=function(){return this.dispatchEvent("action")};Ts("goog-option",function(){return new kv(null)});function lv(){}E(lv,du);da(lv);lv.prototype.G=function(){return"goog-toolbar-button"};function mv(a,b,c){cu.call(this,a,b||lv.U(),c)}E(mv,cu);Ts("goog-toolbar-button",function(){return new mv(null)});function nv(a,b,c,d){gu.call(this,a,b,c||uu.U(),d)}E(nv,gu);Ts("goog-toolbar-menu-button",function(){return new nv(null)});function ov(a,b){Ot.call(this,a||Rt.U(),b)}E(ov,Ot);Ts("goog-toolbar-separator",function(){return new ov});function pv(a,b,c){cu.call(this,a,b||du.U(),c);pt(this,16,!0)}E(pv,cu);Ts("goog-toggle-button",function(){return new pv(null)});function qv(a,b,c){pv.call(this,a,b||lv.U(),c)}E(qv,pv);Ts("goog-toolbar-toggle-button",function(){return new qv(null)});function rv(){}E(rv,ct);da(rv);rv.prototype.G=function(){return"record"};rv.prototype.Y=function(a){return rv.m.Y.call(this,a)};function sv(a,b){$.call(this,null,null,a);this.R=b}E(sv,$);Rs(sv,rv);function tv(a,b){js.call(this,a);this.R=b;this.i=new js(a);this.g=new js(a)}E(tv,js);tv.prototype.lb=function(){return Gg("content",this.s())};
tv.prototype.yb=function(){tv.m.yb.call(this);var a=this.s(),b;b=new bh;b.Hf('<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>');b=
b.toString();A(b)?(La("Soy template output is unsafe for use as HTML: "+b),b="zSoyz"):b=String(b);a.innerHTML=b;qs(new Tt,Gg("goog-toolbar",a));this.oa(this.i,!0);this.oa(this.g,!0);vi(this.g.s(),!1)};tv.prototype.$=function(){tv.m.$.call(this);this.s()};tv.prototype.refresh=function(){};oa("ydn.crm.ui.sugar.SyncPanel",tv);oa("ydn.crm.ui.sugar.SearchPanel",fv);oa("ydn.crm.inj.UserSetting",fs);fs.getInstance=function(){gs||(gs=new fs);return gs};fs.getModuleInfo=fs.prototype.h;oa("ydn.debug.log",Gi);oa("ydn.crm.version","0.6.9");oa("goog.async.Deferred",G);G.prototype.addCallback=G.prototype.D;G.prototype.addErrback=G.prototype.wc;G.prototype.addBoth=G.prototype.aa;G.prototype.addCallbacks=G.prototype.w;})();app=runApp();

            //# sourceMappingURL=ydn.crm-0.6.9.js.map
        