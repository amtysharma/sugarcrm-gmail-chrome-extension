(function(){var h,aa=aa||{},q=this;function ba(a){a=a.split(".");for(var b=q,c;c=a.shift();)if(null!=b[c])b=b[c];else return null;return b}function ca(){}function da(a){a.W=function(){return a.ng?a.ng:a.ng=new a}}
function ea(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function t(a){return void 0!==a}function u(a){return"array"==ea(a)}function v(a){var b=ea(a);return"array"==b||"object"==b&&"number"==typeof a.length}function x(a){return"string"==typeof a}function fa(a){return"boolean"==typeof a}function y(a){return"number"==typeof a}function ga(a){return"function"==ea(a)}function A(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function ha(a){return a[ia]||(a[ia]=++ka)}
var ia="closure_uid_"+(1E9*Math.random()>>>0),ka=0;function la(a,b,c){return a.call.apply(a.bind,arguments)}function ma(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}
function na(a,b,c){na=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?la:ma;return na.apply(null,arguments)}function oa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}}var B=Date.now||function(){return+new Date};
function pa(a,b){var c=a.split("."),d=q;c[0]in d||!d.execScript||d.execScript("var "+c[0]);for(var e;c.length&&(e=c.shift());)c.length||void 0===b?d[e]?d=d[e]:d=d[e]={}:d[e]=b}function C(a,b){function c(){}c.prototype=b.prototype;a.m=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.mi=function(a,c,f){return b.prototype[c].apply(a,Array.prototype.slice.call(arguments,2))}};function qa(a){Error.captureStackTrace?Error.captureStackTrace(this,qa):this.stack=Error().stack||"";a&&(this.message=String(a))}C(qa,Error);qa.prototype.name="CustomError";var ra;function sa(a,b){return 0==a.lastIndexOf(b,0)}function ta(a){var b=a.length-8;return 0<=b&&a.indexOf("#archive",b)==b}function ua(a,b){for(var c=a.split("%s"),d="",e=Array.prototype.slice.call(arguments,1);e.length&&1<c.length;)d+=c.shift()+e.shift();return d+c.join("%s")}function va(a){return/^[\s\xa0]*$/.test(a)}function wa(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")}function xa(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")}
function ya(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")}function za(a){if(!Aa.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ba,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Ca,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Da,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Ea,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(Fa,"&#39;"));return a}var Ba=/&/g,Ca=/</g,Da=/>/g,Ea=/"/g,Fa=/'/g,Aa=/[&<>"']/;function Ga(a){return ya(a.replace(/  /g," &#160;"),void 0)}
function Ha(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a}var Ia={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"},Ja={"'":"\\'"};
function Ka(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0),f=b,g=c+1,k;if(!(k=Ia[d])){if(!(31<e&&127>e))if(d in Ja)d=Ja[d];else if(d in Ia)d=Ja[d]=Ia[d];else{e=d;k=d.charCodeAt(0);if(31<k&&127>k)e=d;else{if(256>k){if(e="\\x",16>k||256<k)e+="0"}else e="\\u",4096>k&&(e+="0");e+=k.toString(16).toUpperCase()}d=Ja[d]=e}k=d}f[g]=k}b.push('"');return b.join("")}function La(a,b){return a<b?-1:a>b?1:0};function Ma(a,b){b.unshift(a);qa.call(this,ua.apply(null,b));b.shift()}C(Ma,qa);Ma.prototype.name="AssertionError";function Na(a,b){throw new Ma("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};var Oa=Array.prototype,Pa=Oa.indexOf?function(a,b,c){return Oa.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(x(a))return x(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Qa=Oa.forEach?function(a,b,c){Oa.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)},Ra=Oa.filter?function(a,b,c){return Oa.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=
0,g=x(a)?a.split(""):a,k=0;k<d;k++)if(k in g){var l=g[k];b.call(c,l,k,a)&&(e[f++]=l)}return e},Sa=Oa.map?function(a,b,c){return Oa.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=x(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e},Ta=Oa.some?function(a,b,c){return Oa.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1},Ua=Oa.every?function(a,b,c){return Oa.every.call(a,b,c)}:function(a,
b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};function Va(a,b){var c=Wa(a,b,void 0);return 0>c?null:x(a)?a.charAt(c):a[c]}function Wa(a,b,c){for(var d=a.length,e=x(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1}function Xa(a,b){return 0<=Pa(a,b)}function Ya(a){if(!u(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0}function Za(a,b){var c=Pa(a,b),d;(d=0<=c)&&Oa.splice.call(a,c,1);return d}
function $a(a){return Oa.concat.apply(Oa,arguments)}function ab(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]}function bb(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(u(d)||(e=v(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,k=0;k<g;k++)a[f+k]=d[k];else a.push(d)}}function cb(a,b,c,d){Oa.splice.apply(a,db(arguments,1))}
function db(a,b,c){return 2>=arguments.length?Oa.slice.call(a,b):Oa.slice.call(a,b,c)}function eb(a,b,c){for(var d=0,e=a.length,f;d<e;){var g=d+e>>1,k;k=b(c,a[g]);0<k?d=g+1:(e=g,f=!k)}return f?d:~d}function fb(a,b){if(!v(a)||!v(b)||a.length!=b.length)return!1;for(var c=a.length,d=gb,e=0;e<c;e++)if(!d(a[e],b[e]))return!1;return!0}function hb(a,b){return a>b?1:a<b?-1:0}function gb(a,b){return a===b}function ib(a,b){var c=eb(a,jb||hb,b);0>c&&cb(a,-(c+1),0,b)};function kb(a){return function(){throw a;}};/*
 Portions of this code are from MochiKit, received by
 The Closure Authors under the MIT license. All other code is Copyright
 2005-2009 The Closure Authors. All Rights Reserved.
*/
function D(a,b){this.l=[];this.M=a;this.G=b||null}h=D.prototype;h.wb=!1;h.Qb=!1;h.Nc=!1;h.Wf=!1;h.Af=!1;h.wd=0;function lb(a,b){if(a.wb)a.i instanceof D&&lb(a.i);else{if(a.h){var c=a.h;delete a.h;b?lb(c,b):(c.wd--,0>=c.wd&&lb(c))}a.M?a.M.call(a.G,a):a.Af=!0;a.wb||a.D(new mb)}}h.Bd=function(a,b){this.Nc=!1;nb(this,a,b)};function nb(a,b,c){a.wb=!0;a.i=c;a.Qb=!b;a.Ge()}function ob(a){if(a.wb){if(!a.Af)throw new pb;a.Af=!1}}h.C=function(a){ob(this);nb(this,!0,a)};h.D=function(a){ob(this);nb(this,!1,a)};
h.A=function(a,b){return this.u(a,null,b)};h.Mc=function(a,b){return this.u(null,a,b)};h.ca=function(a,b){return this.u(a,a,b)};h.u=function(a,b,c){this.l.push([a,b,c]);this.wb&&this.Ge();return this};function qb(a,b){a.u(b.C,b.D,b)}function rb(a){var b=new D;qb(a,b);return b}function sb(a){return Ta(a.l,function(a){return ga(a[1])})}
h.Ge=function(){this.o&&this.wb&&sb(this)&&(q.clearTimeout(this.o),delete this.o);this.h&&(this.h.wd--,delete this.h);for(var a=this.i,b=!1,c=!1;this.l.length&&!this.Nc;){var d=this.l.shift(),e=d[0],f=d[1],d=d[2];if(e=this.Qb?f:e)try{var g=e.call(d||this.G,a);t(g)&&(this.Qb=this.Qb&&(g==a||g instanceof Error),this.i=a=g);a instanceof D&&(this.Nc=c=!0)}catch(k){a=k,this.Qb=!0,sb(this)||(b=!0)}}this.i=a;c&&(a.u(na(this.Bd,this,!0),na(this.Bd,this,!1)),a.Wf=!0);b&&(this.o=q.setTimeout(kb(a),0))};
function tb(a){var b=new D;b.C(a);return b}function F(a){var b=new D;b.D(a);return b}function ub(a){Error.captureStackTrace?Error.captureStackTrace(this,ub):this.stack=Error().stack||"";a&&(this.message=String(a))}C(ub,Error);function pb(){ub.call(this)}C(pb,ub);pb.prototype.message="Deferred has already fired";pb.prototype.name="AlreadyCalledError";function mb(){ub.call(this)}C(mb,ub);mb.prototype.message="Deferred was canceled";mb.prototype.name="CanceledError";function vb(){0!=wb&&(xb[ha(this)]=this)}var wb=0,xb={};vb.prototype.G=!1;vb.prototype.la=function(){if(!this.G&&(this.G=!0,this.I(),0!=wb)){var a=ha(this);delete xb[a]}};vb.prototype.I=function(){if(this.Xb)for(;this.Xb.length;)this.Xb.shift()()};var yb,zb,Ab,Bb,Cb;function Db(){return q.navigator?q.navigator.userAgent:null}function Eb(){return q.navigator}Bb=Ab=zb=yb=!1;var Fb;if(Fb=Db()){var Gb=Eb();yb=sa(Fb,"Opera");zb=!yb&&(-1!=Fb.indexOf("MSIE")||-1!=Fb.indexOf("Trident"));Ab=!yb&&-1!=Fb.indexOf("WebKit");Bb=!yb&&!Ab&&!zb&&"Gecko"==Gb.product}var Hb=yb,H=zb,Ib=Bb,Jb=Ab,Kb=Eb();Cb=-1!=(Kb&&Kb.platform||"").indexOf("Mac");var Lb=!!Eb()&&-1!=(Eb().appVersion||"").indexOf("X11");
function Mb(){var a=q.document;return a?a.documentMode:void 0}var Nb;a:{var Ob="",Pb;if(Hb&&q.opera)var Qb=q.opera.version,Ob="function"==typeof Qb?Qb():Qb;else if(Ib?Pb=/rv\:([^\);]+)(\)|;)/:H?Pb=/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/:Jb&&(Pb=/WebKit\/(\S+)/),Pb)var Rb=Pb.exec(Db()),Ob=Rb?Rb[1]:"";if(H){var Sb=Mb();if(Sb>parseFloat(Ob)){Nb=String(Sb);break a}}Nb=Ob}var Tb={};
function Ub(a){var b;if(!(b=Tb[a])){b=0;for(var c=xa(String(Nb)).split("."),d=xa(String(a)).split("."),e=Math.max(c.length,d.length),f=0;0==b&&f<e;f++){var g=c[f]||"",k=d[f]||"",l=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var n=l.exec(g)||["","",""],p=m.exec(k)||["","",""];if(0==n[0].length&&0==p[0].length)break;b=La(0==n[1].length?0:parseInt(n[1],10),0==p[1].length?0:parseInt(p[1],10))||La(0==n[2].length,0==p[2].length)||La(n[2],p[2])}while(0==b)}b=Tb[a]=0<=b}return b}
var Vb=q.document,Wb=Vb&&H?Mb()||("CSS1Compat"==Vb.compatMode?parseInt(Nb,10):5):void 0;var Xb=!H||H&&9<=Wb,Yb=!H||H&&9<=Wb,Zb=H&&!Ub("9");!Jb||Ub("528");Ib&&Ub("1.9b")||H&&Ub("8")||Hb&&Ub("9.5")||Jb&&Ub("528");Ib&&!Ub("8")||H&&Ub("9");function K(a,b){this.type=a;this.i=this.target=b}h=K.prototype;h.la=function(){};h.Wb=!1;h.vg=!0;h.Yc=function(){this.Wb=!0};h.preventDefault=function(){this.vg=!1};function $b(a){$b[" "](a);return a}$b[" "]=ca;function ac(a,b){K.call(this,a?a.type:"");this.j=this.i=this.target=null;this.g=this.clientY=this.clientX=0;this.l=this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1;this.h=null;a&&this.init(a,b)}C(ac,K);var bc=[1,4,2];
ac.prototype.init=function(a,b){var c=this.type=a.type;this.target=a.target||a.srcElement;this.i=b;var d=a.relatedTarget;if(d){if(Ib){var e;a:{try{$b(d.nodeName);e=!0;break a}catch(f){}e=!1}e||(d=null)}}else"mouseover"==c?d=a.fromElement:"mouseout"==c&&(d=a.toElement);this.j=d;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.g=a.keyCode||0;this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.l=Cb?a.metaKey:
a.ctrlKey;this.h=a;a.defaultPrevented&&this.preventDefault();delete this.Wb};function cc(a){return Xb?0==a.h.button:"click"==a.type?!0:!!(a.h.button&bc[0])}ac.prototype.Yc=function(){ac.m.Yc.call(this);this.h.stopPropagation?this.h.stopPropagation():this.h.cancelBubble=!0};ac.prototype.preventDefault=function(){ac.m.preventDefault.call(this);var a=this.h;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,Zb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};var dc="closure_listenable_"+(1E6*Math.random()|0);function ec(a){try{return!(!a||!a[dc])}catch(b){return!1}}var fc=0;function gc(a,b,c,d,e){this.ic=a;this.proxy=null;this.src=b;this.type=c;this.yd=!!d;this.fb=e;this.key=++fc;this.removed=this.xd=!1}function hc(a){a.removed=!0;a.ic=null;a.proxy=null;a.src=null;a.fb=null};function ic(a,b){for(var c in a)b.call(void 0,a[c],c,a)}function jc(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b}function kc(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b}function lc(a,b){for(var c=v(b),d=c?b:arguments,c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}function mc(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');a[b]=c}function nc(a,b){return b in a?a[b]:void 0}function oc(a){var b={},c;for(c in a)b[a[c]]=c;return b}var pc="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
function qc(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<pc.length;f++)c=pc[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function rc(a){var b=arguments.length;if(1==b&&u(arguments[0]))return rc.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};function sc(a){this.src=a;this.g={};this.h=0}sc.prototype.add=function(a,b,c,d,e){var f=this.g[a];f||(f=this.g[a]=[],this.h++);var g=tc(f,b,d,e);-1<g?(a=f[g],c||(a.xd=!1)):(a=new gc(b,this.src,a,!!d,e),a.xd=c,f.push(a));return a};sc.prototype.remove=function(a,b,c,d){if(!(a in this.g))return!1;var e=this.g[a];b=tc(e,b,c,d);return-1<b?(hc(e[b]),Oa.splice.call(e,b,1),0==e.length&&(delete this.g[a],this.h--),!0):!1};
function uc(a,b){var c=b.type;if(!(c in a.g))return!1;var d=Za(a.g[c],b);d&&(hc(b),0==a.g[c].length&&(delete a.g[c],a.h--));return d}sc.prototype.removeAll=function(a){var b=0,c;for(c in this.g)if(!a||c==a){for(var d=this.g[c],e=0;e<d.length;e++)++b,hc(d[e]);delete this.g[c];this.h--}return b};function vc(a,b,c,d,e){a=a.g[b];b=-1;a&&(b=tc(a,c,d,e));return-1<b?a[b]:null}function tc(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.removed&&f.ic==b&&f.yd==!!c&&f.fb==d)return e}return-1};var wc="closure_lm_"+(1E6*Math.random()|0),xc={},yc=0;function Ac(a,b,c,d,e){if(u(b)){for(var f=0;f<b.length;f++)Ac(a,b[f],c,d,e);return null}c=Bc(c);return ec(a)?a.listen(b,c,d,e):Cc(a,b,c,!1,d,e)}function Cc(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=!!e,k=Dc(a);k||(a[wc]=k=new sc(a));c=k.add(b,c,d,e,f);if(c.proxy)return c;d=Ec();c.proxy=d;d.src=a;d.ic=c;a.addEventListener?a.addEventListener(b,d,g):a.attachEvent(b in xc?xc[b]:xc[b]="on"+b,d);yc++;return c}
function Ec(){var a=Fc,b=Yb?function(c){return a.call(b.src,b.ic,c)}:function(c){c=a.call(b.src,b.ic,c);if(!c)return c};return b}function Gc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Gc(a,b[f],c,d,e);else c=Bc(c),ec(a)?a.vb.add(String(b),c,!0,d,e):Cc(a,b,c,!0,d,e)}function Hc(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)Hc(a,b[f],c,d,e);else c=Bc(c),ec(a)?a.ya(b,c,d,e):a&&(a=Dc(a))&&(b=vc(a,b,c,!!d,e))&&Ic(b)}
function Ic(a){if(y(a)||!a||a.removed)return!1;var b=a.src;if(ec(b))return uc(b.vb,a);var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.yd):b.detachEvent&&b.detachEvent(c in xc?xc[c]:xc[c]="on"+c,d);yc--;(c=Dc(b))?(uc(c,a),0==c.h&&(c.src=null,b[wc]=null)):hc(a);return!0}function Jc(a,b,c,d){var e=1;if(a=Dc(a))if(b=a.g[b])for(b=ab(b),a=0;a<b.length;a++){var f=b[a];f&&f.yd==c&&!f.removed&&(e&=!1!==Kc(f,d))}return Boolean(e)}
function Kc(a,b){var c=a.ic,d=a.fb||a.src;a.xd&&Ic(a);return c.call(d,b)}
function Fc(a,b){if(a.removed)return!0;if(!Yb){var c=b||ba("window.event"),d=new ac(c,this),e=!0;if(!(0>c.keyCode||void 0!=c.returnValue)){a:{var f=!1;if(0==c.keyCode)try{c.keyCode=-1;break a}catch(g){f=!0}if(f||void 0==c.returnValue)c.returnValue=!0}c=[];for(f=d.i;f;f=f.parentNode)c.push(f);for(var f=a.type,k=c.length-1;!d.Wb&&0<=k;k--)d.i=c[k],e&=Jc(c[k],f,!0,d);for(k=0;!d.Wb&&k<c.length;k++)d.i=c[k],e&=Jc(c[k],f,!1,d)}return e}return Kc(a,new ac(b,this))}
function Dc(a){a=a[wc];return a instanceof sc?a:null}var Lc="__closure_events_fn_"+(1E9*Math.random()>>>0);function Bc(a){return ga(a)?a:a[Lc]||(a[Lc]=function(b){return a.handleEvent(b)})};function Mc(){vb.call(this);this.vb=new sc(this);this.Lc=this}C(Mc,vb);Mc.prototype[dc]=!0;h=Mc.prototype;h.Ec=null;h.wf=function(a){this.Ec=a};h.removeEventListener=function(a,b,c,d){Hc(this,a,b,c,d)};
h.dispatchEvent=function(a){var b,c=this.Ec;if(c)for(b=[];c;c=c.Ec)b.push(c);var c=this.Lc,d=a.type||a;if(x(a))a=new K(a,c);else if(a instanceof K)a.target=a.target||c;else{var e=a;a=new K(d,c);qc(a,e)}var e=!0,f;if(b)for(var g=b.length-1;!a.Wb&&0<=g;g--)f=a.i=b[g],e=Nc(f,d,!0,a)&&e;a.Wb||(f=a.i=c,e=Nc(f,d,!0,a)&&e,a.Wb||(e=Nc(f,d,!1,a)&&e));if(b)for(g=0;!a.Wb&&g<b.length;g++)f=a.i=b[g],e=Nc(f,d,!1,a)&&e;return e};h.I=function(){Mc.m.I.call(this);this.vb&&this.vb.removeAll(void 0);this.Ec=null};
h.listen=function(a,b,c,d){return this.vb.add(String(a),b,!1,c,d)};h.ya=function(a,b,c,d){return this.vb.remove(String(a),b,c,d)};function Nc(a,b,c,d){b=a.vb.g[String(b)];if(!b)return!0;b=ab(b);for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.removed&&g.yd==c){var k=g.ic,l=g.fb||g.src;g.xd&&uc(a.vb,g);e=!1!==k.call(l,d)&&e}}return e&&!1!=d.vg};function L(a){qa.call(this,a);this.name="ydn.error.ArgumentException"}C(L,qa);function Oc(a){qa.call(this,a);this.name="ydn.error.NotSupportedException"}C(Oc,qa);function Pc(a){qa.call(this,a);this.name="ydn.error.NotImplementedException"}C(Pc,qa);function Qc(a){qa.call(this,a);this.name="ydn.error.InvalidOperationException"}C(Qc,qa);
function Rc(a){Error.captureStackTrace?Error.captureStackTrace(this,Rc):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(Rc,Error);Rc.prototype.name="ydn.error.InternalError";function Sc(a,b){D.call(this,a,b);this.j=[]}C(Sc,D);function Tc(a,b){for(var c=0;c<a.j.length;c++)a.j[c][0].call(a.j[c][1],b)}Sc.prototype.C=function(a){this.j.length=0;Sc.m.C.call(this,a)};Sc.prototype.D=function(a){this.j.length=0;Sc.m.D.call(this,a)};function Uc(a){this.id="i"+this.count();this.req=a;this.i=!0;this.g=this.h=null;this.j=new Sc;this.l=NaN}Uc.prototype.F=function(){return this.id};var Vc=0;Uc.prototype.count=function(){Vc++;return Vc};
Uc.prototype.listen=function(a){if(a&&a.id==this.id){this.h=a.data;var b=a.error;b&&(b instanceof Error?this.g=b:A(b)?(this.g=Error(b.message),this.g.name=b.name,this.g.source=b,this.g.result=this.h):(this.g=Error(b),this.g.name="UnknownError"));a.done?(this.i=!1,this.g?this.j.D(this.g):this.j.C(this.h),window.clearTimeout(this.l)):Tc(this.j,a.data);return!0}return!1};Uc.prototype.toString=function(){return"Message:"+this.id+(this.i?"*":"")};
Uc.prototype.toJSON=function(){var a=this;this.l=window.setTimeout(function(){if(a.i){var b=Error("message timeout");b.name="TimeOutError";a.listen({id:a.id,req:a.req,error:b})}},1E4);return{id:this.id,req:this.req,group:this.o,name:this.p,data:this.h}};function Wc(a){Mc.call(this);var b=x(a)?null:a;this.name=x(a)?a:a.name;this.g=[];this.o=b;this.h=null;this.i={}}C(Wc,Mc);Wc.prototype.I=function(){if(this.h){var a=this;this.h.disconnect(function(){a.h=null;a.g.length=0})}else this.g.length=0};function Xc(a){K.call(this,"post");this.message=a}C(Xc,K);Xc.prototype.getMessage=function(){return this.message};
Wc.prototype.l=function(a){if(a)if(a.id)for(var b=this.g.length-1;0<=b;b--){if(this.g[b].F()==a.id&&this.g[b].listen(a)){this.g[b].i?25<b&&(a=this.g.splice(b,1),this.g.unshift(a[0])):this.g.splice(b,1);break}}else"info"==a.req?(a.data=this.o,this.h.postMessage(a)):"html-body-inner"==a.req?(window.console.log("html",a),a.req="",a.done=!0,a.data=document&&document.body?document.body.innerHTML:"",this.h.postMessage(a)):this.dispatchEvent(new Xc(a))};Wc.prototype.toString=function(){return"Pipe:"+this.name};
Wc.prototype.j=function(a,b){var c=a||Yc,d=c+(b?"-"+b:"");this.i[d]||(this.i[d]=new Zc(this,c,b||""));return this.i[d]};function $c(a){if(!a.h){a.h=chrome.runtime.connect({name:a.name});var b=na(a.l,a);a.h.onMessage.addListener(b);a.h.onDisconnect.addListener(function(){a.h.onMessage.removeListener(b);a.h=null;a.g.length=0})}return a.h}var ad=null;function bd(){if(!ad){var a=Yc+"-"+B();ad=new Wc(a)}return ad}function cd(a){var b=a;x(a)&&(b={group:a,name:a+"-"+B()});return ad=new Wc(b)}
var Yc="default",dd=["dev","gmail","host-permission","popup","options"];function ed(a,b){return bd().j(a,b)}function Zc(a,b,c){this.g=a;this.h=b;this.i=c}Zc.prototype.send=function(a,b){var c=new Uc(a),d=this.i;c.o=this.h;c.p=d;b&&(c.h=b);var d=c.j,e=this.g,f=c.toJSON();$c(e).postMessage(f);e.g.push(c);50<e.g.length&&(e.g.length-=1);return d};function fd(a){if("function"==typeof a.Ba)return a.Ba();if(x(a))return a.split("");if(v(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return jc(a)}function gd(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(v(a)||x(a))Qa(a,b,c);else{var d;if("function"==typeof a.Ra)d=a.Ra();else if("function"!=typeof a.Ba)if(v(a)||x(a)){d=[];for(var e=a.length,f=0;f<e;f++)d.push(f)}else d=kc(a);else d=void 0;for(var e=fd(a),f=e.length,g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)}};var hd="StopIteration"in q?q.StopIteration:Error("StopIteration");function jd(){}jd.prototype.g=function(){throw hd;};jd.prototype.Nb=function(){return this};function kd(a){if(a instanceof jd)return a;if("function"==typeof a.Nb)return a.Nb(!1);if(v(a)){var b=0,c=new jd;c.g=function(){for(;;){if(b>=a.length)throw hd;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");}
function ld(a,b){if(v(a))try{Qa(a,b,void 0)}catch(c){if(c!==hd)throw c;}else{a=kd(a);try{for(;;)b.call(void 0,a.g(),void 0,a)}catch(d){if(d!==hd)throw d;}}}function md(a){if(v(a))return ab(a);a=kd(a);var b=[];ld(a,function(a){b.push(a)});return b};function nd(a,b){this.h={};this.g=[];this.j=this.i=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a){a instanceof nd?(c=a.Ra(),d=a.Ba()):(c=kc(a),d=jc(a));for(var e=0;e<c.length;e++)this.set(c[e],d[e])}}h=nd.prototype;h.da=function(){return this.i};h.Ba=function(){od(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a};h.Ra=function(){od(this);return this.g.concat()};
h.Pa=function(){return 0==this.i};h.clear=function(){this.h={};this.j=this.i=this.g.length=0};h.remove=function(a){return pd(this.h,a)?(delete this.h[a],this.i--,this.j++,this.g.length>2*this.i&&od(this),!0):!1};function od(a){if(a.i!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];pd(a.h,d)&&(a.g[c++]=d);b++}a.g.length=c}if(a.i!=a.g.length){for(var e={},c=b=0;b<a.g.length;)d=a.g[b],pd(e,d)||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}h.get=function(a,b){return pd(this.h,a)?this.h[a]:b};
h.set=function(a,b){pd(this.h,a)||(this.i++,this.g.push(a),this.j++);this.h[a]=b};h.ga=function(){return new nd(this)};h.Nb=function(a){od(this);var b=0,c=this.g,d=this.h,e=this.j,f=this,g=new jd;g.g=function(){for(;;){if(e!=f.j)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw hd;var g=c[b++];return a?g:d[g]}};return g};function pd(a,b){return Object.prototype.hasOwnProperty.call(a,b)};var qd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$");function rd(a){if(sd){sd=!1;var b=q.location;if(b){var c=b.href;if(c&&(c=(c=rd(c)[3]||null)&&decodeURIComponent(c))&&c!=b.hostname)throw sd=!0,Error();}}return a.match(qd)}var sd=Jb;function td(a,b){var c;if(a instanceof td)this.bc=t(b)?b:a.bc,ud(this,a.nc),this.ie=a.ie,vd(this,a.K()),wd(this,a.Kd),xd(this,a.Fc),yd(this,a.g.ga()),zd(this,a.He);else if(a&&(c=rd(String(a)))){this.bc=!!b;ud(this,c[1]||"",!0);var d=c[2]||"";this.ie=d?decodeURIComponent(d):"";vd(this,c[3]||"",!0);wd(this,c[4]);xd(this,c[5]||"",!0);yd(this,c[6]||"",!0);zd(this,c[7]||"",!0)}else this.bc=!!b,this.g=new Ad(null,0,this.bc)}h=td.prototype;h.nc="";h.ie="";h.Ee="";h.Kd=null;h.Fc="";h.He="";h.bc=!1;
h.toString=function(){var a=[],b=this.nc;b&&a.push(Bd(b,Cd),":");if(b=this.K()){a.push("//");var c=this.ie;c&&a.push(Bd(c,Cd),"@");a.push(encodeURIComponent(String(b)));b=this.Kd;null!=b&&a.push(":",String(b))}if(b=this.Fc)this.Ee&&"/"!=b.charAt(0)&&a.push("/"),a.push(Bd(b,"/"==b.charAt(0)?Dd:Ed));(b=this.g.toString())&&a.push("?",b);(b=this.He)&&a.push("#",Bd(b,Fd));return a.join("")};h.ga=function(){return new td(this)};
function ud(a,b,c){a.nc=c?b?decodeURIComponent(b):"":b;a.nc&&(a.nc=a.nc.replace(/:$/,""));return a}h.K=function(){return this.Ee};function vd(a,b,c){a.Ee=c?b?decodeURIComponent(b):"":b;return a}function wd(a,b){if(b){b=Number(b);if(isNaN(b)||0>b)throw Error("Bad port number "+b);a.Kd=b}else a.Kd=null}function Gd(a){return a.Fc}function xd(a,b,c){a.Fc=c?b?decodeURIComponent(b):"":b}function yd(a,b,c){b instanceof Ad?(a.g=b,Hd(a.g,a.bc)):(c||(b=Bd(b,Id)),a.g=new Ad(b,0,a.bc))}
function zd(a,b,c){a.He=c?b?decodeURIComponent(b):"":b}function Bd(a,b){return x(a)?encodeURI(a).replace(b,Jd):null}function Jd(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Cd=/[#\/\?@]/g,Ed=/[\#\?:]/g,Dd=/[\#\?]/g,Id=/[\#\?@]/g,Fd=/#/g;function Ad(a,b,c){this.g=a||null;this.h=!!c}
function Kd(a){if(!a.ja&&(a.ja=new nd,a.Na=0,a.g))for(var b=a.g.split("&"),c=0;c<b.length;c++){var d=b[c].indexOf("="),e=null,f=null;0<=d?(e=b[c].substring(0,d),f=b[c].substring(d+1)):e=b[c];e=decodeURIComponent(e.replace(/\+/g," "));e=Ld(a,e);a.add(e,f?decodeURIComponent(f.replace(/\+/g," ")):"")}}h=Ad.prototype;h.ja=null;h.Na=null;h.da=function(){Kd(this);return this.Na};h.add=function(a,b){Kd(this);this.g=null;a=Ld(this,a);var c=this.ja.get(a);c||this.ja.set(a,c=[]);c.push(b);this.Na++;return this};
h.remove=function(a){Kd(this);a=Ld(this,a);return pd(this.ja.h,a)?(this.g=null,this.Na-=this.ja.get(a).length,this.ja.remove(a)):!1};h.clear=function(){this.ja=this.g=null;this.Na=0};h.Pa=function(){Kd(this);return 0==this.Na};function Md(a,b){Kd(a);b=Ld(a,b);return pd(a.ja.h,b)}h.Ra=function(){Kd(this);for(var a=this.ja.Ba(),b=this.ja.Ra(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c};
h.Ba=function(a){Kd(this);var b=[];if(x(a))Md(this,a)&&(b=$a(b,this.ja.get(Ld(this,a))));else{a=this.ja.Ba();for(var c=0;c<a.length;c++)b=$a(b,a[c])}return b};h.set=function(a,b){Kd(this);this.g=null;a=Ld(this,a);Md(this,a)&&(this.Na-=this.ja.get(a).length);this.ja.set(a,[b]);this.Na++;return this};h.get=function(a,b){var c=a?this.Ba(a):[];return 0<c.length?String(c[0]):b};
h.toString=function(){if(this.g)return this.g;if(!this.ja)return"";for(var a=[],b=this.ja.Ra(),c=0;c<b.length;c++)for(var d=b[c],e=encodeURIComponent(String(d)),d=this.Ba(d),f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f])));a.push(g)}return this.g=a.join("&")};h.ga=function(){var a=new Ad;a.g=this.g;this.ja&&(a.ja=this.ja.ga(),a.Na=this.Na);return a};function Ld(a,b){var c=String(b);a.h&&(c=c.toLowerCase());return c}
function Hd(a,b){b&&!a.h&&(Kd(a),a.g=null,gd(a.ja,function(a,b){var e=b.toLowerCase();b!=e&&(this.remove(b),this.remove(e),0<a.length&&(this.g=null,this.ja.set(Ld(this,e),ab(a)),this.Na+=a.length))},a));a.h=b};var Nd;
Nd={i:["BC","AD"],h:["Before Christ","Anno Domini"],p:"JFMAMJJASOND".split(""),fa:"JFMAMJJASOND".split(""),o:"January February March April May June July August September October November December".split(" "),Y:"January February March April May June July August September October November December".split(" "),H:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Ka:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),Lc:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Xb:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),
V:"Sun Mon Tue Wed Thu Fri Sat".split(" "),Xa:"Sun Mon Tue Wed Thu Fri Sat".split(" "),s:"SMTWTFS".split(""),oa:"SMTWTFS".split(""),M:["Q1","Q2","Q3","Q4"],G:["1st quarter","2nd quarter","3rd quarter","4th quarter"],g:["AM","PM"],Jf:["EEEE, MMMM d, y","MMMM d, y","MMM d, y","M/d/yy"],Qf:["h:mm:ss a zzzz","h:mm:ss a z","h:mm:ss a","h:mm a"],Kg:["{1} 'at' {0}","{1} 'at' {0}","{1}, {0}","{1}, {0}"],j:6,pd:[5,6],l:5};function Od(a){this.h=[];this.g=Nd;"number"==typeof a?Pd(this,a):Qd(this,a)}var Rd=[/^\'(?:[^\']|\'\')*\'/,/^(?:G+|y+|M+|k+|S+|E+|a+|h+|K+|H+|c+|L+|Q+|d+|m+|s+|v+|w+|z+|Z+)/,/^[^\'GyMkSEahKHcLQdmsvwzZ]+/];function Qd(a,b){for(;b;)for(var c=0;c<Rd.length;++c){var d=b.match(Rd[c]);if(d){d=d[0];b=b.substring(d.length);0==c&&("''"==d?d="'":(d=d.substring(1,d.length-1),d=d.replace(/\'\'/,"'")));a.h.push({text:d,type:c});break}}}
function Pd(a,b){var c;if(4>b)c=a.g.Jf[b];else if(8>b)c=a.g.Qf[b-4];else if(12>b)c=a.g.Kg[b-8],c=c.replace("{1}",a.g.Jf[b-8]),c=c.replace("{0}",a.g.Qf[b-8]);else{Pd(a,10);return}Qd(a,c)}function Sd(a){var b=Od.prototype;if(void 0===b.g||void 0===b.g.Rg)return a;for(var c=[],d=0;d<a.length;d++){var e=a.charCodeAt(d);c.push(48<=e&&57>=e?String.fromCharCode(b.g.Rg+e-48):a.charAt(d))}return c.join("")};var Td={Ig:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},Hg:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Ud=Td,Ud=Td;var Vd={Lf:".",Nf:",",Of:"%",ue:"0",Pg:"+",Mg:"-",Mf:"E",Pf:"\u2030",te:"\u221e",Ng:"NaN",Kf:"#,##0.###",Qg:"#E0",Og:"#,##0%",Jg:"\u00a4#,##0.00;(\u00a4#,##0.00)",Lg:"USD"},Wd=Vd,Wd=Vd;var Xd={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[0,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[18,"kr","kr"],DOP:[2,"$","RD$"],EGP:[2,"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[0,"Ft",
"Ft"],IDR:[0,"Rp","Rp"],ILS:[2,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],LVL:[2,"Ls","Ls"],MNT:[0,"\u20ae","MN\u20ae"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.","S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u0440\u0443\u0431.",
"\u0440\u0443\u0431."],SAR:[2,"Rial","Rial"],SEK:[2,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u20b4","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[0,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};function Yd(a,b,c){this.s=b||Wd.Lg;this.Xb=c||Zd;this.M=40;this.g=1;this.oa=0;this.j=3;this.V=this.h=0;this.Xa=!1;this.H=this.l="";this.i="-";this.o="";this.G=1;this.fa=3;this.Y=this.Ka=!1;this.p=$d;if("number"==typeof a)switch(a){case 1:ae(this,Wd.Kf);break;case 2:ae(this,Wd.Qg);break;case 3:ae(this,Wd.Og);break;case 4:a=Wd.Jg;b=["0"];c=Xd[this.s][0]&7;if(0<c){b.push(".");for(var d=0;d<c;d++)b.push("0")}a=a.replace(/0.00/g,b.join(""));ae(this,a);break;case 5:be(this,1);break;case 6:be(this,2);break;
default:throw Error("Unsupported pattern type.");}else ae(this,a)}var Zd=0,$d=0;
function ae(a,b){b.replace(/ /g,"\u00a0");var c=[0];a.l=ce(a,b,c);for(var d=c[0],e=-1,f=0,g=0,k=0,l=-1,m=b.length,n=!0;c[0]<m&&n;c[0]++)switch(b.charAt(c[0])){case "#":0<g?k++:f++;0<=l&&0>e&&l++;break;case "0":if(0<k)throw Error('Unexpected "0" in pattern "'+b+'"');g++;0<=l&&0>e&&l++;break;case ",":l=0;break;case ".":if(0<=e)throw Error('Multiple decimal separators in pattern "'+b+'"');e=f+g+k;break;case "E":if(a.Y)throw Error('Multiple exponential symbols in pattern "'+b+'"');a.Y=!0;a.V=0;c[0]+1<
m&&"+"==b.charAt(c[0]+1)&&(c[0]++,a.Xa=!0);for(;c[0]+1<m&&"0"==b.charAt(c[0]+1);)c[0]++,a.V++;if(1>f+g||1>a.V)throw Error('Malformed exponential pattern "'+b+'"');n=!1;break;default:c[0]--,n=!1}0==g&&0<f&&0<=e&&(g=e,0==g&&g++,k=f-g,f=g-1,g=1);if(0>e&&0<k||0<=e&&(e<f||e>f+g)||0==l)throw Error('Malformed pattern "'+b+'"');k=f+g+k;a.j=0<=e?k-e:0;0<=e&&(a.h=f+g-e,0>a.h&&(a.h=0));a.g=(0<=e?e:k)-f;a.Y&&(a.M=f+a.g,0==a.j&&0==a.g&&(a.g=1));a.fa=Math.max(0,l);a.Ka=0==e||e==k;d=c[0]-d;a.H=ce(a,b,c);c[0]<b.length&&
b.charAt(c[0])==de?(c[0]++,a.i=ce(a,b,c),c[0]+=d,a.o=ce(a,b,c)):(a.i=a.l+a.i,a.o+=a.H)}function be(a,b){a.p=b;ae(a,Wd.Kf);a.h=0;a.j=2;if(0<a.h)throw Error("Can't combine significant digits and minimum fraction digits");a.oa=2}
Yd.prototype.parse=function(a,b){var c=b||[0];if(this.p!=$d)throw Error("Parsing of compact numbers is unimplemented");var d=NaN;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.l,c[0])==c[0],f=a.indexOf(this.i,c[0])==c[0];e&&f&&(this.l.length>this.i.length?f=!1:this.l.length<this.i.length&&(e=!1));e?c[0]+=this.l.length:f&&(c[0]+=this.i.length);if(a.indexOf(Wd.te,c[0])==c[0])c[0]+=Wd.te.length,d=Infinity;else{var d=a,g=!1,k=!1,l=!1,m=1,n=Wd.Lf,p=Wd.Nf,r=Wd.Mf;if(this.p!=$d)throw Error("Parsing of compact style numbers is not implemented");
for(var s="";c[0]<d.length;c[0]++){var w=d.charAt(c[0]),z=ee(w);if(0<=z&&9>=z)s+=z,l=!0;else if(w==n.charAt(0)){if(g||k)break;s+=".";g=!0}else if(w==p.charAt(0)&&("\u00a0"!=p.charAt(0)||c[0]+1<d.length&&0<=ee(d.charAt(c[0]+1)))){if(g||k)break}else if(w==r.charAt(0)){if(k)break;s+="E";k=!0}else if("+"==w||"-"==w)s+=w;else if(w==Wd.Of.charAt(0)){if(1!=m)break;m=100;if(l){c[0]++;break}}else if(w==Wd.Pf.charAt(0)){if(1!=m)break;m=1E3;if(l){c[0]++;break}}else break}d=parseFloat(s)/m}if(e){if(a.indexOf(this.H,
c[0])!=c[0])return NaN;c[0]+=this.H.length}else if(f){if(a.indexOf(this.o,c[0])!=c[0])return NaN;c[0]+=this.o.length}return f?-d:d};function ge(a,b){var c=Math.pow(10,a.j),d=0>=a.oa?Math.round(b*c):Math.floor(he(b*c,a.oa,a.j)),e;isFinite(d)?(e=Math.floor(d/c),c=Math.floor(d-e*c)):(e=b,c=0);return{og:e,Wg:c}}
function ie(a,b,c,d){if(a.h>a.j)throw Error("Min value must be less than max value");b=ge(a,b);var e=Math.pow(10,a.j),f=b.og,g=b.Wg,k=0<a.h||0<g||!1;b=a.h;k&&(b=a.h);for(var l="",m=f;1E20<m;)l="0"+l,m=Math.round(m/10);var l=m+l,n=Wd.Lf,p=Wd.Nf,m=Wd.ue.charCodeAt(0),r=l.length;if(0<f||0<c){for(f=r;f<c;f++)d.push(String.fromCharCode(m));for(f=0;f<r;f++)d.push(String.fromCharCode(m+1*l.charAt(f))),1<r-f&&0<a.fa&&1==(r-f)%a.fa&&d.push(p)}else k||d.push(String.fromCharCode(m));(a.Ka||k)&&d.push(n);a=""+
(g+e);for(c=a.length;"0"==a.charAt(c-1)&&c>b+1;)c--;for(f=1;f<c;f++)d.push(String.fromCharCode(m+1*a.charAt(f)))}function je(a,b,c){c.push(Wd.Mf);0>b?(b=-b,c.push(Wd.Mg)):a.Xa&&c.push(Wd.Pg);b=""+b;for(var d=Wd.ue,e=b.length;e<a.V;e++)c.push(d);c.push(b)}function ee(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Wd.ue.charCodeAt(0);return b<=a&&a<b+10?a-b:-1}var de=";";
function ce(a,b,c){for(var d="",e=!1,f=b.length;c[0]<f;c[0]++){var g=b.charAt(c[0]);if("'"==g)c[0]+1<f&&"'"==b.charAt(c[0]+1)?(c[0]++,d+="'"):e=!e;else if(e)d+=g;else switch(g){case "#":case "0":case ",":case ".":case de:return d;case "\u00a4":if(c[0]+1<f&&"\u00a4"==b.charAt(c[0]+1))c[0]++,d+=a.s;else switch(a.Xb){case Zd:d+=Xd[a.s][1];break;case 2:var g=a.s,k=Xd[g],d=d+(g==k[1]?g:g+" "+k[1]);break;case 1:d+=Xd[a.s][2]}break;case "%":if(1!=a.G)throw Error("Too many percent/permill");a.G=100;d+=Wd.Of;
break;case "\u2030":if(1!=a.G)throw Error("Too many percent/permill");a.G=1E3;d+=Wd.Pf;break;default:d+=g}}return d}var ke={prefix:"",xg:"",De:0};function le(a,b){var c=1==a.p?Ud.Ig:Ud.Hg;if(3>b)return ke;b=Math.min(14,b);c=c[Math.pow(10,b)];if(!c)return ke;c=c.other;return c&&"0"!=c?(c=/([^0]*)(0+)(.*)/.exec(c))?{prefix:c[1],xg:c[3],De:b-(c[2].length-1)}:ke:ke}function me(a){for(var b=0;1<=(a/=10);)b++;return b}
function he(a,b,c){if(!a)return a;b=b-me(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};function ne(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"}var oe=ne,oe=ne;function pe(a){return 1==a?"one":"other"}var qe=pe,qe=pe;function re(a){this.g=[];this.i=[];this.j=new Yd(1);a&&(a=se(this,a),this.i=te(this,a))}var ue=RegExp("'([{}#].*?)'","g"),ve=RegExp("''","g");
function we(a,b,c,d,e){for(var f=0;f<b.length;f++)switch(b[f].type){case 4:e.push(b[f].value);break;case 3:var g=b[f].value,k=a,l=e,m=c[g];t(m)?(k.g.push(m),l.push(k.h(k.g))):l.push("Undefined parameter - "+g);break;case 2:g=b[f].value;k=e;l=g.ud;t(c[l])?(l=g[c[l]],t(l)||(l=g.other),we(a,l,c,d,k)):k.push("Undefined parameter - "+l);break;case 0:g=b[f].value;xe(a,g,c,qe,d,e);break;case 1:g=b[f].value;xe(a,g,c,oe,d,e);break;default:Na("Unrecognized block type.")}}
function xe(a,b,c,d,e,f){var g=b.ud,k=b.Uf,l=+c[g];if(isNaN(l))f.push("Undefined or invalid parameter - "+g);else if(k=l-k,g=b[c[g]],t(g)||(d=d(k),g=b[d],t(g)||(g=b.other)),b=[],we(a,g,c,e,b),c=b.join(""),e)f.push(c);else{a=a.j;if(isNaN(k))a=Wd.Ng;else{e=[];g=d=k;a.p==$d?b=ke:(d=Math.abs(d),g=Math.abs(g),b=le(a,1>=d?0:me(d)).De,ge(a,g/Math.pow(10,b)),d=ge(a,d/Math.pow(10,b)),b=le(a,b+me(d.og)));k/=Math.pow(10,b.De);e.push(b.prefix);d=0>k||0==k&&0>1/k;e.push(d?a.i:a.l);if(isFinite(k))if(k=k*(d?-1:
1)*a.G,a.Y)if(0==k)ie(a,k,a.g,e),je(a,0,e);else{g=Math.log(k)/Math.log(10);g=Math.floor(g+2E-15);k/=Math.pow(10,g);l=a.g;if(1<a.M&&a.M>a.g){for(;0!=g%a.M;)k*=10,g--;l=1}else 1>a.g?(g++,k/=10):(g-=a.g-1,k*=Math.pow(10,a.g-1));ie(a,k,l,e);je(a,g,e)}else ie(a,k,a.g,e);else e.push(Wd.te);e.push(d?a.o:a.H);e.push(b.xg);a=e.join("")}f.push(c.replace(/#/g,a))}}
function se(a,b){var c=a.g,d=na(a.h,a);b=b.replace(ve,function(){c.push("'");return d(c)});return b=b.replace(ue,function(a,b){c.push(b);return d(c)})}function ye(a){var b=0,c=[],d=[],e=/[{}]/g;e.lastIndex=0;for(var f;f=e.exec(a);){var g=f.index;"}"==f[0]?(c.pop(),0==c.length&&(f={type:1},f.value=a.substring(b,g),d.push(f),b=g+1)):(0==c.length&&(b=a.substring(b,g),""!=b&&d.push({type:0,value:b}),b=g+1),c.push("{"))}b=a.substring(b);""!=b&&d.push({type:0,value:b});return d}
var ze=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Ae=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Be=/^\s*(\w+)\s*,\s*select\s*,/;
function te(a,b){for(var c=[],d=ye(b),e=0;e<d.length;e++){var f={};if(0==d[e].type)f.type=4,f.value=d[e].value;else if(1==d[e].type){var g=d[e].value;switch(ze.test(g)?0:Ae.test(g)?1:Be.test(g)?2:/^\s*\w+\s*/.test(g)?3:5){case 2:f.type=2;f.value=Ce(a,d[e].value);break;case 0:f.type=0;f.value=De(a,d[e].value);break;case 1:f.type=1;f.value=Ee(a,d[e].value);break;case 3:f.type=3;f.value=d[e].value;break;default:Na("Unknown block type.")}}else Na("Unknown part of the pattern.");c.push(f)}return c}
function Ce(a,b){var c="";b=b.replace(Be,function(a,b){c=b;return""});var d={};d.ud=c;for(var e=ye(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=te(a,e[f].value);else Na("Expected block type.");d[g.replace(/\s/g,"")]=k;f++}return d}
function De(a,b){var c="",d=0;b=b.replace(ze,function(a,b,e){c=b;e&&(d=parseInt(e,10));return""});var e={};e.ud=c;e.Uf=d;for(var f=ye(b),g=0;g<f.length;){var k=f[g].value;g++;if(1==f[g].type)var l=te(a,f[g].value);else Na("Expected block type.");e[k.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=l;g++}return e}
function Ee(a,b){var c="";b=b.replace(Ae,function(a,b){c=b;return""});var d={};d.ud=c;d.Uf=0;for(var e=ye(b),f=0;f<e.length;){var g=e[f].value;f++;if(1==e[f].type)var k=te(a,e[f].value);else Na("Expected block type.");d[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return d}re.prototype.h=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};function Fe(a,b,c){a=new re(a);b={COUNT:b,TEXT:c};if(0==a.i.length)a="";else{c=[];we(a,a.i,b,!1,c);for(b=c.join("");0<a.g.length;)b=b.replace(a.h(a.g),a.g.pop());a=b}return a};function Ge(a){this.g=new nd;if(a){a=fd(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])}}function He(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+ha(a):b.substr(0,1)+a}h=Ge.prototype;h.da=function(){return this.g.da()};h.add=function(a){this.g.set(He(a),a)};h.removeAll=function(a){a=fd(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};h.remove=function(a){return this.g.remove(He(a))};h.clear=function(){this.g.clear()};h.Pa=function(){return this.g.Pa()};
h.contains=function(a){a=He(a);return pd(this.g.h,a)};h.Ba=function(){return this.g.Ba()};h.ga=function(){return new Ge(this)};h.Nb=function(){return this.g.Nb(!1)};function Ie(a){return Je(a||arguments.callee.caller,[])}
function Je(a,b){var c=[];if(Xa(b,a))c.push("[...circular reference...]");else if(a&&50>b.length){c.push(Ke(a)+"(");for(var d=a.arguments,e=0;e<d.length;e++){0<e&&c.push(", ");var f;f=d[e];switch(typeof f){case "object":f=f?"object":"null";break;case "string":break;case "number":f=String(f);break;case "boolean":f=f?"true":"false";break;case "function":f=(f=Ke(f))?f:"[fn]";break;default:f=typeof f}40<f.length&&(f=f.substr(0,40)+"...");c.push(f)}b.push(a);c.push(")\n");try{c.push(Je(a.caller,b))}catch(g){c.push("[exception trying to get caller]\n")}}else a?
c.push("[...long stack...]"):c.push("[end]");return c.join("")}function Ke(a){if(Le[a])return Le[a];a=String(a);if(!Le[a]){var b=/function ([^\(]+)/.exec(a);Le[a]=b?b[1]:"[Anonymous]"}return Le[a]}var Le={};function Me(a,b,c,d,e){this.o="number"==typeof e?e:Ne++;this.l=d||B();this.j=a;this.p=b;this.h=c;delete this.i;delete this.g}Me.prototype.o=0;Me.prototype.i=null;Me.prototype.g=null;var Ne=0;Me.prototype.getMessage=function(){return this.p};function Oe(a){this.l=a}Oe.prototype.i=null;Oe.prototype.h=null;Oe.prototype.j=null;Oe.prototype.g=null;function Pe(a,b){this.name=a;this.value=b}Pe.prototype.toString=function(){return this.name};var Qe=new Pe("SHOUT",1200),Re=new Pe("SEVERE",1E3),Se=new Pe("WARNING",900),Te=new Pe("INFO",800),Ue=new Pe("CONFIG",700),Ve=new Pe("FINE",500),We=new Pe("FINER",400),Xe=new Pe("FINEST",300),Ye=[new Pe("OFF",Infinity),Qe,Re,Se,Te,Ue,Ve,We,Xe,new Pe("ALL",0)],Ze=null;h=Oe.prototype;h.getName=function(){return this.l};
function $e(a,b){a.g||(a.g=[]);a.g.push(b)}h.getParent=function(){return this.i};h.getChildren=function(){this.j||(this.j={});return this.j};function af(a){if(a.h)return a.h;if(a.i)return af(a.i);Na("Root logger has no level set.");return null}
h.log=function(a,b,c){if(a.value>=af(this).value)for(ga(b)&&(b=b()),a=this.Zg(a,b,c),b="log:"+a.getMessage(),q.console&&(q.console.timeStamp?q.console.timeStamp(b):q.console.markTimeline&&q.console.markTimeline(b)),q.msWriteProfilerMark&&q.msWriteProfilerMark(b),b=this;b;){c=b;var d=a;if(c.g)for(var e=0,f=void 0;f=c.g[e];e++)f(d);b=b.getParent()}};
h.Zg=function(a,b,c){var d=new Me(a,String(b),this.l);if(c){d.i=c;var e;var f=arguments.callee.caller;try{var g;var k=ba("window.location.href");if(x(c))g={message:c,name:"Unknown error",lineNumber:"Not available",fileName:k,stack:"Not available"};else{var l,m,n=!1;try{l=c.lineNumber||c.pi||"Not available"}catch(p){l="Not available",n=!0}try{m=c.fileName||c.filename||c.sourceURL||q.$googDebugFname||k}catch(r){m="Not available",n=!0}g=!n&&c.lineNumber&&c.fileName&&c.stack&&c.message&&c.name?c:{message:c.message||
"Not available",name:c.name||"UnknownError",lineNumber:l,fileName:m,stack:c.stack||"Not available"}}e="Message: "+za(g.message)+'\nUrl: <a href="view-source:'+g.fileName+'" target="_new">'+g.fileName+"</a>\nLine: "+g.lineNumber+"\n\nBrowser stack:\n"+za(g.stack+"-> ")+"[end]\n\nJS stack traversal:\n"+za(Ie(f)+"-> ")}catch(s){e="Exception trying to expose exception! You win, we lose. "+s}d.g=e}return d};function M(a,b,c){a.log(Se,b,c)}h.info=function(a,b){this.log(Te,a,b)};
function O(a,b,c){a.log(Ve,b,c)}function P(a,b){a.log(We,b,void 0)}function Q(a,b){a.log(Xe,b,void 0)}var bf={},cf=null;function df(){cf||(cf=new Oe(""),bf[""]=cf,cf.h=Ue)}function ef(){df();return cf}function R(a){df();var b;if(!(b=bf[a])){b=new Oe(a);var c=a.lastIndexOf("."),d=a.substr(c+1),c=R(a.substr(0,c));c.getChildren()[d]=b;b.i=c;bf[a]=b}return b};function ff(a){vb.call(this);this.h=a;this.g={}}C(ff,vb);var gf=[];h=ff.prototype;h.listen=function(a,b,c,d){u(b)||(gf[0]=b,b=gf);for(var e=0;e<b.length;e++){var f=Ac(a,b[e],c||this.handleEvent,d||!1,this.h||this);if(!f)break;this.g[f.key]=f}return this};h.ya=function(a,b,c,d,e){if(u(b))for(var f=0;f<b.length;f++)this.ya(a,b[f],c,d,e);else c=c||this.handleEvent,e=e||this.h||this,c=Bc(c),d=!!d,b=ec(a)?vc(a.vb,String(b),c,d,e):a?(a=Dc(a))?vc(a,b,c,d,e):null:null,b&&(Ic(b),delete this.g[b.key]);return this};
h.removeAll=function(){ic(this.g,Ic);this.g={}};h.I=function(){ff.m.I.call(this);this.removeAll()};h.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};function hf(a,b){Mc.call(this);this.h=a||1;this.g=b||q;this.i=na(this.Th,this);this.j=B()}C(hf,Mc);h=hf.prototype;h.Xc=!1;h.ea=null;h.setInterval=function(a){this.h=a;this.ea&&this.Xc?(this.stop(),jf(this)):this.ea&&this.stop()};h.Th=function(){if(this.Xc){var a=B()-this.j;0<a&&a<0.8*this.h?this.ea=this.g.setTimeout(this.i,this.h-a):(this.ea&&(this.g.clearTimeout(this.ea),this.ea=null),this.dispatchEvent(kf),this.Xc&&(this.ea=this.g.setTimeout(this.i,this.h),this.j=B()))}};
function jf(a){a.Xc=!0;a.ea||(a.ea=a.g.setTimeout(a.i,a.h),a.j=B())}h.stop=function(){this.Xc=!1;this.ea&&(this.g.clearTimeout(this.ea),this.ea=null)};h.I=function(){hf.m.I.call(this);this.stop();delete this.g};var kf="tick";function lf(a,b,c){if(ga(a))c&&(a=na(a,c));else if(a&&"function"==typeof a.handleEvent)a=na(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<b?-1:q.setTimeout(a,b||0)};function mf(a){a=String(a);if(/^\s*$/.test(a)?0:/^[\],:{}\s\u2028\u2029]*$/.test(a.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,"")))try{return JSON.parse(a)}catch(b){}throw Error("Invalid JSON string: "+a);}function nf(){}function of(a,b){var c=[];pf(a,b,c);return c.join("")}
function pf(a,b,c){switch(typeof b){case "string":qf(b,c);break;case "number":c.push(isFinite(b)&&!isNaN(b)?b:"null");break;case "boolean":c.push(b);break;case "undefined":c.push("null");break;case "object":if(null==b){c.push("null");break}if(u(b)){var d=b.length;c.push("[");for(var e="",f=0;f<d;f++)c.push(e),pf(a,b[f],c),e=",";c.push("]");break}c.push("{");d="";for(e in b)Object.prototype.hasOwnProperty.call(b,e)&&(f=b[e],"function"!=typeof f&&(c.push(d),qf(e,c),c.push(":"),pf(a,f,c),d=","));c.push("}");
break;case "function":break;default:throw Error("Unknown type: "+typeof b);}}var rf={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},sf=/\uffff/.test("\uffff")?/[\\\"\x00-\x1f\x7f-\uffff]/g:/[\\\"\x00-\x1f\x7f-\xff]/g;function qf(a,b){b.push('"',a.replace(sf,function(a){if(a in rf)return rf[a];var b=a.charCodeAt(0),e="\\u";16>b?e+="000":256>b?e+="00":4096>b&&(e+="0");return rf[a]=e+b.toString(16)}),'"')};function tf(a,b){a&&O(a,b,void 0)};function uf(){}uf.prototype.g=null;function vf(a){var b;(b=a.g)||(b={},wf(a)&&(b[0]=!0,b[1]=!0),b=a.g=b);return b};var xf;function yf(){}C(yf,uf);function zf(a){return(a=wf(a))?new ActiveXObject(a):new XMLHttpRequest}function wf(a){if(!a.h&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var b=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<b.length;c++){var d=b[c];try{return new ActiveXObject(d),a.h=d}catch(e){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed");}return a.h}xf=new yf;function Af(a){Mc.call(this);this.headers=new nd;this.fa=a||null;this.h=!1;this.Y=this.Q=null;this.Xa=this.s="";this.o=0;this.p="";this.i=this.Ka=this.H=this.oa=!1;this.l=0;this.M=null;this.j=Bf;this.V=this.pd=!1}C(Af,Mc);var Bf="";Af.prototype.g=R("goog.net.XhrIo");var Cf=/^https?$/i,Df=["POST","PUT"];h=Af.prototype;h.eg=function(){return this.j};
h.send=function(a,b,c,d){if(this.Q)throw Error("[goog.net.XhrIo] Object is active with another request="+this.s+"; newUri="+a);b=b?b.toUpperCase():"GET";this.s=a;this.p="";this.o=0;this.Xa=b;this.oa=!1;this.h=!0;this.Q=this.fa?zf(this.fa):zf(xf);this.Y=this.fa?vf(this.fa):vf(xf);this.Q.onreadystatechange=na(this.tg,this);try{tf(this.g,Ef(this,"Opening Xhr")),this.Ka=!0,this.Q.open(b,a,!0),this.Ka=!1}catch(e){tf(this.g,Ef(this,"Error opening Xhr: "+e.message));Ff(this,e);return}a=c||"";var f=this.headers.ga();
d&&gd(d,function(a,b){f.set(b,a)});d=Va(f.Ra(),Gf);c=q.FormData&&a instanceof q.FormData;!Xa(Df,b)||d||c||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");gd(f,function(a,b){this.Q.setRequestHeader(b,a)},this);this.j&&(this.Q.responseType=this.j);"withCredentials"in this.Q&&(this.Q.withCredentials=this.pd);try{Hf(this),0<this.l&&(this.V=If(this.Q),tf(this.g,Ef(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.V)),this.V?(this.Q.timeout=this.l,this.Q.ontimeout=na(this.yg,
this)):this.M=lf(this.yg,this.l,this)),tf(this.g,Ef(this,"Sending request")),this.H=!0,this.Q.send(a),this.H=!1}catch(g){tf(this.g,Ef(this,"Send error: "+g.message)),Ff(this,g)}};function If(a){return H&&Ub(9)&&y(a.timeout)&&t(a.ontimeout)}function Gf(a){return"content-type"==a.toLowerCase()}h.yg=function(){"undefined"!=typeof aa&&this.Q&&(this.p="Timed out after "+this.l+"ms, aborting",this.o=8,tf(this.g,Ef(this,this.p)),this.dispatchEvent("timeout"),this.abort(8))};
function Ff(a,b){a.h=!1;a.Q&&(a.i=!0,a.Q.abort(),a.i=!1);a.p=b;a.o=5;Jf(a);Kf(a)}function Jf(a){a.oa||(a.oa=!0,a.dispatchEvent("complete"),a.dispatchEvent("error"))}h.abort=function(a){this.Q&&this.h&&(tf(this.g,Ef(this,"Aborting")),this.h=!1,this.i=!0,this.Q.abort(),this.i=!1,this.o=a||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Kf(this))};h.I=function(){this.Q&&(this.h&&(this.h=!1,this.i=!0,this.Q.abort(),this.i=!1),Kf(this,!0));Af.m.I.call(this)};
h.tg=function(){this.G||(this.Ka||this.H||this.i?Lf(this):this.Nh())};h.Nh=function(){Lf(this)};function Lf(a){if(a.h&&"undefined"!=typeof aa)if(a.Y[1]&&4==Mf(a)&&2==a.O())tf(a.g,Ef(a,"Local request error detected and ignored"));else if(a.H&&4==Mf(a))lf(a.tg,0,a);else if(a.dispatchEvent("readystatechange"),4==Mf(a)){tf(a.g,Ef(a,"Request complete"));a.h=!1;try{a.Ga()?(a.dispatchEvent("complete"),a.dispatchEvent("success")):(a.o=6,a.p=a.Ma()+" ["+a.O()+"]",Jf(a))}finally{Kf(a)}}}
function Kf(a,b){if(a.Q){Hf(a);var c=a.Q,d=a.Y[0]?ca:null;a.Q=null;a.Y=null;b||a.dispatchEvent("ready");try{c.onreadystatechange=d}catch(e){(c=a.g)&&c.log(Re,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Hf(a){a.Q&&a.V&&(a.Q.ontimeout=null);y(a.M)&&(q.clearTimeout(a.M),a.M=null)}
h.Ga=function(){var a=this.O(),b;a:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:b=!0;break a;default:b=!1}if(!b){if(a=0===a)a=rd(String(this.s))[1]||null,!a&&self.location&&(a=self.location.protocol,a=a.substr(0,a.length-1)),a=!Cf.test(a?a.toLowerCase():"");b=a}return b};function Mf(a){return a.Q?a.Q.readyState:0}h.O=function(){try{return 2<Mf(this)?this.Q.status:-1}catch(a){var b=this.g;b&&M(b,"Can not get status: "+a.message,void 0);return-1}};
h.Ma=function(){try{return 2<Mf(this)?this.Q.statusText:""}catch(a){return tf(this.g,"Can not get status: "+a.message),""}};
function Nf(a){try{if(!a.Q)return null;if("response"in a.Q)return a.Q.response;switch(a.j){case Bf:case "text":return a.Q.responseText;case "arraybuffer":if("mozResponseArrayBuffer"in a.Q)return a.Q.mozResponseArrayBuffer}var b=a.g;b&&b.log(Re,"Response type "+a.j+" is not supported on this browser",void 0);return null}catch(c){return tf(a.g,"Can not get response: "+c.message),null}}function Ef(a,b){return b+" ["+a.Xa+" "+a.s+" "+a.O()+"]"};function Of(){this.i=this.h=0;this.g=[]}function Pf(a){if(a.h!=a.i){var b=a.g[a.h];delete a.g[a.h];a.h++;return b}}h=Of.prototype;h.da=function(){return this.i-this.h};h.Pa=function(){return 0==this.i-this.h};h.clear=function(){this.i=this.h=this.g.length=0};h.contains=function(a){return Xa(this.g,a)};h.remove=function(a){a=Pa(this.g,a);if(0>a)return!1;a==this.h?Pf(this):(Oa.splice.call(this.g,a,1),this.i--);return!0};h.Ba=function(){return this.g.slice(this.h,this.i)};function Qf(a,b){vb.call(this);this.o=a||0;this.i=b||10;if(this.o>this.i)throw Error(Rf);this.g=new Of;this.h=new Ge;this.l=null;this.rd()}C(Qf,vb);var Rf="[goog.structs.Pool] Min can not be greater than max";h=Qf.prototype;h.Ld=function(){var a=B();if(!(null!=this.l&&0>a-this.l)){for(var b;0<this.g.da()&&(b=Pf(this.g),!this.sf(b));)this.rd();!b&&this.da()<this.i&&(b=this.Qe());b&&(this.l=a,this.h.add(b));return b}};h.ce=function(a){return this.h.remove(a)?(this.ve(a),!0):!1};
h.ve=function(a){this.h.remove(a);if(this.sf(a)&&this.da()<this.i){var b=this.g;b.g[b.i++]=a}else Sf(a)};h.rd=function(){for(var a=this.g;this.da()<this.o;){var b=this.Qe();a.g[a.i++]=b}for(;this.da()>this.i&&0<this.g.da();)Sf(Pf(a))};h.Qe=function(){return{}};function Sf(a){if("function"==typeof a.la)a.la();else for(var b in a)a[b]=null}h.sf=function(a){return"function"==typeof a.Tg?a.Tg():!0};h.contains=function(a){return this.g.contains(a)||this.h.contains(a)};
h.da=function(){return this.g.da()+this.h.da()};h.Pa=function(){return this.g.Pa()&&this.h.Pa()};h.I=function(){Qf.m.I.call(this);if(0<this.h.da())throw Error("[goog.structs.Pool] Objects not released");delete this.h;for(var a=this.g;!a.Pa();)Sf(Pf(a));delete this.g};function Tf(a,b){this.g=a;this.h=b}Tf.prototype.S=function(){return this.h};Tf.prototype.ga=function(){return new Tf(this.g,this.h)};function Uf(a){this.g=[];if(a)a:{var b,c;if(a instanceof Uf){if(b=a.Ra(),c=a.Ba(),0>=a.da()){a=this.g;for(var d=0;d<b.length;d++)a.push(new Tf(b[d],c[d]));break a}}else b=kc(a),c=jc(a);for(d=0;d<b.length;d++)Vf(this,b[d],c[d])}}function Vf(a,b,c){var d=a.g;d.push(new Tf(b,c));b=d.length-1;a=a.g;for(c=a[b];0<b;)if(d=b-1>>1,a[d].g>c.g)a[b]=a[d],b=d;else break;a[b]=c}h=Uf.prototype;
h.remove=function(){var a=this.g,b=a.length,c=a[0];if(!(0>=b)){if(1==b)Ya(a);else{a[0]=a.pop();for(var a=0,b=this.g,d=b.length,e=b[a];a<d>>1;){var f=2*a+1,g=2*a+2,f=g<d&&b[g].g<b[f].g?g:f;if(b[f].g>e.g)break;b[a]=b[f];a=f}b[a]=e}return c.S()}};h.Ba=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].S());return b};h.Ra=function(){for(var a=this.g,b=[],c=a.length,d=0;d<c;d++)b.push(a[d].g);return b};h.ga=function(){return new Uf(this)};h.da=function(){return this.g.length};
h.Pa=function(){return 0==this.g.length};h.clear=function(){Ya(this.g)};function Wf(){Uf.call(this)}C(Wf,Uf);function Xf(a,b){this.j=new Wf;Qf.call(this,a,b)}C(Xf,Qf);h=Xf.prototype;h.Ld=function(a,b){if(!a)return Xf.m.Ld.call(this);Vf(this.j,t(b)?b:100,a);this.ff()};h.ff=function(){for(var a=this.j;0<a.da();){var b=this.Ld();if(b)a.remove().apply(this,[b]);else break}};h.ve=function(a){Xf.m.ve.call(this,a);this.ff()};h.rd=function(){Xf.m.rd.call(this);this.ff()};h.I=function(){Xf.m.I.call(this);q.clearTimeout(void 0);this.j.clear();this.j=null};function Yf(a,b,c){Xf.call(this,b,c);this.p=a}C(Yf,Xf);Yf.prototype.Qe=function(){var a=new Af,b=this.p;b&&gd(b,function(b,d){a.headers.set(d,b)});return a};Yf.prototype.sf=function(a){return!a.G&&!a.Q};function Zf(a,b,c,d,e){Mc.call(this);this.i=t(a)?a:1;this.j=t(e)?Math.max(0,e):0;this.Jc=new Yf(b,c,d);this.g=new nd;this.h=new ff(this)}C(Zf,Mc);var $f="ready complete success error abort timeout".split(" ");h=Zf.prototype;h.send=function(a,b,c,d,e,f,g,k,l){if(this.g.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new ag(b,na(this.qh,this,a),c,d,e,g,t(k)?k:this.i,l);this.g.set(a,b);a=na(this.ih,this,a);this.Jc.Ld(a,f);return b};
h.abort=function(a,b){var c=this.g.get(a);if(c){var d=c.ke;c.Rf=!0;b&&(d&&(this.h.ya(d,$f,c.je),Gc(d,"ready",function(){this.Jc.ce(d)},!1,this)),this.g.remove(a));d&&d.abort()}};h.ih=function(a,b){var c=this.g.get(a);c&&!c.ke?(this.h.listen(b,$f,c.je),b.l=Math.max(0,this.j),b.j=c.eg(),c.ke=b,this.dispatchEvent(new bg("ready",this,a,b)),cg(this,a,b),c.Rf&&b.abort()):this.Jc.ce(b)};
h.qh=function(a,b){var c=b.target;switch(b.type){case "ready":cg(this,a,c);break;case "complete":a:{var d=this.g.get(a);if(7==c.o||c.Ga()||d.vd>d.Oe)if(this.dispatchEvent(new bg("complete",this,a,c)),d&&(d.$f=!0,d.Ae)){c=d.Ae.call(c,b);break a}c=null}return c;case "success":this.dispatchEvent(new bg("success",this,a,c));break;case "timeout":case "error":d=this.g.get(a);d.vd>d.Oe&&this.dispatchEvent(new bg("error",this,a,c));break;case "abort":this.dispatchEvent(new bg("abort",this,a,c))}return null};
function cg(a,b,c){var d=a.g.get(b);!d||d.$f||d.vd>d.Oe?(d&&(a.h.ya(c,$f,d.je),a.g.remove(b)),a.Jc.ce(c)):(d.vd++,c.send(d.Vh,d.Jd(),d.pa(),d.Vc()))}h.I=function(){Zf.m.I.call(this);this.Jc.la();this.Jc=null;this.h.la();this.h=null;var a=this.g;gd(a,function(a){a.la()});a.clear();this.g=null};function bg(a,b,c,d){K.call(this,a,b);this.id=c;this.ke=d}C(bg,K);
function ag(a,b,c,d,e,f,g,k){vb.call(this);this.Vh=a;this.i=c||"GET";this.g=d;this.h=e||null;this.Oe=t(g)?g:1;this.vd=0;this.Rf=this.$f=!1;this.je=b;this.Ae=f;this.j=k||Bf;this.ke=null}C(ag,vb);h=ag.prototype;h.Jd=function(){return this.i};h.pa=function(){return this.g};h.Vc=function(){return this.h};h.eg=function(){return this.j};h.I=function(){ag.m.I.call(this);delete this.je;delete this.Ae};function dg(a){for(var b=[],c=0,d=0;d<a.length;d++){for(var e=a.charCodeAt(d);255<e;)b[c++]=e&255,e>>=8;b[c++]=e}return b};function eg(){this.i=[];this.h=this.g=0};function fg(){};function gg(){this.g=[];this.j=[];this.o=[];this.i=[];this.i[0]=128;for(var a=1;64>a;++a)this.i[a]=0;this.g[0]=1732584193;this.g[1]=4023233417;this.g[2]=2562383102;this.g[3]=271733878;this.g[4]=3285377520;this.l=this.h=0}C(gg,fg);
function hg(a,b,c){c||(c=0);var d=a.o;if(x(b))for(var e=0;16>e;e++)d[e]=b.charCodeAt(c)<<24|b.charCodeAt(c+1)<<16|b.charCodeAt(c+2)<<8|b.charCodeAt(c+3),c+=4;else for(e=0;16>e;e++)d[e]=b[c]<<24|b[c+1]<<16|b[c+2]<<8|b[c+3],c+=4;for(e=16;80>e;e++){var f=d[e-3]^d[e-8]^d[e-14]^d[e-16];d[e]=(f<<1|f>>>31)&4294967295}b=a.g[0];c=a.g[1];for(var g=a.g[2],k=a.g[3],l=a.g[4],m,e=0;80>e;e++)40>e?20>e?(f=k^c&(g^k),m=1518500249):(f=c^g^k,m=1859775393):60>e?(f=c&g|k&(c|g),m=2400959708):(f=c^g^k,m=3395469782),f=(b<<
5|b>>>27)+f+l+m+d[e]&4294967295,l=k,k=g,g=(c<<30|c>>>2)&4294967295,c=b,b=f;a.g[0]=a.g[0]+b&4294967295;a.g[1]=a.g[1]+c&4294967295;a.g[2]=a.g[2]+g&4294967295;a.g[3]=a.g[3]+k&4294967295;a.g[4]=a.g[4]+l&4294967295}
gg.prototype.update=function(a,b){t(b)||(b=a.length);for(var c=b-64,d=0,e=this.j,f=this.h;d<b;){if(0==f)for(;d<=c;)hg(this,a,d),d+=64;if(x(a))for(;d<b;){if(e[f]=a.charCodeAt(d),++f,++d,64==f){hg(this,e);f=0;break}}else for(;d<b;)if(e[f]=a[d],++f,++d,64==f){hg(this,e);f=0;break}}this.h=f;this.l+=b};
function ig(a){var b=[],c=8*a.l;56>a.h?a.update(a.i,56-a.h):a.update(a.i,64-(a.h-56));for(var d=63;56<=d;d--)a.j[d]=c&255,c/=256;hg(a,a.j);for(d=c=0;5>d;d++)for(var e=24;0<=e;e-=8)b[c]=a.g[d]>>e&255,++c;return b};var jg=null,kg=null;function lg(a){this.g=a;this.h=new nf}lg.prototype.set=function(a,b){t(b)?this.g.set(a,of(this.h,b)):this.g.remove(a)};lg.prototype.get=function(a){var b;try{b=this.g.get(a)}catch(c){return}if(null!==b)try{return mf(b)}catch(d){throw"Storage: Invalid value was encountered";}};lg.prototype.remove=function(a){this.g.remove(a)};function mg(){};function ng(a){lg.call(this,a)}C(ng,lg);function og(a){this.data=a}function pg(a){return!t(a)||a instanceof og?a:new og(a)}function qg(a){a=a.data;if(!t(a))throw"Storage: Invalid value was encountered";return a}ng.prototype.set=function(a,b){ng.m.set.call(this,a,pg(b))};ng.prototype.Wc=function(a){a=ng.m.get.call(this,a);if(!t(a)||a instanceof Object)return a;throw"Storage: Invalid value was encountered";};ng.prototype.get=function(a){return(a=this.Wc(a))?qg(a):void 0};function rg(a){lg.call(this,a)}C(rg,ng);rg.prototype.set=function(a,b,c){if(b=pg(b)){if(c){if(c<B()){rg.prototype.remove.call(this,a);return}b.expiration=c}b.creation=B()}rg.m.set.call(this,a,b)};rg.prototype.Wc=function(a,b){var c=rg.m.Wc.call(this,a);if(c){var d;if(d=!b){d=c.creation;var e=c.expiration;d=!!e&&e<B()||!!d&&d>B()}if(d)rg.prototype.remove.call(this,a);else return c}};function sg(a){lg.call(this,a)}C(sg,rg);function tg(){}C(tg,mg);tg.prototype.da=function(){var a=0;ld(this.Nb(!0),function(){a++});return a};tg.prototype.clear=function(){var a=md(this.Nb(!0)),b=this;Qa(a,function(a){b.remove(a)})};function ug(a,b){lg.call(this,a);this.Pe=dg(b);this.Yf=new nf}C(ug,sg);h=ug.prototype;h.Pe=null;h.Yf=null;
function vg(a,b){var c=new gg;c.update(dg(b));c.update(a.Pe);c=ig(c);if(!v(c))throw Error("encodeByteArray takes an array as a parameter");if(!jg){jg={};kg={};for(var d=0;65>d;d++)jg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(d),kg[d]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(d)}for(var d=kg,e=[],f=0;f<c.length;f+=3){var g=c[f],k=f+1<c.length,l=k?c[f+1]:0,m=f+2<c.length,n=m?c[f+2]:0,p=g>>2,g=(g&3)<<4|l>>4,l=(l&15)<<2|n>>6,n=n&63;
m||(n=64,k||(l=64));e.push(d[p],d[g],d[l],d[n])}return e.join("")}
function wg(a,b,c,d){if(!(0<b.length))throw Error("Non-empty salt must be provided");var e=new gg;e.update(dg(c));e.update(b);e.update(a.Pe);a=new eg;var e=ig(e),f;f||(f=e.length);b=a.i;for(c=0;256>c;++c)b[c]=c;var g=0;for(c=0;256>c;++c){var g=g+b[c]+e[c%f]&255,k=b[c];b[c]=b[g];b[g]=k}a.g=0;a.h=0;f=a.g;e=a.h;b=a.i;for(c=0;1536>c;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=g;a.g=f;a.h=e;d=dg(d);var l;l||(l=d.length);f=a.g;e=a.h;b=a.i;for(c=0;c<l;++c)f=f+1&255,e=e+b[f]&255,g=b[f],b[f]=b[e],b[e]=
g,d[c]^=b[b[f]+b[e]&255];a.g=f;a.h=e;return String.fromCharCode.apply(null,d)}h.set=function(a,b,c){if(t(b)){for(var d=[],e=0;8>e;++e)d[e]=Math.floor(256*Math.random());b=new og(wg(this,d,a,of(this.Yf,b)));b.salt=d;ug.m.set.call(this,vg(this,a),b,c)}else ug.prototype.remove.call(this,a)};
h.Wc=function(a,b){var c=ug.m.Wc.call(this,vg(this,a),b);if(c){var d=qg(c),e=c.salt;if(!x(d)||!u(e)||!e.length)throw"Storage: Invalid value was encountered";d=wg(this,e,a,d);try{c.data=mf(d)}catch(f){throw"Storage: The value could not be decrypted";}return c}};h.remove=function(a){ug.m.remove.call(this,vg(this,a))};function xg(a){this.g=a}C(xg,tg);h=xg.prototype;h.set=function(a,b){try{this.g.setItem(a,b)}catch(c){if(0==this.g.length)throw"Storage mechanism: Storage disabled";throw"Storage mechanism: Quota exceeded";}};h.get=function(a){a=this.g.getItem(a);if(!x(a)&&null!==a)throw"Storage mechanism: Invalid value was encountered";return a};h.remove=function(a){this.g.removeItem(a)};h.da=function(){return this.g.length};
h.Nb=function(a){var b=0,c=this.g,d=new jd;d.g=function(){if(b>=c.length)throw hd;var d=c.key(b++);if(a)return d;d=c.getItem(d);if(!x(d))throw"Storage mechanism: Invalid value was encountered";return d};return d};h.clear=function(){this.g.clear()};h.key=function(a){return this.g.key(a)};function yg(){var a=null;try{a=window.localStorage||null}catch(b){}this.g=a}C(yg,xg);var zg=!H||H&&9<=Wb,Ag=!Ib&&!H||H&&H&&9<=Wb||Ib&&Ub("1.9.1"),Bg=H&&!Ub("9");function Cg(a){a=a.className;return x(a)&&a.match(/\S+/g)||[]}function Dg(a,b){for(var c=Cg(a),d=db(arguments,1),e=c.length+d.length,f=c,g=0;g<d.length;g++)Xa(f,d[g])||f.push(d[g]);a.className=c.join(" ");return c.length==e}function Eg(a,b){var c=Cg(a),d=db(arguments,1),e=Fg(c,d);a.className=e.join(" ");return e.length==c.length-d.length}function Fg(a,b){return Ra(a,function(a){return!Xa(b,a)})};function Gg(a,b){this.x=t(a)?a:0;this.y=t(b)?b:0}Gg.prototype.ga=function(){return new Gg(this.x,this.y)};Gg.prototype.toString=function(){return"("+this.x+", "+this.y+")"};function Hg(a,b){return new Gg(a.x-b.x,a.y-b.y)}Gg.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};Gg.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};function Ig(a,b){this.width=a;this.height=b}h=Ig.prototype;h.ga=function(){return new Ig(this.width,this.height)};h.toString=function(){return"("+this.width+" x "+this.height+")"};h.Pa=function(){return!(this.width*this.height)};h.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function Jg(a){return a?new Kg(Lg(a)):ra||(ra=new Kg)}function Mg(a,b){var c=b||document,d=null;c.querySelectorAll&&c.querySelector?d=c.querySelector("."+a):(c=b||document,d=(c.querySelectorAll&&c.querySelector?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):Ng(document,"*",a,b))[0]);return d||null}
function Ng(a,b,c,d){a=d||a;b=b&&"*"!=b?b.toUpperCase():"";if(a.querySelectorAll&&a.querySelector&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){d={};for(var e=0,f=0,g;g=a[f];f++)b==g.nodeName&&(d[e++]=g);d.length=e;return d}return a}a=a.getElementsByTagName(b||"*");if(c){d={};for(f=e=0;g=a[f];f++)b=g.className,"function"==typeof b.split&&Xa(b.split(/\s+/),c)&&(d[e++]=g);d.length=e;return d}return a}
function Og(a,b){ic(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in Pg?a.setAttribute(Pg[d],b):sa(d,"aria-")||sa(d,"data-")?a.setAttribute(d,b):a[d]=b})}var Pg={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};
function Qg(a){return Jb||"CSS1Compat"!=a.compatMode?a.body||a.documentElement:a.documentElement}function Rg(a){return a.parentWindow||a.defaultView}function Sg(a,b,c){function d(c){c&&b.appendChild(x(c)?a.createTextNode(c):c)}for(var e=2;e<c.length;e++){var f=c[e];!v(f)||A(f)&&0<f.nodeType?d(f):Qa(Tg(f)?ab(f):f,d)}}function Ug(a){for(var b;b=a.firstChild;)a.removeChild(b)}function Vg(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)}function Wg(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function Xg(a){if(void 0!=a.firstElementChild)a=a.firstElementChild;else for(a=a.firstChild;a&&1!=a.nodeType;)a=a.nextSibling;return a}function Yg(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Lg(a){return 9==a.nodeType?a:a.ownerDocument||a.document}
function Zg(a,b){if("textContent"in a)a.textContent=b;else if(3==a.nodeType)a.data=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else Ug(a),a.appendChild(Lg(a).createTextNode(String(b)))}var $g={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1},ah={IMG:" ",BR:"\n"};function bh(a){a=a.getAttributeNode("tabindex");return null!=a&&a.specified}function ch(a){a=a.tabIndex;return y(a)&&0<=a&&32768>a}
function dh(a){var b=[];eh(a,b,!1);return b.join("")}function eh(a,b,c){if(!(a.nodeName in $g))if(3==a.nodeType)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in ah)b.push(ah[a.nodeName]);else for(a=a.firstChild;a;)eh(a,b,c),a=a.nextSibling}function Tg(a){if(a&&"number"==typeof a.length){if(A(a))return"function"==typeof a.item||"string"==typeof a.item;if(ga(a))return"function"==typeof a.item}return!1}
function fh(a,b,c){if(!b&&!c)return null;var d=b?b.toUpperCase():null;return gh(a,function(a){var b;if(b=!d||a.nodeName==d)(b=!c)||(b=Xa(Cg(a),c));return b})}function hh(a){return fh(a,null,"sidebar")}function gh(a,b){for(var c=0;a;){if(b(a))return a;a=a.parentNode;c++}return null}function Kg(a){this.g=a||q.document||document}h=Kg.prototype;h.n=function(a){return x(a)?this.g.getElementById(a):a};
h.t=function(a,b,c){var d=this.g,e=arguments,f=e[0],g=e[1];if(!zg&&g&&(g.name||g.type)){f=["<",f];g.name&&f.push(' name="',za(g.name),'"');if(g.type){f.push(' type="',za(g.type),'"');var k={};qc(k,g);delete k.type;g=k}f.push(">");f=f.join("")}f=d.createElement(f);g&&(x(g)?f.className=g:u(g)?Dg.apply(null,[f].concat(g)):Og(f,g));2<e.length&&Sg(d,f,e);return f};h.createElement=function(a){return this.g.createElement(a)};function ih(a){return"CSS1Compat"==a.g.compatMode}
function jh(a){var b=a.g;a=Qg(b);b=Rg(b);return H&&Ub("10")&&b.pageYOffset!=a.scrollTop?new Gg(a.scrollLeft,a.scrollTop):new Gg(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}h.appendChild=function(a,b){a.appendChild(b)};h.Jh=Vg;h.getChildren=function(a){return Ag&&void 0!=a.children?a.children:Ra(a.childNodes,function(a){return 1==a.nodeType})};h.dg=Xg;h.contains=Yg;H&&Ub(8);function kh(a,b,c){vb.call(this);this.h=a;this.o=b||0;this.i=c;this.l=na(this.j,this)}C(kh,vb);kh.prototype.g=0;kh.prototype.I=function(){kh.m.I.call(this);this.stop();delete this.h;delete this.i};function lh(a){a.stop();a.g=lf(a.l,t(void 0)?void 0:a.o)}kh.prototype.stop=function(){0!=this.g&&q.clearTimeout(this.g);this.g=0};function mh(a){a.stop();a.j()}kh.prototype.j=function(){this.g=0;this.h&&this.h.call(this.i)};function nh(a,b,c){vb.call(this);this.j=a;this.i=b;this.h=c;this.g=na(this.Ph,this)}C(nh,vb);h=nh.prototype;h.ge=!1;h.ea=null;function oh(a){a.ea?a.ge=!0:ph(a)}h.stop=function(){this.ea&&(q.clearTimeout(this.ea),this.ea=null,this.ge=!1)};h.I=function(){nh.m.I.call(this);this.stop()};h.Ph=function(){this.ea=null;this.ge&&(this.ge=!1,ph(this))};function ph(a){a.ea=lf(a.g,a.i);a.j.call(a.h)};R("ydn");var qh=Math.pow(2,3),rh=Math.pow(2,6);function sh(){Mc.call(this);this.key=this.g=void 0}C(sh,Mc);sh.prototype.U=function(a,b){if("boolean"!=typeof b)throw Error("Invalid value");if("number"!=typeof a||0>a)throw Error("Invalid state");"undefined"==typeof this.g&&(this.g=0);this.g=b?this.g|a:this.g&~a};function th(a){a.U(qh,!0);lf(function(){this.dispatchEvent(uh)},0,a)}var uh="a";function vh(a,b,c){K.call(this,a,b);this.url=c}C(vh,K);R("ydn");function wh(a){return!x(a)||va(a)?{}:JSON.parse(a)}function xh(a){var b;try{b=yh(a)}catch(c){b=""}return b?b.substr(0,70)+(70<b.length?"...":""):""}function yh(a){return JSON.stringify(a,void 0,void 0)};R("ydn.Store");function zh(a,b){if(b&&!a)throw Error("Can't create document with namespace and no root tag");if(document.implementation&&document.implementation.createDocument)return document.implementation.createDocument(b||"",a||"",null);if("undefined"!=typeof ActiveXObject){var c=Ah();if(c)return a&&c.appendChild(c.createNode(1,a,b||"")),c}throw Error("Your browser does not support creating new documents");}
function Bh(a){if("undefined"!=typeof DOMParser)return(new DOMParser).parseFromString(a,"application/xml");if("undefined"!=typeof ActiveXObject){var b=Ah();b.loadXML(a);return b}throw Error("Your browser does not support loading xml documents");}function Ch(a){if("undefined"!=typeof XMLSerializer)return(new XMLSerializer).serializeToString(a);if(a=a.xml)return a;throw Error("Your browser does not support serializing XML documents");}
function Ah(){var a=new ActiveXObject("MSXML2.DOMDocument");if(a){a.resolveExternals=!1;a.validateOnParse=!1;try{a.setProperty("ProhibitDTD",!0),a.setProperty("MaxXMLSize",2048),a.setProperty("MaxElementDepth",256)}catch(b){}}return a};function Dh(a){Error.captureStackTrace?Error.captureStackTrace(this,Dh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ArgumentException"}C(Dh,Error);function Eh(a){Error.captureStackTrace?Error.captureStackTrace(this,Eh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotSupportedException"}C(Dh,Error);Eh.prototype.name="ydn.error.NotSupportedException";
function Fh(a){Error.captureStackTrace?Error.captureStackTrace(this,Fh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.NotImplementedException"}C(Fh,Error);function Gh(a){Error.captureStackTrace?Error.captureStackTrace(this,Gh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InternalError"}C(Gh,Error);Gh.prototype.name="ydn.InternalError";
function Hh(a){Error.captureStackTrace?Error.captureStackTrace(this,Hh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.ConstraintError"}C(Hh,Error);Hh.prototype.name="ydn.error.ConstraintError";function Ih(a){Error.captureStackTrace?Error.captureStackTrace(this,Ih):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationException"}C(Dh,Error);
function Jh(a){Error.captureStackTrace?Error.captureStackTrace(this,Jh):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.error.InvalidOperationError"}C(Jh,Error);var Kh,Lh,Mh,Nh;Nh=Mh=Lh=Kh=!1;var Oh=Db();Oh&&(-1!=Oh.indexOf("Firefox")?Kh=!0:-1!=Oh.indexOf("Camino")||(-1!=Oh.indexOf("iPhone")||-1!=Oh.indexOf("iPod")?Lh=!0:-1!=Oh.indexOf("iPad")?Mh=!0:-1!=Oh.indexOf("Chrome")&&(Nh=!0)));var Ph=Kh,Qh=Lh,Rh=Mh,Sh=Nh;function Th(a){if(!u(a))throw new Dh("Array required.");if(t(void 0))return a=Sa(a,function(a){return a[void 0]}),Th(a);for(var b=Number.NaN,c=-1,d=0;d<a.length;d++)!isNaN(a[d])&&(isNaN(b)||a[d]>b)&&(b=a[d],c=d);return{value:b,index:c}};function Uh(){sh.call(this);this.h=null;Ac(this,"user-login",this.ug,!1,this);Ac(this,"user-logout",this.ug,!1,this);this.p=window.top.location.href.replace(/[?#]\S+/,"")}C(Uh,sh);h=Uh.prototype;h.logger=R("ydn.api.AbstractUser");h.ug=function(){this.display?(this.display.i(this.l||""),this.isLogin()?this.j&&this.display.h(this.j):this.i&&this.display.g(this.i),Q(this.logger,"Refreshed.")):Q(this.logger,"No UI refreshed.")};
h.toJSON=function(){return{nickname:this.o,email:this.l,is_login:this.h,login_url:this.i,logout_url:this.j,user_id:this.user_id}};h.isLogin=function(){return!0===this.h};h.toString=function(){return"User:"+(!0===this.h?this.l:!1===this.h?"logout":"?")};h.fd=0;
function Vh(a,b){!b&&a.isLogin()?Q(a.logger,"Already login"):(a.Cc||(a.Cc=new nh(function(){this.isLogin()?this.Cc.stop():1<this.fd?(M(this.logger,"Cannot login to the API server, tried "+this.fd+" times."),this.Cc.stop(),this.fd=0):(this.fd++,this.ed())},5E3,a)),a.fd=0,oh(a.Cc))}h.refresh=function(a){Vh(this,a)};function Wh(a,b,c){vh.call(this,a,b,c)}C(Wh,vh);function Xh(){Uh.call(this)}C(Xh,Uh);Xh.prototype.logger=R("ydn.api.User");
Xh.prototype.load=function(a){O(this.logger,"getting user info");if(a.logout_url)return this.o=a.nickname,this.l=a.email,this.user_id=a.user_id,this.h=a.is_login,this.j=a.logout_url,this.i=a.login_url,O(this.logger,a.email+" login"),this.j=a.logout_url,this.user_id=a.Id?a.Id.$t:void 0,this.h=!0,this.i=void 0,this.U(rh,!0),th(this),!0;a.login_url&&(O(this.logger,"NO user"),this.i=a.login_url,this.h=!1,this.l=this.user_id=this.j=this.o=void 0,this.U(rh,!0),th(this));return!1};
Xh.prototype.s=function(a,b){Q(this.logger,"Receiving "+(b.Ga()?"":"fail")+" login info from server.");if(b.Ga()){var c=a.User;if(c){var d;d=this.load(c)?new Wh("user-login",this,this.j):new Wh("user-logout",this,this.i);lf(function(){this.dispatchEvent(d)},0,this)}}else M(this.logger,"Server return error with: "+b.Ma());this.Cc&&this.Cc.stop()};
function Yh(a,b){var c=new D,d=Zh($h);if(!d)return F("login server not available.");var e={pm:a.p,state:Math.random().toString().substr(2,6)};if(b)for(var f in b)e[f]=b[f];d.request(new ai("/rpc_login","GET",e)).execute(function(a,b){a?c.C(a.User):c.D(b)},a);return c}Xh.prototype.ed=function(){O(this.logger,"Sending login request.");var a=Zh($h),b=window.top.location.href.replace(/[?#]\S+/,"");a.request(new ai("/rpc_login","GET",{url:b})).execute(na(this.s,this));return!1};function bi(){this.g=B()}var ci=new bi;bi.prototype.set=function(a){this.g=a};bi.prototype.get=function(){return this.g};function di(a){this.j=a||"";this.l=ci}di.prototype.g=!0;di.prototype.h=!1;function ei(a){a=new Date(a.l);return fi(a.getFullYear()-2E3)+fi(a.getMonth()+1)+fi(a.getDate())+" "+fi(a.getHours())+":"+fi(a.getMinutes())+":"+fi(a.getSeconds())+"."+fi(Math.floor(a.getMilliseconds()/10))}function fi(a){return 10>a?"0"+a:String(a)}function gi(a,b){var c=(a.l-b)/1E3,d=c.toFixed(3),e=0;if(1>c)e=2;else for(;100>c;)e++,c*=10;for(;0<e--;)d=" "+d;return d}function hi(a){di.call(this,a)}C(hi,di);hi.prototype.h=!0;
hi.prototype.i=function(a){var b;switch(a.j.value){case Qe.value:b="dbg-sh";break;case Re.value:b="dbg-sev";break;case Se.value:b="dbg-w";break;case Te.value:b="dbg-i";break;default:b="dbg-f"}var c=[];c.push(this.j," ");this.g&&c.push("[",ei(a),"] ");c.push("[",Ga(gi(a,this.l.get())),"s] ");c.push("[",za(a.h),"] ");c.push('<span class="',b,'">',ya(Ga(za(a.getMessage()))));this.h&&a.i&&c.push("<br>",ya(Ga(a.g||"")));c.push("</span>");c.push("<br>");return c.join("")};
function ii(a){di.call(this,a)}C(ii,di);ii.prototype.i=function(a){var b=[];b.push(this.j," ");this.g&&b.push("[",ei(a),"] ");b.push("[",gi(a,this.l.get()),"s] ");b.push("[",a.h,"] ");b.push(a.getMessage());this.h&&a.i&&b.push("\n",a.g);b.push("\n");return b.join("")};function ji(){this.j=na(this.o,this);this.g=new ii;this.g.g=!1;this.h=this.g.h=!1;this.i="";this.l={}}function ki(a){var b=li;if(a!=b.h){var c=ef();a?$e(c,b.j):(c=c.g)&&Za(c,b.j);b.h=a}}ji.prototype.o=function(a){if(!this.l[a.h]){var b=this.g.i(a),c=mi;if(c)switch(a.j){case Qe:ni(c,"info",b);break;case Re:ni(c,"error",b);break;case Se:ni(c,"warn",b);break;default:ni(c,"debug",b)}else window.opera?window.opera.postError(b):this.i+=b}};var mi=window.console;
function ni(a,b,c){if(a[b])a[b](c);else a.log(c)};function oi(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d}h=oi.prototype;h.ga=function(){return new oi(this.top,this.right,this.bottom,this.left)};h.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"};h.contains=function(a){return this&&a?a instanceof oi?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom:!1};
h.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};h.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};function pi(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d}h=pi.prototype;h.ga=function(){return new pi(this.left,this.top,this.width,this.height)};h.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"};h.contains=function(a){return a instanceof pi?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};
h.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};h.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};function qi(a,b){var c=Lg(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""}function ri(a,b){return qi(a,b)||(a.currentStyle?a.currentStyle[b]:null)||a.style&&a.style[b]}
function si(a){var b;try{b=a.getBoundingClientRect()}catch(c){return{left:0,top:0,right:0,bottom:0}}H&&a.ownerDocument.body&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function ti(a){if(H&&!(H&&8<=Wb))return a.offsetParent;var b=Lg(a),c=ri(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=ri(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null}
function ui(a){for(var b=new oi(0,Infinity,Infinity,0),c=Jg(a),d=c.g.body,e=c.g.documentElement,f=Qg(c.g);a=ti(a);)if(!(H&&0==a.clientWidth||Jb&&0==a.clientHeight&&a==d||a==d||a==e||"visible"==ri(a,"overflow"))){var g=vi(a),k;k=a;if(Ib&&!Ub("1.9")){var l=parseFloat(qi(k,"borderLeftWidth"));if(wi(k))var m=k.offsetWidth-k.clientWidth-l-parseFloat(qi(k,"borderRightWidth")),l=l+m;k=new Gg(l,parseFloat(qi(k,"borderTopWidth")))}else k=new Gg(k.clientLeft,k.clientTop);g.x+=k.x;g.y+=k.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=(Rg(c.g)||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new Ig(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null}
function vi(a){var b,c=Lg(a),d=ri(a,"position"),e=Ib&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Gg(0,0),g;b=c?Lg(c):document;g=!H||H&&9<=Wb||ih(Jg(b))?b.documentElement:b.body;if(a==g)return f;if(a.getBoundingClientRect)b=si(a),a=jh(Jg(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=
b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(Jb&&"fixed"==ri(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(Hb||Jb&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=ti(b))&&b!=c.body&&b!=g;)f.x-=b.scrollLeft,Hb&&"TR"==b.tagName||(f.y-=b.scrollTop)}return f}function xi(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}
function yi(a){var b=zi;if("none"!=ri(a,"display"))return b(a);var c=a.style,d=c.display,e=c.visibility,f=c.position;c.visibility="hidden";c.position="absolute";c.display="inline";a=b(a);c.display=d;c.position=f;c.visibility=e;return a}function zi(a){var b=a.offsetWidth,c=a.offsetHeight,d=Jb&&!b&&!c;return t(b)&&!d||!a.getBoundingClientRect?new Ig(b,c):(a=si(a),new Ig(a.right-a.left,a.bottom-a.top))}function Ai(a){var b=vi(a);a=yi(a);return new pi(b.x,b.y,a.width,a.height)}
function S(a,b){a.style.display=b?"":"none"}function wi(a){return"rtl"==ri(a,"direction")}var Bi=Ib?"MozUserSelect":Jb?"WebkitUserSelect":null;function Ci(a,b,c){c=c?null:a.getElementsByTagName("*");if(Bi){if(b=b?"none":"",a.style[Bi]=b,c){a=0;for(var d;d=c[a];a++)d.style[Bi]=b}}else if(H||Hb)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;d=c[a];a++)d.setAttribute("unselectable",b)}
function Di(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,d=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var e=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=d;return e}function Ei(a,b){var c=a.currentStyle?a.currentStyle[b]:null;return c?Di(a,c):0}var Fi={thin:2,medium:4,thick:6};
function Gi(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:null))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:null;return c in Fi?Fi[c]:Di(a,c)}function Hi(a){if(H&&!(H&&9<=Wb)){var b=Gi(a,"borderLeft"),c=Gi(a,"borderRight"),d=Gi(a,"borderTop");a=Gi(a,"borderBottom");return new oi(d,c,a,b)}b=qi(a,"borderLeftWidth");c=qi(a,"borderRightWidth");d=qi(a,"borderTopWidth");a=qi(a,"borderBottomWidth");return new oi(parseFloat(d),parseFloat(c),parseFloat(a),parseFloat(b))}var Ii=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function Ji(a){this.l=na(this.o,this);this.h=new hi;this.i=this.h.g=!1;this.g=a;this.j=this.g.ownerDocument||this.g.document;a=Jg(this.g);var b=null,c=a.g;if(H&&c.createStyleSheet)a=b=c.createStyleSheet(),H&&t(a.cssText)?a.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
a.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";else{c=Ng(a.g,"head",void 0,void 0)[0];c||(b=Ng(a.g,"body",void 0,void 0)[0],c=a.t("head"),b.parentNode.insertBefore(c,b));var d=b=a.t("style");H&&t(d.cssText)?d.cssText=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}":
d.innerHTML=".dbg-sev{color:#F00}.dbg-w{color:#C40}.dbg-sh{font-weight:bold;color:#000}.dbg-i{color:#444}.dbg-f{color:#999}.dbg-ev{color:#0A0}.dbg-m{color:#990}.logmsg{border-bottom:1px solid #CCC;padding:2px}.logsep{background-color: #8C8;}.logdiv{border:1px solid #CCC;background-color:#FCFCFC;font:medium monospace}";a.appendChild(c,b)}this.g.className+=" logdiv"}
Ji.prototype.o=function(a){var b=100>=this.g.scrollHeight-this.g.scrollTop-this.g.clientHeight,c=this.j.createElement("div");c.className="logmsg";c.innerHTML=this.h.i(a);this.g.appendChild(c);b&&(this.g.scrollTop=this.g.scrollHeight)};Ji.prototype.clear=function(){this.g.innerHTML=""};var li=null,Ki=null;R("ydn.debug");function Li(a,b,c){if(y(b))b=new Pe("log",b);else if(x(b)){b=b.toUpperCase();if(!Ze){Ze={};for(var d=0,e;e=Ye[d];d++)Ze[e.value]=e,Ze[e.name]=e}b=Ze[b]||null}else b=Ve;R(a||"ydn").h=b;t(c)?Ki||(a=Ki=new Ji(c),!0!=a.i&&(c=ef(),$e(c,a.l),a.i=!0),ef().h=Se):li||Ki||(li=new ji,ki(!0),ef().h=Se)}var Mi=null;function Ni(a){Mi&&setTimeout(function(){Mi.log(a)},10)};var $h="login",Oi=R("ydn.http"),Pi={},Qi=[];var Ri,Si={},Ti=[];function Ui(a,b){Si[b||"default"]=a}function Zh(a){if(!t(a))return Si["default"];for(var b=a,c=0;c<Ti.length;c++){var d=(0,Ti[c])(a);if(d){b=d;break}}return Si[b]||null}function Vi(){Ri||(Ri=new Zf);return Ri}function Wi(a,b,c,d){x(a)?this.Gc=a:(this.Gc=null,this.status=a,this.body=b,this.headers=c||{},this.g=d)}function Xi(a){if(a.Gc){var b=wh(a.Gc);b.gapiRequest&&(b=b.gapiRequest.data);a.status=b.status;a.g=b.statusText;a.headers=b.headers;a.body=b.body;a.Gc=null}}
Wi.prototype.O=function(){Xi(this);return this.status};Wi.prototype.Ga=function(){Xi(this);return 200<=this.status&&400>this.status};Wi.prototype.Ma=function(){Xi(this);return this.g||""};function Yi(a){Xi(a);return a.body}function Zi(a){Xi(a);return a.headers["content-type"]}Wi.prototype.Vc=function(){Xi(this);return this.headers};
function aj(a){var b;Xi(a);"application/json"==Zi(a)?b=!0:(b=a.body,b=x(b)&&!va(b)?/^[\],:{}\s]*$/.test(b.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")):!1);return b&&x(a.body)?JSON.parse(a.body):a.body}function bj(a){return a instanceof Wi?a:x(a)?new Wi(a):new Wi(a.status,a.body,a.headers,a.statusText)}
function ai(a,b,c,d,e){this.path=a;this.method=b?b.toUpperCase():"GET";this.params=c||{};this.headers=d||{};this.body=e}var cj=null;function dj(a,b,c,d){this.i=t(b)?b:Vi();this.h="sr"+ej++;this.j=c||0;this.l=!!d;this.g=a}var ej=0;dj.prototype.F=function(){return this.h};
dj.prototype.execute=function(a,b){var c=this.g,d=new td(c.path),e;for(e in c.params)d.g.set(e,c.params[e]);this.i.send(this.h,d.toString(),c.method,c.body,c.headers,void 0,function(d){d=d.target;for(var e=(d.Q&&4==Mf(d)?d.Q.getAllResponseHeaders():"").split("\n"),k={},l=0;l<e.length;l++){var m=e[l].indexOf(":");0<m&&(k[e[l].substr(0,m).toLowerCase()]=e[l].substr(m+1).trim())}e=l=Nf(d);if(k["content-type"]&&/json/.test(k["content-type"]))if(A(l))e=l;else if(x(l))try{e=wh(l)}catch(n){e=l}k=new Wi(d.O(),
l,k,d.Ma());cj&&!k.Ga()&&cj.log({"class":"ydn.gdata.Entry",method:"commit",context:"HTTP request",HttpRequestData:{path:c.path,uri:String(d.s),method:c.method,params:c.params,headers:c.headers,body:c.body},HttpRespondData:{status:k.O(),statusText:k.Ma(),body:Yi(k),headers:k.Vc()}});a&&(a.call(b,e,k),a=null)},this.j,void 0,this.l);this.i=null};dj.prototype.toString=function(){return"HTTPRequest:"+this.h};function fj(a,b,c){this.h=a;this.i=b;this.g=null;this.Wh=t(c)?c:!0}fj.prototype.request=function(a){return new gj(a,this)};function gj(a,b){dj.call(this,a,b.i);this.parent=b}C(gj,dj);var hj=new Wi(0,null,null,"No access token");
gj.prototype.execute=function(a,b){function c(){this.Wh?d.g.headers.Authorization="Bearer "+d.parent.g.access_token:d.g.params.access_token=d.parent.g.access_token}var d=this;d.parent.g&&d.parent.g.expires>B()?(c(),gj.m.execute.call(this,function(e,f){401==f.O()?ij(d.parent.h).u(function(e){d.parent.g=e;c();gj.m.execute.call(d,a,b)},function(){d.parent.g=null;a.call(b,null,hj)},d):a.call(b,e,f)},this)):ij(this.parent.h).u(function(e){d.parent.g=e;c();gj.m.execute.call(this,a,b)},function(){d.parent.g=
null;a.call(b,null,hj)},this)};function T(a,b,c,d){this.lower=a;this.upper=b;this.lowerOpen=!!c;this.upperOpen=!!d;ga(Object.freeze)&&Object.freeze(this)}T.prototype.lower=void 0;T.prototype.upper=void 0;T.prototype.toJSON=function(){return jj(this)};function kj(a){return lj(a)}T.only=function(a){return new T(a,a,!1,!1)};T.bound=function(a,b,c,d){return new T(a,b,c,d)};T.upperBound=function(a,b){return new T(void 0,a,void 0,!!b)};T.lowerBound=function(a,b){return new T(a,void 0,!!b,void 0)};
function mj(a){var b;if(u(a))b=ab(a),b.push("\uffff");else if(x(a))b=a+"\uffff";else if(y(a))b=a+2.220460492503131E-16,a-=2.220460492503131E-16;else return T.only(a);return T.bound(a,b,!1,!0)}function jj(a){a=a||{};return{lower:a.lower,upper:a.upper,lowerOpen:a.lowerOpen,upperOpen:a.upperOpen}}function nj(a){if(null==a)return null;if(a instanceof T)return a;if(A(a))return new T(a.lower,a.upper,a.lowerOpen,a.upperOpen);throw new L("Invalid key range: "+a+" of type "+typeof a);}
function lj(a){return null!=a?null!=a.upper&&null!=a.lower?oj.bound(a.lower,a.upper,!!a.lowerOpen,!!a.upperOpen):null!=a.upper?oj.upperBound(a.upper,a.upperOpen):null!=a.lower?oj.lowerBound(a.lower,a.lowerOpen):null:null}function pj(a){if(a instanceof T)return"";if(null!=a){if(A(a)){for(var b in a)if(a.hasOwnProperty(b)&&!Xa(["lower","upper","lowerOpen","upperOpen"],b))return'invalid attribute "'+b+'" in key range object';return""}return"key range must be an object"}return""}
T.prototype.xe=function(a){var b=this.lower,c=this.upper,d=this.lowerOpen,e=this.upperOpen;null!=a.lower&&(null==this.lower||a.lower>=this.lower)&&(b=a.lower,d=a.lowerOpen||this.lowerOpen);null!=a.upper&&(null==this.upper||a.upper<=this.upper)&&(c=a.upper,e=a.upperOpen||this.upperOpen);return T.bound(b,c,d,e)};function qj(a){if(!a)return"";var b=a.lowerOpen?"(":"[";null!=a.lower&&(b+=a.lower+", ");null!=a.upper&&(b+=a.upper);return b+=a.upperOpen?")":"]"}
function rj(a,b,c,d,e){if(c)if(c.lowerOpen||c.upperOpen||null==c.lower||null==c.upper||0!==sj(c.lower,c.upper)){if(null!=c.lower){var f=c.lowerOpen?" > ":" >= ";d.push(a+f+"?");e.push(tj(c.lower,b))}null!=c.upper&&(f=c.upperOpen?" < ":" <= ",d.push(a+f+"?"),e.push(tj(c.upper,b)))}else d.push(a+" = ?"),e.push(tj(c.lower,b))}var oj=q.IDBKeyRange||q.webkitIDBKeyRange||T;function uj(a,b){var c,d;2==arguments.length&&x(arguments[1])?(c=!0,d=arguments[1].split(".")):d=(c=v(b))?b:arguments;for(c=c?0:1;c<d.length&&(a=a[d[c]],t(a));c++);return a}function vj(a,b,c){if(a)if(-1==b.indexOf("."))a[b]=c;else{b=b.split(".");for(var d=b.pop(),e;e=b.shift();)A(a[e])||(a[e]={}),a=a[e];a[d]=c}}var wj={};
function xj(a){a=[a];for(var b=new yj,c=0,d,e;void 0!==(e=a.pop());){0===c%4&&12<c+4&&(b.write(c),c=0);d=typeof e;if(e instanceof Array)if(c+=4,0<e.length){a.push(wj);for(d=e.length;d--;)a.push(e[d]);continue}else b.write(c);else if("number"===d)c+=1,b.write(c),zj(b,e);else if(e instanceof Date)c+=2,b.write(c),zj(b,e.valueOf());else if("string"===d){c+=3;b.write(c);c=b;for(d=0;d<e.length;d++){var f=e.charCodeAt(d);126>=f?c.write(f+1):16510>=f?(f-=127,c.write(128|f>>8,f&255)):c.write(192|f>>10,f>>
2|255,(f|3)<<6)}c.write(0)}else if(e===wj)b.write(0);else return"";c=0}return b.trim().toString()}function Aj(a){for(var b=[],c=b,d=[],e,f,g=new Bj(a);null!=g.read();)if(0===g.current)c=d.pop();else{if(null===g.current)break;do{e=g.current/4|0;a=g.current%4;for(var k=0;k<e;k++)f=[],c.push(f),d.push(c),c=f;if(0===a&&12<g.current+4)g.read();else break}while(1);1===a?c.push(Cj(g)):2===a?c.push(new Date(Cj(g))):3===a?c.push(Dj(g)):0===a&&(c=d.pop())}return b[0]}
function zj(a,b){var c,d,e;c=b;var f=e=d=0;if(0!==c)if(isFinite(c)){0>c&&(d=1,c=-c);f=0;if(2.2250738585072014E-308<=c){for(e=c;1>e;)f--,e*=2;for(;2<=e;)f++,e/=2;e=f+1023}f=e?Math.floor(4503599627370496*(c/Math.pow(2,f)-1)):Math.floor(c/4.9E-324)}else e=2047,isNaN(c)?f=0x8000000000000:-Infinity===c&&(d=1);c=d;d=e;e=f;c&&(e=0xfffffffffffff-e,d=2047-d);a.write((c?0:128)|d>>4);a.write((d&15)<<4|0|e/281474976710656);e%=281474976710656;c=0|e/4294967296;a.write(c>>8,c&255);e%=4294967296;c=0|e/65536;a.write(c>>
8,c&255);c=e%65536;a.write(c>>8,c&255)}function Cj(a){var b=a.read()|0,c=b>>7?!1:!0,d=c?-1:1,e=(b&127)<<4,b=a.read()|0,e=e+(b>>4);c&&(e=2047-e);for(var b=[c?15-(b&15):b&15],f=6;f--;)b.push(c?255-(a.read()|0):a.read()|0);a=0;for(f=7;f--;)a=a/256+b[f];a/=16;return 0===a&&0===e?0:(a+1)*Math.pow(2,e-1023)*d}
function Dj(a){for(var b=[],c=0,d=0,e=0,f,g;;){f=a.read();if(0===f||null==f)break;0===c?(g=f>>6,2>g&&!isNaN(f)?b.push(String.fromCharCode(f-1)):(c=g,d=f<<10,e++)):2===c?(b.push(String.fromCharCode(d+f+127)),c=d=e=0):2===e?(d+=f<<2,e++):(b.push(String.fromCharCode(d|f>>6)),c=d=e=0)}return b.join("")}function Bj(a){this.current=null;this.g=a;this.h=this.g.length-1;this.index=-1}
Bj.prototype.read=function(){return this.current=this.index<this.h?parseInt(this.g[++this.index]+this.g[++this.index],16):null};function yj(){this.g=[];this.h=void 0}yj.prototype.write=function(a){for(var b=0;b<arguments.length;b++)this.h=arguments[b].toString(16),this.g.push(2===this.h.length?this.h:this.h="0"+this.h)};yj.prototype.trim=function(){for(var a=this.g.length;"00"===this.g[--a];);this.g.length=++a;return this};yj.prototype.toString=function(){return this.g.length?this.g.join(""):""};
function Ej(a,b){var c=xj(a),d=xj(b);return c>d?1:c==d?0:-1};function Fj(a,b,c,d,e){if(!(b instanceof T))if(x(b)&&t(c)){var f,g,k,l;if("starts"==b||"^"==b)b=mj(c);else{if("<"==b||"<="==b)f=c,k="<"==b;else if(">"==b||">="==b)g=c,l=">"==b;else if("="==b||"=="==b)f=g=c;else throw new L("invalid op: "+b);if("<"==d||"<="==d)f=e,k="<"==d;else if(">"==d||">="==d)g=e,l=">"==d;else if(t(d))throw new L("invalid op2: "+d);b=T.bound(g,f,l,k)}}else b=nj(b);this.g=b;this.h=a}Fj.prototype.h="";Fj.prototype.Uc=function(){return this.h};
Fj.prototype.xe=function(a){if(this.h!=a.h)return null;a=null!=this.g&&null!=a.g?this.g.xe(a.g):this.g||a.g;return new Fj(this.h,a)};var Gj={READ_ONLY:"readonly",READ_WRITE:"readwrite",VERSION_CHANGE:"versionchange"},Hj=q.IDBRequest&&"LOADING"in q.IDBRequest?q.IDBTransaction:q.webkitIDBRequest&&"LOADING"in q.webkitIDBRequest&&1===q.webkitIDBTransaction.READ_WRITE?q.webkitIDBTransaction:Gj,Ij=Hj.READ_ONLY,Jj=Hj.READ_WRITE,Kj=Hj.VERSION_CHANGE,Lj=q.indexedDB||q.mozIndexedDB||q.webkitIndexedDB||q.moz_indexedDB||q.msIndexedDB;function Mj(a,b,c,d){vb.call(this);this.i=c;this.P=c.getName();this.Fb=void 0;this.j=!1;this.ba=null;this.o=a;this.pd=b;this.Xa=0;this.Ka=this.H=!1;this.oa=d||4;this.p=this.h=this.g=void 0;this.V=function(){throw new Rc;};this.Y=function(){throw new Rc;};this.Lc=function(){}}C(Mj,vb);h=Mj.prototype;
h.init=function(a,b,c,d,e){if(t(b)){a=this.i;var f,g=b;u(b)?(f=Nj(a,b),g=b.join(", ")):f=Oj(a,b);if(!f)throw new L('require index "'+g+'" not found in store "'+a.getName()+'"');this.Fb=f.getName()}this.j=x(this.Fb);this.ba=c||null;this.Xa=0;this.Ka=this.H=!1;this.reverse="prev"==d||"prevunique"==d;this.unique="nextunique"==d||"prevunique"==d;this.Lb=d;this.dd=e;this.p=this.h=this.g=void 0};h.Lb="";h.ba=null;h.unique=!1;h.reverse=!1;h.dd=!0;h.logger=R("ydn.db.core.req.AbstractCursor");
h.kc=function(a,b,c){null==a&&(P(this.logger,this+" finished."),this.H=!0);this.g=a;this.h=b;this.p=c;this.Xa++;this.H?(Q(this.logger,this+" DONE."),this.V(),Pj(this)):(Q(this.logger,this+" new cursor position {"+(this.j?this.g+", "+this.h:this.g)+"}"),this.V(this.g))};h.I=function(){this.o=null};h.toString=function(){return"Cursor:"+this.P+(t(this.Fb)?":"+this.Fb:"")+"["+(this.o?"":"~")+this.pd+"]"};
function Pj(a){null!=a.h?a.h=Qj(a.h):a.h=void 0;null!=a.g?a.g=Qj(a.g):a.g=void 0;a.Lc(a.Ka,a.g,a.h)}function Rj(a){a.Ka=!0;Q(a.logger,a+": exit");Pj(a)}h.da=function(){return this.Xa};h.ha=function(){return this.j?this.h:this.g};h.S=function(){return this.dd?this.ha():this.p};h.Ad=function(){};function Sj(){};function Tj(a,b,c,d,e,f,g){if(!x(a))throw new TypeError("store name must be a string, but "+a+" found.");this.i=a;this.h=b;this.o=g;this.p=!!this.h;if(t(d)&&!fa(d))throw new L("reverse value must be a boolean, but "+typeof d+" found");if(t(e)&&!fa(e))throw new L("unique value must be a boolean, but "+typeof e+" found");if(t(f)&&!fa(f))throw new L("key_only value must be a boolean, but "+typeof f+" found");this.g=t(f)?f:!!x(this.h);a="next";d&&e?a="prevunique":d?a="prev":e&&(a="nextunique");this.l=
a;if(d=pj(c))throw new L("Invalid key range: "+d);this.j=lj(c);this.s=Uj;this.M=NaN}C(Tj,Sj);Tj.prototype.g=!0;function Vj(a,b,c,d,e){if(!x(b))throw new L("index name must be string");Tj.call(this,a,b,c,d,e,!0)}C(Vj,Tj);function Wj(a,b,c){if(3<arguments.length)throw new L("too many argument");Tj.call(this,a,void 0,b,c,void 0,!1)}C(Wj,Tj);function Xj(a,b,c,d,e){if(!x(b))throw new L("index name must be string");Tj.call(this,a,b,c,d,e,!1)}C(Xj,Tj);var Uj="init";h=Tj.prototype;h.logger=R("ydn.db.Iterator");
h.J=function(){return this.i};h.ga=function(){var a=new Tj(this.i,this.h,this.j,Yj(this),Zj(this),this.g,this.o);a.M=this.M;return a};h.unique=function(a){return new Tj(this.i,this.h,this.j,Yj(this),a,this.g,this.o)};h.toJSON=function(){return{store:this.i,index:this.h,keyRange:this.j?jj(this.j):null,direction:this.l}};
h.toString=function(){var a=t(this.o)?":"+this.o.join(","):t(this.h)?":"+this.h:"",a=a+qj(this.j);this.s!=Uj&&(a+=this.s+"{"+this.H,this.p&&(a+=", "+this.G),a+="}");var b=this.p?"Index":"",b=b+(this.g?"Key":"Value");return b+"Iterator:"+this.i+a};h.reverse=function(){return new Tj(this.i,this.h,this.j,!Yj(this),Zj(this),this.g,this.o)};function Yj(a){return"prev"===a.l||"prevunique"===a.l}function Zj(a){return"nextunique"===a.l||"prevunique"===a.l}
h.load=function(a){a=a[0];a.init(this.i,this.o||this.h,this.j,this.l,this.g);this.s="busy";var b=this;a.Lc=function(a,d,e){b.H=d;b.G=e;b.s=a?"rest":"done"};a.openCursor(this.H,this.G);return a};h.ha=function(){return this.G};h.stores=function(){return[this.i]};function ak(a,b,c){Sc.call(this,b,c);this.s=a;this.j=[];this.p=[];this.V=[];this.g=null;this.qb="";this.H=0}C(ak,Sc);h=ak.prototype;h.qb="";h.logger=R("ydn.db.Request");function bk(a,b,c){a.g=b;a.qb=c;P(a.logger,a+" BEGIN");if(b){for(c=0;c<a.p.length;c++)a.p[c][0].call(a.p[c][1],b);a.p.length=0}P(a.logger,a+" END")}function ck(a){var b=new ak(a.s);a.H++;bk(b,a.g,a.qb+"C"+a.H);return b}h.Jd=function(){return this.s};
h.abort=function(){if(this.g)if(P(this.logger,this+" aborting"),ga(this.g.abort))this.g.abort();else if(ga(this.g.executeSql))this.g.executeSql("ABORT",[],function(){},function(){return!0});else throw new Oc;else throw new dk("No active transaction");};function U(a,b,c){var d=a.V.shift();c=!!c;d?d[0].call(d[1],b,c,function(b,c){U(a,b,c)}):c?a.D(b):a.C(b)}function ek(a,b,c){a.V.push([b,c])}function V(a,b,c){a.g?b.call(c,a.g):a.p.push([b,c])}
h.C=function(a){P(this.logger,this+" SUCCESS");ak.m.C.call(this,a);this.g=null;this.qb=this.qb};h.D=function(a){P(this.logger,this+" ERROR");ak.m.D.call(this,a);this.g=null;this.qb=this.qb};function W(a){var b="";a.qb&&(b=a.g?"*":"",b="["+a.qb+b+"]");return a.s+b}function fk(a,b){var c=new ak(a);U(c,b);return c}h.toString=function(){return"Request:"+W(this)};
h.Ge=function(){this.o&&this.wb&&sb(this)&&(q.clearTimeout(this.o),delete this.o);this.h&&(this.h.wd--,delete this.h);for(var a=this.i,b=!1;this.l.length&&!this.Nc;){var c=this.l.shift(),d=c[0],e=c[1],c=c[2];if(d=this.Qb?e:d)d=d.call(c||this.G,a),t(d)&&(this.Qb=this.Qb&&(d==a||d instanceof Error),this.i=a=d),a instanceof D&&(this.Nc=b=!0)}this.i=a;b&&(a.u(na(this.Bd,this,!0),na(this.Bd,this,!1)),a.Wf=!0)};
h.toJSON=function(){var a=(this.qb||"").match(/B(\d+)T(\d+)(?:Q(\d+?))?(?:R(\d+))?/)||[];return{method:this.s?this.s.split(":"):[],branchNo:parseFloat(a[1]),transactionNo:parseFloat(a[2]),queueNo:parseFloat(a[3]),requestNo:parseFloat(a[4])}};var sj=Lj&&Lj.cmp?na(Lj.cmp,Lj):Ej,gk=[];(function(a,b){if(null!=a&&!("push"in a))throw new Dh('output receiver object must have "push" method.');this.limit=b}).prototype.logger=R("ydn.db.algo.AbstractSolver");function hk(a){Error.captureStackTrace?Error.captureStackTrace(this,hk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ConstraintError"}C(hk,Error);hk.prototype.name="ConstraintError";hk.prototype.toString=function(){return this.name+": "+this.message};function ik(a){Error.captureStackTrace?Error.captureStackTrace(this,ik):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.InvalidKeyException"}C(ik,Error);
ik.prototype.toString=function(){return this.name+": "+this.message};function jk(a){Error.captureStackTrace?Error.captureStackTrace(this,jk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.VersionError"}C(jk,Error);jk.prototype.name="ydn.db.VersionError";jk.prototype.toString=function(){return this.name+": "+this.message};function kk(a){Error.captureStackTrace?Error.captureStackTrace(this,kk):this.stack=Error().stack||"";a&&(this.message=String(a))}C(kk,Error);
kk.prototype.name="ydn.db.InternalError";function dk(a){Error.captureStackTrace?Error.captureStackTrace(this,dk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidStateError"}C(dk,Error);function lk(a){Error.captureStackTrace?Error.captureStackTrace(this,lk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="InvalidAccessError"}C(lk,Error);
function mk(a){Error.captureStackTrace?Error.captureStackTrace(this,mk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="NotFoundError"}C(mk,Error);mk.prototype.name="NotFoundError";mk.prototype.toString=function(){return this.name+": "+this.message};function nk(a,b){Error.captureStackTrace?Error.captureStackTrace(this,nk):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message+" ["+a.code+"]";this.name="SQLError"}C(nk,Error);
nk.prototype.toString=function(){return this.name+": "+this.message};function ok(a,b){Error.captureStackTrace?Error.captureStackTrace(this,ok):this.stack=Error().stack||"";b&&(this.message=String(b));this.message+=" :"+a.message;this.name="SecurityError"}C(ok,Error);ok.prototype.toString=function(){return this.name+": "+this.message};function pk(a){Error.captureStackTrace?Error.captureStackTrace(this,pk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.SqlParseError"}
C(pk,Error);function qk(a){Error.captureStackTrace?Error.captureStackTrace(this,qk):this.stack=Error().stack||"";a&&(this.message=String(a));this.name="ydn.db.TimeoutError"}C(qk,Error);function rk(a,b,c){var d;if(A(a))d=a.store,b=a.id,null!=a.parent&&(c=new rk(a.parent));else if(t(b))d=a;else if(d=a.lastIndexOf("^|"),b=a,0<d&&(b=a.substr(d),c=new rk(a.substring(0,d))),b=b.split("^:"),d=b[0],b=b[1],!t(b))throw Error("Invalid key value: "+a);this.P=d;this.id=b;this.parent=c||null}h=rk.prototype;h.toJSON=function(){var a={store:this.P,id:this.id};this.parent&&(a.parent=this.parent.toJSON());return a};
h.valueOf=function(){return(this.parent?this.parent.valueOf()+"^|":"")+this.P+"^:"+this.id};h.toString=function(){return this.valueOf().replace("^|","|").replace("^:",":")};h.J=function(){return this.P};h.F=function(){return this.id};function sk(a){return u(a.id)?a.id.join("^|"):a.id instanceof Date?+a.id:a.id}h.getParent=function(){return this.parent};function tk(a){return y(a)||x(a)||u(a)&&Ua(a,tk)||a instanceof Date}
function Qj(a){if(v(a)){for(var b=[],c=0,d=a.length;c<d;c++)b[c]=a[c];return b}return a};function uk(a,b){this.g=b}uk.prototype.logger=R("ydn.db.crud.req.RequestExecuto");uk.prototype.toString=function(){return"RequestExecutor"};function vk(a,b,c,d,e,f){this.Ka=a;this.Xa=b;this.g=this.i=0;this.fa=d;this.Y=e;this.l=c||wk;this.M=f||0;this.s=!1;this.G=0}h=vk.prototype;h.logger=R("ydn.db.tr.Thread");h.Mh=function(a){if("complete"==a||"abort"==a)this.s?(Q(this.logger,"tx "+this.i+" committed"),this.s=!1):(Q(this.logger,"Generator done "+this.s),U(null,this.i,"complete"!=a))};
h.Oc=function(){if(t(this.H))if(this.H)Q(this.logger,"Receive to commit tx "+this.i+" on yield "+this.G),this.s=!0;else throw new Qc("Coroutine transaction thread has been ended");else throw new Qc("Transaction thread not running in a generator");};
function xk(a,b){a.s?(Q(a.logger,"waiting tx to be committed for yielding "+a.G),setTimeout(function(){a.Vb(function(){Q(a.logger,"sending result to yield "+a.G);a.H.next(b)},a.fa,a.Y,na(a.Mh,a))},4)):(Q(a.logger,"sending result to yield "+a.G),a.H.next(b));a.G++}h.request=function(a){a=new ak(a);this.H&&a.u(function(a){xk(this,a)},function(a){var c=a;a instanceof Error||(c=Error(),c.error=a);xk(this,c)},this);return a};h.type=function(){return yk(this.Ka)};h.L=function(){return this.Ka};
h.Qa=function(){return"B"+this.Xa+"T"+this.i};var wk="single";function zk(a){if(a)if(ga(a.abort))a.abort();else if(ga(a.executeSql))a.executeSql("ABORT",[],null,function(){return!0});else throw new Oc;else throw new dk("No active transaction");};function Ak(a){this.i=a;this.g=null;this.h=0}Ak.prototype.logger=R("ydn.db.tr.Mutex");Ak.prototype.jb=null;function Bk(a){return!!a.g&&!a.j}Ak.prototype.ab=null;Ak.prototype.toString=function(){return"Mutex:"+("B"+this.i+"T"+this.h)+(this.g?"*":"")};function Ck(a,b,c,d,e,f){vk.call(this,a,b,c,d,e,f);this.j=[];this.o=[];this.p=null;this.h=new Ak(b);this.V=f||0;this.oa=!1}C(Ck,vk);h=Ck.prototype;h.logger=R("ydn.db.tr.Serial");
function Dk(a,b,c){if("multi"==a.l)a:if(a=a.h,!a.jb||!a.mode||c!=a.mode&&(a.mode!=Jj||c!=Ij)||b.length>a.jb.length)b=!1;else{for(c=0;c<b.length;c++)if(-1==a.jb.indexOf(b[c])){b=!1;break a}b=!0}else if("repeat"==a.l)a:if(a=a.h,a.jb&&a.mode&&c==a.mode&&a.jb.length==b.length){for(c=0;c<b.length;c++)if(-1==a.jb.indexOf(b[c])){b=!1;break a}b=!0}else b=!1;else b="all"==a.l?!0:!1;return b}
function Ek(a){var b=0<a.j.length?a.j[0].jb:null,c=0<a.j.length?a.j[0].mode:null;return null!=b&&null!=c?Dk(a,b,c):!1}function Fk(a,b,c,d,e){Q(a.logger,"push tx queue["+a.j.length+"]");a.j.push({Gd:b,jb:c,mode:d,ab:e})}h.abort=function(){P(this.logger,this+": aborting");zk(this.p)};
h.Vb=function(a,b,c,d){var e=x(b)?[b]:b;if(v(e)){if(0==e.length)throw new L("number of store names must more than 0");for(var f=0;f<e.length;f++){if(!x(e[f]))throw new L("store name at "+f+" must be string but found "+e[f]+" of type "+typeof e[f]);if(this.Xb&&!Xa(this.Xb,e[f]))throw new L('store name "'+f+e[f]+'" in scope of '+this);}}else throw new L("store names must be an array");var g=t(c)?c:Ij,k=this;if(this.h.g||!Gk(this.L())&&this.oa)Fk(this,a,b,g,d);else{var l=this.Qa();d&&this.o.push(d);
if(this.V&&this.i>=this.V)throw new Qc("Exceed maximum number of transactions of "+this.V);this.oa=!0;Hk(this.L(),function(c){var d=k.h;d.g=c;d.j=!1;d.jb=b;d.mode=g;d.h++;d.ab=null;l=k.Qa();O(k.logger,l+" BEGIN "+yh(b)+" "+g);a(k);for(a=null;Ek(k);)c=k.j.shift(),c.ab&&k.o.push(c.ab),Q(k.logger,"pop tx queue"+(k.j.length+1)+" reusing T"+k.i),c.Gd()},e,g,function(a,b){O(k.logger,l+" "+a);var c=k.h;c.g?(c.g=null,c.jb=null,c.mode=null,ga(c.ab)&&c.ab(a,b),c.ab=null):M(c.logger,c+" has no TX to be unlocked for "+
a);for(c=0;c<k.o.length;c++)(0,k.o[c])(a,b);k.o.length=0;(c=k.j.shift())&&k.Vb(c.Gd,c.jb,c.mode,c.ab);k.g=0})}};h.Qa=function(){var a=this.h;return"B"+a.i+"T"+a.h};h.request=function(a,b,c,d){var e=Ck.m.request.call(this,a,b,c,d);a=c||Ij;var f=this;Bk(this.h)&&Dk(this,b,a)?(b=this.h.g,this.g++,bk(e,b,this.Qa()+"R"+this.g),d&&this.o.push(d)):f.Vb(function(){var a=f.h.g;f.g++;bk(e,a,f.Qa()+"R"+f.g)},b,a,d);return e};
h.qc=function(a,b,c,d,e){d=d||Ij;var f=this,g;if(Bk(f.h)&&Dk(this,c,d)){var k=f.h.g;f.g++;g=f.Qa()+"R"+f.g;P(f.logger,g+" BEGIN");b(k,g,function(b,c){f.p=k;c?(P(f.logger,g+" ERROR"),a.D(b)):(P(f.logger,g+" SUCCESS"),a.C(b));f.p=null});P(f.logger,g+" END");b=null}else f.Vb(function(){var c=f.h.g;f.g++;g=f.Qa()+"R"+f.g;P(f.logger,g+" BEGIN");b(c,g,function(b,d){f.p=c;d?(P(f.logger,g+" ERROR"),a.D(b)):(P(f.logger,g+" SUCCESS"),a.C(b));f.p=null});P(f.logger,g+" END");b=null},c,d,e)};h.getName=function(){return this.L().getName()};
h.toString=function(){return"Serial:"+this.Qa()+(this.p?"*":"")};function Ik(a,b){Ck.call(this,a,b)}C(Ik,Ck);Ik.prototype.logger=R("ydn.db.tr.AtomicSerial");Ik.prototype.request=function(a,b,c){var d,e,f,g=Ik.m.request.call(this,a,b,c,function(a,b){g.g=null;if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new qk;U(g,c,!0)}});ek(g,function(a,b,c){f=b;e=a;d=c});return g};
Ik.prototype.qc=function(a,b,c,d,e){var f,g,k=new D;k.u(function(a){g=!1;f=a},function(a){g=!0;f=a});Ik.m.qc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.D(c);else if(!0===g)a.D(f);else if(!1===g)a.C(f);else{var d=new qk;a.D(d)}e&&(e(b,c),e=void 0)})};Ik.prototype.toString=function(){return"Atomic"+Ik.m.toString.call(this)};function Jk(a,b,c,d){this.j=a;this.h=b;this.g=c;this.Va=d;this.i=null}h=Jk.prototype;h.logger=R("ydn.db.tr.DbOperator");h.abort=function(){this.g.abort()};function X(a){a.i||(a.i=a.j.G());return a.i}h.L=function(){return this.j};h.Oc=function(){this.g.Oc()};
function Kk(a,b){var c=a.L(),d=b instanceof Lk?b:Mk(b),e=b.name,f=Y(c.h,e);if(0==Nk(d,f).length)tb(!1);else if(f=f?"update":"add",c.h instanceof Ok)Pk(c.h,d),c.i?(c.i.me(),c.i=null,Qk(c)):tb(!1);else throw new Hh("Cannot "+f+" store: "+e+". Not auto schema generation mode.");}h.toString=function(){return"TxStorage:"+this.L().getName()};function Rk(a,b,c,d){Jk.call(this,a,b,c,d)}C(Rk,Jk);h=Rk.prototype;h.logger=R("ydn.db.crud.DbOperator");
h.count=function(a,b,c,d){var e,f,g,k;if(null!=a)if(u(a)){if(t(c)||t(b))throw new L("too many arguments.");f=a;for(var l=0;l<f.length;l++)if(!Sk(this.h,f[l]))throw new L('store name "'+f[l]+'" at '+l+" not found.");P(this.logger,"countStores: "+yh(f));e=this.g.request("count",f);V(e,function(){X(this).Cd(e,f)},this)}else if(x(a)){l=Y(this.h,a);if(!l)throw new L('store name "'+a+'" not found.');if(t(d)&&!fa(d))throw new L('unique value "'+d+'" must be boolean, but found '+typeof d+".");f=[a];if(x(b))if(g=
b,A(c)){var m=pj(c);if(m)throw new L("invalid key range: "+xh(c)+" "+m);k=lj(c)}else{if(null!=c)throw new L("invalid key range: "+xh(c)+" of type "+typeof c);k=null}else if(A(b)||null==b)if(A(b)){if(m=pj(b))throw new L("invalid key range: "+xh(b)+" "+m);k=lj(b)}else{if(null!=b)throw new L("key range must be  an object but found "+xh(b)+" of type "+typeof b);k=null}else throw new L('invalid second argument for count "'+xh(c)+'" of type '+typeof b);P(this.logger,"countKeyRange: "+a+" "+(g?g:"")+yh(k));
e=this.g.request("count",f);Tk(l,e,arguments);V(e,function(){X(this).Pc(e,f[0],k,g,!!d)},this)}else throw new L("Invalid store name or store names.");else M(this.logger,"count method requires store name(s)"),l=Uk(this.h),e=this.g.request("count",l),ek(e,function(a,b,c){if(b)c(a,!0);else{for(var d=b=0;d<a.length;d++)b+=a[d];c(b,!1)}},this),V(e,function(){X(this).Cd(e,f)},this);return e};
h.get=function(a,b){var c=this,d;if(a instanceof rk){var e=a,f=e.J(),g=Y(this.h,f);if(!g){if(this.h.cb()){if(Gk(this.L()))return fk("get",void 0);d=new ak("get");this.L().Sb(function(){c.get(a,b).u(function(a){d.C(a)},function(a){d.D(a)})});return d}throw new L("Store: "+f+" not found.");}var k=e.F();P(this.logger,"getByKey: "+f+":"+k);d=this.g.request("get:key",[f]);Tk(g,d,arguments,void 0,this);V(d,function(){X(this).Hd(d,f,k)},this)}else if(x(a)&&t(b)){var l=a,g=Y(this.h,l);if(!g){if(this.h.cb()){if(Gk(this.L()))return fk("get",
void 0);d=new ak("get");this.L().Sb(function(){c.get(a,b).u(function(a){d.C(a)},function(a){d.D(a)})});return d}throw new L('Store name "'+l+'" not found.');}var m=b;P(this.logger,"getById: "+l+":"+m);d=this.g.request("get",[l]);Tk(g,d,arguments,void 0,this);V(d,function(){X(this).Hd(d,l,m)},this)}else throw new L("get require valid input arguments.");return d};
h.keys=function(a,b,c,d,e,f,g){var k,l,m=null,n=!1,p=!1,r=a,s=Y(this.h,r);if(!x(r))throw new L("store name must be a string, but "+r+" of type "+typeof r+" is not.");if(!this.h.cb()){if(!s)throw new L('store name "'+r+'" not found.');if(x(b)&&!Oj(s,b))throw new L('index "'+b+'" not found in store "'+r+'".');}if(this.h.cb()&&!s)return fk("keys",[]);var w;if(x(b)){var z=b,G=pj(c);if(G)throw new L("invalid key range: "+c+" "+G);m=lj(c);if(y(d))k=d;else{if(t(d))throw new L("limit must be a number");k=
100}if(y(e))l=e;else{if(t(e))throw new L("offset must be a number");l=0}if(t(f))if(fa(f))n=f;else throw new L("reverse must be a boolean");if(t(g))if(fa(g))p=g;else throw new L("unique must be a boolean");P(this.logger,"keysByIndexKeyRange: "+r);w=this.g.request("keys:iter:index",[r]);Tk(s,w,arguments);V(w,function(){X(this).list(w,2,r,z,m,k,l,n,p)},this)}else{if(A(b)){if(G=pj(b))throw new L("invalid key range: "+xh(b)+" "+G);m=lj(b)}else{if(null!=b)throw new L("invalid key range: "+xh(b)+" of type "+
typeof b);m=null}if(y(c))k=c;else{if(t(c))throw new L("limit must be a number");k=100}if(y(d))l=d;else{if(t(d))throw new L("offset must be a number");l=0}if(t(e))if(fa(e))n=e;else throw new L("reverse must be a boolean");P(this.logger,"keysByKeyRange: "+r);w=this.g.request("keys",[r]);Tk(s,w,arguments);V(w,function(){X(this).list(w,2,r,null,m,k,l,n,!1)},this)}return w};
h.values=function(a,b,c,d,e,f,g){var k=this,l,m,n,p=!1,r=!1;if(x(a)){var s=a,w=Y(this.h,s);if(!w){if(this.h.cb()){if(Gk(this.L()))return fk("values",[]);l=new ak("values");this.L().Sb(function(){k.values(a,b,c,d,e,f).u(function(a){l.C(a)},function(a){l.D(a)})});return l}throw new mk(s);}if(u(b)){if(t(c)||t(d))throw new L("too many input arguments");var z=b;P(this.logger,"listByIds: "+s+" "+z.length+" ids");l=this.g.request("values:array",[s]);Tk(w,l,arguments,void 0,this);V(l,function(){X(this).mf(l,
s,z)},this)}else if(x(b)){var G=b;if(!Vk(w,G))throw new L('index "'+G+'" not found in store "'+s+'"');var E=pj(c);if(E)throw new L("invalid key range: "+c+" "+E);var J=lj(c);if(t(d))if(y(d))m=d;else throw new L("limit must be a number.");else m=100;if(t(e))if(y(e))n=e;else throw new L("offset must be a number.");else n=0;if(fa(f))p=f;else if(t(f))throw new L("reverse must be a boolean, but "+f);if(t(g))if(fa(g))r=g;else throw new L("unique must be a boolean");P(this.logger,"listByIndexKeyRange: "+
s+":"+G);l=this.g.request("values:iter:index",[s]);Tk(w,l,arguments);V(l,function(){X(this).list(l,4,s,G,J,m,n,p,r)},this)}else{J=null;if(A(b)){if(E=pj(b))throw new L("invalid key range: "+b+" "+E);J=lj(b)}else if(null!=b)throw new L('expect key range object, but found "'+xh(b)+'" of type '+typeof b);if(t(c))if(y(c))m=c;else throw new L("limit must be a number, but "+c+" is "+typeof c);else m=100;if(t(d))if(y(d))n=d;else throw new L("offset must be a number, but "+d+" is "+typeof d);else n=0;if(t(e))if(fa(e))p=
e;else throw new L("reverse must be a boolean, but "+e+" is "+typeof e);P(this.logger,(J?"listByKeyRange: ":"listByStore: ")+s);l=this.g.request("values",[s]);Tk(w,l,arguments);V(l,function(){X(this).list(l,4,s,null,J,m,n,p,!1)},this)}}else if(u(a))if(a[0]instanceof rk){for(var w=[],N=a,E=0;E<N.length;E++){var ja=N[E].J();if(!Sk(this.h,ja)){if(this.h.cb())return w=[],w[N.length-1]=void 0,fk("get",w);throw new L("Store: "+ja+" not found.");}Xa(w,ja)||w.push(ja)}P(this.logger,"listByKeys: "+yh(w)+" "+
N.length+" keys");l=this.g.request("values:keys",w);V(l,function(){X(this).Xd(l,N)},this)}else throw new L("first argumentmust be array of ydn.db.Key, but "+a[0]+" of "+typeof a[0]+" found.");else throw new L("first argument "+a+" is invalid.");return l};
h.list=function(a,b,c,d,e,f,g,k,l){var m=Y(this.h,b);if(!m){if(this.h.cb())return fk("get",[]);throw new mk(b);}var n;if(c&&!Vk(m,c))throw new L('index "'+c+'" not found in store "'+b+'"');if(m=pj(d))throw new L("invalid key range: "+d+" "+m);var p=lj(d),r=100;if(y(e))r=e;else if(null!=e)throw new L('limit must be a number but "'+e+'" of type '+typeof e+" found.");var s=0;if(y(f))s=f;else if(null!=f)throw new L('offset must be a number but "'+f+'" of type '+typeof f+" found.");var w=!1;if(fa(g))w=
g;else if(null!=g)throw new L('reverse must be a boolean but "'+g+'" of type '+typeof g+" found.");var z=!1;if(fa(k))z=k;else if(null!=k)throw new L('unique must be a boolean but "'+k+'" of type '+typeof k+" found.");if(s&&l&&t(l[0]))throw new L("offset must not given when initial cursor position is defined");P(this.logger,a+": "+b+":"+c);n=this.g.request("values:iter:index",[b]);V(n,function(){X(this).list(n,a,b,c||null,p,r,s,w,z,l)},this);return n};
h.add=function(a,b,c){var d=x(a)?a:A(a)?a.name:void 0;if(!x(d))throw new L("store name "+d+" must be a string, but "+typeof d);var e=Y(this.h,d);if(!e){if(!this.h.cb())throw new L('store name "'+d+'" not found.');e=Mk(A(a)?a:{name:d});P(this.logger,"Adding object store: "+d);Kk(this,e)}else if(this.h.cb()&&A(a)&&(a=Mk(a),a=Nk(e,a)))throw new Oc(a);var f;if(!e)throw new L('store name "'+d+'" not found.');if(x(e.keyPath)&&t(c))throw new L("key must not be provided while the store uses in-line key.");
if(!e.keyPath&&!e.h&&!t(c))throw new L("out-of-line key must be provided.");if(u(b)){P(this.logger,"addObjects: "+d+" "+b.length+" objects");for(a=0;a<b.length;a++)Wk(e,b[a]);f=this.g.request("add:array",[d],Jj);V(f,function(){X(this).mb(f,!1,!1,d,b,c)},this);e.$b&&f.A(function(a){a=new Xk(Yk,this.L(),e.getName(),a,b);this.L().Za(a)},this)}else if(A(b))a="store: "+d+" key: "+Zk(e,b,c),P(this.logger,"addObject: "+a),Wk(e,b),f=this.g.request("add",[d],Jj),V(f,function(){X(this).mb(f,!1,!0,d,[b],[c])},
this),e.$b&&f.A(function(a){a=new $k(Yk,this.L(),e.getName(),a,b);this.L().Za(a)},this);else throw new L("record must be an object or array list of objects, but "+b+" of type "+typeof b+" found.");return f};
function al(a,b){var c=x(b)?b:A(b)?b.name:void 0;if(!x(c))throw new L("store name must be a string");var d=Y(a.h,c);if(!d){if(!a.h.cb())throw new mk(c);d=Mk(A(b)?b:{name:c});P(a.logger,"Adding object store: "+c);Kk(a,d)}else if(a.h.cb()&&A(b)){var e=Mk(b);if(e=Nk(d,e))throw new Oc(e);}if(!d)throw new mk(c);return d}h.load=function(a,b,c){var d=c||",",e=al(this,a).getName();a=this.g.request("load",[e]);var f=this;this.g.qc(a,function(a,c,l){X(f).tf(a,c,l,e,b,d)},[e],Jj);return a};
h.search=function(a){var b=bl(a);Q(this.logger,"query "+a);var c=this.g.request("search",b,Ij);V(c,function(){var b=X(this);cl(a,function(e,f,g,k){var l=ck(c);b.list(l,4,e,f,lj(g),100,0,!1,!1);l.ca(function(b){var d=null;b instanceof Array||(d=b,b=[]);for(var e=0;e<b.length;e++){var f;f=b[e];var g=f.id,g=x(g)?Aj(g):g,k=g[3];(f=1==this.type&&k!=this.value?null:new dl(this,g[0],g[2],g[1],k,f.k,f.loc))&&a.j.push(f)}a.i--;b=0==a.i?!1:a.h[a.h.length-1].l===this.l?!0:null;!0===b?Tc(c,a):!1===b&&c.C(el(a));
if(d)throw d;},k)})},this);return c};
h.put=function(a,b,c){var d,e=this;if(a instanceof rk){var f=a,g=f.J(),k=Y(this.h,g);if(!k)throw new L('store "'+g+'" not found.');if(k.keyPath){var l=Zk(k,b);if(null!=l){if(0!=sj(l,f.F()))throw new L("Inline key must be "+f+" but "+l+" found.");}else fl(k,b,f.F());return this.put(g,b)}return this.put(g,b,f.F())}if(u(a)){if(t(c))throw new L("too many arguments");var m=a;if(!t(b))throw new L("record values required");for(var n=b,f=[],g=0,k=m.length;g<k;g++){l=m[g].J();-1==Pa(f,l)&&f.push(l);var p=
Y(this.h,l);if(!p)throw new L('store "'+l+'" not found.');p.keyPath&&fl(p,n[g],m[g].F())}P(this.logger,"putByKeys: to "+yh(f)+" "+n.length+" objects");for(g=0;g<n.length;g++)Wk(p,n[g]);d=this.g.request("put:keys",f,Jj);Tk(p,d,arguments);V(d,function(){X(e).be(d,n,m)},this)}else if(x(a)||A(a)){var p=al(this,a),r=p.getName();if(p.keyPath&&t(c))throw new L("key must not be provided while the store uses in-line key.");if(!p.keyPath&&!p.h&&!t(c))throw new L("out-of-line key must be provided.");if(u(b)){var s=
b,w=c;P(this.logger,"putObjects: "+r+" "+s.length+" objects");for(g=0;g<s.length;g++)Wk(p,s[g]);d=this.g.request("put:array",[r],Jj);Tk(p,d,arguments);V(d,function(){X(this).mb(d,!0,!1,r,s,w)},this);p.$b&&d.A(function(a){a=new Xk(gl,this.L(),r,a,s);this.L().Za(a)},this)}else if(A(b)){var z=b,G=c;P(this.logger,"putObject: "+r+" "+G);if(t(q.Blob)&&z instanceof Blob&&p.pc&&!p.keyPath&&0==p.indexes.length&&Jb)d=new ak("put"),f=new FileReader,f.onload=function(a){var b=a.target.result,c=e.g.request("put",
[r],Jj);Tk(p,c,[r,z,G]);V(c,function(){X(e).mb(c,!0,!0,r,[b],[G])},this);c.u(function(a){d.C(a)},function(a){d.D(a)})},f.onerror=function(a){d.D(a)},f.onabort=function(a){d.D(a)},f.readAsDataURL(z);else{Wk(p,z);d=this.g.request("put",[r],Jj);var E=[r,z,G];Tk(p,d,E);V(d,function(){var a=t(G)?[E[2]]:void 0;X(e).mb(d,!0,!0,r,[E[1]],a)},this)}p.$b&&d.A(function(a){a=new $k(gl,this.L(),r,a,z);this.L().Za(a)},this)}else throw new L("put record value must be Object or array of Objects");}else throw new L("the first argument of put must be store name, store schema or array of keys.");
return d};
function hl(a,b,c,d){var e=a.Va,f,g;if(x(b)){var k=Y(a.h,b);if(k){if(!k.keyPath&&!k.h&&null==d)throw new L('key required for store "'+b+'"');}else throw new mk(b);for(var l=0;l<c.length;l++)Wk(k,c[l]);f=[b]}else{g=b;f=[];for(var l=0,m=g.length;l<m;l++){var n=g[l].J(),k=Y(a.h,n);-1==Pa(f,n)&&f.push(n);if(!k)throw new mk(n);Wk(k,c[l])}}var p;x(b)?(k=Y(a.h,b),p=e.request("put:array",f,Jj),V(p,function(){X(this).mb(p,!0,!1,b,c,d)},a)):(p=e.request("put:keys",f,Jj),V(p,function(){X(this).be(p,c,g)},a));
return p}function il(a,b){for(var c=[],d=0,e=b.length;d<e;d++){var f=b[d].J();-1==Pa(c,f)&&c.push(f);if(!Sk(a.h,f))throw new mk(f);}var g=a.Va.request("rm:keys",c,Jj);V(g,function(){X(this).ee(g,b)},a);return g}function jl(a,b,c){var d=a.Va.request("rm:iter",[b],Jj);V(d,function(){X(this).hd(d,b,c||null)},a);return d}
function kl(a,b,c,d,e,f,g){f=f||100;var k,l=g||0;if(g=Y(a.h,b)){if(c&&!Vk(g,c))throw new mk('index "'+c+'" in store "'+b+'"');}else throw new mk(b);var m=lj(d);x(c)?(k=a.Va.request("values:iter:index",[b]),V(k,function(){X(this).list(k,4,b,c,m,f,l,e,!1)},a)):(k=a.Va.request("values",[b]),V(k,function(){X(this).list(k,4,b,null,m,f,l,e,!1)},a));return k}
function ll(a,b){var c=[],d=b.length;if(0==d)return fk("keys",[]);for(var e=0;e<d;e++){var f=b[e].J();-1==Pa(c,f)&&c.push(f);if(!Sk(a.h,f))throw new mk(f);}var g=a.Va.request("keys",c);V(g,function(){X(a).Xd(g,b)},a);return g}
function ml(a,b,c,d,e,f,g,k){var l;e=e||100;var m=Y(a.h,b);if(m){if(c&&!Vk(m,c))throw new mk('index "'+c+'" in store "'+b+'"');}else throw new mk(b);x(c)?(l=a.Va.request("keys:iter:index",[b]),V(l,function(){X(this).list(l,2,b,c,d,e,f,g,k)},a)):(l=a.Va.request("keys",[b]),V(l,function(){X(this).list(l,2,b,null,d,e,f,g,k)},a));return l}
h.clear=function(a,b,c){if(t(c))throw new L("too many input arguments");var d;if(x(a)){c=Y(this.h,a);if(!c)throw new L('store name "'+a+'" not found.');if(A(b)){var e=lj(b);if(null===e)throw new L("clear method requires a valid non-null KeyRange object.");P(this.logger,"clearByKeyRange: "+a+":"+yh(e));d=this.g.request("clear",[a],Jj);Tk(c,d,[a,e]);V(d,function(){X(this).ze(d,a,e)},this)}else{if(t(b))throw new L("clear method requires a valid KeyRange object as second argument, but found "+b+" of type "+
typeof b);P(this.logger,"clearByStore: "+a);d=this.g.request("clear",[a],Jj);V(d,function(){X(this).zd(d,[a])},this)}}else if(!t(a)||u(a)&&x(a[0])){var f=a||Uk(this.h);P(this.logger,"clearByStores: "+yh(f));d=this.g.request("clear",f,Jj);V(d,function(){X(this).zd(d,f)},this)}else throw new L('first argument "'+a+'" is invalid.');return d};
h.remove=function(a,b,c){var d;if(x(a)){var e=Y(this.h,a);if(!e)throw new L('store name "'+a+'" not found.');if(t(c))if(x(b)){var f=Oj(e,b);if(!f)throw new L("index: "+b+" not found in "+a);if(A(c)||null===c){var g=lj(c);P(this.logger,"removeByIndexKeyRange: "+a+":"+f.getName()+" "+a);d=this.g.request("rm:iter:index",[a],Jj);V(d,function(){X(this).uf(d,a,f.getName(),g)},this)}else throw new L("key range "+c+' is invalid type "'+typeof c+'".');}else throw new L('index name "'+b+'" must be a string, but '+
typeof b+" found.");else if(x(b)||y(b)||v(b)||b instanceof Date){P(this.logger,"removeById: "+a+":"+b);d=this.g.request("rm",[a],Jj);var k=[a,b];Tk(e,d,k);V(d,function(){X(this).de(d,a,k[1])},this);e.$b&&d.A(function(b){b=new $k(nl,this.L(),a,b,void 0);this.L().Za(b)},this)}else if(A(b))g=lj(b),P(this.logger,"removeByKeyRange: "+a+":"+yh(g)),d=this.g.request("rm:iter",[a],Jj),Tk(e,d,[a,g]),V(d,function(){X(this).hd(d,a,g)},this),e.$b&&d.A(function(b){b=new Xk(nl,this.L(),a,b,void 0);this.L().Za(b)},
this);else throw new L('Invalid key or key range "'+b+'" of type '+typeof b);}else if(a instanceof rk){var l=a.J(),e=Y(this.h,l);d=this.g.request("rm",[l],Jj);var m=[l,a.F()];Tk(e,d,m);V(d,function(){X(this).de(d,l,m[1])},this)}else if(u(a)){b=[];c=0;for(e=a.length;c<e;c++){if(!(a[c]instanceof rk))throw new L("key list element at "+c+" of "+e+' must be yn.db.Key, but "'+xh(a[c])+'" ('+ea(a[c])+") is not ydn.db.Key.");var n=a[c].J();-1==Pa(b,n)&&b.push(n)}if(1>b.length)throw new L('at least one valid key required in key list "'+
xh(a)+'"');d=this.g.request("rm:keys",b,Jj);V(d,function(){X(this).ee(d,a)},this)}else throw new L('first argument requires store name, key (ydn.db.Key) or list of keys (array) , but "'+xh(a)+'" ('+ea(a)+") found.");return d};h.toString=function(){return"DbOperator:"+this.L().getName()};function ol(a,b,c,d){Jk.call(this,a,b,c,d)}C(ol,Rk);h=ol.prototype;h.logger=R("ydn.db.core.DbOperator");h.get=function(a,b){if(a instanceof Tj){var c=a.J(),d=Y(this.h,c);if(!d)throw new L('store "'+c+'" not found.');var e=a.h;if(t(e)&&!Vk(d,e))throw new L('index "'+e+'" not found in store "'+c+'".');P(this.logger,"getByIterator:"+a);var f=this.g.request("get:iter",[c]);V(f,function(){pl(this,5,f,a,1)},this);return f}return ol.m.get.call(this,a,b)};
h.keys=function(a,b,c,d,e,f,g){if(a instanceof Tj){var k=100;if(y(b)){if(k=b,1>k)throw new L("limit must be a positive value, but "+b);}else if(t(b))throw new L("limit must be a number,  but "+b);if(t(c))throw new L("offset must not be specified");P(this.logger,"keysByIterator:"+a);var l=this.g.request("keys:iter",[a.J()]);V(l,function(){a.p?pl(this,1,l,a,k):pl(this,2,l,a,k)},this);return l}return ol.m.keys.call(this,a,b,c,d,e,f,g)};
h.count=function(a,b,c,d){if(a instanceof Tj){if(t(b)||t(c))throw new L("too many arguments.");P(this.logger,"countIterator:"+a);var e=this.g.request("count",[a.J()]);V(e,function(){pl(this,6,e,a)},this);return e}return ol.m.count.call(this,a,b,c,d)};
h.values=function(a,b,c,d,e,f){if(a instanceof Tj){var g;if(y(b)){if(g=b,1>g)throw new L("limit must be a positive value, but "+g);}else if(t(b))throw new L("limit must be a number, but "+b);if(t(c))throw new L("offset must not be specified");P(this.logger,"listByIterator:"+a);var k=this.g.request("values:iter",[a.J()]);V(k,function(){a.g?pl(this,2,k,a,g):pl(this,4,k,a,g)},this);return k}return ol.m.values.call(this,a,b,c,d,e,f)};
h.map=function(a,b){for(var c=this,d=a.stores(),e,f=0;e=d[f];f++)if(!e)throw new L('Store "'+e+'" not found.');e=this.g.request("map",d);Q(this.logger,"map:"+a);this.g.qc(e,function(d,e,f){Q(c.logger,e+" iterating "+a);for(var m=a.stores(),n=[],p=0;p<m.length;p++)n[p]=X(c).h(d,e,m[p]);var r=a.load(n);r.Y=function(a){f(a,!1)};r.V=function(c){if(null!=c){var d;a.p?a.g?d=c:d=r.ha():a.g?d=c:d=r.S();b(d);r.advance(1)}else f(void 0),b=null}},d,Ij);return e};
function pl(a,b,c,d,e){var f=[],g=c.g,k=W(c),l=k+" "+b+"ByIterator "+d;0<e&&(l+=" limit "+e);P(a.logger,l);for(var m=X(a),n=[],p=d.stores(),r=0;r<p.length;r++)n[r]=m.h(g,k,p[r]);var s=d.load(n);s.Y=function(a){Rj(s);U(c,a,!0)};var w=0,z=!1;s.V=function(d){z||(Q(a.logger,l+" starting"),z=!0);null!=d?(s.ha(),w++,1==b?f.push(d):2==b?f.push(s.ha()):3==b?f.push([d,s.ha()]):6!=b&&f.push(s.S()),5==b?(Rj(s),U(c,f[0])):6==b||!t(e)||w<e?s.Ad():(P(a.logger,"success:"+l+" yields "+f.length+" records"),Rj(s),
U(c,f))):(P(a.logger,"success:"+l+" yields "+f.length+" records"),Rj(s),U(c,5==b?f[0]:6==b?w:f))}};var Yk="created",nl="deleted",gl="updated";function ql(a,b){K.call(this,a,b)}C(ql,K);ql.prototype.J=function(){return this.P};function rl(a,b,c){K.call(this,a,b);this.version=c}C(rl,ql);rl.prototype.name="ReadyEvent";rl.prototype.version=NaN;function sl(a,b,c){K.call(this,c||"error",a);this.error=b}C(sl,ql);sl.prototype.toString=function(){return this.name+":"+(this.error?this.error:"")};sl.prototype.name="ErrorEvent";sl.prototype.error=null;function tl(a,b){sl.call(this,a,b,"fail")}C(tl,sl);
tl.prototype.name="FailEvent";function $k(a,b,c,d,e){K.call(this,a,b);this.P=c;this.key=d;this.value=e}C($k,ql);$k.prototype.name="RecordEvent";$k.prototype.S=function(){return this.value};function Xk(a,b,c,d,e){K.call(this,a,b);this.P=c;this.keys=d;this.values=e}C(Xk,ql);Xk.prototype.name="StoreEvent";Xk.prototype.Ra=function(){return this.keys};Xk.prototype.Ba=function(){return this.values};function ul(a,b,c,d,e,f){t(e)||(e=u(a)?a.join(", "):a);if(null!=a&&!x(a)&&!v(a))throw new L("index keyPath for "+e+" must be a string or array, but "+a+" is "+typeof a);u(a)&&Object.freeze&&Object.freeze(a);!t(a)&&t(e)&&(a=e);this.keyPath=a;this.o=v(this.keyPath);this.h=e;this.type=vl(b);if(t(b)){if(!t(this.type))throw new L("type invalid in index: "+this.h);if(u(this.keyPath))throw new L('composite key for store "'+this.h+'" must not specified type');}this.unique=!!c;this.multiEntry=!!d;this.p=x(this.type)?
this.type:wl;this.j=x(e)?e:u(a)?this.keyPath.join(","):a;this.i=Ka(this.j);this.g=this.o?null:this.keyPath.split(".");this.l=f||null}function xl(a,b){if(null!=b){if(v(a.keyPath)){for(var c=[],d=0,e=a.keyPath.length;d<e;d++){var f=uj(b,a.keyPath[d]);c[d]=f}return c}return uj(b,a.keyPath)}}function yl(a,b,c){for(var d=0;d<a.g.length;d++)d==a.g.length-1?b[a.g[d]]=c:A(b[a.g[d]])||(b[a.g[d]]={})}var wl="TEXT";function tj(a,b){if("DATE"==b){if(a instanceof Date)return+a}else return null!=b?a:xj(a)}
function zl(a,b){return"DATE"==b?new Date(a):t(b)?a:Aj(a)}var Al=["BLOB","DATE","INTEGER","NUMERIC",wl];function vl(a){if(x(a))return a=Pa(Al,a),Al[a]}h=ul.prototype;h.getName=function(){return this.h};h.toJSON=function(){return{name:this.h,keyPath:this.keyPath,type:this.type,unique:this.unique,multiEntry:this.multiEntry}};h.ga=function(){var a=u(this.keyPath)?ab(this.keyPath):this.keyPath;return new ul(a,this.type,this.unique,this.multiEntry,this.h,this.l)};
function Bl(a,b){return null!=a||null!=b?null!=a?null!=b?v(a)&&v(b)?fb(a,b)?null:"expect: "+a+", but: "+b:Cl(a,b)?null:"expect: "+a+", but: "+b:"keyPath: "+a+" no longer defined":"newly define "+b:null}h.hint=function(a){if(!a)return this;var b=u(this.keyPath)?ab(this.keyPath):this.keyPath,c=this.type;t(a.type)||"TEXT"!=c||(c=void 0);return new ul(b,c,this.unique,this.multiEntry,a.h)};function Dl(a,b){a.l=b}
h.toString=function(){var a=this.multiEntry?"MultiEntry":"";this.g&&1<this.g.length&&(a+="Compound");return a+"Index:"+this.h};function Lk(a,b,c,d,e,f,g,k){this.i=a;if(!x(this.i))throw new L("store name must be a string");this.keyPath=t(b)?b:null;this.s=v(this.keyPath);if(null!==this.keyPath&&!x(this.keyPath)&&!this.s)throw new L("keyPath must be a string or array");this.h=c;var l;if(null!=d){l=vl(d);if(!t(l))throw new L('type "'+d+'" for primary key in store "'+this.i+'" is invalid.');if(this.s)throw new L('composite key for store "'+this.i+'" must not specified type');}this.type=null!=l?l:this.h?"INTEGER":void 0;this.o=
x(this.keyPath)?this.keyPath.split("."):[];this.indexes=e||[];this.$b=!!f;this.pc=!!g;this.H=x(this.type)?this.type:wl;this.l=u(this.keyPath)?this.keyPath.join(","):x(this.keyPath)?this.keyPath:"_ROWID_";this.j=Ka(this.l);if(this.G=!!k){if(this.keyPath)throw new L('encrypted store "'+this.i+'" must not use inline key');if(this.h)throw new L('encrypted store "'+this.i+'" must not use key generator');}this.p=[]}h=Lk.prototype;h.$b=!1;h.pc=!1;
h.toJSON=function(){for(var a=[],b=0;b<this.indexes.length;b++)a.push(this.indexes[b].toJSON());return{name:this.i,keyPath:this.keyPath,autoIncrement:this.h,type:this.type,indexes:a}};
function Mk(a){var b="name keyPath autoIncrement type indexes dispatchEvents fixed Sync encrypted".split(" "),c;for(c in a)if(a.hasOwnProperty(c)&&-1==Pa(b,c))throw new L('Unknown attribute "'+c+'"');b=[];c=a.indexes||[];if(u(c))for(var d=0;d<c.length;d++){var e;e=c[d];var f="name unique type keyPath multiEntry generator".split(" "),g=void 0;for(g in e)if(e.hasOwnProperty(g)&&-1==Pa(f,g))throw new L("Unknown field: "+g+" in "+yh(e));e=new ul(e.keyPath,e.type,e.unique,e.multiEntry,e.name,e.generator);
t(e.keyPath)&&e.keyPath===a.keyPath||b.push(e)}return new Lk(a.name,a.keyPath,a.autoIncrement,"undefined"===a.type||"null"===a.type?void 0:a.type,b,a.dispatchEvents,a.fixed,a.encrypted)}function El(a,b,c,d,e,f,g){a=Fl(a,b,c,d,e,f,g);b="";0!=c&&(b+="SELECT "+a.select);b+=" FROM "+a.Rc;a.za&&(b+=" WHERE "+a.za);a.group&&(b+=" GROUP BY "+a.group);a.lc&&(b+=" ORDER BY "+a.lc);return b}
function Fl(a,b,c,d,e,f,g){var k={select:"",Rc:"",za:"",group:"",lc:""},l=a.l,m=a.j,n=null;d!==l&&x(d)&&(n=Oj(a,d));var p=!!n,r=d||l,s=Ka(r),w=p?n.type:a.type,z=p&&n.multiEntry;k.Rc=Gl(a);6===c?k.select="COUNT("+m+")":3===c||1===c||2===c?(k.select=m,null!=d&&d!=l&&(k.select+=", "+s)):k.select="*";d=g?"DISTINCT ":"";l=[];z?(z=Ka("ydn.db.me:"+a.getName()+":"+n.getName()),k.select=6===c?"COUNT("+d+z+"."+s+")":3===c||1===c||2===c?"DISTINCT "+Gl(a)+"."+m+", "+z+"."+s+" AS "+r:"DISTINCT "+Gl(a)+".*, "+
z+"."+s+" AS "+r,k.Rc=z+" INNER JOIN "+Gl(a)+" USING ("+m+")",null!=e&&(rj(z+"."+s,w,e,l,b),0<l.length&&(k.za=k.za?k.za+(" AND "+l.join(" AND ")):l.join(" AND ")))):null!=e&&(rj(s,w,e,l,b),0<l.length&&(k.za=k.za?k.za+(" AND "+l.join(" AND ")):l.join(" AND ")));p&&!n.unique&&g&&(k.group=s);a=f?"DESC":"ASC";k.lc=s+" "+a;p&&(k.lc+=", "+m+" "+a);return k}
function Hl(a,b,c,d,e,f,g,k,l){var m,n,p,r;null!=e?(m=e.lower,n=e.upper,p=e.lowerOpen,r=e.upperOpen,f?null!=n?(e=sj(k,n),-1==e?(n=k,r=l):0==e&&(r=l||r)):(n=k,r=l):null!=m?(e=sj(k,m),1==e?(m=k,p=l):0==e&&(p=l||p)):(m=k,p=l)):f?(n=k,r=l):(m=k,p=l);e=new T(m,n,!!p,!!r);d=d?Oj(a,d):null;b=Fl(a,c,b,d?d.j:a.l,e,f,g);b="SELECT "+b.select+" FROM "+b.Rc+(b.za?" WHERE "+b.za:"")+(b.group?" GROUP BY "+b.group:"")+" ORDER BY "+b.lc;d&&(b+=", "+a.j+(f?"DESC":"ASC"));return b}
function Il(a,b,c,d,e,f,g,k,l,m){var n=Oj(a,d),p=n.j;d=n.i;var r=a.j,s=l?" <":" >",s=g?s+" ":s+"= ";g=tj(f,n.type);k=tj(k,a.type);n="";e?(a=Fl(a,c,b,p,e,l,m),a.za+=" AND ",n=d+s+"?",c.push(g)):(e=l?T.upperBound(f,!0):T.lowerBound(f,!0),a=Fl(a,c,b,p,e,l,m),n=a.za,a.za="");a.za+="("+n+" OR ("+d+" = ? AND "+r+s+"?))";c.push(g);c.push(k);return"SELECT "+a.select+" FROM "+a.Rc+" WHERE "+a.za+(a.group?" GROUP BY "+a.group:"")+" ORDER BY "+a.lc}h.ga=function(){return Mk(this.toJSON())};
h.index=function(a){return this.indexes[a]||null};function Oj(a,b){return Va(a.indexes,function(a){return a.getName()==b})}function Nj(a,b){for(var c=0;c<a.indexes.length;c++)if(!Bl(a.indexes[c].keyPath,b))return a.indexes[c];return null}function Vk(a,b){return b===a.keyPath?!0:Ta(a.indexes,function(a){return a.getName()==b})}function Gl(a){return Ka(a.i)}
function Jl(a,b){if(!b)return a;var c=a.h,d=u(a.keyPath)?ab(a.keyPath):a.keyPath,e=a.type,f=Sa(a.indexes,function(a){return a.ga()});t(b.type)||"TEXT"!=e||(e=void 0);u(b.keyPath)&&x(d)&&d==b.keyPath.join(",")&&(d=ab(b.keyPath));for(var g=0,k=b.indexes.length;g<k;g++)if(b.indexes[g].o)for(var l=b.indexes[g].getName(),m=f.length-1;0<=m;m--)if(0<=l.indexOf(f[m].getName())){f[m]=b.indexes[g].ga();break}for(g=0;g<f.length;g++)(k=Oj(b,f[g].getName()))&&(f[g]=f[g].hint(k));return new Lk(b.i,d,c,e,f)}
h.getName=function(){return this.i};function Kl(a){return!!a.keyPath}function Zk(a,b,c){if(b){if(!a.keyPath&&null!=c)return c;if(a.s){c=[];for(var d=0;d<a.keyPath.length;d++)c.push(uj(b,a.keyPath[d]));return c}if(a.keyPath)return lc(b,a.o)}}function fl(a,b,c){for(var d=0;d<a.o.length;d++){var e=a.o[d];if(d==a.o.length-1){b[e]=c;break}t(b[e])||(b[e]={});b=b[e]}}
function Ll(a,b,c){var d=[],e=[];c=t(c)?c:Zk(a,b);t(c)&&(e.push(a.j),d.push(tj(c,a.type)));for(var f=0;f<a.indexes.length;f++){var g=a.indexes[f];if(!g.multiEntry&&g.getName()!==a.keyPath&&"_default_"!=g.getName()){var k=xl(g,b);null!=k&&(d.push(tj(k,g.type)),e.push(g.i))}}a.pc?a.pc&&!a.keyPath&&0==a.indexes.length&&(x(b)&&-1==b.indexOf(";base64,")?d.push(b):d.push(yh(b)),e.push("_default_")):(d.push(yh(b)),e.push("_default_"));a=[];for(f=d.length-1;0<=f;f--)a[f]="?";return{Zf:e,wg:a,values:d,key:c}}
function Nk(a,b){if(!b)return"missing store: "+a.i;if(a.i!=b.i)return"store name, expect: "+a.i+", but: "+b.i;var c=Bl(a.keyPath,b.keyPath);if(c)return"keyPath, "+c;if(t(a.h)&&t(b.h)&&a.h!=b.h)return"autoIncrement, expect:  "+a.h+", but: "+b.h;if(a.indexes.length!=b.indexes.length)return"indexes length, expect:  "+a.indexes.length+", but: "+b.indexes.length;if(t(a.type)&&t(b.type)&&(v(a.type)?!fb(a.type,b.type):a.type!=b.type))return"data type, expect:  "+a.type+", but: "+b.type;for(c=0;c<a.indexes.length;c++){var d=
Oj(b,a.indexes[c].getName()),e;e=a.indexes[c];if(d)if(e.h!=d.h)e="name, expect: "+e.h+", but: "+d.h;else{var f=Bl(e.keyPath,d.keyPath);e=f?"keyPath, "+f:null!=e.unique&&null!=d.unique&&e.unique!=d.unique?"unique, expect: "+e.unique+", but: "+d.unique:null!=e.multiEntry&&null!=d.multiEntry&&e.multiEntry!=d.multiEntry?"multiEntry, expect: "+e.multiEntry+", but: "+d.multiEntry:t(e.type)&&t(d.type)&&(v(e.type)?!fb(e.type,d.type):e.type!=d.type)?"data type, expect: "+e.type+", but: "+d.type:""}else e=
"no index for "+e.h;if(0<e.length)return'index "'+a.indexes[c].getName()+'" '+e}return""}function Wk(a,b){if(b)for(var c=0;c<a.indexes.length;c++){var d=a.indexes[c],e=b;if(d.l){var f=d.l(e),g=typeof f;if("string"==g||"number"==g||f instanceof Date||u(f)){for(g=0;g<d.g.length-1;g++)A(e[d.g[g]])||(e[d.g[g]]={});e[d.g[d.g.length-1]]=f}}}}function Ml(a,b){a.p.push(b)}function Tk(a,b,c,d,e){for(var f=0;f<a.p.length;f++)d!==f&&a.p[f].call(e,b,c)}
h.toString=function(){return"Store:"+this.i+"["+this.indexes.length+"index]"};function Nl(a,b,c){if(!a||va(a))throw new L("store_name must be provided for primary full text index");if(!b||va(b))throw new L("index_name must be provided for primary full text index");this.P=a;this.g=b;this.h=c||1}Nl.prototype.J=function(){return this.P};function Ol(a,b,c,d){this.name=a;this.indexes=b;this.lang=c||"";if(-1==["","en","fr"].indexOf(this.lang))throw new L('Unsupported lang "'+c+" for full text search index "+a);this.h=d||null;this.g=null}Ol.prototype.getName=function(){return this.name};Ol.prototype.count=function(){return this.indexes.length};Ol.prototype.index=function(a){return this.indexes[a]};function Pl(a,b,c){return Va(a.indexes,function(a){return a.J()==b&&a.g==c})}
function Ql(a){var b=["name","sources","lang"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Pa(b,c))throw new L("Unknown field: "+c+" in "+yh(a));if(!u(a.sources))throw new L("indexes require for full text search index "+a.name+", but "+a.sources+" of type "+typeof a.sources+" found.");b=a.sources.map(function(a){var b=["storeName","keyPath","weight"],c;for(c in a)if(a.hasOwnProperty(c)&&-1==Pa(b,c))throw new L("Unknown field: "+c+" in "+xh(a));return new Nl(a.storeName,a.keyPath,a.weight)});return new Ol(a.name,
b,a.lang)};function Rl(a,b){var c,d,e=b;if(A(a)){d=a;c=["version","stores","fullTextCatalogs"];for(var f in d)if(d.hasOwnProperty(f)&&-1==Pa(c,f))throw new L("Unknown field: "+f+" in schema.");c=d.version;var e=[],g=d.stores||[];if(!u(g))throw new L("stores must be array");for(f=0;f<g.length;f++){var k=Mk(g[f]);if(-1!=Wa(e,function(a){return a.name==k.getName()}))throw new L('duplicate store name "'+k.getName()+'".');e.push(k)}}else x(a)?c=0==a.length?void 0:parseFloat(a):y(a)&&(c=a);if(t(c)){if(!y(c)||0>c)throw new L("Invalid version: "+
c+" ("+a+")");isNaN(c)&&(c=void 0)}if(t(b)&&(!u(b)||0<b.length&&!(b[0]instanceof Lk)))throw new L("stores");this.version=c;this.Bc=!t(this.version);this.stores=e||[];c=[];if(d&&d.fullTextCatalogs)for(f=0;f<d.fullTextCatalogs.length;f++)e=Ql(d.fullTextCatalogs[f]),c[f]=e,Y(this,e.getName())||(g=[new ul("k",wl),new ul("v",wl)],e=new Lk(e.getName(),"id",!1,void 0,g),this.stores.push(e));this.g=c}h=Rl.prototype;
h.toJSON=function(){var a=Sa(this.stores,function(a){return a.toJSON()}),b={};b.stores=a;t(this.version)&&(b.version=this.version);return b};h.Bc=!1;h.cb=function(){return!1};function Uk(a){return Sa(a.stores,function(a){return a.getName()})}h.store=function(a){return this.stores[a]||null};h.count=function(){return this.stores.length};function Y(a,b){return Va(a.stores,function(a){return a.getName()==b})}function Sk(a,b){return Ta(a.stores,function(a){return a.getName()==b})}
function Sl(a,b,c,d){if(!b||a.stores.length!=b.stores.length)return"Number of store: "+a.stores.length+" vs "+b.stores.length;for(var e=0;e<a.stores.length;e++){var f=Y(b,a.stores[e].getName());if(f){c&&(f=Jl(f,a.stores[e]));if(d)for(var g=f,k=a.stores[e],l=0;l<k.indexes.length;l++){var m=k.indexes[l];Vk(g,m.getName())||"BLOB"!=m.type||(m=new ul(m.keyPath,m.type,m.unique,m.multiEntry,m.getName()),g.indexes.push(m))}f=Nk(a.stores[e],f);if(0<f.length)return'store: "'+a.stores[e].getName()+'" '+f}else return'missing object store "'+
a.stores[e].getName()+'"'}return""}function Tl(a,b){return Va(a.g,function(a){return a.getName()==b})};function Ok(a,b){Rl.call(this,a,b)}C(Ok,Rl);Ok.prototype.cb=function(){return!0};function Pk(a,b){a.stores.push(b)};function Ul(a){return wh(yh(a))}function Cl(a,b){var c;c=c||{};if(null!=a&&null!=b){if(v(a)&&v(b)){if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(-1==Va(b,function(b){return Cl(b,a[d])}))return!1;return!0}if(v(a))return 1==a.length&&Cl(a[0],b);if(v(b))return 1==b.length&&Cl(b[0],a);if(A(a)&&A(a)){for(var e in a)if(a.hasOwnProperty(e)&&!c[e]){var f=Cl(a[e],b[e]);if(!f)return!1}for(e in b)if(b.hasOwnProperty(e)&&!c[e]&&(f=Cl(a[e],b[e]),!f))return!1;return!0}return a===b}return!1}
function Vl(a){if(a)for(var b in a)if(a.hasOwnProperty(b))return a[b]};/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Wl(a,b,c){c=c||{};var d="autoSchema connectionTimeout size mechanisms policy isSerial Encryption".split(" "),e;for(e in c)if(c.hasOwnProperty(e)&&-1==Pa(d,e))throw new L('Unknown attribute "'+e+'" in options.');if(c.mechanisms){if(!u(c.mechanisms))throw new L("mechanisms attribute must be an array but "+ea(c.mechanisms)+" found.");for(e=0;e<c.mechanisms.length;e++)if(!Xa(Xl,c.mechanisms[e]))throw new L('Invalid mechanism "'+c.mechanisms[e]+'"');}this.M=c.mechanisms||Xl;this.H=c.size;this.V=
t(c.connectionTimeout)?c.connectionTimeout:3E4;this.i=null;this.j=[];this.Td=!1;var f;if(b instanceof Rl)f=b;else if(A(b))for(c.autoSchema||!t(b.stores)?f=new Ok(b):f=new Rl(b),c=b.stores?b.stores.length:0,e=0;e<c;e++)d=Y(f,b.stores[e].name),b.stores[e].Sync&&this.Tf(d,b.stores[e].Sync);else f=new Ok;this.h=f;for(e=0;e<this.h.count();e++)if(this.h.store(e).G)throw Error("encryption option must be defined");if(t(a)){if(this.i)throw new Qc("Already connected with "+this.s);this.s=a;Qk(this)}this.p=
null;this.o=new D}Wl.prototype.logger=R("ydn.db.con.Storage");function Yl(a,b,c){return(a=Y(a.h,b))?Vk(a,c):!1}function Zl(a){var b;if(t(b)){var c=function(a){b(a.toJSON());b=void 0};a.i?a.i.kb(c):Hk(a,function(b){a.i.kb(c,b)},null,Ij)}return a.h?a.h.toJSON():null}Wl.prototype.getName=function(){return this.s};var Xl="indexeddb websql localstorage sessionstorage userdata memory".split(" ");h=Wl.prototype;h.Ce=function(){return null};
function Qk(a){function b(b,e){b?(Q(a.logger,a+": ready."),a.pg=NaN,d.nd=function(b){a.Za(new sl(a,b))},d.pe=function(b){a.Za(new tl(a,b));a.i=null},d.ae=function(b){a.Za(b)},setTimeout(function(){$l(a,e);am(a)},10),c.C(e)):(M(a.logger,a+": database connection fail "+e.name),setTimeout(function(){$l(a,new tl(a,e));if(a.j){a.logger.info("Purging "+a.j.length+" transactions request.");for(var b;b=a.j.shift();)b.ab&&b.ab("error",e)}},10),c.D(e))}for(var c=new D,d=null,e=a.M,f=0;f<e.length;f++){var g=
e[f].toLowerCase();if(d=a.Ce(g)){d=a.Ce(g);break}}null===d?(e=new Hh("No storage mechanism found."),b(!1,new tl(a,e))):(a.init(),d.connect(a.s,a.h).u(function(){this.i=d;b(!0,new rl("ready",this,parseFloat(d.ne())))},function(a){M(this.logger,this+": opening fail");b(!1,a)},a))}function yk(a){if(a.i)return a.i.Kc()}h.Sb=function(a,b){this.o.ca(a,b)};function $l(a,b){setTimeout(function(){b instanceof sl?a.o.D(b.error):a.o.C();a.Za(b)},4)}function Gk(a){return!!a.i&&a.i.oe()}h.init=function(){};
function bm(a){a.i&&(a.i.me(),a.i=null,Q(a.logger,a+" closed"))}h.pg=NaN;function am(a){var b=a.j.shift();b&&(Q(a.logger,"pop tx queue["+(a.j.length+1)+"]"),Hk(a,b.Gd,b.scopes,b.mode,b.ab));a.pg=B()}function cm(a,b,c,d,e){Q(a.logger,"push tx queue["+a.j.length+"]");a.j.push({Gd:b,scopes:c,mode:d,ab:e});100<a.j.length&&0==a.j.length%100&&M(a.logger,"Transaction queue stack size is "+a.j.length+". It is too large, possibility due to incorrect usage.")}h.Td=!1;
function Hk(a,b,c,d,e){var f=c;if(x(c))f=[c];else if(null!=c)if(v(c)){if(0==c.length)throw new L("number of store names must more than 0");for(var g=0;g<c.length;g++)if(!x(c[g]))throw new L("store name at "+g+" must be string but found "+typeof c[g]);}else throw new L("store names must be an array");else f=null;if(a.i&&a.i.oe()&&!a.Td){var k=t(d)?d:Ij;k==Kj&&(a.Td=!0);a.i.Ed(function(a){b(a);b=null},f,k,function(b,c){ga(e)&&(e(b,c),e=void 0);k==Kj&&(a.Td=!1);am(a)})}else cm(a,b,f,d,e)}
h.Tf=function(a){M(this.logger,"Synchronization option for "+a.getName()+" ignored.")};h.Sf=function(a){M(this.logger,"Full text indexer option for "+a.getName()+" ignored.")};h.Za=function(){};h.toString=function(){return"Storage:"+this.i};function dm(a,b,c,d){this.j=a;this.l=b;this.g=ab(c);this.h=d;this.i=[]}dm.prototype.j=null;dm.prototype.onCompleted=function(a,b){for(var c=0;c<this.i.length;c++)this.i[c](a,b);this.i.length=0;this.i=this.g=this.j=null};function em(a,b,c){if(a.j)c&&a.i.push(c),b(a.j);else throw new Rc("tx committed on ParallelTxExecutor");}dm.prototype.toString=function(){return"ParallelTxExecutor: txNo:"+this.l+" mode:"+this.h+" scopes:"+yh(this.g)};function fm(a,b,c,d,e,f){vk.call(this,a,b,c,d,e,f);this.j=this.h=null}C(fm,vk);h=fm.prototype;h.logger=R("ydn.db.tr.Parallel");h.abort=function(){P(this.logger,this+": aborting");zk(this.j)};
h.Eg=function(a,b){var c;if("multi"==this.l)a:if(c=this.h,!c.g||!c.h||b!=c.h&&(c.h!=Jj||b!=Ij)||a.length>c.g.length)c=!1;else{for(var d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else if("repeat"==this.l)a:if(c=this.h,c.g&&c.h&&b==c.h&&c.g.length==a.length){for(d=0;d<a.length;d++)if(-1==c.g.indexOf(a[d])){c=!1;break a}c=!0}else c=!1;else c="all"==this.l?!0:!1;return c};
h.Vb=function(a,b,c,d){function e(c){l.i++;m=new dm(c,l.i,b,k);g=l.Qa();O(l.logger,g+" BEGIN "+yh(b)+" "+k);l.h=m;em(l.h,a,d)}function f(a,b){O(l.logger,g+" "+a);if(m)m.onCompleted(a,b);l.g=0}var g;this.fa&&(b=this.fa);this.Y&&(c=this.Y);var k=t(c)?c:Ij,l=this,m;if(this.h&&this.h.j&&this.Eg(b,k))em(this.h,a,d);else{if(this.M&&this.i>=this.M)throw new Qc("Exceed maximum number of transactions of "+this.M);Hk(this.L(),e,b,k,f)}};
h.request=function(a,b,c,d){var e=fm.m.request.call(this,a,b,c,d),f=this;this.Vb(function(a){f.g++;bk(e,a,f.Qa()+"R"+f.g)},b,c||Ij,d);return e};h.qc=function(a,b,c,d,e){var f=this,g;this.Vb(function(c){f.g++;g=f.Qa()+"R"+f.g;P(f.logger,g+" BEGIN");b(c,g,function(b,d){f.j=c;g=f.Qa()+"R"+f.g;d?(P(f.logger,g+" ERROR"),a.D(b)):(P(f.logger,g+" SUCCESS"),a.C(b));f.j=null});b=null;P(f.logger,g+" END")},c,d,e)};h.toString=function(){return"Parallel:"+this.l+":"+this.Qa()+(this.j?"*":"")};function gm(a,b){fm.call(this,a,b,wk)}C(gm,fm);h=gm.prototype;h.logger=R("ydn.db.tr.AtomicParallel");h.Eg=function(){return!1};h.request=function(a,b,c){var d,e,f,g=this,k=gm.m.request.call(this,a,b,c,function(a,b){k.g=null;P(g.logger,"transaction "+a);if(d)"complete"!=a&&(f=!0,e=b),d(e,f);else{var c=new qk;U(k,c,!0)}});ek(k,function(a,b,c){f=b;e=a;d=c});return k};
h.qc=function(a,b,c,d,e){var f,g,k=new D;k.u(function(a){g=!1;f=a},function(a){g=!0;f=a});gm.m.qc.call(this,k,b,c,d,function(b,c){if("complete"!=b)a.D(c);else if(!0===g)a.D(f);else if(!1===g)a.C(f);else{var d=new qk;a.D(d)}e&&(e(b,c),e=void 0)})};h.toString=function(){return"Atomic"+gm.m.toString.call(this)};function hm(a,b,c){Wl.call(this,a,b,c);this.l=0;a=!0;b=wk;c&&(t(c.isSerial)&&(a=!!c.isSerial),c.policy&&(b=c.policy));c=im(this,b,a);this.Va=im(this,"atomic",!1);this.g=this.Dc(c,this.Va)}C(hm,Wl);hm.prototype.l=0;hm.prototype.Dc=function(a,b){return new Jk(this,this.h,a,b)};
function im(a,b,c,d,e,f){if(c){if("multi"==b||"repeat"==b||"all"==b||b==wk)return new Ck(a,a.l++,b,d,e,f);if("atomic"==b)return new Ik(a,a.l++);throw new L('Invalid requestType "'+b+'"');}if("multi"==b||"repeat"==b||"all"==b||b==wk)return new fm(a,a.l++,b,d,e,f);if("atomic"==b)return new gm(a,a.l++);throw new L('Invalid requestType "'+b+'"');}
hm.prototype.Y=function(a,b,c){if(3<arguments.length)throw new L("too many input arguments, run accept not more than 3 input arguments, but "+arguments.length+" found.");this.l++;var d=b||Uk(this.h),e=Ij;if(c)if("readwrite"==c)e=Jj;else if("readonly"!=c)throw new L('Invalid transaction mode "'+c+'"');var f=im(this,"all",!1,d,e,1),g=this.Dc(f,this.Va),k=new ak("run"),l=this;f.Vb(function(b){Q(l.logger,"executing run in transaction on "+f);bk(k,b,f.Qa()+"R0");a(g)},d,e,function(a){k.g=null;U(k,f.i,
"complete"!==a)});return k};function jm(a,b,c){hm.call(this,a,b,c);a=this.h;for(b=0;b<a.g.length;b++){c=a.g[b];var d=Y(a,c.getName());if(d){if(!Vk(d,"k"))throw new L('full text index store "'+d.getName()+'" must have "keyword" index');if(!Vk(d,"v"))throw new L('full text index store "'+d.getName()+'" must have "keyword" index');if("id"!=d.keyPath)throw new L('full text index store "'+d.getName()+'" must use "id" as key path.');}else throw new L('full text index store "'+c.getName()+'" required.');for(d=0;d<c.count();d++){var e=
c.index(d),f=Y(a,e.J());if(f)this.Sf(f,c);else throw new L('full text source store "'+e.J()+'" does not exist for full text index "'+c.getName()+'"');}}}C(jm,hm);h=jm.prototype;h.init=function(){jm.m.init.call(this)};h.Dc=function(a,b){return new Rk(this,this.h,a,b)};h.add=function(a,b,c){return this.g.add(a,b,c)};h.count=function(a,b,c,d){return this.g.count(a,b,c,d)};h.get=function(a,b){return this.g.get(a,b)};h.keys=function(a,b,c,d,e,f,g){return this.g.keys(a,b,c,d,e,f,g)};
h.values=function(a,b,c,d,e,f){return this.g.values(a,b,c,d,e,f)};h.list=function(a,b,c,d,e,f,g,k,l){return this.g.list(a,b,c,d,e,f,g,k,l)};h.load=function(a,b,c){return this.g.load(a,b,c)};h.put=function(a,b,c){return this.g.put(a,b,c)};h.clear=function(a,b,c){return this.g.clear(a,b,c)};h.remove=function(a,b,c){return this.g.remove(a,b,c)};h.toString=function(){var a="Storage:"+this.getName();Gk(this)&&(a+=" ["+yk(this)+"]");return a};function lm(a,b,c){jm.call(this,a,b,c)}C(lm,jm);lm.prototype.Dc=function(a,b){return new ol(this,this.h,a,b)};lm.prototype.map=function(a,b){return this.g.map(a,b)};function mm(a,b,c,d){Mj.call(this,a,b,c,d);this.l=null}C(mm,Mj);h=mm.prototype;h.logger=R("ydn.db.core.req.IDBCursor");h.ag=function(a){(a=a.target.result)?this.kc(a.key,a.primaryKey,a.value):this.kc()};
h.openCursor=function(a,b){function c(a,b,c){p.l=n;p.l.onsuccess=na(p.ag,p);p.kc(a,p.j?b:void 0,c);n=null}var d=this+" opening ";null!=a&&(d+="{"+a,d=null!=b?d+(";"+b+"}"):d+"}");Q(this.logger,d);var e=this.ba,d=this.o.objectStore(this.P),f=x(this.Fb)?d.index(this.Fb):null;if(t(a))var g=f?!t(b):!0,k=e?e.lower:void 0,l=e?e.upper:void 0,m=e?!!e.lowerOpen:!1,e=e?!!e.upperOpen:!1,e=kj(this.reverse?new T(k,a,m,g):new T(a,l,g,e));var n;this.dd?f?n=null!=this.Lb?f.openKeyCursor(e,this.Lb):null!=e?f.openKeyCursor(e):
f.openKeyCursor():n=null!=this.Lb?d.openCursor(e,this.Lb):null!=e?d.openCursor(e):d.openCursor():f?n=null!=this.Lb?f.openCursor(e,this.Lb):null!=e?f.openCursor(e):f.openCursor():n=null!=this.Lb?d.openCursor(e,this.Lb):null!=e?d.openCursor(e):d.openCursor();var p=this;n.onerror=function(a){var b=n.error;a.preventDefault();p.Y(b);Pj(p);p.H=!0};null!=a?n.onsuccess=function(d){if(d=d.target.result){var e=Lj.cmp(d.key,a),f=p.reverse?-1:1;if(e==f)c(d.key,d.primaryKey,d.value);else if(e==-f)d["continue"](a);
else if(null!=b)if(Lj.cmp(d.primaryKey,b)==f)c(d.key,d.primaryKey,d.value);else d["continue"]();else d["continue"]()}else c()}:(p.l=n,p.l.onsuccess=na(p.ag,p))};h.Sd=function(){return!!this.l};h.update=function(a){var b=this.l.result;if(b){var c=new D;a=b.update(a);a.onsuccess=function(a){c.C(a.target.result)};a.onerror=function(a){a.preventDefault();c.D(a)};return c}throw new lk("cursor gone");};
h.clear=function(){var a=this.l.result;if(a){var b=new D,a=a["delete"]();a.onsuccess=function(){b.C(1)};a.onerror=function(a){a.preventDefault();b.D(a)};return b}throw new lk("cursor gone");};h.advance=function(a){var b=this.l.result;if(1==a)b["continue"]();else b.advance(a)};h.Ad=function(a){var b=this.l.result;if(null!=a)b["continue"](a);else b["continue"]()};h.I=function(){mm.m.I.call(this);this.l=null};h.toString=function(){return"IDB"+mm.m.toString.call(this)};function nm(a,b,c,d,e,f){D.call(this,e,f);this.j=a;this.g=[];this.p=!!b;this.Y=!!c;this.V=!!d;for(b=this.H=0;b<a.length;b++)a[b].u(na(this.s,this,b,!0),na(this.s,this,b,!1));0!=a.length||this.p||this.C(this.g)}C(nm,D);nm.prototype.s=function(a,b,c){this.H++;this.g[a]=[b,c];this.wb||(this.p&&b?this.C([a,c]):this.Y&&!b?this.D(c):this.H==this.j.length&&this.C(this.g));this.V&&!b&&(c=null);return c};nm.prototype.D=function(a){nm.m.D.call(this,a);for(a=0;a<this.j.length;a++)lb(this.j[a])};
function om(a){return(new nm(a,!1,!0)).A(function(a){for(var c=[],d=0;d<a.length;d++)c[d]=a[d][1];return c})};function pm(a,b){this.g=b}C(pm,uk);h=pm.prototype;h.logger=R("ydn.db.crud.req.IndexedDb");h.Cd=function(a,b){function c(e){var f=a.g.objectStore(b[e]).count();f.onsuccess=function(f){d[e]=f.target.result;e++;e==b.length?U(a,d):c(e)};f.onerror=function(b){b.preventDefault();U(a,f.error,!0)}}var d=[];0==b.length?U(a,[]):c(0)};
h.mb=function(a,b,c,d,e,f){function g(s){if(null==e[s])if(Q(n.logger,"empty object at "+s+" of "+e.length),l++,l==e.length)U(a,k,m);else{var z=s+10;z<e.length&&g(z)}var G,z=e[s];G=null!=f?b?r.put(z,f[s]):r.add(z,f[s]):b?r.put(z):r.add(z);G.onsuccess=function(b){l++;k[s]=b.target.result;l==e.length?U(a,c?k[0]:k,m):(b=s+10,b<e.length&&g(b))};G.onerror=function(b){l++;var f=G.error;Q(n.logger,W(a)+p+' request to "'+d+'" cause '+f.name+' for object "'+xh(e[s])+'" at index '+s+" of "+e.length+" objects.");
k[s]=f;m=!0;b.preventDefault();l==e.length?U(a,c?k[0]:k,m):(b=s+10,b<e.length&&g(b))}}var k=[],l=0,m=!1,n=this,p=b?"put":"add",r=a.g.objectStore(d);Q(this.logger,W(a)+" "+p+" "+e.length+' objects to store "'+d+'"');if(0<e.length)for(var s=0;10>s&&s<e.length;s++)g(s);else U(a,[])};
h.be=function(a,b,c){function d(l){var n=c[l],p=n.J(),r=a.g.objectStore(p),s;s=null===r.keyPath?r.put(b[l],n.F()):r.put(b[l]);s.onsuccess=function(c){f++;e[l]=c.target.result;f==b.length?U(a,e,g):(c=l+10,c<b.length&&d(c))};s.onerror=function(c){f++;M(k.logger,"request result "+c.name+' error when put keys to "'+p+'" for object "'+xh(b[l])+'" at index '+l+" of "+b.length+" objects.");e[l]=s.error;g=!0;c.preventDefault();f==b.length?U(a,e,g):(c=l+10,c<b.length&&d(c))}}var e=[],f=0,g=!1,k=this;Q(this.logger,
W(a)+" putByKeys: of "+b.length+" objects");if(0<b.length)for(var l=0;10>l&&l<b.length;l++)d(l);else U(a,e,g)};
h.tf=function(a,b,c,d,e,f){function g(){var a={},b=e.indexOf("\n",n),d=!1,s;-1==b?(d=!0,s=e.substring(n)):(s=e.substring(n,b),n=b+1);for(var b=s.split(f),J=0;J<p.length;J++){var N=b[J];r[J]&&(r[J]==wl?N=Ha(N,'"'):"INTEGER"==r[J]?N=parseInt(N,10):"NUMERIC"==r[J]&&(N=parseFloat(N)));a[p[J]]=N}var ja=l.put(a);ja.onsuccess=function(a){m.push(a.target.result);d?c(m):g()};ja.onerror=function(a){"DataError"==a.name&&(a=new ik(k+": "+s.substring(0,70)));a.preventDefault();c(ja.error,!0)}}var k=Y(this.g,d),
l=a.objectStore(d),m=[],n=e.indexOf("\n"),p=e.substr(0,n).split(f),r=[];for(a=0;a<p.length;a++){var s=Oj(k,p[a]);s?r[a]=s.type:p[a]==k.keyPath&&(r[a]=k.type)}n++;Q(this.logger,b+" Loading data  of "+p.length+"-fields record to "+d);g()};
h.de=function(a,b,c){var d=a.g.objectStore(b);Q(this.logger,W(a)+" clearById: "+b+" "+c);var e=d.openCursor(oj.only(c));e.onsuccess=function(b){if(b=b.target.result){var c=b["delete"]();c.onsuccess=function(){U(a,1)};c.onerror=function(){U(a,c.error,!0)}}else U(a,0)};e.onerror=function(b){b.preventDefault();U(a,e.error,!0)}};
h.ee=function(a,b){function c(k){k++;if(k>=b.length)0<g.length?U(a,g,!0):U(a,d);else{b[k].J()!=e&&(e=b[k].J(),f=a.g.objectStore(e));var l=f["delete"](b[k].F());l.onsuccess=function(){d++;c(k)};l.onerror=function(a){a.preventDefault();g[k]=l.error;c(k)}}}var d=0,e,f;Q(this.logger,W(a)+" removeByKeys: "+b.length+" keys");var g=[];c(-1)};
h.hd=function(a,b,c){var d=a.g.objectStore(b),e=d.count(c);Q(this.logger,W(a)+" clearByKeyRange: "+b+" "+c);e.onsuccess=function(b){var e=b.target.result,k=d["delete"](c);k.onsuccess=function(){U(a,e)};k.onerror=function(){U(a,k.error,!0)}};e.onerror=function(b){b.preventDefault();U(a,e.error,!0)}};h.ze=function(a,b,c){var d=a.g.objectStore(b);Q(this.logger,W(a)+" "+b+" "+c);var e=d["delete"](c);e.onsuccess=function(){U(a,void 0)};e.onerror=function(b){b.preventDefault();U(a,e.error,!0)}};
h.uf=function(a,b,c,d){var e=a.g.objectStore(b).index(c);Q(this.logger,W(a)+" clearByIndexKeyRange: "+b+":"+c+" "+d);var f=[],g=e.openCursor(d),k=0;g.onsuccess=function(b){var c=b.target.result;if(c){var d=c["delete"]();d.onsuccess=function(){k++;c["continue"]()};d.onerror=function(a){f.push(d.error);a.preventDefault();c["continue"]()}}else 0<f.length?U(a,f,!0):U(a,k)};g.onerror=function(b){b.preventDefault();U(a,g.error,!0)}};
h.zd=function(a,b){var c=b.length,d=0;Q(this.logger,W(a)+" clearByStores: "+b);for(var e=0;e<c;e++){var f=a.g.objectStore(b[e]).clear();f.onsuccess=function(){d++;d==c&&U(a,d)};f.onerror=function(b){d++;b.preventDefault();d==c&&U(a,f.error,!0)}}};
h.Hd=function(a,b,c){var d=this;Q(this.logger,W(a)+b+":"+c);var e=a.g.objectStore(b),f=e.get(c);f.onsuccess=function(b){Q(d.logger,W(a)+" record "+c+(null!=b.target.result?" ":" not ")+" exists.");var f=b.target.result;if(!e.keyPath&&0==e.indexNames.length&&Jb&&x(f)&&0<=f.indexOf(";base64,")){'"'==f.charAt(0)&&'"'==f.charAt(f.length-1)&&(f=f.substr(1,f.length-2));f=f.split(";base64,");b=f[0].split(":")[1];for(var f=window.atob(f[1]),l=f.length,m=new Uint8Array(l),n=0;n<l;++n)m[n]=f.charCodeAt(n);
U(a,new Blob([m.buffer],{type:b}))}else U(a,b.target.result)};f.onerror=function(b){b.preventDefault();U(a,f.error,!0)}};
h.mf=function(a,b,c){function d(b){if(null==c[b])if(f++,e[b]=void 0,f==k)U(a,e);else{var m=b+10;m<k&&d(m)}var n;n=g.get(c[b]);n.onsuccess=function(c){f++;e[b]=c.target.result;f==k?U(a,e):(c=b+10,c<k&&d(c))};n.onerror=function(b){f++;b.preventDefault();U(a,n.error,!0)}}var e=[];e.length=c.length;var f=0,g=a.g.objectStore(b),k=c.length;Q(this.logger,W(a)+" "+b+":"+k+" ids");if(0<k)for(b=0;10>b&&b<k;b++)d(b);else U(a,[])};
h.Xd=function(a,b){function c(f){var k=b[f],l=a.g.objectStore(k.J()).get(k.F());l.onsuccess=function(k){e++;d[f]=k.target.result;e==b.length?U(a,d):(k=f+10,k<b.length&&c(k))};l.onerror=function(b){e++;b.preventDefault();U(a,l.error,!0)}}var d=[];d.length=b.length;var e=0;Q(this.logger,W(a)+" "+b.length+" ids");if(0<b.length)for(var f=0;10>f&&f<b.length;f++)c(f);else U(a,[])};
h.Pc=function(a,b,c,d,e){if(d&&e)throw new Qc("unique count not available in IndexedDB");e=a.g.objectStore(b);b=W(a)+" "+b+(d?":"+d:"")+(c?":"+yh(c):"");Q(this.logger,b);var f;null!=d?(d=e.index(d),f=null!=c?d.count(c):d.count()):f=null!=c?e.count(c):e.count();f.onsuccess=function(b){U(a,b.target.result)};f.onerror=function(b){b.preventDefault();U(a,f.error,!0)}};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=[],p=a.g.objectStore(c),r=k?l?"prevunique":"prev":l?"nextunique":"next";c=W(a)+" "+b+" "+c+(d?":"+d:"")+(e?yh(e):"");k&&(c+=" reverse");l&&(c+=" unique");if(m&&t(m[0])){l=d?!t(m[1]):!0;var s=m[0],w=e?e.lower:void 0,z=e?e.upper:void 0,G=e?!!e.lowerOpen:!1;e=e?!!e.upperOpen:!1;e=kj(k?new T(w,s,G,l):new T(s,z,l,e));c+=" starting from "+yh(m[0]);t(m[1])&&(c+=", "+yh(m[1]))}Q(this.logger,c);var E;E=1==b||2==b||3==b?d?p.index(d).openKeyCursor(e,r):p.openCursor(e,
r):d?p.index(d).openCursor(e,r):p.openCursor(e,r);var J=!1;E.onsuccess=function(c){if(c=c.target.result){if(!J){if(0<g){J=!0;c.advance(g);return}if(m&&d&&t(m[0]))if(t(m[1])){var e=Lj.cmp(c.key,m[0]),l=k?-1:1;if(0==e){e=Lj.cmp(c.primaryKey,m[1]);if(0==e){J=!0;c["continue"]();return}if(e==l)J=!0;else{c["continue"]();return}}else J=!0}else J=!0;else J=!0}1==b?n.push(c.key):2==b?n.push(c.primaryKey):3==b?(l={},d&&(l[d]=c.key),p.keyPath?l[p.keyPath]=c.primaryKey:l._ROWID_=c.primaryKey,n.push(l)):4==b?
n.push(c.value):n.push([c.key,c.primaryKey,c.value]);if(n.length<f)c["continue"]();else m&&(m[0]=Qj(c.key),m[1]=Qj(c.primaryKey)),U(a,n)}else m&&(m[0]=void 0,m[1]=void 0),U(a,n)};E.onerror=function(b){b.preventDefault();U(a,E.error,!0)}};function qm(a,b){this.g=b}C(qm,pm);qm.prototype.logger=R("ydn.db.core.req.IndexedDb");qm.prototype.h=function(a,b,c,d){c=Y(this.g,c);return new mm(a,b,c,d)};function rm(){this.g=!1}rm.prototype.g=!1;function sm(a,b,c,d){Mj.call(this,a,b,c,d);this.p=this.h=this.g=void 0;this.s=this.l=null;this.M=new rm;this.he=this.Yb=null}C(sm,Mj);h=sm.prototype;h.logger=R("ydn.db.core.req.SimpleCursor");h.Sd=function(){return!!this.o};h.update=function(a){tm(this.he,this.ha(),a);return tb()};h.advance=function(a){function b(b){d++;if(!b||d>=a)return um(c,b)}var c=this,d=this.l?-1:0;this.reverse?vm(this.Yb,b,this.l):wm(this.Yb,b,this.l)};
h.Ad=function(a){if(null!=a){var b=this,c=new xm(a),d=function(c){b.l=c;if(!c)return um(b,c);var d=sj(c.value.key,a);if(b.reverse){if(1!=d)return um(b,c)}else if(-1!=d)return um(b,c)};this.reverse?vm(this.Yb,d,c):wm(this.Yb,d,c)}else this.advance(1)};function ym(a){setTimeout(function(){a.M.g?(a.M.g=!1,a.kc(a.g,a.h,a.p),ym(a)):(a.s(),a.s=null)},4)}
function um(a,b){if(a.l=b){var c=b.value;if(a.ba)if(a.reverse||null==a.ba.upper)a.reverse&&null!=a.ba.lower&&(d=sj(c.key,a.ba.lower),-1==d||0==d&&a.ba.lowerOpen)&&(a.l=null);else{var d=sj(c.key,a.ba.upper);if(1==d||0==d&&a.ba.upperOpen)a.l=null}if(a.l){if(a.unique&&null!=a.g&&null!=c.key&&0==sj(a.g,c.key))return;a.g=c.key;a.h=a.j?c.ha():a.g;4==a.oa&&(a.dd?a.p=a.h:a.p=a.he.wa(null,a.h))}}a.l||(a.g=void 0,a.h=void 0,a.p=void 0);return a.M.g=!0}
h.openCursor=function(a,b){var c=null;if(this.ba)if(this.reverse){var d=this.j?"\uffff":void 0;null!=this.ba.upper&&(c=new xm(this.ba.upper,d))}else null!=this.ba.lower&&(c=new xm(this.ba.lower));null!=a&&(c=this.j?new xm(a,b):new xm(a));this.s=this.o.L(function(b){function d(b){var e=b.value,f=e.key;if(b&&null!=f)if(null!=a){if(0==zm(c,e))return}else if(this.ba&&(!this.reverse&&this.ba.lowerOpen&&null!=this.ba.lower&&(e=sj(f,this.ba.lower),0==e)||this.reverse&&this.ba.upperOpen&&null!=this.ba.upper&&
(e=sj(f,this.ba.upper),0==e)))return;return um(this,b)}this.he=Am(b,this.P);this.Yb=Bm(this.he,this.Fb);this.reverse?vm(this.Yb,na(d,this),c):wm(this.Yb,na(d,this),c);ym(this)},this)};h.clear=function(){throw new Pc;};h.toString=function(){return"Simple"+sm.m.toString.call(this)};function Cm(a,b,c){a=["ydn.db",a];t(b)&&(a.push(b),t(c)&&(a.push(c),t(void 0)&&a.push(xj(void 0))));return a.join("^|")};function xm(a,b){this.key=a;this.g=b}xm.prototype.ha=function(){return this.g};xm.prototype.toString=function(){return"ydn.db.con.simple.Node("+this.key+(null!=this.g?", "+this.g+")":")")};function zm(a,b){var c=sj(a.key,b.key);return 0===c?null!=a.g?null!=b.g?sj(a.g,b.g):1:null!=b.g?-1:0:c};function Dm(a){this.Ya=a||Em}function Em(a,b){return String(a)<String(b)?-1:String(a)>String(b)?1:0}h=Dm.prototype;h.Ca=null;h.Ya=null;h.Ib=null;h.Gb=null;
h.add=function(a){if(null==this.Ca)return this.Gb=this.Ib=this.Ca=new Fm(a),!0;var b=null;Gm(this,function(c){var d=null;0<this.Ya(c.value,a)?(d=c.left,null==c.left&&(b=new Fm(a,c),c.left=b,c==this.Ib&&(this.Ib=b))):0>this.Ya(c.value,a)&&(d=c.right,null==c.right&&(b=new Fm(a,c),c.right=b,c==this.Gb&&(this.Gb=b)));return d});b&&(Gm(this,function(a){a.count++;return a.parent},b.parent),Hm(this,b.parent));return!!b};
h.remove=function(a){var b=null;Gm(this,function(c){var d=null;0<this.Ya(c.value,a)?d=c.left:0>this.Ya(c.value,a)?d=c.right:(b=c.value,Im(this,c));return d});return b};h.clear=function(){this.Gb=this.Ib=this.Ca=null};h.contains=function(a){var b=!1;Gm(this,function(c){var d=null;0<this.Ya(c.value,a)?d=c.left:0>this.Ya(c.value,a)?d=c.right:b=!0;return d});return b};h.da=function(){return this.Ca?this.Ca.count:0};h.Ba=function(){var a=[];Jm(this,function(b){a.push(b)});return a};
function Jm(a,b){if(a.Ca){var c,d=c=Km(a);for(c=c.left?c.left:c;null!=d;)if(null!=d.left&&d.left!=c&&d.right!=c)d=d.left;else{if(d.right!=c&&b(d.value))break;var e=d,d=null!=d.right&&d.right!=c?d.right:d.parent;c=e}}}function Gm(a,b,c){for(c=c?c:a.Ca;c&&null!=c;)c=b.call(a,c)}
function Hm(a,b){Gm(a,function(a){var b=a.left?a.left.height:0,e=a.right?a.right.height:0;1<b-e?(a.left.right&&(!a.left.left||a.left.left.height<a.left.right.height)&&Lm(this,a.left),Mm(this,a)):1<e-b&&(a.right.left&&(!a.right.right||a.right.right.height<a.right.left.height)&&Mm(this,a.right),Lm(this,a));b=a.left?a.left.height:0;e=a.right?a.right.height:0;a.height=Math.max(b,e)+1;return a.parent},b)}
function Lm(a,b){Nm(b)?(b.parent.left=b.right,b.right.parent=b.parent):Om(b)?(b.parent.right=b.right,b.right.parent=b.parent):(a.Ca=b.right,a.Ca.parent=null);var c=b.right;b.right=b.right.left;null!=b.right&&(b.right.parent=b);c.left=b;b.parent=c;c.count=b.count;b.count-=(c.right?c.right.count:0)+1}
function Mm(a,b){Nm(b)?(b.parent.left=b.left,b.left.parent=b.parent):Om(b)?(b.parent.right=b.left,b.left.parent=b.parent):(a.Ca=b.left,a.Ca.parent=null);var c=b.left;b.left=b.left.right;null!=b.left&&(b.left.parent=b);c.right=b;b.parent=c;c.count=b.count;b.count-=(c.left?c.left.count:0)+1}
function Im(a,b){if(null!=b.left||null!=b.right){var c=null,d;if(null!=b.left){d=Pm(a,b.left);Gm(a,function(a){a.count--;return a.parent},d);if(d!=b.left){if(d.parent.right=d.left)d.left.parent=d.parent;d.left=b.left;d.left.parent=d;c=d.parent}d.parent=b.parent;d.right=b.right;d.right&&(d.right.parent=d);b==a.Gb&&(a.Gb=d)}else{d=Km(a,b.right);Gm(a,function(a){a.count--;return a.parent},d);if(d!=b.right){if(d.parent.left=d.right)d.right.parent=d.parent;d.right=b.right;d.right.parent=d;c=d.parent}d.parent=
b.parent;d.left=b.left;d.left&&(d.left.parent=d);b==a.Ib&&(a.Ib=d)}d.count=b.count;Nm(b)?b.parent.left=d:Om(b)?b.parent.right=d:a.Ca=d;Hm(a,c?c:d)}else Gm(a,function(a){a.count--;return a.parent},b.parent),Nm(b)?(b.parent.left=null,b==a.Ib&&(a.Ib=b.parent),Hm(a,b.parent)):Om(b)?(b.parent.right=null,b==a.Gb&&(a.Gb=b.parent),Hm(a,b.parent)):a.clear()}function Km(a,b){if(!b)return a.Ib;var c=b;Gm(a,function(a){var b=null;a.left&&(b=c=a.left);return b},b);return c}
function Pm(a,b){if(!b)return a.Gb;var c=b;Gm(a,function(a){var b=null;a.right&&(b=c=a.right);return b},b);return c}function Fm(a,b){this.value=a;this.parent=b?b:null;this.count=1}Fm.prototype.left=null;Fm.prototype.right=null;Fm.prototype.height=1;function Om(a){return!!a.parent&&a.parent.right==a}function Nm(a){return!!a.parent&&a.parent.left==a};function Qm(a){this.Ya=a||Em}C(Qm,Dm);function wm(a,b,c){if(a.Ca){var d;if(c instanceof Fm)d=c;else if(c){if(Gm(a,function(a){var b=null;0<this.Ya(a.value,c)?(b=a.left,d=a):0>this.Ya(a.value,c)?b=a.right:d=a;return b}),!d)return}else d=Km(a);a=d;for(var e=d.left?d.left:d;null!=a;)if(null!=a.left&&a.left!=e&&a.right!=e)a=a.left;else{if(a.right!=e&&b(a))return;var f=a;a=null!=a.right&&a.right!=e?a.right:a.parent;e=f}b(null)}}
function vm(a,b,c){if(a.Ca){var d;if(c instanceof Fm)d=c;else if(c){if(Gm(a,na(function(a){var b=null;0<this.Ya(a.value,c)?b=a.left:(0>this.Ya(a.value,c)&&(b=a.right),d=a);return b},a)),!d)return}else d=Pm(a);a=d;for(var e=d.right?d.right:d;null!=a;)if(null!=a.right&&a.right!=e&&a.left!=e)a=a.right;else{if(a.left!=e&&b(a))return;var f=a;a=null!=a.left&&a.left!=e?a.left:a.parent;e=f}b(null)}};function Rm(a,b,c){this.l=a;this.storage=b;this.h=c;this.g={};a=this.h.keyPath;this.i=u(a)?a.join(","):a||"_ROWID_";this.g[this.i]=null;this.j=Cm(this.l,this.h.getName(),this.i)+"^|"}
function Bm(a,b){var c=b||a.i;if(!a.g[c]){a.g[c]=new Qm(zm);for(var d=a.storage.length,e=0;e<d;e++){var f=a.storage.key(e);if(null!==f&&sa(f,a.j)){var g=Aj(f.substr(a.j.length));if(c==a.i)a.g[c].add(new xm(g));else{var k=a.storage.getItem(f);if(null!==k)if(f=Oj(a.h,c),k=wh(k),k=xl(f,k),f.multiEntry){if(u(k))for(f=0;f<k.length;f++)a.g[c].add(new xm(k[f],g))}else a.g[c].add(new xm(k,g))}}}}return a.g[c]}
function Sm(a,b,c){for(var d in a.g){var e=a.g[d];if(e)if(d==a.i)e.remove(new xm(b));else{var f=Oj(a.h,d),f=uj(c,f.keyPath);e.remove(new xm(b,f))}}}function Tm(a){for(var b in a.g){var c=a.g[b];c&&c.clear()}a.g={}}
function tm(a,b,c,d){if(null==b&&(a.h.keyPath&&(b=Zk(a.h,c)),a.h.h&&null==b)){b=a.j+xj(void 0);var e=wh(a.storage.getItem(b));e.key_count||(e.key_count=0);e.key_count++;a.storage.setItem(b,yh(e));b=e.key_count}d&&(d=null!==a.storage.getItem(a.j+xj(b)));if(d)return null;a.storage.setItem(a.j+xj(b),yh(c));d=b;for(var f in a.g)if(e=a.g[f])if(f==a.i)e.add(new xm(d));else{var g=Oj(a.h,f),g=uj(c,g.keyPath);null!=g&&e.add(new xm(d,g))}return b}
function Um(a,b){var c=a.j+xj(b),d=a.storage.getItem(c);if(null===d)return 0;a.storage.removeItem(c);c=wh(d);Sm(a,b,c);return 1}h=Rm.prototype;h.clear=function(){Tm(this);Vm(this)};h.wa=function(a,b){if(a&&a!=this.i)throw"impl";var c=this.storage.getItem(this.j+xj(b)),d=void 0;if(null!==c)for(var d=wh(c),c=0,e=this.h.indexes.length;c<e;c++){var f=this.h.index(c);if("DATE"==f.type){var g=xl(f,d);g&&yl(f,d,new Date(g))}}return d};h.getName=function(){return this.h.getName()};
function Wm(a,b,c){b=b||a.i;a=Bm(a,b);var d=null,e=null,f=0,g=!1,k=!1;null!=c&&(null!=c.lower&&(d=new xm(c.lower)),null!=c.upper&&(e=new xm(c.upper)),g=c.lowerOpen,k=c.upperOpen);wm(a,function(a){if(null!=a&&(a=a.value,!g||null==d||0!=sj(a.key,d.key))){if(null!=e&&(a=sj(a.key,e.key),1===a||0===a&&k))return!0;f++}},d);return f}
function Vm(a,b){var c=Bm(a,a.i),d=null,e=null,f=0,g=[],k=[],l=!1,m=!1;null!=b&&(null!=b.lower&&(d=new xm(b.lower)),null!=b.upper&&(e=new xm(b.upper)),l=b.lowerOpen,m=b.upperOpen);wm(c,function(b){if(null!=b&&(b=b.value,!l||null==d||0!=zm(b,d))){if(null!=e){var c=zm(b,e);if(1===c||0===c&&m)return!0}var c=a.j+xj(b.key),r=a.storage.getItem(c);null!==r&&(a.storage.removeItem(c),f++,10>g.length&&(g.push(b.key),k.push(wh(r))))}},d);if(10>g.length)for(c=0;c<g.length;c++)Sm(a,g[c],k[c]);else Tm(a);return f}
h.vc=function(a,b,c,d,e,f,g,k){function l(b){if(b&&(z++,!(z<f))){var c=b.value;if(d){if(E&&null!=w&&(b=p?zm(c,w):sj(c.key,w.key),0==b))return;if(null!=s&&(b=p?zm(c,s):sj(c.key,s.key),-1==b||0==b&&G))return k&&(k[0]=void 0,k[1]=void 0),!0}else{if(G&&null!=s&&(b=p?zm(c,s):sj(c.key,s.key),0==b))return;if(null!=w&&(b=p?zm(c,w):sj(c.key,w.key),1==b||0==b&&E))return k&&(k[0]=void 0,k[1]=void 0),!0}b=c.key;if(!g||!r||null==n||0!=sj(n,b)){c=r?c.ha():b;if(2==a)m.push(c);else if(1==a)m.push(b);else if(3==a)m.push([b,
c]);else if(4==a){var l=N.wa(null,c);m.push(l)}else m.push([b,c,N.wa(null,c)]);k&&(k[0]=b,k[1]=c)}n=b;if(t(e)&&m.length>=e)return!0}}var m=[],n,p=!!k&&null!=k[0];b=b||this.i;var r=b!=this.i;b=Bm(this,b);var s=null,w=null;t(f)||(f=0);var z=-1,G=!1,E=!1;null!=c&&(null!=c.lower&&(s=r&&d?new xm(c.lower,"\uffff"):new xm(c.lower)),null!=c.upper&&(w=r&&!d?new xm(c.upper,"\uffff"):new xm(c.upper)),G=!!c.lowerOpen,E=!!c.upperOpen);if(p){d?E=!0:G=!0;c=k[0];var J=t(k[1])?k[1]:"\uffff";d?w=r?new xm(c,J):new xm(c):
s=r?new xm(c,J):new xm(c)}var N=this;d?vm(b,l,w):wm(b,l,s);return m};h.Ra=function(a,b,c,d,e){return this.vc(2,a,b,c,d,e)};h.toString=function(){return"ydn.db.con.simple.Store:"+this.l+":"+this.h.getName()};function Xm(){this.clear()}h=Xm.prototype;h.Be=function(){return this};h.setItem=function(a,b){t(this.g[a])||(this.keys.push(a.toString()),this.length=this.keys.length);this.g[a]=b};h.getItem=function(a){return t(this.g[a])?this.g[a]:null};h.removeItem=function(a){delete this.g[a];Za(this.keys,a.toString());this.length=this.keys.length};h.length=0;h.key=function(a){a=this.keys[a];return t(a)?this.g[a]:null};h.clear=function(){this.g={};this.keys=[];this.length=0};function Ym(a){this.o=a||new Xm;this.l={}}function Am(a,b){var c=Y(a.g,b);if(c)a.l[b]||(a.l[b]=new Rm(a.i,a.j,c));else throw new Rc('store name "'+b+'" not found.');return a.l[b]}Ym.prototype.kb=function(a){var b=this;setTimeout(function(){var c=Cm(b.i),c=b.j.getItem(c),c=new Rl(c);a(c)},10)};function Zm(a,b){this.h=a;this.g=b}Zm.prototype.L=function(a,b){var c=this.h;setTimeout(function(){a.call(b,c)},4);var d=this;return function(){d.g("complete",null);d.g=null;d.h=null}};function $m(a,b){this.g=b}C($m,uk);h=$m.prototype;h.logger=R("ydn.db.crud.req.SimpleStore");h.be=function(a,b,c){this.mb(a,!0,!1,null,b,c)};
h.mb=function(a,b,c,d,e,f){Q(this.logger,W(a)+" "+(b?"put":"add")+"Object"+(c?"":"s "+e.length+" objects"));var g=a.g.L(function(k){var l;if(c)l=Am(k,d),k=f?f[0]:void 0,k=tm(l,k,e[0],!b),null!=k?U(a,k):(l=xh(k),l=new hk(l),U(a,l,!0));else{for(var m=d,n=[],p=!1,r=f||{},s=0;s<e.length;s++){var w;d?w=r[s]:(m=f[s],w=m.F(),m=m.J());l&&l.getName()==m||(l=Am(k,m));w=tm(l,w,e[s],!b);null!=w?n.push(w):(p=!0,n.push(new hk))}U(a,n,p)}g();g=null},this)};h.tf=function(){throw new Pc("putData");};
h.Hd=function(a,b,c){var d=a.g.L(function(e){e=Am(e,b).wa(null,c);U(a,e);d();d=null},this)};function an(a,b,c,d){var e=b.g.L(function(a){for(var g=[],k=c,l,m=0;m<d.length;m++){var n=d[m];n instanceof rk&&(k=n,n=k.F(),k=k.J());l&&l.getName()==k||(l=Am(a,k));n=l.wa(null,n);g[m]=n}U(b,g,!1);e();e=null},a)}h.mf=function(a,b,c){an(this,a,b,c)};h.Xd=function(a,b){an(this,a,null,b)};
h.de=function(a,b,c){var d=W(a)+" removeById "+b+" "+c;Q(this.logger,d);var e=this,f=a.g.L(function(g){g=Um(Am(g,b),c);P(e.logger,"success "+d+(0==g?" [not found]":""));U(a,g);f();f=null},this)};h.ee=function(a,b){Q(this.logger,W(a)+" removeByKeys "+b.length+" keys");var c,d=0,e=a.g.L(function(f){for(var g=0;g<b.length;g++){var k=b[g].J(),l=b[g].F();c&&c.getName()==k||(c=Am(f,k));d+=Um(c,l)}U(a,d);e();e=null},this)};h.ze=function(a,b,c){this.hd(a,b,c)};
h.hd=function(a,b,c){var d=W(a)+" removeByKeyRange "+(c?yh(c):"");Q(this.logger,d);var e=this,f=a.g.L(function(g){g=Vm(Am(g,b),c);P(e.logger,d+" deleted "+g+" records.");U(a,g);f();f=null},this)};h.uf=function(a,b,c,d){var e=W(a)+" removeByIndexKeyRange "+(d?yh(d):"");Q(this.logger,e);var f=a.g.L(function(e){e=Am(e,b);for(var k=e.Ra(c,d),l=k.length,m=0;m<l;m++)Um(e,k[m]);U(a,l);f();f=null},this)};
h.zd=function(a,b){var c=W(a)+" clearByStores";Q(this.logger,c);var d=a.g.L(function(e){for(var f=0;f<b.length;f++)Am(e,b[f]).clear();P(this.logger,"success "+c);U(a,b.length);d();d=null},this)};h.Cd=function(a,b){var c=a.g.L(function(d){for(var e=[],f=0;f<b.length;f++){var g=Am(d,b[f]);e.push(Wm(g))}U(a,e);c();c=null},this)};
h.Pc=function(a,b,c,d){var e=W(a)+" count"+(null!=d?"Index":"")+(null!=c?"KeyRange":"Store");Q(this.logger,e);var f=a.g.L(function(g){g=Wm(Am(g,b),d,c);P(this.logger,"success "+e);U(a,g);f();f=null},this)};h.list=function(a,b,c,d,e,f,g,k,l,m){var n=W(a)+" "+c+" "+(e?xh(e):"");Q(this.logger,n);var p=a.g.L(function(r){r=Am(r,c).vc(b,d,e,k,f,g,l,m);P(this.logger,n+" "+r.length+" records found.");U(a,r);p();p=null},this)};function bn(a,b){this.g=b}C(bn,$m);bn.prototype.h=function(a,b,c,d){c=Y(this.g,c);return new sm(a,b,c,d)};function cn(a,b,c,d){Mj.call(this,a,b,c,d);this.M=null;this.s=this.l=void 0}C(cn,Mj);h=cn.prototype;h.logger=R("ydn.db.core.req.WebsqlCursor");h.ha=function(){return this.s};h.init=function(a,b,c,d,e){cn.m.init.call(this,a,b,c,d,e);this.M=x(b)?Oj(this.i,b):null};h.S=function(){return this.fa};function dn(a,b){a.l=void 0;a.s=void 0;a.fa=void 0;if(t(b))if(A(b)){var c=zl(b[a.i.l],a.i.type);a.s=c;if(a.j){var d=Oj(a.i,a.Fb);a.l=zl(b[a.Fb],d.type)}else a.l=c;a.fa=a.dd?c:en(b,a.i)}else a.fa=b}
function fn(a,b,c,d,e,f){var g=!d;d=[];a.j&&null!=f&&null!=c?c=Il(a.i,a.oa,d,a.M.getName(),a.ba,c,g,f,a.reverse,a.unique):null!=c?(f=a.M?a.M.getName():null,c=Hl(a.i,a.oa,d,f,a.ba,a.reverse,a.unique,c,g)):(c=El(a.i,d,a.oa,a.j?a.M.j:a.i.l,a.ba,a.reverse,a.unique),a.j&&(c+=", "+a.i.j+" ASC"));c+=" LIMIT 1";0<e&&(c+=" OFFSET "+e);Q(a.logger,a+": continue:  SQL: "+c+" : "+yh(d));a.o.executeSql(c,d,function(c,d){0<d.rows.length?dn(a,d.rows.item(0)):dn(a);b.call(a,a.l,a.s,a.fa);b=null},function(c,d){M(a.logger,
"get error: "+d.message);a.Y(d);Pj(a);a.H=!0;dn(a);b.call(a,a.s,a.l,a.fa);b=null;return!1})}h.Sd=function(){return!!this.o};h.update=function(a){if(!this.Sd())throw new lk;var b=new D,c=this.ha();a=Ll(this.i,a,c);var d="REPLACE INTO "+Gl(this.i)+" ("+a.Zf.join(", ")+") VALUES ("+a.wg.join(", ")+")";Q(this.logger,this+': update "'+d+'" : '+yh(a.values));this.o.executeSql(d,a.values,function(){b.C(c)},function(a,c){b.D(c);return!1});return b};
h.advance=function(a){var b=this.l,c=this.s,d=!0;null==this.l||this.j&&null==this.s||(a-=1,d=!1);fn(this,function(a,d,g){var k=null!=b&&null!=a&&0==sj(b,a);if(this.j){var l=null!=d&&null!=c&&0==sj(d,c);if(k&&l)throw new Rc("current: "+b+";"+c+" next: "+a+";"+d);}else if(k)throw new Rc("current: "+b+" next: "+a);this.kc(a,d,g)},this.l,d,a,this.s)};h.Ad=function(a){null!=a?fn(this,this.kc,a,!0):this.advance(1)};h.openCursor=function(a,b){fn(this,this.kc,a,!1,0,b)};
h.clear=function(){if(!this.Sd())throw new lk;var a=new D,b=this.i.l,b="DELETE FROM "+Gl(this.i)+" WHERE "+b+" = ?",c=[this.ha()];Q(this.logger,this+': clear "'+b+'" : '+yh(c));this.o.executeSql(b,c,function(b,c){a.C(c.rowsAffected)},function(b,c){a.D(c);return!1});return a};h.toString=function(){return"WebSql"+cn.m.toString.call(this)};function gn(a,b){this.g=b}C(gn,uk);h=gn.prototype;h.logger=R("ydn.db.crud.req.WebSql");
function en(a,b){if(b.pc&&!b.keyPath&&0==b.indexes.length&&a._default_){var c=a._default_;if(-1==c.indexOf(";base64,"))return wh(c);'"'==c.charAt(0)&&'"'==c.charAt(c.length-1)&&(c=c.substr(1,c.length-2));for(var d=c.split(";base64,"),c=d[0].split(":")[1],d=window.atob(d[1]),e=d.length,f=new Uint8Array(e),g=0;g<e;++g)f[g]=d.charCodeAt(g);return new Blob([f.buffer],{type:c})}c=a._default_?wh(a._default_):{};null!=b.keyPath&&(d=zl(a[b.keyPath],b.type),null!=d&&fl(b,c,d));for(d=0;d<b.indexes.length;d++)e=
b.index(d),f=e.j,"_default_"==f||e.o||e.multiEntry||"DATE"!=e.type&&!b.pc||(f=zl(a[f],e.type),t(f)&&yl(e,c,f));return c}h.tf=function(){throw new Pc("putData");};
h.mb=function(a,b,c,d,e,f){function g(b,d){if(null==e[b])if(Q(m.logger,"empty object at "+b+" of "+e.length),p++,p==e.length)P(m.logger,r+" success "+r),U(a,n,s);else{var G=b+2;G<e.length&&g(G,d)}var E;E=t(f)?Ll(k,e[b],f[b]):Ll(k,e[b]);G=l+Gl(k)+" ("+E.Zf.join(", ")+") VALUES ("+E.wg.join(", ")+");";Q(m.logger,W(a)+" SQL: "+G+" PARAMS: "+E.values+" REQ: "+b+" of "+e.length);d.executeSql(G,E.values,function(f,r){function G(b,c){var e="ydn.db.me:"+k.getName()+":"+b.getName(),e=l+Ka(e)+" ("+k.j+", "+
b.i+") VALUES (?, ?)",f=[tj(I,k.type),tj(c,b.type)];Q(m.logger,W(a)+" multiEntry "+e+" "+f);d.executeSql(e,f,function(){},function(a,b){M(m.logger,"multiEntry index insert error: "+b.message);return!1})}p++;var I=t(E.key)?E.key:r.insertId;1>r.rowsAffected&&(s=!0,I=new hk(I+" no-op"));for(var zc=0,$i=k.indexes.length;zc<$i;zc++){var id=k.index(zc);if(id.multiEntry)for(var fe=uj(e[b],id.keyPath),Wv=(fe?fe.length:0)||0,km=0;km<Wv;km++)G(id,fe[km])}c?U(a,I):(n[b]=I,p==e.length?U(a,n,s):(zc=b+2,zc<e.length&&
g(zc,f)))},function(d,f){p++;s=!0;6==f.code?f.name="ConstraintError":M(m.logger,"error: "+f.message+" "+r);if(c)U(a,f,!0);else if(n[b]=f,p==e.length)Q(m.logger,"success "+r),U(a,n,s);else{var k=b+2;k<e.length&&g(k,d)}return!1})}b=!b;var k=Y(this.g,d),l=b?"INSERT INTO ":"INSERT OR REPLACE INTO ";d=a.g;var m=this,n=[],p=0,r=W(a)+" inserting "+e.length+" objects.",s=!1;if(0<e.length)for(b=0;2>b&&b<e.length;b++)g(b,d);else P(this.logger,"success"),U(a,[])};
h.be=function(a,b,c){if(0==c.length)U(a,[]);else{for(var d=[],e=0,f=0,g=this,k=function(k,l){var m=[];Q(g.logger,"put "+l.length+" objects to "+k);for(var n=Kl(Y(g.g,k)),p=n?void 0:[],r=0;r<l.length;r++)m.push(b[l[r]]),n||p.push(c[l[r]].F());n=ck(a);n.u(function(b){for(var c=0;c<l.length;c++)d[l[c]]=b[c];e++;e==f&&U(a,d)},function(){e++;e==f&&U(a,d,!0)});g.mb(n,!1,!1,k,m,p)},l="",m=[],n=[],p=0;p<c.length;p++){var r=c[p].J(),s=c[p].F();r!=l?(f++,0<m.length&&k(l,m),m=[p],n=[s],l=r):(m.push(p),n.push(s))}0<
m.length&&k(l,m)}};h.Hd=function(a,b,c){var d=a.g,e=Y(this.g,b),f=this;b=e.j;c=[tj(c,e.type)];b="SELECT * FROM "+Gl(e)+" WHERE "+b+" = ?";var g=W(a)+" SQL: "+b+" PARAMS: "+c;Q(this.logger,g);d.executeSql(b,c,function(b,c){if(0<c.rows.length){var d=c.rows.item(0);null!=d?(d=en(d,e),U(a,d)):(P(f.logger,"success no result: "+g),U(a,void 0))}else P(f.logger,"success no result: "+g),U(a,void 0)},function(b,c){M(f.logger,"error: "+g+" "+c.message);U(a,c,!0);return!1})};
h.mf=function(a,b,c){function d(b,e){var p=l.j,r=[tj(c[b],l.type)],s="SELECT * FROM "+Gl(l)+" WHERE "+p+" = ?";Q(f.logger,"SQL: "+s+" PARAMS: "+r);e.executeSql(s,r,function(e,f){k++;if(0<f.rows.length){var n=f.rows.item(0);null!=n&&(g[b]=en(n,l))}else g[b]=void 0;k==c.length?U(a,g):(n=b+10,n<c.length&&d(n,e))},function(e,l){k++;M(f.logger,"error: "+s+" "+l.message);if(k==c.length)U(a,g);else{var n=b+10;n<c.length&&d(n,e)}return!1})}var e=a.g,f=this,g=[],k=0,l=Y(this.g,b);if(0<c.length)for(b=0;10>
b&&b<c.length;b++)d(b,e);else P(f.logger,"success"),U(a,[])};
h.Xd=function(a,b){function c(d,k){var n=b[d],p=Y(e.g,n.J()),r=sk(n),n=p.j,r=[tj(r,p.type)],s="SELECT * FROM "+Gl(p)+" WHERE "+n+" = ?";Q(e.logger,"SQL: "+s+" PARAMS: "+r);k.executeSql(s,r,function(k,m){g++;if(0<m.rows.length){var n=m.rows.item(0);null!=n&&(f[d]=en(n,p))}else f[d]=void 0;g==b.length?(Q(e.logger,"success "+s),U(a,f)):(n=d+10,n<b.length&&c(n,k))},function(b,c){U(a,c,!0);return!1})}var d=a.g,e=this,f=[],g=0;if(0<b.length)for(var k=0;10>k&&k<b.length;k++)c(k,d);else Q(this.logger,"success"),
U(a,[])};
h.zd=function(a,b){function c(d,g){function k(a){a="ydn.db.me:"+l.getName()+":"+a.getName();a="DELETE FROM  "+Ka(a);Q(e.logger,"SQL: "+a);g.executeSql(a,[])}var l=Y(e.g,b[d]),m="DELETE FROM  "+Gl(l);Q(e.logger,"SQL: "+m+" PARAMS: []");g.executeSql(m,[],function(g){d==b.length-1?(Q(e.logger,"success "+m),U(a,b.length)):c(d+1,g)},function(b,c){U(a,c,!0);return!1});for(var n=0,p=l.indexes.length;n<p;n++){var r=l.index(n);r.multiEntry&&k(r)}}var d=a.g,e=this;0<b.length?c(0,d):(Q(this.logger,"success"),
U(a,0))};
h.ee=function(a,b){function c(k){if(k>=b.length)U(a,f,g);else{var l=Y(e.g,b[k].J()),m=tj(b[k].F(),l.type),n=" WHERE "+l.j+" = ?",p="DELETE FROM "+Gl(l)+n,r=W(a)+" SQL: "+p+" PARAMS: "+[m];d.executeSql(p,[m],function(){f++;c(k)},function(a,b){M(e.logger,"error: "+r+b.message);g=!0;c(k);return!1});k++;for(var p=function(b){b="ydn.db.me:"+l.getName()+":"+b.getName();b="DELETE FROM  "+Ka(b)+n;Q(e.logger,W(a)+NaN+b);d.executeSql(b,[m])},s=0,w=l.indexes.length;s<w;s++){var z=l.index(s);z.multiEntry&&p(z)}}}
var d=a.g,e=this,f=0,g=!1;Q(this.logger,W(a)+" removeByKeys: "+b.length+" keys");c(0)};
h.de=function(a,b,c){function d(b){b="ydn.db.me:"+f.getName()+":"+b.getName();b="DELETE FROM  "+Ka(b)+l;Q(k.logger,W(a)+NaN+b);e.executeSql(b,[g])}var e=a.g,f=Y(this.g,b),g=tj(c,f.type),k=this,l=" WHERE "+f.j+" = ?";b="DELETE FROM "+Gl(f)+l;Q(this.logger,W(a)+" SQL: "+b+" PARAMS: "+[g]);e.executeSql(b,[g],function(b,c){U(a,c.rowsAffected)},function(b,c){U(a,c,!0);return!1});b=0;for(c=f.indexes.length;b<c;b++){var m=f.index(b);m.multiEntry&&d(m)}};h.ze=function(a,b,c){hn(this,a,b,void 0,c)};
h.hd=function(a,b,c){hn(this,a,b,void 0,c)};h.uf=function(a,b,c,d){hn(this,a,b,c,d)};
function hn(a,b,c,d,e){function f(c){c="ydn.db.me:"+k.getName()+":"+c.getName();c="DELETE FROM  "+Ka(c)+n;Q(a.logger,W(b)+NaN+c);g.executeSql(c,m)}var g=b.g,k=Y(a.g,c);c="DELETE FROM "+Gl(k);var l=[],m=[],n="";null!=e&&(t(d)?(d=Oj(k,d),rj(d.i,d.type,e,m,l)):rj(k.j,k.type,e,m,l),n=" WHERE "+m.join(" AND "));c+=n;var p=W(b)+" SQL: "+c+" PARAMS: "+l;Q(a.logger,p);g.executeSql(c,l,function(c,d){Q(a.logger,"success "+p);U(b,d.rowsAffected)},function(c,d){M(a.logger,"error: "+p+d.message);U(b,d,!0);return!1});
e=0;for(d=k.indexes.length;e<d;e++)c=k.index(e),c.multiEntry&&f(c)}h.Cd=function(a,b){function c(g){var k="SELECT COUNT(*) FROM "+Ka(b[g]);Q(e.logger,"SQL: "+k+" PARAMS: []");d.executeSql(k,[],function(d,e){var k=e.rows.item(0);f[g]=parseInt(k["COUNT(*)"],10);g++;g==b.length?U(a,f):c(g)},function(b,c){U(a,c,!0);return!1})}var d=a.g,e=this,f=[];0==b.length?(Q(this.logger,"success"),U(a,0)):c(0)};
h.Pc=function(a,b,c,d,e){var f=[];b=El(Y(this.g,b),f,6,d,c,!1,e);Q(this.logger,W(a)+" SQL: "+b+" PARAMS: "+f);a.g.executeSql(b,f,function(b,c){var d=c.rows.item(0);U(a,Vl(d))},function(b,c){U(a,c,!0);return!1})};
h.list=function(a,b,c,d,e,f,g,k,l,m){var n=this,p=[],r=Y(this.g,c),s=r.l,w=r.type,z=w,G=null!=d&&d!==s?Oj(r,d):null,E=d||s;G&&(z=G.type);c=[];if(m&&t(m[0])){var J=m[0];G&&t(m[1])?(d=m[1],e=Il(r,b,c,G.getName(),e,J,!0,d,k,l)):e=Hl(r,b,c,d,e,k,l,J,!0)}else e=El(r,c,b,E,e,k,l);y(f)&&(e+=" LIMIT "+f);y(g)&&(e+=" OFFSET "+g);var N=a+" SQL: "+e+" ;params= "+yh(c);Q(this.logger,N);a.g.executeSql(e,c,function(c,d){for(var e=d.rows.length,f,g=0;g<e;g++)f=d.rows.item(g),2==b?p[g]=zl(f[s],w):1==b?p[g]=zl(f[E],
z):3==b?p[g]=[zl(f[E],z),zl(f[s],w)]:null!=f&&(p[g]=en(f,r));P(n.logger,"success "+a);m&&f&&(m[0]=zl(f[E],z),m[1]=zl(f[s],w));U(a,p)},function(b,c){M(n.logger,"error: "+N+c.message);U(a,c,!0);return!1})};function jn(a,b){this.g=b}C(jn,gn);jn.prototype.logger=R("ydn.db.core.req.WebSql");jn.prototype.h=function(a,b,c,d){c=Y(this.g,c);return new cn(a,b,c,d)};lm.prototype.G=function(){var a=yk(this);if("indexeddb"==a)return new qm(0,this.h);if("websql"==a)return new jn(0,this.h);if("memory"==a||"localstorage"==a||"userdata"==a||"sessionstorage"==a)return new bn(0,this.h);throw new Rc("No executor for "+a);};function kn(a){return x(a)?a.replace(/\D/g,"").replace(/^0+/,""):null}function ln(a){if(!x(a)||!/[\w\+]+@\w+\.\w+/.test(a))return null;a=a.replace(/.*</,"").replace(/>.*/,"");a=a.toLowerCase();a=a.replace(/\+\w*?@/,"@");for(var b=a.indexOf("@");0<=b;b--);return a};function mn(a){if(!x(a))throw new Dh;this.bb=a;this.j=Jj;this.g=[];nn(this,a);this.md=""}h=mn.prototype;h.bb="";h.qg=NaN;h.rg=NaN;h.Df=!1;h.md="";
function nn(a,b){var c=b.split(/\sFROM\s/i);if(2==c.length){var d=c[1],c=c[0].match(/\s*?(SELECT|INSERT|UPDATE|DELETE)\s+(.*)/i);if(3==c.length){a.l=c[1].toUpperCase();if("SELECT"==a.l)a.j=Ij;else if("INSERT"==a.l)a.j=Jj;else if("UPDATE"==a.l)a.j=Jj;else if("DELETE"==a.l)a.j=Jj;else return;var c=c[2].trim(),e=c.match(/^(MIN|MAX|COUNT|AVG|SUM)/i);e?(a.i=e[0].toUpperCase(),c=c.replace(/^(MIN|MAX|COUNT|AVG|SUM)/i,"").trim()):a.i=void 0;"("==c.charAt(0)&&(")"==c.charAt(c.length-1)?c=c.substring(1,c.length-
1):new pk("missing closing parentheses"));a.G=c;c=d.search(/(ORDER BY|LIMIT|OFFSET)/i);0<c?(a.h=d.substring(c),d=d.substring(0,c)):a.h="";c=d.search(/WHERE/i);0<c?(a.o=d.substring(c+6).trim(),d=d.substring(0,c)):a.o="";a.g=d.trim().split(",").map(function(a){a=Ha(a,'"');a=Ha(a,"'");return a.trim()})}}}
h.parse=function(a){if(a){for(var b=0;b<a.length;b++)this.bb=this.bb.replace("?",a[b]);nn(this,this.bb)}this.p=on(this);if(!this.p)return this.md;a=this.h.length;if(b=/OFFSET\s+(\d+)/i.exec(this.h))this.rg=parseInt(b[1],10),a=this.h.search(/OFFSET/i);if(b=/LIMIT\s+(\d+)/i.exec(this.h))this.qg=parseInt(b[1],10),b=this.h.search(/LIMIT/i),b<a&&(a=b);(a=/ORDER BY\s+(.+)/i.exec(this.h.substr(0,a)))?(a=a[1].trim(),(b=a.match(/(ASC|DESC)/i))?(this.Df="DESC"==b[0].toUpperCase(),a=a.replace(/\s+(ASC|DESC)/i,
"")):this.Df=!1,this.s=Ha(Ha(a,'"'),"'")):this.s=void 0;return""};function pn(a){if("*"==a.G)return null;a=a.G.split(",");return a=a.map(function(a){return Ha(a.trim(),'"')})}h.toJSON=function(){return{sql:this.bb}};
function on(a){function b(a){return Wa(c,function(b){return b.Uc()==a})}var c=[],d=/(.+?)(<=|>=|=|>|<)(.+)/i;if(0<a.o.length)for(var e=a.o.split("AND"),f=0;f<e.length;f++){var g=e[f],k=d.exec(g);if(k){var l=k[1].trim(),l=Ha(l,'"'),l=Ha(l,"'");if(0<l.length){var m=k[3].trim();sa(m,'"')?m=Ha(m,'"'):sa(m,"'")?m=Ha(m,"'"):m=parseFloat(m);k=new Fj(l,k[2],m);l=b(l);if(0<=l){if(c[l]=c[l].xe(k),!c[l])return a.md='where clause "'+g+'" conflict',null}else c.push(k)}else return a.md='Invalid clause "'+g+'"',
null}else return a.md='Invalid clause "'+g+'"',null}return c}h.toString=function(){return"query:"+this.bb};function qn(a,b){this.g=b;this.h=a}qn.prototype.logger=R("ydn.db.sql.req.nosql.Node");qn.prototype.toJSON=function(){return{sql:this.g}};qn.prototype.toString=function(){return"idb.Node:"};
qn.prototype.execute=function(a,b){var c=ab(this.g.g)[0],d=this.g.p,e=this.g.qg,e=isNaN(e)?100:e,f=this.g.rg,f=isNaN(f)?0:f,g=this.g.s,k=pn(this.g),l=null,m=this.g.Df;if(0==d.length)l=null;else if(1==d.length)l=lj(d[0].g);else throw new Oc("too many conditions.");null===k||ek(a,function(a,b,c){var d=a;b||(d=a.map(function(a){var b=k.length;if(1==b)return uj(a,k[0]);for(var c={},d=0;d<b;d++)c[k[d]]=uj(a,k[d]);return c}));c(d,b)});var d=0<d.length?d[0].Uc():void 0,n=W(a)+" executing on"+c;d&&(n+=":"+
d);n+=" "+qj(l);P(this.logger,n);g&&g!=this.h.keyPath?b.list(a,4,c,g,l,e,f,m,!1):t(d)&&d!=this.h.keyPath?b.list(a,4,c,d,l,e,f,m,!1):b.list(a,4,c,null,l,e,f,m,!1)};function rn(a,b){qn.call(this,a,b)}C(rn,qn);
rn.prototype.execute=function(a,b){var c,d=ab(this.g.g)[0],e=this.g.p,f=null;if(0==e.length)f=null;else if(1==e.length)f=lj(e[0].g);else throw new Oc("too many conditions.");var g=this.g.i,e=0<e.length?e[0].Uc():void 0,k=W(a)+" executing "+g+" on "+d;e&&(k+=":"+e);k+=" "+qj(f);P(this.logger,k);if("COUNT"==g)f?b.Pc(a,d,f,e,!1):b.Pc(a,d,null,void 0,!1);else{var l,k=pn(this.g);if(!k||0==k.length)throw new Jh("field name require for reduce operation: "+g);k=k[0];if("MIN"==g)l=sn(k);else if("MAX"==g)l=
tn(k);else if("AVG"==g)c=0,l=un(k);else if("SUM"==g)c=0,l=vn(k);else throw new Eh(g);var m;t(e)?m=new Xj(d,e,f):m=new Wj(d,f);var d=b.h(a.g,W(a),d,4),n=m.load([d]);n.Y=function(b){U(a,b,!0)};var p=0;n.V=function(b){null!=b?(b=m.g?n.ha():n.S(),c=l(b,c,p),n.advance(1),p++):U(a,c)}}};function un(a){return function(b,c,d){t(c)||(c=0);return(c*d+b[a])/(d+1)}}function vn(a){return function(b,c){return c+b[a]}}function sn(a){return function(b,c){var d=b[a];return t(c)?c<d?c:d:d}}
function tn(a){return function(b,c){var d=b[a];return t(c)?c>d?c:d:d}};function wn(a,b){this.g=b}C(wn,qm);wn.prototype.logger=R("ydn.db.sql.req.IndexedDb");wn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new pk(c);c=ab(b.g);if(1==c.length){var d=Y(this.g,c[0]);if(!d)throw new mk(c[0]);var e=pn(b);if(e)for(var f=0;f<e.length;f++)if(!Vk(d,e[f]))throw new mk('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new rn(d,b):g=new qn(d,b);g.execute(a,this)}else throw new Eh(b.bb);};function xn(a,b){this.h=b;this.i=a;this.g=pn(b)}xn.prototype.logger=R("ydn.db.sql.req.websql.Node");xn.prototype.toJSON=function(){return{sql:this.h.bb}};xn.prototype.toString=function(){return"websql.Node:"};function yn(a,b){if(a.g){if(1==a.g.length){if(A(b))return lc(b,a.g[0]);return}for(var c={},d=0;d<a.g.length;d++)c[a.g[d]]=lc(b,a.g[d]);return c}return en(b,a.i)}
xn.prototype.execute=function(a,b,c){var d=this,e=[];b.executeSql(this.h.bb,c,function(b,c){for(var k=c.rows.length,l=0;l<k;l++){var m=c.rows.item(l);if(A(m))var n=yn(d,m);e.push(n)}a(e)},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function zn(a,b){xn.call(this,a,b)}C(zn,xn);zn.prototype.execute=function(a,b,c){var d=this;b.executeSql(this.h.bb,c,function(b,c){var d=c.rows.length;if(1==d)d=Vl(c.rows.item(0)),a(d);else if(0==d)a(void 0);else throw new kk;},function(b,c){M(d.logger,"Sqlite error: "+c.message);a(c,!0);return!0})};function An(a,b){this.g=b}C(An,jn);An.prototype.logger=R("ydn.db.sql.req.WebSql");An.prototype.executeSql=function(a,b,c){var d=ab(b.g);if(1==d.length){var e=Y(this.g,d[0]);if(!e)throw new mk(d[0]);var f=pn(b);if(f)for(var g=0;g<f.length;g++)if(!Vk(e,f[g]))throw new mk('Index "'+f[g]+'" not found in '+d[0]);var k;b.i?k=new zn(e,b):k=new xn(e,b);k.execute(function(b,c){U(a,b,c)},a.g,c)}else throw new Eh(b.bb);};function Bn(a,b){this.g=b}C(Bn,bn);Bn.prototype.logger=R("ydn.db.sql.req.SimpleStore");Bn.prototype.executeSql=function(a,b,c){if(c=b.parse(c))throw new pk(c);c=ab(b.g);if(1==c.length){var d=Y(this.g,c[0]);if(!d)throw new mk(c[0]);var e=pn(b);if(e)for(var f=0;f<e.length;f++)if(!Vk(d,e[f]))throw new L('Index "'+e[f]+'" not found in '+c[0]);var g;b.i?g=new rn(d,b):g=new qn(d,b);g.execute(a,this)}else throw new Oc(b.bb);};function Cn(a,b,c,d){Jk.call(this,a,b,c,d)}C(Cn,ol);Cn.prototype.executeSql=function(a,b){for(var c=new mn(a),d=ab(c.g),e=0;e<d.length;e++){var f=Y(this.h,d[e]);if(!f)throw new L("store: "+f+" not exists.");}P(this.logger,"executeSql: "+a+" params: "+b);var g=this.g.request("sql",ab(c.g),c.j);V(g,function(){X(this).executeSql(g,c,b||[])},this);return g};function Dn(a,b,c){jm.call(this,a,b,c)}C(Dn,lm);Dn.prototype.Dc=function(a,b){return new Cn(this,this.h,a,b)};Dn.prototype.executeSql=function(a,b){return this.g.executeSql(a,b)};Dn.prototype.G=function(){var a=yk(this);if("indexeddb"==a)return new wn(0,this.h);if("websql"==a)return new An(0,this.h);if("memory"==a||"localstorage"==a||"sessionstorage"==a)return new Bn(0,this.h);throw new Rc("No executor for "+a);};function En(a,b){t(a)&&5242880<a&&M(this.logger,"storage size request ignored, use Quota Management API instead");this.ia=null;this.jd=b||NaN}h=En.prototype;
h.connect=function(a,b){function c(a,c,d){P(e.logger,(d?"changing":"upgrading")+" version to "+a.version+" from "+g);for(d=0;d<b.stores.length;d++)Fn(e,a,c,b.stores[d]);c=a.objectStoreNames;var f=c.length;for(d=0;d<f;d++)Sk(b,c[d])||(a.deleteObjectStore(c[d]),P(e.logger,"store: "+c[d]+" deleted."))}function d(a,b){f.wb?M(e.logger,"database already set."):t(b)?(M(e.logger,b?b.message:"Error received."),e.ia=null,f.D(b)):(e.ia=a,e.ia.onabort=function(a){Q(e.logger,e+": abort");e.nd(a.target.error)},
e.ia.onerror=function(a){Q(e.logger,e+": error");e.nd(a.target.error)},e.ia.onversionchange=function(a){Q(e.logger,e+" closing connection for onversionchange to: "+a.version);if(e.ia&&(e.ia.onabort=null,e.ia.onblocked=null,e.ia.onerror=null,e.ia.onversionchange=null,e.ae(a),!a.defaultPrevented)){e.ia.close();e.ia=null;var b=Error();b.name=a.type;e.pe(b)}},f.C(parseFloat(g)))}var e=this,f=new D,g=void 0,k=b.version;P(e.logger,"Opening database: "+a+" ver: "+(b.Bc?"auto":k));var l;l=t(k)?Lj.open(a,
k):Lj.open(a);l.onsuccess=function(f){var k=f.target.result;t(g)||(g=k.version);P(e.logger,"Database: "+k.name+", ver: "+k.version+" opened.");if(b.Bc)e.kb(function(f){if(b instanceof Ok)for(var g=0;g<f.stores.length;g++)Sk(b,f.stores[g].getName())||Pk(b,f.stores[g].ga());f=Sl(b,f,!1,!0);if(0<f.length){P(e.logger,"Schema change require for difference in "+f);var l=y(k.version)?k.version+1:1;if("IDBOpenDBRequest"in q){k.close();var m=Lj.open(a,l);m.onupgradeneeded=function(a){a=a.target.result;P(e.logger,
"re-open for version "+a.version);c(a,m.transaction,!1)};m.onsuccess=function(a){d(a.target.result)};m.onerror=function(){P(e.logger,e+": fail.");d(null)}}else{var p=k.setVersion(l+"");p.g=function(a){M(e.logger,"migrating from "+k.version+" to "+l+" failed.");d(null,a)};p.onsuccess=function(){p.transaction.oncomplete=E;c(k,p.transaction,!0)};var E=function(){var b=Lj.open(a);b.onsuccess=function(a){a=a.target.result;P(e.logger,e+": OK.");d(a)};b.onerror=function(){P(e.logger,e+": fail.");d(null)}};
null!=p.transaction&&(p.transaction.oncomplete=E)}}else d(k)},void 0,k);else if(b.version>k.version){var l=k.setVersion(b.version);l.g=function(a){M(e.logger,"migrating from "+k.version+" to "+b.version+" failed.");d(null,a)};l.onsuccess=function(){c(k,l.transaction,!0)}}else b.version==k.version?P(e.logger,"database version "+k.version+" ready to go"):M(e.logger,"connected database version "+k.version+" is higher than requested version."),e.kb(function(a){a=Sl(b,a,!1,!0);0<a.length?(P(e.logger,a),
d(null,new Hh("different schema: "+a))):d(k)},void 0,k)};l.onupgradeneeded=function(a){a=a.target.result;g=NaN;P(e.logger,"upgrade needed for version "+a.version);c(a,l.transaction,!1)};l.onerror=function(c){e.logger.log(Re,'open request to database "'+a+'" '+(t(b.version)?" with version "+b.version:"")+" cause error of "+l.error.name,void 0);d(null,c)};l.onblocked=function(c){e.logger.log(Re,"database "+a+" "+b.version+" block, close other connections.",void 0);d(null,c)};y(this.jd)&&!isNaN(this.jd)&&
setTimeout(function(){"done"!=l.readyState&&(e.logger.log(Re,e+": database state is still "+l.readyState,void 0),d(null,new qk("connection timeout after "+e.jd)))},this.jd);return f};h.jd=18E4;h.pe=function(){};h.nd=function(){};h.ae=function(){};h.Kc=function(){return"indexeddb"};h.oe=function(){return!!this.ia};h.logger=R("ydn.db.con.IndexedDb");h.ia=null;h.ne=function(){return this.ia?parseFloat(this.ia.version):void 0};
h.kb=function(a,b,c){c=c||this.ia;if(t(b)){if(null===b){if(0==c.objectStoreNames.length){a(new Rl(c.version));return}throw new Gh;}c=b.db}else{b=[];for(var d=c.objectStoreNames.length-1;0<=d;d--)b[d]=c.objectStoreNames[d];if(0==b.length){a(new Rl(c.version));return}b=c.transaction(b,Ij)}for(var e=c.objectStoreNames,f=[],g=e.length,d=0;d<g;d++){for(var k=b.objectStore(e[d]),l=[],m=0,n=k.indexNames.length;m<n;m++){var p=k.index(k.indexNames[m]);l[m]=new ul(p.keyPath,void 0,p.unique,p.multiEntry,p.name)}f[d]=
new Lk(k.name,k.keyPath,k.autoIncrement,void 0,l)}b=new Rl(c.version,f);a(b)};
function Fn(a,b,c,d){function e(){var a={autoIncrement:!!d.h};null!=d.keyPath&&(a.keyPath=d.keyPath);return b.createObjectStore(d.getName(),a)}Q(a.logger,"Creating Object Store for "+d.getName()+" keyPath: "+d.keyPath);if(b.objectStoreNames.contains(d.getName())){c=c.objectStore(d.getName());Bl(d.keyPath||"",c.keyPath||"")?(b.deleteObjectStore(d.getName()),M(a.logger,"store: "+d.getName()+" deleted due to keyPath change."),c=e()):fa(c.autoIncrement)&&fa(d.h)&&c.autoIncrement!=d.h&&(b.deleteObjectStore(d.getName()),
M(a.logger,"store: "+d.getName()+" deleted due to autoIncrement change."),c=e());for(var f=c.indexNames,g=0;g<d.indexes.length;g++){var k=d.index(g);!f.contains(k.getName())&&k.l&&(c.clear(),M(a.logger,"store: "+d.getName()+" cleared since generator index need re-indexing."))}for(var l=0,m=0,n=0,g=0;g<d.indexes.length;g++){var k=d.index(g),p=!1;if(f.contains(k.getName())){var r=c.index(k.getName()),s=null!=r.unique&&null!=k.unique&&r.unique!=k.unique,w=null!=r.multiEntry&&null!=k.multiEntry&&r.multiEntry!=
k.multiEntry,r=null!=r.keyPath&&null!=k.keyPath&&!!Bl(r.keyPath,k.keyPath);if(s||w||r)c.deleteIndex(k.getName()),p=!0,l--,n++}else"BLOB"!=k.type&&(p=!0);p&&(k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath),l++)}for(g=0;g<f.length;g++)Vk(d,f[g])||(c.deleteIndex(f[g]),m++);Q(a.logger,"Updated store: "+c.name+", "+l+" index created, "+m+" index deleted, "+n+" modified.")}else{c=e();for(g=0;g<d.indexes.length;g++)k=
d.index(g),"BLOB"==k.type?a.logger.info("Index "+k+" of blob data type ignored."):(Q(a.logger,"Creating index: "+k),k.unique||k.multiEntry?(p={unique:k.unique,multiEntry:k.multiEntry},c.createIndex(k.getName(),k.keyPath,p)):c.createIndex(k.getName(),k.keyPath));Q(a.logger,"Created store: "+c)}}
h.Ed=function(a,b,c,d){var e=this.ia;if(!b){b=[];for(var f=e.objectStoreNames.length-1;0<=f;f--)b[f]=e.objectStoreNames[f]}0==b.length?a(null):(b=e.transaction(b,c),b.oncomplete=function(a){d("complete",a)},b.onabort=function(a){d("abort",a)},a(b),a=null)};h.me=function(){Q(this.logger,this+" closing connection");this.ia.close()};h.toString=function(){return"IndexedDB:"+(this.ia?this.ia.name+":"+this.ia.version:"")};
gk.push(function(a,b){if(!Lj||b&&"indexeddb"!=b)return null;var c=Lj.deleteDatabase(a),d=new ak("IDBVersionChangeEvent ");c.onblocked=function(a){Tc(d,a)};c.onerror=function(a){d.D(a)};c.onsuccess=function(a){d.C(a)};return d});function Gn(a){Ym.call(this,a);this.h=NaN}C(Gn,Ym);h=Gn.prototype;h.logger=R("ydn.db.con.SimpleStorage");h.ne=function(){return this.h};
h.connect=function(a,b){function c(a,b){setTimeout(function(){b?(P(d.logger,d+" opening fail"),e.D(b)):(P(d.logger,d+" version "+d.ne()+" open"),e.C(a))},10)}var d=this,e=new D;this.j=this.o.Be(a);this.i=a;this.g=b;var f=Cm(this.i);this.h=NaN;var g=wh(this.j.getItem(f));t(g.version)&&!y(g.version)&&(g.version=NaN);if(g)if(g=new Rl(g),Sl(this.g,g,!1,!1))if(!this.g.Bc&&!isNaN(g.version)&&this.g.version>g.version)c(NaN,new jk("existing version "+g.version+" is larger than "+this.g.version));else{var k=
this.g.version;this.h=t(k)?k:g.version+1;for(k=0;k<this.g.count();k++)var l=this.g.store(k);if(this.g instanceof Ok)for(k=0;k<g.count();k++)l=g.store(k),Pk(this.g,l);k=this.g.toJSON();k.version=this.h||NaN;this.j.setItem(f,yh(k));c(g.version||NaN)}else{for(k=0;k<this.g.count();k++)l=this.g.store(k);this.h=g.version||NaN;c(this.h)}else g=b.toJSON(),this.h=1,g.version=this.h,this.j.setItem(f,yh(g)),c(NaN);return e};h.oe=function(){return!!this.i};h.pe=function(){};h.nd=function(){};h.ae=function(){};
h.Kc=function(){return"memory"};h.me=function(){};h.Ed=function(a,b,c,d){a(new Zm(this,function(a,b){d(a,b)}))};h.toString=function(){return"SimpleStorage:"+this.Kc()+":"+(this.i+":"+this.h)};function Hn(){Gn.call(this,this)}C(Hn,Gn);Hn.prototype.Be=function(){return window.localStorage};Hn.prototype.Kc=function(){return"localstorage"};gk.push(function(a,b){if(!b||"localstorage"==b){var c=new Hn,d=new Ok;c.connect(a,d);c.kb(function(a){for(var b=0;b<a.stores.length;b++)Am(c,a.stores[b].getName()).clear()})}});function In(){Gn.call(this,this)}C(In,Gn);In.prototype.Be=function(){return window.sessionStorage};In.prototype.Kc=function(){return"sessionstorage"};
gk.push(function(a,b){if(!b||"sessionstorage"==b){var c=new In,d=new Ok;c.connect(a,d);c.kb(function(a){for(var b=0;b<a.stores.length;b++)Am(c,a.stores[b].getName()).clear()})}});function Jn(a){this.g=t(a)?a:4194304}h=Jn.prototype;
h.connect=function(a,b){function c(b,c){var f=b.version?parseInt(b.version,10):0,g=c.Bc?isNaN(f)?1:f+1:c.version;O(e.logger,a+": changing version from "+b.version+" to "+g);var k=!1,l=0;b.changeVersion(b.version,g+"",function(a){e.kb(function(b){k=!0;for(var d=0;d<c.count();d++){var f=Y(b,c.store(d).getName()),f=f?Jl(f,c.store(d)):null;Kn(e,a,c.store(d),function(a){a&&l++},f)}for(d=0;d<b.count();d++)f=b.store(d),Sk(c,f.getName())||(c instanceof Ok?Pk(c,f):(f="DROP TABLE "+Gl(f),P(e.logger,f),a.executeSql(f,
[],function(){},function(a,b){throw b;})))},a,b)},function(c){e.logger.log(Re,"SQLError "+c+" "+c.code+"("+c.message+") while changing version from "+b.version+" to "+g+" on "+a,void 0);throw c;},function(){if(k){var f=".";l!=c.stores.length&&(f=" but unexpected stores exists.");Q(e.logger,a+":"+b.version+" ready"+f);d(b)}else M(e.logger,a+": changing version voided.")})}function d(a,b){t(b)?(e.Ia=null,g.D(b)):(e.Ia=a,g.C(parseFloat(f)))}var e=this,f=NaN,g=new D,k=null;try{k=q.openDatabase(a,"",a,
this.g)}catch(l){if("SECURITY_ERR"==l.name)M(this.logger,"SECURITY_ERR for opening "+a),k=null,this.Ef=new ok(l);else throw l;}if(k){var f=k.version,m="database "+a+(0==k.version.length?"":" version "+k.version);null!=b.version&&b.version==k.version?(O(e.logger,"Existing "+m+" opened as requested."),d(k)):this.kb(function(a){(a=Sl(b,a,!0,!1))?(0==k.version.length?O(e.logger,"New "+m+" created."):b.Bc?O(e.logger,"Existing "+m+" opened and schema change for "+a):O(e.logger,"Existing "+m+" opened and  schema change to version "+
b.version+" for "+a),c(k,b)):(O(e.logger,"Existing "+m+" with same schema opened."),d(k))},null,k)}else d(null,this.Ef);return g};h.Kc=function(){return"websql"};h.Ef=null;h.Ia=null;h.logger=R("ydn.db.con.WebSql");h.pe=function(){};h.nd=function(){};
function Ln(a){var b=a.H,c="CREATE TABLE IF NOT EXISTS "+Gl(a)+" (",d=a.j,c=c+(d+" "+b+" PRIMARY KEY ");a.h&&(c+=" AUTOINCREMENT ");if(!a.pc||!a.keyPath&&0==a.indexes.length)c+=" ,_default_ BLOB";for(var e=[],f=[d],g=0,k=a.indexes.length;g<k;g++){var l=a.index(g),m="";if(l.multiEntry){var m="ydn.db.me:"+a.getName()+":"+l.getName(),n=l.unique?" UNIQUE ":"",l="CREATE TABLE IF NOT EXISTS "+Ka(m)+" ("+d+" "+b+", "+l.i+" "+l.p+n+")";e.push(l)}else l.unique&&(m=" UNIQUE "),n=l.keyPath,"BLOB"!=l.type&&x(n)&&
(n="CREATE "+m+" INDEX IF NOT EXISTS "+Ka(a.getName()+"-"+l.getName())+" ON "+Gl(a)+" ("+l.i+")",e.push(n)),n=l.i,-1==f.indexOf(n)&&(c+=", "+n+" "+l.p+m,f.push(n))}e.unshift(c+")");return e}h.ne=function(){return this.Ia?parseFloat(this.Ia.version):void 0};
h.kb=function(a,b,c){function d(a,b){throw b;}function e(b,c){if(c&&c.rows){for(var d=0;d<c.rows.length;d++){var e=c.rows.item(d);if("__WebKitDatabaseInfoTable__"!=e.name&&"sqlite_sequence"!=e.name&&"table"==e.type){var r=nc(e,"sql");Q(f.logger,"Parsing table schema from SQL: "+r);for(var s=r.substr(r.indexOf("("),r.lastIndexOf(")")).match(/(?:"[^"]*"|[^,])+/g),w=void 0,z,r=[],G=!1,E=!1,J=0;J<s.length;J++){var N=s[J].match(/\w+|"[^"]+"/g),ja=Sa(N,function(a){return a.toUpperCase()}),I=Ha(N[0],'"'),
N=vl(ja[1]);if(-1!=ja.indexOf("PRIMARY")&&-1!=ja.indexOf("KEY")){z=N;if(x(I)&&!va(I)&&"_ROWID_"!=I){var zc=I.split(","),w=I;1<zc.length&&(w=zc,z=void 0)}-1!=ja.indexOf("AUTOINCREMENT")&&(G=!0)}else if("_ROWID_"!=I)if("_default_"==I)E=!0;else{var $i="UNIQUE"==ja[2];sa(I,e.tbl_name+"-")&&(I=I.substr(e.tbl_name.length+1));ja=new ul(I,N,$i);r.push(ja)}}if(sa(e.name,"ydn.db.me:")){var id=e.name.split(":");if(3<=id.length){var fe=id[1],w=new ul(id[2],N,$i,!0),s=Wa(r,function(a){return a.getName()==id[2]});
0<=s?r[s]=w:r.push(w);s=Wa(k,function(a){return a.getName()===fe});0<=s?(J=k[s],k[s]=new Lk(J.getName(),J.keyPath,G,z,r,void 0,!E)):k.push(new Lk(fe,void 0,!1,void 0,[w]));Q(f.logger,'multi entry index "'+w.getName()+'" found in '+fe+(-1==s?"*":""))}else M(f.logger,'Invalid multiEntry store name "'+e.name+'"')}else J=Wa(k,function(a){return a.getName()===e.name}),0<=J?(s=k[J].index(0),r.push(s),k[J]=new Lk(e.name,w,G,z,r,void 0,!E)):(r=new Lk(e.name,w,G,z,r,void 0,!E),k.push(r))}}d=new Rl(g,k);a(d)}}
var f=this,g=(c=c||this.Ia)&&c.version?parseFloat(c.version):void 0,g=isNaN(g)?void 0:g,k=[];b?b.executeSql("SELECT * FROM sqlite_master",[],e,d):c.readTransaction(function(b){f.kb(a,b,c)},function(a){f.logger.log(Re,"opening tx: "+a.message,void 0);throw a;},e)};
function Kn(a,b,c,d,e){function f(a){b.executeSql(a,[],function(){g++;g==k.length&&(d(!0),d=null)},function(b,e){g++;g==k.length&&(d(!1),d=null);var f="SQLError creating table: "+c.getName()+" "+e.message+' for executing "'+a;throw new nk(e,f);})}var g=0,k=Ln(c),l="Create";if(e){e=Nk(c,e);if(0==e.length){Q(a.logger,"same table "+c.getName()+" exists.");d(!0);d=null;return}l="Modify";M(a.logger,"table: "+c.getName()+" has changed by "+e+" ALTER TABLE cannot run in WebSql, dropping old table.");k.unshift("DROP TABLE IF EXISTS "+
Ka(c.getName()))}Q(a.logger,l+" table: "+c.getName()+": "+k.join(";"));for(a=0;a<k.length;a++)f(k[a])}h.oe=function(){return!!this.Ia};h.me=function(){this.Ia=null};
h.Ed=function(a,b,c,d){function e(a){Q(k.logger,k+": Tx "+c+" request cause error.");d("abort",a)}function f(){d("complete",{type:"complete"})}function g(b){a(b)}var k=this;null===this.Ia&&(a(null),d("abort",this.Ef));c==Ij?this.Ia.readTransaction(g,e,f):c==Kj?this.Ia.changeVersion(this.Ia.version,this.Ia.version+1+"",g,e,f):this.Ia.transaction(g,e,f)};
gk.push(function(a,b){if(ga(q.openDatabase)&&(!b||"websql"==b)){var c=new Jn,d=new Ok;P(c.logger,"deleting websql database: "+a);var d=c.connect(a,d),e=function(){c.logger.info("all tables in "+a+" deleted.")};d.A(function(){c.Ed(function(b){b.executeSql('SELECT * FROM sqlite_master WHERE type = "table"',[],function(d,e){if(e&&e.rows){for(var l=e.rows.length,m=0,n=0;n<l;n++){var p=e.rows.item(n);"__WebKitDatabaseInfoTable__"!=p.name&&"sqlite_sequence"!=p.name&&(m++,Q(c.logger,"deleting table: "+p.name),
b.executeSql("DROP TABLE "+p.name))}P(c.logger,m+' tables deleted from "'+a+'"')}},function(a,b){throw b;})},[],Jj,e)});d.Mc(function(){M(c.logger,"Connecting "+a+" failed.")})}});Jn.prototype.ae=function(){};Jn.prototype.toString=function(){return"WebSql:"+(this.Ia?":"+this.Ia.version:"")};hm.prototype.Ce=function(a){return"indexeddb"==a&&Lj?new En(this.H,this.V):"websql"==a&&ga(q.openDatabase)?new Jn(this.H):"localstorage"==a&&window.localStorage?new Hn:"sessionstorage"==a&&window.sessionStorage?new In:"memory"==a?new Gn:null};function Mn(a,b){vb.call(this);this.j=b;this.g=[];if(a>this.j)throw Error("[goog.structs.SimplePool] Initial cannot be greater than max");for(var c=0;c<a;c++)this.g.push(this.h())}C(Mn,vb);Mn.prototype.ce=function(a){this.g.length<this.j?this.g.push(a):this.i(a)};Mn.prototype.h=function(){return{}};Mn.prototype.i=function(a){if(A(a))if(ga(a.la))a.la();else for(var b in a)delete a[b]};Mn.prototype.I=function(){Mn.m.I.call(this);for(var a=this.g;a.length;)this.i(a.pop());delete this.g};function Nn(){this.g=[];this.i=new nd;this.j=new nd;this.o=1;this.l=new Mn(0,4E3);this.l.h=function(){return new On};this.p=new Mn(0,50);this.p.h=function(){return new Pn};var a=this;this.h=new Mn(0,2E3);this.h.h=function(){return String(a.o++)};this.h.i=function(){}}R("goog.debug.Trace");function Pn(){this.time=this.count=0}Pn.prototype.toString=function(){var a=[];a.push(this.type," ",this.count," (",Math.round(10*this.time)/10," ms)");return a.join("")};function On(){}
function Qn(a,b,c){var d=[];-1==b?d.push("    "):d.push(Rn(a.h-b));d.push(" ",Sn(a.h-0));0==a.g?d.push(" Start        "):1==a.g?(d.push(" Done "),d.push(Rn(a.l-a.startTime)," ms ")):d.push(" Comment      ");d.push(c,a);0<a.j&&d.push("[VarAlloc ",a.j,"] ");return d.join("")}On.prototype.toString=function(){return null==this.type?this.i:"["+this.type+"] "+this.i};
Nn.prototype.toString=function(){for(var a=[],b=-1,c=[],d=0;d<this.g.length;d++){var e=this.g[d];1==e.g&&c.pop();a.push(" ",Qn(e,b,c.join("")));b=e.h;a.push("\n");0==e.g&&c.push("|  ")}if(0!=this.i.da()){var f=B();a.push(" Unstopped timers:\n");ld(this.i,function(b){a.push("  ",b," (",f-b.startTime," ms, started at ",Sn(b.startTime),")\n")})}b=this.j.Ra();for(d=0;d<b.length;d++)c=this.j.get(b[d]),1<c.count&&a.push(" TOTAL ",c,"\n");a.push("Total tracers created ",0,"\n","Total comments created ",
0,"\n","Overhead start: ",0," ms\n","Overhead end: ",0," ms\n","Overhead comment: ",0," ms\n");return a.join("")};function Rn(a){a=Math.round(a);var b="";1E3>a&&(b=" ");100>a&&(b="  ");10>a&&(b="   ");return b+a}function Sn(a){a=Math.round(a);return String(100+a/1E3%60).substring(1,3)+"."+String(1E3+a%1E3).substring(1,4)}new Nn;/*
 Copyright 2012 YDN Authors, Yathit. All Rights Reserved.
 Licensed under the Apache License, Version 2.0 (the "License");.
*/
function Tn(a){a.p||(a.p=new Mc);return a.p}hm.prototype.removeEventListener=function(a,b,c,d){Hc(Tn(this),a,b,c,d)};hm.prototype.Za=function(a){Tn(this).dispatchEvent(a)};function Un(a,b,c){jm.call(this,a,b,c)}C(Un,Dn);R("ydn.gdata.base");function Vn(a){this.i=a||null;this.g=this.h=null;a&&Wn(this,a)}Vn.prototype.logger=R("ydn.crm.UserSetting");
var Xn={stores:[{name:"general"},{name:"sugar"}]},Yn={stores:[{name:"contact",keyPath:"id.$t",type:"TEXT",indexes:[{name:"updated.$t",type:"TEXT"},{name:"ydn$emails",multiEntry:!0,generator:function(a){var b=[];a=u(a.gd$email)?a.gd$email:A(a.gd$email)?[a.gd$email]:[];for(var c=0;c<a.length;c++){var d=ln(a[c].address);d&&b.push(d)}return b}},{name:"ydn$externalIds",multiEntry:!0,generator:function(a){return(u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:
[]).map(function(a){return a.value})}}]}]};function Wn(a,b){if(!a.i||a.i!=b){q.sessionStorage.setItem("last-user-id",b);var c=b+"-setting",d=b+"-gdata";a.h&&a.h.getName()!=c&&(bm(a.h),a.h=null);a.g&&a.g.getName()!=d&&(bm(a.g),a.g=null);a.h||(a.h=new Un(c,Xn));a.g||(a.g=new Un(d,Yn))}}function Zn(a){return a.i?a.i+"-sd":q.sessionStorage.getItem("last-user-id")+"-sd"}function $n(a){var b=Zn(a),c=new D;chrome.storage.local.get(b,function(a){c.C(a[b])});return c}
function ao(a,b){var c=Zn(a),d=new D,e={};e[c]=b;chrome.storage.local.set(e,function(){d.C(!0)})};function bo(){var a=new D;chrome.storage.sync.get("user-setting",function(b){a.C(b["user-setting"])});return a};function co(){}co.prototype.logger=R("ydn.crm.Client");function eo(a,b,c){this.client=a;this.g=b;this.h=c}eo.prototype.request=function(a){a=this.g.call(this.h,a);return this.client.request(a)};function fo(a,b,c){this.h=a;this.i=b;this.g=c}fo.prototype.request=function(a){return this.h(a)?this.i.request(a):this.g.request(a)};function go(a,b,c,d,e){this.l=t(a)?a:Vi();this.g=b;this.h=c;this.i=d||0;this.j=!!e}go.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new dj(a,this.l,this.i,this.j)};function ho(a,b,c){this.i=t(a)?a:Vi();this.g=b;this.h=c}ho.prototype.request=function(a){if(this.g){a.headers||(a.headers={});for(var b in this.g)a.headers[b]=this.g[b]}this.h&&(a.path=this.h+a.path);return new dj(a,this.i)};function jo(a){for(var b=Zl(a),c=0;c<b.stores.length;c++);b=(b=wk)||wk;b=im(a,b,!1,void 0,void 0,void 0);this.g=a.Dc(b,a.Va);this.j=!1;a.Sb(this.G,this);this.h=1E4;this.l=Xe.value;this.i=0;this.s=na(this.H,this);this.p=!1;this.o={}}function ko(a){if(a.h&&a.i>=a.h){var b=a.h/100;100<b&&(b=100);a.g.keys("db-logger",null,b).A(function(a){a=a.map(function(a){return new rk("db-logger",a)});this.g.remove(a).A(function(){this.g.count("db-logger").A(function(a){this.i=a},this)},this)},a)}}
function lo(){var a=mo;a.h=1E4;ko(a)}jo.prototype.G=function(){this.h&&(this.j=!0,this.g.count("db-logger").A(function(a){this.i=a;ko(this)},this))};function no(a){var b=mo;if(a!=b.p){var c=ef();a?$e(c,b.s):(c=c.g)&&Za(c,b.s);b.p=a}}jo.prototype.H=function(a){if(this.j){var b=a.h;sa(b,"ydn.db.")||this.o[b]||!(b=a.j)||b.value<=this.l||(a={exception:a.g,level:b.value,logger:a.h,name:b.name,time:a.l,message:a.getMessage(),seq:a.o},this.g.put("db-logger",a),this.i++,ko(this))}};
function oo(a,b){var c=mo,d=a||100,e=b||0,f=mj(["INFO"]);return c.g.values("db-logger","name, time",f,d,e,!0)}var mo=null;var po,qo,ro=R("ydn.crm");function so(){po||(po=new Zf(0));return po}var to=null;function uo(a,b){b&&"local"!=b||(t(a["logging-captureConsole"])&&ki(!!a["logging-captureConsole"]),t(a["logging-bugReport"])&&no(!!a["logging-bugReport"]))}
function vo(){var a;a="Yathit CRM Bridge ydn.crm.version 0.7.23 (dev)";Li("ydn.crm","fine");Li("ydn.crm.inj.App","finest");Li("ydn.ds","fine");q.console.log(a);q.console.log("API documentation: http://dev.yathit.com/\nFeedback and suggestion: https://yathit.uservoice.com/\nBug report: https://github.com/yathit/sugarcrm-gmail-chrome-extension");to=new Un("ydn.crm",{stores:[{name:"log",keyPath:"key"},{name:"db-logger",autoIncrement:!0,indexes:[{name:"level"},{name:"time"},{name:"name"},{name:"name, time",
keyPath:["name","time"]}]}]});mo=new jo(to);lo();mo.l=300;mo.o["ydn.db.tr.DbOperator"]=!0;no(!0);ro.info("Starting ydn.crm.App:0.7.23");chrome.storage.local.get(["logging-captureConsole","logging-bugReport"],uo);chrome.storage.onChanged.addListener(uo);var b=B();cj=Mi=new wo(to,function(a){if(!a||a.HttpRequestData&&"https://mail.google.com/mail/feed/atom/bazinga"==a.HttpRequestData.path)return null;a.uptime=b;return a})}
function xo(a){a=new fj(a,po,!1);Ui(a,"gc");yo();Ui(new fo(function(a){return"GET"==a.method},a,new eo(a,function(a){a.path="https://yathit-app.appspot.com/proxy/"+a.path;return a})),"gse")}function yo(){var a=Zh("proxy");a||(a=new go(so(),void 0,"https://yathit-app.appspot.com/proxy/",0,!0),Ui(a,"proxy"))}function zo(){var a=Zh("auth");a||(a=new go(so(),void 0,"https://yathit-app.appspot.com/a/cm",0,!0),Ui(a,"auth"));return a};function Ao(a,b){this.j=b||B();this.type=a;this.i=this.g=this.h=void 0}function Bo(a,b){A(b)?a.h=Ul(b):a.h=b}Ao.prototype.toJSON=function(){return{type:this.type,timestamp:this.j,newValue:this.g,oldValue:this.h,meta:this.i}};function Co(a){this.g=a}Co.prototype.add=function(a){this.g.add("history",a.toJSON())};function Do(a,b){if(a.link){if(u(a.link)){for(var c=0;c<a.link.length;c++)if(a.link[c].rel==b)return a.link[c];return null}return a.link.rel==b?a.link:null}return null};function Eo(a,b){this.entry=a;this.data=b;this.g=!1}Eo.prototype.data=null;Eo.prototype.preventDefault=function(){this.g=!0};function Fo(a,b,c,d){K.call(this,a,b);this.status=c;this.entry=d}C(Fo,K);Fo.prototype.status=NaN;Fo.prototype.O=function(){return this.status};Fo.prototype.Bb=function(){return this.entry.Bb()};function Go(a,b,c){Fo.call(this,"conflict",a,b,c.entry)}C(Go,Fo);function Ho(a,b){this.g=a;if(b)throw new Oc("optional key paths");}var Io={ii:"key",fi:"date",ji:"modified",hi:"expires",gi:"etag",ki:"updated",li:"uri",NEXT:"next"};Ho.prototype.S=function(a,b){return b&&this.g[a]?uj(b,this.g[a]):void 0};function Jo(a,b,c,d){a.g[b]&&vj(c,a.g[b],d)};function Ko(a,b,c,d){this.key=a;this.h=(this.h=d?b[d]:b)||{};this.g=c}function Lo(a){return null!=a.key?a.key:a.g.S("key",a.h)}Ko.prototype.getDate=function(){return this.g.S("date",this.h)};function Mo(a){return a.g.S("updated",a.h)}function No(a){return a.g.S("etag",a.h)}function Oo(a){var b={},c=No(a);c&&1<c.length?b["if-none-match"]=c:(a=Mo(a))&&(b["if-modified-since"]=a);return b}
Ko.prototype.toJSON=function(){var a={};Jo(this.g,"key",a,Lo(this));var b=this.getDate();b&&Jo(this.g,"date",a,b);(b=this.g.S("expires",this.h))&&Jo(this.g,"expires",a,b);(b=Mo(this))&&Jo(this.g,"updated",a,b);(b=No(this))&&Jo(this.g,"etag",a,b);return a};function Po(a,b,c){b.expires&&Jo(c,"expires",b,(new Date(b.expires)).getTime());b["last-updated"]&&Jo(c,"updated",b,(new Date(b["last-updated"])).getTime());b.etag&&Jo(c,"etag",b,(new Date(b.etag)).getTime());Jo(c,"date",b,NaN);Ko.call(this,a,b,c)}C(Po,Ko);function Qo(a,b,c){this.g=a;this.o=c||null;this.i=this.h=null;this.key=b}h=Qo.prototype;h.logger=R("ydn.db.sync.entry.Rest");h.Bb=function(){if(this.i&&this.g.p&&this.j){var a=this.g.s;this.g.V||delete this.i[a]}return this.i||null};h.S=function(){return this.o};h.F=function(){return this.key};h.qe=function(){return this.g.hf(this.F())};function Ro(a,b){var c=a.F();return new Po(c,b.Vc(),a.g.o)}
h.Le=function(a,b){if(a)return a;if(b.Ga())return aj(b);try{return aj(b)}catch(c){var d=Yi(b);return A(d)?d:{body:d}}};h.save=function(a){var b=this.F();if(a&&!this.g.p)return B(),So(this.g,[this.j.toJSON()]);var c=this.i;if(a&&!c)return tb();a=void 0;null!=this.j&&(B(),a=[this.j.toJSON()]);return To(this.g,[c],a,[b])};
h.mc=function(a,b){if(this.g.H&&A(this.h))a.call(b,304),a=null;else{var c=this;Uo(this,function(d){if(d){var e=d.g.S("expires",d.h);if(e&&e>B()){Q(this.logger,this+" not expired");a.call(b,304);a=null;return}}e=c.qe();d=c.jc(e,"GET",d);this.g.va().request(d).execute(function(d,e){c.j=Ro(c,e);c.i=c.Le(d,e);a.call(b,e.O());a=null})},this)}};
h.jc=function(a,b,c,d){a=new ai(a,b);if(c){var e;"POST"==a.method||"PUT"==a.method||"DELETE"==a.method?(e={},(b=Mo(c))&&(e["if-unmodified-since"]=b),(c=No(c))&&1<c.length&&(e["if-match"]=c),c=e):c=Oo(c);e=c;a.headers?qc(a.headers,e):a.headers=e}a.body=A(d)?JSON.stringify(d):d;Q(this.logger,this+" "+a.method+" "+a.path+" "+xh(e));return a};
function Vo(a,b,c){Uo(a,function(a){var e=this.S();a=this.jc(this.qe(),"PUT",a,e);this.g.va().request(a).execute(function(a,d){this.j=Ro(this,d);this.i=a;b&&(b.call(c,d.O()),b=null)},this)},a)}function Uo(a,b,c){a.l?b.call(c,a.l):Wo(a.g,a.F(),function(d){a.l=d;b.call(c,d)})}
h.load=function(a,b){if(this.h&&this.l)a&&(a.call(b,this.h,this.l),a=void 0);else{var c=this.F();this.g.load(c,function(c,e){this.h=c;var f=this.g.s;this.h&&f&&this.h[f]&&(this.l=new Ko(this.key,this.h,this.g.o,f),this.g.V||delete this.h[f]);this.h=c;this.l=e;a&&(a.call(b,c),a=void 0)},this)}};function Xo(a,b){var c=a.qe(),d=a.g.va();Uo(a,function(a){a=this.jc(c,"DELETE",a);d.request(a).execute(function(a,d){Q(this.logger,"deleted "+c+" "+d.O());b.call(this,d.O())},this)},a)}
h.toString=function(){return"sync.entry{"+this.g.J()+":"+this.key+"}"};function Yo(a,b,c){this.storage=a;this.store=b;this.P=b.getName();a="format readRequestTimeout writeRequestTimeout transport Options fetchStrategies baseUri immutable keepMeta metaStoreName metaDataName prefetch prefetchRefractoryPeriod".split(" ");for(var d in c)if(-1==Pa(a,d))throw new L('Unknown Sync attribute "'+d+'"  in Sync.');this.H=!!c.immutable;this.h=c.baseUri;this.Hb=c.metaStoreName||this.P;this.s=c.metaDataName;this.p=this.Hb==this.P;a=c.Options||{};if(!this.Hb)throw new L("metadata store name required.");
b=this.zb();for(d in a)if(-1==Pa(b,d))throw new L('Unknown Sync.Options attribute "'+d+'" in Sync.Options');this.oa=a.delimiter||"";this.j=a.prefix||"";this.V=!!c.keepMeta;this.M=c.prefetch||y(c.prefetchRefractoryPeriod)?"full":null;this.fa=y(c.prefetchRefractoryPeriod)?c.prefetchRefractoryPeriod:5E3;this.g=Zo(c.transport);this.o=new Ho(this.yb(),c.metaData);this.l=null;this.G=NaN}h=Yo.prototype;h.yb=function(){var a={},b;for(b in Io)a[b]=b;return a};h.zb=function(){return[]};h.J=function(){return this.P};
h.logger=R("ydn.db.sync.Rest");h.Mb=function(){return this.h};h.va=function(){this.g||(this.g=new ho);return this.g};h.toString=function(){return"sync:"+this.P};function So(a,b){return hl(a.storage.g,a.Hb,b).Mc(function(a){throw a;})}function $o(a,b,c){a.store.keyPath&&null==Zk(a.store,b)&&null!=c&&vj(b,a.store.keyPath,c)}
function To(a,b,c,d){d=a.store.keyPath?void 0:d;if(c){if(a.p){for(g=0;g<b.length;g++)null!=c[g]&&qc(b[g],c[g]);return hl(a.storage.g,a.P,b,d)}if(b){for(var e=[],f=b.concat(c),g=0;g<b.length;g++){var k=a.store.keyPath?NaN:d[g];e.push(new rk(a.P,k))}for(g=0;g<c.length;g++)e.push(new rk(a.Hb,NaN));return hl(a.storage.g,e,f)}return hl(a.storage.g,a.Hb,c)}for(g=0;g<b.length;g++)k=d?d[g]:void 0,$o(a,b[g],k);return hl(a.storage.g,a.P,b,d)}
function ap(a,b){var c=[new rk(a.P,b)];a.p||c.push(new rk(a.Hb,b));return il(a.storage.g,c)}h.hf=function(a){return this.Mb()+a};h.add=function(a,b,c){null!=c?$o(this,b,c):this.store.keyPath&&(c=Zk(this.store,b));var d=this.Aa(c,b),e=this;Vo(d,function(a){201==a||200==a?(Q(e.logger,d+" created"),d.save(!0)):M(e.logger,"Unexpected respond "+a+" for add "+d)})};
function Wo(a,b,c){var d=new rk(a.Hb,b);bp(a,[d]).u(function(a){c.call(void 0,new Ko(b,a[0],this.o,this.s))},function(a){M(this.logger,this+" error loading meta data "+a);c.call(void 0,null)},a)}h.Yd=function(a,b){var c=a.map(function(a){return new rk(this.Hb,a)});bp(this,c).u(function(c){for(var e=[],f=0;f<a.length;f++)e[f]=new Ko(a[f],c[f],this.o,this.s);b(e)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)};
h.load=function(a,b,c){var d=this.Hb,e=[new rk(this.J(),a)];this.p||e.push(new rk(d,a));bp(this,e).u(function(d){var e=d[0];b.call(c,e,new Ko(a,this.p?e:d[1],this.o,this.s))},function(a){M(this.logger,this+" error loading meta data "+a);b.call(c,null,null)},this)};function bp(a,b){return ll(a.storage.g,b)}
h.get=function(a,b){this.G||this.ac();ek(a,function(c,d,e){if(d)e(c,d);else{Tc(a,c);var f=t(c);if(f&&this.H)e(c);else{var g=this.Aa(b,c);g.mc(function(a){if(304==a){if(e(c),!f)throw new Rc(g+" not modified, but not exist in server");}else if(200==a)g.save().ca(function(){e(g.Bb())});else if(404==a)ap(g.g,g.F()).ca(function(){e(g.Bb())});else throw e(g.Bb()),new Qc("Invalid HTTP respond "+a+" for GET "+b);},this)}}},this)};
function cp(a,b,c,d,e,f){var g=[],k=a.logger;P(a.logger,d.length+", "+e.length+", "+f.length+", "+g.length+" records to fetch, update, delete, save");var l=d.length+e.length+f.length+g.length;if(0==l)b(c);else{for(var m=!1,n=function(){l--;0==l&&(b(c,m),b=null)},g=0;g<d.length;g++){var p=a.Aa(d[g]);p.index=g;p.mc(function(a){200==a?(Q(k,"A new "+this+" received from server"),this.save().u(function(){c[this.index]=this.Bb();n()},function(){m=!0;n()},this)):304==a?this.save(!0).u(function(){Q(k,this+
" expires date updated");n()},function(){m=!0;n()},this):(M(k,"Invalid status "+a+" for fetching "+this),n())},p)}for(g=0;g<e.length;g++)p=a.Aa(e[g]),p.index=g,p.load(function(){this.mc(function(a){200==a?(Q(k,this+" updated from server"),this.save().u(function(){c[this.index]=this.Bb();n()},function(){m=!0;n()},this)):(M(k,"Invalid status "+a+" for fetching "+this),n())})});for(g=0;g<f.length;g++)p=a.Aa(f[g]),p.index=g,ap(p.g,p.F()).u(function(){c[this.index]=new Eo(p,null);n()},function(){m=!0;
n()},p)}}function dp(a,b,c){ek(b,function(a,e,f){if(e)f(a,e);else if(Ua(a,function(a){return t(a)})&&this.H)f(a);else{Tc(b,a);var g=a.length;for(e=0;e<c.length;e++)if(this.H&&t(a[e]))g--,0==g&&f(a);else{var k=this.Aa(c[e],a[e]);k.index=e;k.mc(function(b){200==b?(a[this.index]=this.Bb(),this.save()):404==b&&(a[this.index]=void 0);g--;0==g&&f(a)},k)}}},a)}h.Aa=function(a,b){return new Qo(this,a,b)};h.count=function(a){return a};h.nf=function(){throw new Oc;};
h.values=function(a,b,c){ep(this)?(Q(this.logger,"prefetch queued"),ek(a,function(d,e,f){Tc(a,d);e?f(d,e):fp(this,function(a){a?kl(this.storage.g,this.P,null,null,!1,b,c).u(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(){M(this.logger,this+" prefetch fail");f(d)},this)},this)):this.nf(a,b,c)};
h.keys=function(a,b,c,d,e,f,g){ek(a,function(k,l,m){Tc(a,k);l?m(k,l):fp(this,function(a){a?ml(this.storage.g,this.P,b,c,d,e,f,g).u(function(a){m(a)},function(a){m(a,!0)},this):m(k)},function(){M(this.logger,this+" prefetch fail");m(k)},this)},this)};h.Je=function(){};
h.put=function(a,b,c){c=t(c)?c:this.store.keyPath?Zk(this.store,b):null;var d=this.Aa(c,b);V(a,function(){d.load()},this);ek(a,function(c,f,g){Tc(a,c);Vo(d,function(c){409==c?d.mc(function(){var c=new Eo(d,b);Tc(a,c);c.g?g(null,f):g(void 0,f)}):200==c||201==c?(d.save(!0),g(b,f)):(M(this.logger,"Unexpected response for PUT: "+c),g(null,f))},this)},this)};
h.remove=function(a,b){var c=this,d=this.Aa(b);d.load(function(){ek(a,function(e,f,g){Xo(d,function(f){if(409==f){f=new Eo(d,null);Tc(a,f);var l=new Go(c.storage,409,f);c.storage.Za(l)}else 200==f?Q(c.logger,"Successfully deleted object "+b):(M(c.logger,"Unexpected response for DELETE: "+f+" "+b),Tc(a,l));g(e)})})})};
h.ac=function(){Q(this.logger,this+" starting prefetch");var a=new D;kl(this.storage.g,this.P,"updated.$t",null,!0,1).u(function(b){var c={};if(b=b[0])b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b;var d=this,c=new ai(this.Mb(),"GET",c);d.va().request(c).execute(function(b,c){if(200==c.O()){if(!b){var g=Yi(c);x(g)&&(b=JSON.parse(g))}g=(g=(b.feed||b).entry)?u(g)?g:[g]:[];0<g.length?To(d,g).ca(function(){a.C(!0)}):a.C(!1)}else 302==c.O()?a.C():(g=d+": Invalid response status "+
c.O()+" on prefetching",M(d.logger,g),a.D(Error(g)))})},function(b){a.D(b)},this);return a};function ep(a){return a.M?a.G?B()-a.G>a.fa:!0:!1}function fp(a,b,c,d){ep(a)?a.l?a.l.u(b,c,d):(a.l=a.ac(),a.G=B(),a.l.u(b,c,d),a.l.u(function(a){Q(this.logger,"prefetch "+(a?"updated":"no update"));this.l=null},function(a){this.l=null;throw a;},a)):b.call(d,!1)};function gp(a,b,c){Yo.call(this,a,b,c)}C(gp,Yo);gp.prototype.logger=R("ydn.db.sync.Atom");gp.prototype.zb=function(){return gp.m.zb.call(this)};gp.prototype.F=function(a){return a.key};function hp(a){this.data=a}h=hp.prototype;h.F=function(){return this.data.id.$t};h.ld=function(){return this.data.title?this.data.title.$t:void 0};h.le=function(a){return Do(this.data,a)};h.Yh=function(){var a=this.le("self");return a?a.href:void 0};h.Xh=function(){var a=this.le("http://schemas.google.com/g/2005#batch");return a?a.href:""};h.pa=function(){return this.data.content||null};function ip(a,b,c){Qo.call(this,a,b,c)}C(ip,Qo);ip.prototype.logger=R("ydn.db.sync.entry.S3");ip.prototype.getName=function(){return this.g.j+this.key};ip.prototype.jc=function(a,b,c,d){b=ip.m.jc.call(this,a,b,c,d);if("PUT"==b.method||"POST"==b.method){c=Gd(new td(a)).substr(1);if(1>c.length)throw new Qc("invalid url "+a);b.headers.Key=c;a=b.headers["Content-Type"]||"application/json";d instanceof File?a=d.type:x(d)&&(a=/<*DOCTYPE html/i.test(d)?"text/html":"text/plain");b.headers.ContentType=a}return b};function jp(a){this.data=a}C(jp,hp);var kp={atom:"http://www.w3.org/2005/Atom",ydn:"http://www.yathit.com/2012/ydn",app:"http://www.w3.org/2007/app",openSearch:"http://a9.com/-/spec/opensearch/1.1/",gAcl:"http://schemas.google.com/acl/2007",sites:"http://schemas.google.com/sites/2008",gs:"http://schemas.google.com/spreadsheets/2006",dc:"http://purl.org/dc/terms",batch:"http://schemas.google.com/gdata/batch",gd:"http://schemas.google.com/g/2005",gContact:"http://schemas.google.com/contact/2008",thr:"http://purl.org/syndication/thread/1.0",
xhtml:"http://www.w3.org/1999/xhtml"};function lp(a,b){for(var c=a.indexOf(" "),d=0;d<b.length;d++){var e=b[d],e=(0==d?"xmlns":"xmlns:"+e)+'="'+kp[e]+'"';-1==a.indexOf(e)&&(a=a.substring(0,c+1)+e+" "+a.substr(c+1))}return a}R("ydn.xml");function mp(a){return kp[a]||kp.xhtml};function np(a,b,c){c=!!c;if(a.getName()!=b.getName())return!1;var d=op(a),e=op(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;for(d=0;d<e.length;d++)if(a.getAttribute(e[d])!=b.getAttribute(e[d]))return!1;d=pp(a);e=pp(b);if(!c&&d.length!=e.length||c&&e.length>d.length)return!1;if(0==d.length||0==d.length)return a.data.$t===b.data.$t;for(d=0;d<e.length;d++){var f=qp(a,e[d]),g=qp(b,e[d]);if(!c&&f.length!=g.length||c&&g.length>f.length)return!1;for(var k=0;k<g.length;k++)if(-1==Wa(f,function(a){return np(a,
g[k],c)}))return!1}return!0};function rp(a,b,c){if(t(b))sp(this,b),t(c)||(c=a[b]);else for(var d in a)if(a.hasOwnProperty(d)&&A(a[d])&&x(a[d].xmlns)){this.od=[d].xmlns;sp(this,d);c=a[d];break}this.data=c;this.parent=a}h=rp.prototype;h.od="http://www.w3.org/2005/Atom";function sp(a,b){var c=b.split(":");1<c.length&&(a.od=mp(c[0])||rp.prototype.od,b=c[1]);a.tagName=b}
h.n=function(a,b){var c;c=a;var d=b,e=c;if(t(d))"atom"!=d&&(e=d+"$"+c);else{var f=c.split(":"),e=c.replace(/:/,"$");2==f.length&&(d=f[0],c=f[1])}d=t(d)?mp(d):void 0;c=t(this.data[c])&&t(d)&&this.data[c].xmlns==d?c:e;return u(this.data[c])?new rp(this.data,c,this.data[c][0]):A(this.data[c])?new rp(this.data,c,this.data[c]):null};h.toString=function(){return"JsonElement:"+this.tagName};h.getName=function(){return this.tagName};
function tp(a,b){for(var c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&delete a.data[c];a.data.$t=b}h.getAttribute=function(a){a=a.replace(/:/,"$");return this.data[a]};h.setAttribute=function(a,b){a=a.replace(/:/,"$");this.data[a]=b};h.removeAttribute=function(a){a=a.replace(/:/,"$");delete this.data[a]};function op(a){var b=[],c;for(c in a.data)a.data.hasOwnProperty(c)&&x(a.data[c])&&"$t"!=c&&b.push(c);return b}
function qp(a,b){t(void 0)?b="undefined$"+b:t(b)&&(b=b.replace(/:/,"$"));var c=[];if(t(b)){var d=a.data[b];if(u(d))for(var e=0;e<d.length;e++)c.push(new rp(a.data,b,d[e]));else A(d)&&c.push(new rp(a.data,b,d))}else for(d in a.data)if(u(a.data[d]))for(e=0;e<a.data[d].length;e++)c.push(new rp(a.data,d,a.data[d][e]));else A(a.data[d])&&c.push(new rp(a.data,d,a.data[d]));return c}function pp(a){var b=[],c;for(c in a.data)A(a.data[c])&&b.push(c.replace("$",":"));return b}
h.appendChild=function(a){var b=a.getName();this.data[b]?(u(this.data[b])||(this.data[b]=[this.data[b]]),this.data[b].push(Ul(a.data))):this.data[b]=Ul(a.data)};
h.update=function(a,b,c,d,e){var f=!1;c=c||{};var g=t(b),k=!0===b||!g,l=!1===b,m=op(this),n=op(a);if(!g)for(var p=0;p<m.length;p++)t(e)&&!e[m[p].replace("$",":")]||Xa(n,m[p])||(this.removeAttribute(m[p]),f=!0);for(p=0;p<n.length;p++){var r=a.getAttribute(n[p]);if(!t(e)||e[n[p].replace("$",":")])Xa(m,n[p])?l||r==this.getAttribute(n[p])||(this.setAttribute(n[p],r),f=!0):(this.setAttribute(n[p],r),f=!0)}if(0==up(a)&&k&&(e=this.data.$t,l=a.data.$t,t(l)&&e!=l))return tp(this,l),!0;if(!g)for(var s in this.data)d&&
!d[s.replace("$",":")]||!A(this.data[s])||A(a.data[s])||(delete this.data[s],f=!0);s=pp(a);for(e=0;e<s.length;e++)if(l=s[e],!d||!0==d[l]){var w=qp(a,l),m=qp(this,l),z=l.replace(":","$");if(1==w.length)0==m.length?(this.data[z]=Ul(w[0].data),f=!0):1==m.length?c[l]?k&&!np(m[0],w[0],!0)&&(u(this.data[z])||(this.data[z]=[this.data[z]]),this.data[z].push(Ul(w[0].data)),f=!0):f=m[0].update(w[0],b)||f:g?(l=Wa(m,function(a){return np(a,w[0],!0)}),-1==l&&k&&(this.data[z].push(Ul(w[0].data)),f=!0)):(this.data[z]=
Ul(w[0].data),f=!0);else if(!u(this.data[z]))if(k)this.data[z]=Ul(a.data[z]),f=!0;else{if(g){var m=Ul(a.data[z]),G=this,l=Wa(m,function(a){return Cl(G.data[z],a)});-1==l&&(m.push(this.data[z]),this.data[z]=m,f=!0)}}else if(k)for(m.length>w.length&&(this.data[z].splice(w.length,m.length-w.length),f=!0),p=0;p<w.length;p++)t(m[p])?Cl(m[p].data,w[p].data)||(this.data[z][p]=Ul(w[p].data),f=!0):(this.data[z][p]=Ul(w[p].data),f=!0);else if(g)for(p=0;p<a.data[z].length;p++)l=Wa(this.data[z],function(b){return Cl(a.data[z][p],
b)}),-1==l&&(this.data[z].push(Ul(a.data[z][p])),f=!0)}return f};h.of=function(a,b,c,d,e){t(b)||(b=!1);return this.update(a,b,c,d,e)};h.toJSON=function(){return{data:this.data,tagName:this.tagName}};
function vp(a){function b(a,g){d(g,a);var k,l;for(l in a)if(a.hasOwnProperty(l)&&!x(a[l]))if(x(a[l].$t)&&"xhtml"==a[l].type){k=c(l);d(k,a[l]);var m=Bh(a[l].$t);e.importNode(m.documentElement,!0);k.appendChild(m.documentElement);g.appendChild(k)}else if(x(a[l].$t))k=c(l),k.textContent=a[l].$t,d(k,a[l]),g.appendChild(k);else if(u(a[l])&&a[l][0]&&x(a[l][0].$t))for(m=0;m<a[l].length;m++)k=c(l),k.textContent=a[l][m].$t,d(k,a[l][m]),g.appendChild(k);else if(u(a[l]))for(m=0;m<a[l].length;m++)k=c(l),g.appendChild(k),
b(a[l][m],k);else A(a[l])&&(k=c(l),g.appendChild(k),b(a[l],k))}function c(a){return e.createElement(a.replace("$",":"))}function d(a,b){for(var c in b)b.hasOwnProperty(c)&&"$t"!=c&&x(b[c])&&a.setAttribute(c.replace("$",":"),b[c])}var e=zh(a.getName(),a.od);b(a.data,e.documentElement);return Ch(e.documentElement)}
function up(a){function b(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&(u(a[c])?b+=a[c].length:A(a[c])&&b++);return b}var c;t(void 0)?c="undefined$"+c:t(c)&&(c=c.replace(/:/,"$"));return t(c)?u(a.data[c])?a.data[c].length:A(a.data[c])?b(a.data[c]):0:b(a.data)}h.ga=function(a){var b={};if(t(a))for(var c in this.data){var d=c.replace("$",":");x(this.data[c])?b[c]=this.data[c]:!0==a[d]&&(b[c]=Ul(this.data[c]))}else b=Ul(this.data);return new rp(null,this.tagName,b)};
function wp(a,b){var c=b.ownerDocument.createElementNS(a.od,a.getName()),d;for(d in a.data)if(a.data.hasOwnProperty(d)){var e=d.replace("$",":");if(x(a.data[d]))"$t"==d?c.textContent=a.data[d]:(e=c.ownerDocument.createAttribute(e),e.nodeValue=a.data[d],c.setAttributeNode(e));else if(u(a.data[d]))for(var f=0;f<a.data[d].length;f++){var g=new rp(a.data[d],e,a.data[d][f]);wp(g,c)}else A(a.data[d])&&(g=new rp(a.data,e,a.data[d]),wp(g,c))}return b.appendChild(c)};function xp(a){var b;if(t(a.id))b=a.id.$t;else if(t(a.batch$id))b=a.batch$id.$t;else if(t(a.g))b=a.g.$t;else throw new Dh("id or batch:id required.");this.id=b;this.h=void 0;this.data=a}C(xp,jp);h=xp.prototype;h.logger=R("ydn.gdata.Entry");h.Ff=function(){return this.kind};h.ld=hp.prototype.ld;h.F=function(){return this.id};function yp(a){return a.id.match(/\w+$/)[0]}h.sc=["link","category"];h.mg=["id","batch$id","link","category"];h.pa=hp.prototype.pa;
function zp(a,b){if(b)a.data.status=""==b?void 0:b;else{var c=a.data;c.status&&(c.status=b)}}function Ap(a){return t(a.gd$deleted)?"gd:deleted":(a=a.status)?a:""}function Bp(a){return"gd:deleted"==Ap(a.data)}h.setTitle=function(){throw new Fh;};
h.Oc=function(){if(!Cp(this.data))throw Error("nothing to commit");var a=new D;Dp(this,function(b,c){if(c.Ga())a.C(b);else{var d=Yi(c);if(x(d)&&/html/.test(Zi(c)))try{var e=(new DOMParser).parseFromString(d,"text/html");e.body&&(d=e.body.innerHTML)}catch(f){}a.D(c.O()+" "+c.Ma()+" "+d)}},this);return a};
function Dp(a,b,c){var d=Zh("gse");if(Cp(a.data)){var e={"Content-Type":"application/atom+xml"};a.g&&(e["GData-Version"]=a.g);var f={},g="POST",k,l,m;m="full";t(l)||(l="base"!=m);var n=a.kind||"contact";k=k?"/"+k:"";k=(l?"https":"http")+"://www.google.com/m8/feeds/"+n+"s/"+a.user_id.replace("@","%40")+"/"+m+k;k=k.replace("%40","@");if(l=(l=a.le("edit"))?l.href:void 0)g="delete"==Ap(a.data)?"DELETE":"PUT",k=l;try{var p=Ep(a)}catch(r){Ni({"class":"ydn.gdata.Entry",method:"ydn.gdata.Entry.commit","entry.data":a.data,
context:"toXmlString",error:{name:r.name,message:r.message,stack:r.stack}})}l=a.type;m=["atom","app","gd","batch","ydn"];if("sites"==l||"site"==l||"content"==l||"webpage"==l)m=m.concat("xhtml","sites");else if("m8"==l||"contact"==l)m=m.concat("gContact");p=lp(p,m);xp.g&&(a.h=[k,f,g,e,p]);d.request(new ai(k,g,f,e,p)).execute(b,c)}else P(a.logger,a+" commit ignore since not modified."),b&&b.call(c,null,null)}function Cp(a){if(null==a.id)return!0;a=Ap(a);return"modified"===a||"delete"===a}h.Ke=function(){return this.data};
function Ep(a){var b=new rp(null,"entry",a.Ke()),c=!1;b.xmlns||(b.xmlns="http://www.w3.org/2005/Atom",c=!0);var d=["atom"],e;for(e in a.data)if(a=e.match(/^(\w+)\$\w+/))a=a[1],a in kp&&(Xa(d,a)||d.push(a));e=vp(b);c&&delete b.xmlns;return lp(e,d)}h.update=function(a){var b=["batch$status","batch$operation","status"],c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Xa(b,c)&&!Xa(this.mg,c)&&(this.data[c]=a.data[c])};h.pf=function(a,b){if(Cl(this.data[a],b))return!1;this.data[a]=Ul(b);return!0};
h.of=function(a){if(a.data.updated.$t>=this.data.updated.$t&&Bp(a)){if(Bp(this)||"delete"==Ap(this.data))return!1;zp(this,"delete");return!0}var b=!1,c;for(c in a.data)a.data.hasOwnProperty(c)&&A(a.data[c])&&!Xa(this.mg,c)&&this.pf(c,a.data[c])&&(b=!0);b&&(a=Ap(this.data),"delete"==a?M(this.logger,this+" marked for deletion. Cannot mark modify flag."):"committed"==a?this.logger.log(Re,this+" already committed. All changes must wait until updated from the server.",void 0):zp(this,"modified"));return b};function Fp(a,b,c){Qo.call(this,a,b,c)}C(Fp,Qo);Fp.prototype.qe=function(){return this.key};Fp.prototype.jc=function(a,b,c,d){a=Fp.m.jc.call(this,a,b,c,d);this.g.Ag(a.method)&&q.gapi&&q.gapi.auth&&(b=gapi.auth.getToken())&&b.access_token&&(a.headers.Authorization=b.token_type+" "+b.access_token);if("GET"==a.method)a.params.alt="json";else if("PUT"==a.method||"POST"==a.method)d=new xp(d),a.body=Ep(d),a.headers["Content-Type"]="application/atom+xml";return a};
Fp.prototype.Le=function(a,b){a=Fp.m.Le.call(this,a,b);a.feed&&(a=a.feed);a.entry&&(a=a.entry);return a};function Gp(a,b,c){Yo.call(this,a,b,c);a=c.Options;this.kind=a.kind;this.version=a.version;this.projection=a.projection;this.i=a.maxResults}C(Gp,gp);h=Gp.prototype;h.projection=null;h.version=null;h.logger=R("ydn.db.sync.GData");h.Aa=function(a,b){return new Fp(this,a,b)};h.yb=function(){var a=Gp.m.yb.call(this);a.key=["id","$t"];a.etag="gd$etag";a.updated=["updated","$t"];return a};h.zb=function(){var a=Gp.m.zb.call(this);return a=a.concat(["version","projection","kind","maxResults"])};
h.Mb=function(){return"https://www.googleapis.com/"+this.kind+"/"};h.Ag=function(){return!1};h.F=function(a){return a?a.id?a.id.$t:"":""};
function Hp(a,b,c){var d=c||a.Mb();c&&Q(a.logger,"continuing "+c);b=new ai(d,"GET",b);var e=new D;a.va().request(b).execute(function(b,d){if(200==d.O()){if(!b){var k=Yi(d);x(k)&&(b=JSON.parse(k))}var k=b.feed||b,l=k.entry,l=l?u(l)?l:[l]:[];0<l.length&&To(a,l);for(var l=null,k=k.link,k=u(k)?k:[k],m=0;m<k.length;m++)"next"==k[m].rel&&(l=k[m].href);l?qb(Hp(a,{},l),e):(Q(a.logger,"prefetch "+a.P+" done"),e.C(!!c))}else 302==d.O()?e.C():(k=a+": Invalid response status "+d.O()+" on prefetching",M(a.logger,
k),e.D(Error(k)))});return e}h.ac=function(){Q(this.logger,"starting prefetch");var a=new D;kl(this.storage.g,this.P,"updated.$t",null,!0,1).A(function(b){var c={alt:"json",kind:this.kind};this.i&&(c["max-results"]=this.i);(b=b[0])?(b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),c["updated-min"]=b,Q(this.logger,this.P+" fetching entries later then "+b)):Q(this.logger,this.P+" fetching entries from beginning");qb(Hp(this,c),a)},this);return a};
h.count=function(a){var b=Nj(this.store,"updated.$t");if(!b)return a;var c=ck(a);a.u(function(a){Tc(c,a);kl(this.storage.g,this.P,b.getName(),null,!1,1).u(function(b){var f={alt:"json"};if(b=u(b)?b[0]:b)b=lc(b,"updated","$t"),b=(new Date(1+ +new Date(b))).toISOString(),f["updated-min"]=b;var g=this,f=new ai(this.Mb(),"GET",f);this.va().request(f).execute(function(b,e){if(200==e.O()){if(!b){var f=Yi(e);x(f)&&(b=JSON.parse(f))}f=lc(b.feed,"openSearch$totalResults");c.C(a+parseFloat(f||0))}else M(g.logger,
g+":Unexpected respond status "+e.O())})},function(a){c.D(a)},this)},function(a){c.D(a)},this);return c};function Ip(a,b,c){Qo.call(this,a,b,c)}C(Ip,Fp);function Jp(a,b,c){Gp.call(this,a,b,c);this.h=this.h.substr(27);this.Ub=c.Options.prefix}C(Jp,Gp);Jp.prototype.va=function(){this.g||(this.g=new Kp(gapi.client));return this.g};Jp.prototype.Aa=function(a,b){return new Ip(this,a,b)};Jp.prototype.Mb=function(){return this.h+this.Ub};
Jp.prototype.ac=function(){Q(this.logger,"starting prefetch");var a=new D;kl(this.storage.g,this.P,"updated",null,!0,1).u(function(b){var c={alt:"json"};if(b=b[0])b=lc(b,"updated"),b=(new Date(1+ +new Date(b))).toISOString(),c.updatedMin=b;var d=this,c=new ai(this.Mb(),"GET",c);d.va().request(c).execute(function(b,c){if(b){var g=b.items||[];0<g.length?To(d,g).ca(function(){a.C(!0)}):a.C(!1)}else 302==c.O()?a.C():(g=d+": Invalid response status "+c.O()+" on prefetching",M(d.logger,g),a.D(Error(g)))})},
function(b){a.D(b)},this);return a};function Lp(a,b){if(!t(q.AWS))throw new Qc("AWS JS SDK not loaded");this.h=a;this.i=b;this.g=null}Lp.prototype.request=function(a){return new Mp(this,a)};function Np(a){var b={params:{Bucket:a.h,region:a.i}};if(!a.h)throw new L("bucket name required");a.g||(a.g=new AWS.S3(b));return a.g}function Mp(a,b){this.parent=a;this.g=b}
function Op(a,b,c,d,e){var f=NaN,g="",k={};a=Np(a.parent)[b](c);a.on("complete",function(a){a.httpResponse&&(f=a.httpResponse.statusCode,x(f)&&(f=parseInt(f,10)),k=a.httpResponse.headers);a.error&&(g=a.error.message,f||(f=400))});a.send(function(a,b){var c=new Wi(f,b,k,g);a?d.call(e,null,c):d.call(e,b,c)})}
Mp.prototype.execute=function(a,b){var c=Gd(new td(this.g.path)),c="/"==c.charAt(0)?c.substr(1):c,d=this.g.headers||{};c&&(d.Key=c);if(c)if("GET"==this.g.method)Op(this,"getObject",d,a,b);else if("PUT"==this.g.method)Op(this,"putObject",d,a,b);else throw new Oc("HTTP method "+this.g.method);};function Pp(a,b){this.g=a;this.prefix=Qp(this,"Prefix")[0];this.h=b.type}Pp.prototype.da=function(){return this.g.documentElement.getElementsByTagName("Contents").length};Pp.prototype.keys=function(){var a=Qp(this,"Key");if(this.prefix){var b=this.prefix.length,a=a.map(function(a){return a.substr(b)});"INTEGER"==this.h?a=a.map(function(a){return parseInt(a,10)}):"NUMERIC"==this.h&&(a=a.map(function(a){return parseFloat(a)}))}return a};
function Qp(a,b){for(var c=[],d=a.g.documentElement.getElementsByTagName(b),e=d.length,f=0;f<e;f++)c[f]=d[f].textContent;return c}function Rp(a){return Qp(a,"LastModified").map(function(a){return(new Date(Date.parse(a))).toGMTString()})}
function Sp(a){var b=a.g.documentElement.getElementsByTagName("NextMarker");return 1==b.length?b[0].textContent:"true"==a.g.documentElement.getElementsByTagName("IsTruncated")[0].textContent&&(a=a.g.documentElement.firstElementChild.lastElementChild)&&"Contents"==a.tagName?a.getElementsByTagName("Key")[0]:null};function Tp(a,b,c){Yo.call(this,a,b,c);this.i=c.Options.bucket;if(!x(this.i)||va(this.i))throw new L("bucket name required.");this.h||(this.h="https://"+this.i+".s3.amazonaws.com/");if(!0===b.h)throw new L('S3 object store "'+b.getName()+'" must not set autoIncrement to true.');}C(Tp,Yo);h=Tp.prototype;h.logger=R("ydn.db.sync.S3");h.zb=function(){var a=Tp.m.zb.call(this);return a=a.concat(["bucket","maxKeys","prefix","delimiter"])};h.va=function(){this.g||(this.g=new Lp(this.i));return this.g};
h.hf=function(a){return this.h+this.j+a};h.Aa=function(a,b){return new ip(this,a,b)};
h.nf=function(a,b){var c=this;ek(a,function(d,e,f){Tc(a,d);c.Yd(d,function(a){var e={},l=a[0]?Lo(a[0]):null;null!=l&&(e.marker=l);0<c.j.length&&(e.prefix=c.j);0<b&&(e["max-keys"]=b);Q(c.logger,c+" querying for newer entries starting from "+l);e=new ai(c.h,"GET",e);c.va().request(e).execute(function(b,e){if(200==e.O()){for(var k=Yi(e),k=k instanceof Document?k:Bh(k),l=new Pp(k,c.store),k=l.keys(),l=Rp(l),s=[],w=[],z=[],G=0,E=0;G<=a.length&&E<k.length;){var J=a[G]?Lo(a[G]):null,N=k[E];if(G==a.length)w.push(N),
E++;else{var ja=J?sj(J,N):-1;0==ja?((N=Mo(a[G]))&&l[E]&&N!=l[E]&&(l[E]>N?z.push(J):M(c.logger,'record "'+J+'" in database is more recent than server '+N+" vs "+l[E])),G++,E++):1==ja?(s.push(J),G++):(w.push(N),E++)}}cp(c,f,d,w,z,s)}else M(c.logger,"Invalid response status "+e.O())})})},this)};
function Up(a,b){function c(f){null!=f&&(d.marker=f);Q(a.logger,a+" querying for newer entries starting from "+f);e.request(new ai(a.h,"GET",d)).execute(function(d,e){if(200==e.O()){var f=Yi(e),f=f instanceof Document?f:Bh(f),f=new Pp(f,a.store),m=Sp(f),f=f.keys(),n=f.length;if(0==n)b([]),b=null;else for(var p=0,r=0;r<n;r++)a.Aa(f[r]).mc(function(){p++;p==n&&(m?c(m):b&&(b([this.Bb()]),b=null))})}else M(a.logger,"Invalid response status "+e.O())})}var d={};0<a.j.length&&(d.prefix=a.j);var e=a.va();
c();a.Y=!0}function Vp(a,b){a.Y||ek(b,function(a,b,e){t(a[0])?e(a):Up(this,e)},a)};function Wp(a,b,c){Qo.call(this,a,b,c)}C(Wp,ip);Wp.prototype.logger=R("ydn.db.sync.entry.Gcs");function Xp(a,b,c){Tp.call(this,a,b,c);this.h="https://"+this.i+".storage.googleapis.com/"}C(Xp,Tp);Xp.prototype.logger=R("ydn.db.sync.Gcs");Xp.prototype.va=function(){this.g||(this.g=new ho);return this.g};Xp.prototype.Aa=function(a,b){return new Wp(this,a,b)};function Kp(a,b){this.h=a;this.g=!!b}Kp.prototype.request=function(a){var b={path:a.path,method:a.method,headers:a.headers,params:a.params,body:a.body};this.g&&(b.callback=function(a,e){c.C(a,e);b.callback=null});a=this.h.request(b);var c=new Yp(a);return c};function Yp(a){this.h=a||null}Yp.prototype.C=function(a,b){this.i&&(this.i(a,bj(b)),this.i=null);this.g={json:a,Gc:b}};
Yp.prototype.execute=function(a){this.h?(this.h.execute(function(b,c){a(b,bj(c))}),this.h=null):this.g?(a(this.g.json,bj(this.g.Gc)),this.g=null):this.i=a};function Zo(a){if(a){if(a instanceof ho)return a;if(ga(a))return new Kp({request:function(b){a(b)}},!0);if("request"in a)return new Kp(a);throw new L(a+" is not a valid HTTP Client");}return null};function Zp(a,b,c){Qo.call(this,a,b,c)}C(Zp,Wp);Zp.prototype.logger=R("ydn.db.sync.entry.GcsJson");Zp.prototype.mc=function(a){var b=this.g,c=this;Uo(this,function(d){var e={method:"GET",path:"storage/v1beta2/b/"+b.i+"/o/"+encodeURIComponent(c.getName())};d&&(e.headers=Oo(d));gapi.client.request(e).execute(function(d,e){var k=bj(e);c.j=new Po(c.F(),k.Vc(),b.o);d?(Q(c.logger,c+": readServer updated"),c.i=d):(Q(c.logger,c+": readServer request fail "+e),c.j=null,c.i=null);a.call(c,200)},e)})};function $p(a,b,c){Xp.call(this,a,b,c)}C($p,Xp);h=$p.prototype;h.logger=R("ydn.db.sync.GcsJson");h.yb=function(){var a=$p.m.yb.call(this);a.key="name";return a};h.va=function(){if(!this.g)if(t(q.gapi))this.g=new Kp(gapi.client);else throw new Qc("gapi not loaded");return $p.m.va.call(this)};h.Aa=function(a,b){return new Zp(this,a,b)};
h.ac=function(){P(this.logger,"starting prefetch");var a=new D;ml(this.storage.g,this.P,null,null,1,0,!0,!1).u(function(b){var c={bucket:this.i};(b=b[0])&&(c.marker=b);var d=this;if(!q.Yg||q.Yg.client)throw Error("gapi lib not loaded");gapi.client.load("storage","v1beta2",function(){var b=gapi.client.storage.objects.list({bucket:d.i});this.Ub&&(c.prefix=this.Ub);b.execute(function(b,c){if(b&&!b.error){var e=b.items||[];0<e.length?To(d,null,e).ca(function(){a.C(!0)}):a.C(!1)}else e=d+": "+c,M(d.logger,
e),a.D(Error(e))})})},function(b){a.D(b)},this);return a};function aq(a,b,c){Xp.call(this,a,b,c);this.M="full"}C(aq,Xp);h=aq.prototype;h.logger=R("ydn.db.sync.GcsMeta");h.yb=function(){var a=aq.m.yb.call(this);a.key="name";return a};h.va=function(){!this.g&&gapi&&(this.g=new Kp(gapi.client));return aq.m.va.call(this)};h.Aa=function(a,b){return new Zp(this,a,b)};
h.ac=function(){P(this.logger,"starting prefetch");var a=new D;if(!q.gapi||!q.gapi.client)throw Error("gapi lib not loaded");var b=this;gapi.client.load("storage","v1beta2",function(){function c(e){e&&(d.pageToken=e);gapi.client.storage.objects.list(d).execute(function(e,g){if(e&&!e.error){var k=e.items||[];if(e.nextPageToken)Q(b.logger,"receiving "+k.length+" meta records, continuing next"),To(b,k),c(e.nextPageToken);else if(0<k.length)To(b,k).ca(function(){Q(b.logger,"receiving "+k.length+" meta records, prefetching dane.");
a.C(!0)});else{var l=!!d.pageToken;Q(b.logger,"prefetching done");a.C(l)}}else l=b+": "+g,M(b.logger,l),a.D(Error(l))})}var d={bucket:b.i};this.Ub&&(d.prefix=this.Ub);c()});return a};h.Yd=function(a,b){if(0==a.length)b([]);else{var c=this.J(),d=Sa(a,function(a){return new rk(c,a)});bp(this,d).u(function(d){for(var f=[],g=0;g<a.length;g++)f[g]=new Ko(a[g],d[g],this.o,c);b(f)},function(a){M(this.logger,this+" error loading meta data "+a);b([])},this)}};function bq(a,b,c){Yo.call(this,a,b,c)}C(bq,Yo);bq.prototype.hf=function(a){return this.h+this.j+this.P+this.oa+a};bq.prototype.logger=R("ydn.db.sync.Json");
bq.prototype.nf=function(a){function b(a,b){var c=new ai(e);d.va().request(c).execute(function(c){if(200==c.status){var e=(c.response instanceof Object?c.response:wh(c.responseText)).items;c=Sa(e,function(a){return a.id});for(var e=Sa(e,function(a){return a.updated}),k=[],p=[],r=[],s=0,w=0;s<=a.length&&w<c.length;){var z=Lo(a[s]),G=c[w];if(s==a.length)p.push(G),w++;else{var E=sj(z,G);0==E?((G=Mo(a[s]))&&e[w]&&G!=e[w]&&(new Date(e[w])>G?r.push(z):M(d.logger,'record "'+z+'" in database is more recent than server '+
G+" vs "+e[w])),s++,w++):1==E?(k.push(z),s++):(p.push(G),w++)}}cp(d,function(){},b,p,r,k)}else M(d.logger,"Invalid response status "+c.status)})}var c=new Sc,d=this,e=this.h+this.j+this.P;a.A(function(a){Tc(c,a);this.Yd(a,function(c){b(c,a)})},this)};function cq(a,b,c){Yo.call(this,a,b,c)}C(cq,gp);function dq(a,b,c){Qo.call(this,a,b,c)}C(dq,ip);dq.prototype.logger=R("ydn.db.sync.entry.S3Meta");function eq(a,b,c){Tp.call(this,a,b,c);this.Ub=c.Options.prefix;if("Key"!=b.keyPath)throw new L('s3-meta store "'+b.getName()+'" must use inline key with keyPath "Key"');this.M="meta"}C(eq,Tp);h=eq.prototype;h.logger=R("ydn.db.sync.S3Meta");h.yb=function(){var a=eq.m.yb.call(this);a.key="Key";a.modified="LastModified";a.etag="ETag";return a};h.Aa=function(a,b){return new dq(this,a,b)};
h.ac=function(){function a(f){f&&(e.marker=f);c.listObjects(e).send(function(c,f){if(c){var l=d+": "+xh(c);M(d.logger,l);b.D(c instanceof Error?c:Error(l))}else{var m=f.Contents||[];f.IsTruncated?(Q(d.logger,"receiving "+m.length+" meta records, continuing next"),To(d,m),a(m[m.length-1].Key+"\uffff")):0<m.length?To(d,m).ca(function(){Q(d.logger,"receiving "+m.length+" meta records, prefetching dane.");b.C(!0)}):(l=!!e.marker,Q(d.logger,"prefetching done"),b.C(l))}})}P(this.logger,"starting prefetch");
var b=new D,c=Np(this.va()),d=this,e={};this.Ub&&(e.prefix=this.Ub);a();return b};h.Yd=function(){throw new Qc("loading meta data should not be necessary");};function fq(a,b,c){Qo.call(this,a,b,c)}C(fq,Fp);function gq(a,b,c){Gp.call(this,a,b,c);a=c.Options;this.domain=a.domain;this.Y=a.siteName;if(a=Oj(b,"sites$parent"))Dl(a,function(a){for(var b=a.link||[],c=0;c<b.length;c++)if("http://schemas.google.com/sites/2008#parent"==b[c].rel)return b[c].href;return a.id.$t.replace(/\w+$/,"0")}),O(this.logger,"index sites$parent in "+b.getName()+" has set a generator.");if(a=Oj(b,"alternate"))Dl(a,function(a){a=a.link||[];for(var b=0;b<a.length;b++)if("alternate"==a[b].rel)return a[b].href}),O(this.logger,"index alternate in "+
b.getName()+" has set a generator.")}C(gq,Gp);h=gq.prototype;h.Aa=function(a,b){return new fq(this,a,b)};h.zb=function(){var a=gq.m.zb.call(this);return a=a.concat(["domain","siteName"])};h.Mb=function(){return"https://sites.google.com/feeds/content/"+this.domain+"/"+this.Y+"/"};h.Ag=function(a){return"GET"!=a};
function hq(a,b,c,d){var e={alt:"json",kind:a.kind};"sites$parent"==c?(c=d.match(/\w+$/)[0],e.parent=c):"alternate"==c&&(c=d.replace(/https:\/\/sites.google.com\/a\/[^\/]+\/[^\/]+/,""),e.path=c);var f={},g=a.Mb();ek(b,function(c,l,m){Tc(b,c);if(l=c[0])l=lc(l,"updated","$t"),l=(new Date(1+ +new Date(l))).toISOString(),e["updated-min"]=l;l=new ai(g,"GET",e,f);a.va().request(l).execute(function(b,e){if(200==e.O()){if(!b){var f=Yi(e);x(f)&&(b=JSON.parse(f))}var g=(f=(b.feed||b).entry)?u(f)?f:[f]:[];0<
g.length?To(a,g).ca(function(){m(g)}):m(c)}else 302==e.O()?m(c):(f=a+": Invalid response status "+e.O()+" for querying pageName: "+d,M(a.logger,f),m(Error(f),!0))})},a)}h.Je=function(a,b,c){if(ep(this))ek(a,function(d,e,f){Tc(a,d);fp(this,function(a){!0===a?kl(this.storage.g,this.P,b,T.only(c),!1,0).u(function(a){f(a)},function(a){f(a,!0)},this):f(d)},function(a){f(a,!0)},this)},this);else return"alternate"==b||"alternate"==b?hq(this,a,b,c):gq.m.Je.call(this,a,b,c)};Lk.prototype.g=null;
jm.prototype.Tf=function(a,b){var c=b.format;if("gdata-sites"==c)a.g=new gq(this,a,b);else if("gdata"==c)a.g=new Gp(this,a,b);else if("gdata-json"==c)a.g=new Jp(this,a,b);else if("odata"==c)a.g=new cq(this,a,b);else if("s3"==c)a.g=new Tp(this,a,b);else if("s3-meta"==c)a.g=new eq(this,a,b);else if("gcs"==c)a.g=new Xp(this,a,b);else if("gcs-json"==c)a.g=new $p(this,a,b);else if("gcs-meta"==c)a.g=new aq(this,a,b);else if("atom"==c)a.g=new gp(this,a,b);else if("json"==c)a.g=new bq(this,a,b);else if("rest"==
c)a.g=new Yo(this,a,b);else throw new Oc("Sync format: "+c);Ml(a,function(b,c){var f=b.Jd();if(!(this instanceof Jk)||this.Va)if(!window.navigator||!t(window.navigator.onLine)||window.navigator.onLine)if("add"==f)f=c[1],a.g.add(b,f);else if("count"==f)c[1]||c[2]||a.g.count(b);else if("put"==f){var f=c[1],g=c[2];a.g.put(b,f,g)}else if("rm:iter"==f)g=c[1],a.g.remove(b,g);else if("values:iter:index"==f){var f=c[1],g=c[2],k=c[3],l=c[4],m=c[5];!k&&!m&&g&&null!=g.lower&&null!=g.upper&&0==sj(g.lower,g.upper)&&
a.g.Je(b,f,g.lower)}else if("keys"==f)g=c[1],l=c[2],k=c[3],m=c[4],a.g.keys(b,null,g,l,k,m,!1);else if("keys:iter:index"==f)f=c[1],g=c[2],l=c[3],k=c[4],m=c[5],a.g.keys(b,f,g,l,k,m,c[6]);else if("values"==f)g=c[1],l=c[2],k=c[3],m=c[4],g||m?g&&g.lower&&x(g.lower)&&g.lower==g.upper||!g&&m&&1==l&&k&&Vp(a.g,b):a.g.values(b,l,k);else if(""!=f)if("get"==f)g=c[1],a.g.get(b,g);else if("values:array"==f)dp(a.g,b,c[1]);else throw Error(f);})};var iq="Accounts Campaigns Contacts Documents Emails EmailTemplates Employees Leads Notes Opportunities Tasks Teams TeamSets Users".split(" "),jq="Accounts Contacts EmailTemplates Leads Notes Emails".split(" "),kq=["Accounts","Contacts","Leads"],lq=["Accounts","Contacts","Leads"],mq=["Contacts","Leads"],nq=["Notes"];function oq(a,b,c){return"https://"+a+"/index.php?module="+b+"&action=DetailView&record="+c};function pq(a){this.h=a||[]}pq.prototype.g=function(a){return-1==this.h.indexOf(a)?a:null};function qq(){}
qq.prototype.g=function(a){var b={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},c={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""};a=a.toLowerCase();var d,e,f=a;if(3>a.length)return a;var g,k;a=a.substr(0,1);"y"==a&&(f=a.toUpperCase()+f.substr(1));g=/^(.+?)(ss|i)es$/;e=/^(.+?)([^s])s$/;
g.test(f)?f=f.replace(g,"$1$2"):e.test(f)&&(f=f.replace(e,"$1$2"));g=/^(.+?)eed$/;e=/^(.+?)(ed|ing)$/;g.test(f)?(e=g.exec(f),g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(e[1])&&(g=/.$/,f=f.replace(g,""))):e.test(f)&&(e=e.exec(f),d=e[1],e=/^([^aeiou][^aeiouy]*)?[aeiouy]/,e.test(d)&&(f=d,e=/(at|bl|iz)$/,k=/([^aeiouylsz])\1$/,d=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,e.test(f)?f+="e":k.test(f)?(g=/.$/,f=f.replace(g,"")):d.test(f)&&(f+="e")));g=/^(.+?)y$/;g.test(f)&&(e=g.exec(f),
d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy]/,g.test(d)&&(f=d+"i"));g=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+b[e]));g=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/;g.test(f)&&(e=g.exec(f),d=e[1],e=e[2],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d+c[e]));g=
/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/;e=/^(.+?)(s|t)(ion)$/;g.test(f)?(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,g.test(d)&&(f=d)):e.test(f)&&(e=e.exec(f),d=e[1]+e[2],e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,e.test(d)&&(f=d));g=/^(.+?)e$/;g.test(f)&&(e=g.exec(f),d=e[1],g=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/,
e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$/,k=/^[^aeiou][^aeiouy]*[aeiouy][^aeiouwxy]$/,g.test(d)||e.test(d)&&!k.test(d))&&(f=d);g=/ll$/;e=/^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*/;g.test(f)&&e.test(f)&&(g=/.$/,f=f.replace(g,""));"y"==a&&(f=a.toLowerCase()+f.substr(1));return f};function rq(a){this.h=a}
rq.prototype.g=function(a){a=a.toLowerCase();a=a.replace(/([^c])\1/g,"$1");a=function(a){return a.match(/^(kn|gn|pn|ae|wr)/)?a.substr(1,a.length-1):a}(a);a=a.replace(/mb$/,"m");a=a.replace(/ck/g,"k");a=function(a){a=a.replace(/([^s]|^)(c)(h)/g,"$1x$3").trim();a=a.replace(/cia/g,"xia");a=a.replace(/c(i|e|y)/g,"s$1");return a=a.replace(/c/g,"k")}(a);a=function(a){a=a.replace(/d(ge|gy|gi)/g,"j$1");return a=a.replace(/d/g,"t")}(a);a=function(a){a=a.replace(/gh(^$|[^aeiou])/g,"h$1");return a=a.replace(/g(n|ned)$/g,
"$1")}(a);a=function(a){a=a.replace(/([^g]|^)(g)(i|e|y)/g,"$1j$3");a=a.replace(/gg/g,"g");return a=a.replace(/g/g,"k")}(a);a=a.replace(/([aeiou])h([^aeiou])/g,"$1$2");a=a.replace(/ph/g,"f");a=a.replace(/q/g,"k");a=a.replace(/s(h|io|ia)/g,"x$1");a=function(a){a=a.replace(/^x/,"s");return a=a.replace(/x/g,"ks")}(a);a=function(a){a=a.replace(/t(ia|io)/g,"x$1");return a=a.replace(/th/,"0")}(a);a=a.replace(/tch/g,"ch");a=a.replace(/v/g,"f");a=a.replace(/^wh/,"w");a=a.replace(/w([^aeiou]|$)/g,"$1");a=a.replace(/y([^aeiou]|$)/g,
"$1");a=a.replace(/z/,"s");a=a.charAt(0)+a.substr(1,a.length).replace(/[aeiou]/g,"");a.length>=this.h&&(a=a.substring(0,this.h));return a=a.toUpperCase()};var sq=new rq(32),tq=new qq,uq=new pq("a a's able about above according accordingly across actually after afterwards again against ain't all allow allows almost alone along already also although always am among amongst an and another any anybody anyhow anyone anything anyway anyways anywhere apart appear appreciate appropriate are aren't around as aside ask asking associated at available away awfully b be became because become becomes becoming been before beforehand behind being believe below beside besides best better between beyond both brief but by c c'mon c's came can can't cannot cant cause causes certain certainly changes clearly co com come comes concerning consequently consider considering contain containing contains corresponding could couldn't course currently d definitely described despite did didn't different do does doesn't doing don't done down downwards during e each edu eg eight either else elsewhere enough entirely especially et etc even ever every everybody everyone everything everywhere ex exactly example except f far few fifth first five followed following follows for former formerly forth four from further furthermore g get gets getting given gives go goes going gone got gotten greetings h had hadn't happens hardly has hasn't have haven't having he he's hello help hence her here here's hereafter hereby herein hereupon hers herself hi him himself his hither hopefully how howbeit however i i'd i'll i'm i've ie if ignored immediate in inasmuch inc indeed indicate indicated indicates inner insofar instead into inward is isn't it it'd it'll it's its itself j just k keep keeps kept know knows known l last lately later latter latterly least less lest let let's like liked likely little look looking looks ltd m mainly many may maybe me mean meanwhile merely might more moreover most mostly much must my myself n name namely nd near nearly necessary need needs neither never nevertheless new next nine no nobody non none noone nor normally not nothing novel now nowhere o obviously of off often oh ok okay old on once one ones only onto or other others otherwise ought our ours ourselves out outside over overall own p particular particularly per perhaps placed please plus possible presumably probably provides q que quite qv r rather rd re really reasonably regarding regardless regards relatively respectively right s said same saw say saying says second secondly see seeing seem seemed seeming seems seen self selves sensible sent serious seriously seven several shall she should shouldn't since six so some somebody somehow someone something sometime sometimes somewhat somewhere soon sorry specified specify specifying still sub such sup sure t t's take taken tell tends th than thank thanks thanx that that's thats the their theirs them themselves then thence there there's thereafter thereby therefore therein theres thereupon these they they'd they'll they're they've think third this thorough thoroughly those though three through throughout thru thus to together too took toward towards tried tries truly try trying twice two u un under unfortunately unless unlikely until unto up upon us use used useful uses using usually uucp v value various very via viz vs w want wants was wasn't way we we'd we'll we're we've welcome well went were weren't what what's whatever when whence whenever where where's whereafter whereas whereby wherein whereupon wherever whether which while whither who who's whoever whole whom whose why will willing wish with within without won't wonder would wouldn't x y yes yet you you'd you'll you're you've your yours yourself yourselves z zero".split(" "));function vq(a){this.data=a;this.h=0}vq.prototype.g=function(a){for(var b=this.h,c=this.data[b],c=1,d=0;0<=b&&b<this.data.length;){c=this.data[b];if(c instanceof Array)if(a<c[0])c=-1;else if(a>c[1])c=1;else return this.h=b,!0;else{if(c==a)return this.h=b,!0;c=a<c?-1:1}if(0==d)d=c;else if(d!=c)break;b+=c;if(b>this.data.length||0>b)break}return!1};
function wq(a,b){for(var c=0,d=0,e=a.length,f=0;f<e;++f){a:{var d=a.charCodeAt(f),g=new vq(categ_letters_numbers_data);if(y(d))d=g.g(d);else{for(var k=0,l=d.length;k<l;++k)if(!1===g.g(d[k])){d=!1;break a}d=!0}}d||((d=f-c)&&b(c,d),c=f+1)}(d=e-c)&&b(c,d)};function xq(a,b){this.j=b;this.value=a}xq.prototype.S=function(){return this.value};xq.prototype.Ab=function(){return 1};var yq=Sh||Ph;xq.prototype.F=function(){return this.value};xq.prototype.toString=function(){return"Entry:"+this.value};function zq(a,b,c,d,e,f){xq.call(this,d,e);this.P=a;this.h=b;this.i=c;this.Zd=f||[]}C(zq,xq);h=zq.prototype;h.kd=function(){return{k:this.j,v:this.value.toLowerCase(),id:this.F(),loc:this.Zd}};h.F=function(){var a=[this.P,this.i,this.h,this.value];return yq?a:xj(a)};h.J=function(){return this.P};h.ha=function(){return this.i};h.toString=function(){return["IndexEntry",this.P,this.i,this.value].join(":")};function Aq(a,b,c,d,e){xq.call(this,b,c);this.l=d;this.g=e;this.type=a;this.Vf=1}C(Aq,xq);Aq.prototype.Ab=function(){return this.g*this.type*this.Vf};Aq.prototype.F=function(){return this.value+"|"+this.l};function Bq(a,b){zq.call(this,b.J(),b.h,b.ha(),b.S(),b.j,[]);this.o=a;this.g=[b]}C(Bq,zq);h=Bq.prototype;h.count=function(){return this.g.length};h.entry=function(a){return this.g[a]};h.of=function(a){a=a.g[0];for(var b=0;b<this.g.length;b++)if(this.g[b].h==a.h&&this.g[b].value==a.value)return;this.g.push(a)};h.Ab=function(){for(var a=0,b=0;b<this.g.length;b++)var c=this.g[b],d=Pl(this.o,c.J(),c.h),c=c.Ab(),a=a+c*d.h;return a};function jb(a,b){var c=a.Ab(),d=b.Ab();return c<=d?1:-1}
h.kd=function(){for(var a={value:this.value,primaryKey:this.i,storeName:this.P,score:this.Ab(),tokens:[]},b=0;b<this.g.length;b++)a.tokens[b]=this.g[b].kd();return a};h.toString=function(){return["RankEntry",this.P,this.i,this.value].join(":")+"["+this.g.length+"]"};function Cq(a){var b=[],c;a=a.split(/\s+/);for(var d=0;d<a.length;d++){c=a[d];for(var e=c.length-1,f=Array(e),g=0;g<e;g++)f[g]=c.substring(g,g+2);c=f;b.push.apply(b,c)}return b};function dl(a,b,c,d,e,f,g){zq.call(this,b,c,d,e,f,g);this.query=a}C(dl,zq);dl.prototype.Ab=function(){var a,b=this.value;a=Cq(this.query.value.toLowerCase().replace(/^\s+|\s+$/g,""));var b=Cq(b.toLowerCase().replace(/^\s+|\s+$/g,"")),c=0,d=a.length+b.length,e,f,g,k;for(e=0;e<a.length;e++)for(g=a[e],f=0;f<b.length;f++)if(k=b[f],g==k){c++;delete b[f];break}a=2*c/d;b=Math.log(this.Zd.length+1);c=this.query.Ab();return b*a*c};dl.prototype.kd=function(){return{keyPath:this.h,value:this.value,loc:this.Zd.slice()}};
dl.prototype.toString=function(){return["ResultEntry",this.P,this.i,this.value].join(":")};function Dq(a,b,c){this.g=a;this.h=b;this.j=[];this.limit=c||1E3;this.i=0}function cl(a,b){for(var c,d,e=a.g.getName(),f=0;f<a.h.length;f++){var g=a.h[f],k=g.type;0.4==k||0.6==k?(d="v",c=g.S().toLowerCase(),c=mj(c)):(d="v",c=g.S().toLowerCase(),c=T.only(c));b(e,d,c,g);a.i++;0.6==k&&(d="k",c=g.j,c=T.only(c),b(e,d,c,g),a.i++)}}function bl(a){for(var b=[a.g.getName()],c=0;c<a.g.count();c++){var d=a.g.index(c).J();-1==b.indexOf(d)&&b.push(d)}return b}
function el(a){for(var b=[],c=[],d=0;d<a.j.length;d++){var e=a.j[d];if(0==e.query.type)-1==Wa(c,function(a){return a.ha()==e.ha()&&a.J()==e.J()})&&c.push(e);else{var f=new Bq(a.g,e),g=Wa(b,function(a){return a.ha()==f.ha()&&a.J()==f.J()});if(0<=g){var k=b[g];Oa.splice.call(b,g,1);k.of(f);f=k}ib(b,f)}}for(a=0;a<c.length;a++)for(g=c[a],d=b.length-1;0<=d;--d)if(k=b[d],g.ha()==k.ha()&&g.J()==k.J()){b.splice(a,1);break}return b.map(function(a){return a.kd()})};function Eq(a){this.g=a;if("en"==a.lang){a=a.h||["stop","stemmer","metaphone"];for(var b=[],c=0;c<a.length;c++)if("metaphone"==a[c])b.push(sq);else if("stemmer"==a[c])b.push(tq);else if("stop"==a[c])b.push(uq);else throw Error('Invalid normalizer "'+a[c]+'" for English lang');a=b}else a=[];this.h=a}function Fq(a,b){for(var c=0;c<a.h.length;c++){var d=a.h[c].g(b);if(d)b=d;else return null}return b}Eq.prototype.parse=function(a){var b=[];wq(a,function(c,d){b.push(a.substr(c,d))});return b};
Eq.prototype.query=function(a,b,c){a=Gq(this,b);return 0==a.length?null:new Dq(this.g,a,c||10)};
function Gq(a,b){var c=[],d=[];wq(b,function(a,e){c.push(b.substr(a,e));d.push(a)});for(var e=[],f=0;f<c.length;f++)e[f]=Fq(a,c[f]);for(var g=[],k=0,f=0;f<c.length;f++){var l=c[f],m=e[f],n="*"==b.charAt(d[f]+l.length),p=n?d[f]+l.length+1:d[f]+l.length,p='"'==b.charAt(d[f]-1)&&'"'==b.charAt(p),r="-"==b.charAt(p?d[f]-2:d[f]-1),s=0.8;n?s=0.4:p?s=1:r?s=0:null!=m&&(s=0.6);l=new Aq(s,l,m,d[f],1/(f+2));g.push(l);k+=l.Ab()}for(f=0;f<g.length;++f)g[f].Vf=1/k;return g}
function Hq(a,b,c,d){var e=[],f=[];wq(b,function(a,c){e.push(b.substr(a,c));f.push(a)});for(var g=[],k=0;k<e.length;k++)g[k]=Fq(a,e[k]);a=c.J();c=c.g;for(var l=[],k=0;k<e.length;k++){var m=e[k],n=g[k];if(null!=n){var p=Va(l,function(a){return a.S()==m});p||(p=new zq(a,c,d,m,n),l.push(p));p.Zd.push(f[k])}}return l}function Iq(a,b,c,d){for(var e=[],f=0;f<a.g.count();f++){var g=a.g.index(f);if(g.J()==b){var k=uj(d,g.g);x(k)&&(e=e.concat(Hq(a,k,g,c)))}}return e};jm.prototype.Sf=function(a,b){var c=this;b.g=new Eq(b);Ml(a,function(d,e){function f(e){var f=a.getName();tk(e)&&ek(d,function(a,g,k){if(g)k(a,g);else{Tc(d,a);var l=kj(T.bound([f,e],[f,e,"\uffff"])),z=b.getName();jl(c.g,z,l).ca(function(){k(a,g)})}})}function g(b){var e=a.getName();ek(d,function(a,f,g){f?g(a,f):(Tc(d,a),b&&(b=kj(T.bound([e,b.lower],[e,b.upper,"\uffff"]))),jl(c.g,e,b).ca(function(){g(a,f)}))})}function k(e,f){var g=a.getName();ek(d,function(a,k,l){Tc(d,a);if(k)l(a,k);else{var z=b.getName();
u(a)||(a=[a]);for(var G=0;G<a.length;G++){var E=a[G];if(tk(E)){if(f){var J=kj(T.bound([g,E],[g,E,"\uffff"]));jl(c.g,z,J)}E=Iq(b.g,g,E,e[G]).map(function(a){return a.kd()});E=hl(c.g,z,E);G==a.length-1&&E.ca(function(){l(a,k)})}}}})}var l=d.Jd();"put"==l?k([e[1]],!0):"put:array"==l?k(e[1],!0):"add"==l?k([e[1]],!1):"add:array"==l?k(e[1],!1):"rm:iter"==l||"clear"==l?g(e[1]):"rm"==l&&f(e[1])})};
jm.prototype.search=function(a,b,c,d){var e=Tl(this.h,a);if(!e)throw new L('full text index catalog "'+a+'" not found.');a=e.g.query(a,b,c,d);return a?this.g.search(a):(P(this.logger,'query "'+b+'" contains only noise and search is ignored'),fk("search",null))};function Jq(a){this.name=a;this.info=null;this.h={};this.g=null}
var Kq={Accounts:{GeneratorIndex:{ydn$emails:["email","email1","email_addresses_non_primary"],ydn$phones:["phone_office","phone_alternate","phone_fax"]}},Contacts:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Documents:{FullTextIndex:{content:["name","document_name","filename","description"]},indexes:[{name:"parent",keyPath:["doc_type","doc_id"]}]},
Emails:{FullTextIndex:{content:["name","description"]},GeneratorIndex:{ydn$emails:["bcc_addrs","cc_addrs","from_addr","to_addrs","reply_to_addr"]},indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]},{name:"message_id"}]},Leads:{FullTextIndex:{name:["name","first_name","last_name","full_name"]},GeneratorIndex:{ydn$emails:["email","email1","email2"],ydn$phones:["phone_home","phone_mobile","phone_work","phone_other","phone_fax"]}},Notes:{FullTextIndex:{content:["name","description"]},
indexes:[{name:"parent",keyPath:["parent_type","parent_id","date_modified"]}]}};
function Lq(a,b){return"ydn$emails"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=a.indexOf(e))if(x(b[e]))if(/addrs$/.test(e))for(var f=b[e].split(","),g=0;g<f.length;g++){var k=ln(f[g]);k&&d.push(k)}else(k=ln(b[e]))&&d.push(k);else if(v(b[e])&&b[e][0]&&b[e][0].email_address)for(f=b[e],g=0;g<f.length;g++)f[g]&&x(f[g].email_address)&&(k=ln(f[g].email_address))&&d.push(k);return d}}:"ydn$phones"==b?{name:b,multiEntry:!0,generator:function(b){var d=[],e;for(e in b)if(0<=
a.indexOf(e)){var f=kn(b[e]);f&&d.push(f)}return d}}:null}function Mq(a,b){if(a.g)for(var c=0;c<a.g.stores.length;c++)if(a.g.stores[c].name==b)return a.g.stores[c];var c=a.h[b]||Kq[b]||{},d={name:b,keyPath:c.keyPath||"id",indexes:[{name:"name"},{name:"date_modified"}]},e=["ydn$emails","ydn$phones","ydn$names"];c.indexes&&(d.indexes=d.indexes.concat(c.indexes));for(var f=c.GeneratorIndex||{},c=0;c<e.length;c++){var g=e[c],k=f[g];!k||u(k)&&0==k.length||d.indexes.push(Lq(k,g))}return d}
function Nq(a){if(a.g)return a.g;for(var b={fullTextCatalogs:[],stores:[{name:"history",indexes:[{keyPath:"type"},{keyPath:"timestamp"}]},{name:"Meta"}]},c=0;c<jq.length;c++){var d=jq[c];b.stores.push(Mq(a,d));var e=a.h[d]||Kq[d]||{};if(e.FullTextIndex)for(var f in e.FullTextIndex){var g=e.FullTextIndex[f];if(0<g.length){for(var k={name:"ft-"+d+"-"+f,lang:"en",sources:[]},l=0;l<g.length;l++)k.sources.push({storeName:d,keyPath:g[l]});b.fullTextCatalogs.push(k)}}}a.g=b;Object.freeze(a.g);return a.g}
;function Oq(a,b,c){this.domain=a;this.module=b;this.g=c||null}h=Oq.prototype;h.K=function(){return this.domain};function Pq(a,b){if(b){a.g||(a.g={});for(var c in b)a.g[c]=b[c]}}h.F=function(){return this.g.id};function Qq(a){return a.g?+new Date(a.g.date_modified+" GMT"):NaN}function Rq(a){if(!a.g)return"";var b=a.g.full_name||a.g.name;return b?b:a.g.first_name||a.g.last_name?(b=(a.g.first_name||"").trim(),a=(a.g.last_name||"").trim(),b+" "+a):a.g.id}h.value=function(a){return this.g?this.g[a]:null};
h.toJSON=function(){return{domain:this.domain,module:this.module,obj:this.g}};h.toString=function(){return"Record:"+this.module+":"+(this.g?this.g.id:void 0)};function Sq(a,b,c){var d=0;if(!b)return d;b.gd$city&&a[c+"_address_city"]!=b.gd$city.$t&&(a[c+"_address_city"]=b.gd$city.$t,d++);b.gd$country&&a[c+"_address_country"]!=b.gd$country.$t&&(a[c+"_address_country"]=b.gd$country.$t,d++);b.gd$postcode&&a[c+"_address_postalcode"]!=b.gd$postcode.$t&&(a[c+"_address_postalcode"]=b.gd$postcode.$t,d++);b.gd$region&&a[c+"_address_state"]!=b.gd$region.$t&&(a[c+"_address_state"]=b.gd$region.$t,d++);b.gd$street&&a[c+"_address_street"]!=b.gd$street.$t&&(a[c+"_address_street"]=
b.gd$street.$t,d++);b.gd$housename&&a[c+"_address_street_2"]!=b.gd$neighborhood.$t&&(a[c+"_address_street_2"]=b.gd$neighborhood.$t,d++);b.gd$neighborhood&&a[c+"_address_street_3"]!=b.gd$city.$t&&(a[c+"_address_street_3"]=b.gd$city.$t,d++);return d}
function Tq(a,b,c){function d(d,g){!a[c+g]||b[d]&&b[d].$t==a[c+g]||(e++,b[d]={$t:a[c+g]})}var e=0;if(!a)return 0;b||(b={});d("gd$city","_address_city");d("gd$country","_address_country");d("gd$postcode","_address_postalcode");d("gd$region","_address_state");d("gd$street","_address_street");d("gd$neighborhood","_address_street_2");d("gd$city","_address_street_3");return e}
function Uq(a,b){var c=0;!a.title||b.name&&b.name==a.title.$t||(b.name=a.title.$t,c++);for(var d=0;a.gd$email&&d<a.gd$email.length;d++){var e=a.gd$email[d];"http://schemas.google.com/g/2005#work"==e.rel?b.email1!=e.address&&(c++,b.email1=e.address):"http://schemas.google.com/g/2005#home"==e.rel?b.email2!=e.address&&(c++,b.email2=e.address):"http://schemas.google.com/g/2005#other"==e.rel&&b.email!=e.address&&(c++,b.email=e.address)}a.gd$name?(a.gd$name.gd$namePrefix&&b.salutation!=a.gd$name.gd$namePrefix.$t&&
(c++,b.salutation=a.gd$name.gd$namePrefix.$t),a.gd$name.gd$givenName&&b.first_name!=a.gd$name.gd$givenName.$t&&(b.first_name=a.gd$name.gd$givenName.$t,c++),a.gd$name.gd$familyName&&b.last_name!=a.gd$name.gd$familyName.$t&&(b.last_name=a.gd$name.gd$familyName.$t,c++),a.gd$name.gd$fullName&&b.full_name!=a.gd$name.gd$fullName.$t&&(b.full_name=a.gd$name.gd$fullName.$t,c++)):b.full_name=a.title.$t;a.gd$organization&&a.gd$organization[0]&&(d=a.gd$organization[0],d.gd$orgTitle&&d.gd$orgTitle.$t!=b.title&&
(b.title=d.gd$orgTitle.$t,c++),d.gd$orgDepartment&&d.gd$orgDepartment.$t!=b.department&&(b.department=d.gd$orgDepartment.$t,c++),d.gd$orgJobDescription&&d.gd$orgJobDescription.$t!=b.description&&(b.description=d.gd$orgJobDescription.$t,c++));if(a.gd$im)for(d=0;d<a.gd$im.length;d++)"Twitter"==a.gd$im[d].label&&b.twitter!=a.gd$im[d].address?(b.twitter=a.gd$im[d].address,c++):"Facebook"==a.gd$im[d].label&&b.facebook!=a.gd$im[d].address?(b.facebook=a.gd$im[d].address,c++):"Google Plus"==a.gd$im[d].label&&
b.googleplus!=a.gd$im[d].address?(b.googleplus=a.gd$im[d].address,c++):"Linkedin"==a.gd$im[d].label&&b.linkedin!=a.gd$im[d].address&&(b.linkedin=a.gd$im[d].address,c++);a.gContact$birthday&&b.birthdate!=a.gContact$birthday.when&&(b.birthdate=a.gContact$birthday.when,c++);for(d=0;a.gd$phoneNumber&&d<a.gd$phoneNumber.length;d++)if(e=a.gd$phoneNumber[d],e.$t)if("http://schemas.google.com/g/2005#mobile"==e.rel)b.phone_mobile!=e.$t&&(b.phone_mobile=e.$t,c++);else if("http://schemas.google.com/g/2005#work"==
e.rel)b.phone_work!=e.$t&&(b.phone_work=e.$t,c++);else if("http://schemas.google.com/g/2005#home"==e.rel)b.phone_home!=e.$t&&(b.phone_home=e.$t,c++);else if("http://schemas.google.com/g/2005#fax"==e.rel||"http://schemas.google.com/g/2005#home_fax"==e.rel||"http://schemas.google.com/g/2005#work_fax"==e.rel)b.phone_fax!=e.$t&&(b.phone_fax=e.$t,c++);else if(b.phone_other=e.$t)b.phone_other=e.$t,c++;if(a.gd$structuredPostalAddress){for(var f=e=-1,d=0;d<a.gd$structuredPostalAddress.length;d++){var g=a.gd$structuredPostalAddress[d];
"http://schemas.google.com/g/2005#work"==g.rel||g.primary?e=d:f=d}-1==e&&(f=-1);c+=Sq(b,a.gd$structuredPostalAddress[e],"primary");c+=Sq(b,a.gd$structuredPostalAddress[f],"alt")}return c}
function Vq(a,b){function c(a,c){if(g[a]){b.gd$phoneNumber||(b.gd$phoneNumber=[]);var d;a:{for(d=0;b.gd$phoneNumber&&d<b.gd$phoneNumber.length;d++)if(b.gd$phoneNumber[d].rel==c){d=b.gd$phoneNumber[d];break a}d=null}d?d.$t!=g[a]&&(d.$t=g[a],k++):(b.gd$phoneNumber.push({rel:c,$t:g[a]}),k++)}}function d(a){b.gd$im||(b.gd$im=[]);for(var c=0;c<b.gd$im.length;c++)if(b.gd$im[c].label==a)return b.gd$im[c];return null}function e(){b.gd$name||(b.gd$name={},k++)}function f(a,c){if(g[a]){b.gd$email?v(b.gd$email)||
(b.gd$email=[b.gd$email]):b.gd$email=[];var d;a:{for(d=0;b.gd$email&&d<b.gd$email.length;d++)if(!(0<=l.indexOf(d))&&b.gd$email[d].address==g[a])break a;d=-1}if(0<=d){var e=b.gd$email[d];e.rel!=c&&(k++,e.rel=c);l.push(d)}else b.gd$email.push({rel:c,address:g[a]}),l.push(b.gd$email.length-1),k++}}var g=a.g,k=0;!g.name||b.title&&b.title.$t==g.name||(b.title={$t:g.name},k++);var l=[];f("email1","http://schemas.google.com/g/2005#work");f("email2","http://schemas.google.com/g/2005#home");f("email","http://schemas.google.com/g/2005#other");
g.salutation&&(e(),b.gd$name.gd$namePrefix&&b.gd$name.gd$namePrefix.$t==g.salutation||(b.gd$name.gd$namePrefix={$t:g.salutation},k++));g.first_name&&(e(),b.gd$name.gd$givenName&&b.gd$name.gd$givenName.$t==g.first_name||(b.gd$name.gd$givenName={$t:g.first_name},k++));g.last_name&&(e(),b.gd$name.gd$familyName&&b.gd$name.gd$familyName.$t==g.last_name||(b.gd$name.gd$familyName={$t:g.last_name},k++));g.full_name&&(e(),b.gd$name.gd$fullName&&b.gd$name.gd$fullName.$t==g.full_name||(b.gd$name.gd$fullName=
{$t:g.full_name},k++));if(g.twitter){var m=d("Twitter");m?m.address!=g.twitter&&(m.address=g.twitter,k++):(b.gd$im.push({label:"Twitter",address:g.twitter}),k++)}g.facebook&&((m=d("Facebook"),m)?m.address!=g.facebook&&(m.address=g.facebook,k++):(b.gd$im.push({label:"Facebook",address:g.facebook}),k++));g.googleplus&&((m=d("Google Plus"),m)?m.address!=g.googleplus&&(m.address=g.googleplus,k++):(b.gd$im.push({label:"Google Plus",address:g.googleplus}),k++));g.linkedin&&((m=d("Linkedin"),m)?m.address!=
g.linkedin&&(m.address=g.linkedin,k++):(b.gd$im.push({label:"Linkedin",address:g.linkedin}),k++));!g.birthdate||b.gContact$birthday&&b.gContact$birthday.when==g.birthdate||(b.gContact$birthday={when:g.birthdate},k++);c("phone_mobile","http://schemas.google.com/g/2005#mobile");c("phone_work","http://schemas.google.com/g/2005#work");c("phone_home","http://schemas.google.com/g/2005#home");c("phone_fax","http://schemas.google.com/g/2005#work_fax");c("phone_other","http://schemas.google.com/g/2005#other");
for(var n=-1,m=-1,p=0;b.gd$structuredPostalAddress&&p<b.gd$structuredPostalAddress.length;p++)-1==n&&"true"==b.gd$structuredPostalAddress[p].primary||"http://schemas.google.com/g/2005#work"==b.gd$structuredPostalAddress[p].rel?n=p:-1==m&&(m=p);-1==n&&0<=m&&(n=m,b.gd$structuredPostalAddress[n].primary="true",m=-1);0<=n?k+=Tq(g,b.gd$structuredPostalAddress[n],"primary"):(n={primary:"true",rel:"http://schemas.google.com/g/2005#work"},p=Tq(g,n,"primary"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=
[]),b.gd$structuredPostalAddress.push(n),k+=p));0<=m?k+=Tq(g,b.gd$structuredPostalAddress[m],"alt"):(n={},p=Tq(g,n,"alt"),0<p&&(b.gd$structuredPostalAddress||(b.gd$structuredPostalAddress=[]),b.gd$structuredPostalAddress.push(n),k+=p));return k};function Wq(a){if(u(a))return a.map(function(a){return Wq(a)});if(A(a)){var b={},c;for(c in a.name_value_list)b[c]=a.name_value_list[c].value;return b}throw Error("Invalid name_value_entries");};function Xq(a,b,c,d,e){c=sa(c,"http")?new td(c):ud(vd(new td,c),"https");zd(c,"");yd(c,null);this.j=c.K();this.V=b;this.p=c.toString().replace(/\/$/,"");this.i=d;this.s=e;this.g=null;this.M=a;this.H=new Jq(this.j);this.db=new Un("su-"+this.j,Nq(this.H),{isSerial:!0,policy:"single",mechanisms:["indexeddb"]});this.h=null;this.l=this.o=NaN;this.G=!1;this.history=new Co(this.db)}C(Xq,co);h=Xq.prototype;h.K=function(){return this.j};
h.request=function(a,b,c,d,e,f){function g(){m.execute(function(g,k){this.o=B();var l=g;if(x(l))try{g=JSON.parse(l)}catch(m){}f||!g||11!=g.number&&10!=g.number?d.call(e,g,k):this.ed().u(function(){this.request(a,b,c,d,e,!0)},function(){d.call(e,null,new Wi(0,null,{},"Login fail"))},this)},this)}for(var k="{",l=0;l<b.length;l++)k+=(0==l?"":",")+'"'+b[l]+'":'+JSON.stringify(c[l]);k+="}";l=new Ad;l.add("method",a);l.add("input_type","json");l.add("response_type","json");l.add("rest_data",k);var m=this.M.request(new ai(this.p+
"/service/v4/rest.php","POST",{},{"Content-Type":"application/x-www-form-urlencoded"},l.toString())),k=B()-this.o;0<k&&100>k?(this.o=100+this.o,Q(this.logger,"request will call after "+k+" ms."),lf(g,k,this)):g.call(this)};
function Yq(a,b,c){var d=["session","module_name"];a=[a.g?a.g.id:null,c.module_name];var e=[!1,!1];if("get_entry_list"==b)b=c.query||"",d.push("query"),a.push(b),e.push(""==b),d.push("order_by"),b=c.order_by||"",a.push(b),e.push(""==b),b=c.offset||0,d.push("offset"),a.push(b),e.push(0==b),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length),b=c.max_results||25,d.push("max_results"),
a.push(b),e.push(null!=c.max_results),b=c.deleted||0,d.push("deleted"),a.push(b),e.push(0==b),c=!!c.favorites,d.push("favorites"),a.push(c),e.push(!1==c);else if("get_available_modules"==b)c=c.filter||"",d.push("filter"),a.push(c),e.push(0==c.length);else if("get_module_fields"==b)c=c.fields||[],d.push("fields"),a.push(c),e.push(0==c.length);else if("get_entries"==b)b=c.ids||[],d.push("ids"),a.push(b),e.push(!1),b=c.select_fields||[],d.push("select_fields"),a.push(b),e.push(0==b.length),b=c.link_name_to_fields_array||
[],d.push("link_name_to_fields_array"),a.push(b),e.push(0==b.length);else for(var f in c)"module_name"!=f&&(d.push(f),a.push(c[f]),e.push(!1));for(c=e.length-1;0<=c;c--)if(e[c])d.pop(),a.pop();else break;return{keys:d,values:a}}
function Zq(a,b){var c=b.entry_list;if(u(c)&&0<c.length){var d=c.map(function(a){return'"'+a.id+'"'});return $q(a,"get_entry_list",{module_name:"EmailText",max_results:b.length,query:"email_id IN ("+d.join(",")+")"}).A(function(a){a=a.entry_list;c.length!=a.length&&M(this.logger,"number of entries retrived for EmailText exptected to have "+c.length+" but found only "+a.length);for(var d=0;d<a.length;d++){var g=a[d];if(a[d]){var k=lc(g,"name_value_list","email_id","value"),l=Wa(c,function(a){return a.id==
k});if(0<=l)for(var m in g.name_value_list)c[l].name_value_list[m]=g.name_value_list[m];else O(this.logger,"key "+k+" not found in EmailText")}}return b},a)}}
function ar(a,b){var c=b.module_name;a.l=B();var d=$q(a,"get_entry_list",b);"Emails"==c&&(d=d.A(function(a){return Zq(this,a)},a));return d.A(function(a){var d=a.result_count,g=a.offset||0,k=a.entry_list,l=parseInt(a.next_offset,10);if(t(d)&&u(k)){if(0<k.length){a=Wq(k);var m=this.V,n=this.K(),p=a;if(m.h)for(var p=u(p)?p:[p],r=0;r<p.length;r++)p[r]&&br(m,new Oq(n,c,p[r]));this.db.put(c,a)}return 0<k.length&&d>=k.length&&l>g?(b.offset=l,ar(this,b)):l}throw Error("Invalid REST respond on entry list query on "+
c+": "+JSON.stringify(a));},a)}function cr(a,b){if(!b){for(var c=[],d=0;d<jq.length;d++)c[d]=cr(a,jq[d]);c.push(cr(a,"Users"));return om(c)}var e={module_name:b},f="module/"+b;return a.db.get("Meta",f).A(function(a){return a?a:$q(this,"get_module_fields",e).A(function(a){a&&a.module_name&&a.module_fields?this.db.put("Meta",a,f):M(this.logger,"Invalid module for "+b+" "+xh(a));return a},this)},a)}
function dr(a,b){var c=new Vj(b,"date_modified",null,!0);return a.db.keys(c,1).A(function(a){var c={};a[0]&&(c.query=b.toLowerCase()+".date_modified>'"+a[0]+"'");c.module_name=b;c.order_by="date_modified";a=ar(this,c);a.u(function(a){this.logger.info(this+" module "+b+" synced, "+a+" records updated.")},function(a){var c=".";a&&(c=" with "+a.name+": "+a.message);M(this.logger,this+" module "+b+" failed"+c)},this);return a},a)}
function $q(a,b,c,d){var e=d||0,f=new D;if(!a.g||!a.g.user_id)return 2>e?(Q(a.logger,"Request require login, tried "+e),a.ed().A(function(){e++;qb($q(a,b,c,e),f)})):(P(a.logger,"Cannot do request, not login. Give up after "+e+" retry"),f.D()),f;d=Yq(a,b,c);a.request(b,d.keys,d.values,function(d,k){k.Ga()&&A(d)?11==d.number&&/invalid/i.test(d.name)?(this.g=null,qb($q(a,b,c,e),f)):f.C(d):f.D(k.O()+" "+k.Ma())},a);return f}
h.list=function(a){if(!u(a)||0==a.length)return F("invalid query");for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.limit||5,f=d.offset||0,g=!!d.reverse;if(!A(d))return F("invalid query at "+c+"");var k=d.store;if(-1==jq.indexOf(k))return F("invalid store name at "+c+": "+k);var l=d.index||"id";if(!x(l)||0==l.length)return F("index name missing in "+k);var m=null;null!=d.key?(m=d.key,"ydn$phones"==l?m=kn(m):"ydn$emails"==l&&(m=m.toLowerCase()),m=d.prefix?mj(m):T.only(m)):null!=d.keyRange&&(m=nj(d.keyRange));
"id"==l?b.push(this.db.values(k,m,e,f,g)):Yl(this.db,k,l)?b.push(this.db.values(k,l,m,e,f,g)):b.push(tb([]))}return(new nm(b)).u(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].result=b[c][1]:(M(this.logger,"query "+c+" failed."),a[c].result=[]);return a},function(b){M(this.logger,"list failed "+b);return a},this)};
h.search=function(a){if(!u(a)||0==a.length)return F("invalid query");for(var b=[],c=Nq(this.H),d=0;d<a.length;d++){var e=a[d];if(!A(e))return F("invalid query at "+d+"");var f=e.q;if(!x(f)||0==f.length)return F("query term missing "+d+"");var g="ft-"+e.store+"-"+(e.index||"name");0<=Wa(c.fullTextCatalogs,function(a){return a.name==g})?(f=this.db.search(g,e.q),e.fetchFull&&(f=f.A(function(a){if(0<a.length){for(var b=[],c=0;c<a.length;c++)b.push(new rk(a[c].storeName,a[c].primaryKey));return this.db.values(b).A(function(b){for(var c=
0;c<b.length;c++)a.record=b[c];return a})}},this)),b.push(f)):b.push(tb([]))}return(new nm(b)).u(function(b){for(var c=0;c<b.length;c++)b[c][0]?a[c].fullTextResult=b[c][1]:(M(this.logger,"query "+c+" failed."),a[c].fullTextResult=[]);return a},function(b){M(this.logger,"list failed "+b);return a},this)};
function er(a,b,c,d){var e={module_name:b},f="get_entry";d?(e.query=d+" = '"+c+"'",e.order_by="id",f="get_entry_list"):e.id=c;return $q(a,f,e).A(function(a){if(a&&a.entry_list&&A(a.entry_list[0]))return Wq(a.entry_list[0]);P(this.logger,"record "+b+":"+c+" not found.");return null},a)}
function fr(a){if(a.isLogin()){var b="login_data/"+a.g.user_id;return a.db.get("Meta",b).A(function(a){var d=er(this,"Users",this.g.user_id).A(function(d){a&&a.date_modified==d.date_modified||this.db.put("Meta",d,b)},this);return a?a:d},a)}return F("Not login")}
function gr(a,b,c,d){if(!x(c)||0==c.length)return F("record id required.");if(0<=jq.indexOf(b)){var e;d?(e=T.only(c),e=a.db.values(b,d,e).A(function(a){return a[0]},a)):e=a.db.get(b,c);return e.A(function(a){if(!a)return er(this,b,c,d)},a)}return 0<=iq.indexOf(b)?er(a,b,c,d):F("module: "+b+" not registerred")}
function hr(a){if(a.h&&a.h.isLogin)return tb(a.h);var b=new D;a.db.get("Meta","info/server").ca(function(a){a&&a.version?(this.h=a,b.C(a)):this.request("get_server_info",[],[],function(a,c){if(0==c.O())this.h=null,b.D("service "+(this.p+"/service/v4/rest.php")+" not responding");else if(c.Ga()){var f=Yi(c);if((!a||!a.version)&&x(f))try{a=JSON.parse(f)}catch(g){a=Yi(c)}if(a&&a.version){var f=a,k={},l;for(l in f)k[l]=f[l];this.h=k;b.C({info:f,about:ir(this)});this.db.put("Meta",f,"info/server")}else this.h=
null,b.D("invalid respond "+Yi(c))}else this.h=null,b.D("request fail "+c.O()+" "+c.Ma())},this)},a);return b}function jr(a){var b=new D;a.request("get_available_modules",["filter"],["all"],function(a){b.C(a)},a);return b}function ir(a){return{baseUrl:a.p,domain:a.K(),userName:a.i,isLogin:a.isLogin(),hostPermission:!0}}function kr(a){return(new nm([hr(a),jr(a)])).A(function(a){return{serverInfo:a[0][1],availableModules:a[1][1],about:ir(this)}},a)}
function lr(a,b,c){var d=[],e;for(e in c)d.push({name:e,value:c[e]});return $q(a,"set_entry",{module_name:b,name_value_list:d}).A(function(a){if(a&&a.id){var c={id:a.id};a=a.entry_list||{};for(var d in a)c[d]=a[d].value;this.db.put(b,c);return c}throw Error("creating "+b+" entry fail");},a)}
function mr(a,b,c){if(c){var d=nr(b,or,a.K(),void 0,c.id),e=d.module,f=new Oq(a.K(),e,c);P(a.logger,"synchronizing "+b+" to "+f);if(Qq(f)==d.h){var g=new Ao("update-gdata-record");Bo(g,c);b=b.data;A(b)&&Ul(b);Uq(b,c)&&lr(a,e,c).u(function(a){A(a)?g.g=Ul(a):g.g=a;this.history.add(g)},function(a){M(this.logger,"Fail to put record "+c.id+" to server "+a.message)},a)}}}
function pr(a,b){for(var c=qr(b),d=0;d<c.length;d++)0<=jq.indexOf(c[d].module)&&a.db.get(c[d].module,c[d].g).A(function(a){mr(this,b,a)},a)}function rr(a,b,c){var d={};Uq(c,d);return lr(a,b,d)}h.isLogin=function(){return!!this.g&&!!this.g.user_id};
h.update=function(){var a;if(this.G)O(this.logger,"Modules are already updating now at "+a+" / "+jq.length);else{this.G=!0;this.l=B();a=0;var b=this,c=function(){var d=jq[a];d?(P(b.logger,"Syncing module "+d),a++,dr(b,d).ca(function(){b.l=B();q.setTimeout(function(){c()},500)})):(O(b.logger,"Updating module done"),b.G=!1)};c();q.setTimeout(function(){2E3<b.l-B()&&c()},2E3)}};
h.ed=function(a,b){if(!window.navigator.onLine){var c=this,d=new D;chrome.storage.local.get("last-login",function(a){(a=a["last-login"])&&qb(c.db.get("Meta","login_data/"+a).A(function(a){this.g=a},c),d)});return d}a&&(this.i=a);b&&(this.s=b);if(!this.i)return F("username required.");if(!this.s)return F("password required.");d=new D;this.request("login",["user_auth","application_name","name_value_list"],[{user_name:this.i,password:this.s},"Yathit CRM",{language:"",notifyonsave:"false"}],function(a,
b){if(a&&a.id){this.g=Wq(a);this.g.id=a.id;var c={};c["last-login"]=this.g.user_id;chrome.storage.local.set(c);d.C(a)}else a&&a.description?d.D(a.description+" ("+a.name+")"):(c=b.O()+" "+b.Ma()+" "+Yi(b),d.D("Login fail: "+c.substr(0,200)))},this,!0);return d};
function sr(a){var b=new D;if(a.g&&a.g.user_id){var c="login_data/"+a.g.user_id;chrome.storage.local.remove("last-login");a.db.remove("Meta",c)}a.request("logout",[],[],function(a,c){this.g=null;c.Ga()?(M(this.logger,"Logout request fail with "+c.O()+" "+c.Ma()),b.C(!0)):b.D(c.O()+" "+c.Ma())},a,!0);return b}
function tr(a){function b(){f.request(new ai(e.toString())).execute(function(a,b){/sugarcrm/i.test(Yi(b))?d.D("Look like SugarCRM web site, but REST V4 API is not available."):200==b.O()?d.D("Not a SugarCRM web site"):d.D("Invalid respond, "+b.O())})}function c(a,b){var c=new Ad;c.add("method","get_server_info");c.add("input_type","json");c.add("response_type","json");c.add("rest_data","{}");f.request(new ai(a,"POST",{},{"Content-Type":"application/x-www-form-urlencoded"},c.toString())).execute(b)}
var d=new D;a=a.trim();sa(a,"http")||(a="https://"+a);var e=new td(a);zd(e,"");yd(e,null);var f=Zh("proxy"),g=e.ga();a=e.Fc;/rest.php$/.test(a)||(/index.php$/.test(a)?xd(g,a.replace("/index.php","")):xd(g,""));var k=g.toString();(function(a,b){c(a+"/service/v4/rest.php",function(a,c){if(200==c.O()){if(!a||!a.version){var d=Yi(c);if(x(d))try{a=JSON.parse(d)}catch(e){b(null,c);return}else a=d}a&&a.version&&b(a,c)}else b(0,c)})})(k,function(a,f){a?(a.isLogin=!1,a.userName=null,a.domain=g.K(),a.baseUrl=
k,d.C(a)):0==a?"https"==e.nc?(ud(g,"http"),setTimeout(function(){c(g.toString(),function(a,c){c.Ga()?d.C(a):b()})},100)):d.D(f.O()+" "+f.Ma()+" "+Yi(f)):b()});return d}h.toString=function(){return"SugarClient:"+this.j};
function ur(a,b,c){if("about"==b)return tb(ir(a));if("details"==b)return kr(a);if("get"==b)return gr(a,c.module,c.id,c.index);if("fetch-module"==b)return dr(a,c);if("info-module"==b)return A(c)&&x(c.module)&&(c=c.module),cr(a,c);if("list"==b)return u(c)?a.list(c):F("query must be an array");if("list-module"==b)return jr(a);if("login-user"==b)return fr(a);if("put-record"==b||"new-record"==b){b=c.module;if(!b||-1==iq.indexOf(b))return F("invalid module name: "+b);c=c.record;return A(c)?lr(a,b,c):F("record object required")}if("search"==
b)return u(c)?a.search(c):F("query must be an array");if("server-info"==b)return hr(a);if("rest"==b){if(!A(c))return F("REST parameter must be an object");b=c.method;c=c.params;return x(b)&&0!=b.length?A(c)?$q(a,b,c):F("REST parameter must be an object"):F("method must be valid string")}return F("invalid req "+b)};function vr(a){Error.captureStackTrace?Error.captureStackTrace(this,vr):this.stack=Error().stack||"";a&&(this.message=String(a))}C(vr,Error);vr.prototype.name="ydn.gdata.error.InvalidAtomFormatError";function wr(a){Error.captureStackTrace?Error.captureStackTrace(this,wr):this.stack=Error().stack||"";a&&(this.message=String(a))}C(wr,Error);wr.prototype.name="ydn.gdata.error.IncompatibleError";var xr="atom app gd xhtml batch openSearch".split(" ");function yr(a){if(!t(this.type))throw new Ih("Abstract class cannot be instantiated.");if(x(a))a={id:{$t:a}};else if(!t(a.id)||!x(a.id.$t))throw new Dh("Invalid GDataFeed");this.id=a.id.$t;this.data=a;t(this.data.entry)?u(this.data.entry)||(this.data.entry=[this.data.entry]):this.data.entry=[];this.j={};this.o={};a=u(this.data.entry)?this.data.entry.length:0;for(var b=0;b<a;b++){var c=this.data.entry[b],c=c.id?c.id.$t:c.Sg?c.Sg.$t:"";if(0==c.length)throw new vr("entry "+b);if(0==c.match(/\w+$/)[0].length)throw new vr("entry "+
b+" of "+c);var d=c.match(/\w+$/)[0];this.j[c]=this.data.entry[b];this.o[d]=this.data.entry[b]}this.i=!0;this.H=[];this.s=new kh(function(){this.dispatchEvent(zr)},300,this);this.zg=null;this.h=NaN;this.p=void 0}C(yr,sh);var zr="i";h=yr.prototype;h.If=function(){return this.kind};h.logger=R("ydn.gdata.Feed");
h.Sb=function(a){var b=new D;Q(this.logger,this+" receiving a task, ready: "+this.i);var c=this;this.i?(this.i=!1,b.ca(function(){Q(c.logger,c+" finish the task.");c.i=!0;var a=c.H.shift();a&&a.call(this)}),a.call(this,b)):this.H.push(oa(na(a,this),b));return b};h.zg=null;function Ar(a){var b;if(!(b=a.zg))if(a=a.se(),t(a)){b=a;for(var c=0;c<Qi.length;c++){var d=(0,Qi[c])(a);if(d){b=d;break}}Q(Oi,"Resolving "+a+" to "+b);b=Pi[b]||null}else b=Pi["default"];return b}h.jf=function(){this.dispatchEvent("e")};
h.bg=function(){return xr};h.Ug=function(a){a.g()||M(this.logger,"Batch submission failed. "+a.responseText)};
h.Oc=function(a,b){var c=this.bg(),d=void 0;t(c)||(c=xr);for(var e="",f=0;f<c.length;f++)var g=c[f],e=0==f?e+(' xmlns="'+kp[g]+'" '):e+(" xmlns:"+g+'="'+kp[g]+'" ');d=t(d)?"<id>"+d+"</id>":"";d=Bh("<feed"+e+">"+d+"</feed>");for(f=c=0;e=this.uc(f);f++)if(Bp(e))zp(e,"");else if(Cp(e.data)){var g="delete"==Ap(e.data),k=!(!e.data.id||!e.data.id.$t);zp(e,null);var l=wp(new rp(null,"entry",e.data),d.documentElement),m=l.getElementsByTagNameNS(mp("batch"),"operation");m[0]?m=m[0]:m=l.appendChild(d.createElementNS(mp("batch"),
"operation"));l=d.createAttribute("type");l.nodeValue=g?"delete":k?"update":"insert";m.setAttributeNode(l);zp(e,"committed");c++;a&&a.message({id:this.Hf(),code:"operation: "+l.nodeValue+" "+e})}if(0==c)return O(this.logger,this+" Nothing to commit."),0;O(this.logger,this+" committing "+c+" entries.");d=Ch(d);b?(this.logger.info("Commit ignored for dry run."),window.console.log(d)):(e=na(this.Ug,this),this.M&&this.M.stop(),f=Ar(this),g=this.Ie(),f.send(g,e,{method:"POST",body:d,headers:{"Content-Type":"application/atom+xml"},
params:{}}));return c};h.re=function(a){return new xp(a)};h.uc=function(a){return 0<=a&&a<this.data.entry.length?this.re(this.data.entry[a]):null};h.Gf=function(a){return(a=this.j[a])?this.re(a):null};
h.save=function(a){if(this.store){var b=this;this.l||(this.l=new kh(function(){this.Sb(function(a){var d=b.toJSON(),e=b.data.entry,f,g,k;b.store.Y(function(a){a.put("ydn.gdata.feed",d).Mc(function(a){throw a;}).A(function(){f=!0});a.put("ydn.gdata.entry",e).Mc(function(a){throw a;}).A(function(a){k=a.length;g=!0})},["ydn.gdata.feed","ydn.gdata.entry"],"readwrite").u(function(){f&&g?Q(this.logger,b+": saved "+k+" entries."):Q(this.logger,b+": saved failed"+e.length+" entries.");a.C(!0)},function(a){throw a;
},this)})},1E3,this));a?mh(this.l):lh(this.l)}};
function Br(a,b,c){c=c||new D;var d=Ar(a);if(!d)return M(a.logger,a+": No transport available."),c.D(Error("No transport available.")),c;d.send(b,function(b){if(200==b.status){a.h=B();b=b.Q?mf(b.Q.responseText):void 0;if(!b.feed)throw new vr("feed missing.");var d=b.feed;if(!t(d))throw b=yh(d),new vr(b.substr(0,50));if(d.id.$t!=a.F())throw new wr(d.id.$t+" is not "+a.F());var g=b=0,k=u(d.entry)?d.entry:d.entry?[d.entry]:[];b=k.length;0==b&&Q(a.logger,a+": fetch return no result.");for(var l=0;l<b;l++){for(var m=
a,n=k[l],p=n instanceof xp?n:m.re(n),r=p,s=0;s<r.sc.length;s++)null!=r.data[r.sc[s]]&&!u(r.data[r.sc[s]])&&(r.data[r.sc[s]]=[r.data[r.sc[s]]]);zp(r,null);r=r.data;r.batch$status&&(r.batch$status=void 0);r.batch$operation&&(r.batch$operation=void 0);var r=p.F(),w=m.Gf(r);(s=!!w)?w.update(p):(w=yp(p),m.data.entry.push(n),m.j[r]=p.data,m.o[w]=p.data);!s&&g++}O(a.logger,a+" "+b+" ("+g+" new) entries received");a.jf();(d=Do(d,"next"))?(a.save(),lh(a.s),a.p=d.$t,Br(a,d.href,c)):(0<b&&(a.save(),lh(a.s)),
c.C(!0))}else M(a.logger,"Fetching "+b.uri+" failed: "+b.status),c.D(!1)});return c}h.toString=function(){return this.type+":"+this.id};function Cr(a,b){a.Gg&&b.g.set("v",a.Gg);b.g.set("alt","json");b.g.set("showdeleted",!0)}
function Dr(a,b){var c="lu",d=!1;if("lf"==c){if(a.h){var d=!0,e=new Date(a.h),e=e.toISOString();b.g.set("updated-min",e)}}else if("lu"==c){for(var e=0,f=-1,g,k=0;g=a.uc(k);k++)g=g.data.updated.$t,e<g&&(e=g,f=k);if(e=a.uc(f))e=new Date(e.data.updated.$t),e=new Date(1+ +e),e=e.toISOString(),b.g.set("updated-min",e)}else"lo"==c?(b.g.set("orderby","lastmodified"),a.h&&b.g.set("max-results","1")):c="no";Q(a.logger,a+" updating "+(d?"continue":"begin")+" by "+c)}h.ci=hp.prototype.le;h.F=hp.prototype.F;
h.ei=hp.prototype.Yh;h.di=hp.prototype.Xh;h.se=function(){return this.ei()||""};h.Hf=function(){return this.id};h.Ie=function(){return this.di()};function Er(a){return a.Sb(function(a){var c=new td(this.se());Cr(this,c);Dr(this,c);this.U(qh,!1);Br(this,c.toString()).ca(function(c){th(this);c?a.C(!0):a.D(void 0)},this)})}h.update=function(a){return a||!0!==("undefined"==typeof this.g?null:(this.g&qh)==qh)?Er(this):(Q(this.logger,this+" already loaded."),tb(!1))};
h.count=function(a){if(a){a=0;for(var b,c=0;b=this.uc(c);c++)Bp(b)||"deleted"==Ap(b.data)||a++;return a}return this.data.entry.length};h.toJSON=function(){return{id:this.id,key:this.Hf(),last_fetch_next_uri:this.p,last_fetch:this.h}};function Fr(a){var b,c=a.match(/^\D*0*(\d{1,2}\D)?\D*0*(.+)/);c?(b=c[1].replace(/\D/g,""),a=c[2].replace(/\D/g,"")):a=a.replace(/\D/g,"");return{rb:b,hb:a}}function Gr(a,b){var c=Fr(a),d=Fr(b);if(t(c.rb)&&t(d.rb)&&0!=c.rb.length&&0!=d.rb.length&&c.rb!==d.rb)return 0;if(t(c.gb)&&0!=c.gb.length){if(t(d.gb)&&0!=d.gb.length){if(c.gb.length>=d.gb.length){for(var e=0;e<d.gb.length;e++)if(c.gb[e]!=d.gb[e])return 0;return 1}for(e=0;e<c.gb.length;e++)if(c.gb[e]!=d.gb[e])return 0}return-1}return 1}
function Hr(a,b){if(!a||!b||0==a.length||0==b.length)return 0;a=a.trim();b=b.trim();var c=Fr(a),d=Fr(b);return c.rb&&c.hb&&c.rb==d.rb&&c.hb==d.hb?6<=c.hb.length?1:4<=c.hb.length?0.8:0.4:c.hb&&4<=c.hb.length&&c.hb==d.hb?8<=c.hb.length?0.8:4<=c.hb.length?0.6:0.4:0};function Ir(a){xp.call(this,a);a=(a=this.id.match(/https?:\/\/www.google.com\/m8\/feeds\/(group|contact|batch)s?\/([^\/]+)\/?(\w+)\/?(\w*)?/))?{oi:"m8",kind:a[1],user_id:a[2]?a[2].replace("%40","@"):"",projection:a[3],id:a[4]}:null;window.console.assert(!!a,"Invalid m8 entry: "+this.id);this.user_id=a.user_id;window.console.assert(a.kind==this.kind,"Invalid kind: "+a.kind+" vs "+this.kind)}C(Ir,xp);Ir.prototype.logger=R("ydn.gdata.m8.Entry");Ir.prototype.g="3.0";Ir.prototype.type="m8";
Ir.prototype.toString=function(){var a=this.id?yp(this):void 0;return"m8.Entry."+this.kind+":"+a};function Jr(a){if(!t(this.kind))throw new Ih("Abstract class cannot be instantiated.");yr.call(this,a);this.user_id=this.F()}C(Jr,yr);h=Jr.prototype;h.If=function(){return this.kind};h.Gg="3.0";h.type="m8";h.toString=function(){return"Feed:"+this.kind+":"+this.user_id};h.se=function(){return"https://www.google.com/m8/feeds/"+this.If()+"s/"+this.user_id.replace("@","%40")+"/full?v=3.0"};
h.Ie=function(){var a=Jr.m.Ie.call(this);return a?a:"https://www.google.com/m8/feeds/"+this.If()+"s/"+this.user_id.replace("@","%40")+"/full/batch?v=3.0"};var Kr=xr.concat(["gContact"]);Jr.prototype.bg=function(){return Kr};function Lr(a,b,c,d,e,f){this.scheme=a;this.domain=b;this.module=c;this.g=d;this.i=y(e)?e:NaN;this.h=y(f)?f:NaN}var or="sugarcrm";function Mr(a){if(!A(a)||!x(a.value))return null;var b=Nr(a.value);if(!b)return null;var c=NaN,d=NaN;if(x(a.label)){a=a.label;var e=a.indexOf("#"),f=a.indexOf("-");0<e&&0<f&&f>e&&(c=parseInt(a.substring(e,f),10),d=parseInt(a.substring(f),10))}return new Lr(b[1],b[2],b[3],b[4],c,d)}function Nr(a){return a?a.match(/(\w+):\/\/([^\/]+)\/([^\/]+)\/(.*)/):null}
Lr.prototype.S=function(){return this.scheme+"://"+this.domain+"/"+this.module+"/"+this.g};function Or(a){Ir.call(this,a)}C(Or,Ir);h=Or.prototype;h.kind="contact";h.logger=R("ydn.gdata.m8.ContactEntry");h.Ff=function(){return"contact"};h.getName=function(a){var b=a?"":this.ld();if(a||0==b.length)a=this.data.gd$name,A(a)&&(b=a.gd$fullName.$t||"",0==b.length&&(b=(a.gd$givenName.$t||"")+" "+(a.gd$familyName.$t||"")));return xa(b)};function Pr(a){var b=a.data.gd$email;a=[];for(var b=u(b)?b:b?[b]:[],c=0;c<b.length;c++)a.push(b[c].address);return a}
function Qr(a){a=a.data.gd$phoneNumber;a=u(a)?a:A(a)?[a]:[];for(var b=[],c=0;c<a.length;c++)a[c].$t&&!va(a[c].$t)&&b.push(a[c].$t);return b}h.Ke=function(){var a=Or.m.Ke.call(this);if(a.ydn$emails||a.ydn$xp||a.ydn$externalIds)a==this.data&&(a=Ul(this.data)),delete a.ydn$emails,delete a.ydn$xp,delete a.ydn$externalIds;return a};h.sc="link category gd$email gd$im gd$organization gd$phoneNumber gd$structuredPostalAddress gd$formattedAddress".split(" ");
function Rr(a,b){function c(a){var b=Va(e,function(b){return b.address===a.address});b?b.rel=t(a.rel)?a.rel:b.rel:d(a)}function d(a){a=Ul(a);f&&delete a.primary;t(void 0)&&(a.rel=void 0);e.push(a)}for(var e=[Ul(a.data.gd$email[0])],f=!!a.data.gd$email[0].primary,g=1;g<a.data.gd$email.length;g++)c(a.data.gd$email[g]);for(g=0;g<b.length;g++)c(b[g]);g=Cl(e,a.data.gd$email);g||(a.data.gd$email=e);return!g}
function Sr(a,b){function c(a){var b=Sa(e,function(b){return Hr(b.$t,a.$t)}),c=Th(b);if(0.4<c.value){var b=e[c.index],f=t(a.rel)?a.rel:b.rel;1==c.value?(b.rel=f,b.$t=a.$t):t(a.rel)&&t(b.rel)&&b.rel!==a.rel?d(a,f):(b.rel=f,c=Gr(b,a),-1==c?b.$t=a.$t:0==c&&(b.$t=a.$t))}else d(a)}function d(a,b){a=Ul(a);f&&delete a.primary;t(b)&&(a.rel=b);e.push(a)}for(var e=[Ul(a.data.gd$phoneNumber[0])],f=!!a.data.gd$phoneNumber[0].primary,g=1;g<a.data.gd$phoneNumber.length;g++)c(a.data.gd$phoneNumber[g]);for(g=0;g<
b.length;g++)c(b[g]);g=Cl(e,a.data.gd$phoneNumber);g||(a.data.gd$phoneNumber=e);return!g}h.pf=function(a,b){if("gd$phoneNumber"==a){if(null!=this.data.gd$phoneNumber)return Sr(this,b);this.data.gd$phoneNumber=Ul(b);return!0}if("gd$email"==a){if(null!=this.data.gd$email)return Rr(this,b);this.data.gd$email=Ul(b);return!0}return Or.m.pf.call(this,a,b)};
function nr(a,b,c,d,e){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var f=0;f<a.length;f++){var g=Mr(a[f]);if(g&&!(b&&b!=g.scheme||c&&c!=g.domain||e&&e!=g.g||d&&d!=g.module))return g}return null}function qr(a){a=a.data;a=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var b=[],c=0;c<a.length;c++){var d=Mr(a[c]);d&&b.push(d)}return b};function Tr(a){Jr.call(this,a)}C(Tr,Jr);h=Tr.prototype;h.logger=R("ydn.gdata.m8.ContactFeed");h.kind="contact";h.jf=function(){Tr.m.jf.call(this)};h.Gf=function(a){return Tr.m.Gf.call(this,a)};h.re=function(a){return new Or(a)};h.uc=function(a){return Tr.m.uc.call(this,a)};h.se=function(){return"https://www.google.com/m8/feeds/contacts/"+this.F()+"/full"};h.Hf=function(){return"http://www.google.com/m8/feeds/contacts/"+this.F().replace("@","%40")};function Ur(a){function b(a){sa(a,"atom:")&&(a=a.substring(5,a.length));return a.replace("#text","$t").replace(/:/g,"$")}x(a)&&(a=Bh(a));var c={};if(1==a.nodeType){if(0<a.attributes.length)for(var d=0;d<a.attributes.length;d++){var e=a.attributes.item(d);c[b(e.nodeName)]=e.nodeValue}}else 3==a.nodeType&&(c=a.nodeValue);if(a.hasChildNodes())for(d=0;d<a.childNodes.length;d++){var e=a.childNodes.item(d),f=b(e.nodeName);if("undefined"==typeof c[f])"content"==f?(c[f]={$t:Ch(e)},e.namespaceURI&&(c[f].xmlns=
e.namespaceURI)):c[f]=Ur(e);else{if("undefined"==typeof c[f].length){var g=c[f];c[f]=[];c[f].push(g)}c[f].push(Ur(e))}}return c};function Vr(a,b){this.id=b.replace("@","%40");this.client=this.g=null;this.i=new nh(function(){O(this.logger,"updating gdata "+this);Wr(this).u(function(a){this.logger.info(this+" synced, "+a+" new entries updated.")},function(){M(this.logger,this+" update failed.")},this)},6E4,this);this.j=a;this.h=null}h=Vr.prototype;h.logger=R("ydn.ds.gdata.GData");h.update=function(){oh(this.i)};h.L=function(){return this.j};function Xr(a){var b=new D;a.execute(function(a,d){a?b.C(a):b.D(d)});return b}
function Yr(a,b){var c=(a.client?a.client:Zh("gse")).request(b);return Xr(c).u(function(a){a=a.feed;if(!a.entry)return 0;for(var b=(new Tr(a)).ci("next"),c=a.entry.length,g=!!this.h,k=0;g&&k<c;k++){var l=a.entry[k];l.gContact$externalId&&this.h(l)}return this.L().put(this.J(),a.entry).A(function(){return b?Yr(this,new ai(b.href)).A(function(a){return c+a},this):c},this)},function(a){M(this.logger,"fetching fail "+(a?a.O()+" "+a.Ma():""))},a)}h.getParams=function(){return{alt:"json"}};
h.get=function(a){return x(a)&&0!=a.length?this.L().get(this.J(),a):F("invalid key")};h.put=function(a){return this.L().put(this.J(),a)};h.Fg=function(a){return new xp(a)};function Zr(a,b){var c=a.Fg(b);zp(c,"modified");return c.Oc().A(function(a){a=Ur(a);var b=a.entry;if(!b||!b.id)throw Error("Invalid respond on saving gdata "+xh(a));delete b.updated;this.L().put(this.J(),b);return b},a)}
function Wr(a){if(!a.L().getName())return F(Error("database not ready"));if(!a.g){var b=new Vj(a.J(),"updated.$t",null,!0);a.g=a.L().keys(b,1).A(function(a){var b=this.getParams();b.orderby="lastmodified";a[0]?(b.sortorder="descending",a=(new Date(1+ +new Date(a[0]))).toISOString(),b["updated-min"]=a):b.sortorder="ascending";return Yr(this,new ai($r(this)+"/full","GET",b)).ca(function(){this.g=null},this)},a)}return a.g}h.toString=function(){return"GData:contact:"+this.id.replace("%40","@")};function as(a,b){Vr.call(this,a,b)}C(as,Vr);as.prototype.J=function(){return"contact"};as.prototype.getParams=function(){var a=as.m.getParams.call(this);a.v="3.0";return a};function $r(a){return"https://www.google.com/m8/feeds/contacts/"+a.id}as.prototype.Fg=function(a){var b=!!a.id;b||(a.id={$t:$r(this)+"/base/0"});var c=new Or(a);b||delete a.id;return c};function bs(a,b){return x(b)?0==b.length?tb([]):a.L().values(a.J(),"ydn$emails",T.only(b),100,0,!1,!0):F("invalid key for email "+b)}
function cs(a,b){var c=b.S();if(!x(c)||0==c.length)return F("invalid key for external id "+c);c=T.only(c);return a.L().values(a.J(),"ydn$externalIds",c).A(function(){},a)}
function ds(a,b,c){return a.L().get(a.J(),b).A(function(a){if(a){if(!c||!c.label||!c.value)return F("invalid external_id_data");var e=c.label,f=c.value;a.gContact$externalId=u(a.gContact$externalId)?a.gContact$externalId:a.gContact$externalId?[a.gContact$externalId]:[];for(var g=!1,k=0;k<a.gContact$externalId.length;k++)if(a.gContact$externalId[k].value==f){a.gContact$externalId[k].label=e;g=!0;break}g||a.gContact$externalId.push({label:e,value:f});return Zr(this,a)}throw Error("gdata entry "+b+" not found");
},a)};function es(a){this.g=a;this.i=0;this.j=[];this.l=[0,0,0,0];this.h=new Kinetic.Layer;a=this.g/2;var b=a/3;this.o=[a,a,b,this.g-b];this.p=[a,b,this.g-b,this.g-b]}es.prototype.clear=function(){this.h=new Kinetic.Layer};var fs=Math.pow(2,2),gs=Math.pow(2,3),hs=Math.pow(2,4),is=Math.pow(2,5);es.prototype.U=function(a,b){this.i=b?this.i|a:this.i&~a};
function js(a){a.clear();for(var b=[["#C2C2C2","#6B6B6B","#525252","#3D3D3D"],["#FAFAFA","#D8D8D8","#D8D8D8","#C2C2C2"],["#FCCA03","#DD1812","#0140CA","#16A61E"]],c=["m252,324c0,-59.647 48.354,-108 108,-108c26.90799,0 51.51501,9.843 70.42401,26.121c1.03198,-8.564 1.57599,-17.27901 1.57599,-26.121c0,-119.126 -96.43701,-215.722 -215.49899,-215.994c40.89099,0.137 73.99899,33.321 73.99899,74.244c0,41.007 -33.24301,74.25 -74.25,74.25c-41.008,0 -74.25,-33.243 -74.25,-74.25c0,-40.979 33.19701,-74.203 74.16701,-74.248c-0.05602,0 -0.11201,-0.002 -0.16701,-0.002c-119.294,0 -216,96.707 -216,216c0,8.843 0.544,17.55701 1.577,26.121c18.908,-16.278 43.515,-26.121 70.423,-26.121c59.646,0 108,48.353 108,108c0,37.93399 -19.561,71.29401 -49.14301,90.56c26.127,11.21701 54.90701,17.44 85.14301,17.44s59.01599,-6.22299 85.14301,-17.44c-29.582,-19.26599 -49.14301,-52.62601 -49.14301,-90.56z",
"m142,74.25c0,41.007 33.242,74.25 74.25,74.25c41.00699,0 74.25,-33.243 74.25,-74.25c0,-40.923 -33.108,-74.107 -73.99899,-74.244c-0.112,0 -0.22301,-0.004 -0.334,-0.004c-40.97,0.045 -74.16701,33.269 -74.16701,74.248z","m180,324c0,-59.647 -48.354,-108 -108,-108c-26.908,0 -51.515,9.843 -70.424,26.121c9.366,77.69 59.967,142.67798 129.28099,172.43799c29.582,-19.26498 49.14301,-52.625 49.14301,-90.55899z","m430.42401,242.121c-18.909,-16.278 -43.51602,-26.121 -70.42401,-26.121c-59.646,0 -108,48.353 -108,108c0,37.93399 19.561,71.29401 49.142,90.56c69.315,-29.76199 119.91602,-94.74899 129.28201,-172.439z"],
d=b[0].slice(),e=[fs,gs,hs,is],f=0;f<e.length;f++){var g=e[f];(a.i&g)==g&&(d[f]=b[2][f])}b=new Kinetic.Group({scaleX:a.g/435,scaleY:a.g/435});e=new Kinetic.Group;for(f=0;f<c.length;f++)a.j[f]=new Kinetic.Path({data:c[f],fill:d[f]}),0<a.l[f]&&(g=a.g/19*8,g=new Kinetic.Text({x:a.o[f]-g/4,y:a.p[f]-g/2,text:String(a.l[f]),fontSize:g,fontFamily:"sans-serif",fill:"white"}),e.add(g)),b.add(a.j[f]);a.h.add(b);a.h.add(e);return a.h};function ks(a){this.g=document.createElement("div");this.h=a||19;this.i=new es(this.h);this.j=new kh(function(){this.render()},100,this);chrome.runtime.onSuspend&&chrome.runtime.onSuspend.addListener(function(){chrome.browserAction.setTitle({title:"suspended"});this.U(gs,!1);this.U(hs,!1);this.U(is,!1);this.U(fs,!1);this.render()}.bind(this))}ks.prototype.n=function(){return this.g};ks.prototype.U=function(a,b){this.i.U(a,b);mh(this.j)};
ks.prototype.render=function(){this.g.parentElement||document.body.appendChild(this.g);(new Kinetic.Stage({container:this.g,width:this.h,height:this.h})).add(js(this.i));if(chrome.browserAction){var a=this.g.querySelector("canvas"),b=a.getContext("2d");chrome.browserAction.setIcon({imageData:b.getImageData(0,0,a.width,a.height)})}};function wo(a,b){this.g=a;this.filter=b||null;var c=this;setTimeout(function(){ls(c)},6E5*Math.random())}
function ls(a){var b=a.g.getName(),c={"Content-Type":"application/json"};a.g.values("log",null,20).A(function(a){if(0!=a.length){var e=a.map(function(a){return a.key});a=JSON.stringify(a);a=new ai("https://mhardartway.s3.amazonaws.com/"+(b+"/"+e[0]),"PUT",null,c,a);var f=Zh(),e=e.map(function(a){return new rk("log",a)});f.request(a).execute(function(a,b){b.Ga()&&this.g.remove(e).A(function(a){a==e.length&&ls(this)},this)},this)}},a)}wo.prototype.log=function(){};function ms(){this.Y=null;this.g={};this.h=null;var a=this.M=new Xh,b=chrome.extension.getURL("option-page.html");a.p=b;this.G=new Vn;this.i=this.p=this.l=this.s=null;this.H=new ug(new yg,"XMLHttpRequest"+location.host);this.o=new ks;chrome.permissions.onAdded.addListener(this.xh.bind(this))}h=ms.prototype;h.logger=R("ydn.crm.app.App");
h.xh=function(a){for(var b=(a=a.origins)?a.length:0,c=0;c<b;c++){var d=a[c].match(/https:\/\/([^\/]+)/);d&&(d=this.g[d[1]])&&O(this.logger,"host permission granted to "+d)}};h.init=function(){P(this.logger,"init "+this);this.o.U(fs,!0);var a=Zh($h);a||(qo||(qo=new ho(so()),Ui(qo,"default")),a=new go(so(),void 0,"https://yathit-app.appspot.com",1,!0),Ui(a,$h))};
function ns(a,b){function c(a){return a.ed().A(function(){var b=a.isLogin()?a.i+"@":" (not login) ";this.logger.info("connected to sugarcrm client: "+b+e);a.isLogin()&&(this.g[e]=a,this.H.set(k,l),b=Object.keys(this.g),ao(this.G,b),a.update(),os(this));return ir(a)},this)}var d=b.baseUrl,e=b.domain||d;if(!e)return F("domain or url required.");e=e.trim();sa(e,"http")&&(e=(new td(e)).K());/\//.test(e)&&(e=(new td("https://"+e)).K());if(d&&(d=d.trim(),!sa(d,"http"))){var d=d.replace(/:?\/\//,""),f=new td("https://"+
d);f.Fc||xd(f,"/");d=f.toString()}var g=a.g[e],k="sugar-client-"+e,l=a.H.get(k)||{};if(g)return g.isLogin()?tb(ir(g)):c.call(a,g);var m=b.userName||l.userName;d||(d=l.base_url);d||(d="https://"+e+"/");if(!m)return P(a.logger,"username not found in "+JSON.stringify(b)),F("username required");var n=b.password;n?b.hashed||(n=CryptoJS.MD5(n).toString()):n=l.password;if(!n)return P(a.logger,"password not found in "+JSON.stringify(b)),F("password required.");l.userName=m;l.password=n;l.base_url=d;var p=
new D;chrome.permissions.contains({origins:[d+"/"]},function(b){b||M(a.logger,"host permission required for "+d);b=b?Zh("default"):Zh("proxy");g=new Xq(b,a,d,m,n);qb(c.call(a,g),p)});return p}function ps(a,b,c,d){return 0<=iq.indexOf(b)?a.h.get(c).A(function(a){if(a){var f=iq[iq.indexOf(b)];return rr(d,f,a).A(function(a){if(a&&a.id)return a;throw Error("Set Entry to "+f+" failed");},this)}throw Error("contact entry "+c+" not found");},a):F(new Dh("invalid module name "+b))}
function qs(a,b){var c=new Oq(b.domain,b.module,b.obj),d={};Vq(c,d);c=new Lr(or,c.K(),c.module,c.F(),NaN,Qq(c));d.gContact$externalId=[{label:c.module+"#"+c.i+"-"+c.h,value:c.S()}];return Zr(a.h,d)}function br(a,b){var c=new Lr(or,b.K(),b.module,b.F());cs(a.h,c).A(function(a){for(var c=0;c<a.length;c++){var f=a[c];0<Vq(b,f)&&this.h.put(f)}},a)}function os(a){var b=!1,c;for(c in a.g)if(a.g[c].isLogin()){b=!0;break}a.o.U(fs,!0);a.o.U(is,a.isLogin());a.o.U(gs,b)}
function rs(a,b){if(!b)return F("domain required");a.H.remove("sugar-client-"+b);return $n(a.G).A(function(a){a=a||[];var d=a.indexOf(b);0<=d&&(a.splice(d,1),ao(this.G,a));return this.g[b]?sr(this.g[b]).A(function(){delete this.g[b];this.logger.info("SugarCRM "+b+" removed.");os(this);return!0},this):!1},a)}
h.Ih=function(a){for(var b=u(a.gContact$externalId)?a.gContact$externalId:[a.gContact$externalId],c=0;c<b.length;c++)if(b[c]&&b[c].value&&b[c].label){var d=Nr(b[c].value);d&&"sugarcrm"==d[1]&&(d=d[2],this.g[d]&&pr(this.g[d],new Or(a)))}};function ss(a){a.h=new as(a.G.g,a.i.email);var b=Zh("gse");a.h.client=b;a.h.h=a.Ih.bind(a);a.h.update()}
function ts(a,b){var c=new D,d=b.email||"";if(a.i&&a.i.email==d)return P(a.logger,"already running for "+d),c.C(a.i),c;a.i=b;a.i.updated=B();d?(a.logger.info(d+" login to YDN server"),xo(a),Wn(a.G,b.Id.$t),ss(a),$n(a.G).A(function(a){a=a||[];for(var b=0;b<a.length;b++)a[b]&&ns(this,{domain:a[b]})},a),c.C(a.i),a.isLogin()?(a.o.U(is,!0),chrome.browserAction.setTitle({title:"Ready"})):(a.o.U(is,!1),chrome.browserAction.setTitle({title:"Login required."}))):(a.logger.info("Not login to YDN server"),c.C(a.i),
a.o.U(is,!1),chrome.browserAction.setTitle({title:"Login required."}));return c}function us(a){var b=new D;zo().request(new ai("/token","DELETE")).execute(function(a,d){d.Ga()?(this.l=this.s=null,b.C(null)):b.D("error "+d.Ma())},a);return b}
function vs(a,b){var c=A(b)?b:{last_login:"1"},d=zo(),e=new D;d.request(new ai("/audit","GET",c)).execute(function(a,b){if(b.Ga()){if(a.LastLoginRecord){var c=a.LastLoginRecord;if(c.timestamp){var d;d=c.timestamp-B();d=Math.abs(d);if(6E4>d)d="0 minutes";else{var m=Math.floor(d/864E5);d%=864E5;var n=Math.floor(d/36E5),p=Math.floor(d%36E5/6E4),r=Sd(String(m)),s=Sd(String(n)),w=Sd(String(p));d=m*(n+p)?" ":"";var z=n*p?" ":"",m=Fe("{COUNT, plural, =0 {}=1 {{TEXT} day}other {{TEXT} days}}",m,r),n=Fe("{COUNT, plural, =0 {}=1 {{TEXT} hour}other {{TEXT} hours}}",
n,s),p=Fe("{COUNT, plural, =0 {}=1 {{TEXT} minute}other {{TEXT} minutes}}",p,w);d=m+(d+(n+(z+p)))}c.ago=d}}e.C(a)}else e.D(b)},a);return e}
function ij(a,b){if(a.l)return a.l;if(a.s&&a.s.expires>B())return tb(a.s);a.l=new D;var c={url:b||chrome.extension.getURL("option-page.html")},c=new ai("/token","GET",c);zo().request(c).execute(function(a,b){if(b.Ga()){var c=a.Tokens[0];c.has_token?(c.expires=1E3*c.expires_in+B(),this.s=c,this.l.C(c)):this.l.D(c)}else this.s=null,this.l.D(b);this.l=null},a);return a.l}h.isLogin=function(){return!!this.i&&this.i.is_login};
function ws(a,b){if(a.p)return a.p;a.p=Yh(a.M,b).A(function(b){return ts(this,b).A(function(){a.isLogin()?setTimeout(function(){a.p=null},9E5):a.p=null},function(a){this.logger.info("Attamping to login YDN server fail: "+xh(a))})},a);return a.p}function xs(a){a.p=null;a.i=null;a.o.U(is,!1)}h.toString=function(){return"SugarApp:0.7.23"};function ys(){ms.call(this);this.j={};zs(this)}C(ys,ms);ys.prototype.logger=R("ydn.crm.app.EventPage");
function As(a,b,c){var d=c.req;c.done=!0;var e=null!=c.data?c.data:{};P(a.logger,"service req: "+d+":"+c.id);if("app-setting"==d)c.data=q.localStorage.getItem("app-setting"),b.postMessage(c);else if("echo"==d)P(a.logger,"resp: "+d+":"+c.id),b.postMessage(c);else if("export-record"==d)qs(a,e).u(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="failed to create a new entry";b.postMessage(this)},c);else if("feed-log"==d){var f=
e.offset||0,e=e.limit||100;mo.g.values("db-logger",null,e||100,f||0,!0).ca(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c)}else if("feed-log-info"==d)f=e.offset||0,e=e.limit||100,oo(e,f).ca(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-fetch"==d)e=c.data,"contact"==e?a.h?Wr(a.h).u(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):(c.error="gdata not ready",
b.postMessage(c)):(c.error="invalid kind "+e,b.postMessage(c));else if("gdata-list-contact-by-email"==d)bs(a.h,c.data).A(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token"==d)ij(a,c.data).ca(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("gdata-token-revoke"==d)us(a).u(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp: "+
this.req+":"+this.id);this.data=c;b.postMessage(this)},c);else if("list-sugarcrm"==d){e=[];for(f in a.g)e.push(ir(a.g[f]));P(a.logger,"resp: "+c.req+":"+c.id);c.data=e;b.postMessage(c)}else"log-bug"==d?(Ni(c.data),b.postMessage(c)):"login-info"==d?ws(a,c.data).u(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="invalid login";b.postMessage(this)},c):"logged-in"==d?(ws(a,null).A(function(b){Bs(a,{req:d,info:b})}),b.postMessage(c)):
"logout"==d?(xs(a),Bs(a,{req:d}),b.postMessage(c)):"new-entry"==d?A(c.data)?Zr(a.h,c.data).u(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(a){this.data=a;this.error="failed to create a new entry";b.postMessage(this)},c):(c.error="Invalid gdata entry data",b.postMessage(c)):"new-sugarcrm"==d?ns(a,c.data).u(function(){P(a.logger,"resp: "+this.req+":"+this.id);this.data=!0;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"remove-sugar"==
d?rs(a,c.data).ca(function(a){this.data=a;b.postMessage(this)},c):"server-audit-log"==d?vs(a,e).u(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},c):"sugar-server-info"==d?(e=c.data,e=/https?:/.test(e)?new td(e):vd(new td,e),(e=a.g[e.K()])?hr(e).A(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},c):tr(c.data).u(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,
"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},c)):"user-setting"==d?bo().A(function(a){this.data=a;b.postMessage(this)},c):M(a.logger,"Main channel unknown req: "+d)}
function Cs(a,b,c,d){var e=d.req;d.done=!0;P(a.logger,"sugar service req: "+c+":"+e+":"+d.id);if(a.isLogin())if("echo"==e)b.postMessage(d);else if("import-gdata"==e){var f=d.data,g=f?f["gdata-id"]:"";g?ps(a,f.module,g,c).u(function(a){this.data=a;b.postMessage(this)},function(a){this.error=a;b.postMessage(this)},d):(M(a.logger,"resp error: "+e+":"+d.id),d.error="gdata id required",b.postMessage(d))}else"link"==e?(c=a.h,(e=d.data["gdata-id"])?ds(c,e,d.data["external-id"]).u(function(a){this.data=a;
b.postMessage(this)},function(c){M(a.logger,"error linking gdata "+this.req+":"+this.id);this.error=c.name+": "+c.message;b.postMessage(this)},d):(d.error="gdata-id not required",b.postMessage(d))):"login"==e?ns(a,d.data).u(function(c){this.data=c;b.postMessage(this);os(a)},function(a){this.error=a;b.postMessage(this)},d):"sync-entry"==e?(e=d.data,a.h.get(e).u(function(c){c?new Or(c):(c="GData entry "+this.data+" not found.",P(a.logger,c),this.error=c,b.postMessage(this))},function(c){P(a.logger,
"resp error: "+this.req+":"+this.id+" "+c);this.error=c;b.postMessage(this)},d)):ur(c,e,d.data).u(function(c){P(a.logger,"resp: "+this.req+":"+this.id);this.data=c;b.postMessage(this)},function(c){P(a.logger,"resp error: "+this.req+":"+this.id+" "+(c&&c instanceof Error?c.name+" "+c.message:c));this.error=c;b.postMessage(this)},d);else d.error="Not login",b.postMessage(d)}function Ds(a){var b=!1,c;for(c in a.j)"gmail"==a.j[c].group&&(b=!0);a.o.U(hs,b)}
function Bs(a,b){for(var c in a.j){var d=a.j[c];"gmail"==d.group&&d.port.postMessage(b)}}ys.prototype.V=function(){var a=Object.keys(this.g)[0];return{sugars:this.g,s0:a?this.g[a]:null,gdata:this.h,ports:this.j,user_info:this.i}};
function zs(a){var b="";chrome.runtime.onMessage.addListener(function(c,d,e){var f=d.url;f&&/https?:\/\/mail.google.com/.test(f)?(d=c?c.req:null,"inject"==d&&b!=c.id?(b=c.id,chrome.storage.local.get("ydn-crm-src",function(b){var c=b["ydn-crm-src"];O(a.logger,"injecting "+c+" to "+f);chrome.tabs.executeScript(null,{file:c},function(){chrome.tabs.executeScript(null,{code:"app = runInjApp();"},function(){O(a.logger,c+" injected")})})}),e(c)):"attach"==d&&(O(a.logger,"attaching crm-ex/sidebar.html to "+
f),chrome.tabs.executeScript(null,{code:'var parent = document.getElementById("'+c.parent+'");var f = document.createElement("iframe"); f.src = "crm-ex/sidebar.html"; parent.appendChild(f);'},function(){O(a.logger,"crm-ex/sidebar.html attached");e("crm-ex/sidebar.html")}))):O(a.logger,"invalid sender "+f)});chrome.runtime.onConnect.addListener(function(b){var d=b.sender.url,e=b.name.substr(0,b.name.lastIndexOf("-"));Xa(dd,e)?(O(a.logger,"Channel "+b.name+" connected for "+d),a.j[b.name]={name:b.name,
group:e,port:b},Ds(a),b.onMessage.addListener(function(d){if(d&&A(d)){if("close"==d.req)a.logger.info("closing "+b.name),delete a.j[b.name],b.disconnect(),Ds(a);else if(!d.id){M(a.logger,"Unknown group in pipe info "+b.name);return}if("sugarcrm"==d.group){var g=d.name,k=a.g[g];k?Cs(a,b,k,d):M(a.logger,"SugarCRM instance "+g+" not found.")}else if("gmail"==d.group||"dev"==d.group||"host-permission"==d.group||"popup"==d.group||"options"==d.group)for(g in a.j)k=a.j[g],k.group!=d.group||d.name&&d.name!=
k.name||(d.group=e,d.name=b.name,k.port.postMessage(d));else As(a,b,d)}else M(a.logger,"invalid message package: "+d)}),b.onDisconnect.addListener(function(){O(a.logger,"disconnected "+b.name);delete a.j[b.name];Ds(a)})):M(a.logger,"channel "+b.name+" ignored from "+d)});O(a.logger,"event page start listening incoming connection")};pa("ydn.debug.log",Li);pa("loadApp",function(a){chrome.storage.local.get("ydn-crm-track",function(b){var c=b["ydn-crm-track"];b="jsc/ydn.crm-0.7.23.js";navigator.onLine&&"Edge"==c?b="https://ydn-src-1.storage.googleapis.com/jsc/ydn.crm-edge.js":"Beta"==c?b="jsc/ydn.crm-0.7.23.js":"RC"==c&&(b="jsc/ydn.crm-0.7.23.js");c=document.createElement("script");c.onload=a;c.type="text/javascript";var d={};d["ydn-crm-src"]=b;chrome.storage.local.set(d);c.src=b;document.getElementsByTagName("head")[0].appendChild(c)})});function Es(a){K.call(this,"navigate");this.g=a}C(Es,K);function Fs(a){Mc.call(this);this.g=a||window;Ac(this.g,"popstate",this.$d,!1,this);Ac(this.g,"hashchange",this.$d,!1,this)}C(Fs,Mc);h=Fs.prototype;h.Ne=!1;h.Qh="/";h.setEnabled=function(a){a!=this.Ne&&(this.Ne=a)&&this.dispatchEvent(new Es(this.getToken()))};h.getToken=function(){var a=this.g.location.href,b=a.indexOf("#");return 0>b?"":a.substring(b+1)};h.I=function(){Hc(this.g,"popstate",this.$d,!1,this);Hc(this.g,"hashchange",this.$d,!1,this)};h.$d=function(){this.Ne&&this.dispatchEvent(new Es(this.getToken()))};function Gs(){}da(Gs);Gs.prototype.g=0;function Z(a){Mc.call(this);this.g=a||Jg();this.Md=Hs}C(Z,Mc);Z.prototype.fa=Gs.W();var Hs=null;function Is(a,b){switch(a){case 1:return b?"disable":"enable";case 2:return b?"highlight":"unhighlight";case 4:return b?"activate":"deactivate";case 8:return b?"select":"unselect";case 16:return b?"check":"uncheck";case 32:return b?"focus":"blur";case 64:return b?"open":"close"}throw Error("Invalid component state");}h=Z.prototype;h.xc=null;h.$=!1;h.X=null;h.Md=null;h.Te=null;h.Oa=null;h.Da=null;h.eb=null;
h.Bg=!1;h.F=function(){return this.xc||(this.xc="ydn:"+(this.fa.g++).toString(36))};function Js(a,b){if(a.Oa&&a.Oa.eb){var c=a.Oa.eb,d=a.xc;d in c&&delete c[d];mc(a.Oa.eb,b,a)}a.xc=b}h.n=function(){return this.X};function Ks(a){return a.l||(a.l=new ff(a))}function Ls(a,b){if(a==b)throw Error("Unable to set parent component");if(b&&a.Oa&&a.xc&&Ms(a.Oa,a.xc)&&a.Oa!=b)throw Error("Unable to set parent component");a.Oa=b;Z.m.wf.call(a,b)}h.getParent=function(){return this.Oa};
h.wf=function(a){if(this.Oa&&this.Oa!=a)throw Error("Method not supported");Z.m.wf.call(this,a)};h.T=function(){this.X=this.g.createElement("div")};h.render=function(a){Ns(this,a)};function Ns(a,b,c){if(a.$)throw Error("Component already rendered");a.X||a.T();b?b.insertBefore(a.X,c||null):a.g.g.body.appendChild(a.X);a.Oa&&!a.Oa.$||a.N()}
function Os(a,b){if(a.$)throw Error("Component already rendered");if(b&&a.Se(b)){a.Bg=!0;var c=Lg(b);a.g&&a.g.g==c||(a.g=Jg(b));a.Zb(b);a.N()}else throw Error("Invalid element to decorate");}h.Se=function(){return!0};h.Zb=function(a){this.X=a};h.N=function(){this.$=!0;Ps(this,function(a){!a.$&&a.n()&&a.N()})};h.La=function(){Ps(this,function(a){a.$&&a.La()});this.l&&this.l.removeAll();this.$=!1};
h.I=function(){this.$&&this.La();this.l&&(this.l.la(),delete this.l);Ps(this,function(a){a.la()});!this.Bg&&this.X&&Wg(this.X);this.Oa=this.Te=this.X=this.eb=this.Da=null;Z.m.I.call(this)};h.B=function(){return this.Te};h.ra=function(a){this.Te=a};h.R=function(a,b){this.qd(a,Qs(this),b)};
h.qd=function(a,b,c){if(a.$&&(c||!this.$))throw Error("Component already rendered");if(0>b||b>Qs(this))throw Error("Child component index out of bounds");this.eb&&this.Da||(this.eb={},this.Da=[]);if(a.getParent()==this){var d=a.F();this.eb[d]=a;Za(this.Da,a)}else mc(this.eb,a.F(),a);Ls(a,this);cb(this.Da,b,0,a);a.$&&this.$&&a.getParent()==this?(c=this.sa(),c.insertBefore(a.n(),c.childNodes[b]||null)):c?(this.X||this.T(),b=$(this,b+1),Ns(a,this.sa(),b?b.X:null)):this.$&&!a.$&&a.X&&a.X.parentNode&&
1==a.X.parentNode.nodeType&&a.N()};h.sa=function(){return this.X};function Rs(a){null==a.Md&&(a.Md=wi(a.$?a.X:a.g.g.body));return a.Md}function Qs(a){return a.Da?a.Da.length:0}function Ms(a,b){return a.eb&&b?nc(a.eb,b)||null:null}function $(a,b){return a.Da?a.Da[b]||null:null}function Ps(a,b,c){a.Da&&Qa(a.Da,b,c)}function Ss(a,b){return a.Da&&b?Pa(a.Da,b):-1}
h.yc=function(a,b){if(a){var c=x(a)?a:a.F();a=Ms(this,c);if(c&&a){var d=this.eb;c in d&&delete d[c];Za(this.Da,a);b&&(a.La(),a.X&&Wg(a.X));Ls(a,null)}}if(!a)throw Error("Child is not in parent component");return a};function Ts(a,b,c,d,e){if(!(H||Jb&&Ub("525")))return!0;if(Cb&&e)return Us(a);if(e&&!d)return!1;y(b)&&(b=Vs(b));if(!c&&(17==b||18==b||Cb&&91==b))return!1;if(Jb&&d&&c)switch(a){case 220:case 219:case 221:case 192:case 186:case 189:case 187:case 188:case 190:case 191:case 192:case 222:return!1}if(H&&d&&b==a)return!1;switch(a){case 13:return!(H&&H&&9<=Wb);case 27:return!Jb}return Us(a)}
function Us(a){if(48<=a&&57>=a||96<=a&&106>=a||65<=a&&90>=a||Jb&&0==a)return!0;switch(a){case 32:case 63:case 107:case 109:case 110:case 111:case 186:case 59:case 189:case 187:case 61:case 188:case 190:case 191:case 192:case 222:case 219:case 220:case 221:return!0;default:return!1}}function Vs(a){if(Ib)a=Ws(a);else if(Cb&&Jb)a:switch(a){case 93:a=91;break a}return a}
function Ws(a){switch(a){case 61:return 187;case 59:return 186;case 173:return 189;case 224:return 91;case 0:return 224;default:return a}};function Xs(a,b){Mc.call(this);a&&Ys(this,a,b)}C(Xs,Mc);h=Xs.prototype;h.wc=null;h.Vd=null;h.kf=null;h.Wd=null;h.$a=-1;h.Rb=-1;h.we=!1;
var Zs={3:13,12:144,63232:38,63233:40,63234:37,63235:39,63236:112,63237:113,63238:114,63239:115,63240:116,63241:117,63242:118,63243:119,63244:120,63245:121,63246:122,63247:123,63248:44,63272:46,63273:36,63275:35,63276:33,63277:34,63289:144,63302:45},$s={Up:38,Down:40,Left:37,Right:39,Enter:13,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,"U+007F":46,Home:36,End:35,PageUp:33,PageDown:34,Insert:45},at=H||Jb&&Ub("525"),bt=Cb&&Ib;h=Xs.prototype;
h.th=function(a){Jb&&(17==this.$a&&!a.ctrlKey||18==this.$a&&!a.altKey||Cb&&91==this.$a&&!a.metaKey)&&(this.Rb=this.$a=-1);-1==this.$a&&(a.ctrlKey&&17!=a.g?this.$a=17:a.altKey&&18!=a.g?this.$a=18:a.metaKey&&91!=a.g&&(this.$a=91));at&&!Ts(a.g,this.$a,a.shiftKey,a.ctrlKey,a.altKey)?this.handleEvent(a):(this.Rb=Vs(a.g),bt&&(this.we=a.altKey))};h.uh=function(a){this.Rb=this.$a=-1;this.we=a.altKey};
h.handleEvent=function(a){var b=a.h,c,d,e=b.altKey;H&&"keypress"==a.type?c=this.Rb:Jb&&"keypress"==a.type?c=this.Rb:Hb?c=this.Rb:(c=b.keyCode||this.Rb,d=b.charCode||0,bt&&(e=this.we),Cb&&63==d&&224==c&&(c=191));d=c=Vs(c);var f=b.keyIdentifier;c?63232<=c&&c in Zs?d=Zs[c]:25==c&&a.shiftKey&&(d=9):f&&f in $s&&(d=$s[f]);this.$a=d;a=new ct(d,0,0,b);a.altKey=e;this.dispatchEvent(a)};h.n=function(){return this.wc};
function Ys(a,b,c){a.Wd&&dt(a);a.wc=b;a.Vd=Ac(a.wc,"keypress",a,c);a.kf=Ac(a.wc,"keydown",a.th,c,a);a.Wd=Ac(a.wc,"keyup",a.uh,c,a)}function dt(a){a.Vd&&(Ic(a.Vd),Ic(a.kf),Ic(a.Wd),a.Vd=null,a.kf=null,a.Wd=null);a.wc=null;a.$a=-1;a.Rb=-1}h.I=function(){Xs.m.I.call(this);dt(this)};function ct(a,b,c,d){ac.call(this,d);this.type="key";this.g=a}C(ct,ac);var et;function ft(a,b){b?a.setAttribute("role",b):a.removeAttribute("role")}function gt(a,b,c){v(c)&&(c=c.join(" "));var d="aria-"+b;""===c||void 0==c?(et||(et={atomic:!1,autocomplete:"none",dropeffect:"none",haspopup:!1,live:"off",multiline:!1,multiselectable:!1,orientation:"vertical",readonly:!1,relevant:"additions text",required:!1,sort:"none",busy:!1,disabled:!1,hidden:!1,invalid:"false"}),c=et,b in c?a.setAttribute(d,c[b]):a.removeAttribute(d)):a.setAttribute(d,c)};function ht(){}var it;da(ht);h=ht.prototype;h.Ob=function(){};h.aa=function(a){var b=a.g.t("div",jt(this,a).join(" "),a.pa());kt(this,a,b);return b};h.xa=function(a){return a};function lt(a,b,c){if(a=a.n?a.n():a)if(H&&!Ub("7")){var d=mt(Cg(a),b);d.push(b);oa(c?Dg:Eg,a).apply(null,d)}else c?Dg(a,b):Eg(a,b)}h.Od=function(){return!0};
h.qa=function(a,b){b.id&&Js(a,b.id);var c=this.xa(b);c&&c.firstChild?nt(a,c.firstChild.nextSibling?ab(c.childNodes):c.firstChild):a.Eb=null;var d=0,e=this.w(),f=this.w(),g=!1,k=!1,c=!1,l=Cg(b);Qa(l,function(a){g||a!=e?k||a!=f?d|=this.Me(a):k=!0:(g=!0,f==e&&(k=!0))},this);a.Pb=d;g||(l.push(e),f==e&&(k=!0));k||l.push(f);var m=a.Fe;m&&l.push.apply(l,m);if(H&&!Ub("7")){var n=mt(l);0<n.length&&(l.push.apply(l,n),c=!0)}if(!g||!k||m||c)b.className=l.join(" ");kt(this,a,b);return b};
h.Pd=function(a){Rs(a)&&this.$e(a.n(),!0);a.isEnabled()&&this.zc(a,a.Fa)};function kt(a,b,c){b.Fa||gt(c,"hidden",!b.Fa);b.isEnabled()||a.Wa(c,1,!b.isEnabled());b.ka&8&&a.Wa(c,8,ot(b,8));b.ka&16&&a.Wa(c,16,ot(b,16));b.ka&64&&a.Wa(c,64,ot(b,64))}h.Qd=function(a,b){Ci(a,!b,!H&&!Hb)};h.$e=function(a,b){lt(a,this.w()+"-rtl",b)};h.Ze=function(a){var b;return a.ka&32&&(b=a.i.gc(a))?bh(b)&&ch(b):!1};
h.zc=function(a,b){var c;if(a.ka&32&&(c=a.i.gc(a))){if(!b&&ot(a,32)){try{c.blur()}catch(d){}ot(a,32)&&a.Rd(null)}(bh(c)&&ch(c))!=b&&(b?c.tabIndex=0:(c.tabIndex=-1,c.removeAttribute("tabIndex")))}};h.U=function(a,b,c){var d=a.n();if(d){var e=this.Sc(b);e&&lt(a,e,c);this.Wa(d,b,c)}};h.Wa=function(a,b,c){it||(it={1:"disabled",8:"selected",16:"checked",64:"expanded"});(b=it[b])&&gt(a,b,c)};
h.Db=function(a,b){var c=this.xa(a);if(c&&(Ug(c),b))if(x(b))Zg(c,b);else{var d=function(a){if(a){var b=Lg(c);c.appendChild(x(a)?b.createTextNode(a):a)}};u(b)?Qa(b,d):!v(b)||"nodeType"in b?d(b):Qa(ab(b),d)}};h.gc=function(a){return a.n()};h.w=function(){return"goog-control"};function jt(a,b){var c=a.w(),d=[c],e=a.w();e!=c&&d.push(e);c=b.Pb;for(e=[];c;){var f=c&-c;e.push(a.Sc(f));c&=~f}d.push.apply(d,e);(c=b.Fe)&&d.push.apply(d,c);H&&!Ub("7")&&d.push.apply(d,mt(d));return d}
function mt(a,b){var c=[];b&&(a=a.concat([b]));Qa([],function(d){!Ua(d,oa(Xa,a))||b&&!Xa(d,b)||c.push(d.join("_"))});return c}h.Sc=function(a){this.g||pt(this);return this.g[a]};h.Me=function(a){this.i||(this.g||pt(this),this.i=oc(this.g));a=parseInt(this.i[a],10);return isNaN(a)?0:a};function pt(a){var b=a.w();a.g={1:b+"-disabled",2:b+"-hover",4:b+"-active",8:b+"-selected",16:b+"-checked",32:b+"-focused",64:b+"-open"}};var qt=!!q.DOMTokenList,rt=qt?function(a){return a.classList}:function(a){a=a.className;return x(a)&&a.match(/\S+/g)||[]},st=qt?function(a,b){return a.classList.contains(b)}:function(a,b){return Xa(rt(a),b)},tt=qt?function(a,b){a.classList.add(b)}:function(a,b){st(a,b)||(a.className+=0<a.className.length?" "+b:b)},ut=qt?function(a,b){Qa(b,function(b){tt(a,b)})}:function(a,b){var c={};Qa(rt(a),function(a){c[a]=!0});Qa(b,function(a){c[a]=!0});a.className="";for(var d in c)a.className+=0<a.className.length?
" "+d:d},vt=qt?function(a,b){a.classList.remove(b)}:function(a,b){st(a,b)&&(a.className=Ra(rt(a),function(a){return a!=b}).join(" "))};function wt(a,b){if(!ga(a))throw Error("Invalid component class "+a);if(!ga(b))throw Error("Invalid renderer class "+b);var c=ha(a);xt[c]=b}function yt(a,b){if(!a)throw Error("Invalid class name "+a);if(!ga(b))throw Error("Invalid decorator function "+b);zt[a]=b}var xt={},zt={};function At(a,b,c){Z.call(this,c);if(!b){b=this.constructor;for(var d;b;){d=ha(b);if(d=xt[d])break;b=b.m?b.m.constructor:null}b=d?ga(d.W)?d.W():new d:null}this.i=b;this.Eb=t(a)?a:null}C(At,Z);h=At.prototype;h.Eb=null;h.Pb=0;h.ka=39;h.ye=255;h.oc=0;h.Fa=!0;h.Fe=null;h.df=!0;h.td=!1;h.af=null;function Bt(a,b){a.$&&b!=a.df&&Ct(a,b);a.df=b}h.T=function(){var a=this.i.aa(this);this.X=a;var b=this.af||this.i.Ob();b&&ft(a,b);this.td||this.i.Qd(a,!1);this.Fa||(S(a,!1),a&&gt(a,"hidden",!0))};h.sa=function(){return this.i.xa(this.n())};
h.Se=function(a){return this.i.Od(a)};h.Zb=function(a){this.X=a=this.i.qa(this,a);var b=this.af||this.i.Ob();b&&ft(a,b);this.td||this.i.Qd(a,!1);this.Fa="none"!=a.style.display};h.N=function(){At.m.N.call(this);this.i.Pd(this);if(this.ka&-2&&(this.df&&Ct(this,!0),this.ka&32)){var a=this.i.gc(this);if(a){var b=this.j||(this.j=new Xs);Ys(b,a);Ks(this).listen(b,"key",this.Sa).listen(a,"focus",this.eh).listen(a,"blur",this.Rd)}}};
function Ct(a,b){var c=Ks(a),d=a.n();b?(c.listen(d,"mouseover",a.cd).listen(d,"mousedown",a.Zc).listen(d,"mouseup",a.hc).listen(d,"mouseout",a.ef),a.bd!=ca&&c.listen(d,"contextmenu",a.bd),H&&c.listen(d,"dblclick",a.hg)):(c.ya(d,"mouseover",a.cd).ya(d,"mousedown",a.Zc).ya(d,"mouseup",a.hc).ya(d,"mouseout",a.ef),a.bd!=ca&&c.ya(d,"contextmenu",a.bd),H&&c.ya(d,"dblclick",a.hg))}h.La=function(){At.m.La.call(this);this.j&&dt(this.j);this.Fa&&this.isEnabled()&&this.i.zc(this,!1)};
h.I=function(){At.m.I.call(this);this.j&&(this.j.la(),delete this.j);delete this.i;this.Fe=this.Eb=null};h.pa=function(){return this.Eb};function nt(a,b){a.Eb=b}h.xb=function(){var a=this.pa();if(!a)return"";if(!x(a))if(u(a))a=Sa(a,dh).join("");else{if(Bg&&"innerText"in a)a=a.innerText.replace(/(\r\n|\r|\n)/g,"\n");else{var b=[];eh(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");Bg||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""))}return wa(a)};
function Dt(a){a.td=!0;var b=a.n();b&&a.i.Qd(b,!0)}h.$c=function(a,b){if(b||this.Fa!=a&&this.dispatchEvent(a?"show":"hide")){var c=this.n();c&&(S(c,a),c&&gt(c,"hidden",!a));this.isEnabled()&&this.i.zc(this,a);this.Fa=a;return!0}return!1};h.isEnabled=function(){return!ot(this,1)};h.setEnabled=function(a){var b=this.getParent();b&&"function"==typeof b.isEnabled&&!b.isEnabled()||!Et(this,1,!a)||(a||(Ft(this,!1),this.Ha(!1)),this.Fa&&this.i.zc(this,a),this.U(1,!a))};
h.Ha=function(a){Et(this,2,a)&&this.U(2,a)};function Ft(a,b){Et(a,4,b)&&a.U(4,b)}h.Hc=function(a){Et(this,8,a)&&this.U(8,a)};h.na=function(a){Et(this,64,a)&&this.U(64,a)};function ot(a,b){return!!(a.Pb&b)}h.U=function(a,b){this.ka&a&&b!=ot(this,a)&&(this.i.U(this,a,b),this.Pb=b?this.Pb|a:this.Pb&~a)};function Gt(a,b,c){if(a.$&&ot(a,b)&&!c)throw Error("Component already rendered");!c&&ot(a,b)&&a.U(b,!1);a.ka=c?a.ka|b:a.ka&~b}function Ht(a,b){return!!(a.ye&b)&&!!(a.ka&b)}function It(a){a.ye&=-256}
function Et(a,b,c){return!!(a.ka&b)&&ot(a,b)!=c&&(!(a.oc&b)||a.dispatchEvent(Is(b,c)))&&!a.G}h.cd=function(a){!Jt(a,this.n())&&this.dispatchEvent("enter")&&this.isEnabled()&&Ht(this,2)&&this.Ha(!0)};h.ef=function(a){!Jt(a,this.n())&&this.dispatchEvent("leave")&&(Ht(this,4)&&Ft(this,!1),Ht(this,2)&&this.Ha(!1))};h.bd=ca;function Jt(a,b){return!!a.j&&Yg(b,a.j)}
h.Zc=function(a){this.isEnabled()&&(Ht(this,2)&&this.Ha(!0),!cc(a)||Jb&&Cb&&a.ctrlKey||(Ht(this,4)&&Ft(this,!0),this.i.Ze(this)&&this.i.gc(this).focus()));this.td||!cc(a)||Jb&&Cb&&a.ctrlKey||a.preventDefault()};h.hc=function(a){this.isEnabled()&&(Ht(this,2)&&this.Ha(!0),ot(this,4)&&this.ob(a)&&Ht(this,4)&&Ft(this,!1))};h.hg=function(a){this.isEnabled()&&this.ob(a)};
h.ob=function(a){if(Ht(this,16)){var b=!ot(this,16);Et(this,16,b)&&this.U(16,b)}Ht(this,8)&&this.Hc(!0);Ht(this,64)&&this.na(!ot(this,64));b=new K("action",this);a&&(b.altKey=a.altKey,b.ctrlKey=a.ctrlKey,b.metaKey=a.metaKey,b.shiftKey=a.shiftKey,b.l=a.l);return this.dispatchEvent(b)};h.eh=function(){Ht(this,32)&&Et(this,32,!0)&&this.U(32,!0)};h.Rd=function(){Ht(this,4)&&Ft(this,!1);Ht(this,32)&&Et(this,32,!1)&&this.U(32,!1)};
h.Sa=function(a){return this.Fa&&this.isEnabled()&&this.Ac(a)?(a.preventDefault(),a.Yc(),!0):!1};h.Ac=function(a){return 13==a.g&&this.ob(a)};wt(At,ht);yt("goog-control",function(){return new At(null)});function Kt(){}C(Kt,ht);da(Kt);h=Kt.prototype;h.w=function(){return"goog-tab"};h.Ob=function(){return"tab"};h.aa=function(a){var b=Kt.m.aa.call(this,a);(a=a.Cb())&&this.Kb(b,a);return b};h.qa=function(a,b){b=Kt.m.qa.call(this,a,b);var c=this.Cb(b);c&&a.fe(c);ot(a,8)&&(c=a.getParent())&&ga(c.Ic)&&(a.U(8,!1),c.Ic(a));return b};h.Cb=function(a){return a.title||""};h.Kb=function(a,b){a&&(a.title=b||"")};function Lt(a,b,c){At.call(this,a,b||Kt.W(),c);Gt(this,8,!0);this.oc|=9}C(Lt,At);Lt.prototype.Cb=function(){return this.h};Lt.prototype.Kb=function(a){this.i.Kb(this.n(),a);this.fe(a)};Lt.prototype.fe=function(a){this.h=a};yt("goog-tab",function(){return new Lt(null)});function Mt(){}da(Mt);h=Mt.prototype;h.Nd=function(){};function Nt(a,b){a&&(a.tabIndex=b?0:-1)}h.Ue=function(a){return"DIV"==a.tagName};function Ot(a,b,c){c.id&&Js(b,c.id);var d=a.w(),e=!1,f=rt(c);f&&Qa(f,function(a){a==d?e=!0:a&&this.xf(b,a,d)},a);e||tt(c,d);Pt(a,b,c);return c}h.xf=function(a,b,c){b==c+"-disabled"?a.setEnabled(!1):b==c+"-horizontal"?Qt(a,Rt):b==c+"-vertical"&&Qt(a,St)};
function Pt(a,b,c){if(c)for(var d=c.firstChild,e;d&&d.parentNode==c;){e=d.nextSibling;if(1==d.nodeType){var f=a.Tc(d);f&&(f.X=d,b.isEnabled()||f.setEnabled(!1),b.R(f),Os(f,d))}else d.nodeValue&&""!=xa(d.nodeValue)||c.removeChild(d);d=e}}h.Tc=function(a){a:{var b;a=rt(a);for(var c=0,d=a.length;c<d;c++)if(b=a[c],b=b in zt?zt[b]():null){a=b;break a}a=null}return a};h.We=function(a){a=a.n();Ci(a,!0,Ib);H&&(a.hideFocus=!0);var b=this.Nd();b&&ft(a,b)};h.w=function(){return"goog-container"};
h.Ve=function(a){var b=this.w(),c=[b,a.Tb==Rt?b+"-horizontal":b+"-vertical"];a.isEnabled()||c.push(b+"-disabled");return c};h.cg=function(){return St};function Tt(a,b,c){Z.call(this,c);this.lb=b||Mt.W();this.Tb=a||this.lb.cg()}C(Tt,Z);var Rt="horizontal",St="vertical";h=Tt.prototype;h.lf=null;h.ec=null;h.lb=null;h.Tb=null;h.Ea=!0;h.cc=!0;h.tc=!0;h.Ta=-1;h.ta=null;h.nb=!1;h.sb=null;function Ut(a){return a.lf||a.n()}h.T=function(){this.X=this.g.t("div",this.lb.Ve(this).join(" "))};h.sa=function(){return this.n()};h.Se=function(a){return this.lb.Ue(a)};h.Zb=function(a){this.X=Ot(this.lb,this,a);"none"==a.style.display&&(this.Ea=!1)};
h.N=function(){Tt.m.N.call(this);Ps(this,function(a){a.$&&Vt(this,a)},this);var a=this.n();this.lb.We(this);this.fc(this.Ea,!0);Ks(this).listen(this,"enter",this.cf).listen(this,"highlight",this.ah).listen(this,"unhighlight",this.dh).listen(this,"open",this.zh).listen(this,"close",this.mh).listen(a,"mousedown",this.bh).listen(Lg(a),"mouseup",this.ph).listen(a,["mousedown","mouseup","mouseover","mouseout","contextmenu"],this.jh);this.tc&&Wt(this,!0)};
function Wt(a,b){var c=Ks(a),d=Ut(a);b?c.listen(d,"focus",a.Xe).listen(d,"blur",a.gg).listen(a.ec||(a.ec=new Xs(Ut(a))),"key",a.Sa):c.ya(d,"focus",a.Xe).ya(d,"blur",a.gg).ya(a.ec||(a.ec=new Xs(Ut(a))),"key",a.Sa)}h.La=function(){this.Jb(-1);this.ta&&this.ta.na(!1);this.nb=!1;Tt.m.La.call(this)};h.I=function(){Tt.m.I.call(this);this.ec&&(this.ec.la(),this.ec=null);this.lb=this.ta=this.sb=this.lf=null};h.cf=function(){return!0};
h.ah=function(a){var b=Ss(this,a.target);if(-1<b&&b!=this.Ta){var c=Xt(this);c&&c.Ha(!1);this.Ta=b;c=Xt(this);this.nb&&Ft(c,!0);this.ta&&c!=this.ta&&(c.ka&64?c.na(!0):this.ta.na(!1))}b=this.n();null!=a.target.n()&&gt(b,"activedescendant",a.target.n().id)};h.dh=function(a){a.target==Xt(this)&&(this.Ta=-1);this.n().removeAttribute("aria-activedescendant")};h.zh=function(a){(a=a.target)&&a!=this.ta&&a.getParent()==this&&(this.ta&&this.ta.na(!1),this.ta=a)};
h.mh=function(a){a.target==this.ta&&(this.ta=null)};h.bh=function(a){this.cc&&(this.nb=!0);var b=Ut(this);b&&bh(b)&&ch(b)?b.focus():a.preventDefault()};h.ph=function(){this.nb=!1};h.jh=function(a){var b;a:{b=a.target;if(this.sb)for(var c=this.n();b&&b!==c;){var d=b.id;if(d in this.sb){b=this.sb[d];break a}b=b.parentNode}b=null}if(b)switch(a.type){case "mousedown":b.Zc(a);break;case "mouseup":b.hc(a);break;case "mouseover":b.cd(a);break;case "mouseout":b.ef(a);break;case "contextmenu":b.bd(a)}};
h.Xe=function(){};h.gg=function(){this.Jb(-1);this.nb=!1;this.ta&&this.ta.na(!1)};h.Sa=function(a){return this.isEnabled()&&this.Ea&&(0!=Qs(this)||this.lf)&&this.Ye(a)?(a.preventDefault(),a.Yc(),!0):!1};
h.Ye=function(a){var b=Xt(this);if(b&&"function"==typeof b.Sa&&b.Sa(a)||this.ta&&this.ta!=b&&"function"==typeof this.ta.Sa&&this.ta.Sa(a))return!0;if(a.shiftKey||a.ctrlKey||a.metaKey||a.altKey)return!1;switch(a.g){case 27:if(this.tc)Ut(this).blur();else return!1;break;case 36:Yt(this);break;case 35:Zt(this);break;case 38:if(this.Tb==St)$t(this);else return!1;break;case 37:if(this.Tb==Rt)Rs(this)?au(this):$t(this);else return!1;break;case 40:if(this.Tb==St)au(this);else return!1;break;case 39:if(this.Tb==
Rt)Rs(this)?$t(this):au(this);else return!1;break;default:return!1}return!0};function Vt(a,b){var c=b.n(),c=c.id||(c.id=b.F());a.sb||(a.sb={});a.sb[c]=b}h.R=function(a,b){Tt.m.R.call(this,a,b)};h.qd=function(a,b,c){a.oc|=2;a.oc|=64;Gt(a,32,!1);Bt(a,!1);Tt.m.qd.call(this,a,b,c);a.$&&this.$&&Vt(this,a);b<=this.Ta&&this.Ta++};
h.yc=function(a,b){if(a=x(a)?Ms(this,a):a){var c=Ss(this,a);-1!=c&&(c==this.Ta?(a.Ha(!1),this.Ta=-1):c<this.Ta&&this.Ta--);var d=a.n();d&&d.id&&this.sb&&(c=this.sb,d=d.id,d in c&&delete c[d])}a=Tt.m.yc.call(this,a,b);Bt(a,!0);return a};function Qt(a,b){if(a.n())throw Error("Component already rendered");a.Tb=b}
h.fc=function(a,b){if(b||this.Ea!=a&&this.dispatchEvent(a?"show":"hide")){this.Ea=a;var c=this.n();c&&(S(c,a),this.tc&&Nt(Ut(this),this.cc&&this.Ea),b||this.dispatchEvent(this.Ea?"aftershow":"afterhide"));return!0}return!1};h.isEnabled=function(){return this.cc};
h.setEnabled=function(a){this.cc!=a&&this.dispatchEvent(a?"enable":"disable")&&(a?(this.cc=!0,Ps(this,function(a){a.Cg?delete a.Cg:a.setEnabled(!0)})):(Ps(this,function(a){a.isEnabled()?a.setEnabled(!1):a.Cg=!0}),this.nb=this.cc=!1),this.tc&&Nt(Ut(this),a&&this.Ea))};function bu(a,b){b!=a.tc&&a.$&&Wt(a,b);a.tc=b;a.cc&&a.Ea&&Nt(Ut(a),b)}h.Jb=function(a){(a=$(this,a))?a.Ha(!0):-1<this.Ta&&Xt(this).Ha(!1)};h.Ha=function(a){this.Jb(Ss(this,a))};function Xt(a){return $(a,a.Ta)}
function Yt(a){cu(a,function(a,c){return(a+1)%c},Qs(a)-1)}function Zt(a){cu(a,function(a,c){a--;return 0>a?c-1:a},0)}function au(a){cu(a,function(a,c){return(a+1)%c},a.Ta)}function $t(a){cu(a,function(a,c){a--;return 0>a?c-1:a},a.Ta)}function cu(a,b,c){c=0>c?Ss(a,a.ta):c;var d=Qs(a);c=b.call(a,c,d);for(var e=0;e<=d;){var f=$(a,c);if(f&&a.Xf(f)){a.vf(c);break}e++;c=b.call(a,c,d)}}h.Xf=function(a){return a.Fa&&a.isEnabled()&&!!(a.ka&2)};h.vf=function(a){this.Jb(a)};function du(){}C(du,Mt);da(du);du.prototype.w=function(){return"goog-tab-bar"};du.prototype.Nd=function(){return"tablist"};du.prototype.xf=function(a,b,c){this.h||(this.g||eu(this),this.h=oc(this.g));var d=this.h[b];d?(Qt(a,d==fu||d==gu?St:Rt),a.i=d):du.m.xf.call(this,a,b,c)};du.prototype.Ve=function(a){var b=du.m.Ve.call(this,a);this.g||eu(this);b.push(this.g[a.i]);return b};function eu(a){var b=a.w();a.g=rc(hu,b+"-top",iu,b+"-bottom",fu,b+"-start",gu,b+"-end")};function ju(a,b,c){a=a||hu;Qt(this,a==fu||a==gu?St:Rt);this.i=a;Tt.call(this,this.Tb,b||du.W(),c);ku(this)}C(ju,Tt);var hu="top",iu="bottom",fu="start",gu="end";h=ju.prototype;h.ib=null;h.N=function(){ju.m.N.call(this);ku(this)};h.I=function(){ju.m.I.call(this);this.ib=null};h.yc=function(a,b){lu(this,a);return ju.m.yc.call(this,a,b)};h.vf=function(a){ju.m.vf.call(this,a);this.Ic($(this,a))};h.Ic=function(a){a?a.Hc(!0):this.ib&&this.ib.Hc(!1)};
function lu(a,b){if(b&&b==a.ib){for(var c=Ss(a,b),d=c-1;b=$(a,d);d--)if(b.Fa&&b.isEnabled()){a.Ic(b);return}for(c+=1;b=$(a,c);c++)if(b.Fa&&b.isEnabled()){a.Ic(b);return}a.Ic(null)}}h.Fh=function(a){this.ib&&this.ib!=a.target&&this.ib.Hc(!1);this.ib=a.target};h.Gh=function(a){a.target==this.ib&&(this.ib=null)};h.Dh=function(a){lu(this,a.target)};h.Eh=function(a){lu(this,a.target)};h.Xe=function(){Xt(this)||this.Ha(this.ib||$(this,0))};
function ku(a){Ks(a).listen(a,"select",a.Fh).listen(a,"unselect",a.Gh).listen(a,"disable",a.Dh).listen(a,"hide",a.Eh)}yt("goog-tab-bar",function(){return new ju});function mu(a,b){this.g=a;this.h=b};function nu(a,b){this.parent=a;this.g=b}function ou(a){var b=a.parent.wa();return b?b.value(a.g):null}nu.prototype.Uc=function(){return ou(this)};function pu(a){a=qu(a.parent.module).module_fields[a.g];return x(a.label)?a.label.replace(/:$/,""):a.label}nu.prototype.toString=function(){return this.parent+";Field:"+this.g};function ru(a,b){this.module=a;this.g=b||"";this.h={}}ru.prototype.K=function(){return this.module.K()};ru.prototype.wa=function(){return this.module.wa()};function su(a){var b=qu(a.module),c=[],d;for(d in b.module_fields){var e=b.module_fields[d];a.g&&e.group==a.g?c.push(d):a.g||e.group||c.push(d)}return c}function tu(a,b){var c=qu(a.module),d;for(d in c.module_fields)if(d==b)return!0;return!1}function uu(a,b){a.h[b]||(a.h[b]=new nu(a,b));return a.h[b]}
function vu(a){a=a.g.replace("_"," ");return a=a.charAt(0).toUpperCase()+a.substr(1)};function wu(a,b){Mc.call(this);this.parent=a;this.g=b;this.i={}}C(wu,Mc);h=wu.prototype;h.logger=R("ydn.crm.sugar.model.Record");h.K=function(){return this.parent.K()};h.F=function(){return this.g.F()};h.value=function(a){return this.g.value(a)};h.Z=function(){return this.g.module};function qu(a){return a.parent.l[a.Z()]}
h.save=function(){var a=this.wa();return a.g?this.parent.send("put-record",{module:a.module,record:a.g}).A(function(b){var c=this,d=!xu(this);Pq(a,b);setTimeout(function(){d?c.dispatchEvent(new yu(0,c)):c.dispatchEvent(new zu(0,c))},10)},this):F("empty record to save")};h.I=function(){wu.m.I.call(this);this.i=null};h.wa=function(){return this.g};
h.pb=function(a){a=a?a.g?a:null:null;var b=!1,c=!1,d=!1;a?a!==this.g&&(b=!0,(c=this.g.module!=a.module)||(d=xu(this)?this.g.F()!=a.F():!0),this.g=a):!a&&xu(this)&&(d=b=!0,this.g.g=null);var e=this.g.module;c?this.dispatchEvent(new Au(e,a,this)):d?this.dispatchEvent(new yu(0,this)):b&&this.dispatchEvent(new zu(0,this))};function xu(a){return!!a.g.g}function Bu(a,b){a.i[b]||(a.i[b]=new ru(a,b));return a.i[b]}h.toString=function(){return"ydn.crm.sugar.model.Record:"+this.g};function Cu(a,b){var c;c=a.replace("@","%40");c="http://www.google.com/m8/feeds/contacts/"+c+"/base/"+ ++Du;b.id={$t:c};Ir.call(this,b)}C(Cu,Or);var Du=0;function Eu(a,b){wu.call(this,a,new Oq(a.K(),b));this.h=null;this.module_name=b;this.fb=new ff(this);this.fb.listen(a,[Fu,Gu,Hu],this.Rh)}C(Eu,wu);h=Eu.prototype;h.logger=R("ydn.crm.sugar.model.GDataRecord");h.I=function(){Eu.m.I.call(this);this.fb.la();this.fb=null};
h.Rh=function(a){if(a instanceof Iu){if(this.pb(null),this.h=Ju(a,this.Z())){var b=nr(this.h,or,this.K(),this.Z()).g;Ku(this,b)}}else a.type!=Fu||xu(this)||((b=Lu(this.getParent()))?(b=[{store:this.Z(),index:"ydn$emails",key:b}],Mu(this.parent).send("list",b).A(function(b){(b=b[0])&&b.result[0]?this.pb(new Oq(this.K(),this.Z(),b.result[0])):this.dispatchEvent(a)},this)):this.dispatchEvent(a))};h.getParent=function(){return this.parent};function Nu(a){return Ou(a.getParent())}h.Z=function(){return this.module_name};
h.pb=function(a){if(a&&a.module!=this.module_name)throw Error("Module name must be "+this.module_name+" but found "+a.module);Eu.m.pb.call(this,a)};function Ku(a,b){var c=Nu(a);c&&Pr(c);b&&(c=[{store:a.Z(),index:"id",key:b}],Mu(a.parent).send("list",c).u(function(a){(a=a[0])&&a.result[0]?this.pb(new Oq(this.K(),this.Z(),a.result[0])):M(this.logger,"record id "+b+" not in "+this.Z())},function(a){throw a;},a))}function Pu(a){return(a=Nu(a))?Pr(a)[0]:null}
function Qu(a){return a.h&&xu(a)?!!nr(a.h,or,a.K(),a.Z(),a.F()):!1}function Ru(a){var b=Nu(a),b={module:a.Z(),kind:b.Ff(),"gdata-id":b.F()};P(a.logger,"sending import-gdata "+JSON.stringify(b));return Mu(a.parent).send("import-gdata",b).A(function(a){a=new Oq(this.K(),this.Z(),a);P(this.logger,a+" created.");this.pb(a)},a)}
function Su(a){var b=Tu(a.getParent());a.wa();var c=lc(b.data,"gd$name","gd$fullName","$t")||"",d={email1:Pr(b)[0],full_name:c};c&&0<c.length&&(c=c.split(/\s/),c[0]&&(d.first_name=c[0]),c[1]&&(d.last_name=c[c.length-1]));b=Qr(b);b[0]&&(d.phone_work=b[0]);d={module:a.Z(),record:d};P(a.logger,"sending put-record "+JSON.stringify(d));return Mu(a.parent).send("put-record",d).A(function(a){a=new Oq(this.K(),this.Z(),a);P(this.logger,a+" created.");this.pb(a)},a)}
function Uu(a){var b=a.wa();return b?Vu(a.getParent(),b):F("no Record to link.")}function Wu(a){var b=a.wa();return b?Xu(a.getParent(),b):F("no Record to link.")}h.save=function(){var a=this.wa(),b=Mu(this.parent).send("put-record",a);b.A(function(b){a.g=b},this);return b};h.toString=function(){var a="";this.g&&(a+=":"+this.g);var b=Nu(this);b&&(a+=":"+b);return"RecordModel:"+this.Z()+a};var Hu="context-gdata-change",Fu="gdata-change",Gu="gdata-updated";function Yu(a,b){K.call(this,a,b)}C(Yu,K);function Iu(a,b,c,d){K.call(this,Hu,d);this.domain=a;this.g=c}C(Iu,Yu);function Ju(a,b){for(var c=0;c<a.g.length;c++)if(nr(a.g[c],or,a.domain,b))return a.g.splice(c,1)[0];return null}function yu(a,b){K.call(this,"record-change",b)}C(yu,Yu);function Au(a,b,c){K.call(this,"record-change",c);this.module=a;this.update=b}C(Au,Yu);function zu(a,b){K.call(this,"record-update",b)}C(zu,Yu);
function Zu(a,b,c,d){K.call(this,a,d)}C(Zu,Yu);function $u(a,b,c){K.call(this,Fu,c)}C($u,Zu);function av(a,b,c){K.call(this,Gu,c)}C(av,Zu);function bv(a,b){Mc.call(this);this.g=a;for(var c={},d=0;d<b.length;d++)c[b[d].module_name]=b[d];this.l=c;this.info={};this.o=null;this.fb=new ff(this);this.j=new Oq(this.K(),"Users");cv(this)}C(bv,Mc);h=bv.prototype;h.isLogin=function(){return!!this.g.isLogin};function cv(a){a.g&&a.g.userName&&a.send("login-user").A(function(a){a&&a.id&&(this.j.g=a)},a)}function dv(a){return a.send("about").A(function(a){this.g=a},a)}function Mu(a){return ed("sugarcrm",a.K())}h.K=function(){return this.g.domain};
function ev(a){return a.g.baseUrl?a.g.baseUrl:"https://"+a.g.domain}function fv(a,b,c){var d={};d.domain=a.K();d.baseUrl=a.g.baseUrl||null;d.qi=b;d.password=c;return a.send("login",d).A(function(a){this.g=a},a)}h.send=function(a,b){return ed("sugarcrm",this.K()).send(a,b)};function gv(a,b,c,d,e,f){b={store:b};c&&(b.index=c);d&&(d instanceof T?b.range=d.toJSON():b.key=d);b.prefix=!!e;f&&(b.limit=void 0);return Mu(a).send("list",[b])}
function hv(a,b,c){c={store:b,index:"name",q:c,fetchFull:!1};"Notes"==b&&(c.index="content");return Mu(a).send("search",[c])}
function iv(a,b,c,d){var e=document.createElement("div");e.innerHTML=b.gf;var f=b.Vg.toISOString().replace("T"," ").replace(/\..+/,""),g=a.g?a.g.userName||"":"",k;k=a.j.value("name")||a.g.userName||null;return a.send("new-record",{module:"Emails",record:{assigned_user_id:g,assigned_user_name:k,type:"archived",date_sent:f,description:e.textContent,description_html:b.gf,name:b.Sh,from_addr:b.Xg,to_addrs:b.Uh,parent_id:d||"",parent_type:c||"",mailbox_id:b.Kh||"",message_id:b.qf||"",status:"read"}})}
h.I=function(){bv.m.I.call(this);this.o=this.info=null;this.fb.la();this.fb=null};h.toString=function(){return"ydn.crm.sugar.model.Sugar:"+this.K()};function jv(a,b,c){bv.call(this,a,b);this.h=this.i=null;this.p=c}C(jv,bv);function Ou(a){return a.h}function Tu(a){return a.i}function Lu(a){return a.i?Pr(a.i)[0]||null:null}
function kv(a,b){for(var c=[],d=0;d<b.length;d++){for(var e=c,f=d,g=a.i,k=b[d],l=0,m=Pr(g),n=Pr(k),p=0;p<m.length;p++)for(var r=m[p],s=0;s<n.length;s++){var w=n[s];r&&r==w&&(l+=1)}m=0;r=g.data.gd$name;s=k.data.gd$name;if(r&&s)for(w=["gd$familyName","gd$givenName","gd$additionalName","gd$fullName"],n=[0.06,0.06,0.06,0.12],p=0;4>p;p++){var z=r[w[p]],G=s[w[p]];z&&G==z&&(m+=n[p])}p=0;n=g.ld();r=k.ld();n&&n==r&&(p+=0.2);s=0;g=Qr(g);k=Qr(k);r=g.length;for(n=[];r--;){s=g[r];w=k.length;for(n[r]=0;w--;)z=
k[w],s.$t&&z.$t&&(z=0.7*Hr(s,z),n[r]=Math.max(n[r],z));s=Th(n).value}e[f]=l+m+p+s}e=[];for(d=0;d<b.length;d++)f=eb(e,hb,c[d]),0>f?(cb(e,-(f+1),0,c[d]),l=b.splice(d,1),cb(b,-(f+1),0,l[0])):cb(e,f,0,c[d])}
function Xu(a,b){b.F();var c=b.module,d=a.h;if(!d)return F("Not contact data to link.");var e=nr(d,or,a.K(),c);if(e)return F("Contact "+yp(d)+" already link to "+e.g+" with the module "+c);c=new Lr(or,a.K(),c,b.F(),+new Date(d.data.updated.$t),Qq(b));d={kind:d.Ff(),"gdata-id":d.F(),"external-id":{label:c.module+"#"+c.i+"-"+c.h,value:c.S()}};return Mu(a).send("link",d).A(function(){this.h=null;this.dispatchEvent(new $u(0,0,this))},a)}
function Vu(a,b){return ed().send("export-record",b.toJSON()).A(function(a){this.h=new Or(a);this.dispatchEvent(new av(0,0,this))},a)}jv.prototype.update=function(a,b,c){this.isLogin()&&this.g.hostPermission?lv(this,a,b,c):dv(this).ca(function(){lv(this,a,b,c)},this)};
function lv(a,b,c,d){a.i=null;a.h=null;if(b){var e={gd$email:[{address:b}]};c&&(e.gd$name={gd$fullName:{$t:c}});d&&(e.gd$phoneNumber=[{$t:d}]);a.i=new Cu(a.p,e);ed().send("gdata-list-contact-by-email",b).u(function(a){a=a.map(function(a){return new Or(a)});kv(this,a);a=new Iu(this.K(),0,a,this);this.dispatchEvent(a);this.h=a.g[0]||null;this.dispatchEvent(new $u(0,0,this))},function(a){throw a;},a)}else a.dispatchEvent(new Iu(a.K(),0,[],a)),a.dispatchEvent(new $u(0,0,a))};function mv(a,b){Z.call(this);this.ra(a);this.parent=b||null;this.h=new nv}C(mv,Z);h=mv.prototype;h.logger=R("ydn.crm.ui.GmailCmd");h.w=function(){return"gmail-cmd-panel"};h.T=function(){mv.m.T.call(this);var a=this.n(),b=this.g;a.classList.add(this.w());b=b.t("a",{"class":"archive"},".");ov(this.h,b);a.appendChild(b)};function pv(a,b){qv(a.h,"View",oq(a.B().K(),"Emails",b.id));var c=a.h.n();c.setAttribute("target","gmail");c.setAttribute("title","View archived email in SugarCRM")}
function rv(a){qv(a.h,"Archive","#archive");a.h.n().setAttribute("title","Archive this email message to SugarCRM")}function sv(a){qv(a.h,".");setTimeout(function(){qv(a.h,"..");var b=tv(a.n());b.qf?(qv(a.h,"..."),a.B().send("list",[{store:"Emails",index:"message_id",key:b.qf}]).u(function(b){(b=b[0]&&b[0].result?b[0].result[0]:null)?pv(a,b):rv(a)},function(b){rv(a);throw b;})):1<b.gf.length?rv(a):uv(a.h,"gmail message cannot be parsed")},100)}
h.N=function(){mv.m.N.call(this);Ks(this).listen(this.h,"click",this.hh);sv(this)};
function tv(a){var b="",c="",d="",e="",f="",g=fh(a,"TR");if(b=g.children[0].querySelector("span[email]"))b=b.getAttribute("email");else return M(ro,"cannot sniff sender email"),null;if(a=g.children[1].querySelector("span[alt]"))a=a.getAttribute("alt"),a=new Date(a.replace(" at",""));else return M(ro,"cannot sniff date sent"),null;var k=g.nextElementSibling;if(!k||"TR"!=k.tagName)return M(ro,"to email address TR expect after title TR"),null;for(var l=k.querySelectorAll("span[email]"),k=0;k<l.length;k++)c&&
(c+=", "),c+=l[k].getAttribute("email");for(var g=fh(g,"TABLE"),m=g.parentElement.nextElementSibling,k=0;m&&10>k;k++)if(l=m.querySelector("div[style]")){d=l.parentElement.className.split(/\s/);k=d.map(function(a){return a.length});k=k.indexOf(Math.max.apply(Math,k));10<d[k].length&&(e=d[k].substring(1),"m"!=d[k].charAt(0)&&P(ro,"not start with m? "+d[k]));d=l.innerHTML;break}else m=m.nextElementSibling;g=fh(g.parentElement,"TABLE");for(k=0;g&&10>k&&"presentation"!=g.getAttribute("role");k++)g=fh(g,
"TABLE");"presentation"==g.getAttribute("role")?(g=g.querySelector("h2"))?f=g.textContent:M(ro,"email subject cannot be sniff"):M(ro,"expect a presentation role TABLE");g=vv().g.email;return{Xg:b,Uh:c,Vg:a,gf:d,Kh:g,qf:e,Sh:f}}h.hh=function(a){if(ta(a.target.href)){a.preventDefault();qv(this.h,"archiving...");var b=a=void 0,c=this.parent?$(this.parent,1).h():[];c[0]&&(a=c[0].module,b=c[0].id);(c=tv(this.n()))?iv(this.B(),c,a,b).u(function(a){pv(this,a)},function(a){uv(this.h,a)},this):uv(this.h,"Cannot gather email message")}};function wv(a,b){this.h=a;this.parent=b||null;this.g=[]}wv.prototype.logger=R("ydn.crm.ui.GmailCmdInjector");function xv(a){var b=document.body;(new MutationObserver(a.i.bind(a))).observe(b,{childList:!1,attributes:!0,characterData:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,attributeFilter:["data-tooltip"]})}
wv.prototype.i=function(a){for(var b=0;b<a.length;b++){var c=a[b].target;if("Reply"==c.getAttribute("data-tooltip")){var d;a:{for(d=0;d<this.g.length;d++)if(!document.body.contains(this.g[d].n())){this.g[d].$&&this.g[d].La();d=this.g[d];break a}d=new mv(this.h);this.g.push(d)}var e=document.createElement("span");c.parentElement.insertBefore(e,c);d.render(e)}}};function yv(){}C(yv,ht);da(yv);yv.prototype.w=function(){return"goog-menuheader"};function zv(a,b,c){At.call(this,a,c||yv.W(),b);Gt(this,1,!1);Gt(this,2,!1);Gt(this,4,!1);Gt(this,32,!1);this.Pb=1}C(zv,At);yt("goog-menuheader",function(){return new zv(null)});function Av(){this.h=[]}C(Av,ht);da(Av);function Bv(a,b){var c=a.h[b];if(!c){switch(b){case 0:c=a.w()+"-highlight";break;case 1:c=a.w()+"-checkbox";break;case 2:c=a.w()+"-content"}a.h[b]=c}return c}h=Av.prototype;h.Ob=function(){return"menuitem"};h.aa=function(a){var b=a.g.t("div",jt(this,a).join(" "),Cv(this,a.pa(),a.g));Dv(this,a,b,!!(a.ka&8)||!!(a.ka&16));kt(this,a,b);return b};h.xa=function(a){return a&&a.firstChild};
h.qa=function(a,b){var c=Xg(b),d=Bv(this,2);c&&st(c,d)||b.appendChild(Cv(this,b.childNodes,a.g));st(b,"goog-option")&&(Gt(a,16,!0),(c=a.n())&&Ev(a.i,a,c),Ev(this,a,b));return Av.m.qa.call(this,a,b)};h.Db=function(a,b){var c=this.xa(a),d=Fv(this,a)?c.firstChild:null;Av.m.Db.call(this,a,b);d&&!Fv(this,a)&&c.insertBefore(d,c.firstChild||null)};function Cv(a,b,c){a=Bv(a,2);return c.t("div",a,b)}function Ev(a,b,c){c&&(ft(c,"menuitemcheckbox"),Dv(a,b,c,!0))}
function Fv(a,b){var c=a.xa(b);if(c){var c=c.firstChild,d=Bv(a,1);return!!c&&A(c)&&1==c.nodeType&&st(c,d)}return!1}function Dv(a,b,c,d){d!=Fv(a,c)&&(d?tt(c,"goog-option"):vt(c,"goog-option"),c=a.xa(c),d?(a=Bv(a,1),c.insertBefore(b.g.t("div",a),c.firstChild||null)):c.removeChild(c.firstChild))}h.Sc=function(a){switch(a){case 2:return Bv(this,0);case 16:case 8:return"goog-option-selected";default:return Av.m.Sc.call(this,a)}};
h.Me=function(a){var b=Bv(this,0);switch(a){case "goog-option-selected":return 16;case b:return 2;default:return Av.m.Me.call(this,a)}};h.w=function(){return"goog-menuitem"};function Gv(a,b,c,d){At.call(this,a,d||Av.W(),c);this.ra(b)}C(Gv,At);h=Gv.prototype;h.S=function(){var a=this.B();return null!=a?a:this.xb()};h.xb=function(){var a=this.pa();return u(a)?(a=Sa(a,function(a){return A(a)&&1==a.nodeType&&(st(a,"goog-menuitem-accel")||st(a,"goog-menuitem-mnemonic-separator"))?"":dh(a)}).join(""),wa(a)):Gv.m.xb.call(this)};
h.hc=function(a){var b=this.getParent();if(b){var c=b.h;b.h=null;if(b=c&&y(a.clientX))b=new Gg(a.clientX,a.clientY),b=c==b?!0:c&&b?c.x==b.x&&c.y==b.y:!1;if(b)return}Gv.m.hc.call(this,a)};h.Ac=function(a){return a.g==this.rf&&this.ob(a)?!0:Gv.m.Ac.call(this,a)};h.$g=function(){return this.rf};yt("goog-menuitem",function(){return new Gv(null)});function Hv(){}C(Hv,ht);da(Hv);Hv.prototype.aa=function(a){return a.g.t("div",this.w())};Hv.prototype.qa=function(a,b){b.id&&Js(a,b.id);if("HR"==b.tagName){var c=b;b=this.aa(a);Vg(b,c);Wg(c)}else tt(b,this.w());return b};Hv.prototype.Db=function(){};Hv.prototype.w=function(){return"goog-menuseparator"};function Iv(a,b){At.call(this,null,a||Hv.W(),b);Gt(this,1,!1);Gt(this,2,!1);Gt(this,4,!1);Gt(this,32,!1);this.Pb=1}C(Iv,At);Iv.prototype.N=function(){Iv.m.N.call(this);var a=this.n();ft(a,"separator")};yt("goog-menuseparator",function(){return new Iv});function Jv(){}C(Jv,Mt);da(Jv);h=Jv.prototype;h.Nd=function(){return"menu"};h.Ue=function(a){return"UL"==a.tagName||Jv.m.Ue.call(this,a)};h.Tc=function(a){return"HR"==a.tagName?new Iv:Jv.m.Tc.call(this,a)};h.tb=function(a,b){return Yg(a.n(),b)};h.w=function(){return"goog-menu"};h.We=function(a){Jv.m.We.call(this,a);a=a.n();gt(a,"haspopup","true")};function Kv(a){Iv.call(this,Hv.W(),a)}C(Kv,Iv);yt("goog-menuseparator",function(){return new Iv});function Lv(a,b){Tt.call(this,St,b||Jv.W(),a);bu(this,!1)}C(Lv,Tt);h=Lv.prototype;h.sd=!0;h.w=function(){return this.lb.w()};h.tb=function(a){if(this.lb.tb(this,a))return!0;for(var b=0,c=Qs(this);b<c;b++){var d=$(this,b);if("function"==typeof d.tb&&d.tb(a))return!0}return!1};h.vc=function(){var a=[];Ps(this,function(b){a.push(b)});return a};h.fc=function(a,b,c){(b=Lv.m.fc.call(this,a,b))&&a&&this.$&&this.sd&&Ut(this).focus();a&&c&&y(c.clientX)?this.h=new Gg(c.clientX,c.clientY):this.h=null;return b};
h.cf=function(a){this.sd&&Ut(this).focus();return Lv.m.cf.call(this,a)};h.Xf=function(a){return a.isEnabled()&&a.Fa&&!!(a.ka&2)};h.Zb=function(a){for(var b=this.lb,c=Ng(this.g.g,"div",b.w()+"-content",a),d=c.length,e=0;e<d;e++)Pt(b,this,c[e]);Lv.m.Zb.call(this,a)};h.Ye=function(a){var b=Lv.m.Ye.call(this,a);b||Ps(this,function(c){!b&&c.$g&&c.rf==a.g&&(this.isEnabled()&&this.Ha(c),b=c.Sa(a))},this);return b};
h.Jb=function(a){Lv.m.Jb.call(this,a);if(a=$(this,a)){var b=a.n();a=this.n();var c=vi(b),d=vi(a),e=Hi(a),f=c.x-d.x-e.left,c=c.y-d.y-e.top,d=a.clientHeight-b.offsetHeight,e=a.scrollLeft,g=a.scrollTop,e=e+Math.min(f,Math.max(f-(a.clientWidth-b.offsetWidth),0)),g=g+Math.min(c,Math.max(c-d,0)),b=new Gg(e,g);a.scrollLeft=b.x;a.scrollTop=b.y}};function Mv(a,b,c,d,e,f,g,k,l){var m,n;if(m=c.offsetParent){var p="HTML"==m.tagName||"BODY"==m.tagName;p&&"static"==ri(m,"position")||(n=vi(m),p||(p=(p=wi(m))&&Ib?-m.scrollLeft:!p||H&&Ub("8")||"visible"==ri(m,"overflowX")?m.scrollLeft:m.scrollWidth-m.clientWidth-m.scrollLeft,n=Hg(n,new Gg(p,m.scrollTop))))}m=n||new Gg;n=Ai(a);if(p=ui(a)){var r=new pi(p.left,p.top,p.right-p.left,p.bottom-p.top),p=Math.max(n.left,r.left),s=Math.min(n.left+n.width,r.left+r.width);if(p<=s){var w=Math.max(n.top,r.top),
r=Math.min(n.top+n.height,r.top+r.height);w<=r&&(n.left=p,n.top=w,n.width=s-p,n.height=r-w)}}p=Jg(a);w=Jg(c);if(p.g!=w.g){var s=p.g.body,w=Rg(w.g),r=new Gg(0,0),z;z=(z=Lg(s))?Rg(z):window;var G=s;do{var E;if(z==w)E=vi(G);else{var J=G;E=void 0;if(J.getBoundingClientRect)E=si(J),E=new Gg(E.left,E.top);else{E=jh(Jg(J));var N=vi(J);E=new Gg(N.x-E.x,N.y-E.y)}if(Ib&&!Ub(12)){N=void 0;H?N="-ms-transform":Jb?N="-webkit-transform":Hb?N="-o-transform":Ib&&(N="-moz-transform");var ja=void 0;N&&(ja=ri(J,N));
ja||(ja=ri(J,"transform"));J=ja?(J=ja.match(Ii))?new Gg(parseFloat(J[1]),parseFloat(J[2])):new Gg(0,0):new Gg(0,0);E=new Gg(E.x+J.x,E.y+J.y)}}r.x+=E.x;r.y+=E.y}while(z&&z!=w&&(G=z.frameElement)&&(z=z.parent));s=Hg(r,vi(s));H&&!ih(p)&&(s=Hg(s,jh(p)));n.left+=s.x;n.top+=s.y}a=Nv(a,b);b=new Gg(a&2?n.left+n.width:n.left,a&1?n.top+n.height:n.top);b=Hg(b,m);e&&(b.x+=(a&2?-1:1)*e.x,b.y+=(a&1?-1:1)*e.y);var I;if(g)if(l)I=l;else if(I=ui(c))I.top-=m.y,I.right-=m.x,I.bottom-=m.y,I.left-=m.x;a:{l=b.ga();e=0;
a=Nv(c,d);d=yi(c);k=k?k.ga():d.ga();if(f||0!=a)a&2?l.x-=k.width+(f?f.right:0):f&&(l.x+=f.left),a&1?l.y-=k.height+(f?f.bottom:0):f&&(l.y+=f.top);if(g&&(I?(f=l,e=0,65==(g&65)&&(f.x<I.left||f.x>=I.right)&&(g&=-2),132==(g&132)&&(f.y<I.top||f.y>=I.bottom)&&(g&=-5),f.x<I.left&&g&1&&(f.x=I.left,e|=1),f.x<I.left&&f.x+k.width>I.right&&g&16&&(k.width=Math.max(k.width-(f.x+k.width-I.right),0),e|=4),f.x+k.width>I.right&&g&1&&(f.x=Math.max(I.right-k.width,I.left),e|=1),g&2&&(e=e|(f.x<I.left?16:0)|(f.x+k.width>
I.right?32:0)),f.y<I.top&&g&4&&(f.y=I.top,e|=2),f.y<=I.top&&f.y+k.height<I.bottom&&g&32&&(k.height=Math.max(k.height-(I.top-f.y),0),f.y=I.top,e|=8),f.y>=I.top&&f.y+k.height>I.bottom&&g&32&&(k.height=Math.max(k.height-(f.y+k.height-I.bottom),0),e|=8),f.y+k.height>I.bottom&&g&4&&(f.y=Math.max(I.bottom-k.height,I.top),e|=2),g&8&&(e=e|(f.y<I.top?64:0)|(f.y+k.height>I.bottom?128:0)),g=e):g=256,e=g,e&496)){c=e;break a}f=Ib&&(Cb||Lb)&&Ub("1.9");l instanceof Gg?(g=l.x,l=l.y):(g=l,l=void 0);c.style.left=xi(g,
f);c.style.top=xi(l,f);d==k||d&&k&&d.width==k.width&&d.height==k.height||(f=ih(Jg(Lg(c))),!H||f&&Ub("8")?(c=c.style,Ib?c.MozBoxSizing="border-box":Jb?c.WebkitBoxSizing="border-box":c.boxSizing="border-box",c.width=Math.max(k.width,0)+"px",c.height=Math.max(k.height,0)+"px"):(g=c.style,f?(H?(f=Ei(c,"paddingLeft"),d=Ei(c,"paddingRight"),l=Ei(c,"paddingTop"),I=Ei(c,"paddingBottom"),f=new oi(l,d,I,f)):(f=qi(c,"paddingLeft"),d=qi(c,"paddingRight"),l=qi(c,"paddingTop"),I=qi(c,"paddingBottom"),f=new oi(parseFloat(l),
parseFloat(d),parseFloat(I),parseFloat(f))),c=Hi(c),g.pixelWidth=k.width-c.left-f.left-f.right-c.right,g.pixelHeight=k.height-c.top-f.top-f.bottom-c.bottom):(g.pixelWidth=k.width,g.pixelHeight=k.height)));c=e}return c}function Nv(a,b){return(b&4&&wi(a)?b^2:b)&-5};function Ov(){}Ov.prototype.i=function(){};function Pv(a,b,c){this.g=a;this.h=b;this.p=c}C(Pv,Ov);Pv.prototype.i=function(a,b,c){Mv(this.g,this.h,a,b,void 0,c,this.p)};function Qv(a,b,c,d){Pv.call(this,a,b);this.j=c?5:0;this.l=d||void 0}C(Qv,Pv);Qv.prototype.o=function(){return this.j};Qv.prototype.i=function(a,b,c,d){var e=Mv(this.g,this.h,a,b,null,c,10,d,this.l);if(e&496){var f=Rv(e,this.h);b=Rv(e,b);e=Mv(this.g,f,a,b,null,c,10,d,this.l);e&496&&(f=Rv(e,f),b=Rv(e,b),Mv(this.g,f,a,b,null,c,this.j,d,this.l))}};function Rv(a,b){a&48&&(b^=2);a&192&&(b^=1);return b};function Sv(a,b,c,d){Qv.call(this,a,b,c||d);if(c||d)this.j=65|(d?32:132)}C(Sv,Qv);function Tv(){}C(Tv,ht);da(Tv);h=Tv.prototype;h.Ob=function(){return"button"};h.Wa=function(a,b,c){switch(b){case 8:case 16:gt(a,"pressed",c);break;default:case 64:case 1:Tv.m.Wa.call(this,a,b,c)}};h.aa=function(a){var b=Tv.m.aa.call(this,a);this.Kb(b,a.Cb());var c=a.S();c&&this.Re(b,c);a.ka&16&&this.Wa(b,16,ot(a,16));return b};h.qa=function(a,b){b=Tv.m.qa.call(this,a,b);var c=this.S(b);a.M=c;a.fe(this.Cb(b));a.ka&16&&this.Wa(b,16,ot(a,16));return b};h.S=ca;h.Re=ca;h.Cb=function(a){return a.title};
h.Kb=function(a,b){a&&b&&(a.title=b)};h.w=function(){return"goog-button"};function Uv(){}C(Uv,Tv);da(Uv);h=Uv.prototype;h.Ob=function(){};h.aa=function(a){Bt(a,!1);It(a);Gt(a,32,!1);return a.g.t("button",{"class":jt(this,a).join(" "),disabled:!a.isEnabled(),title:a.Cb()||"",value:a.S()||""},a.xb()||"")};h.Od=function(a){return"BUTTON"==a.tagName||"INPUT"==a.tagName&&("button"==a.type||"submit"==a.type||"reset"==a.type)};h.qa=function(a,b){Bt(a,!1);It(a);Gt(a,32,!1);if(b.disabled){var c=this.Sc(1);tt(b,c)}return Uv.m.qa.call(this,a,b)};
h.Pd=function(a){Ks(a).listen(a.n(),"click",a.ob)};h.Qd=ca;h.$e=ca;h.Ze=function(a){return a.isEnabled()};h.zc=ca;h.U=function(a,b,c){Uv.m.U.call(this,a,b,c);(a=a.n())&&1==b&&(a.disabled=c)};h.S=function(a){return a.value};h.Re=function(a,b){a&&(a.value=b)};h.Wa=ca;function Vv(a,b,c){At.call(this,a,b||Uv.W(),c)}C(Vv,At);h=Vv.prototype;h.S=function(){return this.M};h.fg=function(a){this.M=a;this.i.Re(this.n(),a)};h.Cb=function(){return this.H};h.Kb=function(a){this.H=a;this.i.Kb(this.n(),a)};h.fe=function(a){this.H=a};h.I=function(){Vv.m.I.call(this);delete this.M;delete this.H};h.N=function(){Vv.m.N.call(this);if(this.ka&32){var a=this.i.gc(this);a&&Ks(this).listen(a,"keyup",this.Ac)}};
h.Ac=function(a){return 13==a.g&&"key"==a.type||32==a.g&&"keyup"==a.type?this.ob(a):32==a.g};yt("goog-button",function(){return new Vv(null)});function Xv(){}C(Xv,Tv);da(Xv);h=Xv.prototype;h.aa=function(a){var b=jt(this,a),b=a.g.t("div",{"class":"goog-inline-block "+b.join(" ")},this.Dd(a.pa(),a.g));this.Kb(b,a.Cb());kt(this,a,b);return b};h.Ob=function(){return"button"};h.xa=function(a){return a&&a.firstChild.firstChild};h.Dd=function(a,b){return b.t("div","goog-inline-block "+(this.w()+"-outer-box"),b.t("div","goog-inline-block "+(this.w()+"-inner-box"),a))};h.Od=function(a){return"DIV"==a.tagName};
h.qa=function(a,b){Yv(b,!0);Yv(b,!1);var c;a:{c=a.g.dg(b);var d=this.w()+"-outer-box";if(c&&st(c,d)&&(c=a.g.dg(c),d=this.w()+"-inner-box",c&&st(c,d))){c=!0;break a}c=!1}c||b.appendChild(this.Dd(b.childNodes,a.g));ut(b,["goog-inline-block",this.w()]);return Xv.m.qa.call(this,a,b)};h.w=function(){return"goog-custom-button"};
function Yv(a,b){if(a)for(var c=b?a.firstChild:a.lastChild,d;c&&c.parentNode==a;){d=b?c.nextSibling:c.previousSibling;if(3==c.nodeType){var e=c.nodeValue;if(""==xa(e))a.removeChild(c);else{c.nodeValue=b?e.replace(/^[\s\xa0]+/,""):e.replace(/[\s\xa0]+$/,"");break}}else break;c=d}};function Zv(){}C(Zv,Xv);da(Zv);Ib&&(Zv.prototype.Db=function(a,b){var c=Zv.m.xa.call(this,a&&a.firstChild);if(c){var d;d=Jg(a).t("div","goog-inline-block "+(this.w()+"-caption"),b);var e=c.parentNode;e&&e.replaceChild(d,c)}});h=Zv.prototype;h.xa=function(a){a=Zv.m.xa.call(this,a&&a.firstChild);Ib&&a&&a.__goog_wrapper_div&&(a=a.firstChild);return a};h.Wa=function(a,b,c){64!=b&&Zv.m.Wa.call(this,a,b,c)};
h.qa=function(a,b){var c=Ng(document,"*","goog-menu",b)[0];if(c){S(c,!1);Lg(c).body.appendChild(c);var d=new Lv;Os(d,c);a.ad(d)}return Zv.m.qa.call(this,a,b)};h.Dd=function(a,b){return Zv.m.Dd.call(this,[b.t("div","goog-inline-block "+(this.w()+"-caption"),a),b.t("div","goog-inline-block "+(this.w()+"-dropdown"),"\u00a0")],b)};h.w=function(){return"goog-menu-button"};function $v(a,b,c,d){Vv.call(this,a,c||Zv.W(),d);Gt(this,64,!0);this.o=new Sv(null,5);b&&this.ad(b);this.ea=new hf(500);!Qh&&!Rh||Ub("533.17.9")||(this.Ud=!0)}C($v,Vv);h=$v.prototype;h.Ud=!1;h.N=function(){$v.m.N.call(this);this.h&&aw(this,this.h,!0);gt(this.X,"haspopup",!!this.h)};h.La=function(){$v.m.La.call(this);if(this.h){this.na(!1);this.h.La();aw(this,this.h,!1);var a=this.h.n();a&&Wg(a)}};h.I=function(){$v.m.I.call(this);this.h&&(this.h.la(),delete this.h);delete this.oa;this.ea.la()};
h.Zc=function(a){$v.m.Zc.call(this,a);ot(this,4)&&(this.na(!ot(this,64),a),this.h&&(this.h.nb=ot(this,64)))};h.hc=function(a){$v.m.hc.call(this,a);this.h&&!ot(this,4)&&(this.h.nb=!1)};h.ob=function(){Ft(this,!1);return!0};h.oh=function(a){this.h&&this.h.Ea&&!this.tb(a.target)&&this.na(!1)};h.tb=function(a){return a&&Yg(this.n(),a)||this.h&&this.h.tb(a)||!1};
h.Ac=function(a){if(32==a.g){if(a.preventDefault(),"keyup"!=a.type)return!0}else if("key"!=a.type)return!1;if(this.h&&this.h.Ea){var b=this.h.Sa(a);return 27==a.g?(this.na(!1),!0):b}return 40==a.g||38==a.g||32==a.g||13==a.g?(this.na(!0),!0):!1};h.bf=function(){this.na(!1)};h.wh=function(){ot(this,4)||this.na(!1)};h.Rd=function(a){this.Ud||this.na(!1);$v.m.Rd.call(this,a)};
h.ad=function(a){var b=this.h;if(a!=b&&(b&&(this.na(!1),this.$&&aw(this,b,!1),delete this.h),this.$&&gt(this.X,"haspopup",!!a),a)){this.h=a;Ls(a,this);a.fc(!1);var c=this.Ud;(a.sd=c)&&bu(a,!0);this.$&&aw(this,a,!0)}return b};h.$c=function(a,b){var c=$v.m.$c.call(this,a,b);c&&!this.Fa&&this.na(!1);return c};h.setEnabled=function(a){$v.m.setEnabled.call(this,a);this.isEnabled()||this.na(!1)};
h.na=function(a,b){$v.m.na.call(this,a);if(this.h&&ot(this,64)==a){if(a)this.h.$||this.h.render(),this.Y=ui(this.n()),this.V=Ai(this.n()),bw(this),this.h.Jb(-1);else{Ft(this,!1);this.h.nb=!1;var c=this.n();c&&gt(c,"activedescendant","");if(null!=this.p&&(this.p=void 0,c=this.h.n())){var d="",e;d instanceof Ig?(e=d.height,d=d.width):e="";c.style.width=xi(d,!0);c.style.height=xi(e,!0)}}this.h.fc(a,!1,b);this.G||(c=Ks(this),d=a?c.listen:c.ya,d.call(c,this.g.g,"mousedown",this.oh,!0),this.Ud&&d.call(c,
this.h,"blur",this.wh),d.call(c,this.ea,kf,this.Oh),a?jf(this.ea):this.ea.stop())}};function bw(a){if(a.h.$){var b=a.oa||a.n(),c=a.o;a.o.g=b;b=a.h.n();a.h.Ea||(b.style.visibility="hidden",S(b,!0));!a.p&&a.o.o&&a.o.j&32&&(a.p=yi(b));c.i(b,c.h^1,null,a.p);a.h.Ea||(S(b,!1),b.style.visibility="visible")}}
h.Oh=function(){var a=Ai(this.n()),b=ui(this.n()),c=this.V;(c=!(c==a||c&&a&&c.left==a.left&&c.width==a.width&&c.top==a.top&&c.height==a.height))||(c=this.Y,c=!(c==b||c&&b&&c.top==b.top&&c.right==b.right&&c.bottom==b.bottom&&c.left==b.left));c&&(this.V=a,this.Y=b,bw(this))};function aw(a,b,c){var d=Ks(a);c=c?d.listen:d.ya;c.call(d,b,"action",a.bf);c.call(d,b,"highlight",a.fh);c.call(d,b,"unhighlight",a.gh)}h.fh=function(a){var b=this.n();null!=a.target.n()&&gt(b,"activedescendant",a.target.n().id)};
h.gh=function(){if(!Xt(this.h)){var a=this.n();gt(a,"activedescendant","")}};yt("goog-menu-button",function(){return new $v(null)});H||Ib&&Ub("1.9.3");function cw(a){a||Jg();nd.call(this)}C(cw,nd);cw.prototype.set=function(a,b){nd.prototype.set.call(this,a,b);return this};function dw(a,b,c,d){return a.set(b.key,b.caption,c,d)}cw.prototype.render=function(){};cw.prototype.n=function(){return null};var ew={key:"ok",caption:"OK"},fw={key:"cancel",caption:"Cancel"},gw={key:"yes",caption:"Yes"},hw={key:"no",caption:"No"},iw={key:"save",caption:"Save"},jw={key:"continue",caption:"Continue"};
"undefined"!=typeof document&&(dw(new cw,ew,!0,!0),dw(dw(new cw,ew,!0),fw,!1,!0),dw(dw(new cw,gw,!0),hw,!1,!0),dw(dw(dw(new cw,gw),hw,!0),fw,!1,!0),dw(dw(dw(new cw,jw),iw),fw,!0,!0));function kw(){this.h=[]}C(kw,Av);da(kw);kw.prototype.aa=function(a){var b=kw.m.aa.call(this,a);tt(b,"goog-submenu");lw(this,a,b);return b};kw.prototype.qa=function(a,b){b=kw.m.qa.call(this,a,b);tt(b,"goog-submenu");lw(this,a,b);var c=Ng(document,"div","goog-menu",b);if(c.length){var d=new Lv(a.g),c=c[0];S(c,!1);a.g.g.body.appendChild(c);Os(d,c);mw(a,d)}return b};kw.prototype.Db=function(a,b){var c=this.xa(a),d=c&&c.lastChild;kw.m.Db.call(this,a,b);d&&c.lastChild!=d&&st(d,"goog-submenu-arrow")&&c.appendChild(d)};
kw.prototype.Pd=function(a){kw.m.Pd.call(this,a);var b=a.sa(),c=Ng(a.g.g,"span","goog-submenu-arrow",b)[0];nw(a,c);c!=b.lastChild&&b.appendChild(c);a=a.n();gt(a,"haspopup","true")};function lw(a,b,c){var d=b.g.t("span");d.className="goog-submenu-arrow";nw(b,d);a.xa(c).appendChild(d)}function nw(a,b){Rs(a)?(tt(b,"goog-submenu-arrow-rtl"),Zg(b,"\u25c4")):(vt(b,"goog-submenu-arrow-rtl"),Zg(b,"\u25ba"))};function ow(a,b,c,d){Gv.call(this,a,b,c,d||kw.W())}C(ow,Gv);h=ow.prototype;h.Qc=null;h.zf=null;h.lg=!1;h.ua=null;h.Fd=!1;h.N=function(){ow.m.N.call(this);Ks(this).listen(this.getParent(),"hide",this.sg);this.ua&&pw(this,this.ua,!0)};h.La=function(){Ks(this).ya(this.getParent(),"hide",this.sg);this.ua&&(pw(this,this.ua,!1),this.Fd||(this.ua.La(),Wg(this.ua.n())));ow.m.La.call(this)};h.I=function(){this.ua&&!this.Fd&&this.ua.la();this.ua=null;ow.m.I.call(this)};
h.Ha=function(a,b){ow.m.Ha.call(this,a);b&&(qw(this).nb=!0);a||(this.Qc&&q.clearTimeout(this.Qc),this.Qc=lf(this.ub,218,this))};h.yf=function(){var a=this.getParent();a&&Xt(a)==this&&(rw(this,!0),sw(this))};h.ub=function(){var a=this.ua;a&&a.getParent()==this&&(rw(this,!1),Ps(a,function(a){"function"==typeof a.ub&&a.ub()}))};function tw(a){a.Qc&&q.clearTimeout(a.Qc);a.zf&&q.clearTimeout(a.zf)}h.$c=function(a,b){var c=ow.m.$c.call(this,a,b);c&&!this.Fa&&this.ub();return c};
function sw(a){Ps(a.getParent(),function(a){a!=this&&"function"==typeof a.ub&&(a.ub(),tw(a))},a)}h.Sa=function(a){var b=a.g,c=Rs(this)?37:39,d=Rs(this)?39:37;if(!this.lg){if(!this.isEnabled()||b!=c&&b!=this.rf)return!1;this.yf();Yt(qw(this));tw(this)}else if(!qw(this).Sa(a))if(b==d)this.ub();else return!1;a.preventDefault();return!0};h.Lh=function(){this.ua.getParent()==this&&(tw(this),this.Ec.Ha(this),sw(this))};h.sg=function(a){a.target==this.Ec&&(this.ub(),tw(this))};
h.cd=function(a){this.isEnabled()&&(tw(this),this.zf=lf(this.yf,218,this));ow.m.cd.call(this,a)};h.ob=function(a){tw(this);if(this.ka&8)return ow.m.ob.call(this,a);this.yf();return!0};
function rw(a,b){a.dispatchEvent(Is(64,b));var c=qw(a);if(b!=c.Ea){b&&(c.$||c.render(),c.Jb(-1));a.lg=b;var d=a.n();b?tt(d,"goog-submenu-open"):vt(d,"goog-submenu-open");c.fc(b);if(b){var c=new Qv(a.n(),6,!1),d=qw(a),e=d.n();d.Ea||(e.style.visibility="hidden",S(e,!0));c.i(e,4);d.Ea||(S(e,!1),e.style.visibility="visible")}}}function pw(a,b,c){var d=Ks(a);(c?d.listen:d.ya).call(d,b,"enter",a.Lh)}h.vc=function(){return qw(this).vc()};
function qw(a){a.ua?a.Fd&&a.ua.getParent()!=a&&Ls(a.ua,a):mw(a,new Lv(a.g));a.ua.n()||a.ua.T();return a.ua}function mw(a,b){var c=a.ua;b!=c&&(c&&(a.ub(),a.$&&pw(a,c,!1)),a.ua=b,a.Fd=!1,b&&(Ls(b,a),b.fc(!1,!0),b.sd=!1,bu(b,!1),a.$&&pw(a,b,!0)))}h.tb=function(a){return qw(this).tb(a)};yt("goog-submenu",function(){return new ow(null)});function uw(a){this.h=a;this.g=null}uw.prototype.logger=R("ydn.crm.ui.gmail.Template");uw.prototype.B=function(){return this.h};function vw(a){if("FORM"!=a.tagName)return null;for(a=a.nextElementSibling;a&&"TABLE"!=a.tagName;)a=a.nextElementSibling;return a}function ww(a){a=fh(a,"table");a=fh(a.parentElement,"table");return fh(a.parentElement,"table").querySelector("form")}
function xw(a,b){if(!a)return null;var c=b||ro,d=ww(a);if(!d)return M(c,"Gmail header FORM not found"),null;d=d.querySelector("textarea[name=to]");if(!d)return M(c,"To textarea not found."),null;d=d.parentElement.querySelector("span[email]");return d?d?d.getAttribute("email"):null:(M(c,"email span not found in TO element"),null)}
uw.prototype.i=function(a){if(a.target instanceof Gv){var b=a.target.B();a=this.B();if(b){var c=xw(this.g,this.logger),d=!1;c||(c=Lu(a),d=!!c);c?yw(this,b.id,c).u(function(a){var f=ww(this.g),g=f.querySelector('input[name="subjectbox"]'),k=vw(f).querySelector('div[aria-label="Message Body"]');d&&(f.querySelector('textarea[name="to"]').value=c);g.value=b.name;f=document.createElement("span");f.innerHTML=a;k.appendChild(f)},function(a){throw a;},this):window.alert("A valid recipient email address is required in To input field.")}else window.open(ev(a)+
"/index.php?module=EmailTemplates&action=EditView&return_module=EmailTemplates&return_action=DetailView",a.K())}};
function zw(a,b){var c=new Kg(b.ownerDocument);if(a.g)a.g.parentElement!=b&&(a.g.parentElement&&a.g.parentElement.removeChild(a.g),c=c.t("span"),c.className="crm-template inj",c.appendChild(a.g),b.insertBefore(c,b.firstElementChild));else{a.g=b;var d=new Lv(c),e=new $v("$t",d,null,c);e.Kb("Insert SugarCRM template");Aw(a,function(a){for(var b=[],c=0;c<a.length;c++)-1==b.indexOf(a[c].type)&&b.push(a[c].type);for(c=0;c<b.length;c++)if(b[c]){for(var e=new ow(b[c],null,d.g),m=0;m<a.length;m++)if(a[m].type==
b[c]){var n=new Gv(a[m].name,a[m]);qw(e).R(n,!0)}d.R(e,!0)}for(m=0;m<a.length;m++)a[m].type||(n=new Gv(a[m].name,a[m]),d.R(n,!0));d.R(new Kv,!0);d.R(new Gv("New template...",null),!0)},a);c=c.t("span");c.className="crm-template inj";b.insertBefore(c,b.firstElementChild);e.render(c);Ac(d,"action",a.i,!0,a)}}
function Aw(a,b,c){gv(a.B(),"EmailTemplates",void 0,void 0,void 0,200).u(function(a){a=a[0];for(var e=[],f=0;f<a.result.length;f++){var g=a.result[f],k=g.body_html;e.push({id:g.id,name:g.name,type:g.type||"",ni:0<=k.indexOf("$contact_name")||0<=k.indexOf("$contact_account_name")})}b.call(c,e)},function(a){throw a;},a)}
function yw(a,b,c){var d=a.B();if(x(c))return d.send("list",[{store:"Contacts",index:"ydn$emails",key:c,limit:1},{store:"Leads",index:"ydn$emails",key:c,limit:1}]).A(function(a){var c=null;a[0].result[0]?c=new Oq(d.K(),"Contacts",a[0].result[0]):a[1].result[0]&&(c=new Oq(d.K(),"Leads",a[1].result[0]));a=c?new wu(d,c):null;return yw(this,b,a)},a);if(!x(b)||16>b.length)throw Error("valid template id required, but "+b+" found.");return d.send("get",{module:"EmailTemplates",id:b}).A(function(a){a=a.body_html;
if(x(a)){var d=this.B().j;if(d&&d.g){var g;g=this.B().l.Users;for(var k in g.module_fields)g=d.value(k),x(g)&&(a=a.replace(RegExp("\\$user_"+k,"g"),g))}else M(this.logger,"Login user info not available");if(c&&xu(c))for(k in d=qu(c),d.module_fields)g=c.value(k),x(g)&&(a=a.replace(RegExp("\\$contact_"+k,"g"),g));return a}throw Error("Template record: "+b+" does not have body_html");},a)};function Bw(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b?"checked":null;break;case "select-one":a.selectedIndex=-1;if(x(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":c=b;x(c)&&(c=[c]);for(var e=0;d=a.options[e];e++)if(d.selected=!1,c)for(var f,g=0;f=c[g];g++)d.value==f&&(d.selected=!0);break;default:a.value=null!=b?b:""}};function Cw(){}C(Cw,ht);da(Cw);Cw.prototype.w=function(){return"field"};function Dw(a){var b=qu(a.parent.module).module_fields[a.g];a="ydnf-"+(a.parent.module.Z()+"-"+a.g);if("enum"==b.type&&b.options&&!document.getElementById(a)){var c=document.createElement("datalist");c.id=a;for(var d in b.options)d&&(b=document.createElement("option"),b.setAttribute("value",d),c.appendChild(b));document.body.appendChild(c)}return a}
Cw.prototype.aa=function(a){var b=Cw.m.aa.call(this,a);a.X=b;var c=a.B();a=a.g;var d,e,f=pu(c);d=qu(c.parent.module).module_fields[c.g].type||"varchar";"bool"==d?(d=a.t("input",{"class":"value",type:"checkbox",disabled:"1"}),e=a.t("span","name")):"enum"==d?(d=a.t("input",{"class":"value enum",type:"text",disabled:"1"}),d.setAttribute("list",Dw(c))):(d=a.t("label","value"),e=a.t("sup","name"));b.classList.add(this.w());b.setAttribute("name",c.g);b.appendChild(d);e&&(e.textContent=f,b.appendChild(e));
return b};Cw.prototype.refresh=function(a,b){S(a,!!b);if(b){var c=ou(b),d=x(c)?!va(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":Bw(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function Ew(a,b,c){At.call(this,null,b,c);Bt(this,!1);Dt(this);It(this);Gt(this,32,!1);Gt(this,8,!1);this.ra(a)}C(Ew,At);wt(Ew,Cw);Ew.prototype.refresh=function(){this.i.refresh(this.n(),this.B())};wt(Ew,Cw);function Fw(){this.i=0}var Gw=new Fw;Fw.prototype.render=function(){};Fw.prototype.h=function(){return++this.i};Fw.prototype.da=function(){return this.i};function Hw(){this.i=0;this.g=document.createElement("div");var a=document.createElement("div");a.className="statusbar";this.g.className="message";a.appendChild(this.g)}C(Hw,Fw);Hw.prototype.render=function(a){a.appendChild(this.g.parentElement)};
Hw.prototype.h=function(a,b){var c=Hw.m.h.call(this,a,b);this.g.g=a;b?this.g.classList.add("error"):this.g.classList.remove("error");return c};function Iw(a,b){Z.call(this,b);this.ra(a)}C(Iw,Z);h=Iw.prototype;h.N=function(){Iw.m.N.call(this);this.n();var a=this.B(),b=Ks(this);b.listen(a,"record-change",this.Cf);b.listen(a,"record-update",this.Cf);this.Cf()};h.Cf=function(){this.refresh()};h.w=function(){return"record-body"};h.T=function(){Iw.m.T.call(this);var a=this.n();a.classList.add(this.w());a.classList.add("view")};h.Dg=function(){return null};h.refresh=function(){for(var a=0;a<Qs(this);a++)$(this,a).refresh()};function Jw(){}C(Jw,ht);da(Jw);Jw.prototype.w=function(){return"record-group"};
Jw.prototype.aa=function(a){var b=Jw.m.aa.call(this,a),c=a.g,d=c.t("div"),e=c.t("div","content");b.appendChild(d);b.appendChild(e);a.X=b;b.setAttribute("name",a.B().g);for(var d=a.B(),e=su(d),f=Cw.W(),g=0;g<e.length;g++){var k=uu(d,e[g]),k=new Ew(k,f,c);a.R(k,!0)}a=d.module;c=a.parent.o||null;a=A(c)?lc(c,["modules",a.Z()]):null;(a=A(a)?lc(a,["groups",d.g]):null)?d=a.normallyHide:(d=d.g,d=/address/i.test(d)?!1:0<=["email","name","phone"].indexOf(d)?!1:!0);d&&b.classList.add("normally-hide");return b};function Kw(a,b,c){At.call(this,null,b,c);Bt(this,!1);Dt(this);It(this);Gt(this,32,!1);Gt(this,8,!1);this.ra(a)}C(Kw,At);Kw.prototype.sa=function(){return Mg("content",this.n())};Kw.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)$(this,a).refresh()};wt(Kw,Jw);function Lw(){}C(Lw,Cw);da(Lw);
Lw.prototype.aa=function(a){var b=a.g.t("span",jt(this,a).join(" "),a.pa());kt(this,a,b);a.X=b;var c=a.B(),d=a.g;a=pu(c);var e=qu(c.parent.module).module_fields[c.g].type||"varchar";"bool"==e?d=d.t("input",{"class":"value",type:"checkbox",disabled:"1"}):"enum"==e?(d=d.t("input",{"class":"value enum",type:"text",disabled:"1"}),d.setAttribute("list",Dw(c))):d=d.t("label","value");d.setAttribute("title",a);b.classList.add(this.w());b.setAttribute("name",c.g);b.appendChild(d);return b};
Lw.prototype.refresh=function(a,b){S(a,!!b);if(b){var c=ou(b),d=x(c)?!va(c):null!=c,e=a.querySelector(".value");"LABEL"==e.tagName?e.textContent=d?c:"":Bw(e,c);d?a.classList.remove("empty"):a.classList.add("empty")}};function Mw(){}C(Mw,ht);da(Mw);Mw.prototype.w=function(){return"address"};Mw.prototype.aa=function(a){var b=Mw.m.aa.call(this,a),c=a.B(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.t("details"),f=d.t("summary");f.textContent=vu(c);b.appendChild(f);var g=d.t("div","content");e.appendChild(f);e.appendChild(g);b.appendChild(e);a.X=b;e=su(c);f=Lw.W();for(g=0;g<e.length;g++){var k=uu(c,e[g]),k=new Ew(k,f,d);a.R(k,!0)}return b};function Nw(a,b){var c=Mw.W();Kw.call(this,a,c,b)}C(Nw,Kw);Nw.prototype.sa=function(){return this.n().querySelector("summary").nextElementSibling};Nw.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)$(this,a).refresh()};wt(Nw,Mw);function Ow(){}C(Ow,ht);da(Ow);Ow.prototype.w=function(){return"email"};Ow.prototype.aa=function(a){var b=Ow.m.aa.call(this,a),c=a.B(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.t("div");e.setAttribute("title",vu(c));b.appendChild(e);c=d.t("div","content");b.appendChild(e);b.appendChild(c);return a.X=b};
function Pw(a,b,c,d,e,f){b?(a.textContent=c||b,a.setAttribute("name",b),b="",d&&(b+=" primary"),e&&(b+=" optout"),f&&(b+=" deleted"),a.className=b):(a.textContent="",a.className="empty")}
Ow.prototype.refresh=function(a){var b=a.n(),c=a.B();S(b,!!c);if(c){var b=a.g,d=uu(c,"email"),e=d?d.Uc():null,d=u(e);a=a.sa();if(d){for(d=0;d<e.length;d++){var c=e[d],f=a.children[d];f||(f=b.t("SPAN"),a.appendChild(f));c&&Pw(f,c.email_address,void 0,"1"==c.primary_address?!0:!1,"1"==c.opt_out?!0:!1,"1"==c.deleted?!0:!1)}for(d=a.childElementCount-1;d>=e.length;d--)a.removeChild(a.children[d])}else{e=su(c);for(d=0;d<e.length;d++){var g=e[d],f=a.children[d];f||(f=b.t("SPAN"),a.appendChild(f));(g=uu(c,
g))&&Pw(f,ou(g))}for(d=a.childElementCount-1;d>=e.length;d--)a.removeChild(a.children[d])}}};function Qw(a,b){var c=Ow.W();Kw.call(this,a,c,b)}C(Qw,Kw);Qw.prototype.sa=function(){return Mg("content",this.n())};Qw.prototype.refresh=function(){this.i.refresh(this)};wt(Qw,Ow);function Rw(){}C(Rw,ht);da(Rw);Rw.prototype.w=function(){return"list"};Rw.prototype.aa=function(a){var b=Rw.m.aa.call(this,a),c=a.B(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.t("div");e.setAttribute("title",vu(c));b.appendChild(e);var f=d.t("div","content");b.appendChild(e);b.appendChild(f);a.X=b;for(var e=su(c),f=Lw.W(),g=0;g<e.length;g++){var k=uu(c,e[g]),k=new Ew(k,f,d);a.R(k,!0)}return b};function Sw(a,b){var c=Rw.W();Kw.call(this,a,c,b)}C(Sw,Kw);Sw.prototype.sa=function(){return Mg("content",this.n())};Sw.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)$(this,a).refresh()};wt(Sw,Rw);function Tw(){}C(Tw,ht);da(Tw);Tw.prototype.w=function(){return"name"};
Tw.prototype.aa=function(a){var b=Tw.m.aa.call(this,a),c=a.B(),d=a.g;b.setAttribute("name",c.g);b.classList.add("record-group");var e=d.t("div");e.setAttribute("title",vu(c));b.appendChild(e);var f=d.t("div","content");b.appendChild(e);b.appendChild(f);a.X=b;su(c);e=Lw.W();tu(c,"salutation")&&(f=uu(c,"salutation"),f=new Ew(f,e,d),a.R(f,!0));tu(c,"first_name")&&a.R(new Ew(uu(c,"first_name"),e,d),!0);tu(c,"last_name")&&a.R(new Ew(uu(c,"last_name"),e,d),!0);return b};function Uw(a,b){var c=Tw.W();Kw.call(this,a,c,b)}C(Uw,Kw);Uw.prototype.sa=function(){return Mg("content",this.n())};Uw.prototype.refresh=function(){for(var a=0;a<Qs(this);a++)$(this,a).refresh()};wt(Uw,Tw);function Vw(a,b){Z.call(this,b);this.ra(a)}C(Vw,Z);Vw.prototype.w=function(){return"field"};Vw.prototype.T=function(){Vw.m.T.call(this);var a=this.n(),b=this.g,c=this.B();a.classList.add(this.w());a.classList.add(c.g);b=b.t("INPUT",{type:"text",name:c.g});a.appendChild(b)};Vw.prototype.refresh=function(){var a=this.B();this.n().querySelector("input").value=ou(a)};function Ww(a,b){Z.call(this,b);this.ra(a)}C(Ww,Z);Ww.prototype.w=function(){return"field"};Ww.prototype.T=function(){Ww.m.T.call(this);var a=this.n(),b=this.g,c=this.B();a.classList.add(this.w());a.classList.add(c.g);b=b.t("TEXTAREA",{name:c.g});a.appendChild(b)};Ww.prototype.refresh=function(){var a=this.B();this.n().querySelector("textarea").value=ou(a)};function Xw(a,b){Iw.call(this,a,b)}C(Xw,Iw);Xw.prototype.T=function(){Xw.m.T.call(this);this.n();var a=this.g,b=this.B(),c=[],d=qu(b),e;for(e in d.module_fields){var f=d.module_fields[e].group;-1==c.indexOf(f)&&c.push(f)}d=Jw.W();for(e=0;e<c.length;e++){var f=c[e],g,k=Bu(b,f);/address/i.test(f)?g=new Nw(k,a):"email"==f?g=new Qw(k,a):"phone"==f?g=new Sw(k,a):"name"==f?g=new Uw(k,a):g=new Kw(k,d,a);this.R(g,!0)}};function Yw(){}da(Yw);function Zw(a){return a.querySelector(".record-footer")}function $w(a){return a.querySelector(".record-footer button[name=save]")}function ax(a){var b;b=a.n().querySelector(".record-footer div.message");b.textContent="";b.classList.remove("error");a=$w(a.n());a.textContent="Save";a.removeAttribute("disabled")};function bx(){}da(bx);
bx.prototype.refresh=function(a){var b=a.B(),c=b.Z(),d;d=a.n().querySelector(".record-header .title");a=a.n().querySelector(".record-header .link");if(xu(b)){d.textContent=b.g.g?Rq(b.g):"";var e;e=b.wa();e=oq(e.domain,e.module,e.F());d.href=e;d.target=b.K();b instanceof Eu?(a.textContent="",Qu(b)?(a.classList.add("synced"),a.setAttribute("title","Gmail contact "+yp(Nu(b))+" is synced with SugarCRM "+c+" "+b.F())):(a.classList.remove("synced"),!b.h&&xu(b)&&Ou(b.getParent())?(a.textContent="link",a.setAttribute("title",
"Link Gmail contact "+yp(Nu(b))+" with SugarCRM "+c+" "+b.F())):(a.textContent="export",a.setAttribute("title","Export SugarCRM "+c+" "+b.F()+" to Gmail My Contact"))),S(a,!0)):S(a,!1)}else d.textContent="",d.href=""};function cx(a){return a.querySelector(".record-header")};function dx(a,b){Iw.call(this,a,b)}C(dx,Iw);dx.prototype.T=function(){dx.m.T.call(this);var a=this.g,b=this.B(),c=Bu(b,"name"),b=Bu(b,""),c=uu(c,"name"),b=uu(b,"description");this.R(new Vw(c,a),!0);this.R(new Ww(b,a),!0)};
dx.prototype.Dg=function(a){var b=$(this,0).n().querySelector("input").value,c=$(this,1).n().querySelector("textarea").value;if(!b)return Gw.h("Note title required.",!0),null;b={name:b,description:c};if(a=a.o)a=a.B(),b.parent_type=a.Z(),b.parent_id=a.F(),b.parent_name=a.value("name");return b};function ex(a,b){Z.call(this,b);this.ra(a)}C(ex,Z);ex.prototype.w=function(){return"secondary"};ex.prototype.T=function(){ex.m.T.call(this);this.n().classList.add(this.w())};ex.prototype.N=function(){ex.m.N.call(this);var a=this.B();if(0<=kq.indexOf(a.Z())){var b=Ks(this);b.listen(a,"module-change",this.h);b.listen(a,"record-change",this.h);this.h()}};
ex.prototype.h=function(){for(;this.Da&&0!=this.Da.length;){var a=$(this,0);this.yc(a,!0);a.la()}a=this.B();if(xu(a)){var b=a.wa(),c=a.parent,a=[{store:"Notes",index:"parent",reverse:!0,keyRange:mj([a.Z(),b.F()])}];c.send("list",a).u(function(a){for(var b=0;b<a.length;b++){var f=a[b];f.result&&0<f.result.length&&(f=new wu(this.B().parent,new Oq(c.K(),"Notes",f.result[0])),f=new fx(f,this.g),this.R(f,!0))}},function(a){throw a;},this)}};function fx(a,b,c){Z.call(this,b);this.ra(a);this.o=c||null;this.i=bx.W();this.h=gx(this);this.j=new ex(a,b);Yw.W()}C(fx,Z);h=fx.prototype;h.logger=R("ydn.crm.ui.sugar.record.Record");h.w=function(){return"record-panel"};function gx(a){var b=a.B();a=a.g;return"Notes"==b.Z()?new dx(b,a):new Xw(b,a)}h.sa=function(){return this.n().querySelector(".content")};
h.T=function(){fx.m.T.call(this);var a=this.n(),b=this.g;a.className=this.w()+" "+this.B().Z();var c=b.t("div","record-header"),d=b.t("div","content");a.appendChild(c);a.appendChild(d);var c=cx(this.n()),d=this.g,e=this.B().Z(),f=d.t("div");c.appendChild(f);var g=d.t("a","title"),e=d.t("span","icon",e.substr(0,2)),k=d.t("a",{href:"#link","class":"link"});f.appendChild(e);f.appendChild(g);f.appendChild(k);g=d.t("div","toolbar");g.appendChild(d.t("a",{name:"Notes","class":"new-item",href:"#new-Notes"},
"Add Note"));g.appendChild(d.t("a",{name:"edit",href:"#edit"},"edit"));g.appendChild(d.t("a",{name:"detail",href:"#detail"},"detail"));c.appendChild(f);c.appendChild(g);this.R(this.h,!0);this.R(this.j,!0);b=b.t("div","record-footer");a.appendChild(b);c=this.g;a=Zw(this.n());b=c.t("button",{type:"button",name:"save"},"Save");c=c.t("div","message");a.appendChild(b);a.appendChild(c)};
h.N=function(){fx.m.N.call(this);var a=Ks(this),b=this.B();a.listen(b,"click",this.jg,!1);a.listen($w(this.n()),"click",this.Bh,!0);a.listen(b,"module-change",this.jg);a.listen(b,Fu,this.kg);a.listen(b,"record-change",this.kg);a.listen(b,"record-update",this.Ah);b=this.n().querySelector(".record-header");a.listen(b,"click",this.lh,!1);a.listen(this.n(),"dblclick",this.nh,!1);hx(this)};
h.lh=function(a){this.n().classList.add("activated");var b=a.target.getAttribute("name");if(a.target.classList.contains("new-item"))a.preventDefault(),ix(this,iq[iq.indexOf(b)]);else if(a.target.classList.contains("link")){a.preventDefault();var c=a.target;c.classList.contains("synced")?P(this.logger,"record in sync"):(a=this.B(),a instanceof Eu&&(!a.h&&xu(a)&&Ou(a.getParent())?(c.textContent="...",Wu(a).u(function(){c.textContent=""},function(a){c.textContent="error";throw a;},this)):(c.textContent=
"...",Uu(a).u(function(){c.textContent=""},function(a){c.textContent="error";throw a;},this))))}else"detail"==b?jx(this,a):"edit"==b&&(a.preventDefault(),a=this.h.n().classList.contains("edit"),kx(this,!a))};h.nh=function(){};
function kx(a,b){var c=a.h;b?(c.n().classList.add("edit"),c.n().classList.remove("view")):(c.n().classList.remove("edit"),c.n().classList.add("view"));c=Zw(a.n());b?(c.classList.add("edit"),c.classList.remove("view")):(c.classList.remove("edit"),c.classList.add("view"));b?a.n().classList.remove("empty"):xu(a.B())&&a.n().classList.add("empty")}
h.Bh=function(a){var b=a.target;if(a=this.h.Dg(this)){b.textContent="saving...";b.setAttribute("disabled","1");var c=this.B();Pq(c.wa(),a);c.save().u(function(){Gw.h("saved",void 0);kx(this,!1);b.textContent="Save";b.removeAttribute("disabled")},function(a){b.textContent="Save";Gw.h("error saving "+a.message,!0)},this)}};
function jx(a,b){b.preventDefault();var c=a.n(),d=a.h.n(),c=c.querySelector("a[name=detail]");"detail"!=c.textContent?(c.textContent="detail",d.classList.remove("detail")):(c.textContent="less",d.classList.add("detail"))}function ix(a,b){var c=a.B().parent,c=new wu(c,new Oq(c.K(),b)),c=new fx(c,a.g,a);a.j.R(c,!0);kx(c,!0)}h.jg=function(){hx(this);this.yc(this.h,!0);this.h.la();this.h=gx(this);this.qd(this.h,0,!0)};h.kg=function(){hx(this)};h.Ah=function(){this.refresh()};
function hx(a){var b=a.B(),c=a.n(),d=a.i,e=a.n().querySelector("a[name=detail]");e.textContent="detail";S(e,!0);for(var e=0<=lq.indexOf(a.B().Z()),f=a.n().querySelectorAll(".new-item"),g=f.length-1;0<=g;g--)S(f[g],e);e=a.B();f=e.Z();g=cx(a.n());Mg("icon",g).textContent=f.substring(0,2);f=g.querySelector("a[name=edit]");S(f,0<=nq.indexOf(e.Z()));d.refresh(a);ax(a);c.className=xu(b)?a.w()+" "+b.Z():a.w()+" "+b.Z()+" empty"}
h.refresh=function(){xu(this.B())?this.n().classList.remove("empty"):this.n().classList.add("empty");this.i.refresh(this);ax(this)};h.toString=function(){return"ydn.crm.ui.sugar.record.Record:"+this.B()};function nv(){Mc.call(this);this.h=this.g=null}C(nv,Mc);nv.prototype.I=function(){this.g&&(this.g.la(),this.h=this.g=null)};function ov(a,b){a.h=b;a.g=new ff(a);a.g.listen(b,"click",a.i,!0)}nv.prototype.n=function(){return this.h};nv.prototype.i=function(a){var b=this.n(),c=this.n();(c.classList.contains("error")?lx:c.href?"n":"v")==lx?(a.preventDefault(),b.textContent="Error reported, thanks.",b.removeAttribute("href"),b.removeAttribute("title"),b.classList.remove("error")):this.dispatchEvent(a)};
var lx="e";function qv(a,b,c,d){a=a.n();a.classList.remove("error");c?a.href=c:a.removeAttribute("href");b?(a.textContent=b,S(a,!0)):S(a,!1);d?a.setAttribute("title",d):a.removeAttribute("title")}function uv(a,b,c){a=a.n();a.classList.add("error");a.href="#error";a.textContent="error";b&&b instanceof Error&&(b=b.name+": "+b.message);a.setAttribute("title","Click to report error"+(b?" for "+b:""));c&&ed().send("log-bug",c)};function mx(a,b){Z.call(this,b);this.ra(a);this.h=new nv;this.i=new nv}C(mx,Z);h=mx.prototype;h.logger=R("ydn.crm.ui.GDataPanel");h.sa=function(){return Mg("gdata-content",this.n())};
h.T=function(){mx.m.T.call(this);var a=this.n(),b=this.B(),c=b.Z(),d=this.g,e=d.t("div","record-root");a.appendChild(e);var a=d.t("div","gdata-header"),f=d.t("div","gdata-content");e.appendChild(a);e.appendChild(f);e.classList.add(c);d.t("span",{"class":"icon"},c.substr(0,2));c=d.t("a",{"class":"import",href:"#import"},"Add to "+c);c.style.zIndex=1E3;c=d.t("div",{"class":"import"},c);a.appendChild(c);b=new fx(b,d);this.R(b,!0)};
h.N=function(){mx.m.N.call(this);var a=this.n(),b=Ks(this),c=this.B();ov(this.h,Ng(document,"A","import",a)[0]);b.listen(this.h,"click",this.sh,!1);b.listen(this.i,"click",this.vh,!1);b.listen(c,[Fu],this.ig);b.listen(c,"record-change",this.ig)};
h.ig=function(){var a,b;b=this.B();var c=Mg("gdata-header",this.n());if(xu(b))S(c,!1);else{S(c,!0);a=this.B();var d=Nu(a),e=a.wa(),f=a.Z(),g="Add to "+f;b="Add current contact "+Pu(a)+" to SugarCRM "+f;xu(a)?(b=g="",d&&!Qu(a)&&(yp(d),e.F())):!(d=Nu(a))||d instanceof Cu||(g="Import to "+f,b="Import existing gmail contact "+Pu(a)+" to SugarCRM "+f);a=g;c.querySelector(".import").querySelector("a");a?(S(c,!0),qv(this.h,a,"#import",b)):S(c,!1)}};
h.vh=function(){var a=this.B();qv(this.i,"Linking...");Wu(a).u(function(){qv(this.i,"Done.");this.dispatchEvent(new K("record-change"))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?xh(a):a;var c=hh(this.n());uv(this.i,a,{"class":"RecordHeader",method:"handleLinkClick",context:"link",html:c?c.outerHTML:"",error:a})},this)};
h.sh=function(){var a=this.B();qv(this.h,"Adding... to "+a.Z());var b;Nu(a)?(b=Ru(a),b=b.A(function(){qv(this.h,"Linking GData and SugarCRM...");return Wu(a)},this)):b=Su(a);b.u(function(){qv(this.h,null);this.dispatchEvent(new K("change",this))},function(a){a=a instanceof Error?a.name+" "+a.message:A(a)?xh(a):a;var b=hh(this.n());uv(this.h,a,{"class":"RecordHeader",method:"handleImportClick",context:"link",html:b?b.outerHTML:"",error:a})},this)};function nx(){}C(nx,Hv);da(nx);nx.prototype.aa=function(a){return a.g.t("div",this.w()+" goog-inline-block","\u00a0")};nx.prototype.qa=function(a,b){b=nx.m.qa.call(this,a,b);tt(b,"goog-inline-block");return b};nx.prototype.w=function(){return"goog-toolbar-separator"};function ox(){}C(ox,Mt);da(ox);ox.prototype.Nd=function(){return"toolbar"};ox.prototype.Tc=function(a){return"HR"==a.tagName?new Iv(nx.W()):ox.m.Tc.call(this,a)};ox.prototype.w=function(){return"goog-toolbar"};ox.prototype.cg=function(){return Rt};function px(a,b,c){Tt.call(this,b,a||ox.W(),c)}C(px,Tt);function qx(a){Mc.call(this);this.g=[];rx(this,a)}C(qx,Mc);qx.prototype.h=null;function rx(a,b){b&&(Qa(b,function(a){sx(a,!1)},a),bb(a.g,b))}qx.prototype.vc=function(){return ab(this.g)};function tx(a){var b=a.h;return b?Pa(a.g,b):-1}qx.prototype.clear=function(){Ya(this.g);this.h=null};qx.prototype.I=function(){qx.m.I.call(this);delete this.g;this.h=null};function sx(a,b){a&&"function"==typeof a.Hc&&a.Hc(b)};function ux(a,b,c,d){$v.call(this,a,b,c,d);this.s=this.pa()}C(ux,$v);h=ux.prototype;h.ma=null;h.N=function(){ux.m.N.call(this);vx(this);wx(this)};h.Zb=function(a){ux.m.Zb.call(this,a);(a=this.xb())?(this.s=a,vx(this)):this.ma&&xx(this,this.ma.g[0]||null)};h.I=function(){ux.m.I.call(this);this.ma&&(this.ma.la(),this.ma=null);this.s=null};h.bf=function(a){xx(this,a.target);ux.m.bf.call(this,a);a.Yc();this.dispatchEvent("action")};h.Ch=function(){var a=yx(this);ux.m.fg.call(this,a&&a.S());vx(this)};
h.ad=function(a){var b=ux.m.ad.call(this,a);a!=b&&(this.ma&&this.ma.clear(),a&&(this.ma?Ps(a,function(a){zx(a);var b=this.ma,e=b.g.length;a&&(sx(a,!1),cb(b.g,e,0,a))},this):Ax(this,a)));return b};function xx(a,b){if(a.ma){var c=yx(a),d=a.ma;b!=d.h&&(sx(d.h,!1),d.h=b,sx(b,!0));d.dispatchEvent("select");b!=c&&a.dispatchEvent("change")}}h.fg=function(a){if(null!=a&&this.ma)for(var b=0,c;c=this.ma.g[b]||null;b++)if(c&&"function"==typeof c.S&&c.S()==a){xx(this,c);return}xx(this,null)};
function yx(a){return a.ma?a.ma.h:null}function Ax(a,b){a.ma=new qx;b&&Ps(b,function(a){zx(a);var b=this.ma,e=b.g.length;a&&(sx(a,!1),cb(b.g,e,0,a))},a);wx(a)}function wx(a){a.ma&&Ks(a).listen(a.ma,"select",a.Ch)}function vx(a){var b=yx(a),b=b?b.xb():a.s;a.i.Db(a.n(),b);a.Eb=b}function zx(a){a.af=a instanceof Gv?"option":"separator"}h.na=function(a,b){ux.m.na.call(this,a,b);ot(this,64)&&(this.h||this.ad(new Lv(this.g)),(this.h||null).Jb(this.ma?tx(this.ma):-1))};yt("goog-select",function(){return new ux(null)});function Bx(){}C(Bx,Zv);da(Bx);Bx.prototype.w=function(){return"goog-toolbar-menu-button"};function Cx(a,b,c,d){ux.call(this,a,b,c||Bx.W(),d)}C(Cx,ux);yt("goog-toolbar-select",function(){return new Cx(null)});function Dx(){}C(Dx,ht);da(Dx);h=Dx.prototype;h.Ob=function(){};function Ex(a,b,c,d){var e=d.t("div",a.w()+"-inner-box"),f=d.t("div",a.w()+"-clear","\u00d7");a=d.t("div",a.w()+"-outer-box",[e,f]);d.appendChild(b,a);d.appendChild(e,c)}h.qa=function(a,b){var c=a.g,d=b;b=c.t("div","goog-inline-block");c.Jh(b,d);Ex(this,b,d,c);Dx.m.qa.call(this,a,b);a.Eb=d.value;return b};
h.aa=function(a){var b=a.g,c=b.t("div","goog-inline-block "+jt(this,a).join(" "));a=b.t("input",{type:"text",value:a.pa()||"",disabled:!a.isEnabled()});Ex(this,c,a,b);return c};h.Od=function(a){return"INPUT"==a.tagName&&(!a.type||"TEXT"==a.type.toUpperCase())};h.xa=function(a){if(a)a:{a=a.getElementsByTagName("input");for(var b=0;b<a.length;++b){var c=a[b];if(!c.type||"TEXT"==c.type.toUpperCase()){a=c;break a}}a=null}else a=null;return a};h.gc=function(a){return this.xa(a.n())};h.$e=ca;h.Ze=function(a){return a.isEnabled()};
h.zc=ca;h.U=function(a,b,c){Dx.m.U.call(this,a,b,c);1==b&&(a=this.xa(a.n()))&&(a.disabled=c)};h.Wa=ca;h.Db=function(a,b){var c=this.xa(a);c&&(c.value=b)};h.pa=function(a){return(a=this.xa(a))?a.value:null};h.w=function(){return"wgui-textinput"};function Fx(a,b,c){At.call(this,a,b||Dx.W(),c);Bt(this,!1);Dt(this);It(this);Gt(this,32,!1);a||(this.Eb="")}C(Fx,At);h=Fx.prototype;h.N=function(){Fx.m.N.call(this);var a=this.i.gc(this);if(a){var b=this.j||(this.j=new Xs);Ys(b,a);Ks(this).listen(b,"key",this.Sa)}(a=Mg(this.i.w()+"-clear",this.n()))&&Ks(this).listen(a,"click",this.kh)};h.kh=function(a){a.preventDefault();this.i.Db(this.n(),"");this.Eb="";this.dispatchEvent(new K("action",this))};
h.pa=function(){return this.n()?this.i.pa(this.n()):null};h.S=function(){return this.pa()};h.xb=function(){return this.pa()||""};function Gx(a,b){this.result=b;wu.call(this,a,new Oq(a.K(),b.storeName,b.record));this.g.g||Hx(this)}C(Gx,wu);function Hx(a){a.parent.send("list",[{store:a.result.storeName,index:"id",key:a.result.primaryKey}]).A(function(a){a=a[0].result;a[0]&&this.pb(new Oq(this.parent.K(),iq[iq.indexOf(this.result.storeName)],a[0]))},a)}function Ix(a,b){b&&(a.result=b,b.record?a.pb(new Oq(a.K(),b.storeName,b.record)):b.storeName&&t(b.primaryKey)&&Hx(a))}
Gx.prototype.clear=function(){this.Pa()||(this.pb(null),this.result=null)};Gx.prototype.toString=function(){return"ydn.crm.sugar.model.ResultRecord:"+this.g};Gx.prototype.Pa=function(){return!xu(this)&&!this.result};function Jx(a,b){Z.call(this,a);this.ra(b);this.i=new Z(a);this.h=null;this.j=[];this.o=0}C(Jx,Z);h=Jx.prototype;h.w=function(){return"search-panel"};
h.T=function(){Jx.m.T.call(this);var a=this.g,b=this.n();b.classList.add(this.w());var c=a.t("div","header");b.appendChild(c);this.h=new px(null,null,a);for(var d=new Lv(a),e=0;e<jq.length;e++)d.R(new Gv(jq[e]),!0);d=new Cx("Module",d,null,a);this.h.R(d,!0);this.h.R(new Fx(""),!0);this.h.render(c);d.$c(!1);a=a.t("div","content");b.appendChild(a);this.R(this.i,!0)};h.N=function(){Jx.m.N.call(this);var a=$(this.h,1);Ks(this).listen(a,"action",this.bi,!0)};
function Kx(a,b){if(b){for(var c=Qs(a.i),d=0;d<c;d++){var e=$(a.i,d).B();if(e.Pa()){Ix(e,b);return}}30<c?(e=$(a.i,0).B(),Ix(e,b)):(c=new Gx(a.B(),b),c=new fx(c,a.g),a.i.R(c,!0))}}function Lx(a,b,c,d){gv(a.B(),b,c,d,!0).u(function(a){a=a[0];if(a.result[0]){var b=a.result[0];Kx(this,{storeName:iq[iq.indexOf(a.store)],primaryKey:b.id,record:b,value:d,tokens:[{keyPath:c}]})}Mx(this)},function(a){Mx(this);throw a;},a)}
function Nx(a){var b=a+0.1,c=["rgb(255, 255, 255) 0%"];99>a&&(c[1]="rgb(135, 224, 253) "+a.toFixed(1)+"%",c[2]="rgb(255, 255, 255) "+b.toFixed(1)+"%");c.push("rgb(255, 255, 255) 100%");return"linear-gradient(to right, "+c.join(", ")+")"}function Ox(a,b){0==a.o&&(a.o=b);var c=100*(a.o-b)/a.o,d=$(a.h,1).n();Ng(document,"input",null,d)[0].style.background=Nx(c)}
function Mx(a){var b=a.j[0];if(b){b.Ja++;Ox(a,4*(a.j.length-1)+(4-b.Ja));var c=a.B();0==b.Ja?Lx(a,b.module,"id",b.Ua):1==b.Ja?Lx(a,b.module,"ydn$emails",b.Ua):2==b.Ja?(c=b.Ua.match(/\d/g),3>(c?c.length:0)?Mx(a):Lx(a,b.module,"ydn$phones",b.Ua)):3==b.Ja?hv(c,b.module,b.Ua).u(function(a){a=a[0].fullTextResult;for(var b=a.length||0,c=0;c<b;c++)Kx(this,a[c]);Mx(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&Mx(a))}}
h.bi=function(){for(var a=$(this.h,1).pa(),b=Qs(this.i)-1;0<=b;b--)$(this.i,b).B().clear();this.o=0;if(a&&(a=a.trim(),2<=a.length)){b=(b=yx($(this.h,0)))?b.xb():null;this.j.length=0;if(b)this.j[0]={module:b,Ua:a,Ja:-1};else for(b=0;b<jq.length;b++)this.j[b]={module:jq[b],Ua:a,Ja:-1};Mx(this)}};h.sa=function(){return Mg("content",this.n())};function Px(a,b){Z.call(this,b);this.ra(a)}C(Px,Z);h=Px.prototype;h.logger=R("ydn.crm.ui.sugar.Header");h.w=function(){return"sugar-header"};h.sa=function(){return this.n().querySelector(".sugar-header-content")};
h.T=function(){Px.m.T.call(this);var a=this.n(),b=this.B(),c=this.g;Dg(a,this.w());var d=c.t("a");d.textContent=b.K();d.href=ev(b);d=c.t("div",{"class":"main-title",title:"SugarCRM"},[d]);a.appendChild(d);var d=[],e=chrome.extension.getURL("option-page.html")+"#credentials",e=c.t("a",{href:e,target:"option-page"},"Setup host permission");e.setAttribute("title","Your permission is required to connect your server from this extension. Without permission request to server will be slow.");d.push(e);d=
c.t("div",{"class":"host-permission"},d);a.appendChild(d);var e=c.t("input",{name:"username",type:"text"}),e=c.t("div",null,[e]),f=c.t("input",{name:"password",type:"password"}),f=c.t("div",null,[f]),g=c.t("div","message"),e=c.t("div","login-form",[e,f,g]);S(d,!1);S(e,!1);a.appendChild(e);a.appendChild(c.t("div","sugar-header-content"));a=new Jx(c,b);this.R(a,!0)};
h.N=function(){Px.m.N.call(this);var a=this.n(),b=Ks(this);this.n().querySelector(".host-permission");a=a.querySelector(".login-form");a=new Xs(a);b.listen(a,"key",this.ai);b.listen(bd(),"post",function(a){a=a.getMessage();if("update-host-permission"==a.req&&(a=a.data)&&a.origins){a=a.origins;for(var b=this.info.K(),e=0;e<a.length;e++)if((new td(a[e])).K()==b){P(this.logger,"has host permission on "+b);var f=this.B();f.g.hostPermission=!0;this.ra(f)}}},!1)};
h.ai=function(a){if(13==a.g){var b=this.n().querySelector(".login-form"),c=this.B();a=b.querySelector("input[name=username]").value;var d=b.querySelector("input[name=password]").value,e=b.querySelector(".message");e.textContent="logging in...";fv(c,a,d).u(function(){c.isLogin()?(e.textContent="",S(b,!1)):e.textContent="login failed"},function(a){e.textContent="Error: "+a},this)}};h.K=function(){return this.B().K()};function Qx(a,b){Z.call(this,b);this.ra(a);this.i=new wv(a);xv(this.i);this.h=mq.map(function(c){c=new Eu(a,c);return new mx(c,b)})}C(Qx,Z);h=Qx.prototype;h.w=function(){return"sugar-panel"};h.sa=function(){return this.n().querySelector(".sugar-panel-content")};
h.T=function(){Qx.m.T.call(this);var a=this.g,b=this.n();Dg(b,this.w());var c=a.t("div"),d=a.t("div","sugar-panel-content");b.appendChild(c);b.appendChild(d);S(d,!1);(new Px(this.B(),a)).render(c);for(a=0;a<this.h.length;a++)this.R(this.h[a],!0)};h.N=function(){Qx.m.N.call(this);Ks(this).listen(this.B(),[Fu],this.yh)};h.yh=function(){var a=!!Lu(this.B());S(this.sa(),a)};h.logger=R("ydn.crm.ui.sugar.SugarPanel");function Rx(){this.g=null;var a=ed().send("user-setting").A(function(){},this),b=ed().send("login-info").u(function(a){a||M(this.logger,"login fail");this.g=a},function(){this.g=null;M(this.logger,"login fail")},this);this.i=om([a,b])}var Sx;Rx.prototype.logger=R("ydn.crm.inj.UserSetting");function vv(){Sx||(Sx=new Rx);return Sx}Rx.prototype.Sb=function(){return this.i};Rx.prototype.j=function(){return this.g.email};
Rx.prototype.h=function(a){var b=ed("sugarcrm",a);return rb(this.i).A(function(){return b.send("info-module").A(function(a){if(u(a))for(var b=0;b<a.length;b++)Tx(a[b]);else Tx(a);return a},this)},this)};
function Tx(a){var b="",c="",d;for(d in a.module_fields){var e=a.module_fields[d];if(0<=["salutation","name","last_name","first_name","full_name"].indexOf(d))e.group="name";else if(/^email\d?$/.test(d))e.group="email";else if(/^phone?/.test(d))e.group="phone";else if(!e.group&&sa(d,b)){e.group=c;continue}b=d;c=e.group}for(d in a.link_fields)b=a.link_fields[d],"contact"!=d||b.module||(b.module="Contacts")};function Ux(a){Z.call(this,a)}C(Ux,Z);Ux.prototype.T=function(){Ux.m.T.call(this);var a=this.n(),b=this.g;Dg(a,"sugarcrm-link-panel");b=b.createElement("a");b.textContent="Setup SugarCRM";b.href=chrome.extension.getURL("option-page.html")+"#credentials";b.className="sugarcrm-setup-link";a.appendChild(b);S(a,!1)};Ux.prototype.ra=function(a){Ux.m.ra.call(this,a);a=u(a)&&0<a.length;S(this.n(),!a)};function Vx(a){Z.call(this,a);this.i=vv();this.h=null}C(Vx,Z);h=Vx.prototype;h.w=function(){return"inj"};h.T=function(){Vx.m.T.call(this);this.n().classList.add(this.w());var a=new Ux;this.R(a,!0)};h.N=function(){Vx.m.N.call(this)};h.logger=R("ydn.crm.ui.SidebarPanel");
function Wx(a,b){var c=b.domain;return a.i.h(c).A(function(a){a=new jv(b,a,this.i.g.email);!this.h&&a.isLogin()&&(P(this.logger,"compose template initialized."),this.h=new uw(a));a=new Qx(a,this.g);for(var e=0;e<Qs(this);e++){var f=$(this,e);if(f instanceof Qx&&f.B().K()==c)return}P(this.logger,"sugar panel "+c+" created");this.R(a,!0)},a)}h.Bf=function(a){for(var b=0;b<Qs(this);b++){var c=$(this,b);c instanceof Qx&&(c=c.B(),a?c.update(a.g,a.h,null):c.update(null,null,null))}};
h.init=function(){return 1<Qs(this)?tb():ed().send("list-sugarcrm").A(function(a){$(this,0).ra(a);for(var b=[],c=0;c<a.length;c++){var d;a:{for(d=1;d<Qs(this);d++){var e=$(this,d);if(e instanceof Qx&&e.B().K()==a[c]){d=!0;break a}}d=!1}d||b.push(Wx(this,a[c]))}return om(b)},this)};function Xx(){this.g=this.h=null}Xx.prototype.init=function(a){this.h=a;a=document.getElementById("user-login");Ac(a,"click",function(a){a.preventDefault();window.open(a.target.href,void 0,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=600, height=400, top="+(screen.height/2-200)+", left="+(screen.width/2-300));return!0},!0,this)};
function Yx(a,b){if(!b||b instanceof Error)a.g=null;else if(a.g=b,a.h){var c=document.getElementById("user-login"),d=document.getElementById("user-name"),e=Mg("login-message",a.h);b instanceof Error?(e.textContent=b.message,S(e,!0),S(c,!1)):a.g.is_login?(c.href=a.g.logout_url,c.textContent="logout",d.textContent=a.g.email,S(e,!1),S(c,!1)):(c.href=a.g.login_url,c.textContent="login",c.style.display="",d.textContent="",S(e,!0),S(c,!0))}};function Zx(){this.h=document.createElement("div");document.body.appendChild(this.h);S(this.h,!1);this.j=new hf(400);Ac(this.j,kf,this.Hh,!0,this);this.i=0;this.s="";cd("gmail");this.g=new Vx;this.g.render(this.h);this.p=!1;var a=this.history=new Fs,b=Gd(new td(document.location.href))+"/";a.Qh=b;Ac(this.history,"navigate",this.rh,!1,this);this.G=null;this.l=!1;new ju;this.o=new Xx}h=Zx.prototype;h.logger=R("ydn.crm.inj.App");h.isLogin=function(){return this.l};
h.Hh=function(){this.i++;this.s!=location.href&&(M(this.logger,"url already changed"),this.j.stop());40<this.i&&(M(this.logger,"sniff give up after "+this.i),this.j.stop());var a;this.g.n();a=(a=document.querySelector('table[role="presentation"]'))?a.querySelector("tr").children[2].querySelector("table"):null;if(a&&!this.p){for(var b,c=a,d=0;4>d;d++)if(c&&c.parentElement&&(c=c.parentElement,c.nextElementSibling&&"DIV"==c.nextElementSibling.tagName)){var c=c.parentElement,d=c.lastElementChild,e=!!d.querySelector("a[href]");
b=document.createElement("div");e&&c.parentElement.contains(d)?c.parentElement.insertBefore(b,d):c.appendChild(b);break}b||(M(this.logger,"usual root position is not available, locating on second best position"),c=a.ownerDocument,b=c.createElement("td"),b.setAttribute("colspan","2"),c=c.createElement("tr"),c.className="widget-topraw",c.appendChild(b),(a.querySelector("tbody")||a).appendChild(c));c=this.h;c.parentElement&&c.parentElement.removeChild(c);b.appendChild(c);S(c,!0);this.p=!0;S(this.h,!0)}a:if(c=
5<this.i,b=a.querySelector("img[jid]")){for(a=b.getAttribute("jid");b&&"TD"!=b.tagName;)b=b.parentElement;b=b.nextElementSibling.querySelector("span[title]").getAttribute("title");a=new mu(a,b)}else{if(c&&(a=a.querySelector("span[title]"))&&(b=a.getAttribute("title").trim(),0<b.length&&(a=document.querySelector('span[name="'+b+'"][email]')))){a=a.getAttribute("email");a=new mu(a,b);break a}a=null}a&&(this.j.stop(),this.g.Bf(a))};
h.rh=function(a){if(a.g!=this.G&&(this.G=a.g,!/^contact/.test(a.g)))if(/compose=new$/.test(a.g)){a=this.g;if(a.h){a=a.h;var b=document.querySelector('form[enctype="multipart/form-data"]');b?(b=(b=vw(b))?(b=b.querySelector("tbody").lastElementChild.firstElementChild.firstElementChild.firstElementChild.lastElementChild.querySelector("table"))?b.querySelector("td:last-child"):null:null,b?(zw(a,b),a=!0):(M(a.logger,"compose toolbar not found."),a=!1)):(M(a.logger,"compose FORM element not found."),a=
!1)}else M(a.logger,"SugarCRM instance not ready."),a=!1;Q(this.logger,"inject compose "+(a?"ok":"fail"))}else/\w+\/[\w\d]{10,18}$/.test(a.g)&&(Q(this.logger,"updating sidebar"),this.i=0,this.s=location.href,this.p=!1,this.g.Bf(null),jf(this.j))};
h.init=function(){P(this.logger,"init "+this);$x(this);var a=window.setInterval(function(){document.querySelector('a[href="http://mail.google.com/mail/help/terms.html"]')&&window.clearTimeout(a)},500);window.setTimeout(function(){window.clearTimeout(a)},15E3)};h.toString=function(){return"inj.Main:0.7.23"};
function $x(a){ed().send("login-info").u(function(a){a:{if(a&&a.email){Q(this.logger,"user "+a.email+" login");this.l=!0;var c=this.o.g;if(c&&c.email==a.email)break a;this.g.init();this.history.setEnabled(!0)}else this.l&&(this.l=!1,this.history.setEnabled(!1));Yx(this.o,a)}},function(a){M(this.logger,a.name+" "+a.message);Yx(this.o,a)},a)}h.Zh=function(){return{sidebar:this.g,setting:this.o}};pa("ydn.crm.version","0.7.23");pa("runInjApp",function(){vo();var a=new Zx;a.init();return a});pa("runEventApp",function(){vo();var a=new ys;a.init();ws(a);return a});pa("ydn.crm.ui.StatusBar",Fw);pa("ydn.crm.ui.SimpleStatusBar",Hw);Fw.instance=Gw;ys.prototype.xp=ys.prototype.V;Zx.prototype.xp=Zx.prototype.Zh;pa("goog.async.Deferred",D);D.prototype.addCallback=D.prototype.A;D.prototype.addErrback=D.prototype.Mc;D.prototype.addBoth=D.prototype.ca;D.prototype.addCallbacks=D.prototype.u;function ay(a,b){Z.call(this,a);this.ra(b);this.i=new Z(a);this.h=null;this.j=[];this.o=0}C(ay,Z);h=ay.prototype;h.w=function(){return"browse-panel"};h.T=function(){ay.m.T.call(this);var a=this.g,b=this.n(),c=a.t("div","header");b.appendChild(c);b.className=this.w();this.h=new px(null,null,a);for(var d=new Lv(a),e=0;e<jq.length;e++)d.R(new Gv(jq[e]),!0);d=new Cx("Module",d,null,a);this.h.R(d,!0);this.h.R(new Fx(""),!0);this.h.render(c);a=a.t("div","content");b.appendChild(a);this.R(this.i,!0)};
h.N=function(){ay.m.N.call(this);var a=$(this.h,1);Ks(this).listen(a,"action",this.$h,!0)};function by(a,b){if(b){for(var c=Qs(a.i),d=0;d<c;d++){var e=$(a.i,d).B();if(e.Pa()){Ix(e,b);return}}30<c?(e=$(a.i,0).B(),Ix(e,b)):(c=new Gx(a.B(),b),c=new fx(c,a.g),a.i.R(c,!0))}}
function cy(a,b,c,d){gv(a.B(),b,c,d,!0).u(function(a){a=a[0];if(a.result[0]){var b=a.result[0];by(this,{storeName:iq[iq.indexOf(a.store)],primaryKey:b.id,record:b,value:d,tokens:[{keyPath:c}]})}dy(this)},function(a){dy(this);throw a;},a)}function ey(a,b){0==a.o&&(a.o=b);var c=100*(a.o-b)/a.o,d=$(a.h,1).n();Ng(document,"input",null,d)[0].style.background=Nx(c)}
function dy(a){var b=a.j[0];if(b){b.Ja++;ey(a,4*(a.j.length-1)+(4-b.Ja));var c=a.B();0==b.Ja?cy(a,b.module,"id",b.Ua):1==b.Ja?cy(a,b.module,"ydn$emails",b.Ua):2==b.Ja?(c=b.Ua.match(/\d/g),3>(c?c.length:0)?dy(a):cy(a,b.module,"ydn$phones",b.Ua)):3==b.Ja?hv(c,b.module,b.Ua).u(function(a){a=a[0].fullTextResult;for(var b=a.length||0,c=0;c<b;c++)by(this,a[c]);dy(this)},function(a){throw a;},a):(a.j.shift(),0<a.j.length&&dy(a))}}
h.$h=function(){for(var a=$(this.h,1).pa(),b=Qs(this.i)-1;0<=b;b--)$(this.i,b).B().clear();this.o=0;if(a&&(a=a.trim(),2<=a.length)){b=(b=yx($(this.h,0)))?b.xb():null;this.j.length=0;if(b)this.j[0]={module:b,Ua:a,Ja:-1};else for(b=0;b<jq.length;b++)this.j[b]={module:jq[b],Ua:a,Ja:-1};dy(this)}};h.sa=function(){return Mg("content",this.n())};function fy(a,b,c){Gv.call(this,a,b,c);Gt(this,8,!0);if(a=this.n())b=this.i,a&&(ft(a,"menuitemradio"),Dv(b,this,a,!0))}C(fy,Gv);fy.prototype.ob=function(){return this.dispatchEvent("action")};yt("goog-option",function(){return new fy(null)});function gy(){}C(gy,Xv);da(gy);gy.prototype.w=function(){return"goog-toolbar-button"};function hy(a,b,c){Vv.call(this,a,b||gy.W(),c)}C(hy,Vv);yt("goog-toolbar-button",function(){return new hy(null)});function iy(a,b,c,d){$v.call(this,a,b,c||Bx.W(),d)}C(iy,$v);yt("goog-toolbar-menu-button",function(){return new iy(null)});function jy(a,b){Iv.call(this,a||nx.W(),b)}C(jy,Iv);yt("goog-toolbar-separator",function(){return new jy});function ky(a,b,c){Vv.call(this,a,b||Xv.W(),c);Gt(this,16,!0)}C(ky,Vv);yt("goog-toggle-button",function(){return new ky(null)});function ly(a,b,c){ky.call(this,a,b||gy.W(),c)}C(ly,ky);yt("goog-toolbar-toggle-button",function(){return new ly(null)});function my(){}C(my,ht);da(my);my.prototype.w=function(){return"record"};my.prototype.aa=function(a){return my.m.aa.call(this,a)};function ny(a,b){At.call(this,null,null,a);this.ra(b)}C(ny,At);wt(ny,my);function oy(a,b){Z.call(this,a);this.ra(b);this.i=new Z(a);this.h=new Z(a)}C(oy,Z);oy.prototype.sa=function(){return Mg("content",this.n())};
oy.prototype.T=function(){oy.m.T.call(this);var a=this.n(),b;A('<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>')?(Na('Soy template output is unsafe for use as HTML: <div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>'),
b="zSoyz"):b='<div class="goog-toolbar"><div title="Select base record type" class="goog-toolbar-select">Base record<div class="goog-menu" name="base-record"><div class="goog-option" name="gmail-contact">Gmail Contacts</div><div class="goog-option" name="Contacts">Contacts</div><div class="goog-option" name="Leads">Leads</div></div></div><div title="Sort order" class="goog-toolbar-select">Sort by<div class="goog-menu" name="sort-by"><div class="goog-option" name="modified">modified</div><div class="goog-option" name="id">id</div><div class="goog-option" name="name">name</div></div></div></div><div class="content"></div>';
a.innerHTML=b;Os(new px,Mg("goog-toolbar",a));this.R(this.i,!0);this.R(this.h,!0);S(this.h.n(),!1)};oy.prototype.N=function(){oy.m.N.call(this);this.n()};oy.prototype.refresh=function(){};pa("ydn.crm.sugar.model.Sugar",bv);pa("ydn.crm.ui.SidebarPanel",Vx);pa("ydn.crm.ui.sugar.SyncPanel",oy);pa("ydn.crm.ui.sugar.SearchPanel",Jx);pa("ydn.crm.ui.sugar.BrowsePanel",ay);pa("ydn.crm.inj.UserSetting",Rx);Rx.getInstance=vv;Rx.prototype.getModuleInfo=Rx.prototype.h;Rx.prototype.getGmail=Rx.prototype.j;
bv.list=function(){var a=vv();return ed().send("list-sugarcrm").A(function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];e.isLogin&&c.push(a.h(e.domain).A(function(a){return new bv(this,a)},e))}return om(c)})};Vx.prototype.update=Vx.prototype.Bf;pa("ydn.msg.Pipe",Wc);pa("ydn.msg.initPipe",cd);pa("ydn.msg.getChannel",ed);Wc.prototype.listen=Wc.prototype.listen;Wc.prototype.getChannel=Wc.prototype.j;Zc.prototype.send=Zc.prototype.send;})();

            //# sourceMappingURL=https://ydn-src-1.storage.googleapis.com/jsc/ydn.crm-0.7.23.js.map
        